!function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module.default}:function getModuleExports(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=429)}([function(module,exports,__webpack_require__){"use strict";module.exports=__webpack_require__(284)},function(module,exports){var core=module.exports={version:"2.5.3"};"number"==typeof __e&&(__e=core)},function(module,exports,__webpack_require__){module.exports=__webpack_require__(301)()},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0,exports.default=function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _defineProperty2=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(109));exports.default=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),(0,_defineProperty2.default)(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}()},function(module,exports,__webpack_require__){var global=__webpack_require__(7),core=__webpack_require__(1),ctx=__webpack_require__(18),hide=__webpack_require__(23),$export=function(type,name,source){var key,own,out,IS_FORCED=type&$export.F,IS_GLOBAL=type&$export.G,IS_STATIC=type&$export.S,IS_PROTO=type&$export.P,IS_BIND=type&$export.B,IS_WRAP=type&$export.W,exports=IS_GLOBAL?core:core[name]||(core[name]={}),expProto=exports.prototype,target=IS_GLOBAL?global:IS_STATIC?global[name]:(global[name]||{}).prototype;for(key in IS_GLOBAL&&(source=name),source)(own=!IS_FORCED&&target&&void 0!==target[key])&&key in exports||(out=own?target[key]:source[key],exports[key]=IS_GLOBAL&&"function"!=typeof target[key]?source[key]:IS_BIND&&own?ctx(out,global):IS_WRAP&&target[key]==out?function(C){var F=function(a,b,c){if(this instanceof C){switch(arguments.length){case 0:return new C;case 1:return new C(a);case 2:return new C(a,b)}return new C(a,b,c)}return C.apply(this,arguments)};return F.prototype=C.prototype,F}(out):IS_PROTO&&"function"==typeof out?ctx(Function.call,out):out,IS_PROTO&&((exports.virtual||(exports.virtual={}))[key]=out,type&$export.R&&expProto&&!expProto[key]&&hide(expProto,key,out)))};$export.F=1,$export.G=2,$export.S=4,$export.P=8,$export.B=16,$export.W=32,$export.U=64,$export.R=128,module.exports=$export},function(module,exports,__webpack_require__){var store=__webpack_require__(93)("wks"),uid=__webpack_require__(63),Symbol=__webpack_require__(7).Symbol,USE_SYMBOL="function"==typeof Symbol;(module.exports=function(name){return store[name]||(store[name]=USE_SYMBOL&&Symbol[name]||(USE_SYMBOL?Symbol:uid)("Symbol."+name))}).store=store},function(module,exports){var global=module.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=global)},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _assign2=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(72));exports.default=_assign2.default||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}},function(module,exports){module.exports=function(it){return"object"==typeof it?null!==it:"function"==typeof it}},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(319),__esModule:!0}},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _typeof3=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(75));exports.default=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!==(void 0===call?"undefined":(0,_typeof3.default)(call))&&"function"!=typeof call?self:call}},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _setPrototypeOf2=_interopRequireDefault(__webpack_require__(321)),_create2=_interopRequireDefault(__webpack_require__(325)),_typeof3=_interopRequireDefault(__webpack_require__(75));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+(void 0===superClass?"undefined":(0,_typeof3.default)(superClass)));subClass.prototype=(0,_create2.default)(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(_setPrototypeOf2.default?(0,_setPrototypeOf2.default)(subClass,superClass):subClass.__proto__=superClass)}},function(module,exports,__webpack_require__){var anObject=__webpack_require__(14),IE8_DOM_DEFINE=__webpack_require__(137),toPrimitive=__webpack_require__(88),dP=Object.defineProperty;exports.f=__webpack_require__(16)?Object.defineProperty:function defineProperty(O,P,Attributes){if(anObject(O),P=toPrimitive(P,!0),anObject(Attributes),IE8_DOM_DEFINE)try{return dP(O,P,Attributes)}catch(e){}if("get"in Attributes||"set"in Attributes)throw TypeError("Accessors not supported!");return"value"in Attributes&&(O[P]=Attributes.value),O}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(9);module.exports=function(it){if(!isObject(it))throw TypeError(it+" is not an object!");return it}},function(module,exports,__webpack_require__){"use strict";var keys=__webpack_require__(214),foreach=__webpack_require__(216),hasSymbols="function"==typeof Symbol&&"symbol"==typeof Symbol(),toStr=Object.prototype.toString,supportsDescriptors=Object.defineProperty&&function(){var obj={};try{for(var _ in Object.defineProperty(obj,"x",{enumerable:!1,value:obj}),obj)return!1;return obj.x===obj}catch(e){return!1}}(),defineProperty=function(object,name,value,predicate){var fn;name in object&&("function"!=typeof(fn=predicate)||"[object Function]"!==toStr.call(fn)||!predicate())||(supportsDescriptors?Object.defineProperty(object,name,{configurable:!0,enumerable:!1,value:value,writable:!0}):object[name]=value)},defineProperties=function(object,map){var predicates=arguments.length>2?arguments[2]:{},props=keys(map);hasSymbols&&(props=props.concat(Object.getOwnPropertySymbols(map))),foreach(props,function(name){defineProperty(object,name,map[name],predicates[name])})};defineProperties.supportsDescriptors=!!supportsDescriptors,module.exports=defineProperties},function(module,exports,__webpack_require__){module.exports=!__webpack_require__(24)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(module,exports){var g;g=function(){return this}();try{g=g||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(g=window)}module.exports=g},function(module,exports,__webpack_require__){var aFunction=__webpack_require__(42);module.exports=function(fn,that,length){if(aFunction(fn),void 0===that)return fn;switch(length){case 1:return function(a){return fn.call(that,a)};case 2:return function(a,b){return fn.call(that,a,b)};case 3:return function(a,b,c){return fn.call(that,a,b,c)}}return function(){return fn.apply(that,arguments)}}},function(module,exports){var global=module.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=global)},function(module,exports){var hasOwnProperty={}.hasOwnProperty;module.exports=function(it,key){return hasOwnProperty.call(it,key)}},function(module,exports,__webpack_require__){var store=__webpack_require__(77)("wks"),uid=__webpack_require__(40),Symbol=__webpack_require__(19).Symbol,USE_SYMBOL="function"==typeof Symbol;(module.exports=function(name){return store[name]||(store[name]=USE_SYMBOL&&Symbol[name]||(USE_SYMBOL?Symbol:uid)("Symbol."+name))}).store=store},function(module,exports,__webpack_require__){"use strict";var implementation=__webpack_require__(219);module.exports=Function.prototype.bind||implementation},function(module,exports,__webpack_require__){var dP=__webpack_require__(13),createDesc=__webpack_require__(43);module.exports=__webpack_require__(16)?function(object,key,value){return dP.f(object,key,createDesc(1,value))}:function(object,key,value){return object[key]=value,object}},function(module,exports){module.exports=function(exec){try{return!!exec()}catch(e){return!0}}},function(module,exports){var hasOwnProperty={}.hasOwnProperty;module.exports=function(it,key){return hasOwnProperty.call(it,key)}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__TemplateTag__=__webpack_require__(458);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__TemplateTag__.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__trimResultTransformer__=__webpack_require__(459);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__trimResultTransformer__.a})},function(module,exports,__webpack_require__){var IObject=__webpack_require__(89),defined=__webpack_require__(90);module.exports=function(it){return IObject(defined(it))}},function(module,exports,__webpack_require__){module.exports=!__webpack_require__(57)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(module,exports,__webpack_require__){var dP=__webpack_require__(31),createDesc=__webpack_require__(59);module.exports=__webpack_require__(29)?function(object,key,value){return dP.f(object,key,createDesc(1,value))}:function(object,key,value){return object[key]=value,object}},function(module,exports,__webpack_require__){var anObject=__webpack_require__(58),IE8_DOM_DEFINE=__webpack_require__(118),toPrimitive=__webpack_require__(76),dP=Object.defineProperty;exports.f=__webpack_require__(29)?Object.defineProperty:function defineProperty(O,P,Attributes){if(anObject(O),P=toPrimitive(P,!0),anObject(Attributes),IE8_DOM_DEFINE)try{return dP(O,P,Attributes)}catch(e){}if("get"in Attributes||"set"in Attributes)throw TypeError("Accessors not supported!");return"value"in Attributes&&(O[P]=Attributes.value),O}},function(module,exports,__webpack_require__){var IObject=__webpack_require__(187),defined=__webpack_require__(122);module.exports=function(it){return IObject(defined(it))}},function(module,exports,__webpack_require__){"use strict";module.exports=__webpack_require__(135)},function(module,exports,__webpack_require__){var defined=__webpack_require__(90);module.exports=function(it){return Object(defined(it))}},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(262),__esModule:!0}},function(module,exports){module.exports={}},function(module,exports,__webpack_require__){"use strict";var $at=__webpack_require__(268)(!0);__webpack_require__(110)(String,"String",function(iterated){this._t=String(iterated),this._i=0},function(){var point,O=this._t,index=this._i;return index>=O.length?{value:void 0,done:!0}:(point=$at(O,index),this._i+=point.length,{value:point,done:!1})})},function(module,exports){var core=module.exports={version:"2.5.3"};"number"==typeof __e&&(__e=core)},function(module,exports){module.exports=function(it){return"object"==typeof it?null!==it:"function"==typeof it}},function(module,exports){var id=0,px=Math.random();module.exports=function(key){return"Symbol(".concat(void 0===key?"":key,")_",(++id+px).toString(36))}},function(module,exports,__webpack_require__){var bind=__webpack_require__(22);module.exports=bind.call(Function.call,Object.prototype.hasOwnProperty)},function(module,exports){module.exports=function(it){if("function"!=typeof it)throw TypeError(it+" is not a function!");return it}},function(module,exports){module.exports=function(bitmap,value){return{enumerable:!(1&bitmap),configurable:!(2&bitmap),writable:!(4&bitmap),value:value}}},function(module,exports,__webpack_require__){var $keys=__webpack_require__(138),enumBugKeys=__webpack_require__(94);module.exports=Object.keys||function keys(O){return $keys(O,enumBugKeys)}},function(module,exports){var toString={}.toString;module.exports=function(it){return toString.call(it).slice(8,-1)}},function(module,exports,__webpack_require__){var def=__webpack_require__(13).f,has=__webpack_require__(25),TAG=__webpack_require__(6)("toStringTag");module.exports=function(it,tag,stat){it&&!has(it=stat?it:it.prototype,TAG)&&def(it,TAG,{configurable:!0,value:tag})}},function(module,exports,__webpack_require__){__webpack_require__(270);for(var global=__webpack_require__(7),hide=__webpack_require__(23),Iterators=__webpack_require__(36),TO_STRING_TAG=__webpack_require__(6)("toStringTag"),DOMIterables="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),i=0;i<DOMIterables.length;i++){var NAME=DOMIterables[i],Collection=global[NAME],proto=Collection&&Collection.prototype;proto&&!proto[TO_STRING_TAG]&&hide(proto,TO_STRING_TAG,NAME),Iterators[NAME]=Iterators.Array}},function(module,exports,__webpack_require__){(function(global){var win;win="undefined"!=typeof window?window:void 0!==global?global:"undefined"!=typeof self?self:{},module.exports=win}).call(exports,__webpack_require__(17))},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__inlineArrayTransformer__=__webpack_require__(465);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__inlineArrayTransformer__.a})},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _defineProperty2=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(109));exports.default=function(obj,key,value){return key in obj?(0,_defineProperty2.default)(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AddonStore=void 0;var _keys2=_interopRequireDefault(__webpack_require__(35)),_classCallCheck3=_interopRequireDefault(__webpack_require__(3)),_createClass3=_interopRequireDefault(__webpack_require__(4));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var AddonStore=exports.AddonStore=function(){function AddonStore(){(0,_classCallCheck3.default)(this,AddonStore),this.loaders={},this.panels={},this.channel=null,this.preview=null,this.database=null}return(0,_createClass3.default)(AddonStore,[{key:"getChannel",value:function getChannel(){if(!this.channel)throw new Error("Accessing nonexistent addons channel, see https://storybook.js.org/basics/faq/#why-is-there-no-addons-channel");return this.channel}},{key:"setChannel",value:function setChannel(channel){this.channel=channel}},{key:"getPreview",value:function getPreview(){return this.preview}},{key:"setPreview",value:function setPreview(preview){this.preview=preview}},{key:"getDatabase",value:function getDatabase(){return this.database}},{key:"setDatabase",value:function setDatabase(database){this.database=database}},{key:"getPanels",value:function getPanels(){return this.panels}},{key:"addPanel",value:function addPanel(name,panel){this.panels[name]=panel}},{key:"register",value:function register(name,loader){this.loaders[name]=loader}},{key:"loadAddons",value:function loadAddons(api){var _this=this;(0,_keys2.default)(this.loaders).map(function(name){return _this.loaders[name]}).forEach(function(loader){return loader(api)})}}]),AddonStore}();exports.default=new AddonStore},function(module,exports,__webpack_require__){var ctx=__webpack_require__(18),call=__webpack_require__(142),isArrayIter=__webpack_require__(143),anObject=__webpack_require__(14),toLength=__webpack_require__(62),getIterFn=__webpack_require__(99),BREAK={},RETURN={};(exports=module.exports=function(iterable,entries,fn,that,ITERATOR){var length,step,iterator,result,iterFn=ITERATOR?function(){return iterable}:getIterFn(iterable),f=ctx(fn,that,entries?2:1),index=0;if("function"!=typeof iterFn)throw TypeError(iterable+" is not iterable!");if(isArrayIter(iterFn)){for(length=toLength(iterable.length);length>index;index++)if((result=entries?f(anObject(step=iterable[index])[0],step[1]):f(iterable[index]))===BREAK||result===RETURN)return result}else for(iterator=iterFn.call(iterable);!(step=iterator.next()).done;)if((result=call(iterator,f,step.value,entries))===BREAK||result===RETURN)return result}).BREAK=BREAK,exports.RETURN=RETURN},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _from2=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(167));exports.default=function(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return(0,_from2.default)(arr)}},function(module,exports,__webpack_require__){"use strict";var getOwnPropertySymbols=Object.getOwnPropertySymbols,hasOwnProperty=Object.prototype.hasOwnProperty,propIsEnumerable=Object.prototype.propertyIsEnumerable;module.exports=function shouldUseNative(){try{if(!Object.assign)return!1;var test1=new String("abc");if(test1[5]="de","5"===Object.getOwnPropertyNames(test1)[0])return!1;for(var test2={},i=0;i<10;i++)test2["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(test2).map(function(n){return test2[n]}).join(""))return!1;var test3={};return"abcdefghijklmnopqrst".split("").forEach(function(letter){test3[letter]=letter}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},test3)).join("")}catch(err){return!1}}()?Object.assign:function(target,source){for(var from,symbols,to=function toObject(val){if(null===val||void 0===val)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(val)}(target),s=1;s<arguments.length;s++){for(var key in from=Object(arguments[s]))hasOwnProperty.call(from,key)&&(to[key]=from[key]);if(getOwnPropertySymbols){symbols=getOwnPropertySymbols(from);for(var i=0;i<symbols.length;i++)propIsEnumerable.call(from,symbols[i])&&(to[symbols[i]]=from[symbols[i]])}}return to}},function(module,exports,__webpack_require__){"use strict";function makeEmptyFunction(arg){return function(){return arg}}var emptyFunction=function emptyFunction(){};emptyFunction.thatReturns=makeEmptyFunction,emptyFunction.thatReturnsFalse=makeEmptyFunction(!1),emptyFunction.thatReturnsTrue=makeEmptyFunction(!0),emptyFunction.thatReturnsNull=makeEmptyFunction(null),emptyFunction.thatReturnsThis=function(){return this},emptyFunction.thatReturnsArgument=function(arg){return arg},module.exports=emptyFunction},,function(module,exports){module.exports=function(exec){try{return!!exec()}catch(e){return!0}}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(39);module.exports=function(it){if(!isObject(it))throw TypeError(it+" is not an object!");return it}},function(module,exports){module.exports=function(bitmap,value){return{enumerable:!(1&bitmap),configurable:!(2&bitmap),writable:!(4&bitmap),value:value}}},function(module,exports,__webpack_require__){var global=__webpack_require__(19),hide=__webpack_require__(30),has=__webpack_require__(20),SRC=__webpack_require__(40)("src"),$toString=Function.toString,TPL=(""+$toString).split("toString");__webpack_require__(38).inspectSource=function(it){return $toString.call(it)},(module.exports=function(O,key,val,safe){var isFunction="function"==typeof val;isFunction&&(has(val,"name")||hide(val,"name",key)),O[key]!==val&&(isFunction&&(has(val,SRC)||hide(val,SRC,O[key]?""+O[key]:TPL.join(String(key)))),O===global?O[key]=val:safe?O[key]?O[key]=val:hide(O,key,val):(delete O[key],hide(O,key,val)))})(Function.prototype,"toString",function toString(){return"function"==typeof this&&this[SRC]||$toString.call(this)})},function(module,exports,__webpack_require__){"use strict";var fnToStr=Function.prototype.toString,constructorRegex=/^\s*class /,isES6ClassFn=function isES6ClassFn(value){try{var spaceStripped=fnToStr.call(value).replace(/\/\/.*\n/g,"").replace(/\/\*[.\s\S]*\*\//g,"").replace(/\n/gm," ").replace(/ {2}/g," ");return constructorRegex.test(spaceStripped)}catch(e){return!1}},toStr=Object.prototype.toString,hasToStringTag="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;module.exports=function isCallable(value){if(!value)return!1;if("function"!=typeof value&&"object"!=typeof value)return!1;if(hasToStringTag)return function tryFunctionObject(value){try{return!isES6ClassFn(value)&&(fnToStr.call(value),!0)}catch(e){return!1}}(value);if(isES6ClassFn(value))return!1;var strClass=toStr.call(value);return"[object Function]"===strClass||"[object GeneratorFunction]"===strClass}},function(module,exports,__webpack_require__){var toInteger=__webpack_require__(91),min=Math.min;module.exports=function(it){return it>0?min(toInteger(it),9007199254740991):0}},function(module,exports){var id=0,px=Math.random();module.exports=function(key){return"Symbol(".concat(void 0===key?"":key,")_",(++id+px).toString(36))}},function(module,exports){exports.f={}.propertyIsEnumerable},function(module,exports){module.exports=!0},function(module,exports,__webpack_require__){var META=__webpack_require__(63)("meta"),isObject=__webpack_require__(9),has=__webpack_require__(25),setDesc=__webpack_require__(13).f,id=0,isExtensible=Object.isExtensible||function(){return!0},FREEZE=!__webpack_require__(24)(function(){return isExtensible(Object.preventExtensions({}))}),setMeta=function(it){setDesc(it,META,{value:{i:"O"+ ++id,w:{}}})},meta=module.exports={KEY:META,NEED:!1,fastKey:function(it,create){if(!isObject(it))return"symbol"==typeof it?it:("string"==typeof it?"S":"P")+it;if(!has(it,META)){if(!isExtensible(it))return"F";if(!create)return"E";setMeta(it)}return it[META].i},getWeak:function(it,create){if(!has(it,META)){if(!isExtensible(it))return!0;if(!create)return!1;setMeta(it)}return it[META].w},onFreeze:function(it){return FREEZE&&meta.NEED&&isExtensible(it)&&!has(it,META)&&setMeta(it),it}}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__stripIndentTransformer__=__webpack_require__(460);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__stripIndentTransformer__.a})},,,,,function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(258),__esModule:!0}},function(module,exports,__webpack_require__){var anObject=__webpack_require__(14),dPs=__webpack_require__(164),enumBugKeys=__webpack_require__(94),IE_PROTO=__webpack_require__(92)("IE_PROTO"),Empty=function(){},createDict=function(){var iframeDocument,iframe=__webpack_require__(87)("iframe"),i=enumBugKeys.length;for(iframe.style.display="none",__webpack_require__(140).appendChild(iframe),iframe.src="javascript:",(iframeDocument=iframe.contentWindow.document).open(),iframeDocument.write("<script>document.F=Object<\/script>"),iframeDocument.close(),createDict=iframeDocument.F;i--;)delete createDict.prototype[enumBugKeys[i]];return createDict()};module.exports=Object.create||function create(O,Properties){var result;return null!==O?(Empty.prototype=anObject(O),result=new Empty,Empty.prototype=null,result[IE_PROTO]=O):result=createDict(),void 0===Properties?result:dPs(result,Properties)}},function(module,exports,__webpack_require__){var cof=__webpack_require__(45),TAG=__webpack_require__(6)("toStringTag"),ARG="Arguments"==cof(function(){return arguments}());module.exports=function(it){var O,T,B;return void 0===it?"Undefined":null===it?"Null":"string"==typeof(T=function(it,key){try{return it[key]}catch(e){}}(O=Object(it),TAG))?T:ARG?cof(O):"Object"==(B=cof(O))&&"function"==typeof O.callee?"Arguments":B}},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _iterator2=_interopRequireDefault(__webpack_require__(306)),_symbol2=_interopRequireDefault(__webpack_require__(175)),_typeof="function"==typeof _symbol2.default&&"symbol"==typeof _iterator2.default?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof _symbol2.default&&obj.constructor===_symbol2.default&&obj!==_symbol2.default.prototype?"symbol":typeof obj};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default="function"==typeof _symbol2.default&&"symbol"===_typeof(_iterator2.default)?function(obj){return void 0===obj?"undefined":_typeof(obj)}:function(obj){return obj&&"function"==typeof _symbol2.default&&obj.constructor===_symbol2.default&&obj!==_symbol2.default.prototype?"symbol":void 0===obj?"undefined":_typeof(obj)}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(39);module.exports=function(it,S){if(!isObject(it))return it;var fn,val;if(S&&"function"==typeof(fn=it.toString)&&!isObject(val=fn.call(it)))return val;if("function"==typeof(fn=it.valueOf)&&!isObject(val=fn.call(it)))return val;if(!S&&"function"==typeof(fn=it.toString)&&!isObject(val=fn.call(it)))return val;throw TypeError("Can't convert object to primitive value")}},function(module,exports,__webpack_require__){var global=__webpack_require__(19),store=global["__core-js_shared__"]||(global["__core-js_shared__"]={});module.exports=function(key){return store[key]||(store[key]={})}},function(module,exports,__webpack_require__){var def=__webpack_require__(31).f,has=__webpack_require__(20),TAG=__webpack_require__(21)("toStringTag");module.exports=function(it,tag,stat){it&&!has(it=stat?it:it.prototype,TAG)&&def(it,TAG,{configurable:!0,value:tag})}},function(module,exports){module.exports=!1},function(module,exports,__webpack_require__){var $keys=__webpack_require__(121),enumBugKeys=__webpack_require__(83);module.exports=Object.keys||function keys(O){return $keys(O,enumBugKeys)}},function(module,exports){var toString={}.toString;module.exports=function(it){return toString.call(it).slice(8,-1)}},function(module,exports,__webpack_require__){var shared=__webpack_require__(77)("keys"),uid=__webpack_require__(40);module.exports=function(key){return shared[key]||(shared[key]=uid(key))}},function(module,exports){module.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(module,exports){exports.f={}.propertyIsEnumerable},function(module,exports){var has=Object.prototype.hasOwnProperty;module.exports=function assign(target,source){if(Object.assign)return Object.assign(target,source);for(var key in source)has.call(source,key)&&(target[key]=source[key]);return target}},function(module,exports,__webpack_require__){"use strict";module.exports=function requirePromise(){if("function"!=typeof Promise)throw new TypeError("`Promise.prototype.finally` requires a global `Promise` be available.")}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(9),document=__webpack_require__(7).document,is=isObject(document)&&isObject(document.createElement);module.exports=function(it){return is?document.createElement(it):{}}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(9);module.exports=function(it,S){if(!isObject(it))return it;var fn,val;if(S&&"function"==typeof(fn=it.toString)&&!isObject(val=fn.call(it)))return val;if("function"==typeof(fn=it.valueOf)&&!isObject(val=fn.call(it)))return val;if(!S&&"function"==typeof(fn=it.toString)&&!isObject(val=fn.call(it)))return val;throw TypeError("Can't convert object to primitive value")}},function(module,exports,__webpack_require__){var cof=__webpack_require__(45);module.exports=Object("z").propertyIsEnumerable(0)?Object:function(it){return"String"==cof(it)?it.split(""):Object(it)}},function(module,exports){module.exports=function(it){if(void 0==it)throw TypeError("Can't call method on  "+it);return it}},function(module,exports){var ceil=Math.ceil,floor=Math.floor;module.exports=function(it){return isNaN(it=+it)?0:(it>0?floor:ceil)(it)}},function(module,exports,__webpack_require__){var shared=__webpack_require__(93)("keys"),uid=__webpack_require__(63);module.exports=function(key){return shared[key]||(shared[key]=uid(key))}},function(module,exports,__webpack_require__){var global=__webpack_require__(7),store=global["__core-js_shared__"]||(global["__core-js_shared__"]={});module.exports=function(key){return store[key]||(store[key]={})}},function(module,exports){module.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(module,exports){exports.f=Object.getOwnPropertySymbols},function(module,exports,__webpack_require__){var $export=__webpack_require__(5),core=__webpack_require__(1),fails=__webpack_require__(24);module.exports=function(KEY,exec){var fn=(core.Object||{})[KEY]||Object[KEY],exp={};exp[KEY]=exec(fn),$export($export.S+$export.F*fails(function(){fn(1)}),"Object",exp)}},function(module,exports){},function(module,exports){module.exports=function(it,Constructor,name,forbiddenField){if(!(it instanceof Constructor)||void 0!==forbiddenField&&forbiddenField in it)throw TypeError(name+": incorrect invocation!");return it}},function(module,exports,__webpack_require__){var classof=__webpack_require__(74),ITERATOR=__webpack_require__(6)("iterator"),Iterators=__webpack_require__(36);module.exports=__webpack_require__(1).getIteratorMethod=function(it){if(void 0!=it)return it[ITERATOR]||it["@@iterator"]||Iterators[classof(it)]}},function(module,exports,__webpack_require__){"use strict";var aFunction=__webpack_require__(42);module.exports.f=function(C){return new function PromiseCapability(C){var resolve,reject;this.promise=new C(function($$resolve,$$reject){if(void 0!==resolve||void 0!==reject)throw TypeError("Bad Promise constructor");resolve=$$resolve,reject=$$reject}),this.resolve=aFunction(resolve),this.reject=aFunction(reject)}(C)}},function(module,exports,__webpack_require__){var hide=__webpack_require__(23);module.exports=function(target,src,safe){for(var key in src)safe&&target[key]?target[key]=src[key]:hide(target,key,src[key]);return target}},function(module,exports,__webpack_require__){"use strict";!function checkDCE(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(err){console.error(err)}}(),module.exports=__webpack_require__(285)},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__replaceResultTransformer__=__webpack_require__(461);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__replaceResultTransformer__.a})},function(module,exports,__webpack_require__){exports.f=__webpack_require__(6)},function(module,exports,__webpack_require__){var global=__webpack_require__(7),core=__webpack_require__(1),LIBRARY=__webpack_require__(65),wksExt=__webpack_require__(104),defineProperty=__webpack_require__(13).f;module.exports=function(name){var $Symbol=core.Symbol||(core.Symbol=LIBRARY?{}:global.Symbol||{});"_"==name.charAt(0)||name in $Symbol||defineProperty($Symbol,name,{value:wksExt.f(name)})}},,,,function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(264),__esModule:!0}},function(module,exports,__webpack_require__){"use strict";var LIBRARY=__webpack_require__(65),$export=__webpack_require__(5),redefine=__webpack_require__(111),hide=__webpack_require__(23),has=__webpack_require__(25),Iterators=__webpack_require__(36),$iterCreate=__webpack_require__(269),setToStringTag=__webpack_require__(46),getPrototypeOf=__webpack_require__(141),ITERATOR=__webpack_require__(6)("iterator"),BUGGY=!([].keys&&"next"in[].keys()),returnThis=function(){return this};module.exports=function(Base,NAME,Constructor,next,DEFAULT,IS_SET,FORCED){$iterCreate(Constructor,NAME,next);var methods,key,IteratorPrototype,getMethod=function(kind){if(!BUGGY&&kind in proto)return proto[kind];switch(kind){case"keys":return function keys(){return new Constructor(this,kind)};case"values":return function values(){return new Constructor(this,kind)}}return function entries(){return new Constructor(this,kind)}},TAG=NAME+" Iterator",DEF_VALUES="values"==DEFAULT,VALUES_BUG=!1,proto=Base.prototype,$native=proto[ITERATOR]||proto["@@iterator"]||DEFAULT&&proto[DEFAULT],$default=!BUGGY&&$native||getMethod(DEFAULT),$entries=DEFAULT?DEF_VALUES?getMethod("entries"):$default:void 0,$anyNative="Array"==NAME&&proto.entries||$native;if($anyNative&&(IteratorPrototype=getPrototypeOf($anyNative.call(new Base)))!==Object.prototype&&IteratorPrototype.next&&(setToStringTag(IteratorPrototype,TAG,!0),LIBRARY||has(IteratorPrototype,ITERATOR)||hide(IteratorPrototype,ITERATOR,returnThis)),DEF_VALUES&&$native&&"values"!==$native.name&&(VALUES_BUG=!0,$default=function values(){return $native.call(this)}),LIBRARY&&!FORCED||!BUGGY&&!VALUES_BUG&&proto[ITERATOR]||hide(proto,ITERATOR,$default),Iterators[NAME]=$default,Iterators[TAG]=returnThis,DEFAULT)if(methods={values:DEF_VALUES?$default:getMethod("values"),keys:IS_SET?$default:getMethod("keys"),entries:$entries},FORCED)for(key in methods)key in proto||redefine(proto,key,methods[key]);else $export($export.P+$export.F*(BUGGY||VALUES_BUG),NAME,methods);return methods}},function(module,exports,__webpack_require__){module.exports=__webpack_require__(23)},function(module,exports,__webpack_require__){"use strict";var emptyObject={};module.exports=emptyObject},function(module,exports,__webpack_require__){var pIE=__webpack_require__(64),createDesc=__webpack_require__(43),toIObject=__webpack_require__(28),toPrimitive=__webpack_require__(88),has=__webpack_require__(25),IE8_DOM_DEFINE=__webpack_require__(137),gOPD=Object.getOwnPropertyDescriptor;exports.f=__webpack_require__(16)?gOPD:function getOwnPropertyDescriptor(O,P){if(O=toIObject(O),P=toPrimitive(P,!0),IE8_DOM_DEFINE)try{return gOPD(O,P)}catch(e){}if(has(O,P))return createDesc(!pIE.f.call(O,P),O[P])}},,,,function(module,exports,__webpack_require__){var global=__webpack_require__(19),core=__webpack_require__(38),hide=__webpack_require__(30),redefine=__webpack_require__(60),ctx=__webpack_require__(182),$export=function(type,name,source){var key,own,out,exp,IS_FORCED=type&$export.F,IS_GLOBAL=type&$export.G,IS_STATIC=type&$export.S,IS_PROTO=type&$export.P,IS_BIND=type&$export.B,target=IS_GLOBAL?global:IS_STATIC?global[name]||(global[name]={}):(global[name]||{}).prototype,exports=IS_GLOBAL?core:core[name]||(core[name]={}),expProto=exports.prototype||(exports.prototype={});for(key in IS_GLOBAL&&(source=name),source)out=((own=!IS_FORCED&&target&&void 0!==target[key])?target:source)[key],exp=IS_BIND&&own?ctx(out,global):IS_PROTO&&"function"==typeof out?ctx(Function.call,out):out,target&&redefine(target,key,out,type&$export.U),exports[key]!=out&&hide(exports,key,exp),IS_PROTO&&expProto[key]!=out&&(expProto[key]=out)};global.core=core,$export.F=1,$export.G=2,$export.S=4,$export.P=8,$export.B=16,$export.W=32,$export.U=64,$export.R=128,module.exports=$export},function(module,exports,__webpack_require__){module.exports=!__webpack_require__(29)&&!__webpack_require__(57)(function(){return 7!=Object.defineProperty(__webpack_require__(119)("div"),"a",{get:function(){return 7}}).a})},function(module,exports,__webpack_require__){var isObject=__webpack_require__(39),document=__webpack_require__(19).document,is=isObject(document)&&isObject(document.createElement);module.exports=function(it){return is?document.createElement(it):{}}},function(module,exports,__webpack_require__){exports.f=__webpack_require__(21)},function(module,exports,__webpack_require__){var has=__webpack_require__(20),toIObject=__webpack_require__(32),arrayIndexOf=__webpack_require__(188)(!1),IE_PROTO=__webpack_require__(82)("IE_PROTO");module.exports=function(object,names){var key,O=toIObject(object),i=0,result=[];for(key in O)key!=IE_PROTO&&has(O,key)&&result.push(key);for(;names.length>i;)has(O,key=names[i++])&&(~arrayIndexOf(result,key)||result.push(key));return result}},function(module,exports){module.exports=function(it){if(void 0==it)throw TypeError("Can't call method on  "+it);return it}},function(module,exports){var ceil=Math.ceil,floor=Math.floor;module.exports=function(it){return isNaN(it=+it)?0:(it>0?floor:ceil)(it)}},function(module,exports){exports.f=Object.getOwnPropertySymbols},function(module,exports,__webpack_require__){var anObject=__webpack_require__(58),dPs=__webpack_require__(192),enumBugKeys=__webpack_require__(83),IE_PROTO=__webpack_require__(82)("IE_PROTO"),Empty=function(){},createDict=function(){var iframeDocument,iframe=__webpack_require__(119)("iframe"),i=enumBugKeys.length;for(iframe.style.display="none",__webpack_require__(193).appendChild(iframe),iframe.src="javascript:",(iframeDocument=iframe.contentWindow.document).open(),iframeDocument.write("<script>document.F=Object<\/script>"),iframeDocument.close(),createDict=iframeDocument.F;i--;)delete createDict.prototype[enumBugKeys[i]];return createDict()};module.exports=Object.create||function create(O,Properties){var result;return null!==O?(Empty.prototype=anObject(O),result=new Empty,Empty.prototype=null,result[IE_PROTO]=O):result=createDict(),void 0===Properties?result:dPs(result,Properties)}},function(module,exports,__webpack_require__){var $keys=__webpack_require__(121),hiddenKeys=__webpack_require__(83).concat("length","prototype");exports.f=Object.getOwnPropertyNames||function getOwnPropertyNames(O){return $keys(O,hiddenKeys)}},function(module,exports){module.exports={}},function(module,exports){module.exports="string"==typeof function foo(){}.name},function(module,exports,__webpack_require__){"use strict";var has=__webpack_require__(41),toPrimitive=__webpack_require__(225),toStr=Object.prototype.toString,hasSymbols="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator,$isNaN=__webpack_require__(131),$isFinite=__webpack_require__(132),MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,assign=__webpack_require__(85),sign=__webpack_require__(133),mod=__webpack_require__(134),isPrimitive=__webpack_require__(228),parseInteger=parseInt,bind=__webpack_require__(22),arraySlice=bind.call(Function.call,Array.prototype.slice),strSlice=bind.call(Function.call,String.prototype.slice),isBinary=bind.call(Function.call,RegExp.prototype.test,/^0b[01]+$/i),isOctal=bind.call(Function.call,RegExp.prototype.test,/^0o[0-7]+$/i),regexExec=bind.call(Function.call,RegExp.prototype.exec),nonWS=["","​","￾"].join(""),nonWSregex=new RegExp("["+nonWS+"]","g"),hasNonWS=bind.call(Function.call,RegExp.prototype.test,nonWSregex),isInvalidHexLiteral=bind.call(Function.call,RegExp.prototype.test,/^[-+]0x[0-9a-f]+$/i),ws=["\t\n\v\f\r   ᠎    ","         　\u2028","\u2029\ufeff"].join(""),trimRegex=new RegExp("(^["+ws+"]+)|(["+ws+"]+$)","g"),replace=bind.call(Function.call,String.prototype.replace),ES5=__webpack_require__(229),hasRegExpMatcher=__webpack_require__(231),ES6=assign(assign({},ES5),{Call:function Call(F,V){var args=arguments.length>2?arguments[2]:[];if(!this.IsCallable(F))throw new TypeError(F+" is not a function");return F.apply(V,args)},ToPrimitive:toPrimitive,ToNumber:function ToNumber(argument){var value=isPrimitive(argument)?argument:toPrimitive(argument,Number);if("symbol"==typeof value)throw new TypeError("Cannot convert a Symbol value to a number");if("string"==typeof value){if(isBinary(value))return this.ToNumber(parseInteger(strSlice(value,2),2));if(isOctal(value))return this.ToNumber(parseInteger(strSlice(value,2),8));if(hasNonWS(value)||isInvalidHexLiteral(value))return NaN;var trimmed=function(value){return replace(value,trimRegex,"")}(value);if(trimmed!==value)return this.ToNumber(trimmed)}return Number(value)},ToInt16:function ToInt16(argument){var int16bit=this.ToUint16(argument);return int16bit>=32768?int16bit-65536:int16bit},ToInt8:function ToInt8(argument){var int8bit=this.ToUint8(argument);return int8bit>=128?int8bit-256:int8bit},ToUint8:function ToUint8(argument){var number=this.ToNumber(argument);if($isNaN(number)||0===number||!$isFinite(number))return 0;var posInt=sign(number)*Math.floor(Math.abs(number));return mod(posInt,256)},ToUint8Clamp:function ToUint8Clamp(argument){var number=this.ToNumber(argument);if($isNaN(number)||number<=0)return 0;if(number>=255)return 255;var f=Math.floor(argument);return f+.5<number?f+1:number<f+.5?f:f%2!=0?f+1:f},ToString:function ToString(argument){if("symbol"==typeof argument)throw new TypeError("Cannot convert a Symbol value to a string");return String(argument)},ToObject:function ToObject(value){return this.RequireObjectCoercible(value),Object(value)},ToPropertyKey:function ToPropertyKey(argument){var key=this.ToPrimitive(argument,String);return"symbol"==typeof key?key:this.ToString(key)},ToLength:function ToLength(argument){var len=this.ToInteger(argument);return len<=0?0:len>MAX_SAFE_INTEGER?MAX_SAFE_INTEGER:len},CanonicalNumericIndexString:function CanonicalNumericIndexString(argument){if("[object String]"!==toStr.call(argument))throw new TypeError("must be a string");if("-0"===argument)return-0;var n=this.ToNumber(argument);return this.SameValue(this.ToString(n),argument)?n:void 0},RequireObjectCoercible:ES5.CheckObjectCoercible,IsArray:Array.isArray||function IsArray(argument){return"[object Array]"===toStr.call(argument)},IsConstructor:function IsConstructor(argument){return"function"==typeof argument&&!!argument.prototype},IsExtensible:function IsExtensible(obj){return!Object.preventExtensions||!isPrimitive(obj)&&Object.isExtensible(obj)},IsInteger:function IsInteger(argument){if("number"!=typeof argument||$isNaN(argument)||!$isFinite(argument))return!1;var abs=Math.abs(argument);return Math.floor(abs)===abs},IsPropertyKey:function IsPropertyKey(argument){return"string"==typeof argument||"symbol"==typeof argument},IsRegExp:function IsRegExp(argument){if(!argument||"object"!=typeof argument)return!1;if(hasSymbols){var isRegExp=argument[Symbol.match];if(void 0!==isRegExp)return ES5.ToBoolean(isRegExp)}return hasRegExpMatcher(argument)},SameValueZero:function SameValueZero(x,y){return x===y||$isNaN(x)&&$isNaN(y)},GetV:function GetV(V,P){if(!this.IsPropertyKey(P))throw new TypeError("Assertion failed: IsPropertyKey(P) is not true");return this.ToObject(V)[P]},GetMethod:function GetMethod(O,P){if(!this.IsPropertyKey(P))throw new TypeError("Assertion failed: IsPropertyKey(P) is not true");var func=this.GetV(O,P);if(null!=func){if(!this.IsCallable(func))throw new TypeError(P+"is not a function");return func}},Get:function Get(O,P){if("Object"!==this.Type(O))throw new TypeError("Assertion failed: Type(O) is not Object");if(!this.IsPropertyKey(P))throw new TypeError("Assertion failed: IsPropertyKey(P) is not true");return O[P]},Type:function Type(x){return"symbol"==typeof x?"Symbol":ES5.Type(x)},SpeciesConstructor:function SpeciesConstructor(O,defaultConstructor){if("Object"!==this.Type(O))throw new TypeError("Assertion failed: Type(O) is not Object");var C=O.constructor;if(void 0===C)return defaultConstructor;if("Object"!==this.Type(C))throw new TypeError("O.constructor is not an Object");var S=hasSymbols&&Symbol.species?C[Symbol.species]:void 0;if(null==S)return defaultConstructor;if(this.IsConstructor(S))return S;throw new TypeError("no constructor found")},CompletePropertyDescriptor:function CompletePropertyDescriptor(Desc){if(!this.IsPropertyDescriptor(Desc))throw new TypeError("Desc must be a Property Descriptor");return this.IsGenericDescriptor(Desc)||this.IsDataDescriptor(Desc)?(has(Desc,"[[Value]]")||(Desc["[[Value]]"]=void 0),has(Desc,"[[Writable]]")||(Desc["[[Writable]]"]=!1)):(has(Desc,"[[Get]]")||(Desc["[[Get]]"]=void 0),has(Desc,"[[Set]]")||(Desc["[[Set]]"]=void 0)),has(Desc,"[[Enumerable]]")||(Desc["[[Enumerable]]"]=!1),has(Desc,"[[Configurable]]")||(Desc["[[Configurable]]"]=!1),Desc},Set:function Set(O,P,V,Throw){if("Object"!==this.Type(O))throw new TypeError("O must be an Object");if(!this.IsPropertyKey(P))throw new TypeError("P must be a Property Key");if("Boolean"!==this.Type(Throw))throw new TypeError("Throw must be a Boolean");if(Throw)return O[P]=V,!0;try{O[P]=V}catch(e){return!1}},HasOwnProperty:function HasOwnProperty(O,P){if("Object"!==this.Type(O))throw new TypeError("O must be an Object");if(!this.IsPropertyKey(P))throw new TypeError("P must be a Property Key");return has(O,P)},HasProperty:function HasProperty(O,P){if("Object"!==this.Type(O))throw new TypeError("O must be an Object");if(!this.IsPropertyKey(P))throw new TypeError("P must be a Property Key");return P in O},IsConcatSpreadable:function IsConcatSpreadable(O){if("Object"!==this.Type(O))return!1;if(hasSymbols&&"symbol"==typeof Symbol.isConcatSpreadable){var spreadable=this.Get(O,Symbol.isConcatSpreadable);if(void 0!==spreadable)return this.ToBoolean(spreadable)}return this.IsArray(O)},Invoke:function Invoke(O,P){if(!this.IsPropertyKey(P))throw new TypeError("P must be a Property Key");var argumentsList=arraySlice(arguments,2),func=this.GetV(O,P);return this.Call(func,O,argumentsList)},CreateIterResultObject:function CreateIterResultObject(value,done){if("Boolean"!==this.Type(done))throw new TypeError("Assertion failed: Type(done) is not Boolean");return{value:value,done:done}},RegExpExec:function RegExpExec(R,S){if("Object"!==this.Type(R))throw new TypeError("R must be an Object");if("String"!==this.Type(S))throw new TypeError("S must be a String");var exec=this.Get(R,"exec");if(this.IsCallable(exec)){var result=this.Call(exec,R,[S]);if(null===result||"Object"===this.Type(result))return result;throw new TypeError('"exec" method must return `null` or an Object')}return regexExec(R,S)},ArraySpeciesCreate:function ArraySpeciesCreate(originalArray,length){if(!this.IsInteger(length)||length<0)throw new TypeError("Assertion failed: length must be an integer >= 0");var C,len=0===length?0:length;if(this.IsArray(originalArray)&&(C=this.Get(originalArray,"constructor"),"Object"===this.Type(C)&&hasSymbols&&Symbol.species&&null===(C=this.Get(C,Symbol.species))&&(C=void 0)),void 0===C)return Array(len);if(!this.IsConstructor(C))throw new TypeError("C must be a constructor");return new C(len)},CreateDataProperty:function CreateDataProperty(O,P,V){if("Object"!==this.Type(O))throw new TypeError("Assertion failed: Type(O) is not Object");if(!this.IsPropertyKey(P))throw new TypeError("Assertion failed: IsPropertyKey(P) is not true");var oldDesc=Object.getOwnPropertyDescriptor(O,P),extensible=oldDesc||"function"!=typeof Object.isExtensible||Object.isExtensible(O);if(oldDesc&&(!oldDesc.writable||!oldDesc.configurable)||!extensible)return!1;var newDesc={configurable:!0,enumerable:!0,value:V,writable:!0};return Object.defineProperty(O,P,newDesc),!0},CreateDataPropertyOrThrow:function CreateDataPropertyOrThrow(O,P,V){if("Object"!==this.Type(O))throw new TypeError("Assertion failed: Type(O) is not Object");if(!this.IsPropertyKey(P))throw new TypeError("Assertion failed: IsPropertyKey(P) is not true");var success=this.CreateDataProperty(O,P,V);if(!success)throw new TypeError("unable to create data property");return success},AdvanceStringIndex:function AdvanceStringIndex(S,index,unicode){if("String"!==this.Type(S))throw new TypeError("Assertion failed: Type(S) is not String");if(!this.IsInteger(index))throw new TypeError("Assertion failed: length must be an integer >= 0 and <= (2**53 - 1)");if(index<0||index>MAX_SAFE_INTEGER)throw new RangeError("Assertion failed: length must be an integer >= 0 and <= (2**53 - 1)");if("Boolean"!==this.Type(unicode))throw new TypeError("Assertion failed: Type(unicode) is not Boolean");if(!unicode)return index+1;if(index+1>=S.length)return index+1;var first=S.charCodeAt(index);if(first<55296||first>56319)return index+1;var second=S.charCodeAt(index+1);return second<56320||second>57343?index+1:index+2}});delete ES6.CheckObjectCoercible,module.exports=ES6},function(module,exports){module.exports=function isPrimitive(value){return null===value||"function"!=typeof value&&"object"!=typeof value}},function(module,exports){module.exports=Number.isNaN||function isNaN(a){return a!=a}},function(module,exports){var $isNaN=Number.isNaN||function(a){return a!=a};module.exports=Number.isFinite||function(x){return"number"==typeof x&&!$isNaN(x)&&x!==1/0&&x!==-1/0}},function(module,exports){module.exports=function sign(number){return number>=0?1:-1}},function(module,exports){module.exports=function mod(number,modulo){var remain=number%modulo;return Math.floor(remain>=0?remain:remain+modulo)}},function(module,exports,__webpack_require__){"use strict";var ES2015=__webpack_require__(129),assign=__webpack_require__(85),ES2016=assign(assign({},ES2015),{SameValueNonNumber:function SameValueNonNumber(x,y){if("number"==typeof x||typeof x!=typeof y)throw new TypeError("SameValueNonNumber requires two non-number values of the same type.");return this.SameValue(x,y)}});module.exports=ES2016},function(module,exports,__webpack_require__){"use strict";var ES2016=__webpack_require__(135),assign=__webpack_require__(85),ES2017=assign(assign({},ES2016),{ToIndex:function ToIndex(value){if(void 0===value)return 0;var integerIndex=this.ToInteger(value);if(integerIndex<0)throw new RangeError("index must be >= 0");var index=this.ToLength(integerIndex);if(!this.SameValueZero(integerIndex,index))throw new RangeError("index must be >= 0 and < 2 ** 53 - 1");return index}});delete ES2017.EnumerableOwnNames,module.exports=ES2017},function(module,exports,__webpack_require__){module.exports=!__webpack_require__(16)&&!__webpack_require__(24)(function(){return 7!=Object.defineProperty(__webpack_require__(87)("div"),"a",{get:function(){return 7}}).a})},function(module,exports,__webpack_require__){var has=__webpack_require__(25),toIObject=__webpack_require__(28),arrayIndexOf=__webpack_require__(260)(!1),IE_PROTO=__webpack_require__(92)("IE_PROTO");module.exports=function(object,names){var key,O=toIObject(object),i=0,result=[];for(key in O)key!=IE_PROTO&&has(O,key)&&result.push(key);for(;names.length>i;)has(O,key=names[i++])&&(~arrayIndexOf(result,key)||result.push(key));return result}},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(267),__esModule:!0}},function(module,exports,__webpack_require__){var document=__webpack_require__(7).document;module.exports=document&&document.documentElement},function(module,exports,__webpack_require__){var has=__webpack_require__(25),toObject=__webpack_require__(34),IE_PROTO=__webpack_require__(92)("IE_PROTO"),ObjectProto=Object.prototype;module.exports=Object.getPrototypeOf||function(O){return O=toObject(O),has(O,IE_PROTO)?O[IE_PROTO]:"function"==typeof O.constructor&&O instanceof O.constructor?O.constructor.prototype:O instanceof Object?ObjectProto:null}},function(module,exports,__webpack_require__){var anObject=__webpack_require__(14);module.exports=function(iterator,fn,value,entries){try{return entries?fn(anObject(value)[0],value[1]):fn(value)}catch(e){var ret=iterator.return;throw void 0!==ret&&anObject(ret.call(iterator)),e}}},function(module,exports,__webpack_require__){var Iterators=__webpack_require__(36),ITERATOR=__webpack_require__(6)("iterator"),ArrayProto=Array.prototype;module.exports=function(it){return void 0!==it&&(Iterators.Array===it||ArrayProto[ITERATOR]===it)}},function(module,exports,__webpack_require__){var anObject=__webpack_require__(14),aFunction=__webpack_require__(42),SPECIES=__webpack_require__(6)("species");module.exports=function(O,D){var S,C=anObject(O).constructor;return void 0===C||void 0==(S=anObject(C)[SPECIES])?D:aFunction(S)}},function(module,exports,__webpack_require__){var defer,channel,port,ctx=__webpack_require__(18),invoke=__webpack_require__(273),html=__webpack_require__(140),cel=__webpack_require__(87),global=__webpack_require__(7),process=global.process,setTask=global.setImmediate,clearTask=global.clearImmediate,MessageChannel=global.MessageChannel,Dispatch=global.Dispatch,counter=0,queue={},run=function(){var id=+this;if(queue.hasOwnProperty(id)){var fn=queue[id];delete queue[id],fn()}},listener=function(event){run.call(event.data)};setTask&&clearTask||(setTask=function setImmediate(fn){for(var args=[],i=1;arguments.length>i;)args.push(arguments[i++]);return queue[++counter]=function(){invoke("function"==typeof fn?fn:Function(fn),args)},defer(counter),counter},clearTask=function clearImmediate(id){delete queue[id]},"process"==__webpack_require__(45)(process)?defer=function(id){process.nextTick(ctx(run,id,1))}:Dispatch&&Dispatch.now?defer=function(id){Dispatch.now(ctx(run,id,1))}:MessageChannel?(port=(channel=new MessageChannel).port2,channel.port1.onmessage=listener,defer=ctx(port.postMessage,port,1)):global.addEventListener&&"function"==typeof postMessage&&!global.importScripts?(defer=function(id){global.postMessage(id+"","*")},global.addEventListener("message",listener,!1)):defer="onreadystatechange"in cel("script")?function(id){html.appendChild(cel("script")).onreadystatechange=function(){html.removeChild(this),run.call(id)}}:function(id){setTimeout(ctx(run,id,1),0)}),module.exports={set:setTask,clear:clearTask}},function(module,exports){module.exports=function(exec){try{return{e:!1,v:exec()}}catch(e){return{e:!0,v:e}}}},function(module,exports,__webpack_require__){var anObject=__webpack_require__(14),isObject=__webpack_require__(9),newPromiseCapability=__webpack_require__(100);module.exports=function(C,x){if(anObject(C),isObject(x)&&x.constructor===C)return x;var promiseCapability=newPromiseCapability.f(C);return(0,promiseCapability.resolve)(x),promiseCapability.promise}},function(module,exports,__webpack_require__){var ITERATOR=__webpack_require__(6)("iterator"),SAFE_CLOSING=!1;try{var riter=[7][ITERATOR]();riter.return=function(){SAFE_CLOSING=!0},Array.from(riter,function(){throw 2})}catch(e){}module.exports=function(exec,skipClosing){if(!skipClosing&&!SAFE_CLOSING)return!1;var safe=!1;try{var arr=[7],iter=arr[ITERATOR]();iter.next=function(){return{done:safe=!0}},arr[ITERATOR]=function(){return iter},exec(arr)}catch(e){}return safe}},function(module,exports,__webpack_require__){"use strict";var stringify=__webpack_require__(282),parse=__webpack_require__(283),formats=__webpack_require__(151);module.exports={formats:formats,parse:parse,stringify:stringify}},function(module,exports,__webpack_require__){"use strict";var has=Object.prototype.hasOwnProperty,hexTable=function(){for(var array=[],i=0;i<256;++i)array.push("%"+((i<16?"0":"")+i.toString(16)).toUpperCase());return array}();exports.arrayToObject=function arrayToObject(source,options){for(var obj=options&&options.plainObjects?Object.create(null):{},i=0;i<source.length;++i)void 0!==source[i]&&(obj[i]=source[i]);return obj},exports.merge=function merge(target,source,options){if(!source)return target;if("object"!=typeof source){if(Array.isArray(target))target.push(source);else{if("object"!=typeof target)return[target,source];(options.plainObjects||options.allowPrototypes||!has.call(Object.prototype,source))&&(target[source]=!0)}return target}if("object"!=typeof target)return[target].concat(source);var mergeTarget=target;return Array.isArray(target)&&!Array.isArray(source)&&(mergeTarget=exports.arrayToObject(target,options)),Array.isArray(target)&&Array.isArray(source)?(source.forEach(function(item,i){has.call(target,i)?target[i]&&"object"==typeof target[i]?target[i]=exports.merge(target[i],item,options):target.push(item):target[i]=item}),target):Object.keys(source).reduce(function(acc,key){var value=source[key];return has.call(acc,key)?acc[key]=exports.merge(acc[key],value,options):acc[key]=value,acc},mergeTarget)},exports.assign=function assignSingleSource(target,source){return Object.keys(source).reduce(function(acc,key){return acc[key]=source[key],acc},target)},exports.decode=function(str){try{return decodeURIComponent(str.replace(/\+/g," "))}catch(e){return str}},exports.encode=function encode(str){if(0===str.length)return str;for(var string="string"==typeof str?str:String(str),out="",i=0;i<string.length;++i){var c=string.charCodeAt(i);45===c||46===c||95===c||126===c||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122?out+=string.charAt(i):c<128?out+=hexTable[c]:c<2048?out+=hexTable[192|c>>6]+hexTable[128|63&c]:c<55296||c>=57344?out+=hexTable[224|c>>12]+hexTable[128|c>>6&63]+hexTable[128|63&c]:(i+=1,c=65536+((1023&c)<<10|1023&string.charCodeAt(i)),out+=hexTable[240|c>>18]+hexTable[128|c>>12&63]+hexTable[128|c>>6&63]+hexTable[128|63&c])}return out},exports.compact=function compact(value){for(var queue=[{obj:{o:value},prop:"o"}],refs=[],i=0;i<queue.length;++i)for(var item=queue[i],obj=item.obj[item.prop],keys=Object.keys(obj),j=0;j<keys.length;++j){var key=keys[j],val=obj[key];"object"==typeof val&&null!==val&&-1===refs.indexOf(val)&&(queue.push({obj:obj,prop:key}),refs.push(val))}return function compactQueue(queue){for(var obj;queue.length;){var item=queue.pop();if(obj=item.obj[item.prop],Array.isArray(obj)){for(var compacted=[],j=0;j<obj.length;++j)void 0!==obj[j]&&compacted.push(obj[j]);item.obj[item.prop]=compacted}}return obj}(queue)},exports.isRegExp=function isRegExp(obj){return"[object RegExp]"===Object.prototype.toString.call(obj)},exports.isBuffer=function isBuffer(obj){return null!==obj&&void 0!==obj&&!!(obj.constructor&&obj.constructor.isBuffer&&obj.constructor.isBuffer(obj))}},function(module,exports,__webpack_require__){"use strict";var replace=String.prototype.replace,percentTwenties=/%20/g;module.exports={default:"RFC3986",formatters:{RFC1738:function(value){return replace.call(value,percentTwenties,"+")},RFC3986:function(value){return value}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},function(module,exports,__webpack_require__){var cof=__webpack_require__(45);module.exports=Array.isArray||function isArray(arg){return"Array"==cof(arg)}},function(module,exports,__webpack_require__){var $keys=__webpack_require__(138),hiddenKeys=__webpack_require__(94).concat("length","prototype");exports.f=Object.getOwnPropertyNames||function getOwnPropertyNames(O){return $keys(O,hiddenKeys)}},function(module,exports,__webpack_require__){var ctx=__webpack_require__(18),IObject=__webpack_require__(89),toObject=__webpack_require__(34),toLength=__webpack_require__(62),asc=__webpack_require__(314);module.exports=function(TYPE,$create){var IS_MAP=1==TYPE,IS_FILTER=2==TYPE,IS_SOME=3==TYPE,IS_EVERY=4==TYPE,IS_FIND_INDEX=6==TYPE,NO_HOLES=5==TYPE||IS_FIND_INDEX,create=$create||asc;return function($this,callbackfn,that){for(var val,res,O=toObject($this),self=IObject(O),f=ctx(callbackfn,that,3),length=toLength(self.length),index=0,result=IS_MAP?create($this,length):IS_FILTER?create($this,0):void 0;length>index;index++)if((NO_HOLES||index in self)&&(res=f(val=self[index],index,O),TYPE))if(IS_MAP)result[index]=res;else if(res)switch(TYPE){case 3:return!0;case 5:return val;case 6:return index;case 2:result.push(val)}else if(IS_EVERY)return!1;return IS_FIND_INDEX?-1:IS_SOME||IS_EVERY?IS_EVERY:result}}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(9);module.exports=function(it,TYPE){if(!isObject(it)||it._t!==TYPE)throw TypeError("Incompatible receiver, "+TYPE+" required!");return it}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _preview=__webpack_require__(330);Object.defineProperty(exports,"linkTo",{enumerable:!0,get:function get(){return _preview.linkTo}}),Object.defineProperty(exports,"hrefTo",{enumerable:!0,get:function get(){return _preview.hrefTo}}),exports.LinkTo=function LinkTo(){hasWarned||(console.error("\nLinkTo has moved to addon-links/react:\n\nimport LinkTo from '@storybook/addon-links/react';\n    "),hasWarned=!0);return null};var ADDON_ID=exports.ADDON_ID="storybook/links",hasWarned=(exports.EVENT_ID=ADDON_ID+"/link-event",exports.REQUEST_HREF_EVENT_ID=ADDON_ID+"/request-href-event",exports.RECEIVE_HREF_EVENT_ID=ADDON_ID+"/receive-href-event",!1)},,,,,,function(module,exports){module.exports=function(module){return module.webpackPolyfill||(module.deprecate=function(){},module.paths=[],module.children||(module.children=[]),Object.defineProperty(module,"loaded",{enumerable:!0,get:function(){return module.l}}),Object.defineProperty(module,"id",{enumerable:!0,get:function(){return module.i}}),module.webpackPolyfill=1),module}},function(module,exports,__webpack_require__){"use strict";var getKeys=__webpack_require__(44),gOPS=__webpack_require__(95),pIE=__webpack_require__(64),toObject=__webpack_require__(34),IObject=__webpack_require__(89),$assign=Object.assign;module.exports=!$assign||__webpack_require__(24)(function(){var A={},B={},S=Symbol(),K="abcdefghijklmnopqrst";return A[S]=7,K.split("").forEach(function(k){B[k]=k}),7!=$assign({},A)[S]||Object.keys($assign({},B)).join("")!=K})?function assign(target,source){for(var T=toObject(target),aLen=arguments.length,index=1,getSymbols=gOPS.f,isEnum=pIE.f;aLen>index;)for(var key,S=IObject(arguments[index++]),keys=getSymbols?getKeys(S).concat(getSymbols(S)):getKeys(S),length=keys.length,j=0;length>j;)isEnum.call(S,key=keys[j++])&&(T[key]=S[key]);return T}:$assign},function(module,exports,__webpack_require__){var dP=__webpack_require__(13),anObject=__webpack_require__(14),getKeys=__webpack_require__(44);module.exports=__webpack_require__(16)?Object.defineProperties:function defineProperties(O,Properties){anObject(O);for(var P,keys=getKeys(Properties),length=keys.length,i=0;length>i;)dP.f(O,P=keys[i++],Properties[P]);return O}},function(module,exports){module.exports=function(done,value){return{value:value,done:!!done}}},function(module,exports,__webpack_require__){"use strict";var global=__webpack_require__(7),core=__webpack_require__(1),dP=__webpack_require__(13),DESCRIPTORS=__webpack_require__(16),SPECIES=__webpack_require__(6)("species");module.exports=function(KEY){var C="function"==typeof core[KEY]?core[KEY]:global[KEY];DESCRIPTORS&&C&&!C[SPECIES]&&dP.f(C,SPECIES,{configurable:!0,get:function(){return this}})}},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(278),__esModule:!0}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setInitialStory=function setInitialStory(storyKindList){return{type:types.SET_INITIAL_STORY,storyKindList:storyKindList}},exports.setError=function setError(error){return{type:types.SET_ERROR,error:error}},exports.clearError=function clearError(){return{type:types.CLEAR_ERROR}},exports.selectStory=function selectStory(kind,story){return{type:types.SELECT_STORY,kind:kind,story:story}};var types=exports.types={SET_ERROR:"PREVIEW_SET_ERROR",CLEAR_ERROR:"PREVIEW_CLEAR_ERROR",SELECT_STORY:"PREVIEW_SELECT_STORY",SET_INITIAL_STORY:"PREVIEW_SET_INITIAL_STORY"}},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _isIterable3=_interopRequireDefault(__webpack_require__(296)),_getIterator3=_interopRequireDefault(__webpack_require__(170));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=function(){return function(arr,i){if(Array.isArray(arr))return arr;if((0,_isIterable3.default)(Object(arr)))return function sliceIterator(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=(0,_getIterator3.default)(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{!_n&&_i.return&&_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(299),__esModule:!0}},function(module,exports,__webpack_require__){"use strict";var validateFormat=function validateFormat(format){};module.exports=function invariant(condition,format,a,b,c,d,e,f){if(validateFormat(format),!condition){var error;if(void 0===format)error=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var args=[a,b,c,d,e,f],argIndex=0;(error=new Error(format.replace(/%s/g,function(){return args[argIndex++]}))).name="Invariant Violation"}throw error.framesToPop=1,error}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.features=void 0,exports.isModifierPressed=isModifierPressed,exports.default=function handle(e){if(e.keyCode===(0,_keycode2.default)("escape"))return features.ESCAPE;if(function focusInInput(e){return/input|textarea/i.test(e.target.tagName)||null!==e.target.getAttribute("contenteditable")}(e))return!1;if(!isModifierPressed(e))return!1;switch(e.keyCode){case(0,_keycode2.default)("F"):return e.preventDefault(),features.FULLSCREEN;case(0,_keycode2.default)("C"):case(0,_keycode2.default)("D"):return e.preventDefault(),features.ADDON_PANEL;case(0,_keycode2.default)("X"):case(0,_keycode2.default)("L"):return e.preventDefault(),features.STORIES_PANEL;case(0,_keycode2.default)("right"):return e.preventDefault(),features.NEXT_STORY;case(0,_keycode2.default)("left"):return e.preventDefault(),features.PREV_STORY;case(0,_keycode2.default)("O"):case(0,_keycode2.default)("P"):return e.preventDefault(),features.SHOW_SEARCH;case(0,_keycode2.default)("G"):case(0,_keycode2.default)("J"):return e.preventDefault(),features.ADDON_PANEL_IN_RIGHT;default:return!1}};var _keycode2=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(303));var features=exports.features={FULLSCREEN:"FULLSCREEN",ADDON_PANEL:"ADDON_PANEL",STORIES_PANEL:"STORIES_PANEL",SHORTCUTS_HELP:"SHORTCUTS_HELP",ESCAPE:"ESCAPE",NEXT_STORY:"NEXT_STORY",PREV_STORY:"PREV_STORY",SHOW_SEARCH:"SHOW_SEARCH",ADDON_PANEL_IN_RIGHT:"ADDON_PANEL_IN_RIGHT"};function isModifierPressed(e){return(e.ctrlKey||91===e.keyCode||e.metaKey)&&e.shiftKey}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.typeReplacer=exports.typeReviver=exports.prepareArguments=exports.muteProperty=exports.isObject=exports.getPropertiesList=exports.canConfigureName=void 0;var _canConfigureName3=_interopRequireDefault(__webpack_require__(363)),_getPropertiesList3=_interopRequireDefault(__webpack_require__(511)),_isObject3=_interopRequireDefault(__webpack_require__(512)),_muteProperty3=_interopRequireDefault(__webpack_require__(513)),_prepareArguments3=_interopRequireDefault(__webpack_require__(514)),_typeReviver3=_interopRequireDefault(__webpack_require__(546)),_typeReplacer3=_interopRequireDefault(__webpack_require__(547));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.canConfigureName=_canConfigureName3.default,exports.getPropertiesList=_getPropertiesList3.default,exports.isObject=_isObject3.default,exports.muteProperty=_muteProperty3.default,exports.prepareArguments=_prepareArguments3.default,exports.typeReviver=_typeReviver3.default,exports.typeReplacer=_typeReplacer3.default},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(304),__esModule:!0}},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(308),__esModule:!0}},,,,function(module,exports,__webpack_require__){"use strict";__webpack_require__(180),__webpack_require__(198),__webpack_require__(206)},function(module,exports,__webpack_require__){__webpack_require__(181),__webpack_require__(196),module.exports=__webpack_require__(38).Symbol},function(module,exports,__webpack_require__){"use strict";var global=__webpack_require__(19),has=__webpack_require__(20),DESCRIPTORS=__webpack_require__(29),$export=__webpack_require__(117),redefine=__webpack_require__(60),META=__webpack_require__(184).KEY,$fails=__webpack_require__(57),shared=__webpack_require__(77),setToStringTag=__webpack_require__(78),uid=__webpack_require__(40),wks=__webpack_require__(21),wksExt=__webpack_require__(120),wksDefine=__webpack_require__(185),enumKeys=__webpack_require__(186),isArray=__webpack_require__(191),anObject=__webpack_require__(58),isObject=__webpack_require__(39),toIObject=__webpack_require__(32),toPrimitive=__webpack_require__(76),createDesc=__webpack_require__(59),_create=__webpack_require__(125),gOPNExt=__webpack_require__(194),$GOPD=__webpack_require__(195),$DP=__webpack_require__(31),$keys=__webpack_require__(80),gOPD=$GOPD.f,dP=$DP.f,gOPN=gOPNExt.f,$Symbol=global.Symbol,$JSON=global.JSON,_stringify=$JSON&&$JSON.stringify,HIDDEN=wks("_hidden"),TO_PRIMITIVE=wks("toPrimitive"),isEnum={}.propertyIsEnumerable,SymbolRegistry=shared("symbol-registry"),AllSymbols=shared("symbols"),OPSymbols=shared("op-symbols"),ObjectProto=Object.prototype,USE_NATIVE="function"==typeof $Symbol,QObject=global.QObject,setter=!QObject||!QObject.prototype||!QObject.prototype.findChild,setSymbolDesc=DESCRIPTORS&&$fails(function(){return 7!=_create(dP({},"a",{get:function(){return dP(this,"a",{value:7}).a}})).a})?function(it,key,D){var protoDesc=gOPD(ObjectProto,key);protoDesc&&delete ObjectProto[key],dP(it,key,D),protoDesc&&it!==ObjectProto&&dP(ObjectProto,key,protoDesc)}:dP,wrap=function(tag){var sym=AllSymbols[tag]=_create($Symbol.prototype);return sym._k=tag,sym},isSymbol=USE_NATIVE&&"symbol"==typeof $Symbol.iterator?function(it){return"symbol"==typeof it}:function(it){return it instanceof $Symbol},$defineProperty=function defineProperty(it,key,D){return it===ObjectProto&&$defineProperty(OPSymbols,key,D),anObject(it),key=toPrimitive(key,!0),anObject(D),has(AllSymbols,key)?(D.enumerable?(has(it,HIDDEN)&&it[HIDDEN][key]&&(it[HIDDEN][key]=!1),D=_create(D,{enumerable:createDesc(0,!1)})):(has(it,HIDDEN)||dP(it,HIDDEN,createDesc(1,{})),it[HIDDEN][key]=!0),setSymbolDesc(it,key,D)):dP(it,key,D)},$defineProperties=function defineProperties(it,P){anObject(it);for(var key,keys=enumKeys(P=toIObject(P)),i=0,l=keys.length;l>i;)$defineProperty(it,key=keys[i++],P[key]);return it},$propertyIsEnumerable=function propertyIsEnumerable(key){var E=isEnum.call(this,key=toPrimitive(key,!0));return!(this===ObjectProto&&has(AllSymbols,key)&&!has(OPSymbols,key))&&(!(E||!has(this,key)||!has(AllSymbols,key)||has(this,HIDDEN)&&this[HIDDEN][key])||E)},$getOwnPropertyDescriptor=function getOwnPropertyDescriptor(it,key){if(it=toIObject(it),key=toPrimitive(key,!0),it!==ObjectProto||!has(AllSymbols,key)||has(OPSymbols,key)){var D=gOPD(it,key);return!D||!has(AllSymbols,key)||has(it,HIDDEN)&&it[HIDDEN][key]||(D.enumerable=!0),D}},$getOwnPropertyNames=function getOwnPropertyNames(it){for(var key,names=gOPN(toIObject(it)),result=[],i=0;names.length>i;)has(AllSymbols,key=names[i++])||key==HIDDEN||key==META||result.push(key);return result},$getOwnPropertySymbols=function getOwnPropertySymbols(it){for(var key,IS_OP=it===ObjectProto,names=gOPN(IS_OP?OPSymbols:toIObject(it)),result=[],i=0;names.length>i;)!has(AllSymbols,key=names[i++])||IS_OP&&!has(ObjectProto,key)||result.push(AllSymbols[key]);return result};USE_NATIVE||(redefine(($Symbol=function Symbol(){if(this instanceof $Symbol)throw TypeError("Symbol is not a constructor!");var tag=uid(arguments.length>0?arguments[0]:void 0),$set=function(value){this===ObjectProto&&$set.call(OPSymbols,value),has(this,HIDDEN)&&has(this[HIDDEN],tag)&&(this[HIDDEN][tag]=!1),setSymbolDesc(this,tag,createDesc(1,value))};return DESCRIPTORS&&setter&&setSymbolDesc(ObjectProto,tag,{configurable:!0,set:$set}),wrap(tag)}).prototype,"toString",function toString(){return this._k}),$GOPD.f=$getOwnPropertyDescriptor,$DP.f=$defineProperty,__webpack_require__(126).f=gOPNExt.f=$getOwnPropertyNames,__webpack_require__(84).f=$propertyIsEnumerable,__webpack_require__(124).f=$getOwnPropertySymbols,DESCRIPTORS&&!__webpack_require__(79)&&redefine(ObjectProto,"propertyIsEnumerable",$propertyIsEnumerable,!0),wksExt.f=function(name){return wrap(wks(name))}),$export($export.G+$export.W+$export.F*!USE_NATIVE,{Symbol:$Symbol});for(var es6Symbols="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),j=0;es6Symbols.length>j;)wks(es6Symbols[j++]);for(var wellKnownSymbols=$keys(wks.store),k=0;wellKnownSymbols.length>k;)wksDefine(wellKnownSymbols[k++]);$export($export.S+$export.F*!USE_NATIVE,"Symbol",{for:function(key){return has(SymbolRegistry,key+="")?SymbolRegistry[key]:SymbolRegistry[key]=$Symbol(key)},keyFor:function keyFor(sym){if(!isSymbol(sym))throw TypeError(sym+" is not a symbol!");for(var key in SymbolRegistry)if(SymbolRegistry[key]===sym)return key},useSetter:function(){setter=!0},useSimple:function(){setter=!1}}),$export($export.S+$export.F*!USE_NATIVE,"Object",{create:function create(it,P){return void 0===P?_create(it):$defineProperties(_create(it),P)},defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor,getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols}),$JSON&&$export($export.S+$export.F*(!USE_NATIVE||$fails(function(){var S=$Symbol();return"[null]"!=_stringify([S])||"{}"!=_stringify({a:S})||"{}"!=_stringify(Object(S))})),"JSON",{stringify:function stringify(it){for(var replacer,$replacer,args=[it],i=1;arguments.length>i;)args.push(arguments[i++]);if($replacer=replacer=args[1],(isObject(replacer)||void 0!==it)&&!isSymbol(it))return isArray(replacer)||(replacer=function(key,value){if("function"==typeof $replacer&&(value=$replacer.call(this,key,value)),!isSymbol(value))return value}),args[1]=replacer,_stringify.apply($JSON,args)}}),$Symbol.prototype[TO_PRIMITIVE]||__webpack_require__(30)($Symbol.prototype,TO_PRIMITIVE,$Symbol.prototype.valueOf),setToStringTag($Symbol,"Symbol"),setToStringTag(Math,"Math",!0),setToStringTag(global.JSON,"JSON",!0)},function(module,exports,__webpack_require__){var aFunction=__webpack_require__(183);module.exports=function(fn,that,length){if(aFunction(fn),void 0===that)return fn;switch(length){case 1:return function(a){return fn.call(that,a)};case 2:return function(a,b){return fn.call(that,a,b)};case 3:return function(a,b,c){return fn.call(that,a,b,c)}}return function(){return fn.apply(that,arguments)}}},function(module,exports){module.exports=function(it){if("function"!=typeof it)throw TypeError(it+" is not a function!");return it}},function(module,exports,__webpack_require__){var META=__webpack_require__(40)("meta"),isObject=__webpack_require__(39),has=__webpack_require__(20),setDesc=__webpack_require__(31).f,id=0,isExtensible=Object.isExtensible||function(){return!0},FREEZE=!__webpack_require__(57)(function(){return isExtensible(Object.preventExtensions({}))}),setMeta=function(it){setDesc(it,META,{value:{i:"O"+ ++id,w:{}}})},meta=module.exports={KEY:META,NEED:!1,fastKey:function(it,create){if(!isObject(it))return"symbol"==typeof it?it:("string"==typeof it?"S":"P")+it;if(!has(it,META)){if(!isExtensible(it))return"F";if(!create)return"E";setMeta(it)}return it[META].i},getWeak:function(it,create){if(!has(it,META)){if(!isExtensible(it))return!0;if(!create)return!1;setMeta(it)}return it[META].w},onFreeze:function(it){return FREEZE&&meta.NEED&&isExtensible(it)&&!has(it,META)&&setMeta(it),it}}},function(module,exports,__webpack_require__){var global=__webpack_require__(19),core=__webpack_require__(38),LIBRARY=__webpack_require__(79),wksExt=__webpack_require__(120),defineProperty=__webpack_require__(31).f;module.exports=function(name){var $Symbol=core.Symbol||(core.Symbol=LIBRARY?{}:global.Symbol||{});"_"==name.charAt(0)||name in $Symbol||defineProperty($Symbol,name,{value:wksExt.f(name)})}},function(module,exports,__webpack_require__){var getKeys=__webpack_require__(80),gOPS=__webpack_require__(124),pIE=__webpack_require__(84);module.exports=function(it){var result=getKeys(it),getSymbols=gOPS.f;if(getSymbols)for(var key,symbols=getSymbols(it),isEnum=pIE.f,i=0;symbols.length>i;)isEnum.call(it,key=symbols[i++])&&result.push(key);return result}},function(module,exports,__webpack_require__){var cof=__webpack_require__(81);module.exports=Object("z").propertyIsEnumerable(0)?Object:function(it){return"String"==cof(it)?it.split(""):Object(it)}},function(module,exports,__webpack_require__){var toIObject=__webpack_require__(32),toLength=__webpack_require__(189),toAbsoluteIndex=__webpack_require__(190);module.exports=function(IS_INCLUDES){return function($this,el,fromIndex){var value,O=toIObject($this),length=toLength(O.length),index=toAbsoluteIndex(fromIndex,length);if(IS_INCLUDES&&el!=el){for(;length>index;)if((value=O[index++])!=value)return!0}else for(;length>index;index++)if((IS_INCLUDES||index in O)&&O[index]===el)return IS_INCLUDES||index||0;return!IS_INCLUDES&&-1}}},function(module,exports,__webpack_require__){var toInteger=__webpack_require__(123),min=Math.min;module.exports=function(it){return it>0?min(toInteger(it),9007199254740991):0}},function(module,exports,__webpack_require__){var toInteger=__webpack_require__(123),max=Math.max,min=Math.min;module.exports=function(index,length){return(index=toInteger(index))<0?max(index+length,0):min(index,length)}},function(module,exports,__webpack_require__){var cof=__webpack_require__(81);module.exports=Array.isArray||function isArray(arg){return"Array"==cof(arg)}},function(module,exports,__webpack_require__){var dP=__webpack_require__(31),anObject=__webpack_require__(58),getKeys=__webpack_require__(80);module.exports=__webpack_require__(29)?Object.defineProperties:function defineProperties(O,Properties){anObject(O);for(var P,keys=getKeys(Properties),length=keys.length,i=0;length>i;)dP.f(O,P=keys[i++],Properties[P]);return O}},function(module,exports,__webpack_require__){var document=__webpack_require__(19).document;module.exports=document&&document.documentElement},function(module,exports,__webpack_require__){var toIObject=__webpack_require__(32),gOPN=__webpack_require__(126).f,toString={}.toString,windowNames="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];module.exports.f=function getOwnPropertyNames(it){return windowNames&&"[object Window]"==toString.call(it)?function(it){try{return gOPN(it)}catch(e){return windowNames.slice()}}(it):gOPN(toIObject(it))}},function(module,exports,__webpack_require__){var pIE=__webpack_require__(84),createDesc=__webpack_require__(59),toIObject=__webpack_require__(32),toPrimitive=__webpack_require__(76),has=__webpack_require__(20),IE8_DOM_DEFINE=__webpack_require__(118),gOPD=Object.getOwnPropertyDescriptor;exports.f=__webpack_require__(29)?gOPD:function getOwnPropertyDescriptor(O,P){if(O=toIObject(O),P=toPrimitive(P,!0),IE8_DOM_DEFINE)try{return gOPD(O,P)}catch(e){}if(has(O,P))return createDesc(!pIE.f.call(O,P),O[P])}},function(module,exports,__webpack_require__){"use strict";var classof=__webpack_require__(197),test={};test[__webpack_require__(21)("toStringTag")]="z",test+""!="[object z]"&&__webpack_require__(60)(Object.prototype,"toString",function toString(){return"[object "+classof(this)+"]"},!0)},function(module,exports,__webpack_require__){var cof=__webpack_require__(81),TAG=__webpack_require__(21)("toStringTag"),ARG="Arguments"==cof(function(){return arguments}());module.exports=function(it){var O,T,B;return void 0===it?"Undefined":null===it?"Null":"string"==typeof(T=function(it,key){try{return it[key]}catch(e){}}(O=Object(it),TAG))?T:ARG?cof(O):"Object"==(B=cof(O))&&"function"==typeof O.callee?"Arguments":B}},function(module,exports,__webpack_require__){__webpack_require__(199),module.exports=__webpack_require__(38).Array.values},function(module,exports,__webpack_require__){"use strict";var addToUnscopables=__webpack_require__(200),step=__webpack_require__(201),Iterators=__webpack_require__(127),toIObject=__webpack_require__(32);module.exports=__webpack_require__(202)(Array,"Array",function(iterated,kind){this._t=toIObject(iterated),this._i=0,this._k=kind},function(){var O=this._t,kind=this._k,index=this._i++;return!O||index>=O.length?(this._t=void 0,step(1)):step(0,"keys"==kind?index:"values"==kind?O[index]:[index,O[index]])},"values"),Iterators.Arguments=Iterators.Array,addToUnscopables("keys"),addToUnscopables("values"),addToUnscopables("entries")},function(module,exports,__webpack_require__){var UNSCOPABLES=__webpack_require__(21)("unscopables"),ArrayProto=Array.prototype;void 0==ArrayProto[UNSCOPABLES]&&__webpack_require__(30)(ArrayProto,UNSCOPABLES,{}),module.exports=function(key){ArrayProto[UNSCOPABLES][key]=!0}},function(module,exports){module.exports=function(done,value){return{value:value,done:!!done}}},function(module,exports,__webpack_require__){"use strict";var LIBRARY=__webpack_require__(79),$export=__webpack_require__(117),redefine=__webpack_require__(60),hide=__webpack_require__(30),has=__webpack_require__(20),Iterators=__webpack_require__(127),$iterCreate=__webpack_require__(203),setToStringTag=__webpack_require__(78),getPrototypeOf=__webpack_require__(204),ITERATOR=__webpack_require__(21)("iterator"),BUGGY=!([].keys&&"next"in[].keys()),returnThis=function(){return this};module.exports=function(Base,NAME,Constructor,next,DEFAULT,IS_SET,FORCED){$iterCreate(Constructor,NAME,next);var methods,key,IteratorPrototype,getMethod=function(kind){if(!BUGGY&&kind in proto)return proto[kind];switch(kind){case"keys":return function keys(){return new Constructor(this,kind)};case"values":return function values(){return new Constructor(this,kind)}}return function entries(){return new Constructor(this,kind)}},TAG=NAME+" Iterator",DEF_VALUES="values"==DEFAULT,VALUES_BUG=!1,proto=Base.prototype,$native=proto[ITERATOR]||proto["@@iterator"]||DEFAULT&&proto[DEFAULT],$default=!BUGGY&&$native||getMethod(DEFAULT),$entries=DEFAULT?DEF_VALUES?getMethod("entries"):$default:void 0,$anyNative="Array"==NAME&&proto.entries||$native;if($anyNative&&(IteratorPrototype=getPrototypeOf($anyNative.call(new Base)))!==Object.prototype&&IteratorPrototype.next&&(setToStringTag(IteratorPrototype,TAG,!0),LIBRARY||has(IteratorPrototype,ITERATOR)||hide(IteratorPrototype,ITERATOR,returnThis)),DEF_VALUES&&$native&&"values"!==$native.name&&(VALUES_BUG=!0,$default=function values(){return $native.call(this)}),LIBRARY&&!FORCED||!BUGGY&&!VALUES_BUG&&proto[ITERATOR]||hide(proto,ITERATOR,$default),Iterators[NAME]=$default,Iterators[TAG]=returnThis,DEFAULT)if(methods={values:DEF_VALUES?$default:getMethod("values"),keys:IS_SET?$default:getMethod("keys"),entries:$entries},FORCED)for(key in methods)key in proto||redefine(proto,key,methods[key]);else $export($export.P+$export.F*(BUGGY||VALUES_BUG),NAME,methods);return methods}},function(module,exports,__webpack_require__){"use strict";var create=__webpack_require__(125),descriptor=__webpack_require__(59),setToStringTag=__webpack_require__(78),IteratorPrototype={};__webpack_require__(30)(IteratorPrototype,__webpack_require__(21)("iterator"),function(){return this}),module.exports=function(Constructor,NAME,next){Constructor.prototype=create(IteratorPrototype,{next:descriptor(1,next)}),setToStringTag(Constructor,NAME+" Iterator")}},function(module,exports,__webpack_require__){var has=__webpack_require__(20),toObject=__webpack_require__(205),IE_PROTO=__webpack_require__(82)("IE_PROTO"),ObjectProto=Object.prototype;module.exports=Object.getPrototypeOf||function(O){return O=toObject(O),has(O,IE_PROTO)?O[IE_PROTO]:"function"==typeof O.constructor&&O instanceof O.constructor?O.constructor.prototype:O instanceof Object?ObjectProto:null}},function(module,exports,__webpack_require__){var defined=__webpack_require__(122);module.exports=function(it){return Object(defined(it))}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(207)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(208),__webpack_require__(209),__webpack_require__(210)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(root,factory){"use strict";void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=factory)?__WEBPACK_AMD_DEFINE_FACTORY__.call(exports,__webpack_require__,exports,module):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}(0,function(){var isRegex,isString,$Array=Array,ArrayPrototype=$Array.prototype,$Object=Object,ObjectPrototype=$Object.prototype,$Function=Function,FunctionPrototype=$Function.prototype,$String=String,StringPrototype=$String.prototype,$Number=Number,NumberPrototype=$Number.prototype,array_slice=ArrayPrototype.slice,array_splice=ArrayPrototype.splice,array_push=ArrayPrototype.push,array_unshift=ArrayPrototype.unshift,array_concat=ArrayPrototype.concat,array_join=ArrayPrototype.join,call=FunctionPrototype.call,apply=FunctionPrototype.apply,max=Math.max,min=Math.min,to_string=ObjectPrototype.toString,hasToStringTag="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,fnToStr=Function.prototype.toString,constructorRegex=/^\s*class /,isES6ClassFn=function isES6ClassFn(value){try{var spaceStripped=fnToStr.call(value).replace(/\/\/.*\n/g,"").replace(/\/\*[.\s\S]*\*\//g,"").replace(/\n/gm," ").replace(/ {2}/g," ");return constructorRegex.test(spaceStripped)}catch(e){return!1}},isCallable=function isCallable(value){if(!value)return!1;if("function"!=typeof value&&"object"!=typeof value)return!1;if(hasToStringTag)return function tryFunctionObject(value){try{return!isES6ClassFn(value)&&(fnToStr.call(value),!0)}catch(e){return!1}}(value);if(isES6ClassFn(value))return!1;var strClass=to_string.call(value);return"[object Function]"===strClass||"[object GeneratorFunction]"===strClass},regexExec=RegExp.prototype.exec;isRegex=function isRegex(value){return"object"==typeof value&&(hasToStringTag?function tryRegexExec(value){try{return regexExec.call(value),!0}catch(e){return!1}}(value):"[object RegExp]"===to_string.call(value))};var strValue=String.prototype.valueOf;isString=function isString(value){return"string"==typeof value||"object"==typeof value&&(hasToStringTag?function tryStringObject(value){try{return strValue.call(value),!0}catch(e){return!1}}(value):"[object String]"===to_string.call(value))};var has,defineProperty,supportsDescriptors=$Object.defineProperty&&function(){try{var obj={};for(var _ in $Object.defineProperty(obj,"x",{enumerable:!1,value:obj}),obj)return!1;return obj.x===obj}catch(e){return!1}}(),defineProperties=(has=ObjectPrototype.hasOwnProperty,defineProperty=supportsDescriptors?function(object,name,method,forceAssign){!forceAssign&&name in object||$Object.defineProperty(object,name,{configurable:!0,enumerable:!1,writable:!0,value:method})}:function(object,name,method,forceAssign){!forceAssign&&name in object||(object[name]=method)},function defineProperties(object,map,forceAssign){for(var name in map)has.call(map,name)&&defineProperty(object,name,map[name],forceAssign)}),isPrimitive=function isPrimitive(input){var type=typeof input;return null===input||"object"!==type&&"function"!==type},isActualNaN=$Number.isNaN||function isActualNaN(x){return x!=x},ES_ToInteger=function ToInteger(num){var n=+num;return isActualNaN(n)?n=0:0!==n&&n!==1/0&&n!==-1/0&&(n=(n>0||-1)*Math.floor(Math.abs(n))),n},ES_ToPrimitive=function ToPrimitive(input){var val,valueOf,toStr;if(isPrimitive(input))return input;if(valueOf=input.valueOf,isCallable(valueOf)&&(val=valueOf.call(input),isPrimitive(val)))return val;if(toStr=input.toString,isCallable(toStr)&&(val=toStr.call(input),isPrimitive(val)))return val;throw new TypeError},ES_ToObject=function(o){if(null==o)throw new TypeError("can't convert "+o+" to object");return $Object(o)},ES_ToUint_=function ToUint32(x){return x>>>0},Empty=function Empty(){};defineProperties(FunctionPrototype,{bind:function bind(that){var target=this;if(!isCallable(target))throw new TypeError("Function.prototype.bind called on incompatible "+target);for(var bound,args=array_slice.call(arguments,1),boundLength=max(0,target.length-args.length),boundArgs=[],i=0;i<boundLength;i++)array_push.call(boundArgs,"$"+i);return bound=$Function("binder","return function ("+array_join.call(boundArgs,",")+"){ return binder.apply(this, arguments); }")(function(){if(this instanceof bound){var result=apply.call(target,this,array_concat.call(args,array_slice.call(arguments)));return $Object(result)===result?result:this}return apply.call(target,that,array_concat.call(args,array_slice.call(arguments)))}),target.prototype&&(Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null),bound}});var owns=call.bind(ObjectPrototype.hasOwnProperty),toStr=call.bind(ObjectPrototype.toString),arraySlice=call.bind(array_slice),arraySliceApply=apply.bind(array_slice);if("object"==typeof document&&document&&document.documentElement)try{arraySlice(document.documentElement.childNodes)}catch(e){var origArraySlice=arraySlice,origArraySliceApply=arraySliceApply;arraySlice=function arraySliceIE(arr){for(var r=[],i=arr.length;i-- >0;)r[i]=arr[i];return origArraySliceApply(r,origArraySlice(arguments,1))},arraySliceApply=function arraySliceApplyIE(arr,args){return origArraySliceApply(arraySlice(arr),args)}}var strSlice=call.bind(StringPrototype.slice),strSplit=call.bind(StringPrototype.split),strIndexOf=call.bind(StringPrototype.indexOf),pushCall=call.bind(array_push),isEnum=call.bind(ObjectPrototype.propertyIsEnumerable),arraySort=call.bind(ArrayPrototype.sort),isArray=$Array.isArray||function isArray(obj){return"[object Array]"===toStr(obj)},hasUnshiftReturnValueBug=1!==[].unshift(0);defineProperties(ArrayPrototype,{unshift:function(){return array_unshift.apply(this,arguments),this.length}},hasUnshiftReturnValueBug),defineProperties($Array,{isArray:isArray});var boxedString=$Object("a"),splitString="a"!==boxedString[0]||!(0 in boxedString),properlyBoxesContext=function properlyBoxed(method){var properlyBoxesNonStrict=!0,properlyBoxesStrict=!0,threwException=!1;if(method)try{method.call("foo",function(_,__,context){"object"!=typeof context&&(properlyBoxesNonStrict=!1)}),method.call([1],function(){"use strict";properlyBoxesStrict="string"==typeof this},"x")}catch(e){threwException=!0}return!!method&&!threwException&&properlyBoxesNonStrict&&properlyBoxesStrict};defineProperties(ArrayPrototype,{forEach:function forEach(callbackfn){var T,object=ES_ToObject(this),self=splitString&&isString(this)?strSplit(this,""):object,i=-1,length=ES_ToUint_(self.length);if(arguments.length>1&&(T=arguments[1]),!isCallable(callbackfn))throw new TypeError("Array.prototype.forEach callback must be a function");for(;++i<length;)i in self&&(void 0===T?callbackfn(self[i],i,object):callbackfn.call(T,self[i],i,object))}},!properlyBoxesContext(ArrayPrototype.forEach)),defineProperties(ArrayPrototype,{map:function map(callbackfn){var T,object=ES_ToObject(this),self=splitString&&isString(this)?strSplit(this,""):object,length=ES_ToUint_(self.length),result=$Array(length);if(arguments.length>1&&(T=arguments[1]),!isCallable(callbackfn))throw new TypeError("Array.prototype.map callback must be a function");for(var i=0;i<length;i++)i in self&&(result[i]=void 0===T?callbackfn(self[i],i,object):callbackfn.call(T,self[i],i,object));return result}},!properlyBoxesContext(ArrayPrototype.map)),defineProperties(ArrayPrototype,{filter:function filter(callbackfn){var value,T,object=ES_ToObject(this),self=splitString&&isString(this)?strSplit(this,""):object,length=ES_ToUint_(self.length),result=[];if(arguments.length>1&&(T=arguments[1]),!isCallable(callbackfn))throw new TypeError("Array.prototype.filter callback must be a function");for(var i=0;i<length;i++)i in self&&(value=self[i],(void 0===T?callbackfn(value,i,object):callbackfn.call(T,value,i,object))&&pushCall(result,value));return result}},!properlyBoxesContext(ArrayPrototype.filter)),defineProperties(ArrayPrototype,{every:function every(callbackfn){var T,object=ES_ToObject(this),self=splitString&&isString(this)?strSplit(this,""):object,length=ES_ToUint_(self.length);if(arguments.length>1&&(T=arguments[1]),!isCallable(callbackfn))throw new TypeError("Array.prototype.every callback must be a function");for(var i=0;i<length;i++)if(i in self&&!(void 0===T?callbackfn(self[i],i,object):callbackfn.call(T,self[i],i,object)))return!1;return!0}},!properlyBoxesContext(ArrayPrototype.every)),defineProperties(ArrayPrototype,{some:function some(callbackfn){var T,object=ES_ToObject(this),self=splitString&&isString(this)?strSplit(this,""):object,length=ES_ToUint_(self.length);if(arguments.length>1&&(T=arguments[1]),!isCallable(callbackfn))throw new TypeError("Array.prototype.some callback must be a function");for(var i=0;i<length;i++)if(i in self&&(void 0===T?callbackfn(self[i],i,object):callbackfn.call(T,self[i],i,object)))return!0;return!1}},!properlyBoxesContext(ArrayPrototype.some));var reduceCoercesToObject=!1;ArrayPrototype.reduce&&(reduceCoercesToObject="object"==typeof ArrayPrototype.reduce.call("es5",function(_,__,___,list){return list})),defineProperties(ArrayPrototype,{reduce:function reduce(callbackfn){var object=ES_ToObject(this),self=splitString&&isString(this)?strSplit(this,""):object,length=ES_ToUint_(self.length);if(!isCallable(callbackfn))throw new TypeError("Array.prototype.reduce callback must be a function");if(0===length&&1===arguments.length)throw new TypeError("reduce of empty array with no initial value");var result,i=0;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i++];break}if(++i>=length)throw new TypeError("reduce of empty array with no initial value")}for(;i<length;i++)i in self&&(result=callbackfn(result,self[i],i,object));return result}},!reduceCoercesToObject);var reduceRightCoercesToObject=!1;ArrayPrototype.reduceRight&&(reduceRightCoercesToObject="object"==typeof ArrayPrototype.reduceRight.call("es5",function(_,__,___,list){return list})),defineProperties(ArrayPrototype,{reduceRight:function reduceRight(callbackfn){var result,object=ES_ToObject(this),self=splitString&&isString(this)?strSplit(this,""):object,length=ES_ToUint_(self.length);if(!isCallable(callbackfn))throw new TypeError("Array.prototype.reduceRight callback must be a function");if(0===length&&1===arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var i=length-1;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i--];break}if(--i<0)throw new TypeError("reduceRight of empty array with no initial value")}if(i<0)return result;do{i in self&&(result=callbackfn(result,self[i],i,object))}while(i--);return result}},!reduceRightCoercesToObject);var hasFirefox2IndexOfBug=ArrayPrototype.indexOf&&-1!==[0,1].indexOf(1,2);defineProperties(ArrayPrototype,{indexOf:function indexOf(searchElement){var self=splitString&&isString(this)?strSplit(this,""):ES_ToObject(this),length=ES_ToUint_(self.length);if(0===length)return-1;var i=0;for(arguments.length>1&&(i=ES_ToInteger(arguments[1])),i=i>=0?i:max(0,length+i);i<length;i++)if(i in self&&self[i]===searchElement)return i;return-1}},hasFirefox2IndexOfBug);var hasFirefox2LastIndexOfBug=ArrayPrototype.lastIndexOf&&-1!==[0,1].lastIndexOf(0,-3);defineProperties(ArrayPrototype,{lastIndexOf:function lastIndexOf(searchElement){var self=splitString&&isString(this)?strSplit(this,""):ES_ToObject(this),length=ES_ToUint_(self.length);if(0===length)return-1;var i=length-1;for(arguments.length>1&&(i=min(i,ES_ToInteger(arguments[1]))),i=i>=0?i:length-Math.abs(i);i>=0;i--)if(i in self&&searchElement===self[i])return i;return-1}},hasFirefox2LastIndexOfBug);var a,result,spliceNoopReturnsEmptyArray=(result=(a=[1,2]).splice(),2===a.length&&isArray(result)&&0===result.length);defineProperties(ArrayPrototype,{splice:function splice(start,deleteCount){return 0===arguments.length?[]:array_splice.apply(this,arguments)}},!spliceNoopReturnsEmptyArray);var obj,spliceWorksWithEmptyObject=(obj={},ArrayPrototype.splice.call(obj,0,0,1),1===obj.length);defineProperties(ArrayPrototype,{splice:function splice(start,deleteCount){if(0===arguments.length)return[];var args=arguments;return this.length=max(ES_ToInteger(this.length),0),arguments.length>0&&"number"!=typeof deleteCount&&((args=arraySlice(arguments)).length<2?pushCall(args,this.length-start):args[1]=ES_ToInteger(deleteCount)),array_splice.apply(this,args)}},!spliceWorksWithEmptyObject);var arr,spliceWorksWithLargeSparseArrays=((arr=new $Array(1e5))[8]="x",arr.splice(1,1),7===arr.indexOf("x")),spliceWorksWithSmallSparseArrays=function(){var arr=[];return arr[256]="a",arr.splice(257,0,"b"),"a"===arr[256]}();defineProperties(ArrayPrototype,{splice:function splice(start,deleteCount){for(var from,O=ES_ToObject(this),A=[],len=ES_ToUint_(O.length),relativeStart=ES_ToInteger(start),actualStart=relativeStart<0?max(len+relativeStart,0):min(relativeStart,len),actualDeleteCount=min(max(ES_ToInteger(deleteCount),0),len-actualStart),k=0;k<actualDeleteCount;)from=$String(actualStart+k),owns(O,from)&&(A[k]=O[from]),k+=1;var to,items=arraySlice(arguments,2),itemCount=items.length;if(itemCount<actualDeleteCount){k=actualStart;for(var maxK=len-actualDeleteCount;k<maxK;)from=$String(k+actualDeleteCount),to=$String(k+itemCount),owns(O,from)?O[to]=O[from]:delete O[to],k+=1;k=len;for(var minK=len-actualDeleteCount+itemCount;k>minK;)delete O[k-1],k-=1}else if(itemCount>actualDeleteCount)for(k=len-actualDeleteCount;k>actualStart;)from=$String(k+actualDeleteCount-1),to=$String(k+itemCount-1),owns(O,from)?O[to]=O[from]:delete O[to],k-=1;k=actualStart;for(var i=0;i<items.length;++i)O[k]=items[i],k+=1;return O.length=len-actualDeleteCount+itemCount,A}},!spliceWorksWithLargeSparseArrays||!spliceWorksWithSmallSparseArrays);var hasStringJoinBug,originalJoin=ArrayPrototype.join;try{hasStringJoinBug="1,2,3"!==Array.prototype.join.call("123",",")}catch(e){hasStringJoinBug=!0}hasStringJoinBug&&defineProperties(ArrayPrototype,{join:function join(separator){var sep=void 0===separator?",":separator;return originalJoin.call(isString(this)?strSplit(this,""):this,sep)}},hasStringJoinBug);var hasJoinUndefinedBug="1,2"!==[1,2].join(void 0);hasJoinUndefinedBug&&defineProperties(ArrayPrototype,{join:function join(separator){var sep=void 0===separator?",":separator;return originalJoin.call(this,sep)}},hasJoinUndefinedBug);var pushShim=function push(item){for(var O=ES_ToObject(this),n=ES_ToUint_(O.length),i=0;i<arguments.length;)O[n+i]=arguments[i],i+=1;return O.length=n+i,n+i},pushIsNotGeneric=function(){var obj={};return 1!==Array.prototype.push.call(obj,void 0)||1!==obj.length||void 0!==obj[0]||!owns(obj,0)}();defineProperties(ArrayPrototype,{push:function push(item){return isArray(this)?array_push.apply(this,arguments):pushShim.apply(this,arguments)}},pushIsNotGeneric);var pushUndefinedIsWeird=function(){var arr=[];return 1!==arr.push(void 0)||1!==arr.length||void 0!==arr[0]||!owns(arr,0)}();defineProperties(ArrayPrototype,{push:pushShim},pushUndefinedIsWeird),defineProperties(ArrayPrototype,{slice:function(start,end){var arr=isString(this)?strSplit(this,""):this;return arraySliceApply(arr,arguments)}},splitString);var sortIgnoresNonFunctions=function(){try{[1,2].sort(null)}catch(e){try{[1,2].sort({})}catch(e2){return!1}}return!0}(),sortThrowsOnRegex=function(){try{return[1,2].sort(/a/),!1}catch(e){}return!0}(),sortIgnoresUndefined=function(){try{return[1,2].sort(void 0),!0}catch(e){}return!1}();defineProperties(ArrayPrototype,{sort:function sort(compareFn){if(void 0===compareFn)return arraySort(this);if(!isCallable(compareFn))throw new TypeError("Array.prototype.sort callback must be a function");return arraySort(this,compareFn)}},sortIgnoresNonFunctions||!sortIgnoresUndefined||!sortThrowsOnRegex);var hasDontEnumBug=!isEnum({toString:null},"toString"),hasProtoEnumBug=isEnum(function(){},"prototype"),hasStringEnumBug=!owns("x","0"),equalsConstructorPrototype=function(o){var ctor=o.constructor;return ctor&&ctor.prototype===o},excludedKeys={$window:!0,$console:!0,$parent:!0,$self:!0,$frame:!0,$frames:!0,$frameElement:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$external:!0,$width:!0,$height:!0,$top:!0,$localStorage:!0},hasAutomationEqualityBug=function(){if("undefined"==typeof window)return!1;for(var k in window)try{!excludedKeys["$"+k]&&owns(window,k)&&null!==window[k]&&"object"==typeof window[k]&&equalsConstructorPrototype(window[k])}catch(e){return!0}return!1}(),dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length,isStandardArguments=function isArguments(value){return"[object Arguments]"===toStr(value)},isArguments=isStandardArguments(arguments)?isStandardArguments:function isArguments(value){return null!==value&&"object"==typeof value&&"number"==typeof value.length&&value.length>=0&&!isArray(value)&&isCallable(value.callee)};defineProperties($Object,{keys:function keys(object){var isFn=isCallable(object),isArgs=isArguments(object),isObject=null!==object&&"object"==typeof object,isStr=isObject&&isString(object);if(!isObject&&!isFn&&!isArgs)throw new TypeError("Object.keys called on a non-object");var theKeys=[],skipProto=hasProtoEnumBug&&isFn;if(isStr&&hasStringEnumBug||isArgs)for(var i=0;i<object.length;++i)pushCall(theKeys,$String(i));if(!isArgs)for(var name in object)skipProto&&"prototype"===name||!owns(object,name)||pushCall(theKeys,$String(name));if(hasDontEnumBug)for(var skipConstructor=function(object){if("undefined"==typeof window||!hasAutomationEqualityBug)return equalsConstructorPrototype(object);try{return equalsConstructorPrototype(object)}catch(e){return!1}}(object),j=0;j<dontEnumsLength;j++){var dontEnum=dontEnums[j];skipConstructor&&"constructor"===dontEnum||!owns(object,dontEnum)||pushCall(theKeys,dontEnum)}return theKeys}});var keysWorksWithArguments=$Object.keys&&function(){return 2===$Object.keys(arguments).length}(1,2),keysHasArgumentsLengthBug=$Object.keys&&function(){var argKeys=$Object.keys(arguments);return 1!==arguments.length||1!==argKeys.length||1!==argKeys[0]}(1),originalKeys=$Object.keys;defineProperties($Object,{keys:function keys(object){return isArguments(object)?originalKeys(arraySlice(object)):originalKeys(object)}},!keysWorksWithArguments||keysHasArgumentsLengthBug);var hasToDateStringFormatBug,hasToStringFormatBug,hasNegativeMonthYearBug=0!==new Date(-0xc782b5b342b24).getUTCMonth(),aNegativeTestDate=new Date(-0x55d318d56a724),aPositiveTestDate=new Date(14496624e5),hasToUTCStringFormatBug="Mon, 01 Jan -45875 11:59:59 GMT"!==aNegativeTestDate.toUTCString();aNegativeTestDate.getTimezoneOffset()<-720?(hasToDateStringFormatBug="Tue Jan 02 -45875"!==aNegativeTestDate.toDateString(),hasToStringFormatBug=!/^Thu Dec 10 2015 \d\d:\d\d:\d\d GMT[-+]\d\d\d\d(?: |$)/.test(String(aPositiveTestDate))):(hasToDateStringFormatBug="Mon Jan 01 -45875"!==aNegativeTestDate.toDateString(),hasToStringFormatBug=!/^Wed Dec 09 2015 \d\d:\d\d:\d\d GMT[-+]\d\d\d\d(?: |$)/.test(String(aPositiveTestDate)));var originalGetFullYear=call.bind(Date.prototype.getFullYear),originalGetMonth=call.bind(Date.prototype.getMonth),originalGetDate=call.bind(Date.prototype.getDate),originalGetUTCFullYear=call.bind(Date.prototype.getUTCFullYear),originalGetUTCMonth=call.bind(Date.prototype.getUTCMonth),originalGetUTCDate=call.bind(Date.prototype.getUTCDate),originalGetUTCDay=call.bind(Date.prototype.getUTCDay),originalGetUTCHours=call.bind(Date.prototype.getUTCHours),originalGetUTCMinutes=call.bind(Date.prototype.getUTCMinutes),originalGetUTCSeconds=call.bind(Date.prototype.getUTCSeconds),originalGetUTCMilliseconds=call.bind(Date.prototype.getUTCMilliseconds),dayName=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthName=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],daysInMonth=function daysInMonth(month,year){return originalGetDate(new Date(year,month,0))};defineProperties(Date.prototype,{getFullYear:function getFullYear(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var year=originalGetFullYear(this);return year<0&&originalGetMonth(this)>11?year+1:year},getMonth:function getMonth(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var year=originalGetFullYear(this),month=originalGetMonth(this);return year<0&&month>11?0:month},getDate:function getDate(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var year=originalGetFullYear(this),month=originalGetMonth(this),date=originalGetDate(this);return year<0&&month>11?12===month?date:daysInMonth(0,year+1)-date+1:date},getUTCFullYear:function getUTCFullYear(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var year=originalGetUTCFullYear(this);return year<0&&originalGetUTCMonth(this)>11?year+1:year},getUTCMonth:function getUTCMonth(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var year=originalGetUTCFullYear(this),month=originalGetUTCMonth(this);return year<0&&month>11?0:month},getUTCDate:function getUTCDate(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var year=originalGetUTCFullYear(this),month=originalGetUTCMonth(this),date=originalGetUTCDate(this);return year<0&&month>11?12===month?date:daysInMonth(0,year+1)-date+1:date}},hasNegativeMonthYearBug),defineProperties(Date.prototype,{toUTCString:function toUTCString(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var day=originalGetUTCDay(this),date=originalGetUTCDate(this),month=originalGetUTCMonth(this),year=originalGetUTCFullYear(this),hour=originalGetUTCHours(this),minute=originalGetUTCMinutes(this),second=originalGetUTCSeconds(this);return dayName[day]+", "+(date<10?"0"+date:date)+" "+monthName[month]+" "+year+" "+(hour<10?"0"+hour:hour)+":"+(minute<10?"0"+minute:minute)+":"+(second<10?"0"+second:second)+" GMT"}},hasNegativeMonthYearBug||hasToUTCStringFormatBug),defineProperties(Date.prototype,{toDateString:function toDateString(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var day=this.getDay(),date=this.getDate(),month=this.getMonth(),year=this.getFullYear();return dayName[day]+" "+monthName[month]+" "+(date<10?"0"+date:date)+" "+year}},hasNegativeMonthYearBug||hasToDateStringFormatBug),(hasNegativeMonthYearBug||hasToStringFormatBug)&&(Date.prototype.toString=function toString(){if(!(this&&this instanceof Date))throw new TypeError("this is not a Date object.");var day=this.getDay(),date=this.getDate(),month=this.getMonth(),year=this.getFullYear(),hour=this.getHours(),minute=this.getMinutes(),second=this.getSeconds(),timezoneOffset=this.getTimezoneOffset(),hoursOffset=Math.floor(Math.abs(timezoneOffset)/60),minutesOffset=Math.floor(Math.abs(timezoneOffset)%60);return dayName[day]+" "+monthName[month]+" "+(date<10?"0"+date:date)+" "+year+" "+(hour<10?"0"+hour:hour)+":"+(minute<10?"0"+minute:minute)+":"+(second<10?"0"+second:second)+" GMT"+(timezoneOffset>0?"-":"+")+(hoursOffset<10?"0"+hoursOffset:hoursOffset)+(minutesOffset<10?"0"+minutesOffset:minutesOffset)},supportsDescriptors&&$Object.defineProperty(Date.prototype,"toString",{configurable:!0,enumerable:!1,writable:!0}));var hasNegativeDateBug=Date.prototype.toISOString&&-1===new Date(-621987552e5).toISOString().indexOf("-000001"),hasSafari51DateBug=Date.prototype.toISOString&&"1969-12-31T23:59:59.999Z"!==new Date(-1).toISOString(),getTime=call.bind(Date.prototype.getTime);defineProperties(Date.prototype,{toISOString:function toISOString(){if(!isFinite(this)||!isFinite(getTime(this)))throw new RangeError("Date.prototype.toISOString called on non-finite value.");var year=originalGetUTCFullYear(this),month=originalGetUTCMonth(this);year+=Math.floor(month/12);var result=[(month=(month%12+12)%12)+1,originalGetUTCDate(this),originalGetUTCHours(this),originalGetUTCMinutes(this),originalGetUTCSeconds(this)];year=(year<0?"-":year>9999?"+":"")+strSlice("00000"+Math.abs(year),0<=year&&year<=9999?-4:-6);for(var i=0;i<result.length;++i)result[i]=strSlice("00"+result[i],-2);return year+"-"+arraySlice(result,0,2).join("-")+"T"+arraySlice(result,2).join(":")+"."+strSlice("000"+originalGetUTCMilliseconds(this),-3)+"Z"}},hasNegativeDateBug||hasSafari51DateBug),function(){try{return Date.prototype.toJSON&&null===new Date(NaN).toJSON()&&-1!==new Date(-621987552e5).toJSON().indexOf("-000001")&&Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(e){return!1}}()||(Date.prototype.toJSON=function toJSON(key){var O=$Object(this),tv=ES_ToPrimitive(O);if("number"==typeof tv&&!isFinite(tv))return null;var toISO=O.toISOString;if(!isCallable(toISO))throw new TypeError("toISOString property is not callable");return toISO.call(O)});var supportsExtendedYears=1e15===Date.parse("+033658-09-27T01:46:40.000Z"),acceptsInvalidDates=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z"))||!isNaN(Date.parse("2012-12-31T23:59:60.000Z"));if(isNaN(Date.parse("2000-01-01T00:00:00.000Z"))||acceptsInvalidDates||!supportsExtendedYears){var maxSafeUnsigned32Bit=Math.pow(2,31)-1,hasSafariSignedIntBug=isActualNaN(new Date(1970,0,1,0,0,0,maxSafeUnsigned32Bit+1).getTime());Date=function(NativeDate){var DateShim=function Date(Y,M,D,h,m,s,ms){var date,length=arguments.length;if(this instanceof NativeDate){var seconds=s,millis=ms;if(hasSafariSignedIntBug&&length>=7&&ms>maxSafeUnsigned32Bit){var msToShift=Math.floor(ms/maxSafeUnsigned32Bit)*maxSafeUnsigned32Bit,sToShift=Math.floor(msToShift/1e3);seconds+=sToShift,millis-=1e3*sToShift}date=1===length&&$String(Y)===Y?new NativeDate(DateShim.parse(Y)):length>=7?new NativeDate(Y,M,D,h,m,seconds,millis):length>=6?new NativeDate(Y,M,D,h,m,seconds):length>=5?new NativeDate(Y,M,D,h,m):length>=4?new NativeDate(Y,M,D,h):length>=3?new NativeDate(Y,M,D):length>=2?new NativeDate(Y,M):length>=1?new NativeDate(Y instanceof NativeDate?+Y:Y):new NativeDate}else date=NativeDate.apply(this,arguments);return isPrimitive(date)||defineProperties(date,{constructor:DateShim},!0),date},isoDateExpression=new RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:(\\.\\d{1,}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),months=[0,31,59,90,120,151,181,212,243,273,304,334,365],dayFromMonth=function dayFromMonth(year,month){var t=month>1?1:0;return months[month]+Math.floor((year-1969+t)/4)-Math.floor((year-1901+t)/100)+Math.floor((year-1601+t)/400)+365*(year-1970)};for(var key in NativeDate)owns(NativeDate,key)&&(DateShim[key]=NativeDate[key]);defineProperties(DateShim,{now:NativeDate.now,UTC:NativeDate.UTC},!0),DateShim.prototype=NativeDate.prototype,defineProperties(DateShim.prototype,{constructor:DateShim},!0);return defineProperties(DateShim,{parse:function parse(string){var match=isoDateExpression.exec(string);if(match){var result,year=$Number(match[1]),month=$Number(match[2]||1)-1,day=$Number(match[3]||1)-1,hour=$Number(match[4]||0),minute=$Number(match[5]||0),second=$Number(match[6]||0),millisecond=Math.floor(1e3*$Number(match[7]||0)),isLocalTime=Boolean(match[4]&&!match[8]),signOffset="-"===match[9]?1:-1,hourOffset=$Number(match[10]||0),minuteOffset=$Number(match[11]||0);return hour<(minute>0||second>0||millisecond>0?24:25)&&minute<60&&second<60&&millisecond<1e3&&month>-1&&month<12&&hourOffset<24&&minuteOffset<60&&day>-1&&day<dayFromMonth(year,month+1)-dayFromMonth(year,month)&&(result=1e3*(60*((result=60*(24*(dayFromMonth(year,month)+day)+hour+hourOffset*signOffset))+minute+minuteOffset*signOffset)+second)+millisecond,isLocalTime&&(result=function toUTC(t){var s=0,ms=t;if(hasSafariSignedIntBug&&ms>maxSafeUnsigned32Bit){var msToShift=Math.floor(ms/maxSafeUnsigned32Bit)*maxSafeUnsigned32Bit,sToShift=Math.floor(msToShift/1e3);s+=sToShift,ms-=1e3*sToShift}return $Number(new NativeDate(1970,0,1,0,0,s,ms))}(result)),-864e13<=result&&result<=864e13)?result:NaN}return NativeDate.parse.apply(this,arguments)}}),DateShim}(Date)}Date.now||(Date.now=function now(){return(new Date).getTime()});var hasToFixedBugs=NumberPrototype.toFixed&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0)),toFixedHelpers={base:1e7,size:6,data:[0,0,0,0,0,0],multiply:function multiply(n,c){for(var i=-1,c2=c;++i<toFixedHelpers.size;)c2+=n*toFixedHelpers.data[i],toFixedHelpers.data[i]=c2%toFixedHelpers.base,c2=Math.floor(c2/toFixedHelpers.base)},divide:function divide(n){for(var i=toFixedHelpers.size,c=0;--i>=0;)c+=toFixedHelpers.data[i],toFixedHelpers.data[i]=Math.floor(c/n),c=c%n*toFixedHelpers.base},numToString:function numToString(){for(var i=toFixedHelpers.size,s="";--i>=0;)if(""!==s||0===i||0!==toFixedHelpers.data[i]){var t=$String(toFixedHelpers.data[i]);""===s?s=t:s+=strSlice("0000000",0,7-t.length)+t}return s},pow:function pow(x,n,acc){return 0===n?acc:n%2==1?pow(x,n-1,acc*x):pow(x*x,n/2,acc)},log:function log(x){for(var n=0,x2=x;x2>=4096;)n+=12,x2/=4096;for(;x2>=2;)n+=1,x2/=2;return n}};defineProperties(NumberPrototype,{toFixed:function toFixed(fractionDigits){var f,x,s,m,e,z,j,k;if(f=$Number(fractionDigits),(f=isActualNaN(f)?0:Math.floor(f))<0||f>20)throw new RangeError("Number.toFixed called with invalid number of decimals");if(x=$Number(this),isActualNaN(x))return"NaN";if(x<=-1e21||x>=1e21)return $String(x);if(s="",x<0&&(s="-",x=-x),m="0",x>1e-21)if(z=(e=toFixedHelpers.log(x*toFixedHelpers.pow(2,69,1))-69)<0?x*toFixedHelpers.pow(2,-e,1):x/toFixedHelpers.pow(2,e,1),z*=4503599627370496,(e=52-e)>0){for(toFixedHelpers.multiply(0,z),j=f;j>=7;)toFixedHelpers.multiply(1e7,0),j-=7;for(toFixedHelpers.multiply(toFixedHelpers.pow(10,j,1),0),j=e-1;j>=23;)toFixedHelpers.divide(1<<23),j-=23;toFixedHelpers.divide(1<<j),toFixedHelpers.multiply(1,1),toFixedHelpers.divide(2),m=toFixedHelpers.numToString()}else toFixedHelpers.multiply(0,z),toFixedHelpers.multiply(1<<-e,0),m=toFixedHelpers.numToString()+strSlice("0.00000000000000000000",2,2+f);return m=f>0?(k=m.length)<=f?s+strSlice("0.0000000000000000000",0,f-k+2)+m:s+strSlice(m,0,k-f)+"."+strSlice(m,k-f):s+m}},hasToFixedBugs);var compliantExecNpcg,maxSafe32BitInt,hasToPrecisionUndefinedBug=function(){try{return"1"===1..toPrecision(void 0)}catch(e){return!0}}(),originalToPrecision=NumberPrototype.toPrecision;defineProperties(NumberPrototype,{toPrecision:function toPrecision(precision){return void 0===precision?originalToPrecision.call(this):originalToPrecision.call(this,precision)}},hasToPrecisionUndefinedBug),2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||".".split(/()()/).length>1?(compliantExecNpcg=void 0===/()??/.exec("")[1],maxSafe32BitInt=Math.pow(2,32)-1,StringPrototype.split=function(separator,limit){var string=String(this);if(void 0===separator&&0===limit)return[];if(!isRegex(separator))return strSplit(this,separator,limit);var separator2,match,lastIndex,lastLength,output=[],flags=(separator.ignoreCase?"i":"")+(separator.multiline?"m":"")+(separator.unicode?"u":"")+(separator.sticky?"y":""),lastLastIndex=0,separatorCopy=new RegExp(separator.source,flags+"g");compliantExecNpcg||(separator2=new RegExp("^"+separatorCopy.source+"$(?!\\s)",flags));var splitLimit=void 0===limit?maxSafe32BitInt:ES_ToUint_(limit);for(match=separatorCopy.exec(string);match&&!((lastIndex=match.index+match[0].length)>lastLastIndex&&(pushCall(output,strSlice(string,lastLastIndex,match.index)),!compliantExecNpcg&&match.length>1&&match[0].replace(separator2,function(){for(var i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(match[i]=void 0)}),match.length>1&&match.index<string.length&&array_push.apply(output,arraySlice(match,1)),lastLength=match[0].length,lastLastIndex=lastIndex,output.length>=splitLimit));)separatorCopy.lastIndex===match.index&&separatorCopy.lastIndex++,match=separatorCopy.exec(string);return lastLastIndex===string.length?!lastLength&&separatorCopy.test("")||pushCall(output,""):pushCall(output,strSlice(string,lastLastIndex)),output.length>splitLimit?arraySlice(output,0,splitLimit):output}):"0".split(void 0,0).length&&(StringPrototype.split=function split(separator,limit){return void 0===separator&&0===limit?[]:strSplit(this,separator,limit)});var groups,str_replace=StringPrototype.replace;(groups=[],"x".replace(/x(.)?/g,function(match,group){pushCall(groups,group)}),1===groups.length&&void 0===groups[0])||(StringPrototype.replace=function replace(searchValue,replaceValue){var isFn=isCallable(replaceValue),hasCapturingGroups=isRegex(searchValue)&&/\)[*?]/.test(searchValue.source);if(isFn&&hasCapturingGroups){return str_replace.call(this,searchValue,function(match){var length=arguments.length,originalLastIndex=searchValue.lastIndex;searchValue.lastIndex=0;var args=searchValue.exec(match)||[];return searchValue.lastIndex=originalLastIndex,pushCall(args,arguments[length-2],arguments[length-1]),replaceValue.apply(this,args)})}return str_replace.call(this,searchValue,replaceValue)});var string_substr=StringPrototype.substr,hasNegativeSubstrBug="".substr&&"b"!=="0b".substr(-1);defineProperties(StringPrototype,{substr:function substr(start,length){var normalizedStart=start;return start<0&&(normalizedStart=max(this.length+start,0)),string_substr.call(this,normalizedStart,length)}},hasNegativeSubstrBug);var ws="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff",wsRegexChars="["+ws+"]",trimBeginRegexp=new RegExp("^"+wsRegexChars+wsRegexChars+"*"),trimEndRegexp=new RegExp(wsRegexChars+wsRegexChars+"*$"),hasTrimWhitespaceBug=StringPrototype.trim&&(ws.trim()||!"​".trim());defineProperties(StringPrototype,{trim:function trim(){if(void 0===this||null===this)throw new TypeError("can't convert "+this+" to object");return $String(this).replace(trimBeginRegexp,"").replace(trimEndRegexp,"")}},hasTrimWhitespaceBug);var trim=call.bind(String.prototype.trim),hasLastIndexBug=StringPrototype.lastIndexOf&&-1!=="abcあい".lastIndexOf("あい",2);defineProperties(StringPrototype,{lastIndexOf:function lastIndexOf(searchString){if(void 0===this||null===this)throw new TypeError("can't convert "+this+" to object");for(var S=$String(this),searchStr=$String(searchString),numPos=arguments.length>1?$Number(arguments[1]):NaN,pos=isActualNaN(numPos)?1/0:ES_ToInteger(numPos),start=min(max(pos,0),S.length),searchLen=searchStr.length,k=start+searchLen;k>0;){k=max(0,k-searchLen);var index=strIndexOf(strSlice(S,k,start+searchLen),searchStr);if(-1!==index)return k+index}return-1}},hasLastIndexBug);var origParseInt,hexRegex,origParseFloat,originalLastIndexOf=StringPrototype.lastIndexOf;if(defineProperties(StringPrototype,{lastIndexOf:function lastIndexOf(searchString){return originalLastIndexOf.apply(this,arguments)}},1!==StringPrototype.lastIndexOf.length),8===parseInt(ws+"08")&&22===parseInt(ws+"0x16")||(parseInt=(origParseInt=parseInt,hexRegex=/^[-+]?0[xX]/,function parseInt(str,radix){var string=trim(String(str)),defaultedRadix=$Number(radix)||(hexRegex.test(string)?16:10);return origParseInt(string,defaultedRadix)})),1/parseFloat("-0")!=-1/0&&(parseFloat=(origParseFloat=parseFloat,function parseFloat(string){var inputString=trim(String(string)),result=origParseFloat(inputString);return 0===result&&"-"===strSlice(inputString,0,1)?-0:result})),"RangeError: test"!==String(new RangeError("test"))){Error.prototype.toString=function toString(){if(void 0===this||null===this)throw new TypeError("can't convert "+this+" to object");var name=this.name;void 0===name?name="Error":"string"!=typeof name&&(name=$String(name));var msg=this.message;return void 0===msg?msg="":"string"!=typeof msg&&(msg=$String(msg)),name?msg?name+": "+msg:name:msg}}if(supportsDescriptors){var ensureNonEnumerable=function(obj,prop){if(isEnum(obj,prop)){var desc=Object.getOwnPropertyDescriptor(obj,prop);desc.configurable&&(desc.enumerable=!1,Object.defineProperty(obj,prop,desc))}};ensureNonEnumerable(Error.prototype,"message"),""!==Error.prototype.message&&(Error.prototype.message=""),ensureNonEnumerable(Error.prototype,"name")}if("/a/gim"!==String(/a/gim)){RegExp.prototype.toString=function toString(){var str="/"+this.source+"/";return this.global&&(str+="g"),this.ignoreCase&&(str+="i"),this.multiline&&(str+="m"),str}}})},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(root,factory){"use strict";void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=factory)?__WEBPACK_AMD_DEFINE_FACTORY__.call(exports,__webpack_require__,exports,module):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}(0,function(){var defineGetter,defineSetter,lookupGetter,lookupSetter,call=Function.call,prototypeOfObject=Object.prototype,owns=call.bind(prototypeOfObject.hasOwnProperty),isEnumerable=call.bind(prototypeOfObject.propertyIsEnumerable),toStr=call.bind(prototypeOfObject.toString),supportsAccessors=owns(prototypeOfObject,"__defineGetter__");supportsAccessors&&(defineGetter=call.bind(prototypeOfObject.__defineGetter__),defineSetter=call.bind(prototypeOfObject.__defineSetter__),lookupGetter=call.bind(prototypeOfObject.__lookupGetter__),lookupSetter=call.bind(prototypeOfObject.__lookupSetter__));var isPrimitive=function isPrimitive(o){return null==o||"object"!=typeof o&&"function"!=typeof o};Object.getPrototypeOf||(Object.getPrototypeOf=function getPrototypeOf(object){var proto=object.__proto__;return proto||null===proto?proto:"[object Function]"===toStr(object.constructor)?object.constructor.prototype:object instanceof Object?prototypeOfObject:null});var doesGetOwnPropertyDescriptorWork=function doesGetOwnPropertyDescriptorWork(object){try{return object.sentinel=0,0===Object.getOwnPropertyDescriptor(object,"sentinel").value}catch(exception){return!1}};if(Object.defineProperty){var getOwnPropertyDescriptorWorksOnObject=doesGetOwnPropertyDescriptorWork({});if(!("undefined"==typeof document||doesGetOwnPropertyDescriptorWork(document.createElement("div")))||!getOwnPropertyDescriptorWorksOnObject)var getOwnPropertyDescriptorFallback=Object.getOwnPropertyDescriptor}if(!Object.getOwnPropertyDescriptor||getOwnPropertyDescriptorFallback){Object.getOwnPropertyDescriptor=function getOwnPropertyDescriptor(object,property){if(isPrimitive(object))throw new TypeError("Object.getOwnPropertyDescriptor called on a non-object: "+object);if(getOwnPropertyDescriptorFallback)try{return getOwnPropertyDescriptorFallback.call(Object,object,property)}catch(exception){}var descriptor;if(!owns(object,property))return descriptor;if(descriptor={enumerable:isEnumerable(object,property),configurable:!0},supportsAccessors){var prototype=object.__proto__,notPrototypeOfObject=object!==prototypeOfObject;notPrototypeOfObject&&(object.__proto__=prototypeOfObject);var getter=lookupGetter(object,property),setter=lookupSetter(object,property);if(notPrototypeOfObject&&(object.__proto__=prototype),getter||setter)return getter&&(descriptor.get=getter),setter&&(descriptor.set=setter),descriptor}return descriptor.value=object[property],descriptor.writable=!0,descriptor}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function getOwnPropertyNames(object){return Object.keys(object)}),!Object.create){var createEmpty,supportsProto=!({__proto__:null}instanceof Object);createEmpty=supportsProto||"undefined"==typeof document?function(){return{__proto__:null}}:function(){var empty=function shouldUseActiveX(){if(!document.domain)return!1;try{return!!new ActiveXObject("htmlfile")}catch(exception){return!1}}()?function getEmptyViaActiveX(){var empty,xDoc;return(xDoc=new ActiveXObject("htmlfile")).write("<script><\/script>"),xDoc.close(),empty=xDoc.parentWindow.Object.prototype,xDoc=null,empty}():function getEmptyViaIFrame(){var empty,iframe=document.createElement("iframe"),parent=document.body||document.documentElement;return iframe.style.display="none",parent.appendChild(iframe),iframe.src="javascript:",empty=iframe.contentWindow.Object.prototype,parent.removeChild(iframe),iframe=null,empty}();delete empty.constructor,delete empty.hasOwnProperty,delete empty.propertyIsEnumerable,delete empty.isPrototypeOf,delete empty.toLocaleString,delete empty.toString,delete empty.valueOf;var Empty=function Empty(){};return Empty.prototype=empty,createEmpty=function(){return new Empty},new Empty},Object.create=function create(prototype,properties){var object,Type=function Type(){};if(null===prototype)object=createEmpty();else{if(null!==prototype&&isPrimitive(prototype))throw new TypeError("Object prototype may only be an Object or null");Type.prototype=prototype,(object=new Type).__proto__=prototype}return void 0!==properties&&Object.defineProperties(object,properties),object}}var freezeObject,doesDefinePropertyWork=function doesDefinePropertyWork(object){try{return Object.defineProperty(object,"sentinel",{}),"sentinel"in object}catch(exception){return!1}};if(Object.defineProperty){var definePropertyWorksOnObject=doesDefinePropertyWork({}),definePropertyWorksOnDom="undefined"==typeof document||doesDefinePropertyWork(document.createElement("div"));if(!definePropertyWorksOnObject||!definePropertyWorksOnDom)var definePropertyFallback=Object.defineProperty,definePropertiesFallback=Object.defineProperties}if(!Object.defineProperty||definePropertyFallback){Object.defineProperty=function defineProperty(object,property,descriptor){if(isPrimitive(object))throw new TypeError("Object.defineProperty called on non-object: "+object);if(isPrimitive(descriptor))throw new TypeError("Property description must be an object: "+descriptor);if(definePropertyFallback)try{return definePropertyFallback.call(Object,object,property,descriptor)}catch(exception){}if("value"in descriptor)if(supportsAccessors&&(lookupGetter(object,property)||lookupSetter(object,property))){var prototype=object.__proto__;object.__proto__=prototypeOfObject,delete object[property],object[property]=descriptor.value,object.__proto__=prototype}else object[property]=descriptor.value;else{var hasGetter="get"in descriptor,hasSetter="set"in descriptor;if(!supportsAccessors&&(hasGetter||hasSetter))throw new TypeError("getters & setters can not be defined on this javascript engine");hasGetter&&defineGetter(object,property,descriptor.get),hasSetter&&defineSetter(object,property,descriptor.set)}return object}}Object.defineProperties&&!definePropertiesFallback||(Object.defineProperties=function defineProperties(object,properties){if(definePropertiesFallback)try{return definePropertiesFallback.call(Object,object,properties)}catch(exception){}return Object.keys(properties).forEach(function(property){"__proto__"!==property&&Object.defineProperty(object,property,properties[property])}),object}),Object.seal||(Object.seal=function seal(object){if(Object(object)!==object)throw new TypeError("Object.seal can only be called on Objects.");return object}),Object.freeze||(Object.freeze=function freeze(object){if(Object(object)!==object)throw new TypeError("Object.freeze can only be called on Objects.");return object});try{Object.freeze(function(){})}catch(exception){Object.freeze=(freezeObject=Object.freeze,function freeze(object){return"function"==typeof object?object:freezeObject(object)})}Object.preventExtensions||(Object.preventExtensions=function preventExtensions(object){if(Object(object)!==object)throw new TypeError("Object.preventExtensions can only be called on Objects.");return object}),Object.isSealed||(Object.isSealed=function isSealed(object){if(Object(object)!==object)throw new TypeError("Object.isSealed can only be called on Objects.");return!1}),Object.isFrozen||(Object.isFrozen=function isFrozen(object){if(Object(object)!==object)throw new TypeError("Object.isFrozen can only be called on Objects.");return!1}),Object.isExtensible||(Object.isExtensible=function isExtensible(object){if(Object(object)!==object)throw new TypeError("Object.isExtensible can only be called on Objects.");for(var name="";owns(object,name);)name+="?";object[name]=!0;var returnValue=owns(object,name);return delete object[name],returnValue})})},function(module,exports,__webpack_require__){"use strict";__webpack_require__(211),__webpack_require__(213)(),__webpack_require__(220)},function(module,exports,__webpack_require__){(function(global,process){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__;void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=function(){"use strict";var ArrayIterator,_apply=Function.call.bind(Function.apply),_call=Function.call.bind(Function.call),isArray=Array.isArray,keys=Object.keys,throwsError=function(func){try{return func(),!1}catch(e){return!0}},valueOrFalseIfThrows=function valueOrFalseIfThrows(func){try{return func()}catch(e){return!1}},isCallableWithoutNew=function notThunker(func){return function notThunk(){return!_apply(func,this,arguments)}}(throwsError),supportsDescriptors=!!Object.defineProperty&&!throwsError(function(){Object.defineProperty({},"x",{get:function(){}})}),functionsHaveNames="foo"===function foo(){}.name,_forEach=Function.call.bind(Array.prototype.forEach),_reduce=Function.call.bind(Array.prototype.reduce),_filter=Function.call.bind(Array.prototype.filter),_some=Function.call.bind(Array.prototype.some),defineProperty=function(object,name,value,force){!force&&name in object||(supportsDescriptors?Object.defineProperty(object,name,{configurable:!0,enumerable:!1,writable:!0,value:value}):object[name]=value)},defineProperties=function(object,map,forceOverride){_forEach(keys(map),function(name){var method=map[name];defineProperty(object,name,method,!!forceOverride)})},_toString=Function.call.bind(Object.prototype.toString),isCallable=function IsCallableFast(x){return"function"==typeof x},Value_getter=function(object,name,getter){if(!supportsDescriptors)throw new TypeError("getters require true ES5 support");Object.defineProperty(object,name,{configurable:!0,enumerable:!1,get:getter})},Value_proxy=function(originalObject,key,targetObject){if(!supportsDescriptors)throw new TypeError("getters require true ES5 support");var originalDescriptor=Object.getOwnPropertyDescriptor(originalObject,key);Object.defineProperty(targetObject,key,{configurable:originalDescriptor.configurable,enumerable:originalDescriptor.enumerable,get:function getKey(){return originalObject[key]},set:function setKey(value){originalObject[key]=value}})},Value_redefine=function(object,property,newValue){if(supportsDescriptors){var descriptor=Object.getOwnPropertyDescriptor(object,property);descriptor.value=newValue,Object.defineProperty(object,property,descriptor)}else object[property]=newValue},Value_defineByDescriptor=function(object,property,descriptor){supportsDescriptors?Object.defineProperty(object,property,descriptor):"value"in descriptor&&(object[property]=descriptor.value)},Value_preserveToString=function(target,source){source&&isCallable(source.toString)&&defineProperty(target,"toString",source.toString.bind(source),!0)},create=Object.create||function(prototype,properties){var Prototype=function Prototype(){};Prototype.prototype=prototype;var object=new Prototype;return void 0!==properties&&keys(properties).forEach(function(key){Value_defineByDescriptor(object,key,properties[key])}),object},supportsSubclassing=function(C,f){return!!Object.setPrototypeOf&&valueOrFalseIfThrows(function(){var Sub=function Subclass(arg){var o=new C(arg);return Object.setPrototypeOf(o,Subclass.prototype),o};return Object.setPrototypeOf(Sub,C),Sub.prototype=create(C.prototype,{constructor:{value:Sub}}),f(Sub)})},globals=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==global)return global;throw new Error("unable to locate global object")}(),globalIsFinite=globals.isFinite,_indexOf=Function.call.bind(String.prototype.indexOf),_arrayIndexOfApply=Function.apply.bind(Array.prototype.indexOf),_concat=Function.call.bind(Array.prototype.concat),_strSlice=Function.call.bind(String.prototype.slice),_push=Function.call.bind(Array.prototype.push),_pushApply=Function.apply.bind(Array.prototype.push),_shift=Function.call.bind(Array.prototype.shift),_max=Math.max,_min=Math.min,_floor=Math.floor,_abs=Math.abs,_exp=Math.exp,_log=Math.log,_sqrt=Math.sqrt,_hasOwnProperty=Function.call.bind(Object.prototype.hasOwnProperty),noop=function(){},OrigMap=globals.Map,origMapDelete=OrigMap&&OrigMap.prototype.delete,origMapGet=OrigMap&&OrigMap.prototype.get,origMapHas=OrigMap&&OrigMap.prototype.has,origMapSet=OrigMap&&OrigMap.prototype.set,Symbol=globals.Symbol||{},symbolSpecies=Symbol.species||"@@species",numberIsNaN=Number.isNaN||function isNaN(value){return value!=value},numberIsFinite=Number.isFinite||function isFinite(value){return"number"==typeof value&&globalIsFinite(value)},_sign=isCallable(Math.sign)?Math.sign:function sign(value){var number=Number(value);return 0===number?number:numberIsNaN(number)?number:number<0?-1:1},isStandardArguments=function isArguments(value){return"[object Arguments]"===_toString(value)},isArguments=isStandardArguments(arguments)?isStandardArguments:function isArguments(value){return null!==value&&"object"==typeof value&&"number"==typeof value.length&&value.length>=0&&"[object Array]"!==_toString(value)&&"[object Function]"===_toString(value.callee)},Type_primitive=function(x){return null===x||"function"!=typeof x&&"object"!=typeof x},Type_string=function(x){return"[object String]"===_toString(x)},Type_regex=function(x){return"[object RegExp]"===_toString(x)},Type_symbol=function(x){return"function"==typeof globals.Symbol&&"symbol"==typeof x},overrideNative=function overrideNative(object,property,replacement){var original=object[property];defineProperty(object,property,replacement,!0),Value_preserveToString(object[property],original)},hasSymbols="function"==typeof Symbol&&"function"==typeof Symbol.for&&Type_symbol(Symbol()),$iterator$=Type_symbol(Symbol.iterator)?Symbol.iterator:"_es6-shim iterator_";globals.Set&&"function"==typeof(new globals.Set)["@@iterator"]&&($iterator$="@@iterator"),globals.Reflect||defineProperty(globals,"Reflect",{},!0);var o,Reflect=globals.Reflect,$String=String,domAll="undefined"!=typeof document&&document?document.all:null,isNullOrUndefined=null==domAll?function isNullOrUndefined(x){return null==x}:function isNullOrUndefinedAndNotDocumentAll(x){return null==x&&x!==domAll},ES={Call:function Call(F,V){var args=arguments.length>2?arguments[2]:[];if(!ES.IsCallable(F))throw new TypeError(F+" is not a function");return _apply(F,V,args)},RequireObjectCoercible:function(x,optMessage){if(isNullOrUndefined(x))throw new TypeError(optMessage||"Cannot call method on "+x);return x},TypeIsObject:function(x){return void 0!==x&&null!==x&&!0!==x&&!1!==x&&("function"==typeof x||"object"==typeof x||x===domAll)},ToObject:function(o,optMessage){return Object(ES.RequireObjectCoercible(o,optMessage))},IsCallable:isCallable,IsConstructor:function(x){return ES.IsCallable(x)},ToInt32:function(x){return ES.ToNumber(x)>>0},ToUint32:function(x){return ES.ToNumber(x)>>>0},ToNumber:function(value){if("[object Symbol]"===_toString(value))throw new TypeError("Cannot convert a Symbol value to a number");return+value},ToInteger:function(value){var number=ES.ToNumber(value);return numberIsNaN(number)?0:0!==number&&numberIsFinite(number)?(number>0?1:-1)*_floor(_abs(number)):number},ToLength:function(value){var len=ES.ToInteger(value);return len<=0?0:len>Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:len},SameValue:function(a,b){return a===b?0!==a||1/a==1/b:numberIsNaN(a)&&numberIsNaN(b)},SameValueZero:function(a,b){return a===b||numberIsNaN(a)&&numberIsNaN(b)},IsIterable:function(o){return ES.TypeIsObject(o)&&(void 0!==o[$iterator$]||isArguments(o))},GetIterator:function(o){if(isArguments(o))return new ArrayIterator(o,"value");var itFn=ES.GetMethod(o,$iterator$);if(!ES.IsCallable(itFn))throw new TypeError("value is not an iterable");var it=ES.Call(itFn,o);if(!ES.TypeIsObject(it))throw new TypeError("bad iterator");return it},GetMethod:function(o,p){var func=ES.ToObject(o)[p];if(!isNullOrUndefined(func)){if(!ES.IsCallable(func))throw new TypeError("Method not callable: "+p);return func}},IteratorComplete:function(iterResult){return!!iterResult.done},IteratorClose:function(iterator,completionIsThrow){var returnMethod=ES.GetMethod(iterator,"return");if(void 0!==returnMethod){var innerResult,innerException;try{innerResult=ES.Call(returnMethod,iterator)}catch(e){innerException=e}if(!completionIsThrow){if(innerException)throw innerException;if(!ES.TypeIsObject(innerResult))throw new TypeError("Iterator's return method returned a non-object.")}}},IteratorNext:function(it){var result=arguments.length>1?it.next(arguments[1]):it.next();if(!ES.TypeIsObject(result))throw new TypeError("bad iterator");return result},IteratorStep:function(it){var result=ES.IteratorNext(it);return!ES.IteratorComplete(result)&&result},Construct:function(C,args,newTarget,isES6internal){var target=void 0===newTarget?C:newTarget;if(!isES6internal&&Reflect.construct)return Reflect.construct(C,args,target);var proto=target.prototype;ES.TypeIsObject(proto)||(proto=Object.prototype);var obj=create(proto),result=ES.Call(C,obj,args);return ES.TypeIsObject(result)?result:obj},SpeciesConstructor:function(O,defaultConstructor){var C=O.constructor;if(void 0===C)return defaultConstructor;if(!ES.TypeIsObject(C))throw new TypeError("Bad constructor");var S=C[symbolSpecies];if(isNullOrUndefined(S))return defaultConstructor;if(!ES.IsConstructor(S))throw new TypeError("Bad @@species");return S},CreateHTML:function(string,tag,attribute,value){var S=ES.ToString(string),p1="<"+tag;""!==attribute&&(p1+=" "+attribute+'="'+ES.ToString(value).replace(/"/g,"&quot;")+'"');return p1+">"+S+"</"+tag+">"},IsRegExp:function IsRegExp(argument){if(!ES.TypeIsObject(argument))return!1;var isRegExp=argument[Symbol.match];return void 0!==isRegExp?!!isRegExp:Type_regex(argument)},ToString:function ToString(string){return $String(string)}};if(supportsDescriptors&&hasSymbols){var defineWellKnownSymbol=function defineWellKnownSymbol(name){if(Type_symbol(Symbol[name]))return Symbol[name];var sym=Symbol.for("Symbol."+name);return Object.defineProperty(Symbol,name,{configurable:!1,enumerable:!1,writable:!1,value:sym}),sym};if(!Type_symbol(Symbol.search)){var symbolSearch=defineWellKnownSymbol("search"),originalSearch=String.prototype.search;defineProperty(RegExp.prototype,symbolSearch,function search(string){return ES.Call(originalSearch,string,[this])});overrideNative(String.prototype,"search",function search(regexp){var O=ES.RequireObjectCoercible(this);if(!isNullOrUndefined(regexp)){var searcher=ES.GetMethod(regexp,symbolSearch);if(void 0!==searcher)return ES.Call(searcher,regexp,[O])}return ES.Call(originalSearch,O,[ES.ToString(regexp)])})}if(!Type_symbol(Symbol.replace)){var symbolReplace=defineWellKnownSymbol("replace"),originalReplace=String.prototype.replace;defineProperty(RegExp.prototype,symbolReplace,function replace(string,replaceValue){return ES.Call(originalReplace,string,[this,replaceValue])});overrideNative(String.prototype,"replace",function replace(searchValue,replaceValue){var O=ES.RequireObjectCoercible(this);if(!isNullOrUndefined(searchValue)){var replacer=ES.GetMethod(searchValue,symbolReplace);if(void 0!==replacer)return ES.Call(replacer,searchValue,[O,replaceValue])}return ES.Call(originalReplace,O,[ES.ToString(searchValue),replaceValue])})}if(!Type_symbol(Symbol.split)){var symbolSplit=defineWellKnownSymbol("split"),originalSplit=String.prototype.split;defineProperty(RegExp.prototype,symbolSplit,function split(string,limit){return ES.Call(originalSplit,string,[this,limit])});overrideNative(String.prototype,"split",function split(separator,limit){var O=ES.RequireObjectCoercible(this);if(!isNullOrUndefined(separator)){var splitter=ES.GetMethod(separator,symbolSplit);if(void 0!==splitter)return ES.Call(splitter,separator,[O,limit])}return ES.Call(originalSplit,O,[ES.ToString(separator),limit])})}var symbolMatchExists=Type_symbol(Symbol.match),stringMatchIgnoresSymbolMatch=symbolMatchExists&&((o={})[Symbol.match]=function(){return 42},42!=="a".match(o));if(!symbolMatchExists||stringMatchIgnoresSymbolMatch){var symbolMatch=defineWellKnownSymbol("match"),originalMatch=String.prototype.match;defineProperty(RegExp.prototype,symbolMatch,function match(string){return ES.Call(originalMatch,string,[this])});overrideNative(String.prototype,"match",function match(regexp){var O=ES.RequireObjectCoercible(this);if(!isNullOrUndefined(regexp)){var matcher=ES.GetMethod(regexp,symbolMatch);if(void 0!==matcher)return ES.Call(matcher,regexp,[O])}return ES.Call(originalMatch,O,[ES.ToString(regexp)])})}}var wrapConstructor=function wrapConstructor(original,replacement,keysToSkip){Value_preserveToString(replacement,original),Object.setPrototypeOf&&Object.setPrototypeOf(original,replacement),supportsDescriptors?_forEach(Object.getOwnPropertyNames(original),function(key){key in noop||keysToSkip[key]||Value_proxy(original,key,replacement)}):_forEach(Object.keys(original),function(key){key in noop||keysToSkip[key]||(replacement[key]=original[key])}),replacement.prototype=original.prototype,Value_redefine(original.prototype,"constructor",replacement)},defaultSpeciesGetter=function(){return this},addDefaultSpecies=function(C){supportsDescriptors&&!_hasOwnProperty(C,symbolSpecies)&&Value_getter(C,symbolSpecies,defaultSpeciesGetter)},addIterator=function(prototype,impl){var implementation=impl||function iterator(){return this};defineProperty(prototype,$iterator$,implementation),!prototype[$iterator$]&&Type_symbol($iterator$)&&(prototype[$iterator$]=implementation)},createDataPropertyOrThrow=function createDataPropertyOrThrow(object,name,value){if(function createDataProperty(object,name,value){supportsDescriptors?Object.defineProperty(object,name,{configurable:!0,enumerable:!0,writable:!0,value:value}):object[name]=value}(object,name,value),!ES.SameValue(object[name],value))throw new TypeError("property is nonconfigurable")},emulateES6construct=function(o,defaultNewTarget,defaultProto,slots){if(!ES.TypeIsObject(o))throw new TypeError("Constructor requires `new`: "+defaultNewTarget.name);var proto=defaultNewTarget.prototype;ES.TypeIsObject(proto)||(proto=defaultProto);var obj=create(proto);for(var name in slots)if(_hasOwnProperty(slots,name)){var value=slots[name];defineProperty(obj,name,value,!0)}return obj};if(String.fromCodePoint&&1!==String.fromCodePoint.length){var originalFromCodePoint=String.fromCodePoint;overrideNative(String,"fromCodePoint",function fromCodePoint(codePoints){return ES.Call(originalFromCodePoint,this,arguments)})}var StringShims={fromCodePoint:function fromCodePoint(codePoints){for(var next,result=[],i=0,length=arguments.length;i<length;i++){if(next=Number(arguments[i]),!ES.SameValue(next,ES.ToInteger(next))||next<0||next>1114111)throw new RangeError("Invalid code point "+next);next<65536?_push(result,String.fromCharCode(next)):(next-=65536,_push(result,String.fromCharCode(55296+(next>>10))),_push(result,String.fromCharCode(next%1024+56320)))}return result.join("")},raw:function raw(callSite){var cooked=ES.ToObject(callSite,"bad callSite"),rawString=ES.ToObject(cooked.raw,"bad raw value"),len=rawString.length,literalsegments=ES.ToLength(len);if(literalsegments<=0)return"";for(var nextKey,next,nextSeg,nextSub,stringElements=[],nextIndex=0;nextIndex<literalsegments&&(nextKey=ES.ToString(nextIndex),nextSeg=ES.ToString(rawString[nextKey]),_push(stringElements,nextSeg),!(nextIndex+1>=literalsegments));)next=nextIndex+1<arguments.length?arguments[nextIndex+1]:"",nextSub=ES.ToString(next),_push(stringElements,nextSub),nextIndex+=1;return stringElements.join("")}};String.raw&&"xy"!==String.raw({raw:{0:"x",1:"y",length:2}})&&overrideNative(String,"raw",StringShims.raw),defineProperties(String,StringShims);var StringPrototypeShims={repeat:function repeat(times){var thisStr=ES.ToString(ES.RequireObjectCoercible(this)),numTimes=ES.ToInteger(times);if(numTimes<0||numTimes>=1/0)throw new RangeError("repeat count must be less than infinity and not overflow maximum string size");return function repeat(s,times){if(times<1)return"";if(times%2)return repeat(s,times-1)+s;var half=repeat(s,times/2);return half+half}(thisStr,numTimes)},startsWith:function startsWith(searchString){var S=ES.ToString(ES.RequireObjectCoercible(this));if(ES.IsRegExp(searchString))throw new TypeError('Cannot call method "startsWith" with a regex');var position,searchStr=ES.ToString(searchString);arguments.length>1&&(position=arguments[1]);var start=_max(ES.ToInteger(position),0);return _strSlice(S,start,start+searchStr.length)===searchStr},endsWith:function endsWith(searchString){var S=ES.ToString(ES.RequireObjectCoercible(this));if(ES.IsRegExp(searchString))throw new TypeError('Cannot call method "endsWith" with a regex');var endPosition,searchStr=ES.ToString(searchString),len=S.length;arguments.length>1&&(endPosition=arguments[1]);var pos=void 0===endPosition?len:ES.ToInteger(endPosition),end=_min(_max(pos,0),len);return _strSlice(S,end-searchStr.length,end)===searchStr},includes:function includes(searchString){if(ES.IsRegExp(searchString))throw new TypeError('"includes" does not accept a RegExp');var position,searchStr=ES.ToString(searchString);return arguments.length>1&&(position=arguments[1]),-1!==_indexOf(this,searchStr,position)},codePointAt:function codePointAt(pos){var thisStr=ES.ToString(ES.RequireObjectCoercible(this)),position=ES.ToInteger(pos),length=thisStr.length;if(position>=0&&position<length){var first=thisStr.charCodeAt(position);if(first<55296||first>56319||position+1===length)return first;var second=thisStr.charCodeAt(position+1);return second<56320||second>57343?first:1024*(first-55296)+(second-56320)+65536}}};if(String.prototype.includes&&!1!=="a".includes("a",1/0)&&overrideNative(String.prototype,"includes",StringPrototypeShims.includes),String.prototype.startsWith&&String.prototype.endsWith){var startsWithRejectsRegex=throwsError(function(){"/a/".startsWith(/a/)}),startsWithHandlesInfinity=valueOrFalseIfThrows(function(){return!1==="abc".startsWith("a",1/0)});startsWithRejectsRegex&&startsWithHandlesInfinity||(overrideNative(String.prototype,"startsWith",StringPrototypeShims.startsWith),overrideNative(String.prototype,"endsWith",StringPrototypeShims.endsWith))}hasSymbols&&(valueOrFalseIfThrows(function(){var re=/a/;return re[Symbol.match]=!1,"/a/".startsWith(re)})||overrideNative(String.prototype,"startsWith",StringPrototypeShims.startsWith),valueOrFalseIfThrows(function(){var re=/a/;return re[Symbol.match]=!1,"/a/".endsWith(re)})||overrideNative(String.prototype,"endsWith",StringPrototypeShims.endsWith),valueOrFalseIfThrows(function(){var re=/a/;return re[Symbol.match]=!1,"/a/".includes(re)})||overrideNative(String.prototype,"includes",StringPrototypeShims.includes));defineProperties(String.prototype,StringPrototypeShims);var ws=["\t\n\v\f\r   ᠎    ","         　\u2028","\u2029\ufeff"].join(""),trimRegexp=new RegExp("(^["+ws+"]+)|(["+ws+"]+$)","g"),trimShim=function trim(){return ES.ToString(ES.RequireObjectCoercible(this)).replace(trimRegexp,"")},nonWS=["","​","￾"].join(""),nonWSregex=new RegExp("["+nonWS+"]","g"),isBadHexRegex=/^[-+]0x[0-9a-f]+$/i,hasStringTrimBug=nonWS.trim().length!==nonWS.length;defineProperty(String.prototype,"trim",trimShim,hasStringTrimBug);var iteratorResult=function(x){return{value:x,done:0===arguments.length}},StringIterator=function(s){ES.RequireObjectCoercible(s),this._s=ES.ToString(s),this._i=0};StringIterator.prototype.next=function(){var s=this._s,i=this._i;if(void 0===s||i>=s.length)return this._s=void 0,iteratorResult();var second,len,first=s.charCodeAt(i);return len=first<55296||first>56319||i+1===s.length?1:(second=s.charCodeAt(i+1))<56320||second>57343?1:2,this._i=i+len,iteratorResult(s.substr(i,len))},addIterator(StringIterator.prototype),addIterator(String.prototype,function(){return new StringIterator(this)});var ArrayShims={from:function from(items){var mapFn,mapping,T,length,result,i,C=this;if(arguments.length>1&&(mapFn=arguments[1]),void 0===mapFn)mapping=!1;else{if(!ES.IsCallable(mapFn))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(T=arguments[2]),mapping=!0}if(void 0!==(isArguments(items)||ES.GetMethod(items,$iterator$))){result=ES.IsConstructor(C)?Object(new C):[];var next,nextValue,iterator=ES.GetIterator(items);for(i=0;!1!==(next=ES.IteratorStep(iterator));){nextValue=next.value;try{mapping&&(nextValue=void 0===T?mapFn(nextValue,i):_call(mapFn,T,nextValue,i)),result[i]=nextValue}catch(e){throw ES.IteratorClose(iterator,!0),e}i+=1}length=i}else{var value,arrayLike=ES.ToObject(items);for(length=ES.ToLength(arrayLike.length),result=ES.IsConstructor(C)?Object(new C(length)):new Array(length),i=0;i<length;++i)value=arrayLike[i],mapping&&(value=void 0===T?mapFn(value,i):_call(mapFn,T,value,i)),createDataPropertyOrThrow(result,i,value)}return result.length=length,result},of:function of(){for(var len=arguments.length,C=this,A=isArray(C)||!ES.IsCallable(C)?new Array(len):ES.Construct(C,[len]),k=0;k<len;++k)createDataPropertyOrThrow(A,k,arguments[k]);return A.length=len,A}};defineProperties(Array,ArrayShims),addDefaultSpecies(Array),defineProperties((ArrayIterator=function(array,kind){this.i=0,this.array=array,this.kind=kind}).prototype,{next:function(){var i=this.i,array=this.array;if(!(this instanceof ArrayIterator))throw new TypeError("Not an ArrayIterator");if(void 0!==array)for(var len=ES.ToLength(array.length);i<len;i++){var retval,kind=this.kind;return"key"===kind?retval=i:"value"===kind?retval=array[i]:"entry"===kind&&(retval=[i,array[i]]),this.i=i+1,iteratorResult(retval)}return this.array=void 0,iteratorResult()}}),addIterator(ArrayIterator.prototype),Array.of===ArrayShims.of||function(){var Foo=function Foo(len){this.length=len};Foo.prototype=[];var fooArr=Array.of.apply(Foo,[1,2]);return fooArr instanceof Foo&&2===fooArr.length}()||overrideNative(Array,"of",ArrayShims.of);var ArrayPrototypeShims={copyWithin:function copyWithin(target,start){var end,o=ES.ToObject(this),len=ES.ToLength(o.length),relativeTarget=ES.ToInteger(target),relativeStart=ES.ToInteger(start),to=relativeTarget<0?_max(len+relativeTarget,0):_min(relativeTarget,len),from=relativeStart<0?_max(len+relativeStart,0):_min(relativeStart,len);arguments.length>2&&(end=arguments[2]);var relativeEnd=void 0===end?len:ES.ToInteger(end),finalItem=relativeEnd<0?_max(len+relativeEnd,0):_min(relativeEnd,len),count=_min(finalItem-from,len-to),direction=1;for(from<to&&to<from+count&&(direction=-1,from+=count-1,to+=count-1);count>0;)from in o?o[to]=o[from]:delete o[to],from+=direction,to+=direction,count-=1;return o},fill:function fill(value){var start,end;arguments.length>1&&(start=arguments[1]),arguments.length>2&&(end=arguments[2]);var O=ES.ToObject(this),len=ES.ToLength(O.length);start=ES.ToInteger(void 0===start?0:start),end=ES.ToInteger(void 0===end?len:end);for(var relativeStart=start<0?_max(len+start,0):_min(start,len),relativeEnd=end<0?len+end:end,i=relativeStart;i<len&&i<relativeEnd;++i)O[i]=value;return O},find:function find(predicate){var list=ES.ToObject(this),length=ES.ToLength(list.length);if(!ES.IsCallable(predicate))throw new TypeError("Array#find: predicate must be a function");for(var value,thisArg=arguments.length>1?arguments[1]:null,i=0;i<length;i++)if(value=list[i],thisArg){if(_call(predicate,thisArg,value,i,list))return value}else if(predicate(value,i,list))return value},findIndex:function findIndex(predicate){var list=ES.ToObject(this),length=ES.ToLength(list.length);if(!ES.IsCallable(predicate))throw new TypeError("Array#findIndex: predicate must be a function");for(var thisArg=arguments.length>1?arguments[1]:null,i=0;i<length;i++)if(thisArg){if(_call(predicate,thisArg,list[i],i,list))return i}else if(predicate(list[i],i,list))return i;return-1},keys:function keys(){return new ArrayIterator(this,"key")},values:function values(){return new ArrayIterator(this,"value")},entries:function entries(){return new ArrayIterator(this,"entry")}};if(Array.prototype.keys&&!ES.IsCallable([1].keys().next)&&delete Array.prototype.keys,Array.prototype.entries&&!ES.IsCallable([1].entries().next)&&delete Array.prototype.entries,Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[$iterator$]&&(defineProperties(Array.prototype,{values:Array.prototype[$iterator$]}),Type_symbol(Symbol.unscopables)&&(Array.prototype[Symbol.unscopables].values=!0)),functionsHaveNames&&Array.prototype.values&&"values"!==Array.prototype.values.name){var originalArrayPrototypeValues=Array.prototype.values;overrideNative(Array.prototype,"values",function values(){return ES.Call(originalArrayPrototypeValues,this,arguments)}),defineProperty(Array.prototype,$iterator$,Array.prototype.values,!0)}defineProperties(Array.prototype,ArrayPrototypeShims),1/[!0].indexOf(!0,-0)<0&&defineProperty(Array.prototype,"indexOf",function indexOf(searchElement){var value=_arrayIndexOfApply(this,arguments);return 0===value&&1/value<0?0:value},!0),addIterator(Array.prototype,function(){return this.values()}),Object.getPrototypeOf&&addIterator(Object.getPrototypeOf([].values()));var arr,arrayFromSwallowsNegativeLengths=valueOrFalseIfThrows(function(){return 0===Array.from({length:-1}).length}),arrayFromHandlesIterables=1===(arr=Array.from([0].entries())).length&&isArray(arr[0])&&0===arr[0][0]&&0===arr[0][1];if(arrayFromSwallowsNegativeLengths&&arrayFromHandlesIterables||overrideNative(Array,"from",ArrayShims.from),!valueOrFalseIfThrows(function(){return Array.from([0],void 0)})){var origArrayFrom=Array.from;overrideNative(Array,"from",function from(items){return arguments.length>1&&void 0!==arguments[1]?ES.Call(origArrayFrom,this,arguments):_call(origArrayFrom,this,items)})}var int32sAsOne=-(Math.pow(2,32)-1),toLengthsCorrectly=function(method,reversed){var obj={length:int32sAsOne};return obj[reversed?(obj.length>>>0)-1:0]=!0,valueOrFalseIfThrows(function(){return _call(method,obj,function(){throw new RangeError("should not reach here")},[]),!0})};if(!toLengthsCorrectly(Array.prototype.forEach)){var originalForEach=Array.prototype.forEach;overrideNative(Array.prototype,"forEach",function forEach(callbackFn){return ES.Call(originalForEach,this.length>=0?this:[],arguments)})}if(!toLengthsCorrectly(Array.prototype.map)){var originalMap=Array.prototype.map;overrideNative(Array.prototype,"map",function map(callbackFn){return ES.Call(originalMap,this.length>=0?this:[],arguments)})}if(!toLengthsCorrectly(Array.prototype.filter)){var originalFilter=Array.prototype.filter;overrideNative(Array.prototype,"filter",function filter(callbackFn){return ES.Call(originalFilter,this.length>=0?this:[],arguments)})}if(!toLengthsCorrectly(Array.prototype.some)){var originalSome=Array.prototype.some;overrideNative(Array.prototype,"some",function some(callbackFn){return ES.Call(originalSome,this.length>=0?this:[],arguments)})}if(!toLengthsCorrectly(Array.prototype.every)){var originalEvery=Array.prototype.every;overrideNative(Array.prototype,"every",function every(callbackFn){return ES.Call(originalEvery,this.length>=0?this:[],arguments)})}if(!toLengthsCorrectly(Array.prototype.reduce)){var originalReduce=Array.prototype.reduce;overrideNative(Array.prototype,"reduce",function reduce(callbackFn){return ES.Call(originalReduce,this.length>=0?this:[],arguments)})}if(!toLengthsCorrectly(Array.prototype.reduceRight,!0)){var originalReduceRight=Array.prototype.reduceRight;overrideNative(Array.prototype,"reduceRight",function reduceRight(callbackFn){return ES.Call(originalReduceRight,this.length>=0?this:[],arguments)})}var lacksOctalSupport=8!==Number("0o10"),lacksBinarySupport=2!==Number("0b10"),trimsNonWhitespace=_some(nonWS,function(c){return 0===Number(c+0+c)});if(lacksOctalSupport||lacksBinarySupport||trimsNonWhitespace){var OrigNumber=Number,binaryRegex=/^0b[01]+$/i,octalRegex=/^0o[0-7]+$/i,isBinary=binaryRegex.test.bind(binaryRegex),isOctal=octalRegex.test.bind(octalRegex),hasNonWS=nonWSregex.test.bind(nonWSregex),isBadHex=isBadHexRegex.test.bind(isBadHexRegex),NumberShim=function(){var NumberShim=function Number(value){var primValue;"string"==typeof(primValue=arguments.length>0?Type_primitive(value)?value:function(O){var result;if("function"==typeof O.valueOf&&(result=O.valueOf(),Type_primitive(result)))return result;if("function"==typeof O.toString&&(result=O.toString(),Type_primitive(result)))return result;throw new TypeError("No default value")}(value):0)&&(primValue=ES.Call(trimShim,primValue),isBinary(primValue)?primValue=parseInt(_strSlice(primValue,2),2):isOctal(primValue)?primValue=parseInt(_strSlice(primValue,2),8):(hasNonWS(primValue)||isBadHex(primValue))&&(primValue=NaN));var receiver=this,valueOfSucceeds=valueOrFalseIfThrows(function(){return OrigNumber.prototype.valueOf.call(receiver),!0});return receiver instanceof NumberShim&&!valueOfSucceeds?new OrigNumber(primValue):OrigNumber(primValue)};return NumberShim}();wrapConstructor(OrigNumber,NumberShim,{}),defineProperties(NumberShim,{NaN:OrigNumber.NaN,MAX_VALUE:OrigNumber.MAX_VALUE,MIN_VALUE:OrigNumber.MIN_VALUE,NEGATIVE_INFINITY:OrigNumber.NEGATIVE_INFINITY,POSITIVE_INFINITY:OrigNumber.POSITIVE_INFINITY}),Number=NumberShim,Value_redefine(globals,"Number",NumberShim)}var maxSafeInteger=Math.pow(2,53)-1;defineProperties(Number,{MAX_SAFE_INTEGER:maxSafeInteger,MIN_SAFE_INTEGER:-maxSafeInteger,EPSILON:2.220446049250313e-16,parseInt:globals.parseInt,parseFloat:globals.parseFloat,isFinite:numberIsFinite,isInteger:function isInteger(value){return numberIsFinite(value)&&ES.ToInteger(value)===value},isSafeInteger:function isSafeInteger(value){return Number.isInteger(value)&&_abs(value)<=Number.MAX_SAFE_INTEGER},isNaN:numberIsNaN}),defineProperty(Number,"parseInt",globals.parseInt,Number.parseInt!==globals.parseInt),1===[,1].find(function(){return!0})&&overrideNative(Array.prototype,"find",ArrayPrototypeShims.find),0!==[,1].findIndex(function(){return!0})&&overrideNative(Array.prototype,"findIndex",ArrayPrototypeShims.findIndex);var FAKENULL,gpo,spo,isEnumerableOn=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable),ensureEnumerable=function ensureEnumerable(obj,prop){supportsDescriptors&&isEnumerableOn(obj,prop)&&Object.defineProperty(obj,prop,{enumerable:!1})},sliceArgs=function sliceArgs(){for(var initial=Number(this),len=arguments.length,desiredArgCount=len-initial,args=new Array(desiredArgCount<0?0:desiredArgCount),i=initial;i<len;++i)args[i-initial]=arguments[i];return args},assignTo=function assignTo(source){return function assignToSource(target,key){return target[key]=source[key],target}},assignReducer=function(target,source){var symbols,sourceKeys=keys(Object(source));return ES.IsCallable(Object.getOwnPropertySymbols)&&(symbols=_filter(Object.getOwnPropertySymbols(Object(source)),isEnumerableOn(source))),_reduce(_concat(sourceKeys,symbols||[]),assignTo(source),target)},ObjectShims={assign:function(target,source){var to=ES.ToObject(target,"Cannot convert undefined or null to object");return _reduce(ES.Call(sliceArgs,1,arguments),assignReducer,to)},is:function is(a,b){return ES.SameValue(a,b)}};if(Object.assign&&Object.preventExtensions&&function(){var thrower=Object.preventExtensions({1:2});try{Object.assign(thrower,"xy")}catch(e){return"y"===thrower[1]}}()&&overrideNative(Object,"assign",ObjectShims.assign),defineProperties(Object,ObjectShims),supportsDescriptors){var ES5ObjectShims={setPrototypeOf:function(Object,magic){var set,setPrototypeOf=function(O,proto){return function(O,proto){if(!ES.TypeIsObject(O))throw new TypeError("cannot set prototype on a non-object");if(null!==proto&&!ES.TypeIsObject(proto))throw new TypeError("can only set prototype to an object or null"+proto)}(O,proto),_call(set,O,proto),O};try{set=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,_call(set,{},null)}catch(e){if(Object.prototype!=={}.__proto__)return;set=function(proto){this.__proto__=proto},setPrototypeOf.polyfill=setPrototypeOf(setPrototypeOf({},null),Object.prototype)instanceof Object}return setPrototypeOf}(Object)};defineProperties(Object,ES5ObjectShims)}if(Object.setPrototypeOf&&Object.getPrototypeOf&&null!==Object.getPrototypeOf(Object.setPrototypeOf({},null))&&null===Object.getPrototypeOf(Object.create(null))&&(FAKENULL=Object.create(null),gpo=Object.getPrototypeOf,spo=Object.setPrototypeOf,Object.getPrototypeOf=function(o){var result=gpo(o);return result===FAKENULL?null:result},Object.setPrototypeOf=function(o,p){return spo(o,null===p?FAKENULL:p)},Object.setPrototypeOf.polyfill=!1),!!throwsError(function(){Object.keys("foo")})){var originalObjectKeys=Object.keys;overrideNative(Object,"keys",function keys(value){return originalObjectKeys(ES.ToObject(value))}),keys=Object.keys}if(throwsError(function(){Object.keys(/a/g)})){var regexRejectingObjectKeys=Object.keys;overrideNative(Object,"keys",function keys(value){if(Type_regex(value)){var regexKeys=[];for(var k in value)_hasOwnProperty(value,k)&&_push(regexKeys,k);return regexKeys}return regexRejectingObjectKeys(value)}),keys=Object.keys}if(Object.getOwnPropertyNames&&!!throwsError(function(){Object.getOwnPropertyNames("foo")})){var cachedWindowNames="object"==typeof window?Object.getOwnPropertyNames(window):[],originalObjectGetOwnPropertyNames=Object.getOwnPropertyNames;overrideNative(Object,"getOwnPropertyNames",function getOwnPropertyNames(value){var val=ES.ToObject(value);if("[object Window]"===_toString(val))try{return originalObjectGetOwnPropertyNames(val)}catch(e){return _concat([],cachedWindowNames)}return originalObjectGetOwnPropertyNames(val)})}if(Object.getOwnPropertyDescriptor&&!!throwsError(function(){Object.getOwnPropertyDescriptor("foo","bar")})){var originalObjectGetOwnPropertyDescriptor=Object.getOwnPropertyDescriptor;overrideNative(Object,"getOwnPropertyDescriptor",function getOwnPropertyDescriptor(value,property){return originalObjectGetOwnPropertyDescriptor(ES.ToObject(value),property)})}if(Object.seal&&!!throwsError(function(){Object.seal("foo")})){var originalObjectSeal=Object.seal;overrideNative(Object,"seal",function seal(value){return ES.TypeIsObject(value)?originalObjectSeal(value):value})}if(Object.isSealed&&!!throwsError(function(){Object.isSealed("foo")})){var originalObjectIsSealed=Object.isSealed;overrideNative(Object,"isSealed",function isSealed(value){return!ES.TypeIsObject(value)||originalObjectIsSealed(value)})}if(Object.freeze&&!!throwsError(function(){Object.freeze("foo")})){var originalObjectFreeze=Object.freeze;overrideNative(Object,"freeze",function freeze(value){return ES.TypeIsObject(value)?originalObjectFreeze(value):value})}if(Object.isFrozen&&!!throwsError(function(){Object.isFrozen("foo")})){var originalObjectIsFrozen=Object.isFrozen;overrideNative(Object,"isFrozen",function isFrozen(value){return!ES.TypeIsObject(value)||originalObjectIsFrozen(value)})}if(Object.preventExtensions&&!!throwsError(function(){Object.preventExtensions("foo")})){var originalObjectPreventExtensions=Object.preventExtensions;overrideNative(Object,"preventExtensions",function preventExtensions(value){return ES.TypeIsObject(value)?originalObjectPreventExtensions(value):value})}if(Object.isExtensible&&!!throwsError(function(){Object.isExtensible("foo")})){var originalObjectIsExtensible=Object.isExtensible;overrideNative(Object,"isExtensible",function isExtensible(value){return!!ES.TypeIsObject(value)&&originalObjectIsExtensible(value)})}if(Object.getPrototypeOf&&!!throwsError(function(){Object.getPrototypeOf("foo")})){var originalGetProto=Object.getPrototypeOf;overrideNative(Object,"getPrototypeOf",function getPrototypeOf(value){return originalGetProto(ES.ToObject(value))})}var desc,hasFlags=supportsDescriptors&&((desc=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags"))&&ES.IsCallable(desc.get));if(supportsDescriptors&&!hasFlags){Value_getter(RegExp.prototype,"flags",function flags(){if(!ES.TypeIsObject(this))throw new TypeError("Method called on incompatible type: must be an object.");var result="";return this.global&&(result+="g"),this.ignoreCase&&(result+="i"),this.multiline&&(result+="m"),this.unicode&&(result+="u"),this.sticky&&(result+="y"),result})}var regex,regExpSupportsFlagsWithRegex=supportsDescriptors&&valueOrFalseIfThrows(function(){return"/a/i"===String(new RegExp(/a/g,"i"))}),regExpNeedsToSupportSymbolMatch=hasSymbols&&supportsDescriptors&&((regex=/./)[Symbol.match]=!1,RegExp(regex)===regex),regexToStringIsGeneric=valueOrFalseIfThrows(function(){return"/abc/"===RegExp.prototype.toString.call({source:"abc"})}),regexToStringSupportsGenericFlags=regexToStringIsGeneric&&valueOrFalseIfThrows(function(){return"/a/b"===RegExp.prototype.toString.call({source:"a",flags:"b"})});if(!regexToStringIsGeneric||!regexToStringSupportsGenericFlags){var origRegExpToString=RegExp.prototype.toString;defineProperty(RegExp.prototype,"toString",function toString(){var R=ES.RequireObjectCoercible(this);return Type_regex(R)?_call(origRegExpToString,R):"/"+$String(R.source)+"/"+$String(R.flags)},!0),Value_preserveToString(RegExp.prototype.toString,origRegExpToString)}if(supportsDescriptors&&(!regExpSupportsFlagsWithRegex||regExpNeedsToSupportSymbolMatch)){var flagsGetter=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get,sourceDesc=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{},sourceGetter=ES.IsCallable(sourceDesc.get)?sourceDesc.get:function(){return this.source},OrigRegExp=RegExp,RegExpShim=function RegExp(pattern,flags){var patternIsRegExp=ES.IsRegExp(pattern);return this instanceof RegExp||!patternIsRegExp||void 0!==flags||pattern.constructor!==RegExp?Type_regex(pattern)?new RegExp(ES.Call(sourceGetter,pattern),void 0===flags?ES.Call(flagsGetter,pattern):flags):(patternIsRegExp&&(pattern.source,void 0===flags&&pattern.flags),new OrigRegExp(pattern,flags)):pattern};wrapConstructor(OrigRegExp,RegExpShim,{$input:!0}),RegExp=RegExpShim,Value_redefine(globals,"RegExp",RegExpShim)}if(supportsDescriptors){var regexGlobals={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};_forEach(keys(regexGlobals),function(prop){prop in RegExp&&!(regexGlobals[prop]in RegExp)&&Value_getter(RegExp,regexGlobals[prop],function get(){return RegExp[prop]})})}addDefaultSpecies(RegExp);var inverseEpsilon=1/Number.EPSILON,BINARY_32_EPSILON=Math.pow(2,-23),BINARY_32_MAX_VALUE=Math.pow(2,127)*(2-BINARY_32_EPSILON),BINARY_32_MIN_VALUE=Math.pow(2,-126),E=Math.E,LOG2E=Math.LOG2E,LOG10E=Math.LOG10E,numberCLZ=Number.prototype.clz;delete Number.prototype.clz;var MathShims={acosh:function acosh(value){var x=Number(value);return numberIsNaN(x)||value<1?NaN:1===x?0:x===1/0?x:_log(x/E+_sqrt(x+1)*_sqrt(x-1)/E)+1},asinh:function asinh(value){var x=Number(value);return 0!==x&&globalIsFinite(x)?x<0?-asinh(-x):_log(x+_sqrt(x*x+1)):x},atanh:function atanh(value){var x=Number(value);return numberIsNaN(x)||x<-1||x>1?NaN:-1===x?-1/0:1===x?1/0:0===x?x:.5*_log((1+x)/(1-x))},cbrt:function cbrt(value){var x=Number(value);if(0===x)return x;var result,negate=x<0;return negate&&(x=-x),result=x===1/0?1/0:(x/((result=_exp(_log(x)/3))*result)+2*result)/3,negate?-result:result},clz32:function clz32(value){var x=Number(value),number=ES.ToUint32(x);return 0===number?32:numberCLZ?ES.Call(numberCLZ,number):31-_floor(_log(number+.5)*LOG2E)},cosh:function cosh(value){var x=Number(value);return 0===x?1:numberIsNaN(x)?NaN:globalIsFinite(x)?(x<0&&(x=-x),x>21?_exp(x)/2:(_exp(x)+_exp(-x))/2):1/0},expm1:function expm1(value){var x=Number(value);if(x===-1/0)return-1;if(!globalIsFinite(x)||0===x)return x;if(_abs(x)>.5)return _exp(x)-1;for(var t=x,sum=0,n=1;sum+t!==sum;)sum+=t,t*=x/(n+=1);return sum},hypot:function hypot(x,y){for(var result=0,largest=0,i=0;i<arguments.length;++i){var value=_abs(Number(arguments[i]));largest<value?(result*=largest/value*(largest/value),result+=1,largest=value):result+=value>0?value/largest*(value/largest):value}return largest===1/0?1/0:largest*_sqrt(result)},log2:function log2(value){return _log(value)*LOG2E},log10:function log10(value){return _log(value)*LOG10E},log1p:function log1p(value){var x=Number(value);return x<-1||numberIsNaN(x)?NaN:0===x||x===1/0?x:-1===x?-1/0:1+x-1==0?x:x*(_log(1+x)/(1+x-1))},sign:_sign,sinh:function sinh(value){var x=Number(value);return globalIsFinite(x)&&0!==x?_abs(x)<1?(Math.expm1(x)-Math.expm1(-x))/2:(_exp(x-1)-_exp(-x-1))*E/2:x},tanh:function tanh(value){var x=Number(value);return numberIsNaN(x)||0===x?x:x>=20?1:x<=-20?-1:(Math.expm1(x)-Math.expm1(-x))/(_exp(x)+_exp(-x))},trunc:function trunc(value){var x=Number(value);return x<0?-_floor(-x):_floor(x)},imul:function imul(x,y){var a=ES.ToUint32(x),b=ES.ToUint32(y),al=65535&a,bl=65535&b;return al*bl+((a>>>16&65535)*bl+al*(b>>>16&65535)<<16>>>0)|0},fround:function fround(x){var v=Number(x);if(0===v||v===1/0||v===-1/0||numberIsNaN(v))return v;var sign=_sign(v),abs=_abs(v);if(abs<BINARY_32_MIN_VALUE)return sign*function roundTiesToEven(n){return n+inverseEpsilon-inverseEpsilon}(abs/BINARY_32_MIN_VALUE/BINARY_32_EPSILON)*BINARY_32_MIN_VALUE*BINARY_32_EPSILON;var a=(1+BINARY_32_EPSILON/Number.EPSILON)*abs,result=a-(a-abs);return result>BINARY_32_MAX_VALUE||numberIsNaN(result)?sign*(1/0):sign*result}};defineProperties(Math,MathShims),defineProperty(Math,"log1p",MathShims.log1p,-1e-17!==Math.log1p(-1e-17)),defineProperty(Math,"asinh",MathShims.asinh,Math.asinh(-1e7)!==-Math.asinh(1e7)),defineProperty(Math,"tanh",MathShims.tanh,-2e-17!==Math.tanh(-2e-17)),defineProperty(Math,"acosh",MathShims.acosh,Math.acosh(Number.MAX_VALUE)===1/0),defineProperty(Math,"cbrt",MathShims.cbrt,Math.abs(1-Math.cbrt(1e-300)/1e-100)/Number.EPSILON>8),defineProperty(Math,"sinh",MathShims.sinh,-2e-17!==Math.sinh(-2e-17));var expm1OfTen=Math.expm1(10);defineProperty(Math,"expm1",MathShims.expm1,expm1OfTen>22025.465794806718||expm1OfTen<22025.465794806718);var origMathRound=Math.round,roundHandlesBoundaryConditions=0===Math.round(.5-Number.EPSILON/4)&&1===Math.round(Number.EPSILON/3.99-.5),roundDoesNotIncreaseIntegers=[inverseEpsilon+1,2*inverseEpsilon-1].every(function(num){return Math.round(num)===num});defineProperty(Math,"round",function round(x){var floor=_floor(x);return x-floor<.5?floor:-1===floor?-0:floor+1},!roundHandlesBoundaryConditions||!roundDoesNotIncreaseIntegers),Value_preserveToString(Math.round,origMathRound);var origImul=Math.imul;-5!==Math.imul(4294967295,5)&&(Math.imul=MathShims.imul,Value_preserveToString(Math.imul,origImul)),2!==Math.imul.length&&overrideNative(Math,"imul",function imul(x,y){return ES.Call(origImul,Math,arguments)});var count,thenable,PromiseShim=function(){var setTimeout=globals.setTimeout;if("function"==typeof setTimeout||"object"==typeof setTimeout){ES.IsPromise=function(promise){return!!ES.TypeIsObject(promise)&&void 0!==promise._promise};var makeZeroTimeout,PromiseCapability=function(C){if(!ES.IsConstructor(C))throw new TypeError("Bad promise constructor");var capability=this;if(capability.resolve=void 0,capability.reject=void 0,capability.promise=new C(function(resolve,reject){if(void 0!==capability.resolve||void 0!==capability.reject)throw new TypeError("Bad Promise implementation!");capability.resolve=resolve,capability.reject=reject}),!ES.IsCallable(capability.resolve)||!ES.IsCallable(capability.reject))throw new TypeError("Bad promise constructor")};"undefined"!=typeof window&&ES.IsCallable(window.postMessage)&&(makeZeroTimeout=function(){var timeouts=[];return window.addEventListener("message",function(event){if(event.source===window&&"zero-timeout-message"===event.data){if(event.stopPropagation(),0===timeouts.length)return;_shift(timeouts)()}},!0),function(fn){_push(timeouts,fn),window.postMessage("zero-timeout-message","*")}});var P,pr,Promise$prototype,Promise$prototype$then,PromiseShim,enqueue=ES.IsCallable(globals.setImmediate)?globals.setImmediate:"object"==typeof process&&process.nextTick?process.nextTick:(P=globals.Promise,(pr=P&&P.resolve&&P.resolve())&&function(task){return pr.then(task)}||(ES.IsCallable(makeZeroTimeout)?makeZeroTimeout():function(task){setTimeout(task,0)})),PROMISE_IDENTITY=function(x){return x},PROMISE_THROWER=function(e){throw e},PROMISE_FAKE_CAPABILITY={},enqueuePromiseReactionJob=function(handler,capability,argument){enqueue(function(){promiseReactionJob(handler,capability,argument)})},promiseReactionJob=function(handler,promiseCapability,argument){var handlerResult,f;if(promiseCapability===PROMISE_FAKE_CAPABILITY)return handler(argument);try{handlerResult=handler(argument),f=promiseCapability.resolve}catch(e){handlerResult=e,f=promiseCapability.reject}f(handlerResult)},fulfillPromise=function(promise,value){var _promise=promise._promise,length=_promise.reactionLength;if(length>0&&(enqueuePromiseReactionJob(_promise.fulfillReactionHandler0,_promise.reactionCapability0,value),_promise.fulfillReactionHandler0=void 0,_promise.rejectReactions0=void 0,_promise.reactionCapability0=void 0,length>1))for(var i=1,idx=0;i<length;i++,idx+=3)enqueuePromiseReactionJob(_promise[idx+0],_promise[idx+2],value),promise[idx+0]=void 0,promise[idx+1]=void 0,promise[idx+2]=void 0;_promise.result=value,_promise.state=1,_promise.reactionLength=0},rejectPromise=function(promise,reason){var _promise=promise._promise,length=_promise.reactionLength;if(length>0&&(enqueuePromiseReactionJob(_promise.rejectReactionHandler0,_promise.reactionCapability0,reason),_promise.fulfillReactionHandler0=void 0,_promise.rejectReactions0=void 0,_promise.reactionCapability0=void 0,length>1))for(var i=1,idx=0;i<length;i++,idx+=3)enqueuePromiseReactionJob(_promise[idx+1],_promise[idx+2],reason),promise[idx+0]=void 0,promise[idx+1]=void 0,promise[idx+2]=void 0;_promise.result=reason,_promise.state=2,_promise.reactionLength=0},createResolvingFunctions=function(promise){var alreadyResolved=!1;return{resolve:function(resolution){var then;if(!alreadyResolved){if(alreadyResolved=!0,resolution===promise)return rejectPromise(promise,new TypeError("Self resolution"));if(!ES.TypeIsObject(resolution))return fulfillPromise(promise,resolution);try{then=resolution.then}catch(e){return rejectPromise(promise,e)}if(!ES.IsCallable(then))return fulfillPromise(promise,resolution);enqueue(function(){promiseResolveThenableJob(promise,resolution,then)})}},reject:function(reason){if(!alreadyResolved)return alreadyResolved=!0,rejectPromise(promise,reason)}}},optimizedThen=function(then,thenable,resolve,reject){then===Promise$prototype$then?_call(then,thenable,resolve,reject,PROMISE_FAKE_CAPABILITY):_call(then,thenable,resolve,reject)},promiseResolveThenableJob=function(promise,thenable,then){var resolvingFunctions=createResolvingFunctions(promise),resolve=resolvingFunctions.resolve,reject=resolvingFunctions.reject;try{optimizedThen(then,thenable,resolve,reject)}catch(e){reject(e)}},Promise=PromiseShim=function Promise(resolver){if(!(this instanceof PromiseShim))throw new TypeError('Constructor Promise requires "new"');if(this&&this._promise)throw new TypeError("Bad construction");if(!ES.IsCallable(resolver))throw new TypeError("not a valid resolver");var promise=emulateES6construct(this,PromiseShim,Promise$prototype,{_promise:{result:void 0,state:0,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}}),resolvingFunctions=createResolvingFunctions(promise),reject=resolvingFunctions.reject;try{resolver(resolvingFunctions.resolve,reject)}catch(e){reject(e)}return promise};Promise$prototype=Promise.prototype;var _promiseAllResolver=function(index,values,capability,remaining){var alreadyCalled=!1;return function(x){alreadyCalled||(alreadyCalled=!0,values[index]=x,0==--remaining.count&&(0,capability.resolve)(values))}};return defineProperties(Promise,{all:function all(iterable){var C=this;if(!ES.TypeIsObject(C))throw new TypeError("Promise is not object");var iterator,iteratorRecord,capability=new PromiseCapability(C);try{return function(iteratorRecord,C,resultCapability){for(var next,nextValue,it=iteratorRecord.iterator,values=[],remaining={count:1},index=0;;){try{if(!1===(next=ES.IteratorStep(it))){iteratorRecord.done=!0;break}nextValue=next.value}catch(e){throw iteratorRecord.done=!0,e}values[index]=void 0;var nextPromise=C.resolve(nextValue),resolveElement=_promiseAllResolver(index,values,resultCapability,remaining);remaining.count+=1,optimizedThen(nextPromise.then,nextPromise,resolveElement,resultCapability.reject),index+=1}0==--remaining.count&&(0,resultCapability.resolve)(values);return resultCapability.promise}(iteratorRecord={iterator:iterator=ES.GetIterator(iterable),done:!1},C,capability)}catch(e){var exception=e;if(iteratorRecord&&!iteratorRecord.done)try{ES.IteratorClose(iterator,!0)}catch(ee){exception=ee}return(0,capability.reject)(exception),capability.promise}},race:function race(iterable){var C=this;if(!ES.TypeIsObject(C))throw new TypeError("Promise is not object");var iterator,iteratorRecord,capability=new PromiseCapability(C);try{return function(iteratorRecord,C,resultCapability){for(var next,nextValue,nextPromise,it=iteratorRecord.iterator;;){try{if(!1===(next=ES.IteratorStep(it))){iteratorRecord.done=!0;break}nextValue=next.value}catch(e){throw iteratorRecord.done=!0,e}nextPromise=C.resolve(nextValue),optimizedThen(nextPromise.then,nextPromise,resultCapability.resolve,resultCapability.reject)}return resultCapability.promise}(iteratorRecord={iterator:iterator=ES.GetIterator(iterable),done:!1},C,capability)}catch(e){var exception=e;if(iteratorRecord&&!iteratorRecord.done)try{ES.IteratorClose(iterator,!0)}catch(ee){exception=ee}return(0,capability.reject)(exception),capability.promise}},reject:function reject(reason){if(!ES.TypeIsObject(this))throw new TypeError("Bad promise constructor");var capability=new PromiseCapability(this);return(0,capability.reject)(reason),capability.promise},resolve:function resolve(v){var C=this;if(!ES.TypeIsObject(C))throw new TypeError("Bad promise constructor");if(ES.IsPromise(v)&&v.constructor===C)return v;var capability=new PromiseCapability(C);return(0,capability.resolve)(v),capability.promise}}),defineProperties(Promise$prototype,{catch:function(onRejected){return this.then(null,onRejected)},then:function then(onFulfilled,onRejected){if(!ES.IsPromise(this))throw new TypeError("not a promise");var resultCapability,C=ES.SpeciesConstructor(this,Promise);resultCapability=arguments.length>2&&arguments[2]===PROMISE_FAKE_CAPABILITY&&C===Promise?PROMISE_FAKE_CAPABILITY:new PromiseCapability(C);var value,fulfillReactionHandler=ES.IsCallable(onFulfilled)?onFulfilled:PROMISE_IDENTITY,rejectReactionHandler=ES.IsCallable(onRejected)?onRejected:PROMISE_THROWER,_promise=this._promise;if(0===_promise.state){if(0===_promise.reactionLength)_promise.fulfillReactionHandler0=fulfillReactionHandler,_promise.rejectReactionHandler0=rejectReactionHandler,_promise.reactionCapability0=resultCapability;else{var idx=3*(_promise.reactionLength-1);_promise[idx+0]=fulfillReactionHandler,_promise[idx+1]=rejectReactionHandler,_promise[idx+2]=resultCapability}_promise.reactionLength+=1}else if(1===_promise.state)value=_promise.result,enqueuePromiseReactionJob(fulfillReactionHandler,resultCapability,value);else{if(2!==_promise.state)throw new TypeError("unexpected Promise state");value=_promise.result,enqueuePromiseReactionJob(rejectReactionHandler,resultCapability,value)}return resultCapability.promise}}),PROMISE_FAKE_CAPABILITY=new PromiseCapability(Promise),Promise$prototype$then=Promise$prototype.then,Promise}}();if(globals.Promise&&(delete globals.Promise.accept,delete globals.Promise.defer,delete globals.Promise.prototype.chain),"function"==typeof PromiseShim){defineProperties(globals,{Promise:PromiseShim});var promiseSupportsSubclassing=supportsSubclassing(globals.Promise,function(S){return S.resolve(42).then(function(){})instanceof S}),promiseIgnoresNonFunctionThenCallbacks=!throwsError(function(){globals.Promise.reject(42).then(null,5).then(null,noop)}),promiseRequiresObjectContext=throwsError(function(){globals.Promise.call(3,noop)}),promiseResolveBroken=function(Promise){var p=Promise.resolve(5);p.constructor={};var p2=Promise.resolve(p);try{p2.then(null,noop).then(null,noop)}catch(e){return!0}return p===p2}(globals.Promise),getsThenSynchronously=supportsDescriptors&&(count=0,thenable=Object.defineProperty({},"then",{get:function(){count+=1}}),Promise.resolve(thenable),1===count),BadResolverPromise=function BadResolverPromise(executor){var p=new Promise(executor);executor(3,function(){}),this.then=p.then,this.constructor=BadResolverPromise};BadResolverPromise.prototype=Promise.prototype,BadResolverPromise.all=Promise.all;var hasBadResolverPromise=valueOrFalseIfThrows(function(){return!!BadResolverPromise.all([1,2])});if(promiseSupportsSubclassing&&promiseIgnoresNonFunctionThenCallbacks&&promiseRequiresObjectContext&&!promiseResolveBroken&&getsThenSynchronously&&!hasBadResolverPromise||(Promise=PromiseShim,overrideNative(globals,"Promise",PromiseShim)),1!==Promise.all.length){var origAll=Promise.all;overrideNative(Promise,"all",function all(iterable){return ES.Call(origAll,this,arguments)})}if(1!==Promise.race.length){var origRace=Promise.race;overrideNative(Promise,"race",function race(iterable){return ES.Call(origRace,this,arguments)})}if(1!==Promise.resolve.length){var origResolve=Promise.resolve;overrideNative(Promise,"resolve",function resolve(x){return ES.Call(origResolve,this,arguments)})}if(1!==Promise.reject.length){var origReject=Promise.reject;overrideNative(Promise,"reject",function reject(r){return ES.Call(origReject,this,arguments)})}ensureEnumerable(Promise,"all"),ensureEnumerable(Promise,"race"),ensureEnumerable(Promise,"resolve"),ensureEnumerable(Promise,"reject"),addDefaultSpecies(Promise)}var s,m,testOrder=function(a){var b=keys(_reduce(a,function(o,k){return o[k]=!0,o},{}));return a.join(":")===b.join(":")},preservesInsertionOrder=testOrder(["z","a","bb"]),preservesNumericInsertionOrder=testOrder(["z",1,"a","3",2]);if(supportsDescriptors){var fastkey=function fastkey(key,skipInsertionOrderCheck){return skipInsertionOrderCheck||preservesInsertionOrder?isNullOrUndefined(key)?"^"+ES.ToString(key):"string"==typeof key?"$"+key:"number"==typeof key?preservesNumericInsertionOrder?key:"n"+key:"boolean"==typeof key?"b"+key:null:null},emptyObject=function emptyObject(){return Object.create?Object.create(null):{}},addIterableToMap=function addIterableToMap(MapConstructor,map,iterable){if(isArray(iterable)||Type_string(iterable))_forEach(iterable,function(entry){if(!ES.TypeIsObject(entry))throw new TypeError("Iterator value "+entry+" is not an entry object");map.set(entry[0],entry[1])});else if(iterable instanceof MapConstructor)_call(MapConstructor.prototype.forEach,iterable,function(value,key){map.set(key,value)});else{var iter,adder;if(!isNullOrUndefined(iterable)){if(adder=map.set,!ES.IsCallable(adder))throw new TypeError("bad map");iter=ES.GetIterator(iterable)}if(void 0!==iter)for(;;){var next=ES.IteratorStep(iter);if(!1===next)break;var nextItem=next.value;try{if(!ES.TypeIsObject(nextItem))throw new TypeError("Iterator value "+nextItem+" is not an entry object");_call(adder,map,nextItem[0],nextItem[1])}catch(e){throw ES.IteratorClose(iter,!0),e}}}},addIterableToSet=function addIterableToSet(SetConstructor,set,iterable){if(isArray(iterable)||Type_string(iterable))_forEach(iterable,function(value){set.add(value)});else if(iterable instanceof SetConstructor)_call(SetConstructor.prototype.forEach,iterable,function(value){set.add(value)});else{var iter,adder;if(!isNullOrUndefined(iterable)){if(adder=set.add,!ES.IsCallable(adder))throw new TypeError("bad set");iter=ES.GetIterator(iterable)}if(void 0!==iter)for(;;){var next=ES.IteratorStep(iter);if(!1===next)break;var nextValue=next.value;try{_call(adder,set,nextValue)}catch(e){throw ES.IteratorClose(iter,!0),e}}}},collectionShims={Map:function(){var empty={},MapEntry=function MapEntry(key,value){this.key=key,this.value=value,this.next=null,this.prev=null};MapEntry.prototype.isRemoved=function isRemoved(){return this.key===empty};var Map$prototype,requireMapSlot=function requireMapSlot(map,method){if(!ES.TypeIsObject(map)||!function isMap(map){return!!map._es6map}(map))throw new TypeError("Method Map.prototype."+method+" called on incompatible receiver "+ES.ToString(map))},MapIterator=function MapIterator(map,kind){requireMapSlot(map,"[[MapIterator]]"),this.head=map._head,this.i=this.head,this.kind=kind};addIterator(MapIterator.prototype={next:function next(){var result,i=this.i,kind=this.kind,head=this.head;if(void 0===this.i)return iteratorResult();for(;i.isRemoved()&&i!==head;)i=i.prev;for(;i.next!==head;)if(!(i=i.next).isRemoved())return result="key"===kind?i.key:"value"===kind?i.value:[i.key,i.value],this.i=i,iteratorResult(result);return this.i=void 0,iteratorResult()}});var MapShim=function Map(){if(!(this instanceof Map))throw new TypeError('Constructor Map requires "new"');if(this&&this._es6map)throw new TypeError("Bad construction");var map=emulateES6construct(this,Map,Map$prototype,{_es6map:!0,_head:null,_map:OrigMap?new OrigMap:null,_size:0,_storage:emptyObject()}),head=new MapEntry(null,null);return head.next=head.prev=head,map._head=head,arguments.length>0&&addIterableToMap(Map,map,arguments[0]),map};return Value_getter(Map$prototype=MapShim.prototype,"size",function(){if(void 0===this._size)throw new TypeError("size method called on incompatible Map");return this._size}),defineProperties(Map$prototype,{get:function get(key){var entry;requireMapSlot(this,"get");var fkey=fastkey(key,!0);if(null!==fkey)return(entry=this._storage[fkey])?entry.value:void 0;if(this._map)return(entry=origMapGet.call(this._map,key))?entry.value:void 0;for(var head=this._head,i=head;(i=i.next)!==head;)if(ES.SameValueZero(i.key,key))return i.value},has:function has(key){requireMapSlot(this,"has");var fkey=fastkey(key,!0);if(null!==fkey)return void 0!==this._storage[fkey];if(this._map)return origMapHas.call(this._map,key);for(var head=this._head,i=head;(i=i.next)!==head;)if(ES.SameValueZero(i.key,key))return!0;return!1},set:function set(key,value){requireMapSlot(this,"set");var entry,head=this._head,i=head,fkey=fastkey(key,!0);if(null!==fkey){if(void 0!==this._storage[fkey])return this._storage[fkey].value=value,this;entry=this._storage[fkey]=new MapEntry(key,value),i=head.prev}else this._map&&(origMapHas.call(this._map,key)?origMapGet.call(this._map,key).value=value:(entry=new MapEntry(key,value),origMapSet.call(this._map,key,entry),i=head.prev));for(;(i=i.next)!==head;)if(ES.SameValueZero(i.key,key))return i.value=value,this;return entry=entry||new MapEntry(key,value),ES.SameValue(-0,key)&&(entry.key=0),entry.next=this._head,entry.prev=this._head.prev,entry.prev.next=entry,entry.next.prev=entry,this._size+=1,this},delete:function(key){requireMapSlot(this,"delete");var head=this._head,i=head,fkey=fastkey(key,!0);if(null!==fkey){if(void 0===this._storage[fkey])return!1;i=this._storage[fkey].prev,delete this._storage[fkey]}else if(this._map){if(!origMapHas.call(this._map,key))return!1;i=origMapGet.call(this._map,key).prev,origMapDelete.call(this._map,key)}for(;(i=i.next)!==head;)if(ES.SameValueZero(i.key,key))return i.key=empty,i.value=empty,i.prev.next=i.next,i.next.prev=i.prev,this._size-=1,!0;return!1},clear:function clear(){requireMapSlot(this,"clear"),this._map=OrigMap?new OrigMap:null,this._size=0,this._storage=emptyObject();for(var head=this._head,i=head,p=i.next;(i=p)!==head;)i.key=empty,i.value=empty,p=i.next,i.next=i.prev=head;head.next=head.prev=head},keys:function keys(){return requireMapSlot(this,"keys"),new MapIterator(this,"key")},values:function values(){return requireMapSlot(this,"values"),new MapIterator(this,"value")},entries:function entries(){return requireMapSlot(this,"entries"),new MapIterator(this,"key+value")},forEach:function forEach(callback){requireMapSlot(this,"forEach");for(var context=arguments.length>1?arguments[1]:null,it=this.entries(),entry=it.next();!entry.done;entry=it.next())context?_call(callback,context,entry.value[1],entry.value[0],this):callback(entry.value[1],entry.value[0],this)}}),addIterator(Map$prototype,Map$prototype.entries),MapShim}(),Set:function(){var Set$prototype,requireSetSlot=function requireSetSlot(set,method){if(!ES.TypeIsObject(set)||!function isSet(set){return set._es6set&&void 0!==set._storage}(set))throw new TypeError("Set.prototype."+method+" called on incompatible receiver "+ES.ToString(set))},SetShim=function Set(){if(!(this instanceof Set))throw new TypeError('Constructor Set requires "new"');if(this&&this._es6set)throw new TypeError("Bad construction");var set=emulateES6construct(this,Set,Set$prototype,{_es6set:!0,"[[SetData]]":null,_storage:emptyObject()});if(!set._es6set)throw new TypeError("bad set");return arguments.length>0&&addIterableToSet(Set,set,arguments[0]),set};Set$prototype=SetShim.prototype;var ensureMap=function ensureMap(set){if(!set["[[SetData]]"]){var m=new collectionShims.Map;set["[[SetData]]"]=m,_forEach(keys(set._storage),function(key){var k=function(key){var k=key;if("^null"===k)return null;if("^undefined"!==k){var first=k.charAt(0);return"$"===first?_strSlice(k,1):"n"===first?+_strSlice(k,1):"b"===first?"btrue"===k:+k}}(key);m.set(k,k)}),set["[[SetData]]"]=m}set._storage=null};return Value_getter(SetShim.prototype,"size",function(){return requireSetSlot(this,"size"),this._storage?keys(this._storage).length:(ensureMap(this),this["[[SetData]]"].size)}),defineProperties(SetShim.prototype,{has:function has(key){var fkey;return requireSetSlot(this,"has"),this._storage&&null!==(fkey=fastkey(key))?!!this._storage[fkey]:(ensureMap(this),this["[[SetData]]"].has(key))},add:function add(key){var fkey;return requireSetSlot(this,"add"),this._storage&&null!==(fkey=fastkey(key))?(this._storage[fkey]=!0,this):(ensureMap(this),this["[[SetData]]"].set(key,key),this)},delete:function(key){var fkey;if(requireSetSlot(this,"delete"),this._storage&&null!==(fkey=fastkey(key))){var hasFKey=_hasOwnProperty(this._storage,fkey);return delete this._storage[fkey]&&hasFKey}return ensureMap(this),this["[[SetData]]"].delete(key)},clear:function clear(){requireSetSlot(this,"clear"),this._storage&&(this._storage=emptyObject()),this["[[SetData]]"]&&this["[[SetData]]"].clear()},values:function values(){return requireSetSlot(this,"values"),ensureMap(this),this["[[SetData]]"].values()},entries:function entries(){return requireSetSlot(this,"entries"),ensureMap(this),this["[[SetData]]"].entries()},forEach:function forEach(callback){requireSetSlot(this,"forEach");var context=arguments.length>1?arguments[1]:null,entireSet=this;ensureMap(entireSet),this["[[SetData]]"].forEach(function(value,key){context?_call(callback,context,key,key,entireSet):callback(key,key,entireSet)})}}),defineProperty(SetShim.prototype,"keys",SetShim.prototype.values,!0),addIterator(SetShim.prototype,SetShim.prototype.values),SetShim}()};if(globals.Map||globals.Set){valueOrFalseIfThrows(function(){return 2===new Map([[1,2]]).get(1)})||(globals.Map=function Map(){if(!(this instanceof Map))throw new TypeError('Constructor Map requires "new"');var m=new OrigMap;return arguments.length>0&&addIterableToMap(Map,m,arguments[0]),delete m.constructor,Object.setPrototypeOf(m,globals.Map.prototype),m},globals.Map.prototype=create(OrigMap.prototype),defineProperty(globals.Map.prototype,"constructor",globals.Map,!0),Value_preserveToString(globals.Map,OrigMap));var testMap=new Map,mapUsesSameValueZero=((m=new Map([[1,0],[2,0],[3,0],[4,0]])).set(-0,m),m.get(0)===m&&m.get(-0)===m&&m.has(0)&&m.has(-0)),mapSupportsChaining=testMap.set(1,2)===testMap;mapUsesSameValueZero&&mapSupportsChaining||overrideNative(Map.prototype,"set",function set(k,v){return _call(origMapSet,this,0===k?0:k,v),this}),mapUsesSameValueZero||(defineProperties(Map.prototype,{get:function get(k){return _call(origMapGet,this,0===k?0:k)},has:function has(k){return _call(origMapHas,this,0===k?0:k)}},!0),Value_preserveToString(Map.prototype.get,origMapGet),Value_preserveToString(Map.prototype.has,origMapHas));var testSet=new Set,setUsesSameValueZero=((s=testSet).delete(0),s.add(-0),!s.has(0)),setSupportsChaining=testSet.add(1)===testSet;if(!setUsesSameValueZero||!setSupportsChaining){var origSetAdd=Set.prototype.add;Set.prototype.add=function add(v){return _call(origSetAdd,this,0===v?0:v),this},Value_preserveToString(Set.prototype.add,origSetAdd)}if(!setUsesSameValueZero){var origSetHas=Set.prototype.has;Set.prototype.has=function has(v){return _call(origSetHas,this,0===v?0:v)},Value_preserveToString(Set.prototype.has,origSetHas);var origSetDel=Set.prototype.delete;Set.prototype.delete=function SetDelete(v){return _call(origSetDel,this,0===v?0:v)},Value_preserveToString(Set.prototype.delete,origSetDel)}var mapSupportsSubclassing=supportsSubclassing(globals.Map,function(M){var m=new M([]);return m.set(42,42),m instanceof M}),mapFailsToSupportSubclassing=Object.setPrototypeOf&&!mapSupportsSubclassing,mapRequiresNew=function(){try{return!(globals.Map()instanceof globals.Map)}catch(e){return e instanceof TypeError}}();0===globals.Map.length&&!mapFailsToSupportSubclassing&&mapRequiresNew||(globals.Map=function Map(){if(!(this instanceof Map))throw new TypeError('Constructor Map requires "new"');var m=new OrigMap;return arguments.length>0&&addIterableToMap(Map,m,arguments[0]),delete m.constructor,Object.setPrototypeOf(m,Map.prototype),m},globals.Map.prototype=OrigMap.prototype,defineProperty(globals.Map.prototype,"constructor",globals.Map,!0),Value_preserveToString(globals.Map,OrigMap));var setSupportsSubclassing=supportsSubclassing(globals.Set,function(S){var s=new S([]);return s.add(42,42),s instanceof S}),setFailsToSupportSubclassing=Object.setPrototypeOf&&!setSupportsSubclassing,setRequiresNew=function(){try{return!(globals.Set()instanceof globals.Set)}catch(e){return e instanceof TypeError}}();if(0!==globals.Set.length||setFailsToSupportSubclassing||!setRequiresNew){var OrigSet=globals.Set;globals.Set=function Set(){if(!(this instanceof Set))throw new TypeError('Constructor Set requires "new"');var s=new OrigSet;return arguments.length>0&&addIterableToSet(Set,s,arguments[0]),delete s.constructor,Object.setPrototypeOf(s,Set.prototype),s},globals.Set.prototype=OrigSet.prototype,defineProperty(globals.Set.prototype,"constructor",globals.Set,!0),Value_preserveToString(globals.Set,OrigSet)}var newMap=new globals.Map,mapIterationThrowsStopIterator=!valueOrFalseIfThrows(function(){return newMap.keys().next().done});if(("function"!=typeof globals.Map.prototype.clear||0!==(new globals.Set).size||0!==newMap.size||"function"!=typeof globals.Map.prototype.keys||"function"!=typeof globals.Set.prototype.keys||"function"!=typeof globals.Map.prototype.forEach||"function"!=typeof globals.Set.prototype.forEach||isCallableWithoutNew(globals.Map)||isCallableWithoutNew(globals.Set)||"function"!=typeof newMap.keys().next||mapIterationThrowsStopIterator||!mapSupportsSubclassing)&&defineProperties(globals,{Map:collectionShims.Map,Set:collectionShims.Set},!0),globals.Set.prototype.keys!==globals.Set.prototype.values&&defineProperty(globals.Set.prototype,"keys",globals.Set.prototype.values,!0),addIterator(Object.getPrototypeOf((new globals.Map).keys())),addIterator(Object.getPrototypeOf((new globals.Set).keys())),functionsHaveNames&&"has"!==globals.Set.prototype.has.name){var anonymousSetHas=globals.Set.prototype.has;overrideNative(globals.Set.prototype,"has",function has(key){return _call(anonymousSetHas,this,key)})}}defineProperties(globals,collectionShims),addDefaultSpecies(globals.Map),addDefaultSpecies(globals.Set)}var throwUnlessTargetIsObject=function throwUnlessTargetIsObject(target){if(!ES.TypeIsObject(target))throw new TypeError("target must be an object")},ReflectShims={apply:function apply(){return ES.Call(ES.Call,null,arguments)},construct:function construct(constructor,args){if(!ES.IsConstructor(constructor))throw new TypeError("First argument must be a constructor.");var newTarget=arguments.length>2?arguments[2]:constructor;if(!ES.IsConstructor(newTarget))throw new TypeError("new.target must be a constructor.");return ES.Construct(constructor,args,newTarget,"internal")},deleteProperty:function deleteProperty(target,key){if(throwUnlessTargetIsObject(target),supportsDescriptors){var desc=Object.getOwnPropertyDescriptor(target,key);if(desc&&!desc.configurable)return!1}return delete target[key]},has:function has(target,key){return throwUnlessTargetIsObject(target),key in target}};Object.getOwnPropertyNames&&Object.assign(ReflectShims,{ownKeys:function ownKeys(target){throwUnlessTargetIsObject(target);var keys=Object.getOwnPropertyNames(target);return ES.IsCallable(Object.getOwnPropertySymbols)&&_pushApply(keys,Object.getOwnPropertySymbols(target)),keys}});var callAndCatchException=function ConvertExceptionToBoolean(func){return!throwsError(func)};if(Object.preventExtensions&&Object.assign(ReflectShims,{isExtensible:function isExtensible(target){return throwUnlessTargetIsObject(target),Object.isExtensible(target)},preventExtensions:function preventExtensions(target){return throwUnlessTargetIsObject(target),callAndCatchException(function(){Object.preventExtensions(target)})}}),supportsDescriptors){var internalGet=function get(target,key,receiver){var desc=Object.getOwnPropertyDescriptor(target,key);if(!desc){var parent=Object.getPrototypeOf(target);if(null===parent)return;return internalGet(parent,key,receiver)}return"value"in desc?desc.value:desc.get?ES.Call(desc.get,receiver):void 0},internalSet=function set(target,key,value,receiver){var desc=Object.getOwnPropertyDescriptor(target,key);if(!desc){var parent=Object.getPrototypeOf(target);if(null!==parent)return internalSet(parent,key,value,receiver);desc={value:void 0,writable:!0,enumerable:!0,configurable:!0}}return"value"in desc?!!desc.writable&&(!!ES.TypeIsObject(receiver)&&(Object.getOwnPropertyDescriptor(receiver,key)?Reflect.defineProperty(receiver,key,{value:value}):Reflect.defineProperty(receiver,key,{value:value,writable:!0,enumerable:!0,configurable:!0}))):!!desc.set&&(_call(desc.set,receiver,value),!0)};Object.assign(ReflectShims,{defineProperty:function defineProperty(target,propertyKey,attributes){return throwUnlessTargetIsObject(target),callAndCatchException(function(){Object.defineProperty(target,propertyKey,attributes)})},getOwnPropertyDescriptor:function getOwnPropertyDescriptor(target,propertyKey){return throwUnlessTargetIsObject(target),Object.getOwnPropertyDescriptor(target,propertyKey)},get:function get(target,key){throwUnlessTargetIsObject(target);var receiver=arguments.length>2?arguments[2]:target;return internalGet(target,key,receiver)},set:function set(target,key,value){throwUnlessTargetIsObject(target);var receiver=arguments.length>3?arguments[3]:target;return internalSet(target,key,value,receiver)}})}if(Object.getPrototypeOf){var objectDotGetPrototypeOf=Object.getPrototypeOf;ReflectShims.getPrototypeOf=function getPrototypeOf(target){return throwUnlessTargetIsObject(target),objectDotGetPrototypeOf(target)}}if(Object.setPrototypeOf&&ReflectShims.getPrototypeOf){Object.assign(ReflectShims,{setPrototypeOf:function setPrototypeOf(object,proto){if(throwUnlessTargetIsObject(object),null!==proto&&!ES.TypeIsObject(proto))throw new TypeError("proto must be an object or null");return proto===Reflect.getPrototypeOf(object)||!(Reflect.isExtensible&&!Reflect.isExtensible(object))&&(!function(object,lastProto){for(var proto=lastProto;proto;){if(object===proto)return!0;proto=ReflectShims.getPrototypeOf(proto)}return!1}(object,proto)&&(Object.setPrototypeOf(object,proto),!0))}})}Object.keys(ReflectShims).forEach(function(key){!function(key,shim){ES.IsCallable(globals.Reflect[key])?valueOrFalseIfThrows(function(){return globals.Reflect[key](1),globals.Reflect[key](NaN),globals.Reflect[key](!0),!0})&&overrideNative(globals.Reflect,key,shim):defineProperty(globals.Reflect,key,shim)}(key,ReflectShims[key])});var originalReflectGetProto=globals.Reflect.getPrototypeOf;if(functionsHaveNames&&originalReflectGetProto&&"getPrototypeOf"!==originalReflectGetProto.name&&overrideNative(globals.Reflect,"getPrototypeOf",function getPrototypeOf(target){return _call(originalReflectGetProto,globals.Reflect,target)}),globals.Reflect.setPrototypeOf&&valueOrFalseIfThrows(function(){return globals.Reflect.setPrototypeOf(1,{}),!0})&&overrideNative(globals.Reflect,"setPrototypeOf",ReflectShims.setPrototypeOf),globals.Reflect.defineProperty&&(valueOrFalseIfThrows(function(){var basic=!globals.Reflect.defineProperty(1,"test",{value:1}),extensible="function"!=typeof Object.preventExtensions||!globals.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return basic&&extensible})||overrideNative(globals.Reflect,"defineProperty",ReflectShims.defineProperty)),globals.Reflect.construct&&(valueOrFalseIfThrows(function(){var F=function F(){};return globals.Reflect.construct(function(){},[],F)instanceof F})||overrideNative(globals.Reflect,"construct",ReflectShims.construct)),"Invalid Date"!==String(new Date(NaN))){var dateToString=Date.prototype.toString;overrideNative(Date.prototype,"toString",function toString(){var valueOf=+this;return valueOf!=valueOf?"Invalid Date":ES.Call(dateToString,this)})}var stringHTMLshims={anchor:function anchor(name){return ES.CreateHTML(this,"a","name",name)},big:function big(){return ES.CreateHTML(this,"big","","")},blink:function blink(){return ES.CreateHTML(this,"blink","","")},bold:function bold(){return ES.CreateHTML(this,"b","","")},fixed:function fixed(){return ES.CreateHTML(this,"tt","","")},fontcolor:function fontcolor(color){return ES.CreateHTML(this,"font","color",color)},fontsize:function fontsize(size){return ES.CreateHTML(this,"font","size",size)},italics:function italics(){return ES.CreateHTML(this,"i","","")},link:function link(url){return ES.CreateHTML(this,"a","href",url)},small:function small(){return ES.CreateHTML(this,"small","","")},strike:function strike(){return ES.CreateHTML(this,"strike","","")},sub:function sub(){return ES.CreateHTML(this,"sub","","")},sup:function sub(){return ES.CreateHTML(this,"sup","","")}};_forEach(Object.keys(stringHTMLshims),function(key){var method=String.prototype[key],shouldOverwrite=!1;if(ES.IsCallable(method)){var output=_call(method,"",' " '),quotesCount=_concat([],output.match(/"/g)).length;shouldOverwrite=output!==output.toLowerCase()||quotesCount>2}else shouldOverwrite=!0;shouldOverwrite&&overrideNative(String.prototype,key,stringHTMLshims[key])});var JSONstringifiesSymbols=function(){if(!hasSymbols)return!1;var stringify="object"==typeof JSON&&"function"==typeof JSON.stringify?JSON.stringify:null;if(!stringify)return!1;if(void 0!==stringify(Symbol()))return!0;if("[null]"!==stringify([Symbol()]))return!0;var obj={a:Symbol()};return obj[Symbol()]=!0,"{}"!==stringify(obj)}(),JSONstringifyAcceptsObjectSymbol=valueOrFalseIfThrows(function(){return!hasSymbols||"{}"===JSON.stringify(Object(Symbol()))&&"[{}]"===JSON.stringify([Object(Symbol())])});if(JSONstringifiesSymbols||!JSONstringifyAcceptsObjectSymbol){var origStringify=JSON.stringify;overrideNative(JSON,"stringify",function stringify(value){if("symbol"!=typeof value){var replacer;arguments.length>1&&(replacer=arguments[1]);var args=[value];if(isArray(replacer))args.push(replacer);else{var replaceFn=ES.IsCallable(replacer)?replacer:null;args.push(function(key,val){var parsedValue=replaceFn?_call(replaceFn,this,key,val):val;if("symbol"!=typeof parsedValue)return Type_symbol(parsedValue)?assignTo({})(parsedValue):parsedValue})}return arguments.length>2&&args.push(arguments[2]),origStringify.apply(this,args)}})}return globals})?__WEBPACK_AMD_DEFINE_FACTORY__.call(exports,__webpack_require__,exports,module):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}).call(exports,__webpack_require__(17),__webpack_require__(212))},function(module,exports){var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},function(module,exports,__webpack_require__){"use strict";var supportsDescriptors=__webpack_require__(15).supportsDescriptors,functionsHaveNames=__webpack_require__(128),getPolyfill=__webpack_require__(217),defineProperty=Object.defineProperty,TypeErr=TypeError;module.exports=function shimName(){var polyfill=getPolyfill();if(functionsHaveNames)return polyfill;if(!supportsDescriptors)throw new TypeErr("Shimming Function.prototype.name support requires ES5 property descriptor support.");var functionProto=Function.prototype;return defineProperty(functionProto,"name",{configurable:!0,enumerable:!1,get:function(){var name=polyfill.call(this);return this!==functionProto&&defineProperty(this,"name",{configurable:!0,enumerable:!1,value:name,writable:!1}),name}}),polyfill}},function(module,exports,__webpack_require__){"use strict";var has=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,slice=Array.prototype.slice,isArgs=__webpack_require__(215),isEnumerable=Object.prototype.propertyIsEnumerable,hasDontEnumBug=!isEnumerable.call({toString:null},"toString"),hasProtoEnumBug=isEnumerable.call(function(){},"prototype"),dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],equalsConstructorPrototype=function(o){var ctor=o.constructor;return ctor&&ctor.prototype===o},excludedKeys={$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},hasAutomationEqualityBug=function(){if("undefined"==typeof window)return!1;for(var k in window)try{if(!excludedKeys["$"+k]&&has.call(window,k)&&null!==window[k]&&"object"==typeof window[k])try{equalsConstructorPrototype(window[k])}catch(e){return!0}}catch(e){return!0}return!1}(),keysShim=function keys(object){var isObject=null!==object&&"object"==typeof object,isFunction="[object Function]"===toStr.call(object),isArguments=isArgs(object),isString=isObject&&"[object String]"===toStr.call(object),theKeys=[];if(!isObject&&!isFunction&&!isArguments)throw new TypeError("Object.keys called on a non-object");var skipProto=hasProtoEnumBug&&isFunction;if(isString&&object.length>0&&!has.call(object,0))for(var i=0;i<object.length;++i)theKeys.push(String(i));if(isArguments&&object.length>0)for(var j=0;j<object.length;++j)theKeys.push(String(j));else for(var name in object)skipProto&&"prototype"===name||!has.call(object,name)||theKeys.push(String(name));if(hasDontEnumBug)for(var skipConstructor=function(o){if("undefined"==typeof window||!hasAutomationEqualityBug)return equalsConstructorPrototype(o);try{return equalsConstructorPrototype(o)}catch(e){return!1}}(object),k=0;k<dontEnums.length;++k)skipConstructor&&"constructor"===dontEnums[k]||!has.call(object,dontEnums[k])||theKeys.push(dontEnums[k]);return theKeys};keysShim.shim=function shimObjectKeys(){if(Object.keys){if(!function(){return 2===(Object.keys(arguments)||"").length}(1,2)){var originalKeys=Object.keys;Object.keys=function keys(object){return isArgs(object)?originalKeys(slice.call(object)):originalKeys(object)}}}else Object.keys=keysShim;return Object.keys||keysShim},module.exports=keysShim},function(module,exports,__webpack_require__){"use strict";var toStr=Object.prototype.toString;module.exports=function isArguments(value){var str=toStr.call(value),isArgs="[object Arguments]"===str;return isArgs||(isArgs="[object Array]"!==str&&null!==value&&"object"==typeof value&&"number"==typeof value.length&&value.length>=0&&"[object Function]"===toStr.call(value.callee)),isArgs}},function(module,exports){var hasOwn=Object.prototype.hasOwnProperty,toString=Object.prototype.toString;module.exports=function forEach(obj,fn,ctx){if("[object Function]"!==toString.call(fn))throw new TypeError("iterator must be a function");var l=obj.length;if(l===+l)for(var i=0;i<l;i++)fn.call(ctx,obj[i],i,obj);else for(var k in obj)hasOwn.call(obj,k)&&fn.call(ctx,obj[k],k,obj)}},function(module,exports,__webpack_require__){"use strict";var implementation=__webpack_require__(218);module.exports=function getPolyfill(){return implementation}},function(module,exports,__webpack_require__){"use strict";var isCallable=__webpack_require__(61),functionsHaveNames=__webpack_require__(128),bind=__webpack_require__(22),functionToString=bind.call(Function.call,Function.prototype.toString),stringMatch=bind.call(Function.call,String.prototype.match),classRegex=/^class /,regex=/\s*function\s+([^(\s]*)\s*/,functionProto=Function.prototype;module.exports=function getName(){if(!function isClassConstructor(fn){if(isCallable(fn))return!1;if("function"!=typeof fn)return!1;try{return!!stringMatch(functionToString(fn),classRegex)}catch(e){}return!1}(this)&&!isCallable(this))throw new TypeError("Function.prototype.name sham getter called on non-function");if(functionsHaveNames)return this.name;if(this===functionProto)return"";var str=functionToString(this),match=stringMatch(str,regex);return match&&match[1]}},function(module,exports,__webpack_require__){"use strict";var slice=Array.prototype.slice,toStr=Object.prototype.toString;module.exports=function bind(that){var target=this;if("function"!=typeof target||"[object Function]"!==toStr.call(target))throw new TypeError("Function.prototype.bind called on incompatible "+target);for(var bound,args=slice.call(arguments,1),boundLength=Math.max(0,target.length-args.length),boundArgs=[],i=0;i<boundLength;i++)boundArgs.push("$"+i);if(bound=Function("binder","return function ("+boundArgs.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));return Object(result)===result?result:this}return target.apply(that,args.concat(slice.call(arguments)))}),target.prototype){var Empty=function Empty(){};Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null}return bound}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(221)(),__webpack_require__(232)},function(module,exports,__webpack_require__){"use strict";var define=__webpack_require__(15),getPolyfill=__webpack_require__(222);module.exports=function shimArrayPrototypeIncludes(){var polyfill=getPolyfill();return define(Array.prototype,{includes:polyfill},{includes:function(){return Array.prototype.includes!==polyfill}}),polyfill}},function(module,exports,__webpack_require__){"use strict";var implementation=__webpack_require__(223);module.exports=function getPolyfill(){return Array.prototype.includes||implementation}},function(module,exports,__webpack_require__){"use strict";(function(global){var ES=__webpack_require__(224),$isNaN=Number.isNaN||function isNaN(a){return a!=a},$isFinite=Number.isFinite||function isFinite(n){return"number"==typeof n&&global.isFinite(n)},indexOf=Array.prototype.indexOf;module.exports=function includes(searchElement){var fromIndex=arguments.length>1?ES.ToInteger(arguments[1]):0;if(indexOf&&!$isNaN(searchElement)&&$isFinite(fromIndex)&&void 0!==searchElement)return indexOf.apply(this,arguments)>-1;var O=ES.ToObject(this),length=ES.ToLength(O.length);if(0===length)return!1;for(var k=fromIndex>=0?fromIndex:Math.max(0,length+fromIndex);k<length;){if(ES.SameValueZero(searchElement,O[k]))return!0;k+=1}return!1}}).call(exports,__webpack_require__(17))},function(module,exports,__webpack_require__){"use strict";module.exports=__webpack_require__(129)},function(module,exports,__webpack_require__){"use strict";var hasSymbols="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator,isPrimitive=__webpack_require__(130),isCallable=__webpack_require__(61),isDate=__webpack_require__(226),isSymbol=__webpack_require__(227);module.exports=function ToPrimitive(input,PreferredType){if(isPrimitive(input))return input;var exoticToPrim,hint="default";if(arguments.length>1&&(PreferredType===String?hint="string":PreferredType===Number&&(hint="number")),hasSymbols&&(Symbol.toPrimitive?exoticToPrim=function GetMethod(O,P){var func=O[P];if(null!==func&&void 0!==func){if(!isCallable(func))throw new TypeError(func+" returned for property "+P+" of object "+O+" is not a function");return func}}(input,Symbol.toPrimitive):isSymbol(input)&&(exoticToPrim=Symbol.prototype.valueOf)),void 0!==exoticToPrim){var result=exoticToPrim.call(input,hint);if(isPrimitive(result))return result;throw new TypeError("unable to convert exotic object to primitive")}return"default"===hint&&(isDate(input)||isSymbol(input))&&(hint="string"),function OrdinaryToPrimitive(O,hint){if(void 0===O||null===O)throw new TypeError("Cannot call method on "+O);if("string"!=typeof hint||"number"!==hint&&"string"!==hint)throw new TypeError('hint must be "string" or "number"');var method,result,i,methodNames="string"===hint?["toString","valueOf"]:["valueOf","toString"];for(i=0;i<methodNames.length;++i)if(method=O[methodNames[i]],isCallable(method)&&(result=method.call(O),isPrimitive(result)))return result;throw new TypeError("No default value")}(input,"default"===hint?"number":hint)}},function(module,exports,__webpack_require__){"use strict";var getDay=Date.prototype.getDay,toStr=Object.prototype.toString,hasToStringTag="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;module.exports=function isDateObject(value){return"object"==typeof value&&null!==value&&(hasToStringTag?function tryDateObject(value){try{return getDay.call(value),!0}catch(e){return!1}}(value):"[object Date]"===toStr.call(value))}},function(module,exports,__webpack_require__){"use strict";var toStr=Object.prototype.toString;if("function"==typeof Symbol&&"symbol"==typeof Symbol()){var symToStr=Symbol.prototype.toString,symStringRegex=/^Symbol\(.*\)$/;module.exports=function isSymbol(value){if("symbol"==typeof value)return!0;if("[object Symbol]"!==toStr.call(value))return!1;try{return function isSymbolObject(value){return"symbol"==typeof value.valueOf()&&symStringRegex.test(symToStr.call(value))}(value)}catch(e){return!1}}}else module.exports=function isSymbol(value){return!1}},function(module,exports){module.exports=function isPrimitive(value){return null===value||"function"!=typeof value&&"object"!=typeof value}},function(module,exports,__webpack_require__){"use strict";var $isNaN=__webpack_require__(131),$isFinite=__webpack_require__(132),sign=__webpack_require__(133),mod=__webpack_require__(134),IsCallable=__webpack_require__(61),toPrimitive=__webpack_require__(230),has=__webpack_require__(41),ES5={ToPrimitive:toPrimitive,ToBoolean:function ToBoolean(value){return!!value},ToNumber:function ToNumber(value){return Number(value)},ToInteger:function ToInteger(value){var number=this.ToNumber(value);return $isNaN(number)?0:0!==number&&$isFinite(number)?sign(number)*Math.floor(Math.abs(number)):number},ToInt32:function ToInt32(x){return this.ToNumber(x)>>0},ToUint32:function ToUint32(x){return this.ToNumber(x)>>>0},ToUint16:function ToUint16(value){var number=this.ToNumber(value);if($isNaN(number)||0===number||!$isFinite(number))return 0;var posInt=sign(number)*Math.floor(Math.abs(number));return mod(posInt,65536)},ToString:function ToString(value){return String(value)},ToObject:function ToObject(value){return this.CheckObjectCoercible(value),Object(value)},CheckObjectCoercible:function CheckObjectCoercible(value,optMessage){if(null==value)throw new TypeError(optMessage||"Cannot call method on "+value);return value},IsCallable:IsCallable,SameValue:function SameValue(x,y){return x===y?0!==x||1/x==1/y:$isNaN(x)&&$isNaN(y)},Type:function Type(x){return null===x?"Null":void 0===x?"Undefined":"function"==typeof x||"object"==typeof x?"Object":"number"==typeof x?"Number":"boolean"==typeof x?"Boolean":"string"==typeof x?"String":void 0},IsPropertyDescriptor:function IsPropertyDescriptor(Desc){if("Object"!==this.Type(Desc))return!1;var allowed={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var key in Desc)if(has(Desc,key)&&!allowed[key])return!1;var isData=has(Desc,"[[Value]]"),IsAccessor=has(Desc,"[[Get]]")||has(Desc,"[[Set]]");if(isData&&IsAccessor)throw new TypeError("Property Descriptors may not be both accessor and data descriptors");return!0},IsAccessorDescriptor:function IsAccessorDescriptor(Desc){if(void 0===Desc)return!1;if(!this.IsPropertyDescriptor(Desc))throw new TypeError("Desc must be a Property Descriptor");return!(!has(Desc,"[[Get]]")&&!has(Desc,"[[Set]]"))},IsDataDescriptor:function IsDataDescriptor(Desc){if(void 0===Desc)return!1;if(!this.IsPropertyDescriptor(Desc))throw new TypeError("Desc must be a Property Descriptor");return!(!has(Desc,"[[Value]]")&&!has(Desc,"[[Writable]]"))},IsGenericDescriptor:function IsGenericDescriptor(Desc){if(void 0===Desc)return!1;if(!this.IsPropertyDescriptor(Desc))throw new TypeError("Desc must be a Property Descriptor");return!this.IsAccessorDescriptor(Desc)&&!this.IsDataDescriptor(Desc)},FromPropertyDescriptor:function FromPropertyDescriptor(Desc){if(void 0===Desc)return Desc;if(!this.IsPropertyDescriptor(Desc))throw new TypeError("Desc must be a Property Descriptor");if(this.IsDataDescriptor(Desc))return{value:Desc["[[Value]]"],writable:!!Desc["[[Writable]]"],enumerable:!!Desc["[[Enumerable]]"],configurable:!!Desc["[[Configurable]]"]};if(this.IsAccessorDescriptor(Desc))return{get:Desc["[[Get]]"],set:Desc["[[Set]]"],enumerable:!!Desc["[[Enumerable]]"],configurable:!!Desc["[[Configurable]]"]};throw new TypeError("FromPropertyDescriptor must be called with a fully populated Property Descriptor")},ToPropertyDescriptor:function ToPropertyDescriptor(Obj){if("Object"!==this.Type(Obj))throw new TypeError("ToPropertyDescriptor requires an object");var desc={};if(has(Obj,"enumerable")&&(desc["[[Enumerable]]"]=this.ToBoolean(Obj.enumerable)),has(Obj,"configurable")&&(desc["[[Configurable]]"]=this.ToBoolean(Obj.configurable)),has(Obj,"value")&&(desc["[[Value]]"]=Obj.value),has(Obj,"writable")&&(desc["[[Writable]]"]=this.ToBoolean(Obj.writable)),has(Obj,"get")){var getter=Obj.get;if(void 0!==getter&&!this.IsCallable(getter))throw new TypeError("getter must be a function");desc["[[Get]]"]=getter}if(has(Obj,"set")){var setter=Obj.set;if(void 0!==setter&&!this.IsCallable(setter))throw new TypeError("setter must be a function");desc["[[Set]]"]=setter}if((has(desc,"[[Get]]")||has(desc,"[[Set]]"))&&(has(desc,"[[Value]]")||has(desc,"[[Writable]]")))throw new TypeError("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return desc}};module.exports=ES5},function(module,exports,__webpack_require__){"use strict";var toStr=Object.prototype.toString,isPrimitive=__webpack_require__(130),isCallable=__webpack_require__(61),ES_internalSlots__DefaultValue_=function(O,hint){var actualHint=hint||("[object Date]"===toStr.call(O)?String:Number);if(actualHint===String||actualHint===Number){var value,i,methods=actualHint===String?["toString","valueOf"]:["valueOf","toString"];for(i=0;i<methods.length;++i)if(isCallable(O[methods[i]])&&(value=O[methods[i]](),isPrimitive(value)))return value;throw new TypeError("No default value")}throw new TypeError("invalid [[DefaultValue]] hint supplied")};module.exports=function ToPrimitive(input,PreferredType){return isPrimitive(input)?input:ES_internalSlots__DefaultValue_(input,PreferredType)}},function(module,exports,__webpack_require__){"use strict";var has=__webpack_require__(41),regexExec=RegExp.prototype.exec,gOPD=Object.getOwnPropertyDescriptor,toStr=Object.prototype.toString,hasToStringTag="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;module.exports=function isRegex(value){if(!value||"object"!=typeof value)return!1;if(!hasToStringTag)return"[object RegExp]"===toStr.call(value);var descriptor=gOPD(value,"lastIndex");return!(!descriptor||!has(descriptor,"value"))&&function tryRegexExec(value){try{var lastIndex=value.lastIndex;return value.lastIndex=0,regexExec.call(value),!0}catch(e){return!1}finally{value.lastIndex=lastIndex}}(value)}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(233)(),__webpack_require__(236)(),__webpack_require__(239)(),__webpack_require__(242)(),__webpack_require__(245)(),__webpack_require__(248)},function(module,exports,__webpack_require__){"use strict";var getPolyfill=__webpack_require__(234),define=__webpack_require__(15);module.exports=function shimValues(){var polyfill=getPolyfill();return define(Object,{values:polyfill},{values:function testValues(){return Object.values!==polyfill}}),polyfill}},function(module,exports,__webpack_require__){"use strict";var implementation=__webpack_require__(235);module.exports=function getPolyfill(){return"function"==typeof Object.values?Object.values:implementation}},function(module,exports,__webpack_require__){"use strict";var ES=__webpack_require__(33),has=__webpack_require__(41),isEnumerable=__webpack_require__(22).call(Function.call,Object.prototype.propertyIsEnumerable);module.exports=function values(O){var obj=ES.RequireObjectCoercible(O),vals=[];for(var key in obj)has(obj,key)&&isEnumerable(obj,key)&&vals.push(obj[key]);return vals}},function(module,exports,__webpack_require__){"use strict";var getPolyfill=__webpack_require__(237),define=__webpack_require__(15);module.exports=function shimEntries(){var polyfill=getPolyfill();return define(Object,{entries:polyfill},{entries:function testEntries(){return Object.entries!==polyfill}}),polyfill}},function(module,exports,__webpack_require__){"use strict";var implementation=__webpack_require__(238);module.exports=function getPolyfill(){return"function"==typeof Object.entries?Object.entries:implementation}},function(module,exports,__webpack_require__){"use strict";var ES=__webpack_require__(33),has=__webpack_require__(41),isEnumerable=__webpack_require__(22).call(Function.call,Object.prototype.propertyIsEnumerable);module.exports=function entries(O){var obj=ES.RequireObjectCoercible(O),entrys=[];for(var key in obj)has(obj,key)&&isEnumerable(obj,key)&&entrys.push([key,obj[key]]);return entrys}},function(module,exports,__webpack_require__){"use strict";var getPolyfill=__webpack_require__(240),define=__webpack_require__(15);module.exports=function shimPadStart(){var polyfill=getPolyfill();return define(String.prototype,{padStart:polyfill},{padStart:function(){return String.prototype.padStart!==polyfill}}),polyfill}},function(module,exports,__webpack_require__){"use strict";var implementation=__webpack_require__(241);module.exports=function getPolyfill(){return"function"==typeof String.prototype.padStart?String.prototype.padStart:implementation}},function(module,exports,__webpack_require__){"use strict";var bind=__webpack_require__(22),ES=__webpack_require__(33),slice=bind.call(Function.call,String.prototype.slice);module.exports=function padStart(maxLength){var fillString,O=ES.RequireObjectCoercible(this),S=ES.ToString(O),stringLength=ES.ToLength(S.length);arguments.length>1&&(fillString=arguments[1]);var filler=void 0===fillString?"":ES.ToString(fillString);""===filler&&(filler=" ");var intMaxLength=ES.ToLength(maxLength);if(intMaxLength<=stringLength)return S;for(var fillLen=intMaxLength-stringLength;filler.length<fillLen;){var fLen=filler.length,remainingCodeUnits=fillLen-fLen;filler+=fLen>remainingCodeUnits?slice(filler,0,remainingCodeUnits):filler}return(filler.length>fillLen?slice(filler,0,fillLen):filler)+S}},function(module,exports,__webpack_require__){"use strict";var getPolyfill=__webpack_require__(243),define=__webpack_require__(15);module.exports=function shimPadEnd(){var polyfill=getPolyfill();return define(String.prototype,{padEnd:polyfill},{padEnd:function(){return String.prototype.padEnd!==polyfill}}),polyfill}},function(module,exports,__webpack_require__){"use strict";var implementation=__webpack_require__(244);module.exports=function getPolyfill(){return"function"==typeof String.prototype.padEnd?String.prototype.padEnd:implementation}},function(module,exports,__webpack_require__){"use strict";var bind=__webpack_require__(22),ES=__webpack_require__(33),slice=bind.call(Function.call,String.prototype.slice);module.exports=function padEnd(maxLength){var fillString,O=ES.RequireObjectCoercible(this),S=ES.ToString(O),stringLength=ES.ToLength(S.length);arguments.length>1&&(fillString=arguments[1]);var filler=void 0===fillString?"":ES.ToString(fillString);""===filler&&(filler=" ");var intMaxLength=ES.ToLength(maxLength);if(intMaxLength<=stringLength)return S;for(var fillLen=intMaxLength-stringLength;filler.length<fillLen;){var fLen=filler.length,remainingCodeUnits=fillLen-fLen;filler+=fLen>remainingCodeUnits?slice(filler,0,remainingCodeUnits):filler}return S+(filler.length>fillLen?slice(filler,0,fillLen):filler)}},function(module,exports,__webpack_require__){"use strict";var getPolyfill=__webpack_require__(246),define=__webpack_require__(15);module.exports=function shimGetOwnPropertyDescriptors(){var polyfill=getPolyfill();return define(Object,{getOwnPropertyDescriptors:polyfill},{getOwnPropertyDescriptors:function(){return Object.getOwnPropertyDescriptors!==polyfill}}),polyfill}},function(module,exports,__webpack_require__){"use strict";var implementation=__webpack_require__(247);module.exports=function getPolyfill(){return"function"==typeof Object.getOwnPropertyDescriptors?Object.getOwnPropertyDescriptors:implementation}},function(module,exports,__webpack_require__){"use strict";var ES=__webpack_require__(33),defineProperty=Object.defineProperty,getDescriptor=Object.getOwnPropertyDescriptor,getOwnNames=Object.getOwnPropertyNames,getSymbols=Object.getOwnPropertySymbols,concat=Function.call.bind(Array.prototype.concat),reduce=Function.call.bind(Array.prototype.reduce),getAll=getSymbols?function(obj){return concat(getOwnNames(obj),getSymbols(obj))}:getOwnNames,isES5=ES.IsCallable(getDescriptor)&&ES.IsCallable(getOwnNames);module.exports=function getOwnPropertyDescriptors(value){if(ES.RequireObjectCoercible(value),!isES5)throw new TypeError("getOwnPropertyDescriptors requires Object.getOwnPropertyDescriptor");var O=ES.ToObject(value);return reduce(getAll(O),function(acc,key){var descriptor=getDescriptor(O,key);return void 0!==descriptor&&function put(obj,prop,val){defineProperty&&prop in obj?defineProperty(obj,prop,{configurable:!0,enumerable:!0,value:val,writable:!0}):obj[prop]=val}(acc,key,descriptor),acc},{})}},function(module,exports,__webpack_require__){"use strict";"function"==typeof Promise&&__webpack_require__(249)(),__webpack_require__(252)(),__webpack_require__(255)()},function(module,exports,__webpack_require__){"use strict";var requirePromise=__webpack_require__(86),getPolyfill=__webpack_require__(250),define=__webpack_require__(15);module.exports=function shimPromiseFinally(){requirePromise();var polyfill=getPolyfill();return define(Promise.prototype,{finally:polyfill},{finally:function testFinally(){return Promise.prototype.finally!==polyfill}}),polyfill}},function(module,exports,__webpack_require__){"use strict";var requirePromise=__webpack_require__(86),implementation=__webpack_require__(251);module.exports=function getPolyfill(){return requirePromise(),"function"==typeof Promise.prototype.finally?Promise.prototype.finally:implementation}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(86)();var ES=__webpack_require__(33),bind=__webpack_require__(22),promiseResolve=function PromiseResolve(C,value){return new C(function(resolve){resolve(value)})},OriginalPromise=Promise,then=bind.call(Function.call,OriginalPromise.prototype.then),promiseFinally=function finally_(onFinally){then(this,null,function(){});var C=ES.SpeciesConstructor(this,OriginalPromise),thenFinally=onFinally,catchFinally=onFinally;return ES.IsCallable(onFinally)&&(thenFinally=function CreateThenFinally(C,onFinally){return function(value){var result=onFinally();return promiseResolve(C,result).then(function(){return value})}}(C,onFinally),catchFinally=function CreateCatchFinally(C,onFinally){return function(reason){var result=onFinally();return promiseResolve(C,result).then(function(){throw reason})}}(C,onFinally)),this.then(thenFinally,catchFinally)};if(Object.getOwnPropertyDescriptor){var descriptor=Object.getOwnPropertyDescriptor(promiseFinally,"name");descriptor&&descriptor.configurable&&Object.defineProperty(promiseFinally,"name",{configurable:!0,value:"finally"})}module.exports=promiseFinally},function(module,exports,__webpack_require__){"use strict";var define=__webpack_require__(15),getPolyfill=__webpack_require__(253);module.exports=function shimFlatten(){var polyfill=getPolyfill();return define(Array.prototype,{flatten:polyfill},{flatten:function(){return Array.prototype.flatten!==polyfill}}),polyfill}},function(module,exports,__webpack_require__){"use strict";var implementation=__webpack_require__(254);module.exports=function getPolyfill(){return Array.prototype.flatten||implementation}},function(module,exports,__webpack_require__){"use strict";var ES=__webpack_require__(136),MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1;module.exports=function flatten(){var O=ES.ToObject(this),sourceLen=ES.ToLength(ES.Get(O,"length")),depthNum=1;arguments.length>0&&void 0!==arguments[0]&&(depthNum=ES.ToInteger(arguments[0]));var A=ES.ArraySpeciesCreate(O,0);return function FlattenIntoArray(target,source,sourceLen,start,depth){for(var targetIndex=start,sourceIndex=0;sourceIndex<sourceLen;){var P=ES.ToString(sourceIndex);if(ES.HasProperty(source,P)){var element=ES.Get(source,P),shouldFlatten=!1;if(depth>0&&(shouldFlatten=ES.IsArray(element)),shouldFlatten)targetIndex=FlattenIntoArray(target,element,ES.ToLength(ES.Get(element,"length")),targetIndex,depth-1);else{if(targetIndex>=MAX_SAFE_INTEGER)throw new TypeError("index too large");ES.CreateDataPropertyOrThrow(target,ES.ToString(targetIndex),element),targetIndex+=1}}sourceIndex+=1}return targetIndex}(A,O,sourceLen,0,depthNum),A}},function(module,exports,__webpack_require__){"use strict";var define=__webpack_require__(15),getPolyfill=__webpack_require__(256);module.exports=function shimFlatMap(){var polyfill=getPolyfill();return define(Array.prototype,{flatMap:polyfill},{flatMap:function(){return Array.prototype.flatMap!==polyfill}}),polyfill}},function(module,exports,__webpack_require__){"use strict";var implementation=__webpack_require__(257);module.exports=function getPolyfill(){return Array.prototype.flatMap||implementation}},function(module,exports,__webpack_require__){"use strict";var ES=__webpack_require__(136),MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1;module.exports=function flatMap(callbackfn){var T,O=ES.ToObject(this),sourceLen=ES.ToLength(ES.Get(O,"length"));if(!ES.IsCallable(callbackfn))throw new TypeError("callback must be a function");arguments.length>1&&(T=arguments[1]);var A=ES.ArraySpeciesCreate(O,0);return function FlattenIntoArray(target,source,sourceLen,start,depth){var mapperFunction,targetIndex=start,sourceIndex=0;for(arguments.length>5&&(mapperFunction=arguments[5]);sourceIndex<sourceLen;){var P=ES.ToString(sourceIndex);if(ES.HasProperty(source,P)){var element=ES.Get(source,P);if(void 0!==mapperFunction){if(arguments.length<=6)throw new TypeError("Assertion failed: thisArg is required when mapperFunction is provided");element=ES.Call(mapperFunction,arguments[6],[element,sourceIndex,source])}var shouldFlatten=!1;if(depth>0&&(shouldFlatten=ES.IsArray(element)),shouldFlatten)targetIndex=FlattenIntoArray(target,element,ES.ToLength(ES.Get(element,"length")),targetIndex,depth-1);else{if(targetIndex>=MAX_SAFE_INTEGER)throw new TypeError("index too large");ES.CreateDataPropertyOrThrow(target,ES.ToString(targetIndex),element),targetIndex+=1}}sourceIndex+=1}return targetIndex}(A,O,sourceLen,0,1,callbackfn,T),A}},function(module,exports,__webpack_require__){__webpack_require__(259),module.exports=__webpack_require__(1).Object.assign},function(module,exports,__webpack_require__){var $export=__webpack_require__(5);$export($export.S+$export.F,"Object",{assign:__webpack_require__(163)})},function(module,exports,__webpack_require__){var toIObject=__webpack_require__(28),toLength=__webpack_require__(62),toAbsoluteIndex=__webpack_require__(261);module.exports=function(IS_INCLUDES){return function($this,el,fromIndex){var value,O=toIObject($this),length=toLength(O.length),index=toAbsoluteIndex(fromIndex,length);if(IS_INCLUDES&&el!=el){for(;length>index;)if((value=O[index++])!=value)return!0}else for(;length>index;index++)if((IS_INCLUDES||index in O)&&O[index]===el)return IS_INCLUDES||index||0;return!IS_INCLUDES&&-1}}},function(module,exports,__webpack_require__){var toInteger=__webpack_require__(91),max=Math.max,min=Math.min;module.exports=function(index,length){return(index=toInteger(index))<0?max(index+length,0):min(index,length)}},function(module,exports,__webpack_require__){__webpack_require__(263),module.exports=__webpack_require__(1).Object.keys},function(module,exports,__webpack_require__){var toObject=__webpack_require__(34),$keys=__webpack_require__(44);__webpack_require__(96)("keys",function(){return function keys(it){return $keys(toObject(it))}})},function(module,exports,__webpack_require__){__webpack_require__(265);var $Object=__webpack_require__(1).Object;module.exports=function defineProperty(it,key,desc){return $Object.defineProperty(it,key,desc)}},function(module,exports,__webpack_require__){var $export=__webpack_require__(5);$export($export.S+$export.F*!__webpack_require__(16),"Object",{defineProperty:__webpack_require__(13).f})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PostmsgTransport=exports.KEY=void 0;var _promise2=_interopRequireDefault(__webpack_require__(139)),_classCallCheck3=_interopRequireDefault(__webpack_require__(3)),_createClass3=_interopRequireDefault(__webpack_require__(4));exports.default=function createChannel(_ref){var page=_ref.page,transport=new PostmsgTransport({page:page});return new _channels2.default({transport:transport})};var _global=__webpack_require__(48),_channels2=_interopRequireDefault(__webpack_require__(277)),_jsonStringifySafe2=_interopRequireDefault(__webpack_require__(281));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var KEY=exports.KEY="storybook-channel",PostmsgTransport=exports.PostmsgTransport=function(){function PostmsgTransport(config){var _this=this;if((0,_classCallCheck3.default)(this,PostmsgTransport),this._config=config,this._buffer=[],this._handler=null,_global.window.addEventListener("message",this._handleEvent.bind(this),!1),_global.document.addEventListener("DOMContentLoaded",function(){return _this._flush()}),"manager"!==config.page&&"preview"!==config.page)throw new Error('postmsg-channel: "config.page" cannot be "'+config.page+'"')}return(0,_createClass3.default)(PostmsgTransport,[{key:"setHandler",value:function setHandler(handler){this._handler=handler}},{key:"send",value:function send(event){var _this2=this,iframeWindow=this._getWindow();if(!iframeWindow)return new _promise2.default(function(resolve,reject){_this2._buffer.push({event:event,resolve:resolve,reject:reject})});var data=(0,_jsonStringifySafe2.default)({key:KEY,event:event});return iframeWindow.postMessage(data,"*"),_promise2.default.resolve(null)}},{key:"_flush",value:function _flush(){var _this3=this,buffer=this._buffer;this._buffer=[],buffer.forEach(function(item){_this3.send(item.event).then(item.resolve).catch(item.reject)})}},{key:"_getWindow",value:function _getWindow(){if("manager"===this._config.page){var iframe=_global.document.getElementById("storybook-preview-iframe");return iframe?iframe.contentWindow:null}return _global.window.parent}},{key:"_handleEvent",value:function _handleEvent(rawEvent){try{var data=rawEvent.data,_JSON$parse=JSON.parse(data),key=_JSON$parse.key,event=_JSON$parse.event;key===KEY&&this._handler(event)}catch(error){}}}]),PostmsgTransport}()},function(module,exports,__webpack_require__){__webpack_require__(97),__webpack_require__(37),__webpack_require__(47),__webpack_require__(272),__webpack_require__(275),__webpack_require__(276),module.exports=__webpack_require__(1).Promise},function(module,exports,__webpack_require__){var toInteger=__webpack_require__(91),defined=__webpack_require__(90);module.exports=function(TO_STRING){return function(that,pos){var a,b,s=String(defined(that)),i=toInteger(pos),l=s.length;return i<0||i>=l?TO_STRING?"":void 0:(a=s.charCodeAt(i))<55296||a>56319||i+1===l||(b=s.charCodeAt(i+1))<56320||b>57343?TO_STRING?s.charAt(i):a:TO_STRING?s.slice(i,i+2):b-56320+(a-55296<<10)+65536}}},function(module,exports,__webpack_require__){"use strict";var create=__webpack_require__(73),descriptor=__webpack_require__(43),setToStringTag=__webpack_require__(46),IteratorPrototype={};__webpack_require__(23)(IteratorPrototype,__webpack_require__(6)("iterator"),function(){return this}),module.exports=function(Constructor,NAME,next){Constructor.prototype=create(IteratorPrototype,{next:descriptor(1,next)}),setToStringTag(Constructor,NAME+" Iterator")}},function(module,exports,__webpack_require__){"use strict";var addToUnscopables=__webpack_require__(271),step=__webpack_require__(165),Iterators=__webpack_require__(36),toIObject=__webpack_require__(28);module.exports=__webpack_require__(110)(Array,"Array",function(iterated,kind){this._t=toIObject(iterated),this._i=0,this._k=kind},function(){var O=this._t,kind=this._k,index=this._i++;return!O||index>=O.length?(this._t=void 0,step(1)):step(0,"keys"==kind?index:"values"==kind?O[index]:[index,O[index]])},"values"),Iterators.Arguments=Iterators.Array,addToUnscopables("keys"),addToUnscopables("values"),addToUnscopables("entries")},function(module,exports){module.exports=function(){}},function(module,exports,__webpack_require__){"use strict";var Internal,newGenericPromiseCapability,OwnPromiseCapability,Wrapper,LIBRARY=__webpack_require__(65),global=__webpack_require__(7),ctx=__webpack_require__(18),classof=__webpack_require__(74),$export=__webpack_require__(5),isObject=__webpack_require__(9),aFunction=__webpack_require__(42),anInstance=__webpack_require__(98),forOf=__webpack_require__(52),speciesConstructor=__webpack_require__(144),task=__webpack_require__(145).set,microtask=__webpack_require__(274)(),newPromiseCapabilityModule=__webpack_require__(100),perform=__webpack_require__(146),promiseResolve=__webpack_require__(147),TypeError=global.TypeError,process=global.process,$Promise=global.Promise,isNode="process"==classof(process),empty=function(){},newPromiseCapability=newGenericPromiseCapability=newPromiseCapabilityModule.f,USE_NATIVE=!!function(){try{var promise=$Promise.resolve(1),FakePromise=(promise.constructor={})[__webpack_require__(6)("species")]=function(exec){exec(empty,empty)};return(isNode||"function"==typeof PromiseRejectionEvent)&&promise.then(empty)instanceof FakePromise}catch(e){}}(),isThenable=function(it){var then;return!(!isObject(it)||"function"!=typeof(then=it.then))&&then},notify=function(promise,isReject){if(!promise._n){promise._n=!0;var chain=promise._c;microtask(function(){for(var value=promise._v,ok=1==promise._s,i=0,run=function(reaction){var result,then,handler=ok?reaction.ok:reaction.fail,resolve=reaction.resolve,reject=reaction.reject,domain=reaction.domain;try{handler?(ok||(2==promise._h&&onHandleUnhandled(promise),promise._h=1),!0===handler?result=value:(domain&&domain.enter(),result=handler(value),domain&&domain.exit()),result===reaction.promise?reject(TypeError("Promise-chain cycle")):(then=isThenable(result))?then.call(result,resolve,reject):resolve(result)):reject(value)}catch(e){reject(e)}};chain.length>i;)run(chain[i++]);promise._c=[],promise._n=!1,isReject&&!promise._h&&onUnhandled(promise)})}},onUnhandled=function(promise){task.call(global,function(){var result,handler,console,value=promise._v,unhandled=isUnhandled(promise);if(unhandled&&(result=perform(function(){isNode?process.emit("unhandledRejection",value,promise):(handler=global.onunhandledrejection)?handler({promise:promise,reason:value}):(console=global.console)&&console.error&&console.error("Unhandled promise rejection",value)}),promise._h=isNode||isUnhandled(promise)?2:1),promise._a=void 0,unhandled&&result.e)throw result.v})},isUnhandled=function(promise){return 1!==promise._h&&0===(promise._a||promise._c).length},onHandleUnhandled=function(promise){task.call(global,function(){var handler;isNode?process.emit("rejectionHandled",promise):(handler=global.onrejectionhandled)&&handler({promise:promise,reason:promise._v})})},$reject=function(value){var promise=this;promise._d||(promise._d=!0,(promise=promise._w||promise)._v=value,promise._s=2,promise._a||(promise._a=promise._c.slice()),notify(promise,!0))},$resolve=function(value){var then,promise=this;if(!promise._d){promise._d=!0,promise=promise._w||promise;try{if(promise===value)throw TypeError("Promise can't be resolved itself");(then=isThenable(value))?microtask(function(){var wrapper={_w:promise,_d:!1};try{then.call(value,ctx($resolve,wrapper,1),ctx($reject,wrapper,1))}catch(e){$reject.call(wrapper,e)}}):(promise._v=value,promise._s=1,notify(promise,!1))}catch(e){$reject.call({_w:promise,_d:!1},e)}}};USE_NATIVE||($Promise=function Promise(executor){anInstance(this,$Promise,"Promise","_h"),aFunction(executor),Internal.call(this);try{executor(ctx($resolve,this,1),ctx($reject,this,1))}catch(err){$reject.call(this,err)}},(Internal=function Promise(executor){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=__webpack_require__(101)($Promise.prototype,{then:function then(onFulfilled,onRejected){var reaction=newPromiseCapability(speciesConstructor(this,$Promise));return reaction.ok="function"!=typeof onFulfilled||onFulfilled,reaction.fail="function"==typeof onRejected&&onRejected,reaction.domain=isNode?process.domain:void 0,this._c.push(reaction),this._a&&this._a.push(reaction),this._s&&notify(this,!1),reaction.promise},catch:function(onRejected){return this.then(void 0,onRejected)}}),OwnPromiseCapability=function(){var promise=new Internal;this.promise=promise,this.resolve=ctx($resolve,promise,1),this.reject=ctx($reject,promise,1)},newPromiseCapabilityModule.f=newPromiseCapability=function(C){return C===$Promise||C===Wrapper?new OwnPromiseCapability(C):newGenericPromiseCapability(C)}),$export($export.G+$export.W+$export.F*!USE_NATIVE,{Promise:$Promise}),__webpack_require__(46)($Promise,"Promise"),__webpack_require__(166)("Promise"),Wrapper=__webpack_require__(1).Promise,$export($export.S+$export.F*!USE_NATIVE,"Promise",{reject:function reject(r){var capability=newPromiseCapability(this);return(0,capability.reject)(r),capability.promise}}),$export($export.S+$export.F*(LIBRARY||!USE_NATIVE),"Promise",{resolve:function resolve(x){return promiseResolve(LIBRARY&&this===Wrapper?$Promise:this,x)}}),$export($export.S+$export.F*!(USE_NATIVE&&__webpack_require__(148)(function(iter){$Promise.all(iter).catch(empty)})),"Promise",{all:function all(iterable){var C=this,capability=newPromiseCapability(C),resolve=capability.resolve,reject=capability.reject,result=perform(function(){var values=[],index=0,remaining=1;forOf(iterable,!1,function(promise){var $index=index++,alreadyCalled=!1;values.push(void 0),remaining++,C.resolve(promise).then(function(value){alreadyCalled||(alreadyCalled=!0,values[$index]=value,--remaining||resolve(values))},reject)}),--remaining||resolve(values)});return result.e&&reject(result.v),capability.promise},race:function race(iterable){var C=this,capability=newPromiseCapability(C),reject=capability.reject,result=perform(function(){forOf(iterable,!1,function(promise){C.resolve(promise).then(capability.resolve,reject)})});return result.e&&reject(result.v),capability.promise}})},function(module,exports){module.exports=function(fn,args,that){var un=void 0===that;switch(args.length){case 0:return un?fn():fn.call(that);case 1:return un?fn(args[0]):fn.call(that,args[0]);case 2:return un?fn(args[0],args[1]):fn.call(that,args[0],args[1]);case 3:return un?fn(args[0],args[1],args[2]):fn.call(that,args[0],args[1],args[2]);case 4:return un?fn(args[0],args[1],args[2],args[3]):fn.call(that,args[0],args[1],args[2],args[3])}return fn.apply(that,args)}},function(module,exports,__webpack_require__){var global=__webpack_require__(7),macrotask=__webpack_require__(145).set,Observer=global.MutationObserver||global.WebKitMutationObserver,process=global.process,Promise=global.Promise,isNode="process"==__webpack_require__(45)(process);module.exports=function(){var head,last,notify,flush=function(){var parent,fn;for(isNode&&(parent=process.domain)&&parent.exit();head;){fn=head.fn,head=head.next;try{fn()}catch(e){throw head?notify():last=void 0,e}}last=void 0,parent&&parent.enter()};if(isNode)notify=function(){process.nextTick(flush)};else if(!Observer||global.navigator&&global.navigator.standalone)if(Promise&&Promise.resolve){var promise=Promise.resolve();notify=function(){promise.then(flush)}}else notify=function(){macrotask.call(global,flush)};else{var toggle=!0,node=document.createTextNode("");new Observer(flush).observe(node,{characterData:!0}),notify=function(){node.data=toggle=!toggle}}return function(fn){var task={fn:fn,next:void 0};last&&(last.next=task),head||(head=task,notify()),last=task}}},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(5),core=__webpack_require__(1),global=__webpack_require__(7),speciesConstructor=__webpack_require__(144),promiseResolve=__webpack_require__(147);$export($export.P+$export.R,"Promise",{finally:function(onFinally){var C=speciesConstructor(this,core.Promise||global.Promise),isFunction="function"==typeof onFinally;return this.then(isFunction?function(x){return promiseResolve(C,onFinally()).then(function(){return x})}:onFinally,isFunction?function(e){return promiseResolve(C,onFinally()).then(function(){throw e})}:onFinally)}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(5),newPromiseCapability=__webpack_require__(100),perform=__webpack_require__(146);$export($export.S,"Promise",{try:function(callbackfn){var promiseCapability=newPromiseCapability.f(this),result=perform(callbackfn);return(result.e?promiseCapability.reject:promiseCapability.resolve)(result.v),promiseCapability.promise}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _toConsumableArray3=_interopRequireDefault(__webpack_require__(53)),_keys2=_interopRequireDefault(__webpack_require__(35)),_classCallCheck3=_interopRequireDefault(__webpack_require__(3)),_createClass3=_interopRequireDefault(__webpack_require__(4));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Channel=function(){function Channel(_ref){var transport=_ref.transport;(0,_classCallCheck3.default)(this,Channel),this._sender=this._randomId(),this._transport=transport,this._transport.setHandler(this._handleEvent.bind(this)),this._listeners={}}return(0,_createClass3.default)(Channel,[{key:"addListener",value:function addListener(type,listener){this.on(type,listener)}},{key:"addPeerListener",value:function addPeerListener(type,listener){var _this=this,peerListener=listener;peerListener.isPeer=function(from){return from===_this._sender},this.on(type,peerListener)}},{key:"emit",value:function emit(type){for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];var event={type:type,args:args,from:this._sender};this._transport.send(event)}},{key:"eventNames",value:function eventNames(){return(0,_keys2.default)(this._listeners)}},{key:"listenerCount",value:function listenerCount(type){var listeners=this._listeners[type];return listeners?listeners.length:0}},{key:"listeners",value:function listeners(type){return this._listeners[type]}},{key:"on",value:function on(type,listener){this._listeners[type]=this._listeners[type]||[],this._listeners[type].push(listener)}},{key:"once",value:function once(type,listener){var onceListener=this._onceListener(type,listener);this.on(type,onceListener)}},{key:"prependListener",value:function prependListener(type,listener){this._listeners[type]=this._listeners[type]||[],this._listeners[type].unshift(listener)}},{key:"prependOnceListener",value:function prependOnceListener(type,listener){var onceListener=this._onceListener(type,listener);this.prependListener(type,onceListener)}},{key:"removeAllListeners",value:function removeAllListeners(type){type?this._listeners[type]&&delete this._listeners[type]:this._listeners={}}},{key:"removeListener",value:function removeListener(type,listener){var listeners=this._listeners[type];listeners&&(this._listeners[type]=listeners.filter(function(l){return l!==listener}))}},{key:"_randomId",value:function _randomId(){return Math.random().toString(16).slice(2)}},{key:"_handleEvent",value:function _handleEvent(event){var listeners=this._listeners[event.type];listeners&&listeners.forEach(function(fn){return!(fn.isPeer&&fn.isPeer(event.from))&&fn.apply(void 0,(0,_toConsumableArray3.default)(event.args))})}},{key:"_onceListener",value:function _onceListener(type,listener){var _this2=this;return function onceListener(){return _this2.removeListener(type,onceListener),listener.apply(void 0,arguments)}}}]),Channel}();exports.default=Channel},function(module,exports,__webpack_require__){__webpack_require__(37),__webpack_require__(279),module.exports=__webpack_require__(1).Array.from},function(module,exports,__webpack_require__){"use strict";var ctx=__webpack_require__(18),$export=__webpack_require__(5),toObject=__webpack_require__(34),call=__webpack_require__(142),isArrayIter=__webpack_require__(143),toLength=__webpack_require__(62),createProperty=__webpack_require__(280),getIterFn=__webpack_require__(99);$export($export.S+$export.F*!__webpack_require__(148)(function(iter){Array.from(iter)}),"Array",{from:function from(arrayLike){var length,result,step,iterator,O=toObject(arrayLike),C="function"==typeof this?this:Array,aLen=arguments.length,mapfn=aLen>1?arguments[1]:void 0,mapping=void 0!==mapfn,index=0,iterFn=getIterFn(O);if(mapping&&(mapfn=ctx(mapfn,aLen>2?arguments[2]:void 0,2)),void 0==iterFn||C==Array&&isArrayIter(iterFn))for(result=new C(length=toLength(O.length));length>index;index++)createProperty(result,index,mapping?mapfn(O[index],index):O[index]);else for(iterator=iterFn.call(O),result=new C;!(step=iterator.next()).done;index++)createProperty(result,index,mapping?call(iterator,mapfn,[step.value,index],!0):step.value);return result.length=index,result}})},function(module,exports,__webpack_require__){"use strict";var $defineProperty=__webpack_require__(13),createDesc=__webpack_require__(43);module.exports=function(object,index,value){index in object?$defineProperty.f(object,index,createDesc(0,value)):object[index]=value}},function(module,exports){function serializer(replacer,cycleReplacer){var stack=[],keys=[];return null==cycleReplacer&&(cycleReplacer=function(key,value){return stack[0]===value?"[Circular ~]":"[Circular ~."+keys.slice(0,stack.indexOf(value)).join(".")+"]"}),function(key,value){if(stack.length>0){var thisPos=stack.indexOf(this);~thisPos?stack.splice(thisPos+1):stack.push(this),~thisPos?keys.splice(thisPos,1/0,key):keys.push(key),~stack.indexOf(value)&&(value=cycleReplacer.call(this,key,value))}else stack.push(value);return null==replacer?value:replacer.call(this,key,value)}}(module.exports=function stringify(obj,replacer,spaces,cycleReplacer){return JSON.stringify(obj,serializer(replacer,cycleReplacer),spaces)}).getSerialize=serializer},function(module,exports,__webpack_require__){"use strict";var utils=__webpack_require__(150),formats=__webpack_require__(151),arrayPrefixGenerators={brackets:function brackets(prefix){return prefix+"[]"},indices:function indices(prefix,key){return prefix+"["+key+"]"},repeat:function repeat(prefix){return prefix}},toISO=Date.prototype.toISOString,defaults={delimiter:"&",encode:!0,encoder:utils.encode,encodeValuesOnly:!1,serializeDate:function serializeDate(date){return toISO.call(date)},skipNulls:!1,strictNullHandling:!1},stringify=function stringify(object,prefix,generateArrayPrefix,strictNullHandling,skipNulls,encoder,filter,sort,allowDots,serializeDate,formatter,encodeValuesOnly){var obj=object;if("function"==typeof filter)obj=filter(prefix,obj);else if(obj instanceof Date)obj=serializeDate(obj);else if(null===obj){if(strictNullHandling)return encoder&&!encodeValuesOnly?encoder(prefix,defaults.encoder):prefix;obj=""}if("string"==typeof obj||"number"==typeof obj||"boolean"==typeof obj||utils.isBuffer(obj))return encoder?[formatter(encodeValuesOnly?prefix:encoder(prefix,defaults.encoder))+"="+formatter(encoder(obj,defaults.encoder))]:[formatter(prefix)+"="+formatter(String(obj))];var objKeys,values=[];if(void 0===obj)return values;if(Array.isArray(filter))objKeys=filter;else{var keys=Object.keys(obj);objKeys=sort?keys.sort(sort):keys}for(var i=0;i<objKeys.length;++i){var key=objKeys[i];skipNulls&&null===obj[key]||(values=Array.isArray(obj)?values.concat(stringify(obj[key],generateArrayPrefix(prefix,key),generateArrayPrefix,strictNullHandling,skipNulls,encoder,filter,sort,allowDots,serializeDate,formatter,encodeValuesOnly)):values.concat(stringify(obj[key],prefix+(allowDots?"."+key:"["+key+"]"),generateArrayPrefix,strictNullHandling,skipNulls,encoder,filter,sort,allowDots,serializeDate,formatter,encodeValuesOnly)))}return values};module.exports=function(object,opts){var obj=object,options=opts?utils.assign({},opts):{};if(null!==options.encoder&&void 0!==options.encoder&&"function"!=typeof options.encoder)throw new TypeError("Encoder has to be a function.");var delimiter=void 0===options.delimiter?defaults.delimiter:options.delimiter,strictNullHandling="boolean"==typeof options.strictNullHandling?options.strictNullHandling:defaults.strictNullHandling,skipNulls="boolean"==typeof options.skipNulls?options.skipNulls:defaults.skipNulls,encode="boolean"==typeof options.encode?options.encode:defaults.encode,encoder="function"==typeof options.encoder?options.encoder:defaults.encoder,sort="function"==typeof options.sort?options.sort:null,allowDots=void 0!==options.allowDots&&options.allowDots,serializeDate="function"==typeof options.serializeDate?options.serializeDate:defaults.serializeDate,encodeValuesOnly="boolean"==typeof options.encodeValuesOnly?options.encodeValuesOnly:defaults.encodeValuesOnly;if(void 0===options.format)options.format=formats.default;else if(!Object.prototype.hasOwnProperty.call(formats.formatters,options.format))throw new TypeError("Unknown format option provided.");var objKeys,filter,formatter=formats.formatters[options.format];"function"==typeof options.filter?obj=(filter=options.filter)("",obj):Array.isArray(options.filter)&&(objKeys=filter=options.filter);var arrayFormat,keys=[];if("object"!=typeof obj||null===obj)return"";arrayFormat=options.arrayFormat in arrayPrefixGenerators?options.arrayFormat:"indices"in options?options.indices?"indices":"repeat":"indices";var generateArrayPrefix=arrayPrefixGenerators[arrayFormat];objKeys||(objKeys=Object.keys(obj)),sort&&objKeys.sort(sort);for(var i=0;i<objKeys.length;++i){var key=objKeys[i];skipNulls&&null===obj[key]||(keys=keys.concat(stringify(obj[key],key,generateArrayPrefix,strictNullHandling,skipNulls,encode?encoder:null,filter,sort,allowDots,serializeDate,formatter,encodeValuesOnly)))}var joined=keys.join(delimiter),prefix=!0===options.addQueryPrefix?"?":"";return joined.length>0?prefix+joined:""}},function(module,exports,__webpack_require__){"use strict";var utils=__webpack_require__(150),has=Object.prototype.hasOwnProperty,defaults={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:utils.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},parseKeys=function parseQueryStringKeys(givenKey,val,options){if(givenKey){var key=options.allowDots?givenKey.replace(/\.([^.[]+)/g,"[$1]"):givenKey,child=/(\[[^[\]]*])/g,segment=/(\[[^[\]]*])/.exec(key),parent=segment?key.slice(0,segment.index):key,keys=[];if(parent){if(!options.plainObjects&&has.call(Object.prototype,parent)&&!options.allowPrototypes)return;keys.push(parent)}for(var i=0;null!==(segment=child.exec(key))&&i<options.depth;){if(i+=1,!options.plainObjects&&has.call(Object.prototype,segment[1].slice(1,-1))&&!options.allowPrototypes)return;keys.push(segment[1])}return segment&&keys.push("["+key.slice(segment.index)+"]"),function(chain,val,options){for(var leaf=val,i=chain.length-1;i>=0;--i){var obj,root=chain[i];if("[]"===root)obj=(obj=[]).concat(leaf);else{obj=options.plainObjects?Object.create(null):{};var cleanRoot="["===root.charAt(0)&&"]"===root.charAt(root.length-1)?root.slice(1,-1):root,index=parseInt(cleanRoot,10);!isNaN(index)&&root!==cleanRoot&&String(index)===cleanRoot&&index>=0&&options.parseArrays&&index<=options.arrayLimit?(obj=[])[index]=leaf:obj[cleanRoot]=leaf}leaf=obj}return leaf}(keys,val,options)}};module.exports=function(str,opts){var options=opts?utils.assign({},opts):{};if(null!==options.decoder&&void 0!==options.decoder&&"function"!=typeof options.decoder)throw new TypeError("Decoder has to be a function.");if(options.ignoreQueryPrefix=!0===options.ignoreQueryPrefix,options.delimiter="string"==typeof options.delimiter||utils.isRegExp(options.delimiter)?options.delimiter:defaults.delimiter,options.depth="number"==typeof options.depth?options.depth:defaults.depth,options.arrayLimit="number"==typeof options.arrayLimit?options.arrayLimit:defaults.arrayLimit,options.parseArrays=!1!==options.parseArrays,options.decoder="function"==typeof options.decoder?options.decoder:defaults.decoder,options.allowDots="boolean"==typeof options.allowDots?options.allowDots:defaults.allowDots,options.plainObjects="boolean"==typeof options.plainObjects?options.plainObjects:defaults.plainObjects,options.allowPrototypes="boolean"==typeof options.allowPrototypes?options.allowPrototypes:defaults.allowPrototypes,options.parameterLimit="number"==typeof options.parameterLimit?options.parameterLimit:defaults.parameterLimit,options.strictNullHandling="boolean"==typeof options.strictNullHandling?options.strictNullHandling:defaults.strictNullHandling,""===str||null===str||void 0===str)return options.plainObjects?Object.create(null):{};for(var tempObj="string"==typeof str?function parseQueryStringValues(str,options){for(var obj={},cleanStr=options.ignoreQueryPrefix?str.replace(/^\?/,""):str,limit=options.parameterLimit===1/0?void 0:options.parameterLimit,parts=cleanStr.split(options.delimiter,limit),i=0;i<parts.length;++i){var key,val,part=parts[i],bracketEqualsPos=part.indexOf("]="),pos=-1===bracketEqualsPos?part.indexOf("="):bracketEqualsPos+1;-1===pos?(key=options.decoder(part,defaults.decoder),val=options.strictNullHandling?null:""):(key=options.decoder(part.slice(0,pos),defaults.decoder),val=options.decoder(part.slice(pos+1),defaults.decoder)),has.call(obj,key)?obj[key]=[].concat(obj[key]).concat(val):obj[key]=val}return obj}(str,options):str,obj=options.plainObjects?Object.create(null):{},keys=Object.keys(tempObj),i=0;i<keys.length;++i){var key=keys[i],newObj=parseKeys(key,tempObj[key],options);obj=utils.merge(obj,newObj,options)}return utils.compact(obj)}},function(module,exports,__webpack_require__){"use strict";var m=__webpack_require__(54),n=__webpack_require__(112),p=__webpack_require__(55),q="function"==typeof Symbol&&Symbol.for,r=q?Symbol.for("react.element"):60103,t=q?Symbol.for("react.call"):60104,u=q?Symbol.for("react.return"):60105,v=q?Symbol.for("react.portal"):60106,w=q?Symbol.for("react.fragment"):60107,x="function"==typeof Symbol&&Symbol.iterator;function y(a){for(var b=arguments.length-1,e="Minified React error #"+a+"; visit http://facebook.github.io/react/docs/error-decoder.html?invariant="+a,c=0;c<b;c++)e+="&args[]="+encodeURIComponent(arguments[c+1]);throw(b=Error(e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.")).name="Invariant Violation",b.framesToPop=1,b}var z={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}};function A(a,b,e){this.props=a,this.context=b,this.refs=n,this.updater=e||z}function B(a,b,e){this.props=a,this.context=b,this.refs=n,this.updater=e||z}function C(){}A.prototype.isReactComponent={},A.prototype.setState=function(a,b){"object"!=typeof a&&"function"!=typeof a&&null!=a&&y("85"),this.updater.enqueueSetState(this,a,b,"setState")},A.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,"forceUpdate")},C.prototype=A.prototype;var D=B.prototype=new C;function E(a,b,e){this.props=a,this.context=b,this.refs=n,this.updater=e||z}D.constructor=B,m(D,A.prototype),D.isPureReactComponent=!0;var F=E.prototype=new C;F.constructor=E,m(F,A.prototype),F.unstable_isAsyncReactComponent=!0,F.render=function(){return this.props.children};var G={current:null},H=Object.prototype.hasOwnProperty,I={key:!0,ref:!0,__self:!0,__source:!0};function J(a,b,e){var c,d={},g=null,k=null;if(null!=b)for(c in void 0!==b.ref&&(k=b.ref),void 0!==b.key&&(g=""+b.key),b)H.call(b,c)&&!I.hasOwnProperty(c)&&(d[c]=b[c]);var f=arguments.length-2;if(1===f)d.children=e;else if(1<f){for(var h=Array(f),l=0;l<f;l++)h[l]=arguments[l+2];d.children=h}if(a&&a.defaultProps)for(c in f=a.defaultProps)void 0===d[c]&&(d[c]=f[c]);return{$$typeof:r,type:a,key:g,ref:k,props:d,_owner:G.current}}function K(a){return"object"==typeof a&&null!==a&&a.$$typeof===r}var L=/\/+/g,M=[];function N(a,b,e,c){if(M.length){var d=M.pop();return d.result=a,d.keyPrefix=b,d.func=e,d.context=c,d.count=0,d}return{result:a,keyPrefix:b,func:e,context:c,count:0}}function O(a){a.result=null,a.keyPrefix=null,a.func=null,a.context=null,a.count=0,10>M.length&&M.push(a)}function P(a,b,e,c){var d=typeof a;"undefined"!==d&&"boolean"!==d||(a=null);var g=!1;if(null===a)g=!0;else switch(d){case"string":case"number":g=!0;break;case"object":switch(a.$$typeof){case r:case t:case u:case v:g=!0}}if(g)return e(c,a,""===b?"."+Q(a,0):b),1;if(g=0,b=""===b?".":b+":",Array.isArray(a))for(var k=0;k<a.length;k++){var f=b+Q(d=a[k],k);g+=P(d,f,e,c)}else if(null===a||void 0===a?f=null:f="function"==typeof(f=x&&a[x]||a["@@iterator"])?f:null,"function"==typeof f)for(a=f.call(a),k=0;!(d=a.next()).done;)g+=P(d=d.value,f=b+Q(d,k++),e,c);else"object"===d&&y("31","[object Object]"===(e=""+a)?"object with keys {"+Object.keys(a).join(", ")+"}":e,"");return g}function Q(a,b){return"object"==typeof a&&null!==a&&null!=a.key?function escape(a){var b={"=":"=0",":":"=2"};return"$"+(""+a).replace(/[=:]/g,function(a){return b[a]})}(a.key):b.toString(36)}function R(a,b){a.func.call(a.context,b,a.count++)}function S(a,b,e){var c=a.result,d=a.keyPrefix;a=a.func.call(a.context,b,a.count++),Array.isArray(a)?T(a,c,e,p.thatReturnsArgument):null!=a&&(K(a)&&(b=d+(!a.key||b&&b.key===a.key?"":(""+a.key).replace(L,"$&/")+"/")+e,a={$$typeof:r,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}),c.push(a))}function T(a,b,e,c,d){var g="";null!=e&&(g=(""+e).replace(L,"$&/")+"/"),b=N(b,g,c,d),null==a||P(a,"",S,b),O(b)}var U={Children:{map:function(a,b,e){if(null==a)return a;var c=[];return T(a,c,null,b,e),c},forEach:function(a,b,e){if(null==a)return a;b=N(null,null,b,e),null==a||P(a,"",R,b),O(b)},count:function(a){return null==a?0:P(a,"",p.thatReturnsNull,null)},toArray:function(a){var b=[];return T(a,b,null,p.thatReturnsArgument),b},only:function(a){return K(a)||y("143"),a}},Component:A,PureComponent:B,unstable_AsyncComponent:E,Fragment:w,createElement:J,cloneElement:function(a,b,e){var c=m({},a.props),d=a.key,g=a.ref,k=a._owner;if(null!=b){if(void 0!==b.ref&&(g=b.ref,k=G.current),void 0!==b.key&&(d=""+b.key),a.type&&a.type.defaultProps)var f=a.type.defaultProps;for(h in b)H.call(b,h)&&!I.hasOwnProperty(h)&&(c[h]=void 0===b[h]&&void 0!==f?f[h]:b[h])}var h=arguments.length-2;if(1===h)c.children=e;else if(1<h){f=Array(h);for(var l=0;l<h;l++)f[l]=arguments[l+2];c.children=f}return{$$typeof:r,type:a.type,key:d,ref:g,props:c,_owner:k}},createFactory:function(a){var b=J.bind(null,a);return b.type=a,b},isValidElement:K,version:"16.2.0",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentOwner:G,assign:m}},V=Object.freeze({default:U}),W=V&&U||V;module.exports=W.default?W.default:W},function(module,exports,__webpack_require__){"use strict";var aa=__webpack_require__(0),l=__webpack_require__(286),B=__webpack_require__(54),C=__webpack_require__(55),ba=__webpack_require__(287),da=__webpack_require__(288),ea=__webpack_require__(289),fa=__webpack_require__(290),ia=__webpack_require__(293),D=__webpack_require__(112);function E(a){for(var b=arguments.length-1,c="Minified React error #"+a+"; visit http://facebook.github.io/react/docs/error-decoder.html?invariant="+a,d=0;d<b;d++)c+="&args[]="+encodeURIComponent(arguments[d+1]);throw(b=Error(c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.")).name="Invariant Violation",b.framesToPop=1,b}aa||E("227");var oa={children:!0,dangerouslySetInnerHTML:!0,defaultValue:!0,defaultChecked:!0,innerHTML:!0,suppressContentEditableWarning:!0,suppressHydrationWarning:!0,style:!0};function pa(a,b){return(a&b)===b}var ta={MUST_USE_PROPERTY:1,HAS_BOOLEAN_VALUE:4,HAS_NUMERIC_VALUE:8,HAS_POSITIVE_NUMERIC_VALUE:24,HAS_OVERLOADED_BOOLEAN_VALUE:32,HAS_STRING_BOOLEAN_VALUE:64,injectDOMPropertyConfig:function(a){var b=ta,c=a.Properties||{},d=a.DOMAttributeNamespaces||{},e=a.DOMAttributeNames||{};for(var f in a=a.DOMMutationMethods||{},c){ua.hasOwnProperty(f)&&E("48",f);var g=f.toLowerCase(),h=c[f];1>=(g={attributeName:g,attributeNamespace:null,propertyName:f,mutationMethod:null,mustUseProperty:pa(h,b.MUST_USE_PROPERTY),hasBooleanValue:pa(h,b.HAS_BOOLEAN_VALUE),hasNumericValue:pa(h,b.HAS_NUMERIC_VALUE),hasPositiveNumericValue:pa(h,b.HAS_POSITIVE_NUMERIC_VALUE),hasOverloadedBooleanValue:pa(h,b.HAS_OVERLOADED_BOOLEAN_VALUE),hasStringBooleanValue:pa(h,b.HAS_STRING_BOOLEAN_VALUE)}).hasBooleanValue+g.hasNumericValue+g.hasOverloadedBooleanValue||E("50",f),e.hasOwnProperty(f)&&(g.attributeName=e[f]),d.hasOwnProperty(f)&&(g.attributeNamespace=d[f]),a.hasOwnProperty(f)&&(g.mutationMethod=a[f]),ua[f]=g}}},ua={};function va(a,b){if(oa.hasOwnProperty(a)||2<a.length&&("o"===a[0]||"O"===a[0])&&("n"===a[1]||"N"===a[1]))return!1;if(null===b)return!0;switch(typeof b){case"boolean":return oa.hasOwnProperty(a)?a=!0:(b=wa(a))?a=b.hasBooleanValue||b.hasStringBooleanValue||b.hasOverloadedBooleanValue:a="data-"===(a=a.toLowerCase().slice(0,5))||"aria-"===a,a;case"undefined":case"number":case"string":case"object":return!0;default:return!1}}function wa(a){return ua.hasOwnProperty(a)?ua[a]:null}var xa=ta,ya=xa.MUST_USE_PROPERTY,K=xa.HAS_BOOLEAN_VALUE,za=xa.HAS_NUMERIC_VALUE,Aa=xa.HAS_POSITIVE_NUMERIC_VALUE,Ba=xa.HAS_OVERLOADED_BOOLEAN_VALUE,Ca=xa.HAS_STRING_BOOLEAN_VALUE,Da={Properties:{allowFullScreen:K,async:K,autoFocus:K,autoPlay:K,capture:Ba,checked:ya|K,cols:Aa,contentEditable:Ca,controls:K,default:K,defer:K,disabled:K,download:Ba,draggable:Ca,formNoValidate:K,hidden:K,loop:K,multiple:ya|K,muted:ya|K,noValidate:K,open:K,playsInline:K,readOnly:K,required:K,reversed:K,rows:Aa,rowSpan:za,scoped:K,seamless:K,selected:ya|K,size:Aa,start:za,span:Aa,spellCheck:Ca,style:0,tabIndex:0,itemScope:K,acceptCharset:0,className:0,htmlFor:0,httpEquiv:0,value:Ca},DOMAttributeNames:{acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv"},DOMMutationMethods:{value:function(a,b){if(null==b)return a.removeAttribute("value");"number"!==a.type||!1===a.hasAttribute("value")?a.setAttribute("value",""+b):a.validity&&!a.validity.badInput&&a.ownerDocument.activeElement!==a&&a.setAttribute("value",""+b)}}},Ea=xa.HAS_STRING_BOOLEAN_VALUE,M_xlink="http://www.w3.org/1999/xlink",M_xml="http://www.w3.org/XML/1998/namespace",Ga={Properties:{autoReverse:Ea,externalResourcesRequired:Ea,preserveAlpha:Ea},DOMAttributeNames:{autoReverse:"autoReverse",externalResourcesRequired:"externalResourcesRequired",preserveAlpha:"preserveAlpha"},DOMAttributeNamespaces:{xlinkActuate:M_xlink,xlinkArcrole:M_xlink,xlinkHref:M_xlink,xlinkRole:M_xlink,xlinkShow:M_xlink,xlinkTitle:M_xlink,xlinkType:M_xlink,xmlBase:M_xml,xmlLang:M_xml,xmlSpace:M_xml}},Ha=/[\-\:]([a-z])/g;function Ia(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode x-height xlink:actuate xlink:arcrole xlink:href xlink:role xlink:show xlink:title xlink:type xml:base xmlns:xlink xml:lang xml:space".split(" ").forEach(function(a){var b=a.replace(Ha,Ia);Ga.Properties[b]=0,Ga.DOMAttributeNames[b]=a}),xa.injectDOMPropertyConfig(Da),xa.injectDOMPropertyConfig(Ga);var P={_caughtError:null,_hasCaughtError:!1,_rethrowError:null,_hasRethrowError:!1,injection:{injectErrorUtils:function(a){"function"!=typeof a.invokeGuardedCallback&&E("197"),Ja=a.invokeGuardedCallback}},invokeGuardedCallback:function(a,b,c,d,e,f,g,h,k){Ja.apply(P,arguments)},invokeGuardedCallbackAndCatchFirstError:function(a,b,c,d,e,f,g,h,k){if(P.invokeGuardedCallback.apply(this,arguments),P.hasCaughtError()){var q=P.clearCaughtError();P._hasRethrowError||(P._hasRethrowError=!0,P._rethrowError=q)}},rethrowCaughtError:function(){return function Ka(){if(P._hasRethrowError){var a=P._rethrowError;throw P._rethrowError=null,P._hasRethrowError=!1,a}}.apply(P,arguments)},hasCaughtError:function(){return P._hasCaughtError},clearCaughtError:function(){if(P._hasCaughtError){var a=P._caughtError;return P._caughtError=null,P._hasCaughtError=!1,a}E("198")}};function Ja(a,b,c,d,e,f,g,h,k){P._hasCaughtError=!1,P._caughtError=null;var q=Array.prototype.slice.call(arguments,3);try{b.apply(c,q)}catch(v){P._caughtError=v,P._hasCaughtError=!0}}var La=null,Ma={};function Na(){if(La)for(var a in Ma){var b=Ma[a],c=La.indexOf(a);if(-1<c||E("96",a),!Oa[c])for(var d in b.extractEvents||E("97",a),Oa[c]=b,c=b.eventTypes){var e=void 0,f=c[d],g=b,h=d;Pa.hasOwnProperty(h)&&E("99",h),Pa[h]=f;var k=f.phasedRegistrationNames;if(k){for(e in k)k.hasOwnProperty(e)&&Qa(k[e],g,h);e=!0}else f.registrationName?(Qa(f.registrationName,g,h),e=!0):e=!1;e||E("98",d,a)}}}function Qa(a,b,c){Ra[a]&&E("100",a),Ra[a]=b,Sa[a]=b.eventTypes[c].dependencies}var Oa=[],Pa={},Ra={},Sa={};function Ta(a){La&&E("101"),La=Array.prototype.slice.call(a),Na()}function Ua(a){var c,b=!1;for(c in a)if(a.hasOwnProperty(c)){var d=a[c];Ma.hasOwnProperty(c)&&Ma[c]===d||(Ma[c]&&E("102",c),Ma[c]=d,b=!0)}b&&Na()}var Va=Object.freeze({plugins:Oa,eventNameDispatchConfigs:Pa,registrationNameModules:Ra,registrationNameDependencies:Sa,possibleRegistrationNames:null,injectEventPluginOrder:Ta,injectEventPluginsByName:Ua}),Wa=null,Xa=null,Ya=null;function Za(a,b,c,d){b=a.type||"unknown-event",a.currentTarget=Ya(d),P.invokeGuardedCallbackAndCatchFirstError(b,c,void 0,a),a.currentTarget=null}function $a(a,b){return null==b&&E("30"),null==a?b:Array.isArray(a)?Array.isArray(b)?(a.push.apply(a,b),a):(a.push(b),a):Array.isArray(b)?[a].concat(b):[a,b]}function ab(a,b,c){Array.isArray(a)?a.forEach(b,c):a&&b.call(c,a)}var bb=null;function cb(a,b){if(a){var c=a._dispatchListeners,d=a._dispatchInstances;if(Array.isArray(c))for(var e=0;e<c.length&&!a.isPropagationStopped();e++)Za(a,b,c[e],d[e]);else c&&Za(a,b,c,d);a._dispatchListeners=null,a._dispatchInstances=null,a.isPersistent()||a.constructor.release(a)}}function db(a){return cb(a,!0)}function gb(a){return cb(a,!1)}var hb={injectEventPluginOrder:Ta,injectEventPluginsByName:Ua};function ib(a,b){var c=a.stateNode;if(!c)return null;var d=Wa(c);if(!d)return null;c=d[b];a:switch(b){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":(d=!d.disabled)||(d=!("button"===(a=a.type)||"input"===a||"select"===a||"textarea"===a)),a=!d;break a;default:a=!1}return a?null:(c&&"function"!=typeof c&&E("231",b,typeof c),c)}function jb(a,b,c,d){for(var e,f=0;f<Oa.length;f++){var g=Oa[f];g&&(g=g.extractEvents(a,b,c,d))&&(e=$a(e,g))}return e}function kb(a){a&&(bb=$a(bb,a))}function lb(a){var b=bb;bb=null,b&&(ab(b,a?db:gb),bb&&E("95"),P.rethrowCaughtError())}var mb=Object.freeze({injection:hb,getListener:ib,extractEvents:jb,enqueueEvents:kb,processEventQueue:lb}),nb=Math.random().toString(36).slice(2),Q="__reactInternalInstance$"+nb,ob="__reactEventHandlers$"+nb;function pb(a){if(a[Q])return a[Q];for(var b=[];!a[Q];){if(b.push(a),!a.parentNode)return null;a=a.parentNode}var c=void 0,d=a[Q];if(5===d.tag||6===d.tag)return d;for(;a&&(d=a[Q]);a=b.pop())c=d;return c}function qb(a){if(5===a.tag||6===a.tag)return a.stateNode;E("33")}function rb(a){return a[ob]||null}var sb=Object.freeze({precacheFiberNode:function(a,b){b[Q]=a},getClosestInstanceFromNode:pb,getInstanceFromNode:function(a){return!(a=a[Q])||5!==a.tag&&6!==a.tag?null:a},getNodeFromInstance:qb,getFiberCurrentPropsFromNode:rb,updateFiberProps:function(a,b){a[ob]=b}});function tb(a){do{a=a.return}while(a&&5!==a.tag);return a||null}function ub(a,b,c){for(var d=[];a;)d.push(a),a=tb(a);for(a=d.length;0<a--;)b(d[a],"captured",c);for(a=0;a<d.length;a++)b(d[a],"bubbled",c)}function vb(a,b,c){(b=ib(a,c.dispatchConfig.phasedRegistrationNames[b]))&&(c._dispatchListeners=$a(c._dispatchListeners,b),c._dispatchInstances=$a(c._dispatchInstances,a))}function wb(a){a&&a.dispatchConfig.phasedRegistrationNames&&ub(a._targetInst,vb,a)}function xb(a){if(a&&a.dispatchConfig.phasedRegistrationNames){var b=a._targetInst;ub(b=b?tb(b):null,vb,a)}}function yb(a,b,c){a&&c&&c.dispatchConfig.registrationName&&(b=ib(a,c.dispatchConfig.registrationName))&&(c._dispatchListeners=$a(c._dispatchListeners,b),c._dispatchInstances=$a(c._dispatchInstances,a))}function zb(a){a&&a.dispatchConfig.registrationName&&yb(a._targetInst,null,a)}function Ab(a){ab(a,wb)}function Bb(a,b,c,d){if(c&&d)a:{for(var e=c,f=d,g=0,h=e;h;h=tb(h))g++;h=0;for(var k=f;k;k=tb(k))h++;for(;0<g-h;)e=tb(e),g--;for(;0<h-g;)f=tb(f),h--;for(;g--;){if(e===f||e===f.alternate)break a;e=tb(e),f=tb(f)}e=null}else e=null;for(f=e,e=[];c&&c!==f&&(null===(g=c.alternate)||g!==f);)e.push(c),c=tb(c);for(c=[];d&&d!==f&&(null===(g=d.alternate)||g!==f);)c.push(d),d=tb(d);for(d=0;d<e.length;d++)yb(e[d],"bubbled",a);for(a=c.length;0<a--;)yb(c[a],"captured",b)}var Cb=Object.freeze({accumulateTwoPhaseDispatches:Ab,accumulateTwoPhaseDispatchesSkipTarget:function(a){ab(a,xb)},accumulateEnterLeaveDispatches:Bb,accumulateDirectDispatches:function(a){ab(a,zb)}}),Db=null;function Eb(){return!Db&&l.canUseDOM&&(Db="textContent"in document.documentElement?"textContent":"innerText"),Db}var S={_root:null,_startText:null,_fallbackText:null};function Fb(){if(S._fallbackText)return S._fallbackText;var a,d,b=S._startText,c=b.length,e=Gb(),f=e.length;for(a=0;a<c&&b[a]===e[a];a++);var g=c-a;for(d=1;d<=g&&b[c-d]===e[f-d];d++);return S._fallbackText=e.slice(a,1<d?1-d:void 0),S._fallbackText}function Gb(){return"value"in S._root?S._root.value:S._root[Eb()]}var Hb="dispatchConfig _targetInst nativeEvent isDefaultPrevented isPropagationStopped _dispatchListeners _dispatchInstances".split(" "),Ib={type:null,target:null,currentTarget:C.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};function T(a,b,c,d){for(var e in this.dispatchConfig=a,this._targetInst=b,this.nativeEvent=c,a=this.constructor.Interface)a.hasOwnProperty(e)&&((b=a[e])?this[e]=b(c):"target"===e?this.target=d:this[e]=c[e]);return this.isDefaultPrevented=(null!=c.defaultPrevented?c.defaultPrevented:!1===c.returnValue)?C.thatReturnsTrue:C.thatReturnsFalse,this.isPropagationStopped=C.thatReturnsFalse,this}function Kb(a,b,c,d){if(this.eventPool.length){var e=this.eventPool.pop();return this.call(e,a,b,c,d),e}return new this(a,b,c,d)}function Lb(a){a instanceof this||E("223"),a.destructor(),10>this.eventPool.length&&this.eventPool.push(a)}function Jb(a){a.eventPool=[],a.getPooled=Kb,a.release=Lb}function Mb(a,b,c,d){return T.call(this,a,b,c,d)}function Nb(a,b,c,d){return T.call(this,a,b,c,d)}B(T.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():"unknown"!=typeof a.returnValue&&(a.returnValue=!1),this.isDefaultPrevented=C.thatReturnsTrue)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():"unknown"!=typeof a.cancelBubble&&(a.cancelBubble=!0),this.isPropagationStopped=C.thatReturnsTrue)},persist:function(){this.isPersistent=C.thatReturnsTrue},isPersistent:C.thatReturnsFalse,destructor:function(){var b,a=this.constructor.Interface;for(b in a)this[b]=null;for(a=0;a<Hb.length;a++)this[Hb[a]]=null}}),T.Interface=Ib,T.augmentClass=function(a,b){function c(){}c.prototype=this.prototype;var d=new c;B(d,a.prototype),a.prototype=d,a.prototype.constructor=a,a.Interface=B({},this.Interface,b),a.augmentClass=this.augmentClass,Jb(a)},Jb(T),T.augmentClass(Mb,{data:null}),T.augmentClass(Nb,{data:null});var Xb,Pb=[9,13,27,32],Vb=l.canUseDOM&&"CompositionEvent"in window,Wb=null;if(l.canUseDOM&&"documentMode"in document&&(Wb=document.documentMode),Xb=l.canUseDOM&&"TextEvent"in window&&!Wb){var Yb=window.opera;Xb=!("object"==typeof Yb&&"function"==typeof Yb.version&&12>=parseInt(Yb.version(),10))}var Zb=Xb,$b=l.canUseDOM&&(!Vb||Wb&&8<Wb&&11>=Wb),ac=String.fromCharCode(32),bc={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["topCompositionEnd","topKeyPress","topTextInput","topPaste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"topBlur topCompositionEnd topKeyDown topKeyPress topKeyUp topMouseDown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"topBlur topCompositionStart topKeyDown topKeyPress topKeyUp topMouseDown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"topBlur topCompositionUpdate topKeyDown topKeyPress topKeyUp topMouseDown".split(" ")}},cc=!1;function dc(a,b){switch(a){case"topKeyUp":return-1!==Pb.indexOf(b.keyCode);case"topKeyDown":return 229!==b.keyCode;case"topKeyPress":case"topMouseDown":case"topBlur":return!0;default:return!1}}function ec(a){return"object"==typeof(a=a.detail)&&"data"in a?a.data:null}var fc=!1;var ic={eventTypes:bc,extractEvents:function(a,b,c,d){var e;if(Vb)b:{switch(a){case"topCompositionStart":var f=bc.compositionStart;break b;case"topCompositionEnd":f=bc.compositionEnd;break b;case"topCompositionUpdate":f=bc.compositionUpdate;break b}f=void 0}else fc?dc(a,c)&&(f=bc.compositionEnd):"topKeyDown"===a&&229===c.keyCode&&(f=bc.compositionStart);return f?($b&&(fc||f!==bc.compositionStart?f===bc.compositionEnd&&fc&&(e=Fb()):(S._root=d,S._startText=Gb(),fc=!0)),f=Mb.getPooled(f,b,c,d),e?f.data=e:null!==(e=ec(c))&&(f.data=e),Ab(f),e=f):e=null,(a=Zb?function gc(a,b){switch(a){case"topCompositionEnd":return ec(b);case"topKeyPress":return 32!==b.which?null:(cc=!0,ac);case"topTextInput":return(a=b.data)===ac&&cc?null:a;default:return null}}(a,c):function hc(a,b){if(fc)return"topCompositionEnd"===a||!Vb&&dc(a,b)?(a=Fb(),S._root=null,S._startText=null,S._fallbackText=null,fc=!1,a):null;switch(a){case"topPaste":return null;case"topKeyPress":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;case"topCompositionEnd":return $b?null:b.data;default:return null}}(a,c))?((b=Nb.getPooled(bc.beforeInput,b,c,d)).data=a,Ab(b)):b=null,[e,b]}},jc=null,kc=null,lc=null;function mc(a){if(a=Xa(a)){jc&&"function"==typeof jc.restoreControlledState||E("194");var b=Wa(a.stateNode);jc.restoreControlledState(a.stateNode,a.type,b)}}var nc={injectFiberControlledHostComponent:function(a){jc=a}};function oc(a){kc?lc?lc.push(a):lc=[a]:kc=a}function pc(){if(kc){var a=kc,b=lc;if(lc=kc=null,mc(a),b)for(a=0;a<b.length;a++)mc(b[a])}}var qc=Object.freeze({injection:nc,enqueueStateRestore:oc,restoreStateIfNeeded:pc});function rc(a,b){return a(b)}var sc=!1;function tc(a,b){if(sc)return rc(a,b);sc=!0;try{return rc(a,b)}finally{sc=!1,pc()}}var xc,uc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vc(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return"input"===b?!!uc[a.type]:"textarea"===b}function wc(a){return(a=a.target||a.srcElement||window).correspondingUseElement&&(a=a.correspondingUseElement),3===a.nodeType?a.parentNode:a}function yc(a,b){if(!l.canUseDOM||b&&!("addEventListener"in document))return!1;var c=(b="on"+a)in document;return c||((c=document.createElement("div")).setAttribute(b,"return;"),c="function"==typeof c[b]),!c&&xc&&"wheel"===a&&(c=document.implementation.hasFeature("Events.wheel","3.0")),c}function zc(a){var b=a.type;return(a=a.nodeName)&&"input"===a.toLowerCase()&&("checkbox"===b||"radio"===b)}function Bc(a){a._valueTracker||(a._valueTracker=function Ac(a){var b=zc(a)?"checked":"value",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,b),d=""+a[b];if(!a.hasOwnProperty(b)&&"function"==typeof c.get&&"function"==typeof c.set)return Object.defineProperty(a,b,{enumerable:c.enumerable,configurable:!0,get:function(){return c.get.call(this)},set:function(a){d=""+a,c.set.call(this,a)}}),{getValue:function(){return d},setValue:function(a){d=""+a},stopTracking:function(){a._valueTracker=null,delete a[b]}}}(a))}function Cc(a){if(!a)return!1;var b=a._valueTracker;if(!b)return!0;var c=b.getValue(),d="";return a&&(d=zc(a)?a.checked?"true":"false":a.value),(a=d)!==c&&(b.setValue(a),!0)}l.canUseDOM&&(xc=document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("",""));var Dc={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"topBlur topChange topClick topFocus topInput topKeyDown topKeyUp topSelectionChange".split(" ")}};function Ec(a,b,c){return(a=T.getPooled(Dc.change,a,b,c)).type="change",oc(c),Ab(a),a}var Fc=null,Gc=null;function Hc(a){kb(a),lb(!1)}function Ic(a){if(Cc(qb(a)))return a}function Jc(a,b){if("topChange"===a)return b}var Kc=!1;function Lc(){Fc&&(Fc.detachEvent("onpropertychange",Mc),Gc=Fc=null)}function Mc(a){"value"===a.propertyName&&Ic(Gc)&&tc(Hc,a=Ec(Gc,a,wc(a)))}function Nc(a,b,c){"topFocus"===a?(Lc(),Gc=c,(Fc=b).attachEvent("onpropertychange",Mc)):"topBlur"===a&&Lc()}function Oc(a){if("topSelectionChange"===a||"topKeyUp"===a||"topKeyDown"===a)return Ic(Gc)}function Pc(a,b){if("topClick"===a)return Ic(b)}function $c(a,b){if("topInput"===a||"topChange"===a)return Ic(b)}l.canUseDOM&&(Kc=yc("input")&&(!document.documentMode||9<document.documentMode));var ad={eventTypes:Dc,_isInputEventSupported:Kc,extractEvents:function(a,b,c,d){var e=b?qb(b):window,f=e.nodeName&&e.nodeName.toLowerCase();if("select"===f||"input"===f&&"file"===e.type)var g=Jc;else if(vc(e))if(Kc)g=$c;else{g=Oc;var h=Nc}else!(f=e.nodeName)||"input"!==f.toLowerCase()||"checkbox"!==e.type&&"radio"!==e.type||(g=Pc);if(g&&(g=g(a,b)))return Ec(g,c,d);h&&h(a,e,b),"topBlur"===a&&null!=b&&(a=b._wrapperState||e._wrapperState)&&a.controlled&&"number"===e.type&&(a=""+e.value,e.getAttribute("value")!==a&&e.setAttribute("value",a))}};function bd(a,b,c,d){return T.call(this,a,b,c,d)}T.augmentClass(bd,{view:null,detail:null});var cd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dd(a){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(a):!!(a=cd[a])&&!!b[a]}function ed(){return dd}function fd(a,b,c,d){return T.call(this,a,b,c,d)}bd.augmentClass(fd,{screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:ed,button:null,buttons:null,relatedTarget:function(a){return a.relatedTarget||(a.fromElement===a.srcElement?a.toElement:a.fromElement)}});var gd={mouseEnter:{registrationName:"onMouseEnter",dependencies:["topMouseOut","topMouseOver"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["topMouseOut","topMouseOver"]}},hd={eventTypes:gd,extractEvents:function(a,b,c,d){if("topMouseOver"===a&&(c.relatedTarget||c.fromElement)||"topMouseOut"!==a&&"topMouseOver"!==a)return null;var e=d.window===d?d:(e=d.ownerDocument)?e.defaultView||e.parentWindow:window;if("topMouseOut"===a?(a=b,b=(b=c.relatedTarget||c.toElement)?pb(b):null):a=null,a===b)return null;var f=null==a?e:qb(a);e=null==b?e:qb(b);var g=fd.getPooled(gd.mouseLeave,a,c,d);return g.type="mouseleave",g.target=f,g.relatedTarget=e,(c=fd.getPooled(gd.mouseEnter,b,c,d)).type="mouseenter",c.target=e,c.relatedTarget=f,Bb(g,c,a,b),[g,c]}},id=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner;function jd(a){return"string"==typeof(a=a.type)?a:"function"==typeof a?a.displayName||a.name:null}function kd(a){var b=a;if(a.alternate)for(;b.return;)b=b.return;else{if(0!=(2&b.effectTag))return 1;for(;b.return;)if(0!=(2&(b=b.return).effectTag))return 1}return 3===b.tag?2:3}function ld(a){return!!(a=a._reactInternalFiber)&&2===kd(a)}function md(a){2!==kd(a)&&E("188")}function nd(a){var b=a.alternate;if(!b)return 3===(b=kd(a))&&E("188"),1===b?null:a;for(var c=a,d=b;;){var e=c.return,f=e?e.alternate:null;if(!e||!f)break;if(e.child===f.child){for(var g=e.child;g;){if(g===c)return md(e),a;if(g===d)return md(e),b;g=g.sibling}E("188")}if(c.return!==d.return)c=e,d=f;else{g=!1;for(var h=e.child;h;){if(h===c){g=!0,c=e,d=f;break}if(h===d){g=!0,d=e,c=f;break}h=h.sibling}if(!g){for(h=f.child;h;){if(h===c){g=!0,c=f,d=e;break}if(h===d){g=!0,d=f,c=e;break}h=h.sibling}g||E("189")}}c.alternate!==d&&E("190")}return 3!==c.tag&&E("188"),c.stateNode.current===c?a:b}var qd=[];function rd(a){var b=a.targetInst;do{if(!b){a.ancestors.push(b);break}var c;for(c=b;c.return;)c=c.return;if(!(c=3!==c.tag?null:c.stateNode.containerInfo))break;a.ancestors.push(b),b=pb(c)}while(b);for(c=0;c<a.ancestors.length;c++)b=a.ancestors[c],sd(a.topLevelType,b,a.nativeEvent,wc(a.nativeEvent))}var td=!0,sd=void 0;function ud(a){td=!!a}function U(a,b,c){return c?ba.listen(c,b,vd.bind(null,a)):null}function wd(a,b,c){return c?ba.capture(c,b,vd.bind(null,a)):null}function vd(a,b){if(td){var c=wc(b);if(null===(c=pb(c))||"number"!=typeof c.tag||2===kd(c)||(c=null),qd.length){var d=qd.pop();d.topLevelType=a,d.nativeEvent=b,d.targetInst=c,a=d}else a={topLevelType:a,nativeEvent:b,targetInst:c,ancestors:[]};try{tc(rd,a)}finally{a.topLevelType=null,a.nativeEvent=null,a.targetInst=null,a.ancestors.length=0,10>qd.length&&qd.push(a)}}}var xd=Object.freeze({get _enabled(){return td},get _handleTopLevel(){return sd},setHandleTopLevel:function(a){sd=a},setEnabled:ud,isEnabled:function(){return td},trapBubbledEvent:U,trapCapturedEvent:wd,dispatchEvent:vd});function yd(a,b){var c={};return c[a.toLowerCase()]=b.toLowerCase(),c["Webkit"+a]="webkit"+b,c["Moz"+a]="moz"+b,c["ms"+a]="MS"+b,c["O"+a]="o"+b.toLowerCase(),c}var zd={animationend:yd("Animation","AnimationEnd"),animationiteration:yd("Animation","AnimationIteration"),animationstart:yd("Animation","AnimationStart"),transitionend:yd("Transition","TransitionEnd")},Ad={},Bd={};function Cd(a){if(Ad[a])return Ad[a];if(!zd[a])return a;var c,b=zd[a];for(c in b)if(b.hasOwnProperty(c)&&c in Bd)return Ad[a]=b[c];return""}l.canUseDOM&&(Bd=document.createElement("div").style,"AnimationEvent"in window||(delete zd.animationend.animation,delete zd.animationiteration.animation,delete zd.animationstart.animation),"TransitionEvent"in window||delete zd.transitionend.transition);var Dd={topAbort:"abort",topAnimationEnd:Cd("animationend")||"animationend",topAnimationIteration:Cd("animationiteration")||"animationiteration",topAnimationStart:Cd("animationstart")||"animationstart",topBlur:"blur",topCancel:"cancel",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topChange:"change",topClick:"click",topClose:"close",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topLoadedData:"loadeddata",topLoad:"load",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topScroll:"scroll",topSeeked:"seeked",topSeeking:"seeking",topSelectionChange:"selectionchange",topStalled:"stalled",topSuspend:"suspend",topTextInput:"textInput",topTimeUpdate:"timeupdate",topToggle:"toggle",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topTransitionEnd:Cd("transitionend")||"transitionend",topVolumeChange:"volumechange",topWaiting:"waiting",topWheel:"wheel"},Ed={},Fd=0,Gd="_reactListenersID"+(""+Math.random()).slice(2);function Hd(a){return Object.prototype.hasOwnProperty.call(a,Gd)||(a[Gd]=Fd++,Ed[a[Gd]]={}),Ed[a[Gd]]}function Id(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Jd(a,b){var d,c=Id(a);for(a=0;c;){if(3===c.nodeType){if(d=a+c.textContent.length,a<=b&&d>=b)return{node:c,offset:b-a};a=d}a:{for(;c;){if(c.nextSibling){c=c.nextSibling;break a}c=c.parentNode}c=void 0}c=Id(c)}}function Kd(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return b&&("input"===b&&"text"===a.type||"textarea"===b||"true"===a.contentEditable)}var Ld=l.canUseDOM&&"documentMode"in document&&11>=document.documentMode,Md={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"topBlur topContextMenu topFocus topKeyDown topKeyUp topMouseDown topMouseUp topSelectionChange".split(" ")}},Nd=null,Od=null,Pd=null,Qd=!1;function Rd(a,b){if(Qd||null==Nd||Nd!==da())return null;var c=Nd;return"selectionStart"in c&&Kd(c)?c={start:c.selectionStart,end:c.selectionEnd}:window.getSelection?c={anchorNode:(c=window.getSelection()).anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}:c=void 0,Pd&&ea(Pd,c)?null:(Pd=c,(a=T.getPooled(Md.select,Od,a,b)).type="select",a.target=Nd,Ab(a),a)}var Sd={eventTypes:Md,extractEvents:function(a,b,c,d){var f,e=d.window===d?d.document:9===d.nodeType?d:d.ownerDocument;if(!(f=!e)){a:{e=Hd(e),f=Sa.onSelect;for(var g=0;g<f.length;g++){var h=f[g];if(!e.hasOwnProperty(h)||!e[h]){e=!1;break a}}e=!0}f=!e}if(f)return null;switch(e=b?qb(b):window,a){case"topFocus":(vc(e)||"true"===e.contentEditable)&&(Nd=e,Od=b,Pd=null);break;case"topBlur":Pd=Od=Nd=null;break;case"topMouseDown":Qd=!0;break;case"topContextMenu":case"topMouseUp":return Qd=!1,Rd(c,d);case"topSelectionChange":if(Ld)break;case"topKeyDown":case"topKeyUp":return Rd(c,d)}return null}};function Td(a,b,c,d){return T.call(this,a,b,c,d)}function Ud(a,b,c,d){return T.call(this,a,b,c,d)}function Vd(a,b,c,d){return T.call(this,a,b,c,d)}function Wd(a){var b=a.keyCode;return"charCode"in a?0===(a=a.charCode)&&13===b&&(a=13):a=b,32<=a||13===a?a:0}T.augmentClass(Td,{animationName:null,elapsedTime:null,pseudoElement:null}),T.augmentClass(Ud,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),bd.augmentClass(Vd,{relatedTarget:null});var Xd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Yd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};function Zd(a,b,c,d){return T.call(this,a,b,c,d)}function $d(a,b,c,d){return T.call(this,a,b,c,d)}function ae(a,b,c,d){return T.call(this,a,b,c,d)}function be(a,b,c,d){return T.call(this,a,b,c,d)}function ce(a,b,c,d){return T.call(this,a,b,c,d)}bd.augmentClass(Zd,{key:function(a){if(a.key){var b=Xd[a.key]||a.key;if("Unidentified"!==b)return b}return"keypress"===a.type?13===(a=Wd(a))?"Enter":String.fromCharCode(a):"keydown"===a.type||"keyup"===a.type?Yd[a.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:ed,charCode:function(a){return"keypress"===a.type?Wd(a):0},keyCode:function(a){return"keydown"===a.type||"keyup"===a.type?a.keyCode:0},which:function(a){return"keypress"===a.type?Wd(a):"keydown"===a.type||"keyup"===a.type?a.keyCode:0}}),fd.augmentClass($d,{dataTransfer:null}),bd.augmentClass(ae,{touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:ed}),T.augmentClass(be,{propertyName:null,elapsedTime:null,pseudoElement:null}),fd.augmentClass(ce,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:null,deltaMode:null});var de={},ee={};"abort animationEnd animationIteration animationStart blur cancel canPlay canPlayThrough click close contextMenu copy cut doubleClick drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error focus input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing progress rateChange reset scroll seeked seeking stalled submit suspend timeUpdate toggle touchCancel touchEnd touchMove touchStart transitionEnd volumeChange waiting wheel".split(" ").forEach(function(a){var b=a[0].toUpperCase()+a.slice(1),c="on"+b;c={phasedRegistrationNames:{bubbled:c,captured:c+"Capture"},dependencies:[b="top"+b]},de[a]=c,ee[b]=c});var fe={eventTypes:de,extractEvents:function(a,b,c,d){var e=ee[a];if(!e)return null;switch(a){case"topKeyPress":if(0===Wd(c))return null;case"topKeyDown":case"topKeyUp":a=Zd;break;case"topBlur":case"topFocus":a=Vd;break;case"topClick":if(2===c.button)return null;case"topDoubleClick":case"topMouseDown":case"topMouseMove":case"topMouseUp":case"topMouseOut":case"topMouseOver":case"topContextMenu":a=fd;break;case"topDrag":case"topDragEnd":case"topDragEnter":case"topDragExit":case"topDragLeave":case"topDragOver":case"topDragStart":case"topDrop":a=$d;break;case"topTouchCancel":case"topTouchEnd":case"topTouchMove":case"topTouchStart":a=ae;break;case"topAnimationEnd":case"topAnimationIteration":case"topAnimationStart":a=Td;break;case"topTransitionEnd":a=be;break;case"topScroll":a=bd;break;case"topWheel":a=ce;break;case"topCopy":case"topCut":case"topPaste":a=Ud;break;default:a=T}return Ab(b=a.getPooled(e,b,c,d)),b}};sd=function(a,b,c,d){kb(a=jb(a,b,c,d)),lb(!1)},hb.injectEventPluginOrder("ResponderEventPlugin SimpleEventPlugin TapEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),Wa=sb.getFiberCurrentPropsFromNode,Xa=sb.getInstanceFromNode,Ya=sb.getNodeFromInstance,hb.injectEventPluginsByName({SimpleEventPlugin:fe,EnterLeaveEventPlugin:hd,ChangeEventPlugin:ad,SelectEventPlugin:Sd,BeforeInputEventPlugin:ic});var ge=[],he=-1;function V(a){0>he||(a.current=ge[he],ge[he]=null,he--)}function W(a,b){ge[++he]=a.current,a.current=b}new Set;var ie={current:D},X={current:!1},je=D;function ke(a){return le(a)?je:ie.current}function me(a,b){var c=a.type.contextTypes;if(!c)return D;var d=a.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===b)return d.__reactInternalMemoizedMaskedChildContext;var f,e={};for(f in c)e[f]=b[f];return d&&((a=a.stateNode).__reactInternalMemoizedUnmaskedChildContext=b,a.__reactInternalMemoizedMaskedChildContext=e),e}function le(a){return 2===a.tag&&null!=a.type.childContextTypes}function ne(a){le(a)&&(V(X),V(ie))}function oe(a,b,c){null!=ie.cursor&&E("168"),W(ie,b),W(X,c)}function pe(a,b){var c=a.stateNode,d=a.type.childContextTypes;if("function"!=typeof c.getChildContext)return b;for(var e in c=c.getChildContext())e in d||E("108",jd(a)||"Unknown",e);return B({},b,c)}function qe(a){if(!le(a))return!1;var b=a.stateNode;return b=b&&b.__reactInternalMemoizedMergedChildContext||D,je=ie.current,W(ie,b),W(X,X.current),!0}function re(a,b){var c=a.stateNode;if(c||E("169"),b){var d=pe(a,je);c.__reactInternalMemoizedMergedChildContext=d,V(X),V(ie),W(ie,d)}else V(X);W(X,b)}function Y(a,b,c){this.tag=a,this.key=b,this.stateNode=this.type=null,this.sibling=this.child=this.return=null,this.index=0,this.memoizedState=this.updateQueue=this.memoizedProps=this.pendingProps=this.ref=null,this.internalContextTag=c,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.expirationTime=0,this.alternate=null}function se(a,b,c){var d=a.alternate;return null===d?((d=new Y(a.tag,a.key,a.internalContextTag)).type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.effectTag=0,d.nextEffect=null,d.firstEffect=null,d.lastEffect=null),d.expirationTime=c,d.pendingProps=b,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d}function te(a,b,c){var d=void 0,e=a.type,f=a.key;return"function"==typeof e?((d=e.prototype&&e.prototype.isReactComponent?new Y(2,f,b):new Y(0,f,b)).type=e,d.pendingProps=a.props):"string"==typeof e?((d=new Y(5,f,b)).type=e,d.pendingProps=a.props):"object"==typeof e&&null!==e&&"number"==typeof e.tag?(d=e).pendingProps=a.props:E("130",null==e?e:typeof e,""),d.expirationTime=c,d}function ue(a,b,c,d){return(b=new Y(10,d,b)).pendingProps=a,b.expirationTime=c,b}function ve(a,b,c){return(b=new Y(6,null,b)).pendingProps=a,b.expirationTime=c,b}function we(a,b,c){return(b=new Y(7,a.key,b)).type=a.handler,b.pendingProps=a,b.expirationTime=c,b}function xe(a,b,c){return(a=new Y(9,null,b)).expirationTime=c,a}function ye(a,b,c){return(b=new Y(4,a.key,b)).pendingProps=a.children||[],b.expirationTime=c,b.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},b}var ze=null,Ae=null;function Be(a){return function(b){try{return a(b)}catch(c){}}}function De(a){"function"==typeof ze&&ze(a)}function Ee(a){"function"==typeof Ae&&Ae(a)}function Fe(a){return{baseState:a,expirationTime:0,first:null,last:null,callbackList:null,hasForceUpdate:!1,isInitialized:!1}}function Ge(a,b){null===a.last?a.first=a.last=b:(a.last.next=b,a.last=b),(0===a.expirationTime||a.expirationTime>b.expirationTime)&&(a.expirationTime=b.expirationTime)}function He(a,b){var c=a.alternate,d=a.updateQueue;null===d&&(d=a.updateQueue=Fe(null)),null!==c?null===(a=c.updateQueue)&&(a=c.updateQueue=Fe(null)):a=null,null===(a=a!==d?a:null)?Ge(d,b):null===d.last||null===a.last?(Ge(d,b),Ge(a,b)):(Ge(d,b),a.last=b)}function Ie(a,b,c,d){return"function"==typeof(a=a.partialState)?a.call(b,c,d):a}function Je(a,b,c,d,e,f){null!==a&&a.updateQueue===c&&(c=b.updateQueue={baseState:c.baseState,expirationTime:c.expirationTime,first:c.first,last:c.last,isInitialized:c.isInitialized,callbackList:null,hasForceUpdate:!1}),c.expirationTime=0,c.isInitialized?a=c.baseState:(a=c.baseState=b.memoizedState,c.isInitialized=!0);for(var g=!0,h=c.first,k=!1;null!==h;){var q=h.expirationTime;if(q>f){var v=c.expirationTime;(0===v||v>q)&&(c.expirationTime=q),k||(k=!0,c.baseState=a)}else k||(c.first=h.next,null===c.first&&(c.last=null)),h.isReplace?(a=Ie(h,d,a,e),g=!0):(q=Ie(h,d,a,e))&&(a=g?B({},a,q):B(a,q),g=!1),h.isForced&&(c.hasForceUpdate=!0),null!==h.callback&&(null===(q=c.callbackList)&&(q=c.callbackList=[]),q.push(h));h=h.next}return null!==c.callbackList?b.effectTag|=32:null!==c.first||c.hasForceUpdate||(b.updateQueue=null),k||(c.baseState=a),a}function Ke(a,b){var c=a.callbackList;if(null!==c)for(a.callbackList=null,a=0;a<c.length;a++){var d=c[a],e=d.callback;d.callback=null,"function"!=typeof e&&E("191",e),e.call(b)}}var Qe="function"==typeof Symbol&&Symbol.for,Re=Qe?Symbol.for("react.element"):60103,Se=Qe?Symbol.for("react.call"):60104,Te=Qe?Symbol.for("react.return"):60105,Ue=Qe?Symbol.for("react.portal"):60106,Ve=Qe?Symbol.for("react.fragment"):60107,We="function"==typeof Symbol&&Symbol.iterator;function Xe(a){return null===a||void 0===a?null:"function"==typeof(a=We&&a[We]||a["@@iterator"])?a:null}var Ye=Array.isArray;function Ze(a,b){var c=b.ref;if(null!==c&&"function"!=typeof c){if(b._owner){var d=void 0;(b=b._owner)&&(2!==b.tag&&E("110"),d=b.stateNode),d||E("147",c);var e=""+c;return null!==a&&null!==a.ref&&a.ref._stringRef===e?a.ref:((a=function(a){var b=d.refs===D?d.refs={}:d.refs;null===a?delete b[e]:b[e]=a})._stringRef=e,a)}"string"!=typeof c&&E("148"),b._owner||E("149",c)}return c}function $e(a,b){"textarea"!==a.type&&E("31","[object Object]"===Object.prototype.toString.call(b)?"object with keys {"+Object.keys(b).join(", ")+"}":b,"")}function af(a){function b(b,c){if(a){var d=b.lastEffect;null!==d?(d.nextEffect=c,b.lastEffect=c):b.firstEffect=b.lastEffect=c,c.nextEffect=null,c.effectTag=8}}function c(c,d){if(!a)return null;for(;null!==d;)b(c,d),d=d.sibling;return null}function d(a,b){for(a=new Map;null!==b;)null!==b.key?a.set(b.key,b):a.set(b.index,b),b=b.sibling;return a}function e(a,b,c){return(a=se(a,b,c)).index=0,a.sibling=null,a}function f(b,c,d){return b.index=d,a?null!==(d=b.alternate)?(d=d.index)<c?(b.effectTag=2,c):d:(b.effectTag=2,c):c}function g(b){return a&&null===b.alternate&&(b.effectTag=2),b}function h(a,b,c,d){return null===b||6!==b.tag?((b=ve(c,a.internalContextTag,d)).return=a,b):((b=e(b,c,d)).return=a,b)}function k(a,b,c,d){return null!==b&&b.type===c.type?((d=e(b,c.props,d)).ref=Ze(b,c),d.return=a,d):((d=te(c,a.internalContextTag,d)).ref=Ze(b,c),d.return=a,d)}function q(a,b,c,d){return null===b||7!==b.tag?((b=we(c,a.internalContextTag,d)).return=a,b):((b=e(b,c,d)).return=a,b)}function v(a,b,c,d){return null===b||9!==b.tag?((b=xe(c,a.internalContextTag,d)).type=c.value,b.return=a,b):((b=e(b,null,d)).type=c.value,b.return=a,b)}function y(a,b,c,d){return null===b||4!==b.tag||b.stateNode.containerInfo!==c.containerInfo||b.stateNode.implementation!==c.implementation?((b=ye(c,a.internalContextTag,d)).return=a,b):((b=e(b,c.children||[],d)).return=a,b)}function u(a,b,c,d,f){return null===b||10!==b.tag?((b=ue(c,a.internalContextTag,d,f)).return=a,b):((b=e(b,c,d)).return=a,b)}function z(a,b,c){if("string"==typeof b||"number"==typeof b)return(b=ve(""+b,a.internalContextTag,c)).return=a,b;if("object"==typeof b&&null!==b){switch(b.$$typeof){case Re:return b.type===Ve?((b=ue(b.props.children,a.internalContextTag,c,b.key)).return=a,b):((c=te(b,a.internalContextTag,c)).ref=Ze(null,b),c.return=a,c);case Se:return(b=we(b,a.internalContextTag,c)).return=a,b;case Te:return(c=xe(b,a.internalContextTag,c)).type=b.value,c.return=a,c;case Ue:return(b=ye(b,a.internalContextTag,c)).return=a,b}if(Ye(b)||Xe(b))return(b=ue(b,a.internalContextTag,c,null)).return=a,b;$e(a,b)}return null}function G(a,b,c,d){var e=null!==b?b.key:null;if("string"==typeof c||"number"==typeof c)return null!==e?null:h(a,b,""+c,d);if("object"==typeof c&&null!==c){switch(c.$$typeof){case Re:return c.key===e?c.type===Ve?u(a,b,c.props.children,d,e):k(a,b,c,d):null;case Se:return c.key===e?q(a,b,c,d):null;case Te:return null===e?v(a,b,c,d):null;case Ue:return c.key===e?y(a,b,c,d):null}if(Ye(c)||Xe(c))return null!==e?null:u(a,b,c,d,null);$e(a,c)}return null}function I(a,b,c,d,e){if("string"==typeof d||"number"==typeof d)return h(b,a=a.get(c)||null,""+d,e);if("object"==typeof d&&null!==d){switch(d.$$typeof){case Re:return a=a.get(null===d.key?c:d.key)||null,d.type===Ve?u(b,a,d.props.children,e,d.key):k(b,a,d,e);case Se:return q(b,a=a.get(null===d.key?c:d.key)||null,d,e);case Te:return v(b,a=a.get(c)||null,d,e);case Ue:return y(b,a=a.get(null===d.key?c:d.key)||null,d,e)}if(Ye(d)||Xe(d))return u(b,a=a.get(c)||null,d,e,null);$e(b,d)}return null}function L(e,g,m,A){for(var h=null,r=null,n=g,w=g=0,k=null;null!==n&&w<m.length;w++){n.index>w?(k=n,n=null):k=n.sibling;var x=G(e,n,m[w],A);if(null===x){null===n&&(n=k);break}a&&n&&null===x.alternate&&b(e,n),g=f(x,g,w),null===r?h=x:r.sibling=x,r=x,n=k}if(w===m.length)return c(e,n),h;if(null===n){for(;w<m.length;w++)(n=z(e,m[w],A))&&(g=f(n,g,w),null===r?h=n:r.sibling=n,r=n);return h}for(n=d(e,n);w<m.length;w++)(k=I(n,e,w,m[w],A))&&(a&&null!==k.alternate&&n.delete(null===k.key?w:k.key),g=f(k,g,w),null===r?h=k:r.sibling=k,r=k);return a&&n.forEach(function(a){return b(e,a)}),h}function N(e,g,m,A){var h=Xe(m);"function"!=typeof h&&E("150"),null==(m=h.call(m))&&E("151");for(var r=h=null,n=g,w=g=0,k=null,x=m.next();null!==n&&!x.done;w++,x=m.next()){n.index>w?(k=n,n=null):k=n.sibling;var J=G(e,n,x.value,A);if(null===J){n||(n=k);break}a&&n&&null===J.alternate&&b(e,n),g=f(J,g,w),null===r?h=J:r.sibling=J,r=J,n=k}if(x.done)return c(e,n),h;if(null===n){for(;!x.done;w++,x=m.next())null!==(x=z(e,x.value,A))&&(g=f(x,g,w),null===r?h=x:r.sibling=x,r=x);return h}for(n=d(e,n);!x.done;w++,x=m.next())null!==(x=I(n,e,w,x.value,A))&&(a&&null!==x.alternate&&n.delete(null===x.key?w:x.key),g=f(x,g,w),null===r?h=x:r.sibling=x,r=x);return a&&n.forEach(function(a){return b(e,a)}),h}return function(a,d,f,h){"object"==typeof f&&null!==f&&f.type===Ve&&null===f.key&&(f=f.props.children);var m="object"==typeof f&&null!==f;if(m)switch(f.$$typeof){case Re:a:{var r=f.key;for(m=d;null!==m;){if(m.key===r){if(10===m.tag?f.type===Ve:m.type===f.type){c(a,m.sibling),(d=e(m,f.type===Ve?f.props.children:f.props,h)).ref=Ze(m,f),d.return=a,a=d;break a}c(a,m);break}b(a,m),m=m.sibling}f.type===Ve?((d=ue(f.props.children,a.internalContextTag,h,f.key)).return=a,a=d):((h=te(f,a.internalContextTag,h)).ref=Ze(d,f),h.return=a,a=h)}return g(a);case Se:a:{for(m=f.key;null!==d;){if(d.key===m){if(7===d.tag){c(a,d.sibling),(d=e(d,f,h)).return=a,a=d;break a}c(a,d);break}b(a,d),d=d.sibling}(d=we(f,a.internalContextTag,h)).return=a,a=d}return g(a);case Te:a:{if(null!==d){if(9===d.tag){c(a,d.sibling),(d=e(d,null,h)).type=f.value,d.return=a,a=d;break a}c(a,d)}(d=xe(f,a.internalContextTag,h)).type=f.value,d.return=a,a=d}return g(a);case Ue:a:{for(m=f.key;null!==d;){if(d.key===m){if(4===d.tag&&d.stateNode.containerInfo===f.containerInfo&&d.stateNode.implementation===f.implementation){c(a,d.sibling),(d=e(d,f.children||[],h)).return=a,a=d;break a}c(a,d);break}b(a,d),d=d.sibling}(d=ye(f,a.internalContextTag,h)).return=a,a=d}return g(a)}if("string"==typeof f||"number"==typeof f)return f=""+f,null!==d&&6===d.tag?(c(a,d.sibling),d=e(d,f,h)):(c(a,d),d=ve(f,a.internalContextTag,h)),d.return=a,g(a=d);if(Ye(f))return L(a,d,f,h);if(Xe(f))return N(a,d,f,h);if(m&&$e(a,f),void 0===f)switch(a.tag){case 2:case 1:E("152",(h=a.type).displayName||h.name||"Component")}return c(a,d)}}var bf=af(!0),cf=af(!1);function df(a,b,c,d,e){function f(a,b,c){var d=b.expirationTime;b.child=null===a?cf(b,null,c,d):bf(b,a.child,c,d)}function g(a,b){var c=b.ref;null===c||a&&a.ref===c||(b.effectTag|=128)}function h(a,b,c,d){if(g(a,b),!c)return d&&re(b,!1),q(a,b);c=b.stateNode,id.current=b;var e=c.render();return b.effectTag|=1,f(a,b,e),b.memoizedState=c.state,b.memoizedProps=c.props,d&&re(b,!0),b.child}function k(a){var b=a.stateNode;b.pendingContext?oe(0,b.pendingContext,b.pendingContext!==b.context):b.context&&oe(0,b.context,!1),I(a,b.containerInfo)}function q(a,b){if(null!==a&&b.child!==a.child&&E("153"),null!==b.child){var c=se(a=b.child,a.pendingProps,a.expirationTime);for(b.child=c,c.return=b;null!==a.sibling;)a=a.sibling,(c=c.sibling=se(a,a.pendingProps,a.expirationTime)).return=b;c.sibling=null}return b.child}function v(a,b){switch(b.tag){case 3:k(b);break;case 2:qe(b);break;case 4:I(b,b.stateNode.containerInfo)}return null}var y=a.shouldSetTextContent,u=a.useSyncScheduling,z=a.shouldDeprioritizeSubtree,G=b.pushHostContext,I=b.pushHostContainer,L=c.enterHydrationState,N=c.resetHydrationState,J=c.tryToClaimNextHydratableInstance,w=(a=function Le(a,b,c,d){function e(a,b){b.updater=f,a.stateNode=b,b._reactInternalFiber=a}var f={isMounted:ld,enqueueSetState:function(c,d,e){c=c._reactInternalFiber,e=void 0===e?null:e;var g=b(c);He(c,{expirationTime:g,partialState:d,callback:e,isReplace:!1,isForced:!1,nextCallback:null,next:null}),a(c,g)},enqueueReplaceState:function(c,d,e){c=c._reactInternalFiber,e=void 0===e?null:e;var g=b(c);He(c,{expirationTime:g,partialState:d,callback:e,isReplace:!0,isForced:!1,nextCallback:null,next:null}),a(c,g)},enqueueForceUpdate:function(c,d){c=c._reactInternalFiber,d=void 0===d?null:d;var e=b(c);He(c,{expirationTime:e,partialState:null,callback:d,isReplace:!1,isForced:!0,nextCallback:null,next:null}),a(c,e)}};return{adoptClassInstance:e,constructClassInstance:function(a,b){var c=a.type,d=ke(a),f=2===a.tag&&null!=a.type.contextTypes,g=f?me(a,d):D;return e(a,b=new c(b,g)),f&&((a=a.stateNode).__reactInternalMemoizedUnmaskedChildContext=d,a.__reactInternalMemoizedMaskedChildContext=g),b},mountClassInstance:function(a,b){var c=a.alternate,d=a.stateNode,e=d.state||null,g=a.pendingProps;g||E("158");var h=ke(a);d.props=g,d.state=a.memoizedState=e,d.refs=D,d.context=me(a,h),null!=a.type&&null!=a.type.prototype&&!0===a.type.prototype.unstable_isAsyncReactComponent&&(a.internalContextTag|=1),"function"==typeof d.componentWillMount&&(e=d.state,d.componentWillMount(),e!==d.state&&f.enqueueReplaceState(d,d.state,null),null!==(e=a.updateQueue)&&(d.state=Je(c,a,e,d,g,b))),"function"==typeof d.componentDidMount&&(a.effectTag|=4)},updateClassInstance:function(a,b,e){var g=b.stateNode;g.props=b.memoizedProps,g.state=b.memoizedState;var h=b.memoizedProps,k=b.pendingProps;k||null==(k=h)&&E("159");var u=g.context,z=ke(b);if(z=me(b,z),"function"!=typeof g.componentWillReceiveProps||h===k&&u===z||(u=g.state,g.componentWillReceiveProps(k,z),g.state!==u&&f.enqueueReplaceState(g,g.state,null)),u=b.memoizedState,e=null!==b.updateQueue?Je(a,b,b.updateQueue,g,k,e):u,!(h!==k||u!==e||X.current||null!==b.updateQueue&&b.updateQueue.hasForceUpdate))return"function"!=typeof g.componentDidUpdate||h===a.memoizedProps&&u===a.memoizedState||(b.effectTag|=4),!1;var G=k;if(null===h||null!==b.updateQueue&&b.updateQueue.hasForceUpdate)G=!0;else{var I=b.stateNode,L=b.type;G="function"==typeof I.shouldComponentUpdate?I.shouldComponentUpdate(G,e,z):!(L.prototype&&L.prototype.isPureReactComponent&&ea(h,G)&&ea(u,e))}return G?("function"==typeof g.componentWillUpdate&&g.componentWillUpdate(k,e,z),"function"==typeof g.componentDidUpdate&&(b.effectTag|=4)):("function"!=typeof g.componentDidUpdate||h===a.memoizedProps&&u===a.memoizedState||(b.effectTag|=4),c(b,k),d(b,e)),g.props=k,g.state=e,g.context=z,G}}}(d,e,function(a,b){a.memoizedProps=b},function(a,b){a.memoizedState=b})).adoptClassInstance,m=a.constructClassInstance,A=a.mountClassInstance,Ob=a.updateClassInstance;return{beginWork:function(a,b,c){if(0===b.expirationTime||b.expirationTime>c)return v(0,b);switch(b.tag){case 0:null!==a&&E("155");var d=b.type,e=b.pendingProps,r=ke(b);return d=d(e,r=me(b,r)),b.effectTag|=1,"object"==typeof d&&null!==d&&"function"==typeof d.render?(b.tag=2,e=qe(b),w(b,d),A(b,c),b=h(a,b,!0,e)):(b.tag=1,f(a,b,d),b.memoizedProps=e,b=b.child),b;case 1:a:{if(e=b.type,c=b.pendingProps,d=b.memoizedProps,X.current)null===c&&(c=d);else if(null===c||d===c){b=q(a,b);break a}e=e(c,d=me(b,d=ke(b))),b.effectTag|=1,f(a,b,e),b.memoizedProps=c,b=b.child}return b;case 2:return e=qe(b),d=void 0,null===a?b.stateNode?E("153"):(m(b,b.pendingProps),A(b,c),d=!0):d=Ob(a,b,c),h(a,b,d,e);case 3:return k(b),null!==(e=b.updateQueue)?(d=b.memoizedState)===(e=Je(a,b,e,null,null,c))?(N(),b=q(a,b)):(d=e.element,r=b.stateNode,(null===a||null===a.child)&&r.hydrate&&L(b)?(b.effectTag|=2,b.child=cf(b,null,d,c)):(N(),f(a,b,d)),b.memoizedState=e,b=b.child):(N(),b=q(a,b)),b;case 5:G(b),null===a&&J(b),e=b.type;var n=b.memoizedProps;return null===(d=b.pendingProps)&&(null===(d=n)&&E("154")),r=null!==a?a.memoizedProps:null,X.current||null!==d&&n!==d?(n=d.children,y(e,d)?n=null:r&&y(e,r)&&(b.effectTag|=16),g(a,b),2147483647!==c&&!u&&z(e,d)?(b.expirationTime=2147483647,b=null):(f(a,b,n),b.memoizedProps=d,b=b.child)):b=q(a,b),b;case 6:return null===a&&J(b),null===(a=b.pendingProps)&&(a=b.memoizedProps),b.memoizedProps=a,null;case 8:b.tag=7;case 7:return e=b.pendingProps,X.current?null===e&&(null===(e=a&&a.memoizedProps)&&E("154")):null!==e&&b.memoizedProps!==e||(e=b.memoizedProps),d=e.children,b.stateNode=null===a?cf(b,b.stateNode,d,c):bf(b,b.stateNode,d,c),b.memoizedProps=e,b.stateNode;case 9:return null;case 4:a:{if(I(b,b.stateNode.containerInfo),e=b.pendingProps,X.current)null===e&&(null==(e=a&&a.memoizedProps)&&E("154"));else if(null===e||b.memoizedProps===e){b=q(a,b);break a}null===a?b.child=bf(b,null,e,c):f(a,b,e),b.memoizedProps=e,b=b.child}return b;case 10:a:{if(c=b.pendingProps,X.current)null===c&&(c=b.memoizedProps);else if(null===c||b.memoizedProps===c){b=q(a,b);break a}f(a,b,c),b.memoizedProps=c,b=b.child}return b;default:E("156")}},beginFailedWork:function(a,b,c){switch(b.tag){case 2:qe(b);break;case 3:k(b);break;default:E("157")}return b.effectTag|=64,null===a?b.child=null:b.child!==a.child&&(b.child=a.child),0===b.expirationTime||b.expirationTime>c?v(0,b):(b.firstEffect=null,b.lastEffect=null,b.child=null===a?cf(b,null,null,c):bf(b,a.child,null,c),2===b.tag&&(a=b.stateNode,b.memoizedProps=a.props,b.memoizedState=a.state),b.child)}}}var gf={};function kf(a){function b(a){Qb=ja=!0;var b=a.stateNode;if(b.current===a&&E("177"),b.isReadyForCommit=!1,id.current=null,1<a.effectTag)if(null!==a.lastEffect){a.lastEffect.nextEffect=a;var c=a.firstEffect}else c=a;else c=a.firstEffect;for(yg(),t=c;null!==t;){var d=!1,e=void 0;try{for(;null!==t;){var f=t.effectTag;if(16&f&&zg(t),128&f){var g=t.alternate;null!==g&&Ag(g)}switch(-242&f){case 2:Ne(t),t.effectTag&=-3;break;case 6:Ne(t),t.effectTag&=-3,Oe(t.alternate,t);break;case 4:Oe(t.alternate,t);break;case 8:Sc=!0,Bg(t),Sc=!1}t=t.nextEffect}}catch(Tc){d=!0,e=Tc}d&&(null===t&&E("178"),h(t,e),null!==t&&(t=t.nextEffect))}for(Cg(),b.current=a,t=c;null!==t;){c=!1,d=void 0;try{for(;null!==t;){var k=t.effectTag;if(36&k&&Dg(t.alternate,t),128&k&&Eg(t),64&k)switch(e=t,f=void 0,null!==R&&(f=R.get(e),R.delete(e),null==f&&null!==e.alternate&&(e=e.alternate,f=R.get(e),R.delete(e))),null==f&&E("184"),e.tag){case 2:e.stateNode.componentDidCatch(f.error,{componentStack:f.componentStack});break;case 3:null===ca&&(ca=f.error);break;default:E("157")}var Qc=t.nextEffect;t.nextEffect=null,t=Qc}}catch(Tc){c=!0,d=Tc}c&&(null===t&&E("178"),h(t,d),null!==t&&(t=t.nextEffect))}return ja=Qb=!1,De(a.stateNode),ha&&(ha.forEach(G),ha=null),null!==ca&&(a=ca,ca=null,Ob(a)),0===(b=b.current.expirationTime)&&(qa=R=null),b}function c(a){for(;;){var b=Fg(a.alternate,a,H),c=a.return,d=a.sibling,e=a;if(2147483647===H||2147483647!==e.expirationTime){if(2!==e.tag&&3!==e.tag)var f=0;else f=null===(f=e.updateQueue)?0:f.expirationTime;for(var g=e.child;null!==g;)0!==g.expirationTime&&(0===f||f>g.expirationTime)&&(f=g.expirationTime),g=g.sibling;e.expirationTime=f}if(null!==b)return b;if(null!==c&&(null===c.firstEffect&&(c.firstEffect=a.firstEffect),null!==a.lastEffect&&(null!==c.lastEffect&&(c.lastEffect.nextEffect=a.firstEffect),c.lastEffect=a.lastEffect),1<a.effectTag&&(null!==c.lastEffect?c.lastEffect.nextEffect=a:c.firstEffect=a,c.lastEffect=a)),null!==d)return d;if(null===c){a.stateNode.isReadyForCommit=!0;break}a=c}return null}function d(a){var b=rg(a.alternate,a,H);return null===b&&(b=c(a)),id.current=null,b}function e(a){var b=Gg(a.alternate,a,H);return null===b&&(b=c(a)),id.current=null,b}function f(a){if(null!==R){if(!(0===H||H>a))if(H<=Uc)for(;null!==F;)F=k(F)?e(F):d(F);else for(;null!==F&&!A();)F=k(F)?e(F):d(F)}else if(!(0===H||H>a))if(H<=Uc)for(;null!==F;)F=d(F);else for(;null!==F&&!A();)F=d(F)}function g(a,b){if(ja&&E("243"),ja=!0,a.isReadyForCommit=!1,a!==ra||b!==H||null===F){for(;-1<he;)ge[he]=null,he--;je=D,ie.current=D,X.current=!1,x(),H=b,F=se((ra=a).current,null,b)}var c=!1,d=null;try{f(b)}catch(Rc){c=!0,d=Rc}for(;c;){if(eb){ca=d;break}var g=F;if(null===g)eb=!0;else{var k=h(g,d);if(null===k&&E("183"),!eb){try{for(d=b,k=c=k;null!==g;){switch(g.tag){case 2:ne(g);break;case 5:qg(g);break;case 3:p(g);break;case 4:p(g)}if(g===k||g.alternate===k)break;g=g.return}F=e(c),f(d)}catch(Rc){c=!0,d=Rc;continue}break}}}return b=ca,eb=ja=!1,ca=null,null!==b&&Ob(b),a.isReadyForCommit?a.current.alternate:null}function h(a,b){var c=id.current=null,d=!1,e=!1,f=null;if(3===a.tag)c=a,q(a)&&(eb=!0);else for(var g=a.return;null!==g&&null===c;){if(2===g.tag?"function"==typeof g.stateNode.componentDidCatch&&(d=!0,f=jd(g),c=g,e=!0):3===g.tag&&(c=g),q(g)){if(Sc||null!==ha&&(ha.has(g)||null!==g.alternate&&ha.has(g.alternate)))return null;c=null,e=!1}g=g.return}if(null!==c){null===qa&&(qa=new Set),qa.add(c);var h="";g=a;do{a:switch(g.tag){case 0:case 1:case 2:case 5:var k=g._debugOwner,Qc=g._debugSource,m=jd(g),n=null;k&&(n=jd(k)),k=Qc,m="\n    in "+(m||"Unknown")+(k?" (at "+k.fileName.replace(/^.*[\\\/]/,"")+":"+k.lineNumber+")":n?" (created by "+n+")":"");break a;default:m=""}h+=m,g=g.return}while(g);g=h,a=jd(a),null===R&&(R=new Map),b={componentName:a,componentStack:g,error:b,errorBoundary:d?c.stateNode:null,errorBoundaryFound:d,errorBoundaryName:f,willRetry:e},R.set(c,b);try{var p=b.error;p&&p.suppressReactErrorLogging||console.error(p)}catch(Vc){Vc&&Vc.suppressReactErrorLogging||console.error(Vc)}return Qb?(null===ha&&(ha=new Set),ha.add(c)):G(c),c}return null===ca&&(ca=b),null}function k(a){return null!==R&&(R.has(a)||null!==a.alternate&&R.has(a.alternate))}function q(a){return null!==qa&&(qa.has(a)||null!==a.alternate&&qa.has(a.alternate))}function v(){return 20*(1+((I()+100)/20|0))}function y(a){return 0!==ka?ka:ja?Qb?1:H:!Hg||1&a.internalContextTag?v():1}function u(a,b){return z(a,b)}function z(a,b){for(;null!==a;){if((0===a.expirationTime||a.expirationTime>b)&&(a.expirationTime=b),null!==a.alternate&&(0===a.alternate.expirationTime||a.alternate.expirationTime>b)&&(a.alternate.expirationTime=b),null===a.return){if(3!==a.tag)break;var c=a.stateNode;!ja&&c===ra&&b<H&&(F=ra=null,H=0);var d=c,e=b;if(Rb>Ig&&E("185"),null===d.nextScheduledRoot)d.remainingExpirationTime=e,null===O?(sa=O=d,d.nextScheduledRoot=d):(O=O.nextScheduledRoot=d).nextScheduledRoot=sa;else{var f=d.remainingExpirationTime;(0===f||e<f)&&(d.remainingExpirationTime=e)}Fa||(la?Sb&&m(ma=d,na=1):1===e?w(1,null):L(e)),!ja&&c===ra&&b<H&&(F=ra=null,H=0)}a=a.return}}function G(a){z(a,1)}function I(){return Uc=2+((Wc()-Pe)/10|0)}function L(a){if(0!==Tb){if(a>Tb)return;Jg(Xc)}var b=Wc()-Pe;Tb=a,Xc=Kg(J,{timeout:10*(a-2)-b})}function N(){var a=0,b=null;if(null!==O)for(var c=O,d=sa;null!==d;){var e=d.remainingExpirationTime;if(0===e){if((null===c||null===O)&&E("244"),d===d.nextScheduledRoot){sa=O=d.nextScheduledRoot=null;break}if(d===sa)sa=e=d.nextScheduledRoot,O.nextScheduledRoot=e,d.nextScheduledRoot=null;else{if(d===O){(O=c).nextScheduledRoot=sa,d.nextScheduledRoot=null;break}c.nextScheduledRoot=d.nextScheduledRoot,d.nextScheduledRoot=null}d=c.nextScheduledRoot}else{if((0===a||e<a)&&(a=e,b=d),d===O)break;c=d,d=d.nextScheduledRoot}}null!==(c=ma)&&c===b?Rb++:Rb=0,ma=b,na=a}function J(a){w(0,a)}function w(a,b){for(fb=b,N();null!==ma&&0!==na&&(0===a||na<=a)&&!Yc;)m(ma,na),N();if(null!==fb&&(Tb=0,Xc=-1),0!==na&&L(na),fb=null,Yc=!1,Rb=0,Ub)throw a=Zc,Zc=null,Ub=!1,a}function m(a,c){if(Fa&&E("245"),Fa=!0,c<=I()){var d=a.finishedWork;null!==d?(a.finishedWork=null,a.remainingExpirationTime=b(d)):(a.finishedWork=null,null!==(d=g(a,c))&&(a.remainingExpirationTime=b(d)))}else null!==(d=a.finishedWork)?(a.finishedWork=null,a.remainingExpirationTime=b(d)):(a.finishedWork=null,null!==(d=g(a,c))&&(A()?a.finishedWork=d:a.remainingExpirationTime=b(d)));Fa=!1}function A(){return!(null===fb||fb.timeRemaining()>Lg)&&(Yc=!0)}function Ob(a){null===ma&&E("246"),ma.remainingExpirationTime=0,Ub||(Ub=!0,Zc=a)}var r=function hf(a){function b(a){return a===gf&&E("174"),a}var c=a.getChildHostContext,d=a.getRootHostContext,e={current:gf},f={current:gf},g={current:gf};return{getHostContext:function(){return b(e.current)},getRootHostContainer:function(){return b(g.current)},popHostContainer:function(a){V(e),V(f),V(g)},popHostContext:function(a){f.current===a&&(V(e),V(f))},pushHostContainer:function(a,b){W(g,b),b=d(b),W(f,a),W(e,b)},pushHostContext:function(a){var d=b(g.current),h=b(e.current);h!==(d=c(h,a.type,d))&&(W(f,a),W(e,d))},resetHostContainer:function(){e.current=gf,g.current=gf}}}(a),n=function jf(a){function b(a,b){var c=new Y(5,null,0);c.type="DELETED",c.stateNode=b,c.return=a,c.effectTag=8,null!==a.lastEffect?(a.lastEffect.nextEffect=c,a.lastEffect=c):a.firstEffect=a.lastEffect=c}function c(a,b){switch(a.tag){case 5:return null!==(b=f(b,a.type,a.pendingProps))&&(a.stateNode=b,!0);case 6:return null!==(b=g(b,a.pendingProps))&&(a.stateNode=b,!0);default:return!1}}function d(a){for(a=a.return;null!==a&&5!==a.tag&&3!==a.tag;)a=a.return;y=a}var e=a.shouldSetTextContent;if(!(a=a.hydration))return{enterHydrationState:function(){return!1},resetHydrationState:function(){},tryToClaimNextHydratableInstance:function(){},prepareToHydrateHostInstance:function(){E("175")},prepareToHydrateHostTextInstance:function(){E("176")},popHydrationState:function(){return!1}};var f=a.canHydrateInstance,g=a.canHydrateTextInstance,h=a.getNextHydratableSibling,k=a.getFirstHydratableChild,q=a.hydrateInstance,v=a.hydrateTextInstance,y=null,u=null,z=!1;return{enterHydrationState:function(a){return u=k(a.stateNode.containerInfo),y=a,z=!0},resetHydrationState:function(){u=y=null,z=!1},tryToClaimNextHydratableInstance:function(a){if(z){var d=u;if(d){if(!c(a,d)){if(!(d=h(d))||!c(a,d))return a.effectTag|=2,z=!1,void(y=a);b(y,u)}y=a,u=k(d)}else a.effectTag|=2,z=!1,y=a}},prepareToHydrateHostInstance:function(a,b,c){return b=q(a.stateNode,a.type,a.memoizedProps,b,c,a),a.updateQueue=b,null!==b},prepareToHydrateHostTextInstance:function(a){return v(a.stateNode,a.memoizedProps,a)},popHydrationState:function(a){if(a!==y)return!1;if(!z)return d(a),z=!0,!1;var c=a.type;if(5!==a.tag||"head"!==c&&"body"!==c&&!e(c,a.memoizedProps))for(c=u;c;)b(a,c),c=h(c);return d(a),u=y?h(a.stateNode):null,!0}}}(a),p=r.popHostContainer,qg=r.popHostContext,x=r.resetHostContainer,Me=df(a,r,n,u,y),rg=Me.beginWork,Gg=Me.beginFailedWork,Fg=function ef(a,b,c){function d(a){a.effectTag|=4}var e=a.createInstance,f=a.createTextInstance,g=a.appendInitialChild,h=a.finalizeInitialChildren,k=a.prepareUpdate,q=a.persistence,v=b.getRootHostContainer,y=b.popHostContext,u=b.getHostContext,z=b.popHostContainer,G=c.prepareToHydrateHostInstance,I=c.prepareToHydrateHostTextInstance,L=c.popHydrationState,N=void 0,J=void 0,w=void 0;return a.mutation?(N=function(){},J=function(a,b,c){(b.updateQueue=c)&&d(b)},w=function(a,b,c,e){c!==e&&d(b)}):E(q?"235":"236"),{completeWork:function(a,b,c){var m=b.pendingProps;switch(null===m?m=b.memoizedProps:2147483647===b.expirationTime&&2147483647!==c||(b.pendingProps=null),b.tag){case 1:return null;case 2:return ne(b),null;case 3:return z(b),V(X),V(ie),(m=b.stateNode).pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),null!==a&&null!==a.child||(L(b),b.effectTag&=-3),N(b),null;case 5:y(b),c=v();var A=b.type;if(null!==a&&null!=b.stateNode){var p=a.memoizedProps,q=b.stateNode,x=u();q=k(q,A,p,m,c,x),J(a,b,q,A,p,m,c),a.ref!==b.ref&&(b.effectTag|=128)}else{if(!m)return null===b.stateNode&&E("166"),null;if(a=u(),L(b))G(b,c,a)&&d(b);else{a=e(A,m,c,a,b);a:for(p=b.child;null!==p;){if(5===p.tag||6===p.tag)g(a,p.stateNode);else if(4!==p.tag&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===b)break;for(;null===p.sibling;){if(null===p.return||p.return===b)break a;p=p.return}p.sibling.return=p.return,p=p.sibling}h(a,A,m,c)&&d(b),b.stateNode=a}null!==b.ref&&(b.effectTag|=128)}return null;case 6:if(a&&null!=b.stateNode)w(a,b,a.memoizedProps,m);else{if("string"!=typeof m)return null===b.stateNode&&E("166"),null;a=v(),c=u(),L(b)?I(b)&&d(b):b.stateNode=f(m,a,c,b)}return null;case 7:(m=b.memoizedProps)||E("165"),b.tag=8,A=[];a:for((p=b.stateNode)&&(p.return=b);null!==p;){if(5===p.tag||6===p.tag||4===p.tag)E("247");else if(9===p.tag)A.push(p.type);else if(null!==p.child){p.child.return=p,p=p.child;continue}for(;null===p.sibling;){if(null===p.return||p.return===b)break a;p=p.return}p.sibling.return=p.return,p=p.sibling}return m=(p=m.handler)(m.props,A),b.child=bf(b,null!==a?a.child:null,m,c),b.child;case 8:return b.tag=7,null;case 9:case 10:return null;case 4:return z(b),N(b),null;case 0:E("167");default:E("156")}}}}(a,r,n).completeWork,zg=(r=function ff(a,b){function c(a){var c=a.ref;if(null!==c)try{c(null)}catch(A){b(a,A)}}function d(a){switch(Ee(a),a.tag){case 2:c(a);var d=a.stateNode;if("function"==typeof d.componentWillUnmount)try{d.props=a.memoizedProps,d.state=a.memoizedState,d.componentWillUnmount()}catch(A){b(a,A)}break;case 5:c(a);break;case 7:e(a.stateNode);break;case 4:k&&g(a)}}function e(a){for(var b=a;;)if(d(b),null===b.child||k&&4===b.tag){if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return;b=b.return}b.sibling.return=b.return,b=b.sibling}else b.child.return=b,b=b.child}function f(a){return 5===a.tag||3===a.tag||4===a.tag}function g(a){for(var b=a,c=!1,f=void 0,g=void 0;;){if(!c){c=b.return;a:for(;;){switch(null===c&&E("160"),c.tag){case 5:f=c.stateNode,g=!1;break a;case 3:case 4:f=c.stateNode.containerInfo,g=!0;break a}c=c.return}c=!0}if(5===b.tag||6===b.tag)e(b),g?J(f,b.stateNode):N(f,b.stateNode);else if(4===b.tag?f=b.stateNode.containerInfo:d(b),null!==b.child){b.child.return=b,b=b.child;continue}if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return;4===(b=b.return).tag&&(c=!1)}b.sibling.return=b.return,b=b.sibling}}var h=a.getPublicInstance,k=a.mutation;a=a.persistence,k||E(a?"235":"236");var q=k.commitMount,v=k.commitUpdate,y=k.resetTextContent,u=k.commitTextUpdate,z=k.appendChild,G=k.appendChildToContainer,I=k.insertBefore,L=k.insertInContainerBefore,N=k.removeChild,J=k.removeChildFromContainer;return{commitResetTextContent:function(a){y(a.stateNode)},commitPlacement:function(a){a:{for(var b=a.return;null!==b;){if(f(b)){var c=b;break a}b=b.return}E("160"),c=void 0}var d=b=void 0;switch(c.tag){case 5:b=c.stateNode,d=!1;break;case 3:case 4:b=c.stateNode.containerInfo,d=!0;break;default:E("161")}16&c.effectTag&&(y(b),c.effectTag&=-17);a:b:for(c=a;;){for(;null===c.sibling;){if(null===c.return||f(c.return)){c=null;break a}c=c.return}for(c.sibling.return=c.return,c=c.sibling;5!==c.tag&&6!==c.tag;){if(2&c.effectTag)continue b;if(null===c.child||4===c.tag)continue b;c.child.return=c,c=c.child}if(!(2&c.effectTag)){c=c.stateNode;break a}}for(var e=a;;){if(5===e.tag||6===e.tag)c?d?L(b,e.stateNode,c):I(b,e.stateNode,c):d?G(b,e.stateNode):z(b,e.stateNode);else if(4!==e.tag&&null!==e.child){e.child.return=e,e=e.child;continue}if(e===a)break;for(;null===e.sibling;){if(null===e.return||e.return===a)return;e=e.return}e.sibling.return=e.return,e=e.sibling}},commitDeletion:function(a){g(a),a.return=null,a.child=null,a.alternate&&(a.alternate.child=null,a.alternate.return=null)},commitWork:function(a,b){switch(b.tag){case 2:break;case 5:var c=b.stateNode;if(null!=c){var d=b.memoizedProps;a=null!==a?a.memoizedProps:d;var e=b.type,f=b.updateQueue;b.updateQueue=null,null!==f&&v(c,f,e,a,d,b)}break;case 6:null===b.stateNode&&E("162"),c=b.memoizedProps,u(b.stateNode,null!==a?a.memoizedProps:c,c);break;case 3:break;default:E("163")}},commitLifeCycles:function(a,b){switch(b.tag){case 2:var c=b.stateNode;if(4&b.effectTag)if(null===a)c.props=b.memoizedProps,c.state=b.memoizedState,c.componentDidMount();else{var d=a.memoizedProps;a=a.memoizedState,c.props=b.memoizedProps,c.state=b.memoizedState,c.componentDidUpdate(d,a)}null!==(b=b.updateQueue)&&Ke(b,c);break;case 3:null!==(c=b.updateQueue)&&Ke(c,null!==b.child?b.child.stateNode:null);break;case 5:c=b.stateNode,null===a&&4&b.effectTag&&q(c,b.type,b.memoizedProps,b);break;case 6:case 4:break;default:E("163")}},commitAttachRef:function(a){var b=a.ref;if(null!==b){var c=a.stateNode;switch(a.tag){case 5:b(h(c));break;default:b(c)}}},commitDetachRef:function(a){null!==(a=a.ref)&&a(null)}}}(a,h)).commitResetTextContent,Ne=r.commitPlacement,Bg=r.commitDeletion,Oe=r.commitWork,Dg=r.commitLifeCycles,Eg=r.commitAttachRef,Ag=r.commitDetachRef,Wc=a.now,Kg=a.scheduleDeferredCallback,Jg=a.cancelDeferredCallback,Hg=a.useSyncScheduling,yg=a.prepareForCommit,Cg=a.resetAfterCommit,Pe=Wc(),Uc=2,ka=0,ja=!1,F=null,ra=null,H=0,t=null,R=null,qa=null,ha=null,ca=null,eb=!1,Qb=!1,Sc=!1,sa=null,O=null,Tb=0,Xc=-1,Fa=!1,ma=null,na=0,Yc=!1,Ub=!1,Zc=null,fb=null,la=!1,Sb=!1,Ig=1e3,Rb=0,Lg=1;return{computeAsyncExpiration:v,computeExpirationForFiber:y,scheduleWork:u,batchedUpdates:function(a,b){var c=la;la=!0;try{return a(b)}finally{(la=c)||Fa||w(1,null)}},unbatchedUpdates:function(a){if(la&&!Sb){Sb=!0;try{return a()}finally{Sb=!1}}return a()},flushSync:function(a){var b=la;la=!0;try{a:{var c=ka;ka=1;try{var d=a();break a}finally{ka=c}d=void 0}return d}finally{la=b,Fa&&E("187"),w(1,null)}},deferredUpdates:function(a){var b=ka;ka=v();try{return a()}finally{ka=b}}}}function lf(a){function b(a){return null===(a=function od(a){if(!(a=nd(a)))return null;for(var b=a;;){if(5===b.tag||6===b.tag)return b;if(b.child)b.child.return=b,b=b.child;else{if(b===a)break;for(;!b.sibling;){if(!b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return,b=b.sibling}}return null}(a))?null:a.stateNode}var c=a.getPublicInstance,d=(a=kf(a)).computeAsyncExpiration,e=a.computeExpirationForFiber,f=a.scheduleWork;return{createContainer:function(a,b){var c=new Y(3,null,0);return a={current:c,containerInfo:a,pendingChildren:null,remainingExpirationTime:0,isReadyForCommit:!1,finishedWork:null,context:null,pendingContext:null,hydrate:b,nextScheduledRoot:null},c.stateNode=a},updateContainer:function(a,b,c,q){var g=b.current;if(c){var h;c=c._reactInternalFiber;b:{for(2===kd(c)&&2===c.tag||E("170"),h=c;3!==h.tag;){if(le(h)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break b}(h=h.return)||E("171")}h=h.stateNode.context}c=le(c)?pe(c,h):h}else c=D;null===b.context?b.context=c:b.pendingContext=c,b=void 0===(b=q)?null:b,He(g,{expirationTime:q=null!=a&&null!=a.type&&null!=a.type.prototype&&!0===a.type.prototype.unstable_isAsyncReactComponent?d():e(g),partialState:{element:a},callback:b,isReplace:!1,isForced:!1,nextCallback:null,next:null}),f(g,q)},batchedUpdates:a.batchedUpdates,unbatchedUpdates:a.unbatchedUpdates,deferredUpdates:a.deferredUpdates,flushSync:a.flushSync,getPublicRootInstance:function(a){if(!(a=a.current).child)return null;switch(a.child.tag){case 5:return c(a.child.stateNode);default:return a.child.stateNode}},findHostInstance:b,findHostInstanceWithNoPortals:function(a){return null===(a=function pd(a){if(!(a=nd(a)))return null;for(var b=a;;){if(5===b.tag||6===b.tag)return b;if(b.child&&4!==b.tag)b.child.return=b,b=b.child;else{if(b===a)break;for(;!b.sibling;){if(!b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return,b=b.sibling}}return null}(a))?null:a.stateNode},injectIntoDevTools:function(a){var c=a.findFiberByHostInstance;return function Ce(a){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var b=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(b.isDisabled||!b.supportsFiber)return!0;try{var c=b.inject(a);ze=Be(function(a){return b.onCommitFiberRoot(c,a)}),Ae=Be(function(a){return b.onCommitFiberUnmount(c,a)})}catch(d){}return!0}(B({},a,{findHostInstanceByFiber:function(a){return b(a)},findFiberByHostInstance:function(a){return c?c(a):null}}))}}}var mf=Object.freeze({default:lf}),nf=mf&&lf||mf,of=nf.default?nf.default:nf;var qf="object"==typeof performance&&"function"==typeof performance.now,rf=void 0;rf=qf?function(){return performance.now()}:function(){return Date.now()};var sf=void 0,tf=void 0;if(l.canUseDOM)if("function"!=typeof requestIdleCallback||"function"!=typeof cancelIdleCallback){var Bf,uf=null,vf=!1,wf=-1,xf=!1,yf=0,zf=33,Af=33;Bf=qf?{didTimeout:!1,timeRemaining:function(){var a=yf-performance.now();return 0<a?a:0}}:{didTimeout:!1,timeRemaining:function(){var a=yf-Date.now();return 0<a?a:0}};var Cf="__reactIdleCallback$"+Math.random().toString(36).slice(2);window.addEventListener("message",function(a){if(a.source===window&&a.data===Cf){if(vf=!1,a=rf(),0>=yf-a){if(!(-1!==wf&&wf<=a))return void(xf||(xf=!0,requestAnimationFrame(Df)));Bf.didTimeout=!0}else Bf.didTimeout=!1;wf=-1,a=uf,uf=null,null!==a&&a(Bf)}},!1);var Df=function(a){xf=!1;var b=a-yf+Af;b<Af&&zf<Af?(8>b&&(b=8),Af=b<zf?zf:b):zf=b,yf=a+Af,vf||(vf=!0,window.postMessage(Cf,"*"))};sf=function(a,b){return uf=a,null!=b&&"number"==typeof b.timeout&&(wf=rf()+b.timeout),xf||(xf=!0,requestAnimationFrame(Df)),0},tf=function(){uf=null,vf=!1,wf=-1}}else sf=window.requestIdleCallback,tf=window.cancelIdleCallback;else sf=function(a){return setTimeout(function(){a({timeRemaining:function(){return 1/0}})})},tf=function(a){clearTimeout(a)};var Ef=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ff={},Gf={};function If(a,b,c){var d=wa(b);if(d&&va(b,c)){var e=d.mutationMethod;e?e(a,c):null==c||d.hasBooleanValue&&!c||d.hasNumericValue&&isNaN(c)||d.hasPositiveNumericValue&&1>c||d.hasOverloadedBooleanValue&&!1===c?Jf(a,b):d.mustUseProperty?a[d.propertyName]=c:(b=d.attributeName,(e=d.attributeNamespace)?a.setAttributeNS(e,b,""+c):d.hasBooleanValue||d.hasOverloadedBooleanValue&&!0===c?a.setAttribute(b,""):a.setAttribute(b,""+c))}else Kf(a,b,va(b,c)?c:null)}function Kf(a,b,c){(function Hf(a){return!!Gf.hasOwnProperty(a)||!Ff.hasOwnProperty(a)&&(Ef.test(a)?Gf[a]=!0:(Ff[a]=!0,!1))})(b)&&(null==c?a.removeAttribute(b):a.setAttribute(b,""+c))}function Jf(a,b){var c=wa(b);c?(b=c.mutationMethod)?b(a,void 0):c.mustUseProperty?a[c.propertyName]=!c.hasBooleanValue&&"":a.removeAttribute(c.attributeName):a.removeAttribute(b)}function Lf(a,b){var c=b.value,d=b.checked;return B({type:void 0,step:void 0,min:void 0,max:void 0},b,{defaultChecked:void 0,defaultValue:void 0,value:null!=c?c:a._wrapperState.initialValue,checked:null!=d?d:a._wrapperState.initialChecked})}function Mf(a,b){var c=b.defaultValue;a._wrapperState={initialChecked:null!=b.checked?b.checked:b.defaultChecked,initialValue:null!=b.value?b.value:c,controlled:"checkbox"===b.type||"radio"===b.type?null!=b.checked:null!=b.value}}function Nf(a,b){null!=(b=b.checked)&&If(a,"checked",b)}function Of(a,b){Nf(a,b);var c=b.value;null!=c?0===c&&""===a.value?a.value="0":"number"===b.type?(c!=(b=parseFloat(a.value)||0)||c==b&&a.value!=c)&&(a.value=""+c):a.value!==""+c&&(a.value=""+c):(null==b.value&&null!=b.defaultValue&&a.defaultValue!==""+b.defaultValue&&(a.defaultValue=""+b.defaultValue),null==b.checked&&null!=b.defaultChecked&&(a.defaultChecked=!!b.defaultChecked))}function Pf(a,b){switch(b.type){case"submit":case"reset":break;case"color":case"date":case"datetime":case"datetime-local":case"month":case"time":case"week":a.value="",a.value=a.defaultValue;break;default:a.value=a.value}""!==(b=a.name)&&(a.name=""),a.defaultChecked=!a.defaultChecked,a.defaultChecked=!a.defaultChecked,""!==b&&(a.name=b)}function Rf(a,b){return a=B({children:void 0},b),(b=function Qf(a){var b="";return aa.Children.forEach(a,function(a){null==a||"string"!=typeof a&&"number"!=typeof a||(b+=a)}),b}(b.children))&&(a.children=b),a}function Sf(a,b,c,d){if(a=a.options,b){b={};for(var e=0;e<c.length;e++)b["$"+c[e]]=!0;for(c=0;c<a.length;c++)e=b.hasOwnProperty("$"+a[c].value),a[c].selected!==e&&(a[c].selected=e),e&&d&&(a[c].defaultSelected=!0)}else{for(c=""+c,b=null,e=0;e<a.length;e++){if(a[e].value===c)return a[e].selected=!0,void(d&&(a[e].defaultSelected=!0));null!==b||a[e].disabled||(b=a[e])}null!==b&&(b.selected=!0)}}function Tf(a,b){var c=b.value;a._wrapperState={initialValue:null!=c?c:b.defaultValue,wasMultiple:!!b.multiple}}function Uf(a,b){return null!=b.dangerouslySetInnerHTML&&E("91"),B({},b,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function Vf(a,b){var c=b.value;null==c&&(c=b.defaultValue,null!=(b=b.children)&&(null!=c&&E("92"),Array.isArray(b)&&(1>=b.length||E("93"),b=b[0]),c=""+b),null==c&&(c="")),a._wrapperState={initialValue:""+c}}function Wf(a,b){var c=b.value;null!=c&&((c=""+c)!==a.value&&(a.value=c),null==b.defaultValue&&(a.defaultValue=c)),null!=b.defaultValue&&(a.defaultValue=b.defaultValue)}function Xf(a){var b=a.textContent;b===a._wrapperState.initialValue&&(a.value=b)}var Yf_html="http://www.w3.org/1999/xhtml",Yf_svg="http://www.w3.org/2000/svg";function Zf(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $f(a,b){return null==a||"http://www.w3.org/1999/xhtml"===a?Zf(b):"http://www.w3.org/2000/svg"===a&&"foreignObject"===b?"http://www.w3.org/1999/xhtml":a}var a,ag=void 0,bg=(a=function(a,b){if(a.namespaceURI!==Yf_svg||"innerHTML"in a)a.innerHTML=b;else{for((ag=ag||document.createElement("div")).innerHTML="<svg>"+b+"</svg>",b=ag.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;b.firstChild;)a.appendChild(b.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(b,c,d,e){MSApp.execUnsafeLocalFunction(function(){return a(b,c)})}:a);function cg(a,b){if(b){var c=a.firstChild;if(c&&c===a.lastChild&&3===c.nodeType)return void(c.nodeValue=b)}a.textContent=b}var dg={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},eg=["Webkit","ms","Moz","O"];function fg(a,b){for(var c in a=a.style,b)if(b.hasOwnProperty(c)){var d=0===c.indexOf("--"),e=c,f=b[c];e=null==f||"boolean"==typeof f||""===f?"":d||"number"!=typeof f||0===f||dg.hasOwnProperty(e)&&dg[e]?(""+f).trim():f+"px","float"===c&&(c="cssFloat"),d?a.setProperty(c,e):a[c]=e}}Object.keys(dg).forEach(function(a){eg.forEach(function(b){b=b+a.charAt(0).toUpperCase()+a.substring(1),dg[b]=dg[a]})});var gg=B({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hg(a,b,c){b&&(gg[a]&&(null!=b.children||null!=b.dangerouslySetInnerHTML)&&E("137",a,c()),null!=b.dangerouslySetInnerHTML&&(null!=b.children&&E("60"),"object"==typeof b.dangerouslySetInnerHTML&&"__html"in b.dangerouslySetInnerHTML||E("61")),null!=b.style&&"object"!=typeof b.style&&E("62",c()))}function ig(a,b){if(-1===a.indexOf("-"))return"string"==typeof b.is;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jg=Yf_html,kg=C.thatReturns("");function lg(a,b){var c=Hd(a=9===a.nodeType||11===a.nodeType?a:a.ownerDocument);b=Sa[b];for(var d=0;d<b.length;d++){var e=b[d];c.hasOwnProperty(e)&&c[e]||("topScroll"===e?wd("topScroll","scroll",a):"topFocus"===e||"topBlur"===e?(wd("topFocus","focus",a),wd("topBlur","blur",a),c.topBlur=!0,c.topFocus=!0):"topCancel"===e?(yc("cancel",!0)&&wd("topCancel","cancel",a),c.topCancel=!0):"topClose"===e?(yc("close",!0)&&wd("topClose","close",a),c.topClose=!0):Dd.hasOwnProperty(e)&&U(e,Dd[e],a),c[e]=!0)}}var mg={topAbort:"abort",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topLoadedData:"loadeddata",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topSeeked:"seeked",topSeeking:"seeking",topStalled:"stalled",topSuspend:"suspend",topTimeUpdate:"timeupdate",topVolumeChange:"volumechange",topWaiting:"waiting"};function ng(a,b,c,d){return c=9===c.nodeType?c:c.ownerDocument,d===jg&&(d=Zf(a)),d===jg?"script"===a?((a=c.createElement("div")).innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):a="string"==typeof b.is?c.createElement(a,{is:b.is}):c.createElement(a):a=c.createElementNS(d,a),a}function og(a,b){return(9===b.nodeType?b:b.ownerDocument).createTextNode(a)}function pg(a,b,c,d){var e=ig(b,c);switch(b){case"iframe":case"object":U("topLoad","load",a);var f=c;break;case"video":case"audio":for(f in mg)mg.hasOwnProperty(f)&&U(f,mg[f],a);f=c;break;case"source":U("topError","error",a),f=c;break;case"img":case"image":U("topError","error",a),U("topLoad","load",a),f=c;break;case"form":U("topReset","reset",a),U("topSubmit","submit",a),f=c;break;case"details":U("topToggle","toggle",a),f=c;break;case"input":Mf(a,c),f=Lf(a,c),U("topInvalid","invalid",a),lg(d,"onChange");break;case"option":f=Rf(a,c);break;case"select":Tf(a,c),f=B({},c,{value:void 0}),U("topInvalid","invalid",a),lg(d,"onChange");break;case"textarea":Vf(a,c),f=Uf(a,c),U("topInvalid","invalid",a),lg(d,"onChange");break;default:f=c}hg(b,f,kg);var h,g=f;for(h in g)if(g.hasOwnProperty(h)){var k=g[h];"style"===h?fg(a,k):"dangerouslySetInnerHTML"===h?null!=(k=k?k.__html:void 0)&&bg(a,k):"children"===h?"string"==typeof k?("textarea"!==b||""!==k)&&cg(a,k):"number"==typeof k&&cg(a,""+k):"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&"autoFocus"!==h&&(Ra.hasOwnProperty(h)?null!=k&&lg(d,h):e?Kf(a,h,k):null!=k&&If(a,h,k))}switch(b){case"input":Bc(a),Pf(a,c);break;case"textarea":Bc(a),Xf(a);break;case"option":null!=c.value&&a.setAttribute("value",c.value);break;case"select":a.multiple=!!c.multiple,null!=(b=c.value)?Sf(a,!!c.multiple,b,!1):null!=c.defaultValue&&Sf(a,!!c.multiple,c.defaultValue,!0);break;default:"function"==typeof f.onClick&&(a.onclick=C)}}function sg(a,b,c,d,e){var g,h,f=null;switch(b){case"input":c=Lf(a,c),d=Lf(a,d),f=[];break;case"option":c=Rf(a,c),d=Rf(a,d),f=[];break;case"select":c=B({},c,{value:void 0}),d=B({},d,{value:void 0}),f=[];break;case"textarea":c=Uf(a,c),d=Uf(a,d),f=[];break;default:"function"!=typeof c.onClick&&"function"==typeof d.onClick&&(a.onclick=C)}for(g in hg(b,d,kg),a=null,c)if(!d.hasOwnProperty(g)&&c.hasOwnProperty(g)&&null!=c[g])if("style"===g)for(h in b=c[g])b.hasOwnProperty(h)&&(a||(a={}),a[h]="");else"dangerouslySetInnerHTML"!==g&&"children"!==g&&"suppressContentEditableWarning"!==g&&"suppressHydrationWarning"!==g&&"autoFocus"!==g&&(Ra.hasOwnProperty(g)?f||(f=[]):(f=f||[]).push(g,null));for(g in d){var k=d[g];if(b=null!=c?c[g]:void 0,d.hasOwnProperty(g)&&k!==b&&(null!=k||null!=b))if("style"===g)if(b){for(h in b)!b.hasOwnProperty(h)||k&&k.hasOwnProperty(h)||(a||(a={}),a[h]="");for(h in k)k.hasOwnProperty(h)&&b[h]!==k[h]&&(a||(a={}),a[h]=k[h])}else a||(f||(f=[]),f.push(g,a)),a=k;else"dangerouslySetInnerHTML"===g?(k=k?k.__html:void 0,b=b?b.__html:void 0,null!=k&&b!==k&&(f=f||[]).push(g,""+k)):"children"===g?b===k||"string"!=typeof k&&"number"!=typeof k||(f=f||[]).push(g,""+k):"suppressContentEditableWarning"!==g&&"suppressHydrationWarning"!==g&&(Ra.hasOwnProperty(g)?(null!=k&&lg(e,g),f||b===k||(f=[])):(f=f||[]).push(g,k))}return a&&(f=f||[]).push("style",a),f}function tg(a,b,c,d,e){"input"===c&&"radio"===e.type&&null!=e.name&&Nf(a,e),ig(c,d),d=ig(c,e);for(var f=0;f<b.length;f+=2){var g=b[f],h=b[f+1];"style"===g?fg(a,h):"dangerouslySetInnerHTML"===g?bg(a,h):"children"===g?cg(a,h):d?null!=h?Kf(a,g,h):a.removeAttribute(g):null!=h?If(a,g,h):Jf(a,g)}switch(c){case"input":Of(a,e);break;case"textarea":Wf(a,e);break;case"select":a._wrapperState.initialValue=void 0,b=a._wrapperState.wasMultiple,a._wrapperState.wasMultiple=!!e.multiple,null!=(c=e.value)?Sf(a,!!e.multiple,c,!1):b!==!!e.multiple&&(null!=e.defaultValue?Sf(a,!!e.multiple,e.defaultValue,!0):Sf(a,!!e.multiple,e.multiple?[]:"",!1))}}function ug(a,b,c,d,e){switch(b){case"iframe":case"object":U("topLoad","load",a);break;case"video":case"audio":for(var f in mg)mg.hasOwnProperty(f)&&U(f,mg[f],a);break;case"source":U("topError","error",a);break;case"img":case"image":U("topError","error",a),U("topLoad","load",a);break;case"form":U("topReset","reset",a),U("topSubmit","submit",a);break;case"details":U("topToggle","toggle",a);break;case"input":Mf(a,c),U("topInvalid","invalid",a),lg(e,"onChange");break;case"select":Tf(a,c),U("topInvalid","invalid",a),lg(e,"onChange");break;case"textarea":Vf(a,c),U("topInvalid","invalid",a),lg(e,"onChange")}for(var g in hg(b,c,kg),d=null,c)c.hasOwnProperty(g)&&(f=c[g],"children"===g?"string"==typeof f?a.textContent!==f&&(d=["children",f]):"number"==typeof f&&a.textContent!==""+f&&(d=["children",""+f]):Ra.hasOwnProperty(g)&&null!=f&&lg(e,g));switch(b){case"input":Bc(a),Pf(a,c);break;case"textarea":Bc(a),Xf(a);break;case"select":case"option":break;default:"function"==typeof c.onClick&&(a.onclick=C)}return d}function vg(a,b){return a.nodeValue!==b}var wg=Object.freeze({createElement:ng,createTextNode:og,setInitialProperties:pg,diffProperties:sg,updateProperties:tg,diffHydratedProperties:ug,diffHydratedText:vg,warnForUnmatchedText:function(){},warnForDeletedHydratableElement:function(){},warnForDeletedHydratableText:function(){},warnForInsertedHydratedElement:function(){},warnForInsertedHydratedText:function(){},restoreControlledState:function(a,b,c){switch(b){case"input":if(Of(a,c),b=c.name,"radio"===c.type&&null!=b){for(c=a;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+b)+'][type="radio"]'),b=0;b<c.length;b++){var d=c[b];if(d!==a&&d.form===a.form){var e=rb(d);e||E("90"),Cc(d),Of(d,e)}}}break;case"textarea":Wf(a,c);break;case"select":null!=(b=c.value)&&Sf(a,!!c.multiple,b,!1)}}});nc.injectFiberControlledHostComponent(wg);var xg=null,Mg=null;function Ng(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType&&(8!==a.nodeType||" react-mount-point-unstable "!==a.nodeValue))}var Z=of({getRootHostContext:function(a){var b=a.nodeType;switch(b){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:$f(null,"");break;default:a=$f(a=(b=8===b?a.parentNode:a).namespaceURI||null,b=b.tagName)}return a},getChildHostContext:function(a,b){return $f(a,b)},getPublicInstance:function(a){return a},prepareForCommit:function(){xg=td;var a=da();if(Kd(a)){if("selectionStart"in a)var b={start:a.selectionStart,end:a.selectionEnd};else a:{var c=window.getSelection&&window.getSelection();if(c&&0!==c.rangeCount){b=c.anchorNode;var d=c.anchorOffset,e=c.focusNode;c=c.focusOffset;try{b.nodeType,e.nodeType}catch(z){b=null;break a}var f=0,g=-1,h=-1,k=0,q=0,v=a,y=null;b:for(;;){for(var u;v!==b||0!==d&&3!==v.nodeType||(g=f+d),v!==e||0!==c&&3!==v.nodeType||(h=f+c),3===v.nodeType&&(f+=v.nodeValue.length),null!==(u=v.firstChild);)y=v,v=u;for(;;){if(v===a)break b;if(y===b&&++k===d&&(g=f),y===e&&++q===c&&(h=f),null!==(u=v.nextSibling))break;y=(v=y).parentNode}v=u}b=-1===g||-1===h?null:{start:g,end:h}}else b=null}b=b||{start:0,end:0}}else b=null;Mg={focusedElem:a,selectionRange:b},ud(!1)},resetAfterCommit:function(){var a=Mg,b=da(),c=a.focusedElem,d=a.selectionRange;if(b!==c&&fa(document.documentElement,c)){if(Kd(c))if(b=d.start,void 0===(a=d.end)&&(a=b),"selectionStart"in c)c.selectionStart=b,c.selectionEnd=Math.min(a,c.value.length);else if(window.getSelection){b=window.getSelection();var e=c[Eb()].length;a=Math.min(d.start,e),d=void 0===d.end?a:Math.min(d.end,e),!b.extend&&a>d&&(e=d,d=a,a=e),e=Jd(c,a);var f=Jd(c,d);if(e&&f&&(1!==b.rangeCount||b.anchorNode!==e.node||b.anchorOffset!==e.offset||b.focusNode!==f.node||b.focusOffset!==f.offset)){var g=document.createRange();g.setStart(e.node,e.offset),b.removeAllRanges(),a>d?(b.addRange(g),b.extend(f.node,f.offset)):(g.setEnd(f.node,f.offset),b.addRange(g))}}for(b=[],a=c;a=a.parentNode;)1===a.nodeType&&b.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(ia(c),c=0;c<b.length;c++)(a=b[c]).element.scrollLeft=a.left,a.element.scrollTop=a.top}Mg=null,ud(xg),xg=null},createInstance:function(a,b,c,d,e){return(a=ng(a,b,c,d))[Q]=e,a[ob]=b,a},appendInitialChild:function(a,b){a.appendChild(b)},finalizeInitialChildren:function(a,b,c,d){pg(a,b,c,d);a:{switch(b){case"button":case"input":case"select":case"textarea":a=!!c.autoFocus;break a}a=!1}return a},prepareUpdate:function(a,b,c,d,e){return sg(a,b,c,d,e)},shouldSetTextContent:function(a,b){return"textarea"===a||"string"==typeof b.children||"number"==typeof b.children||"object"==typeof b.dangerouslySetInnerHTML&&null!==b.dangerouslySetInnerHTML&&"string"==typeof b.dangerouslySetInnerHTML.__html},shouldDeprioritizeSubtree:function(a,b){return!!b.hidden},createTextInstance:function(a,b,c,d){return(a=og(a,b))[Q]=d,a},now:rf,mutation:{commitMount:function(a){a.focus()},commitUpdate:function(a,b,c,d,e){a[ob]=e,tg(a,b,c,d,e)},resetTextContent:function(a){a.textContent=""},commitTextUpdate:function(a,b,c){a.nodeValue=c},appendChild:function(a,b){a.appendChild(b)},appendChildToContainer:function(a,b){8===a.nodeType?a.parentNode.insertBefore(b,a):a.appendChild(b)},insertBefore:function(a,b,c){a.insertBefore(b,c)},insertInContainerBefore:function(a,b,c){8===a.nodeType?a.parentNode.insertBefore(b,c):a.insertBefore(b,c)},removeChild:function(a,b){a.removeChild(b)},removeChildFromContainer:function(a,b){8===a.nodeType?a.parentNode.removeChild(b):a.removeChild(b)}},hydration:{canHydrateInstance:function(a,b){return 1!==a.nodeType||b.toLowerCase()!==a.nodeName.toLowerCase()?null:a},canHydrateTextInstance:function(a,b){return""===b||3!==a.nodeType?null:a},getNextHydratableSibling:function(a){for(a=a.nextSibling;a&&1!==a.nodeType&&3!==a.nodeType;)a=a.nextSibling;return a},getFirstHydratableChild:function(a){for(a=a.firstChild;a&&1!==a.nodeType&&3!==a.nodeType;)a=a.nextSibling;return a},hydrateInstance:function(a,b,c,d,e,f){return a[Q]=f,a[ob]=c,ug(a,b,c,e,d)},hydrateTextInstance:function(a,b,c){return a[Q]=c,vg(a,b)},didNotMatchHydratedContainerTextInstance:function(){},didNotMatchHydratedTextInstance:function(){},didNotHydrateContainerInstance:function(){},didNotHydrateInstance:function(){},didNotFindHydratableContainerInstance:function(){},didNotFindHydratableContainerTextInstance:function(){},didNotFindHydratableInstance:function(){},didNotFindHydratableTextInstance:function(){}},scheduleDeferredCallback:sf,cancelDeferredCallback:tf,useSyncScheduling:!0});function Pg(a,b,c,d,e){Ng(c)||E("200");var f=c._reactRootContainer;if(f)Z.updateContainer(b,f,a,e);else{if(!(d=d||function Og(a){return!(!(a=a?9===a.nodeType?a.documentElement:a.firstChild:null)||1!==a.nodeType||!a.hasAttribute("data-reactroot"))}(c)))for(f=void 0;f=c.lastChild;)c.removeChild(f);var g=Z.createContainer(c,d);f=c._reactRootContainer=g,Z.unbatchedUpdates(function(){Z.updateContainer(b,g,a,e)})}return Z.getPublicRootInstance(f)}function Qg(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return Ng(b)||E("200"),function pf(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:Ue,key:null==d?null:""+d,children:a,containerInfo:b,implementation:c}}(a,b,null,c)}function Rg(a,b){this._reactRootContainer=Z.createContainer(a,b)}rc=Z.batchedUpdates,Rg.prototype.render=function(a,b){Z.updateContainer(a,this._reactRootContainer,null,b)},Rg.prototype.unmount=function(a){Z.updateContainer(null,this._reactRootContainer,null,a)};var Sg={createPortal:Qg,findDOMNode:function(a){if(null==a)return null;if(1===a.nodeType)return a;var b=a._reactInternalFiber;if(b)return Z.findHostInstance(b);"function"==typeof a.render?E("188"):E("213",Object.keys(a))},hydrate:function(a,b,c){return Pg(null,a,b,!0,c)},render:function(a,b,c){return Pg(null,a,b,!1,c)},unstable_renderSubtreeIntoContainer:function(a,b,c,d){return(null==a||void 0===a._reactInternalFiber)&&E("38"),Pg(a,b,c,!1,d)},unmountComponentAtNode:function(a){return Ng(a)||E("40"),!!a._reactRootContainer&&(Z.unbatchedUpdates(function(){Pg(null,null,a,!1,function(){a._reactRootContainer=null})}),!0)},unstable_createPortal:Qg,unstable_batchedUpdates:tc,unstable_deferredUpdates:Z.deferredUpdates,flushSync:Z.flushSync,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{EventPluginHub:mb,EventPluginRegistry:Va,EventPropagators:Cb,ReactControlledComponent:qc,ReactDOMComponentTree:sb,ReactDOMEventListener:xd}};Z.injectIntoDevTools({findFiberByHostInstance:pb,bundleType:0,version:"16.2.0",rendererPackageName:"react-dom"});var Tg=Object.freeze({default:Sg}),Ug=Tg&&Sg||Tg;module.exports=Ug.default?Ug.default:Ug},function(module,exports,__webpack_require__){"use strict";var canUseDOM=!("undefined"==typeof window||!window.document||!window.document.createElement),ExecutionEnvironment={canUseDOM:canUseDOM,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:canUseDOM&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:canUseDOM&&!!window.screen,isInWorker:!canUseDOM};module.exports=ExecutionEnvironment},function(module,exports,__webpack_require__){"use strict";var emptyFunction=__webpack_require__(55),EventListener={listen:function listen(target,eventType,callback){return target.addEventListener?(target.addEventListener(eventType,callback,!1),{remove:function remove(){target.removeEventListener(eventType,callback,!1)}}):target.attachEvent?(target.attachEvent("on"+eventType,callback),{remove:function remove(){target.detachEvent("on"+eventType,callback)}}):void 0},capture:function capture(target,eventType,callback){return target.addEventListener?(target.addEventListener(eventType,callback,!0),{remove:function remove(){target.removeEventListener(eventType,callback,!0)}}):{remove:emptyFunction}},registerDefault:function registerDefault(){}};module.exports=EventListener},function(module,exports,__webpack_require__){"use strict";module.exports=function getActiveElement(doc){if(void 0===(doc=doc||("undefined"!=typeof document?document:void 0)))return null;try{return doc.activeElement||doc.body}catch(e){return doc.body}}},function(module,exports,__webpack_require__){"use strict";var hasOwnProperty=Object.prototype.hasOwnProperty;function is(x,y){return x===y?0!==x||0!==y||1/x==1/y:x!=x&&y!=y}module.exports=function shallowEqual(objA,objB){if(is(objA,objB))return!0;if("object"!=typeof objA||null===objA||"object"!=typeof objB||null===objB)return!1;var keysA=Object.keys(objA),keysB=Object.keys(objB);if(keysA.length!==keysB.length)return!1;for(var i=0;i<keysA.length;i++)if(!hasOwnProperty.call(objB,keysA[i])||!is(objA[keysA[i]],objB[keysA[i]]))return!1;return!0}},function(module,exports,__webpack_require__){"use strict";var isTextNode=__webpack_require__(291);module.exports=function containsNode(outerNode,innerNode){return!(!outerNode||!innerNode)&&(outerNode===innerNode||!isTextNode(outerNode)&&(isTextNode(innerNode)?containsNode(outerNode,innerNode.parentNode):"contains"in outerNode?outerNode.contains(innerNode):!!outerNode.compareDocumentPosition&&!!(16&outerNode.compareDocumentPosition(innerNode))))}},function(module,exports,__webpack_require__){"use strict";var isNode=__webpack_require__(292);module.exports=function isTextNode(object){return isNode(object)&&3==object.nodeType}},function(module,exports,__webpack_require__){"use strict";module.exports=function isNode(object){var defaultView=(object?object.ownerDocument||object:document).defaultView||window;return!(!object||!("function"==typeof defaultView.Node?object instanceof defaultView.Node:"object"==typeof object&&"number"==typeof object.nodeType&&"string"==typeof object.nodeName))}},function(module,exports,__webpack_require__){"use strict";module.exports=function focusNode(node){try{node.focus()}catch(e){}}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__splitStringTransformer__=__webpack_require__(466);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__splitStringTransformer__.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__html__=__webpack_require__(476);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__html__.a})},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(297),__esModule:!0}},function(module,exports,__webpack_require__){__webpack_require__(47),__webpack_require__(37),module.exports=__webpack_require__(298)},function(module,exports,__webpack_require__){var classof=__webpack_require__(74),ITERATOR=__webpack_require__(6)("iterator"),Iterators=__webpack_require__(36);module.exports=__webpack_require__(1).isIterable=function(it){var O=Object(it);return void 0!==O[ITERATOR]||"@@iterator"in O||Iterators.hasOwnProperty(classof(O))}},function(module,exports,__webpack_require__){__webpack_require__(47),__webpack_require__(37),module.exports=__webpack_require__(300)},function(module,exports,__webpack_require__){var anObject=__webpack_require__(14),get=__webpack_require__(99);module.exports=__webpack_require__(1).getIterator=function(it){var iterFn=get(it);if("function"!=typeof iterFn)throw TypeError(it+" is not iterable!");return anObject(iterFn.call(it))}},function(module,exports,__webpack_require__){"use strict";var emptyFunction=__webpack_require__(55),invariant=__webpack_require__(171),ReactPropTypesSecret=__webpack_require__(302);module.exports=function(){function shim(props,propName,componentName,location,propFullName,secret){secret!==ReactPropTypesSecret&&invariant(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function getShim(){return shim}shim.isRequired=shim;var ReactPropTypes={array:shim,bool:shim,func:shim,number:shim,object:shim,string:shim,symbol:shim,any:shim,arrayOf:getShim,element:shim,instanceOf:getShim,node:shim,objectOf:getShim,oneOf:getShim,oneOfType:getShim,shape:getShim,exact:getShim};return ReactPropTypes.checkPropTypes=emptyFunction,ReactPropTypes.PropTypes=ReactPropTypes,ReactPropTypes}},function(module,exports,__webpack_require__){"use strict";module.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(module,exports){var codes=(exports=module.exports=function(searchInput){if(searchInput&&"object"==typeof searchInput){var hasKeyCode=searchInput.which||searchInput.keyCode||searchInput.charCode;hasKeyCode&&(searchInput=hasKeyCode)}if("number"==typeof searchInput)return names[searchInput];var foundNamedKey,search=String(searchInput);return(foundNamedKey=codes[search.toLowerCase()])?foundNamedKey:(foundNamedKey=aliases[search.toLowerCase()])||(1===search.length?search.charCodeAt(0):void 0)}).code=exports.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},aliases=exports.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(i=97;i<123;i++)codes[String.fromCharCode(i)]=i-32;for(var i=48;i<58;i++)codes[i-48]=i;for(i=1;i<13;i++)codes["f"+i]=i+111;for(i=0;i<10;i++)codes["numpad "+i]=i+96;var names=exports.names=exports.title={};for(i in codes)names[codes[i]]=i;for(var alias in aliases)codes[alias]=aliases[alias]},function(module,exports,__webpack_require__){var core=__webpack_require__(1),$JSON=core.JSON||(core.JSON={stringify:JSON.stringify});module.exports=function stringify(it){return $JSON.stringify.apply($JSON,arguments)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.reviver=exports.retrocycle=exports.decycle=exports.CYCLIC_KEY=void 0;var _decycle3=_interopRequireDefault(__webpack_require__(515)),_retrocycle3=_interopRequireDefault(__webpack_require__(545)),_reviver3=_interopRequireDefault(__webpack_require__(364));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.CYCLIC_KEY="$___storybook.isCyclic";exports.decycle=_decycle3.default,exports.retrocycle=_retrocycle3.default,exports.reviver=_reviver3.default},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(307),__esModule:!0}},function(module,exports,__webpack_require__){__webpack_require__(37),__webpack_require__(47),module.exports=__webpack_require__(104).f("iterator")},function(module,exports,__webpack_require__){__webpack_require__(309),__webpack_require__(97),__webpack_require__(312),__webpack_require__(313),module.exports=__webpack_require__(1).Symbol},function(module,exports,__webpack_require__){"use strict";var global=__webpack_require__(7),has=__webpack_require__(25),DESCRIPTORS=__webpack_require__(16),$export=__webpack_require__(5),redefine=__webpack_require__(111),META=__webpack_require__(66).KEY,$fails=__webpack_require__(24),shared=__webpack_require__(93),setToStringTag=__webpack_require__(46),uid=__webpack_require__(63),wks=__webpack_require__(6),wksExt=__webpack_require__(104),wksDefine=__webpack_require__(105),enumKeys=__webpack_require__(310),isArray=__webpack_require__(152),anObject=__webpack_require__(14),isObject=__webpack_require__(9),toIObject=__webpack_require__(28),toPrimitive=__webpack_require__(88),createDesc=__webpack_require__(43),_create=__webpack_require__(73),gOPNExt=__webpack_require__(311),$GOPD=__webpack_require__(113),$DP=__webpack_require__(13),$keys=__webpack_require__(44),gOPD=$GOPD.f,dP=$DP.f,gOPN=gOPNExt.f,$Symbol=global.Symbol,$JSON=global.JSON,_stringify=$JSON&&$JSON.stringify,HIDDEN=wks("_hidden"),TO_PRIMITIVE=wks("toPrimitive"),isEnum={}.propertyIsEnumerable,SymbolRegistry=shared("symbol-registry"),AllSymbols=shared("symbols"),OPSymbols=shared("op-symbols"),ObjectProto=Object.prototype,USE_NATIVE="function"==typeof $Symbol,QObject=global.QObject,setter=!QObject||!QObject.prototype||!QObject.prototype.findChild,setSymbolDesc=DESCRIPTORS&&$fails(function(){return 7!=_create(dP({},"a",{get:function(){return dP(this,"a",{value:7}).a}})).a})?function(it,key,D){var protoDesc=gOPD(ObjectProto,key);protoDesc&&delete ObjectProto[key],dP(it,key,D),protoDesc&&it!==ObjectProto&&dP(ObjectProto,key,protoDesc)}:dP,wrap=function(tag){var sym=AllSymbols[tag]=_create($Symbol.prototype);return sym._k=tag,sym},isSymbol=USE_NATIVE&&"symbol"==typeof $Symbol.iterator?function(it){return"symbol"==typeof it}:function(it){return it instanceof $Symbol},$defineProperty=function defineProperty(it,key,D){return it===ObjectProto&&$defineProperty(OPSymbols,key,D),anObject(it),key=toPrimitive(key,!0),anObject(D),has(AllSymbols,key)?(D.enumerable?(has(it,HIDDEN)&&it[HIDDEN][key]&&(it[HIDDEN][key]=!1),D=_create(D,{enumerable:createDesc(0,!1)})):(has(it,HIDDEN)||dP(it,HIDDEN,createDesc(1,{})),it[HIDDEN][key]=!0),setSymbolDesc(it,key,D)):dP(it,key,D)},$defineProperties=function defineProperties(it,P){anObject(it);for(var key,keys=enumKeys(P=toIObject(P)),i=0,l=keys.length;l>i;)$defineProperty(it,key=keys[i++],P[key]);return it},$propertyIsEnumerable=function propertyIsEnumerable(key){var E=isEnum.call(this,key=toPrimitive(key,!0));return!(this===ObjectProto&&has(AllSymbols,key)&&!has(OPSymbols,key))&&(!(E||!has(this,key)||!has(AllSymbols,key)||has(this,HIDDEN)&&this[HIDDEN][key])||E)},$getOwnPropertyDescriptor=function getOwnPropertyDescriptor(it,key){if(it=toIObject(it),key=toPrimitive(key,!0),it!==ObjectProto||!has(AllSymbols,key)||has(OPSymbols,key)){var D=gOPD(it,key);return!D||!has(AllSymbols,key)||has(it,HIDDEN)&&it[HIDDEN][key]||(D.enumerable=!0),D}},$getOwnPropertyNames=function getOwnPropertyNames(it){for(var key,names=gOPN(toIObject(it)),result=[],i=0;names.length>i;)has(AllSymbols,key=names[i++])||key==HIDDEN||key==META||result.push(key);return result},$getOwnPropertySymbols=function getOwnPropertySymbols(it){for(var key,IS_OP=it===ObjectProto,names=gOPN(IS_OP?OPSymbols:toIObject(it)),result=[],i=0;names.length>i;)!has(AllSymbols,key=names[i++])||IS_OP&&!has(ObjectProto,key)||result.push(AllSymbols[key]);return result};USE_NATIVE||(redefine(($Symbol=function Symbol(){if(this instanceof $Symbol)throw TypeError("Symbol is not a constructor!");var tag=uid(arguments.length>0?arguments[0]:void 0),$set=function(value){this===ObjectProto&&$set.call(OPSymbols,value),has(this,HIDDEN)&&has(this[HIDDEN],tag)&&(this[HIDDEN][tag]=!1),setSymbolDesc(this,tag,createDesc(1,value))};return DESCRIPTORS&&setter&&setSymbolDesc(ObjectProto,tag,{configurable:!0,set:$set}),wrap(tag)}).prototype,"toString",function toString(){return this._k}),$GOPD.f=$getOwnPropertyDescriptor,$DP.f=$defineProperty,__webpack_require__(153).f=gOPNExt.f=$getOwnPropertyNames,__webpack_require__(64).f=$propertyIsEnumerable,__webpack_require__(95).f=$getOwnPropertySymbols,DESCRIPTORS&&!__webpack_require__(65)&&redefine(ObjectProto,"propertyIsEnumerable",$propertyIsEnumerable,!0),wksExt.f=function(name){return wrap(wks(name))}),$export($export.G+$export.W+$export.F*!USE_NATIVE,{Symbol:$Symbol});for(var es6Symbols="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),j=0;es6Symbols.length>j;)wks(es6Symbols[j++]);for(var wellKnownSymbols=$keys(wks.store),k=0;wellKnownSymbols.length>k;)wksDefine(wellKnownSymbols[k++]);$export($export.S+$export.F*!USE_NATIVE,"Symbol",{for:function(key){return has(SymbolRegistry,key+="")?SymbolRegistry[key]:SymbolRegistry[key]=$Symbol(key)},keyFor:function keyFor(sym){if(!isSymbol(sym))throw TypeError(sym+" is not a symbol!");for(var key in SymbolRegistry)if(SymbolRegistry[key]===sym)return key},useSetter:function(){setter=!0},useSimple:function(){setter=!1}}),$export($export.S+$export.F*!USE_NATIVE,"Object",{create:function create(it,P){return void 0===P?_create(it):$defineProperties(_create(it),P)},defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor,getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols}),$JSON&&$export($export.S+$export.F*(!USE_NATIVE||$fails(function(){var S=$Symbol();return"[null]"!=_stringify([S])||"{}"!=_stringify({a:S})||"{}"!=_stringify(Object(S))})),"JSON",{stringify:function stringify(it){for(var replacer,$replacer,args=[it],i=1;arguments.length>i;)args.push(arguments[i++]);if($replacer=replacer=args[1],(isObject(replacer)||void 0!==it)&&!isSymbol(it))return isArray(replacer)||(replacer=function(key,value){if("function"==typeof $replacer&&(value=$replacer.call(this,key,value)),!isSymbol(value))return value}),args[1]=replacer,_stringify.apply($JSON,args)}}),$Symbol.prototype[TO_PRIMITIVE]||__webpack_require__(23)($Symbol.prototype,TO_PRIMITIVE,$Symbol.prototype.valueOf),setToStringTag($Symbol,"Symbol"),setToStringTag(Math,"Math",!0),setToStringTag(global.JSON,"JSON",!0)},function(module,exports,__webpack_require__){var getKeys=__webpack_require__(44),gOPS=__webpack_require__(95),pIE=__webpack_require__(64);module.exports=function(it){var result=getKeys(it),getSymbols=gOPS.f;if(getSymbols)for(var key,symbols=getSymbols(it),isEnum=pIE.f,i=0;symbols.length>i;)isEnum.call(it,key=symbols[i++])&&result.push(key);return result}},function(module,exports,__webpack_require__){var toIObject=__webpack_require__(28),gOPN=__webpack_require__(153).f,toString={}.toString,windowNames="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];module.exports.f=function getOwnPropertyNames(it){return windowNames&&"[object Window]"==toString.call(it)?function(it){try{return gOPN(it)}catch(e){return windowNames.slice()}}(it):gOPN(toIObject(it))}},function(module,exports,__webpack_require__){__webpack_require__(105)("asyncIterator")},function(module,exports,__webpack_require__){__webpack_require__(105)("observable")},function(module,exports,__webpack_require__){var speciesConstructor=__webpack_require__(315);module.exports=function(original,length){return new(speciesConstructor(original))(length)}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(9),isArray=__webpack_require__(152),SPECIES=__webpack_require__(6)("species");module.exports=function(original){var C;return isArray(original)&&("function"!=typeof(C=original.constructor)||C!==Array&&!isArray(C.prototype)||(C=void 0),isObject(C)&&null===(C=C[SPECIES])&&(C=void 0)),void 0===C?Array:C}},function(module,exports,__webpack_require__){"use strict";var global=__webpack_require__(7),$export=__webpack_require__(5),meta=__webpack_require__(66),fails=__webpack_require__(24),hide=__webpack_require__(23),redefineAll=__webpack_require__(101),forOf=__webpack_require__(52),anInstance=__webpack_require__(98),isObject=__webpack_require__(9),setToStringTag=__webpack_require__(46),dP=__webpack_require__(13).f,each=__webpack_require__(154)(0),DESCRIPTORS=__webpack_require__(16);module.exports=function(NAME,wrapper,methods,common,IS_MAP,IS_WEAK){var Base=global[NAME],C=Base,ADDER=IS_MAP?"set":"add",proto=C&&C.prototype,O={};return DESCRIPTORS&&"function"==typeof C&&(IS_WEAK||proto.forEach&&!fails(function(){(new C).entries().next()}))?(C=wrapper(function(target,iterable){anInstance(target,C,NAME,"_c"),target._c=new Base,void 0!=iterable&&forOf(iterable,IS_MAP,target[ADDER],target)}),each("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(KEY){var IS_ADDER="add"==KEY||"set"==KEY;KEY in proto&&(!IS_WEAK||"clear"!=KEY)&&hide(C.prototype,KEY,function(a,b){if(anInstance(this,C,KEY),!IS_ADDER&&IS_WEAK&&!isObject(a))return"get"==KEY&&void 0;var result=this._c[KEY](0===a?0:a,b);return IS_ADDER?this:result})}),IS_WEAK||dP(C.prototype,"size",{get:function(){return this._c.size}})):(C=common.getConstructor(wrapper,NAME,IS_MAP,ADDER),redefineAll(C.prototype,methods),meta.NEED=!0),setToStringTag(C,NAME),O[NAME]=C,$export($export.G+$export.W+$export.F,O),IS_WEAK||common.setStrong(C,NAME,IS_MAP),C}},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(5);module.exports=function(COLLECTION){$export($export.S,COLLECTION,{of:function of(){for(var length=arguments.length,A=new Array(length);length--;)A[length]=arguments[length];return new this(A)}})}},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(5),aFunction=__webpack_require__(42),ctx=__webpack_require__(18),forOf=__webpack_require__(52);module.exports=function(COLLECTION){$export($export.S,COLLECTION,{from:function from(source){var mapping,A,n,cb,mapFn=arguments[1];return aFunction(this),(mapping=void 0!==mapFn)&&aFunction(mapFn),void 0==source?new this:(A=[],mapping?(n=0,cb=ctx(mapFn,arguments[2],2),forOf(source,!1,function(nextItem){A.push(cb(nextItem,n++))})):forOf(source,!1,A.push,A),new this(A))}})}},function(module,exports,__webpack_require__){__webpack_require__(320),module.exports=__webpack_require__(1).Object.getPrototypeOf},function(module,exports,__webpack_require__){var toObject=__webpack_require__(34),$getPrototypeOf=__webpack_require__(141);__webpack_require__(96)("getPrototypeOf",function(){return function getPrototypeOf(it){return $getPrototypeOf(toObject(it))}})},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(322),__esModule:!0}},function(module,exports,__webpack_require__){__webpack_require__(323),module.exports=__webpack_require__(1).Object.setPrototypeOf},function(module,exports,__webpack_require__){var $export=__webpack_require__(5);$export($export.S,"Object",{setPrototypeOf:__webpack_require__(324).set})},function(module,exports,__webpack_require__){var isObject=__webpack_require__(9),anObject=__webpack_require__(14),check=function(O,proto){if(anObject(O),!isObject(proto)&&null!==proto)throw TypeError(proto+": can't set as prototype!")};module.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(test,buggy,set){try{(set=__webpack_require__(18)(Function.call,__webpack_require__(113).f(Object.prototype,"__proto__").set,2))(test,[]),buggy=!(test instanceof Array)}catch(e){buggy=!0}return function setPrototypeOf(O,proto){return check(O,proto),buggy?O.__proto__=proto:set(O,proto),O}}({},!1):void 0),check:check}},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(326),__esModule:!0}},function(module,exports,__webpack_require__){__webpack_require__(327);var $Object=__webpack_require__(1).Object;module.exports=function create(P,D){return $Object.create(P,D)}},function(module,exports,__webpack_require__){var $export=__webpack_require__(5);$export($export.S,"Object",{create:__webpack_require__(73)})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.types=exports.undefinedType=exports.symbolType=exports.regexpType=exports.nanType=exports.infinityType=exports.functionType=exports.dateType=exports.objectType=void 0;var _object2=_interopRequireDefault(__webpack_require__(525)),_date2=_interopRequireDefault(__webpack_require__(532)),_function2=_interopRequireDefault(__webpack_require__(533)),_infinity2=_interopRequireDefault(__webpack_require__(535)),_nan2=_interopRequireDefault(__webpack_require__(539)),_regexp2=_interopRequireDefault(__webpack_require__(540)),_symbol2=_interopRequireDefault(__webpack_require__(542)),_undefined2=_interopRequireDefault(__webpack_require__(544));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.objectType=_object2.default,exports.dateType=_date2.default,exports.functionType=_function2.default,exports.infinityType=_infinity2.default,exports.nanType=_nan2.default,exports.regexpType=_regexp2.default,exports.symbolType=_symbol2.default,exports.undefinedType=_undefined2.default;exports.types=[_date2.default,_function2.default,_nan2.default,_infinity2.default,_regexp2.default,_symbol2.default,_undefined2.default]},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function createFunction(){var name=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(_canConfigureName2.default){var func=function unnamed(){};return Object.defineProperty(func,"name",{value:name}),func}return(0,_createFunctionEval2.default)(name)};var _canConfigureName2=_interopRequireDefault(__webpack_require__(363)),_createFunctionEval2=_interopRequireDefault(__webpack_require__(527));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.hrefTo=exports.linkTo=exports.openLink=void 0;var _promise2=_interopRequireDefault(__webpack_require__(139)),_toConsumableArray3=_interopRequireDefault(__webpack_require__(53)),_addons2=_interopRequireDefault(__webpack_require__(51)),_=__webpack_require__(156);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var openLink=exports.openLink=function openLink(params){return _addons2.default.getChannel().emit(_.EVENT_ID,params)};exports.linkTo=function linkTo(kind,story){return function(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var resolver=function valueOrCall(args){return function(value){return"function"==typeof value?value.apply(void 0,(0,_toConsumableArray3.default)(args)):value}}(args);openLink({kind:resolver(kind),story:resolver(story)})}},exports.hrefTo=function hrefTo(kind,story){return new _promise2.default(function(resolve){var channel=_addons2.default.getChannel();channel.on(_.RECEIVE_HREF_EVENT_ID,resolve),channel.emit(_.REQUEST_HREF_EVENT_ID,{kind:kind,story:story})})}},,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.linkTo=exports.action=exports.getStorybook=exports.configure=exports.addDecorator=exports.setAddon=exports.storiesOf=void 0;var _preview=__webpack_require__(350);Object.defineProperty(exports,"storiesOf",{enumerable:!0,get:function get(){return _preview.storiesOf}}),Object.defineProperty(exports,"setAddon",{enumerable:!0,get:function get(){return _preview.setAddon}}),Object.defineProperty(exports,"addDecorator",{enumerable:!0,get:function get(){return _preview.addDecorator}}),Object.defineProperty(exports,"configure",{enumerable:!0,get:function get(){return _preview.configure}}),Object.defineProperty(exports,"getStorybook",{enumerable:!0,get:function get(){return _preview.getStorybook}});var _utilDeprecate2=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(361)),_addonActions=__webpack_require__(362),_addonLinks=__webpack_require__(156);exports.action=(0,_utilDeprecate2.default)(_addonActions.action,"@storybook/react action is deprecated. See: https://github.com/storybooks/storybook/tree/master/addons/actions"),exports.linkTo=(0,_utilDeprecate2.default)(_addonLinks.linkTo,"@storybook/react linkTo is deprecated. See: https://github.com/storybooks/storybook/tree/master/addons/links")},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.configure=exports.getStorybook=exports.clearDecorators=exports.addDecorator=exports.setAddon=exports.storiesOf=void 0;var _assign2=_interopRequireDefault(__webpack_require__(72)),_redux=__webpack_require__(432),_addons2=_interopRequireDefault(__webpack_require__(51)),_channelPostmessage2=_interopRequireDefault(__webpack_require__(266)),_qs2=_interopRequireDefault(__webpack_require__(149)),_global=__webpack_require__(48),_story_store2=_interopRequireDefault(__webpack_require__(447)),_client_api2=_interopRequireDefault(__webpack_require__(448)),_config_api2=_interopRequireDefault(__webpack_require__(449)),_render2=_interopRequireDefault(__webpack_require__(450)),_init2=_interopRequireDefault(__webpack_require__(502)),_actions=__webpack_require__(168),_reducer2=_interopRequireDefault(__webpack_require__(503));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var isBrowser=_global.navigator&&_global.navigator.userAgent&&"storyshots"!==_global.navigator.userAgent&&!(_global.navigator.userAgent.indexOf("Node.js")>-1)&&!(_global.navigator.userAgent.indexOf("jsdom")>-1),storyStore=new _story_store2.default,reduxStore=(0,_redux.createStore)(_reducer2.default),context={storyStore:storyStore,reduxStore:reduxStore};if(isBrowser){var queryParams=_qs2.default.parse(_global.window.location.search.substring(1)),channel=(0,_channelPostmessage2.default)({page:"preview"});channel.on("setCurrentStory",function(data){reduxStore.dispatch((0,_actions.selectStory)(data.kind,data.story))}),(0,_assign2.default)(context,{channel:channel,window:_global.window,queryParams:queryParams}),_addons2.default.setChannel(channel),(0,_init2.default)(context)}var clientApi=new _client_api2.default(context),configApi=new _config_api2.default(context);exports.storiesOf=clientApi.storiesOf.bind(clientApi),exports.setAddon=clientApi.setAddon.bind(clientApi),exports.addDecorator=clientApi.addDecorator.bind(clientApi),exports.clearDecorators=clientApi.clearDecorators.bind(clientApi),exports.getStorybook=clientApi.getStorybook.bind(clientApi),exports.configure=configApi.configure.bind(configApi);reduxStore.subscribe(function renderUI(){isBrowser&&(0,_render2.default)(context)})},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return ActionTypes}),__webpack_exports__.b=function createStore(reducer,preloadedState,enhancer){var _ref2;"function"==typeof preloadedState&&void 0===enhancer&&(enhancer=preloadedState,preloadedState=void 0);if(void 0!==enhancer){if("function"!=typeof enhancer)throw new Error("Expected the enhancer to be a function.");return enhancer(createStore)(reducer,preloadedState)}if("function"!=typeof reducer)throw new Error("Expected the reducer to be a function.");var currentReducer=reducer;var currentState=preloadedState;var currentListeners=[];var nextListeners=currentListeners;var isDispatching=!1;function ensureCanMutateNextListeners(){nextListeners===currentListeners&&(nextListeners=currentListeners.slice())}function getState(){return currentState}function subscribe(listener){if("function"!=typeof listener)throw new Error("Expected listener to be a function.");var isSubscribed=!0;return ensureCanMutateNextListeners(),nextListeners.push(listener),function unsubscribe(){if(isSubscribed){isSubscribed=!1,ensureCanMutateNextListeners();var index=nextListeners.indexOf(listener);nextListeners.splice(index,1)}}}function dispatch(action){if(!Object(__WEBPACK_IMPORTED_MODULE_0_lodash_es_isPlainObject__.a)(action))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===action.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(isDispatching)throw new Error("Reducers may not dispatch actions.");try{isDispatching=!0,currentState=currentReducer(currentState,action)}finally{isDispatching=!1}for(var listeners=currentListeners=nextListeners,i=0;i<listeners.length;i++){var listener=listeners[i];listener()}return action}dispatch({type:ActionTypes.INIT});return _ref2={dispatch:dispatch,subscribe:subscribe,getState:getState,replaceReducer:function replaceReducer(nextReducer){if("function"!=typeof nextReducer)throw new Error("Expected the nextReducer to be a function.");currentReducer=nextReducer,dispatch({type:ActionTypes.INIT})}},_ref2[__WEBPACK_IMPORTED_MODULE_1_symbol_observable__.a]=function observable(){var _ref,outerSubscribe=subscribe;return(_ref={subscribe:function subscribe(observer){if("object"!=typeof observer)throw new TypeError("Expected the observer to be an object.");function observeState(){observer.next&&observer.next(getState())}observeState();var unsubscribe=outerSubscribe(observeState);return{unsubscribe:unsubscribe}}})[__WEBPACK_IMPORTED_MODULE_1_symbol_observable__.a]=function(){return this},_ref},_ref2};var __WEBPACK_IMPORTED_MODULE_0_lodash_es_isPlainObject__=__webpack_require__(352),__WEBPACK_IMPORTED_MODULE_1_symbol_observable__=__webpack_require__(441),ActionTypes={INIT:"@@redux/INIT"}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__baseGetTag_js__=__webpack_require__(433),__WEBPACK_IMPORTED_MODULE_1__getPrototype_js__=__webpack_require__(438),__WEBPACK_IMPORTED_MODULE_2__isObjectLike_js__=__webpack_require__(440),objectTag="[object Object]",funcProto=Function.prototype,objectProto=Object.prototype,funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,objectCtorString=funcToString.call(Object);__webpack_exports__.a=function isPlainObject(value){if(!Object(__WEBPACK_IMPORTED_MODULE_2__isObjectLike_js__.a)(value)||Object(__WEBPACK_IMPORTED_MODULE_0__baseGetTag_js__.a)(value)!=objectTag)return!1;var proto=Object(__WEBPACK_IMPORTED_MODULE_1__getPrototype_js__.a)(value);if(null===proto)return!0;var Ctor=hasOwnProperty.call(proto,"constructor")&&proto.constructor;return"function"==typeof Ctor&&Ctor instanceof Ctor&&funcToString.call(Ctor)==objectCtorString}},function(module,__webpack_exports__,__webpack_require__){"use strict";var Symbol=__webpack_require__(434).a.Symbol;__webpack_exports__.a=Symbol},function(module,__webpack_exports__,__webpack_require__){"use strict"},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a=function compose(){for(var _len=arguments.length,funcs=Array(_len),_key=0;_key<_len;_key++)funcs[_key]=arguments[_key];if(0===funcs.length)return function(arg){return arg};if(1===funcs.length)return funcs[0];return funcs.reduce(function(a,b){return function(){return a(b.apply(void 0,arguments))}})}},function(module,exports,__webpack_require__){"use strict";(function(global){Object.defineProperty(exports,"__esModule",{value:!0});var console=global.console;exports.logger={info:function info(message){return console.log(message)},warn:function warn(message){return console.warn(message)},error:function error(message){return console.error(message)}}}).call(exports,__webpack_require__(17))},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _defineProperties2=_interopRequireDefault(__webpack_require__(451)),_freeze2=_interopRequireDefault(__webpack_require__(454));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=function(strings,raw){return(0,_freeze2.default)((0,_defineProperties2.default)(strings,{raw:{value:(0,_freeze2.default)(raw)}}))}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__replaceSubstitutionTransformer__=__webpack_require__(462);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__replaceSubstitutionTransformer__.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__removeNonPrintingValuesTransformer__=__webpack_require__(467);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__removeNonPrintingValuesTransformer__.a})},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(468),__esModule:!0}},function(module,exports,__webpack_require__){(function(global){function config(name){try{if(!global.localStorage)return!1}catch(_){return!1}var val=global.localStorage[name];return null!=val&&"true"===String(val).toLowerCase()}module.exports=function deprecate(fn,msg){if(config("noDeprecation"))return fn;var warned=!1;return function deprecated(){if(!warned){if(config("throwDeprecation"))throw new Error(msg);config("traceDeprecation")?console.trace(msg):console.warn(msg),warned=!0}return fn.apply(this,arguments)}}}).call(exports,__webpack_require__(17))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _preview=__webpack_require__(504);Object.defineProperty(exports,"action",{enumerable:!0,get:function get(){return _preview.action}}),Object.defineProperty(exports,"decorateAction",{enumerable:!0,get:function get(){return _preview.decorateAction}});var ADDON_ID=exports.ADDON_ID="storybook/actions";exports.PANEL_ID=ADDON_ID+"/actions-panel",exports.EVENT_ID=ADDON_ID+"/action-event"},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var nameDescriptor=(0,function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(508)).default)(function unnamed(){},"name"),canConfigureName=!nameDescriptor||nameDescriptor.configurable;exports.default=canConfigureName},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _util=__webpack_require__(173);exports.default=function reviver(key,value){if((0,_util.isObject)(value)){var result=(0,_util.typeReviver)(value);if(result)return result.value}return value}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){__webpack_require__(179),__webpack_require__(430),module.exports=__webpack_require__(431)},function(module,exports,__webpack_require__){"use strict";window.STORYBOOK_REACT_CLASSES={},window.STORYBOOK_ENV="react"},function(module,exports,__webpack_require__){"use strict";(function(module){(0,__webpack_require__(349).configure)(function loadStories(){__webpack_require__(548)},module)}).call(exports,__webpack_require__(162)(module))},function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0__createStore__=__webpack_require__(351),__WEBPACK_IMPORTED_MODULE_1__combineReducers__=__webpack_require__(444),__WEBPACK_IMPORTED_MODULE_2__bindActionCreators__=__webpack_require__(445),__WEBPACK_IMPORTED_MODULE_3__applyMiddleware__=__webpack_require__(446),__WEBPACK_IMPORTED_MODULE_4__compose__=__webpack_require__(355);__webpack_require__(354);__webpack_require__.d(__webpack_exports__,"createStore",function(){return __WEBPACK_IMPORTED_MODULE_0__createStore__.b}),__webpack_require__.d(__webpack_exports__,"combineReducers",function(){return __WEBPACK_IMPORTED_MODULE_1__combineReducers__.a}),__webpack_require__.d(__webpack_exports__,"bindActionCreators",function(){return __WEBPACK_IMPORTED_MODULE_2__bindActionCreators__.a}),__webpack_require__.d(__webpack_exports__,"applyMiddleware",function(){return __WEBPACK_IMPORTED_MODULE_3__applyMiddleware__.a}),__webpack_require__.d(__webpack_exports__,"compose",function(){return __WEBPACK_IMPORTED_MODULE_4__compose__.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__Symbol_js__=__webpack_require__(353),__WEBPACK_IMPORTED_MODULE_1__getRawTag_js__=__webpack_require__(436),__WEBPACK_IMPORTED_MODULE_2__objectToString_js__=__webpack_require__(437),nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=__WEBPACK_IMPORTED_MODULE_0__Symbol_js__.a?__WEBPACK_IMPORTED_MODULE_0__Symbol_js__.a.toStringTag:void 0;__webpack_exports__.a=function baseGetTag(value){return null==value?void 0===value?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(value)?Object(__WEBPACK_IMPORTED_MODULE_1__getRawTag_js__.a)(value):Object(__WEBPACK_IMPORTED_MODULE_2__objectToString_js__.a)(value)}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__freeGlobal_js__=__webpack_require__(435),freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=__WEBPACK_IMPORTED_MODULE_0__freeGlobal_js__.a||freeSelf||Function("return this")();__webpack_exports__.a=root},function(module,__webpack_exports__,__webpack_require__){"use strict";(function(global){var freeGlobal="object"==typeof global&&global&&global.Object===Object&&global;__webpack_exports__.a=freeGlobal}).call(__webpack_exports__,__webpack_require__(17))},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__Symbol_js__=__webpack_require__(353),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=__WEBPACK_IMPORTED_MODULE_0__Symbol_js__.a?__WEBPACK_IMPORTED_MODULE_0__Symbol_js__.a.toStringTag:void 0;__webpack_exports__.a=function getRawTag(value){var isOwn=hasOwnProperty.call(value,symToStringTag),tag=value[symToStringTag];try{value[symToStringTag]=void 0;var unmasked=!0}catch(e){}var result=nativeObjectToString.call(value);return unmasked&&(isOwn?value[symToStringTag]=tag:delete value[symToStringTag]),result}},function(module,__webpack_exports__,__webpack_require__){"use strict";var nativeObjectToString=Object.prototype.toString;__webpack_exports__.a=function objectToString(value){return nativeObjectToString.call(value)}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__overArg_js__=__webpack_require__(439),getPrototype=Object(__WEBPACK_IMPORTED_MODULE_0__overArg_js__.a)(Object.getPrototypeOf,Object);__webpack_exports__.a=getPrototype},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a=function overArg(func,transform){return function(arg){return func(transform(arg))}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a=function isObjectLike(value){return null!=value&&"object"==typeof value}},function(module,__webpack_exports__,__webpack_require__){"use strict";(function(global,module){var root,__WEBPACK_IMPORTED_MODULE_0__ponyfill_js__=__webpack_require__(443);root="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==global?global:module;var result=Object(__WEBPACK_IMPORTED_MODULE_0__ponyfill_js__.a)(root);__webpack_exports__.a=result}).call(__webpack_exports__,__webpack_require__(17),__webpack_require__(442)(module))},function(module,exports){module.exports=function(originalModule){if(!originalModule.webpackPolyfill){var module=Object.create(originalModule);module.children||(module.children=[]),Object.defineProperty(module,"loaded",{enumerable:!0,get:function(){return module.l}}),Object.defineProperty(module,"id",{enumerable:!0,get:function(){return module.i}}),Object.defineProperty(module,"exports",{enumerable:!0}),module.webpackPolyfill=1}return module}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a=function symbolObservablePonyfill(root){var result,Symbol=root.Symbol;"function"==typeof Symbol?Symbol.observable?result=Symbol.observable:(result=Symbol("observable"),Symbol.observable=result):result="@@observable";return result}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a=function combineReducers(reducers){for(var reducerKeys=Object.keys(reducers),finalReducers={},i=0;i<reducerKeys.length;i++){var key=reducerKeys[i];0,"function"==typeof reducers[key]&&(finalReducers[key]=reducers[key])}var finalReducerKeys=Object.keys(finalReducers);0;var shapeAssertionError=void 0;try{!function assertReducerShape(reducers){Object.keys(reducers).forEach(function(key){var reducer=reducers[key],initialState=reducer(void 0,{type:__WEBPACK_IMPORTED_MODULE_0__createStore__.a.INIT});if(void 0===initialState)throw new Error('Reducer "'+key+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");var type="@@redux/PROBE_UNKNOWN_ACTION_"+Math.random().toString(36).substring(7).split("").join(".");if(void 0===reducer(void 0,{type:type}))throw new Error('Reducer "'+key+"\" returned undefined when probed with a random type. Don't try to handle "+__WEBPACK_IMPORTED_MODULE_0__createStore__.a.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}(finalReducers)}catch(e){shapeAssertionError=e}return function combination(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},action=arguments[1];if(shapeAssertionError)throw shapeAssertionError;for(var hasChanged=!1,nextState={},_i=0;_i<finalReducerKeys.length;_i++){var _key=finalReducerKeys[_i],reducer=finalReducers[_key],previousStateForKey=state[_key],nextStateForKey=reducer(previousStateForKey,action);if(void 0===nextStateForKey){var errorMessage=getUndefinedStateErrorMessage(_key,action);throw new Error(errorMessage)}nextState[_key]=nextStateForKey,hasChanged=hasChanged||nextStateForKey!==previousStateForKey}return hasChanged?nextState:state}};var __WEBPACK_IMPORTED_MODULE_0__createStore__=__webpack_require__(351);__webpack_require__(352),__webpack_require__(354);function getUndefinedStateErrorMessage(key,action){var actionType=action&&action.type;return"Given action "+(actionType&&'"'+actionType.toString()+'"'||"an action")+', reducer "'+key+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}},function(module,__webpack_exports__,__webpack_require__){"use strict";function bindActionCreator(actionCreator,dispatch){return function(){return dispatch(actionCreator.apply(void 0,arguments))}}__webpack_exports__.a=function bindActionCreators(actionCreators,dispatch){if("function"==typeof actionCreators)return bindActionCreator(actionCreators,dispatch);if("object"!=typeof actionCreators||null===actionCreators)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===actionCreators?"null":typeof actionCreators)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var keys=Object.keys(actionCreators),boundActionCreators={},i=0;i<keys.length;i++){var key=keys[i],actionCreator=actionCreators[key];"function"==typeof actionCreator&&(boundActionCreators[key]=bindActionCreator(actionCreator,dispatch))}return boundActionCreators}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a=function applyMiddleware(){for(var _len=arguments.length,middlewares=Array(_len),_key=0;_key<_len;_key++)middlewares[_key]=arguments[_key];return function(createStore){return function(reducer,preloadedState,enhancer){var store=createStore(reducer,preloadedState,enhancer),_dispatch=store.dispatch,chain=[],middlewareAPI={getState:store.getState,dispatch:function dispatch(action){return _dispatch(action)}};return chain=middlewares.map(function(middleware){return middleware(middlewareAPI)}),_dispatch=__WEBPACK_IMPORTED_MODULE_0__compose__.a.apply(void 0,chain)(store.dispatch),_extends({},store,{dispatch:_dispatch})}}};var __WEBPACK_IMPORTED_MODULE_0__compose__=__webpack_require__(355),_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _keys2=_interopRequireDefault(__webpack_require__(35)),_classCallCheck3=_interopRequireDefault(__webpack_require__(3)),_createClass3=_interopRequireDefault(__webpack_require__(4));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var count=0;function getId(){return count+=1}var StoryStore=function(){function StoryStore(){(0,_classCallCheck3.default)(this,StoryStore),this._data={},this._revision=0}return(0,_createClass3.default)(StoryStore,[{key:"getRevision",value:function getRevision(){return this._revision}},{key:"incrementRevision",value:function incrementRevision(){this._revision+=1}},{key:"addStory",value:function addStory(kind,name,fn,fileName){this._data[kind]||(this._data[kind]={kind:kind,fileName:fileName,index:getId(),stories:{}}),this._data[kind].stories[name]={name:name,index:getId(),fn:fn}}},{key:"getStoryKinds",value:function getStoryKinds(){var _this=this;return(0,_keys2.default)(this._data).map(function(key){return _this._data[key]}).filter(function(kind){return(0,_keys2.default)(kind.stories).length>0}).sort(function(info1,info2){return info1.index-info2.index}).map(function(info){return info.kind})}},{key:"getStories",value:function getStories(kind){var _this2=this;return this._data[kind]?(0,_keys2.default)(this._data[kind].stories).map(function(name){return _this2._data[kind].stories[name]}).sort(function(info1,info2){return info1.index-info2.index}).map(function(info){return info.name}):[]}},{key:"getStoryFileName",value:function getStoryFileName(kind){var storiesKind=this._data[kind];return storiesKind?storiesKind.fileName:null}},{key:"getStory",value:function getStory(kind,name){var storiesKind=this._data[kind];if(!storiesKind)return null;var storyInfo=storiesKind.stories[name];return storyInfo?storyInfo.fn:null}},{key:"removeStoryKind",value:function removeStoryKind(kind){this._data[kind].stories={}}},{key:"hasStoryKind",value:function hasStoryKind(kind){return Boolean(this._data[kind])}},{key:"hasStory",value:function hasStory(kind,name){return Boolean(this.getStory(kind,name))}},{key:"dumpStoryBook",value:function dumpStoryBook(){var _this3=this;return this.getStoryKinds().map(function(kind){return{kind:kind,stories:_this3.getStories(kind)}})}},{key:"size",value:function size(){return(0,_keys2.default)(this._data).length}},{key:"clean",value:function clean(){var _this4=this;this.getStoryKinds().forEach(function(kind){return delete _this4._data[kind]})}}]),StoryStore}();exports.default=StoryStore},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _toConsumableArray3=_interopRequireDefault(__webpack_require__(53)),_keys2=_interopRequireDefault(__webpack_require__(35)),_extends3=_interopRequireDefault(__webpack_require__(8)),_classCallCheck3=_interopRequireDefault(__webpack_require__(3)),_createClass3=_interopRequireDefault(__webpack_require__(4)),_clientLogger=__webpack_require__(356);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ClientApi=function(){function ClientApi(_ref){var channel=_ref.channel,storyStore=_ref.storyStore;(0,_classCallCheck3.default)(this,ClientApi),this._channel=channel,this._storyStore=storyStore,this._addons={},this._globalDecorators=[]}return(0,_createClass3.default)(ClientApi,[{key:"setAddon",value:function setAddon(addon){this._addons=(0,_extends3.default)({},this._addons,addon)}},{key:"addDecorator",value:function addDecorator(decorator){this._globalDecorators.push(decorator)}},{key:"clearDecorators",value:function clearDecorators(){this._globalDecorators=[]}},{key:"storiesOf",value:function storiesOf(kind,m){var _this=this;if(!kind&&"string"!=typeof kind)throw new Error("Invalid or missing kind provided for stories, should be a string");m||_clientLogger.logger.warn("Missing 'module' parameter for story with a kind of '"+kind+"'. It will break your HMR"),m&&m.hot&&m.hot.dispose(function(){_this._storyStore.removeStoryKind(kind),_this._storyStore.incrementRevision()});var localDecorators=[],api={kind:kind};return(0,_keys2.default)(this._addons).forEach(function(name){var addon=_this._addons[name];api[name]=function(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return addon.apply(api,args),api}}),api.add=function(storyName,getStory){if("string"!=typeof storyName)throw new Error('Invalid or missing storyName provided for a "'+kind+'" story.');if(_this._storyStore.hasStory(kind,storyName))throw new Error('Story of "'+kind+'" named "'+storyName+'" already exists');var fn=[].concat(localDecorators,(0,_toConsumableArray3.default)(_this._globalDecorators)).reduce(function(decorated,decorator){return function(context){return decorator(function(){return decorated(context)},context)}},getStory),fileName=m?m.filename:null;return _this._storyStore.addStory(kind,storyName,fn,fileName),api},api.addDecorator=function(decorator){return localDecorators.push(decorator),api},api}},{key:"getStorybook",value:function getStorybook(){var _this2=this;return this._storyStore.getStoryKinds().map(function(kind){var fileName=_this2._storyStore.getStoryFileName(kind),stories=_this2._storyStore.getStories(kind).map(function(name){return{name:name,render:_this2._storyStore.getStory(kind,name)}});return{kind:kind,fileName:fileName,stories:stories}})}}]),ClientApi}();exports.default=ClientApi},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _classCallCheck3=_interopRequireDefault(__webpack_require__(3)),_createClass3=_interopRequireDefault(__webpack_require__(4)),_global=__webpack_require__(48),_actions=__webpack_require__(168),_=__webpack_require__(350);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ConfigApi=function(){function ConfigApi(_ref){var channel=_ref.channel,storyStore=_ref.storyStore,reduxStore=_ref.reduxStore;(0,_classCallCheck3.default)(this,ConfigApi),this._channel=channel,this._storyStore=storyStore,this._reduxStore=reduxStore}return(0,_createClass3.default)(ConfigApi,[{key:"_renderMain",value:function _renderMain(loaders){loaders&&loaders();var stories=this._storyStore.dumpStoryBook();this._channel.emit("setStories",{stories:stories}),this._reduxStore.dispatch((0,_actions.clearError)()),this._reduxStore.dispatch((0,_actions.setInitialStory)(stories))}},{key:"_renderError",value:function _renderError(e){var error={stack:e.stack,message:e.message};this._reduxStore.dispatch((0,_actions.setError)(error))}},{key:"configure",value:function configure(loaders,module){var _this=this,render=function render(){try{_this._renderMain(loaders)}catch(error){module.hot&&"apply"===module.hot.status()?_global.location.reload():_this._renderError(error)}};module.hot&&(module.hot.accept(function(){setTimeout(render)}),module.hot.dispose(function(){(0,_.clearDecorators)()})),this._channel?render():loaders()}}]),ConfigApi}();exports.default=ConfigApi},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _taggedTemplateLiteral3=_interopRequireDefault(__webpack_require__(357)),_templateObject=(0,_taggedTemplateLiteral3.default)(['\n        Did you forget to return the React element from the story?\n        Use "() => (<MyComp/>)" or "() => { return <MyComp/>; }" when defining the story.\n      '],['\n        Did you forget to return the React element from the story?\n        Use "() => (<MyComp/>)" or "() => { return <MyComp/>; }" when defining the story.\n      ']),_templateObject2=(0,_taggedTemplateLiteral3.default)(["\n         Seems like you are not returning a correct React element from the story.\n         Could you double check that?\n       "],["\n         Seems like you are not returning a correct React element from the story.\n         Could you double check that?\n       "]);exports.renderError=renderError,exports.renderException=renderException,exports.renderMain=renderMain,exports.default=function renderPreview(_ref){var reduxStore=_ref.reduxStore,storyStore=_ref.storyStore,state=reduxStore.getState();if(state.error)return renderException(state.error);try{return renderMain(state,storyStore)}catch(ex){return renderException(ex)}};var _react2=_interopRequireDefault(__webpack_require__(0)),_reactDom2=_interopRequireDefault(__webpack_require__(102)),_commonTags=__webpack_require__(457),_clientLogger=__webpack_require__(356),_element_check2=_interopRequireDefault(__webpack_require__(499)),_error_display2=_interopRequireDefault(__webpack_require__(501));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var rootEl=null,previousKind="",previousStory="",previousRevision=-1;function renderError(error){var properError=new Error(error.title);properError.stack=error.description;var redBox=_react2.default.createElement(_error_display2.default,{error:properError});_reactDom2.default.render(redBox,rootEl)}function renderException(error){var realError=new Error(error.message);realError.stack=error.stack;var redBox=_react2.default.createElement(_error_display2.default,{error:realError});_reactDom2.default.render(redBox,rootEl),_clientLogger.logger.error(error.stack)}function renderMain(data,storyStore){if(0===storyStore.size())return null;var noPreview=_react2.default.createElement(function NoPreview(){return _react2.default.createElement("p",null,"No Preview Available!")},null),selectedKind=data.selectedKind,selectedStory=data.selectedStory,revision=storyStore.getRevision(),story=storyStore.getStory(selectedKind,selectedStory);if(!story)return _reactDom2.default.render(noPreview,rootEl),null;if(revision===previousRevision&&selectedKind===previousKind&&previousStory===selectedStory)return null;previousRevision=revision,previousKind=selectedKind,previousStory=selectedStory,_reactDom2.default.unmountComponentAtNode(rootEl);var element=story({kind:selectedKind,story:selectedStory});return element?(0,_element_check2.default)(element)?(_reactDom2.default.render(element,rootEl),null):renderError({title:'Expecting a valid React element from the story: "'+selectedStory+'" of "'+selectedKind+'".',description:(0,_commonTags.stripIndents)(_templateObject2)}):renderError({title:'Expecting a React element from the story: "'+selectedStory+'" of "'+selectedKind+'".',description:(0,_commonTags.stripIndents)(_templateObject)})}"undefined"!=typeof window&&(rootEl=document.getElementById("root"))},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(452),__esModule:!0}},function(module,exports,__webpack_require__){__webpack_require__(453);var $Object=__webpack_require__(1).Object;module.exports=function defineProperties(T,D){return $Object.defineProperties(T,D)}},function(module,exports,__webpack_require__){var $export=__webpack_require__(5);$export($export.S+$export.F*!__webpack_require__(16),"Object",{defineProperties:__webpack_require__(164)})},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(455),__esModule:!0}},function(module,exports,__webpack_require__){__webpack_require__(456),module.exports=__webpack_require__(1).Object.freeze},function(module,exports,__webpack_require__){var isObject=__webpack_require__(9),meta=__webpack_require__(66).onFreeze;__webpack_require__(96)("freeze",function($freeze){return function freeze(it){return $freeze&&isObject(it)?$freeze(meta(it)):it}})},function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0__TemplateTag__=__webpack_require__(26);__webpack_require__.d(__webpack_exports__,"TemplateTag",function(){return __WEBPACK_IMPORTED_MODULE_0__TemplateTag__.a});var __WEBPACK_IMPORTED_MODULE_1__trimResultTransformer__=__webpack_require__(27);__webpack_require__.d(__webpack_exports__,"trimResultTransformer",function(){return __WEBPACK_IMPORTED_MODULE_1__trimResultTransformer__.a});var __WEBPACK_IMPORTED_MODULE_2__stripIndentTransformer__=__webpack_require__(67);__webpack_require__.d(__webpack_exports__,"stripIndentTransformer",function(){return __WEBPACK_IMPORTED_MODULE_2__stripIndentTransformer__.a});var __WEBPACK_IMPORTED_MODULE_3__replaceResultTransformer__=__webpack_require__(103);__webpack_require__.d(__webpack_exports__,"replaceResultTransformer",function(){return __WEBPACK_IMPORTED_MODULE_3__replaceResultTransformer__.a});var __WEBPACK_IMPORTED_MODULE_4__replaceSubstitutionTransformer__=__webpack_require__(358);__webpack_require__.d(__webpack_exports__,"replaceSubstitutionTransformer",function(){return __WEBPACK_IMPORTED_MODULE_4__replaceSubstitutionTransformer__.a});var __WEBPACK_IMPORTED_MODULE_5__replaceStringTransformer__=__webpack_require__(463);__webpack_require__.d(__webpack_exports__,"replaceStringTransformer",function(){return __WEBPACK_IMPORTED_MODULE_5__replaceStringTransformer__.a});var __WEBPACK_IMPORTED_MODULE_6__inlineArrayTransformer__=__webpack_require__(49);__webpack_require__.d(__webpack_exports__,"inlineArrayTransformer",function(){return __WEBPACK_IMPORTED_MODULE_6__inlineArrayTransformer__.a});var __WEBPACK_IMPORTED_MODULE_7__splitStringTransformer__=__webpack_require__(294);__webpack_require__.d(__webpack_exports__,"splitStringTransformer",function(){return __WEBPACK_IMPORTED_MODULE_7__splitStringTransformer__.a});var __WEBPACK_IMPORTED_MODULE_8__removeNonPrintingValuesTransformer__=__webpack_require__(359);__webpack_require__.d(__webpack_exports__,"removeNonPrintingValuesTransformer",function(){return __WEBPACK_IMPORTED_MODULE_8__removeNonPrintingValuesTransformer__.a});var __WEBPACK_IMPORTED_MODULE_9__commaLists__=__webpack_require__(470);__webpack_require__.d(__webpack_exports__,"commaLists",function(){return __WEBPACK_IMPORTED_MODULE_9__commaLists__.a});var __WEBPACK_IMPORTED_MODULE_10__commaListsAnd__=__webpack_require__(472);__webpack_require__.d(__webpack_exports__,"commaListsAnd",function(){return __WEBPACK_IMPORTED_MODULE_10__commaListsAnd__.a});var __WEBPACK_IMPORTED_MODULE_11__commaListsOr__=__webpack_require__(474);__webpack_require__.d(__webpack_exports__,"commaListsOr",function(){return __WEBPACK_IMPORTED_MODULE_11__commaListsOr__.a});var __WEBPACK_IMPORTED_MODULE_12__html__=__webpack_require__(295);__webpack_require__.d(__webpack_exports__,"html",function(){return __WEBPACK_IMPORTED_MODULE_12__html__.a});var __WEBPACK_IMPORTED_MODULE_13__codeBlock__=__webpack_require__(477);__webpack_require__.d(__webpack_exports__,"codeBlock",function(){return __WEBPACK_IMPORTED_MODULE_13__codeBlock__.a});var __WEBPACK_IMPORTED_MODULE_14__source__=__webpack_require__(478);__webpack_require__.d(__webpack_exports__,"source",function(){return __WEBPACK_IMPORTED_MODULE_14__source__.a});var __WEBPACK_IMPORTED_MODULE_15__safeHtml__=__webpack_require__(479);__webpack_require__.d(__webpack_exports__,"safeHtml",function(){return __WEBPACK_IMPORTED_MODULE_15__safeHtml__.a});var __WEBPACK_IMPORTED_MODULE_16__oneLine__=__webpack_require__(481);__webpack_require__.d(__webpack_exports__,"oneLine",function(){return __WEBPACK_IMPORTED_MODULE_16__oneLine__.a});var __WEBPACK_IMPORTED_MODULE_17__oneLineTrim__=__webpack_require__(483);__webpack_require__.d(__webpack_exports__,"oneLineTrim",function(){return __WEBPACK_IMPORTED_MODULE_17__oneLineTrim__.a});var __WEBPACK_IMPORTED_MODULE_18__oneLineCommaLists__=__webpack_require__(485);__webpack_require__.d(__webpack_exports__,"oneLineCommaLists",function(){return __WEBPACK_IMPORTED_MODULE_18__oneLineCommaLists__.a});var __WEBPACK_IMPORTED_MODULE_19__oneLineCommaListsOr__=__webpack_require__(487);__webpack_require__.d(__webpack_exports__,"oneLineCommaListsOr",function(){return __WEBPACK_IMPORTED_MODULE_19__oneLineCommaListsOr__.a});var __WEBPACK_IMPORTED_MODULE_20__oneLineCommaListsAnd__=__webpack_require__(489);__webpack_require__.d(__webpack_exports__,"oneLineCommaListsAnd",function(){return __WEBPACK_IMPORTED_MODULE_20__oneLineCommaListsAnd__.a});var __WEBPACK_IMPORTED_MODULE_21__inlineLists__=__webpack_require__(491);__webpack_require__.d(__webpack_exports__,"inlineLists",function(){return __WEBPACK_IMPORTED_MODULE_21__inlineLists__.a});var __WEBPACK_IMPORTED_MODULE_22__oneLineInlineLists__=__webpack_require__(493);__webpack_require__.d(__webpack_exports__,"oneLineInlineLists",function(){return __WEBPACK_IMPORTED_MODULE_22__oneLineInlineLists__.a});var __WEBPACK_IMPORTED_MODULE_23__stripIndent__=__webpack_require__(495);__webpack_require__.d(__webpack_exports__,"stripIndent",function(){return __WEBPACK_IMPORTED_MODULE_23__stripIndent__.a});var __WEBPACK_IMPORTED_MODULE_24__stripIndents__=__webpack_require__(497);__webpack_require__.d(__webpack_exports__,"stripIndents",function(){return __WEBPACK_IMPORTED_MODULE_24__stripIndents__.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_taggedTemplateLiteral__=__webpack_require__(357),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_taggedTemplateLiteral___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_taggedTemplateLiteral__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck__=__webpack_require__(3),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_createClass__=__webpack_require__(4),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_createClass___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_createClass__),_templateObject=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_taggedTemplateLiteral___default()(["",""],["",""]),TemplateTag=function(){function TemplateTag(){for(var _this=this,_len=arguments.length,transformers=Array(_len),_key=0;_key<_len;_key++)transformers[_key]=arguments[_key];return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck___default()(this,TemplateTag),this.tag=function(strings){for(var _len2=arguments.length,expressions=Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++)expressions[_key2-1]=arguments[_key2];return"function"==typeof strings?_this.interimTag.bind(_this,strings):"string"==typeof strings?_this.transformEndResult(strings):(strings=strings.map(_this.transformString.bind(_this)),_this.transformEndResult(strings.reduce(_this.processSubstitutions.bind(_this,expressions))))},transformers.length>0&&Array.isArray(transformers[0])&&(transformers=transformers[0]),this.transformers=transformers.map(function(transformer){return"function"==typeof transformer?transformer():transformer}),this.tag}return __WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_createClass___default()(TemplateTag,[{key:"interimTag",value:function interimTag(previousTag,template){for(var _len3=arguments.length,substitutions=Array(_len3>2?_len3-2:0),_key3=2;_key3<_len3;_key3++)substitutions[_key3-2]=arguments[_key3];return this.tag(_templateObject,previousTag.apply(void 0,[template].concat(substitutions)))}},{key:"processSubstitutions",value:function processSubstitutions(substitutions,resultSoFar,remainingPart){return resultSoFar+this.transformSubstitution(substitutions.shift(),resultSoFar)+remainingPart}},{key:"transformString",value:function transformString(str){return this.transformers.reduce(function cb(res,transform){return transform.onString?transform.onString(res):res},str)}},{key:"transformSubstitution",value:function transformSubstitution(substitution,resultSoFar){return this.transformers.reduce(function cb(res,transform){return transform.onSubstitution?transform.onSubstitution(res,resultSoFar):res},substitution)}},{key:"transformEndResult",value:function transformEndResult(endResult){return this.transformers.reduce(function cb(res,transform){return transform.onEndResult?transform.onEndResult(res):res},endResult)}}]),TemplateTag}();__webpack_exports__.a=TemplateTag},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a=function trimResultTransformer(){var side=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{onEndResult:function onEndResult(endResult){if(""===side)return endResult.trim();if("start"===(side=side.toLowerCase())||"left"===side)return endResult.replace(/^\s*/,"");if("end"===side||"right"===side)return endResult.replace(/\s*$/,"");throw new Error("Side not supported: "+side)}}}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray__=__webpack_require__(53),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray__);__webpack_exports__.a=function stripIndentTransformer(){var type=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"initial";return{onEndResult:function onEndResult(endResult){if("initial"===type){var match=endResult.match(/^[^\S\n]*(?=\S)/gm),indent=match&&Math.min.apply(Math,__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray___default()(match.map(function(el){return el.length})));if(indent){var regexp=new RegExp("^.{"+indent+"}","gm");return endResult.replace(regexp,"")}return endResult}if("all"===type)return endResult.replace(/^[^\S\n]+/gm,"");throw new Error("Unknown type: "+type)}}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a=function replaceResultTransformer(replaceWhat,replaceWith){return{onEndResult:function onEndResult(endResult){if(null==replaceWhat||null==replaceWith)throw new Error("replaceResultTransformer requires at least 2 arguments.");return endResult.replace(replaceWhat,replaceWith)}}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a=function replaceSubstitutionTransformer(replaceWhat,replaceWith){return{onSubstitution:function onSubstitution(substitution,resultSoFar){if(null==replaceWhat||null==replaceWith)throw new Error("replaceSubstitutionTransformer requires at least 2 arguments.");return null==substitution?substitution:substitution.toString().replace(replaceWhat,replaceWith)}}}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__replaceStringTransformer__=__webpack_require__(464);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__replaceStringTransformer__.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a=function replaceStringTransformer(replaceWhat,replaceWith){return{onString:function onString(str){if(null==replaceWhat||null==replaceWith)throw new Error("replaceStringTransformer requires at least 2 arguments.");return str.replace(replaceWhat,replaceWith)}}}},function(module,__webpack_exports__,__webpack_require__){"use strict";var defaults={separator:"",conjunction:"",serial:!1};__webpack_exports__.a=function inlineArrayTransformer(){var opts=arguments.length>0&&void 0!==arguments[0]?arguments[0]:defaults;return{onSubstitution:function onSubstitution(substitution,resultSoFar){if(Array.isArray(substitution)){var arrayLength=substitution.length,separator=opts.separator,conjunction=opts.conjunction,serial=opts.serial,indent=resultSoFar.match(/(\n?[^\S\n]+)$/);if(substitution=indent?substitution.join(separator+indent[1]):substitution.join(separator+" "),conjunction&&arrayLength>1){var separatorIndex=substitution.lastIndexOf(separator);substitution=substitution.slice(0,separatorIndex)+(serial?separator:"")+" "+conjunction+substitution.slice(separatorIndex+1)}}return substitution}}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a=function splitStringTransformer(splitBy){return{onSubstitution:function onSubstitution(substitution,resultSoFar){if(null==splitBy||"string"!=typeof splitBy)throw new Error("You need to specify a string character to split by.");return"string"==typeof substitution&&substitution.includes(splitBy)&&(substitution=substitution.split(splitBy)),substitution}}}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_number_is_nan__=__webpack_require__(360),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_number_is_nan___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_number_is_nan__),isValidValue=function isValidValue(x){return null!=x&&!__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_number_is_nan___default()(x)&&"boolean"!=typeof x};__webpack_exports__.a=function removeNonPrintingValuesTransformer(){return{onSubstitution:function onSubstitution(substitution){return Array.isArray(substitution)?substitution.filter(isValidValue):isValidValue(substitution)?substitution:""}}}},function(module,exports,__webpack_require__){__webpack_require__(469),module.exports=__webpack_require__(1).Number.isNaN},function(module,exports,__webpack_require__){var $export=__webpack_require__(5);$export($export.S,"Number",{isNaN:function isNaN(number){return number!=number}})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__commaLists__=__webpack_require__(471);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__commaLists__.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__TemplateTag__=__webpack_require__(26),__WEBPACK_IMPORTED_MODULE_1__stripIndentTransformer__=__webpack_require__(67),__WEBPACK_IMPORTED_MODULE_2__inlineArrayTransformer__=__webpack_require__(49),__WEBPACK_IMPORTED_MODULE_3__trimResultTransformer__=__webpack_require__(27),commaLists=new __WEBPACK_IMPORTED_MODULE_0__TemplateTag__.a(Object(__WEBPACK_IMPORTED_MODULE_2__inlineArrayTransformer__.a)({separator:","}),__WEBPACK_IMPORTED_MODULE_1__stripIndentTransformer__.a,__WEBPACK_IMPORTED_MODULE_3__trimResultTransformer__.a);__webpack_exports__.a=commaLists},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__commaListsAnd__=__webpack_require__(473);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__commaListsAnd__.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__TemplateTag__=__webpack_require__(26),__WEBPACK_IMPORTED_MODULE_1__stripIndentTransformer__=__webpack_require__(67),__WEBPACK_IMPORTED_MODULE_2__inlineArrayTransformer__=__webpack_require__(49),__WEBPACK_IMPORTED_MODULE_3__trimResultTransformer__=__webpack_require__(27),commaListsAnd=new __WEBPACK_IMPORTED_MODULE_0__TemplateTag__.a(Object(__WEBPACK_IMPORTED_MODULE_2__inlineArrayTransformer__.a)({separator:",",conjunction:"and"}),__WEBPACK_IMPORTED_MODULE_1__stripIndentTransformer__.a,__WEBPACK_IMPORTED_MODULE_3__trimResultTransformer__.a);__webpack_exports__.a=commaListsAnd},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__commaListsOr__=__webpack_require__(475);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__commaListsOr__.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__TemplateTag__=__webpack_require__(26),__WEBPACK_IMPORTED_MODULE_1__stripIndentTransformer__=__webpack_require__(67),__WEBPACK_IMPORTED_MODULE_2__inlineArrayTransformer__=__webpack_require__(49),__WEBPACK_IMPORTED_MODULE_3__trimResultTransformer__=__webpack_require__(27),commaListsOr=new __WEBPACK_IMPORTED_MODULE_0__TemplateTag__.a(Object(__WEBPACK_IMPORTED_MODULE_2__inlineArrayTransformer__.a)({separator:",",conjunction:"or"}),__WEBPACK_IMPORTED_MODULE_1__stripIndentTransformer__.a,__WEBPACK_IMPORTED_MODULE_3__trimResultTransformer__.a);__webpack_exports__.a=commaListsOr},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__TemplateTag__=__webpack_require__(26),__WEBPACK_IMPORTED_MODULE_1__stripIndentTransformer__=__webpack_require__(67),__WEBPACK_IMPORTED_MODULE_2__inlineArrayTransformer__=__webpack_require__(49),__WEBPACK_IMPORTED_MODULE_3__trimResultTransformer__=__webpack_require__(27),__WEBPACK_IMPORTED_MODULE_4__splitStringTransformer__=__webpack_require__(294),__WEBPACK_IMPORTED_MODULE_5__removeNonPrintingValuesTransformer__=__webpack_require__(359),html=new __WEBPACK_IMPORTED_MODULE_0__TemplateTag__.a(Object(__WEBPACK_IMPORTED_MODULE_4__splitStringTransformer__.a)("\n"),__WEBPACK_IMPORTED_MODULE_5__removeNonPrintingValuesTransformer__.a,__WEBPACK_IMPORTED_MODULE_2__inlineArrayTransformer__.a,__WEBPACK_IMPORTED_MODULE_1__stripIndentTransformer__.a,__WEBPACK_IMPORTED_MODULE_3__trimResultTransformer__.a);__webpack_exports__.a=html},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__html__=__webpack_require__(295);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__html__.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__html__=__webpack_require__(295);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__html__.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__safeHtml__=__webpack_require__(480);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__safeHtml__.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__TemplateTag__=__webpack_require__(26),__WEBPACK_IMPORTED_MODULE_1__stripIndentTransformer__=__webpack_require__(67),__WEBPACK_IMPORTED_MODULE_2__inlineArrayTransformer__=__webpack_require__(49),__WEBPACK_IMPORTED_MODULE_3__trimResultTransformer__=__webpack_require__(27),__WEBPACK_IMPORTED_MODULE_4__splitStringTransformer__=__webpack_require__(294),__WEBPACK_IMPORTED_MODULE_5__replaceSubstitutionTransformer__=__webpack_require__(358),safeHtml=new __WEBPACK_IMPORTED_MODULE_0__TemplateTag__.a(Object(__WEBPACK_IMPORTED_MODULE_4__splitStringTransformer__.a)("\n"),__WEBPACK_IMPORTED_MODULE_2__inlineArrayTransformer__.a,__WEBPACK_IMPORTED_MODULE_1__stripIndentTransformer__.a,__WEBPACK_IMPORTED_MODULE_3__trimResultTransformer__.a,Object(__WEBPACK_IMPORTED_MODULE_5__replaceSubstitutionTransformer__.a)(/&/g,"&amp;"),Object(__WEBPACK_IMPORTED_MODULE_5__replaceSubstitutionTransformer__.a)(/</g,"&lt;"),Object(__WEBPACK_IMPORTED_MODULE_5__replaceSubstitutionTransformer__.a)(/>/g,"&gt;"),Object(__WEBPACK_IMPORTED_MODULE_5__replaceSubstitutionTransformer__.a)(/"/g,"&quot;"),Object(__WEBPACK_IMPORTED_MODULE_5__replaceSubstitutionTransformer__.a)(/'/g,"&#x27;"),Object(__WEBPACK_IMPORTED_MODULE_5__replaceSubstitutionTransformer__.a)(/`/g,"&#x60;"));__webpack_exports__.a=safeHtml},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__oneLine__=__webpack_require__(482);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__oneLine__.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__TemplateTag__=__webpack_require__(26),__WEBPACK_IMPORTED_MODULE_1__trimResultTransformer__=__webpack_require__(27),__WEBPACK_IMPORTED_MODULE_2__replaceResultTransformer__=__webpack_require__(103),oneLine=new __WEBPACK_IMPORTED_MODULE_0__TemplateTag__.a(Object(__WEBPACK_IMPORTED_MODULE_2__replaceResultTransformer__.a)(/(?:\n(?:\s*))+/g," "),__WEBPACK_IMPORTED_MODULE_1__trimResultTransformer__.a);__webpack_exports__.a=oneLine},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__oneLineTrim__=__webpack_require__(484);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__oneLineTrim__.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__TemplateTag__=__webpack_require__(26),__WEBPACK_IMPORTED_MODULE_1__trimResultTransformer__=__webpack_require__(27),__WEBPACK_IMPORTED_MODULE_2__replaceResultTransformer__=__webpack_require__(103),oneLineTrim=new __WEBPACK_IMPORTED_MODULE_0__TemplateTag__.a(Object(__WEBPACK_IMPORTED_MODULE_2__replaceResultTransformer__.a)(/(?:\n\s*)/g,""),__WEBPACK_IMPORTED_MODULE_1__trimResultTransformer__.a);__webpack_exports__.a=oneLineTrim},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__oneLineCommaLists__=__webpack_require__(486);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__oneLineCommaLists__.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__TemplateTag__=__webpack_require__(26),__WEBPACK_IMPORTED_MODULE_1__inlineArrayTransformer__=__webpack_require__(49),__WEBPACK_IMPORTED_MODULE_2__trimResultTransformer__=__webpack_require__(27),__WEBPACK_IMPORTED_MODULE_3__replaceResultTransformer__=__webpack_require__(103),oneLineCommaLists=new __WEBPACK_IMPORTED_MODULE_0__TemplateTag__.a(Object(__WEBPACK_IMPORTED_MODULE_1__inlineArrayTransformer__.a)({separator:","}),Object(__WEBPACK_IMPORTED_MODULE_3__replaceResultTransformer__.a)(/(?:\s+)/g," "),__WEBPACK_IMPORTED_MODULE_2__trimResultTransformer__.a);__webpack_exports__.a=oneLineCommaLists},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__oneLineCommaListsOr__=__webpack_require__(488);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__oneLineCommaListsOr__.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__TemplateTag__=__webpack_require__(26),__WEBPACK_IMPORTED_MODULE_1__inlineArrayTransformer__=__webpack_require__(49),__WEBPACK_IMPORTED_MODULE_2__trimResultTransformer__=__webpack_require__(27),__WEBPACK_IMPORTED_MODULE_3__replaceResultTransformer__=__webpack_require__(103),oneLineCommaListsOr=new __WEBPACK_IMPORTED_MODULE_0__TemplateTag__.a(Object(__WEBPACK_IMPORTED_MODULE_1__inlineArrayTransformer__.a)({separator:",",conjunction:"or"}),Object(__WEBPACK_IMPORTED_MODULE_3__replaceResultTransformer__.a)(/(?:\s+)/g," "),__WEBPACK_IMPORTED_MODULE_2__trimResultTransformer__.a);__webpack_exports__.a=oneLineCommaListsOr},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__oneLineCommaListsAnd__=__webpack_require__(490);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__oneLineCommaListsAnd__.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__TemplateTag__=__webpack_require__(26),__WEBPACK_IMPORTED_MODULE_1__inlineArrayTransformer__=__webpack_require__(49),__WEBPACK_IMPORTED_MODULE_2__trimResultTransformer__=__webpack_require__(27),__WEBPACK_IMPORTED_MODULE_3__replaceResultTransformer__=__webpack_require__(103),oneLineCommaListsAnd=new __WEBPACK_IMPORTED_MODULE_0__TemplateTag__.a(Object(__WEBPACK_IMPORTED_MODULE_1__inlineArrayTransformer__.a)({separator:",",conjunction:"and"}),Object(__WEBPACK_IMPORTED_MODULE_3__replaceResultTransformer__.a)(/(?:\s+)/g," "),__WEBPACK_IMPORTED_MODULE_2__trimResultTransformer__.a);__webpack_exports__.a=oneLineCommaListsAnd},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__inlineLists__=__webpack_require__(492);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__inlineLists__.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__TemplateTag__=__webpack_require__(26),__WEBPACK_IMPORTED_MODULE_1__stripIndentTransformer__=__webpack_require__(67),__WEBPACK_IMPORTED_MODULE_2__inlineArrayTransformer__=__webpack_require__(49),__WEBPACK_IMPORTED_MODULE_3__trimResultTransformer__=__webpack_require__(27),inlineLists=new __WEBPACK_IMPORTED_MODULE_0__TemplateTag__.a(__WEBPACK_IMPORTED_MODULE_2__inlineArrayTransformer__.a,__WEBPACK_IMPORTED_MODULE_1__stripIndentTransformer__.a,__WEBPACK_IMPORTED_MODULE_3__trimResultTransformer__.a);__webpack_exports__.a=inlineLists},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__oneLineInlineLists__=__webpack_require__(494);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__oneLineInlineLists__.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__TemplateTag__=__webpack_require__(26),__WEBPACK_IMPORTED_MODULE_1__inlineArrayTransformer__=__webpack_require__(49),__WEBPACK_IMPORTED_MODULE_2__trimResultTransformer__=__webpack_require__(27),__WEBPACK_IMPORTED_MODULE_3__replaceResultTransformer__=__webpack_require__(103),oneLineInlineLists=new __WEBPACK_IMPORTED_MODULE_0__TemplateTag__.a(__WEBPACK_IMPORTED_MODULE_1__inlineArrayTransformer__.a,Object(__WEBPACK_IMPORTED_MODULE_3__replaceResultTransformer__.a)(/(?:\s+)/g," "),__WEBPACK_IMPORTED_MODULE_2__trimResultTransformer__.a);__webpack_exports__.a=oneLineInlineLists},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__stripIndent__=__webpack_require__(496);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__stripIndent__.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__TemplateTag__=__webpack_require__(26),__WEBPACK_IMPORTED_MODULE_1__stripIndentTransformer__=__webpack_require__(67),__WEBPACK_IMPORTED_MODULE_2__trimResultTransformer__=__webpack_require__(27),stripIndent=new __WEBPACK_IMPORTED_MODULE_0__TemplateTag__.a(__WEBPACK_IMPORTED_MODULE_1__stripIndentTransformer__.a,__WEBPACK_IMPORTED_MODULE_2__trimResultTransformer__.a);__webpack_exports__.a=stripIndent},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__stripIndents__=__webpack_require__(498);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__stripIndents__.a})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__TemplateTag__=__webpack_require__(26),__WEBPACK_IMPORTED_MODULE_1__stripIndentTransformer__=__webpack_require__(67),__WEBPACK_IMPORTED_MODULE_2__trimResultTransformer__=__webpack_require__(27),stripIndents=new __WEBPACK_IMPORTED_MODULE_0__TemplateTag__.a(Object(__WEBPACK_IMPORTED_MODULE_1__stripIndentTransformer__.a)("all"),__WEBPACK_IMPORTED_MODULE_2__trimResultTransformer__.a);__webpack_exports__.a=stripIndents},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isPriorToFiber=exports.isValidFiberElement=void 0;var _slicedToArray3=_interopRequireDefault(__webpack_require__(169)),_react2=_interopRequireDefault(__webpack_require__(0)),_lodash2=_interopRequireDefault(__webpack_require__(500));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var isValidFiberElement=exports.isValidFiberElement=function isValidFiberElement(element){return"string"==typeof element||"number"==typeof element||_react2.default.isValidElement(element)},isPriorToFiber=exports.isPriorToFiber=function isPriorToFiber(version){var _version$split=version.split("."),majorVersion=(0,_slicedToArray3.default)(_version$split,1)[0];return Number(majorVersion)<16};exports.default=function isReactRenderable(element){if(isPriorToFiber(_react2.default.version))return _react2.default.isValidElement(element);if(!Array.isArray(element))return isValidFiberElement(element);var elementsList=element.map(isReactRenderable);return!(0,_lodash2.default)(elementsList).filter(function(elementIsRenderable){return!1===elementIsRenderable}).length}},function(module,exports,__webpack_require__){(function(global){var INFINITY=1/0,MAX_SAFE_INTEGER=9007199254740991,argsTag="[object Arguments]",funcTag="[object Function]",genTag="[object GeneratorFunction]",freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")();function arrayPush(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array}var objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,objectToString=objectProto.toString,Symbol=root.Symbol,propertyIsEnumerable=objectProto.propertyIsEnumerable,spreadableSymbol=Symbol?Symbol.isConcatSpreadable:void 0;function isFlattenable(value){return isArray(value)||function isArguments(value){return function isArrayLikeObject(value){return function isObjectLike(value){return!!value&&"object"==typeof value}(value)&&function isArrayLike(value){return null!=value&&function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=MAX_SAFE_INTEGER}(value.length)&&!function isFunction(value){var tag=function isObject(value){var type=typeof value;return!!value&&("object"==type||"function"==type)}(value)?objectToString.call(value):"";return tag==funcTag||tag==genTag}(value)}(value)}(value)&&hasOwnProperty.call(value,"callee")&&(!propertyIsEnumerable.call(value,"callee")||objectToString.call(value)==argsTag)}(value)||!!(spreadableSymbol&&value&&value[spreadableSymbol])}var isArray=Array.isArray;module.exports=function flattenDeep(array){return array&&array.length?function baseFlatten(array,depth,predicate,isStrict,result){var index=-1,length=array.length;for(predicate||(predicate=isFlattenable),result||(result=[]);++index<length;){var value=array[index];depth>0&&predicate(value)?depth>1?baseFlatten(value,depth-1,predicate,isStrict,result):arrayPush(result,value):isStrict||(result[result.length]=value)}return result}(array,INFINITY):[]}}).call(exports,__webpack_require__(17))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _propTypes2=_interopRequireDefault(__webpack_require__(2)),_react2=_interopRequireDefault(__webpack_require__(0));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var mainStyle={position:"fixed",top:0,bottom:0,left:0,right:0,padding:20,backgroundColor:"rgb(187, 49, 49)",color:"#FFF",WebkitFontSmoothing:"antialiased"},headingStyle={fontSize:20,fontWeight:600,letterSpacing:.2,margin:"10px 0",fontFamily:'\n    -apple-system, ".SFNSText-Regular", "San Francisco", Roboto, "Segoe UI",\n    "Helvetica Neue", "Lucida Grande", sans-serif\n    '},codeStyle={fontSize:14,width:"100vw",overflow:"auto"},ErrorDisplay=function ErrorDisplay(_ref){var error=_ref.error;return _react2.default.createElement("div",{style:mainStyle},_react2.default.createElement("div",{style:headingStyle},error.message),_react2.default.createElement("pre",{style:codeStyle},_react2.default.createElement("code",null,error.stack)))};ErrorDisplay.propTypes={error:_propTypes2.default.shape({message:_propTypes2.default.string,stack:_propTypes2.default.string}).isRequired},exports.default=ErrorDisplay},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _extends3=_interopRequireDefault(__webpack_require__(8));exports.default=function(context){var queryParams=context.queryParams,reduxStore=context.reduxStore,window=context.window,channel=context.channel;queryParams.selectedKind&&reduxStore.dispatch((0,_actions.selectStory)(queryParams.selectedKind,queryParams.selectedStory));var originalQueryParams=queryParams;reduxStore.subscribe(function(){var _reduxStore$getState=reduxStore.getState(),selectedKind=_reduxStore$getState.selectedKind,selectedStory=_reduxStore$getState.selectedStory,queryString=_qs2.default.stringify((0,_extends3.default)({},originalQueryParams,{selectedKind:selectedKind,selectedStory:selectedStory}));window.history.replaceState({},"","?"+queryString)}),window.onkeydown=function(e){var parsedEvent=(0,_key_events2.default)(e);parsedEvent&&channel.emit("applyShortcut",{event:parsedEvent})}};var _key_events2=_interopRequireDefault(__webpack_require__(172)),_qs2=_interopRequireDefault(__webpack_require__(149)),_actions=__webpack_require__(168);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray3=_interopRequireDefault(__webpack_require__(169)),_extends3=_interopRequireDefault(__webpack_require__(8));exports.default=function reducer(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},action=arguments[1];switch(action.type){case _actions.types.CLEAR_ERROR:return(0,_extends3.default)({},state,{error:null});case _actions.types.SET_ERROR:return(0,_extends3.default)({},state,{error:action.error});case _actions.types.SELECT_STORY:return(0,_extends3.default)({},state,{selectedKind:action.kind,selectedStory:action.story});case _actions.types.SET_INITIAL_STORY:var newState=(0,_extends3.default)({},state),storyKindList=action.storyKindList;if(!newState.selectedKind&&storyKindList.length>0){newState.selectedKind=storyKindList[0].kind;var _storyKindList$0$stor=(0,_slicedToArray3.default)(storyKindList[0].stories,1);newState.selectedStory=_storyKindList$0$stor[0]}return newState;default:return state}};var _actions=__webpack_require__(168);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _toConsumableArray3=_interopRequireDefault(__webpack_require__(53));exports.action=action,exports.decorateAction=function decorateAction(decorators){return function(name){var callAction=action(name);return function(){for(var _len2=arguments.length,_args=Array(_len2),_key2=0;_key2<_len2;_key2++)_args[_key2]=arguments[_key2];var decorated=decorators.reduce(function(args,fn){return fn(args)},_args);callAction.apply(void 0,(0,_toConsumableArray3.default)(decorated))}}};var _addons2=_interopRequireDefault(__webpack_require__(51)),_v2=_interopRequireDefault(__webpack_require__(505)),_=__webpack_require__(362),_util=__webpack_require__(173);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function action(name){var handler=function action(){for(var _len=arguments.length,_args=Array(_len),_key=0;_key<_len;_key++)_args[_key]=arguments[_key];var args=_args.map(_util.prepareArguments),channel=_addons2.default.getChannel(),id=(0,_v2.default)();channel.emit(_.EVENT_ID,{id:id,data:{name:name,args:args}})};return _util.canConfigureName&&name&&"string"==typeof name&&Object.defineProperty(handler,"name",{value:name}),handler}},function(module,exports,__webpack_require__){var _nodeId,_clockseq,rng=__webpack_require__(506),bytesToUuid=__webpack_require__(507),_lastMSecs=0,_lastNSecs=0;module.exports=function v1(options,buf,offset){var i=buf&&offset||0,b=buf||[],node=(options=options||{}).node||_nodeId,clockseq=void 0!==options.clockseq?options.clockseq:_clockseq;if(null==node||null==clockseq){var seedBytes=rng();null==node&&(node=_nodeId=[1|seedBytes[0],seedBytes[1],seedBytes[2],seedBytes[3],seedBytes[4],seedBytes[5]]),null==clockseq&&(clockseq=_clockseq=16383&(seedBytes[6]<<8|seedBytes[7]))}var msecs=void 0!==options.msecs?options.msecs:(new Date).getTime(),nsecs=void 0!==options.nsecs?options.nsecs:_lastNSecs+1,dt=msecs-_lastMSecs+(nsecs-_lastNSecs)/1e4;if(dt<0&&void 0===options.clockseq&&(clockseq=clockseq+1&16383),(dt<0||msecs>_lastMSecs)&&void 0===options.nsecs&&(nsecs=0),nsecs>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=msecs,_lastNSecs=nsecs,_clockseq=clockseq;var tl=(1e4*(268435455&(msecs+=122192928e5))+nsecs)%4294967296;b[i++]=tl>>>24&255,b[i++]=tl>>>16&255,b[i++]=tl>>>8&255,b[i++]=255&tl;var tmh=msecs/4294967296*1e4&268435455;b[i++]=tmh>>>8&255,b[i++]=255&tmh,b[i++]=tmh>>>24&15|16,b[i++]=tmh>>>16&255,b[i++]=clockseq>>>8|128,b[i++]=255&clockseq;for(var n=0;n<6;++n)b[i+n]=node[n];return buf||bytesToUuid(b)}},function(module,exports){var getRandomValues="undefined"!=typeof crypto&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&msCrypto.getRandomValues.bind(msCrypto);if(getRandomValues){var rnds8=new Uint8Array(16);module.exports=function whatwgRNG(){return getRandomValues(rnds8),rnds8}}else{var rnds=new Array(16);module.exports=function mathRNG(){for(var r,i=0;i<16;i++)0==(3&i)&&(r=4294967296*Math.random()),rnds[i]=r>>>((3&i)<<3)&255;return rnds}}},function(module,exports){for(var byteToHex=[],i=0;i<256;++i)byteToHex[i]=(i+256).toString(16).substr(1);module.exports=function bytesToUuid(buf,offset){var i=offset||0,bth=byteToHex;return bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+"-"+bth[buf[i++]]+bth[buf[i++]]+"-"+bth[buf[i++]]+bth[buf[i++]]+"-"+bth[buf[i++]]+bth[buf[i++]]+"-"+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]}},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(509),__esModule:!0}},function(module,exports,__webpack_require__){__webpack_require__(510);var $Object=__webpack_require__(1).Object;module.exports=function getOwnPropertyDescriptor(it,key){return $Object.getOwnPropertyDescriptor(it,key)}},function(module,exports,__webpack_require__){var toIObject=__webpack_require__(28),$getOwnPropertyDescriptor=__webpack_require__(113).f;__webpack_require__(96)("getOwnPropertyDescriptor",function(){return function getOwnPropertyDescriptor(it,key){return $getOwnPropertyDescriptor(toIObject(it),key)}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function getPropertiesList(value){var keys=[];for(var name in value)try{(hasOwnProperty.call(value,name)||"function"!=typeof value[name])&&keys.push(name)}catch(error){console.error("Error accessing property "+name,error)}return keys};var hasOwnProperty=Object.prototype.hasOwnProperty},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function isObject(value){return"[object Object]"===toString.call(value)};var toString=Object.prototype.toString},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _defineProperty2=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(109));exports.default=function muteProperty(key,value){return(0,_defineProperty2.default)(value,key,{enumerable:!1})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _stringify2=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(174));exports.default=function prepareArguments(arg){if(arg&&void 0!==arg.preventDefault)return(0,_stringify2.default)("["+arg.constructor.name+"]");try{return(0,_stringify2.default)((0,_index.decycle)(arg))}catch(error){return error.toString()}};var _index=__webpack_require__(305)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _stringify2=_interopRequireDefault(__webpack_require__(174)),_typeof3=_interopRequireDefault(__webpack_require__(75)),_weakMap2=_interopRequireDefault(__webpack_require__(516));exports.default=function decycle(object){var depth=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,objects=new _weakMap2.default,isCyclic=!1;return function derez(value,path,_depth){var oldPath=void 0,obj=void 0;if(Object(value)===value&&_depth>depth){var name=value.constructor?value.constructor.name:void 0===value?"undefined":(0,_typeof3.default)(value);return"["+name+"...]"}var result=(0,_util.typeReplacer)(value);if(result)return result.value;var type=void 0===value?"undefined":(0,_typeof3.default)(value);if(value instanceof Boolean||value instanceof Number||value instanceof String)return value;if("object"===type&&null!==value){if(void 0!==(oldPath=objects.get(value)))return isCyclic=!0,{$ref:oldPath};try{objects.set(value,path)}catch(error){return console.error(error),new _errors.DecycleError(error.message)}if(Array.isArray(value)){obj=[];for(var i=0;i<value.length;i+=1)obj[i]=derez(value[i],path+"["+i+"]",_depth+1)}else obj=_types.objectType.serialize(value),(0,_util.getPropertiesList)(value).forEach(function(name){try{obj[name]=derez(value[name],path+"["+(0,_stringify2.default)(name)+"]",_depth+1)}catch(error){console.error(error),obj[name]=new _errors.DecycleError(error.message)}});return 0===_depth&&value instanceof Object&&isCyclic&&(obj[_.CYCLIC_KEY]=!0),obj}return value}(object,"$",0)};var _errors=__webpack_require__(522),_util=__webpack_require__(173),_=__webpack_require__(305),_types=__webpack_require__(328);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(517),__esModule:!0}},function(module,exports,__webpack_require__){__webpack_require__(97),__webpack_require__(47),__webpack_require__(518),__webpack_require__(520),__webpack_require__(521),module.exports=__webpack_require__(1).WeakMap},function(module,exports,__webpack_require__){"use strict";var InternalMap,each=__webpack_require__(154)(0),redefine=__webpack_require__(111),meta=__webpack_require__(66),assign=__webpack_require__(163),weak=__webpack_require__(519),isObject=__webpack_require__(9),fails=__webpack_require__(24),validate=__webpack_require__(155),getWeak=meta.getWeak,isExtensible=Object.isExtensible,uncaughtFrozenStore=weak.ufstore,tmp={},wrapper=function(get){return function WeakMap(){return get(this,arguments.length>0?arguments[0]:void 0)}},methods={get:function get(key){if(isObject(key)){var data=getWeak(key);return!0===data?uncaughtFrozenStore(validate(this,"WeakMap")).get(key):data?data[this._i]:void 0}},set:function set(key,value){return weak.def(validate(this,"WeakMap"),key,value)}},$WeakMap=module.exports=__webpack_require__(316)("WeakMap",wrapper,methods,weak,!0,!0);fails(function(){return 7!=(new $WeakMap).set((Object.freeze||Object)(tmp),7).get(tmp)})&&(assign((InternalMap=weak.getConstructor(wrapper,"WeakMap")).prototype,methods),meta.NEED=!0,each(["delete","has","get","set"],function(key){var proto=$WeakMap.prototype,method=proto[key];redefine(proto,key,function(a,b){if(isObject(a)&&!isExtensible(a)){this._f||(this._f=new InternalMap);var result=this._f[key](a,b);return"set"==key?this:result}return method.call(this,a,b)})}))},function(module,exports,__webpack_require__){"use strict";var redefineAll=__webpack_require__(101),getWeak=__webpack_require__(66).getWeak,anObject=__webpack_require__(14),isObject=__webpack_require__(9),anInstance=__webpack_require__(98),forOf=__webpack_require__(52),createArrayMethod=__webpack_require__(154),$has=__webpack_require__(25),validate=__webpack_require__(155),arrayFind=createArrayMethod(5),arrayFindIndex=createArrayMethod(6),id=0,uncaughtFrozenStore=function(that){return that._l||(that._l=new UncaughtFrozenStore)},UncaughtFrozenStore=function(){this.a=[]},findUncaughtFrozen=function(store,key){return arrayFind(store.a,function(it){return it[0]===key})};UncaughtFrozenStore.prototype={get:function(key){var entry=findUncaughtFrozen(this,key);if(entry)return entry[1]},has:function(key){return!!findUncaughtFrozen(this,key)},set:function(key,value){var entry=findUncaughtFrozen(this,key);entry?entry[1]=value:this.a.push([key,value])},delete:function(key){var index=arrayFindIndex(this.a,function(it){return it[0]===key});return~index&&this.a.splice(index,1),!!~index}},module.exports={getConstructor:function(wrapper,NAME,IS_MAP,ADDER){var C=wrapper(function(that,iterable){anInstance(that,C,NAME,"_i"),that._t=NAME,that._i=id++,that._l=void 0,void 0!=iterable&&forOf(iterable,IS_MAP,that[ADDER],that)});return redefineAll(C.prototype,{delete:function(key){if(!isObject(key))return!1;var data=getWeak(key);return!0===data?uncaughtFrozenStore(validate(this,NAME)).delete(key):data&&$has(data,this._i)&&delete data[this._i]},has:function has(key){if(!isObject(key))return!1;var data=getWeak(key);return!0===data?uncaughtFrozenStore(validate(this,NAME)).has(key):data&&$has(data,this._i)}}),C},def:function(that,key,value){var data=getWeak(anObject(key),!0);return!0===data?uncaughtFrozenStore(that).set(key,value):data[that._i]=value,that},ufstore:uncaughtFrozenStore}},function(module,exports,__webpack_require__){__webpack_require__(317)("WeakMap")},function(module,exports,__webpack_require__){__webpack_require__(318)("WeakMap")},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DecycleError=void 0;var _DecycleError3=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(523));exports.DecycleError=_DecycleError3.default},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _getPrototypeOf2=_interopRequireDefault(__webpack_require__(10)),_classCallCheck3=_interopRequireDefault(__webpack_require__(3)),_possibleConstructorReturn3=_interopRequireDefault(__webpack_require__(11)),_inherits3=_interopRequireDefault(__webpack_require__(12));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var DecycleError=function(_BaseError){function DecycleError(){return(0,_classCallCheck3.default)(this,DecycleError),(0,_possibleConstructorReturn3.default)(this,(DecycleError.__proto__||(0,_getPrototypeOf2.default)(DecycleError)).apply(this,arguments))}return(0,_inherits3.default)(DecycleError,_BaseError),DecycleError}(__webpack_require__(524).BaseError);exports.default=DecycleError},function(module,exports,__webpack_require__){"use strict";var construct="undefined"!=typeof Reflect?Reflect.construct:void 0,defineProperty=Object.defineProperty,captureStackTrace=Error.captureStackTrace;function BaseError(message){void 0!==message&&defineProperty(this,"message",{configurable:!0,value:message,writable:!0});var cname=this.constructor.name;void 0!==cname&&cname!==this.name&&defineProperty(this,"name",{configurable:!0,value:cname,writable:!0}),captureStackTrace(this,this.constructor)}void 0===captureStackTrace&&(captureStackTrace=function captureStackTrace(error){var container=new Error;defineProperty(error,"stack",{configurable:!0,get:function getStack(){var stack=container.stack;return defineProperty(this,"stack",{configurable:!0,value:stack,writable:!0}),stack},set:function setStack(stack){defineProperty(error,"stack",{configurable:!0,value:stack,writable:!0})}})}),BaseError.prototype=Object.create(Error.prototype,{constructor:{configurable:!0,value:BaseError,writable:!0}});var setFunctionName=function(){function setFunctionName(fn,name){return defineProperty(fn,"name",{configurable:!0,value:name})}try{var f=function(){};if(setFunctionName(f,"foo"),"foo"===f.name)return setFunctionName}catch(_){}}();(module.exports=function makeError(constructor,super_){if(null==super_||super_===Error)super_=BaseError;else if("function"!=typeof super_)throw new TypeError("super_ should be a function");var name;if("string"==typeof constructor)name=constructor,constructor=void 0!==construct?function(){return construct(super_,arguments,this.constructor)}:function(){super_.apply(this,arguments)},void 0!==setFunctionName&&(setFunctionName(constructor,name),name=void 0);else if("function"!=typeof constructor)throw new TypeError("constructor should be either a string or a function");constructor.super_=constructor.super=super_;var properties={constructor:{configurable:!0,value:constructor,writable:!0}};return void 0!==name&&(properties.name={configurable:!0,value:name,writable:!0}),constructor.prototype=Object.create(super_.prototype,properties),constructor}).BaseError=BaseError},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _defineProperty3=_interopRequireDefault(__webpack_require__(50)),_createNamedObject2=_interopRequireDefault(__webpack_require__(526)),_getObjectName2=_interopRequireDefault(__webpack_require__(530));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var KEY="$___storybook.objectName",objectType={KEY:KEY,serialize:function serialize(value){return(0,_defineProperty3.default)({},KEY,(0,_getObjectName2.default)(value))},deserialize:function deserialize(value){return(0,_createNamedObject2.default)(value,KEY)}};exports.default=objectType},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _assign2=_interopRequireDefault(__webpack_require__(72));exports.default=function createNamedObject(obj,key){var namedObj=new((0,_createFunction2.default)(obj[key]));return delete obj[key],(0,_assign2.default)(namedObj,obj),namedObj};var _createFunction2=_interopRequireDefault(__webpack_require__(329));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function createFunctionEval(name){var fnName=(0,_isReserved2.default)(name)?name+"$":name;return new Function("return function "+fnName+"() {}")()};var _isReserved2=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(528))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function isReserved(name){return _reservedKeywords2.default.indexOf(name)>=0};var _reservedKeywords2=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(529))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.default=["break","case","catch","class","continue","debugger","default","delete","do","else","export","extends","finally","for","function","if","import","in","instanceof","new","return","super","switch","this","throw","try","typeof","var","void","while","with","yield"]},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function getObjectName(value){if((0,_canAccessProperty2.default)("toString",value)){var stringValue=value.toString();if("class"===stringValue.slice(0,5))return stringValue.slice(6,-3);var type=stringValue.slice(8,-1);if("object"===stringValue.slice(1,7)&&"Object"!==type)return type;var parts=stringValue.match(/function (\w+).*/);if(parts&&2===parts.length)return parts[1]}return value.constructor?value.constructor.name:"Object"};var _canAccessProperty2=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(531))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function canAccessProperty(key,value){var prop=void 0;try{prop=value[key]}catch(error){console.error(error)}return!!prop}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _defineProperty3=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(50));var KEY="$___storybook.Date",dateType={KEY:KEY,is:function is(value){return value instanceof Date},serialize:function serialize(value){return(0,_defineProperty3.default)({},KEY,value.toISOString())},deserialize:function deserialize(value){return new Date(value[KEY])}};exports.default=dateType},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _defineProperty3=_interopRequireDefault(__webpack_require__(50)),_createBoundFunction2=_interopRequireDefault(__webpack_require__(534)),_createFunction2=_interopRequireDefault(__webpack_require__(329));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var KEY="$___storybook.functionName",functionType={KEY:KEY,is:function is(value){return"function"==typeof value},serialize:function serialize(value){return(0,_defineProperty3.default)({},KEY,value.name||"")},deserialize:function deserialize(value){var parts=value[KEY].split(" ");return 2===parts.length&&"bound"===parts[0]?(0,_createBoundFunction2.default)(parts[1]):(0,_createFunction2.default)(parts[0])}};exports.default=functionType},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function createBoundFunction(name){return(0,_createFunction2.default)(name).bind({})};var _createFunction2=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(329))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _defineProperty3=_interopRequireDefault(__webpack_require__(50)),_isFinite2=_interopRequireDefault(__webpack_require__(536));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var KEY="$___storybook.Infinity",InfinityType={KEY:KEY,is:function is(value){return"number"==typeof value&&!(0,_isFinite2.default)(value)},serialize:function serialize(value){return(0,_defineProperty3.default)({},KEY,value===1/0)},deserialize:function deserialize(value){return value[KEY]?1/0:-1/0}};exports.default=InfinityType},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(537),__esModule:!0}},function(module,exports,__webpack_require__){__webpack_require__(538),module.exports=__webpack_require__(1).Number.isFinite},function(module,exports,__webpack_require__){var $export=__webpack_require__(5),_isFinite=__webpack_require__(7).isFinite;$export($export.S,"Number",{isFinite:function isFinite(it){return"number"==typeof it&&_isFinite(it)}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _defineProperty3=_interopRequireDefault(__webpack_require__(50)),_isNan2=_interopRequireDefault(__webpack_require__(360));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var KEY="$___storybook.NaN",NaNType={KEY:KEY,is:function is(value){return"number"==typeof value&&(0,_isNan2.default)(value)},serialize:function serialize(){return(0,_defineProperty3.default)({},KEY,!0)},deserialize:function deserialize(){return NaN}};exports.default=NaNType},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _defineProperty3=_interopRequireDefault(__webpack_require__(50)),_createRegExp2=_interopRequireDefault(__webpack_require__(541));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var KEY="$___storybook.regExpKey",regExpType={KEY:KEY,is:function is(value){return value instanceof RegExp},serialize:function serialize(value){return(0,_defineProperty3.default)({},KEY,value.toString())},deserialize:function deserialize(value){return(0,_createRegExp2.default)(value[KEY])}};exports.default=regExpType},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function createRegExp(regExp){var parts=regExp.split("/");return new RegExp(parts[1],parts[2])}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _defineProperty3=_interopRequireDefault(__webpack_require__(50)),_typeof3=_interopRequireDefault(__webpack_require__(75)),_createSymbol2=_interopRequireDefault(__webpack_require__(543));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var KEY="$___storybook.symbolName",symbolType={KEY:KEY,is:function is(value){return"symbol"===(void 0===value?"undefined":(0,_typeof3.default)(value))},serialize:function serialize(value){return(0,_defineProperty3.default)({},KEY,String(value).slice(7,-1)||null)},deserialize:function deserialize(value){return(0,_createSymbol2.default)(value[KEY])}};exports.default=symbolType},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _symbol2=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(175));exports.default=function createSymbol(name){return(0,_symbol2.default)(name)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _defineProperty3=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(50));var KEY="$___storybook.undefined",undefinedType={KEY:KEY,is:function is(value){return void 0===value},serialize:function serialize(){return(0,_defineProperty3.default)({},KEY,!0)},deserialize:function deserialize(){}};exports.default=undefinedType},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _typeof2=__webpack_require__(75),_typeof3=_interopRequireDefault(_typeof2);exports.default=retrocycle;var _reviver=__webpack_require__(364),_reviver2=_interopRequireDefault(_reviver),_util=__webpack_require__(173),_=__webpack_require__(305);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var pathReg=/^\$(?:\[(?:\d+|"(?:[^\\"\u0000-\u001f]|\\([\\"/bfnrt]|u[0-9a-zA-Z]{4}))*")])*$/;function retrocycle(json){var $=JSON.parse(json,_reviver2.default);return"object"!==(void 0===$?"undefined":(0,_typeof3.default)($))||null===$?$:(function rez(value){if(value&&"object"===(void 0===value?"undefined":(0,_typeof3.default)(value)))if(Array.isArray(value))for(var i=0;i<value.length;i+=1){var item=value[i];if(item&&"object"===(void 0===item?"undefined":(0,_typeof3.default)(item))){var path=item.$ref;"string"==typeof path&&pathReg.test(path)?value[i]=eval(path):rez(item)}}else for(var name in value){var _item=value[name];if("object"===(void 0===_item?"undefined":(0,_typeof3.default)(_item))&&null!==_item){var _path=_item.$ref;"string"==typeof _path&&pathReg.test(_path)?value[name]=eval(_path):rez(_item)}}}($),(0,_util.muteProperty)(_.CYCLIC_KEY,$),$)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _types=__webpack_require__(328),hasOwnProperty=Object.prototype.hasOwnProperty,allTypes=_types.types.concat(_types.objectType);exports.default=function typeFilter(value){var found=allTypes.find(function(type){return hasOwnProperty.call(value,type.KEY)});return!!found&&{value:found.deserialize(value)}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _types=__webpack_require__(328);exports.default=function typeReplacer(value){var found=_types.types.find(function(type){return type.is(value)});return!!found&&{value:found.serialize(value)}}},function(module,exports,__webpack_require__){"use strict";(function(module){var _react2=_interopRequireDefault(__webpack_require__(0)),_react3=__webpack_require__(349),_addonNotes=__webpack_require__(549),_htmlTablify=__webpack_require__(551),_src2=_interopRequireDefault(__webpack_require__(552)),_cbioportalData2=_interopRequireDefault(__webpack_require__(560)),_dataset2=_interopRequireDefault(__webpack_require__(561)),_dataset4=_interopRequireDefault(__webpack_require__(562)),_dataset6=_interopRequireDefault(__webpack_require__(563));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var createNotes=function createNotes(data){return"<h2>Input Mutation Data</h2>"+(0,_htmlTablify.tablify)({data:data,pretty:!1,cellpadding:5})};(0,_react3.storiesOf)("OncoPrint",module).add("with a few entries",(0,_addonNotes.withNotes)(createNotes(_dataset2.default))(function(){return _react2.default.createElement(_src2.default,{data:_dataset2.default})})).add("with a few more entries (full width)",(0,_addonNotes.withNotes)(createNotes(_dataset4.default))(function(){return _react2.default.createElement(_src2.default,{data:_dataset4.default,fullWidth:!0})})).add("with two genes and lots of truncating mutations",(0,_addonNotes.withNotes)(createNotes(_dataset6.default))(function(){return _react2.default.createElement(_src2.default,{data:_dataset6.default,fullWidth:!0})})).add("with cBioPortal test data (full width)",(0,_addonNotes.withNotes)(createNotes(_cbioportalData2.default))(function(){return _react2.default.createElement(_src2.default,{data:_cbioportalData2.default,fullWidth:!0})}))}).call(exports,__webpack_require__(162)(module))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.withNotes=void 0;var _utilDeprecate2=_interopRequireDefault(__webpack_require__(361)),_addons2=_interopRequireDefault(__webpack_require__(51)),_react=__webpack_require__(550);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.withNotes=function withNotes(textOrOptions){var channel=_addons2.default.getChannel(),options="string"==typeof textOrOptions?{text:textOrOptions}:textOrOptions;return function(getStory){return function(context){return channel.emit("storybook/notes/add_notes",options.text),getStory(context)}}};Object.defineProperty(exports,"WithNotes",{configurable:!0,enumerable:!0,get:(0,_utilDeprecate2.default)(function(){return _react.WithNotes},"@storybook/addon-notes WithNotes Component is deprecated, use withNotes() instead. See https://github.com/storybooks/storybook/tree/master/addons/notes")})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WithNotes=void 0;var _getPrototypeOf2=_interopRequireDefault(__webpack_require__(10)),_classCallCheck3=_interopRequireDefault(__webpack_require__(3)),_createClass3=_interopRequireDefault(__webpack_require__(4)),_possibleConstructorReturn3=_interopRequireDefault(__webpack_require__(11)),_inherits3=_interopRequireDefault(__webpack_require__(12)),_react2=_interopRequireDefault(__webpack_require__(0)),_propTypes2=_interopRequireDefault(__webpack_require__(2)),_addons2=_interopRequireDefault(__webpack_require__(51));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var WithNotes=exports.WithNotes=function(_React$Component){function WithNotes(){return(0,_classCallCheck3.default)(this,WithNotes),(0,_possibleConstructorReturn3.default)(this,(WithNotes.__proto__||(0,_getPrototypeOf2.default)(WithNotes)).apply(this,arguments))}return(0,_inherits3.default)(WithNotes,_React$Component),(0,_createClass3.default)(WithNotes,[{key:"render",value:function render(){var _props=this.props,children=_props.children,notes=_props.notes;return _addons2.default.getChannel().emit("storybook/notes/add_notes",notes),children}}]),WithNotes}(_react2.default.Component);WithNotes.propTypes={children:_propTypes2.default.node,notes:_propTypes2.default.string},WithNotes.defaultProps={children:null,notes:""}},function(module,exports,__webpack_require__){"use strict";function isDefined(x){return void 0!==x&&null!==x}var html_tablify={tablify:function tablify(options){var tableData=(options=options||{}).data||[],header=options.header,border=isDefined(options.border)?options.border:1,cellspacing=isDefined(options.cellspacing)?options.cellspacing:0,cellpadding=isDefined(options.cellpadding)?options.cellpadding:0,tableId=options.table_id||"tablify",tableClass=options.table_class||"tablify",header_mapping=options.header_mapping||{},pretty=options.pretty;void 0===pretty&&(pretty=!0);var isSingleRow=!1;if(Array.isArray(tableData)||(isSingleRow=!0,tableData=[tableData]),!Array.isArray(header)){var headerObj={};tableData.forEach(function(json){Object.keys(json).forEach(function(key){headerObj[key]=!0})}),header=Object.keys(headerObj)}isSingleRow&&1===tableData.length&&(header=header.filter(function(h){return tableData[0][h]}));var i,j,htmlTable="",cellArray=[],cellRow=[];cellArray.push(cellRow),header.forEach(function(key){cellRow.push("<th>"+(header_mapping[key]||key)+"</th>")}),tableData.forEach(function(json){cellRow=[],cellArray.push(cellRow),header.forEach(function(key){var value=json[key];void 0===value?value="":"string"!=typeof value&&(value=JSON.stringify(value)),cellRow.push("<td>"+value+"</td>")})}),isSingleRow&&cellArray.length&&(cellArray=cellArray[0].map(function(col,i){return cellArray.map(function(row){return row[i]})}));var newLine="",indent="";if(pretty&&(newLine="\n",indent="  "),tableData.length){for(htmlTable+='<table id="'+tableId+'" class="'+tableClass+'" border="'+border+'" cellspacing="'+cellspacing+'" cellpadding="'+cellpadding+'">',i=0;i<cellArray.length;i++){for(htmlTable+=newLine,htmlTable+=indent,htmlTable+="<tr>",j=0;j<cellArray[i].length;j++)htmlTable+=newLine,htmlTable+=indent,htmlTable+=indent,htmlTable+=cellArray[i][j];htmlTable+=newLine,htmlTable+=indent,htmlTable+="</tr>"}htmlTable+=newLine,htmlTable+="</table>"}return htmlTable}};module.exports=html_tablify},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react2=_interopRequireDefault(__webpack_require__(0)),_reactPlotly2=_interopRequireDefault(__webpack_require__(553)),_utils=__webpack_require__(557);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}var OncoPrint=function(_React$PureComponent){function OncoPrint(){return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,OncoPrint),function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,(OncoPrint.__proto__||Object.getPrototypeOf(OncoPrint)).apply(this,arguments))}return function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(OncoPrint,_react2.default.PureComponent),_createClass(OncoPrint,[{key:"getData",value:function getData(){var _props=this.props,inputData=_props.data,padding=_props.padding,sampleColor=_props.sampleColor,events=(0,_utils.aggregate)(inputData),genes=(0,_utils.getSortedGenes)(inputData),samples=(0,_utils.getSortedSamples)(inputData),base=0,bBackground=[],tBackground=[],xBackground=[],yBackground=[];samples.forEach(function(s){bBackground.push.apply(bBackground,_toConsumableArray(Array(genes.length).fill(base))),tBackground.push.apply(tBackground,_toConsumableArray(Array(genes.length).fill(s))),xBackground.push.apply(xBackground,_toConsumableArray(Array(genes.length).fill(1))),yBackground.push.apply(yBackground,_toConsumableArray(genes)),base+=1});var data=[{base:bBackground.map(function(i){return i+padding}),hoverinfo:"text",marker:{color:sampleColor},name:"No alteration",text:tBackground,orientation:"h",type:"bar",x:xBackground.map(function(i){return i-2*padding}),y:yBackground}];return Object.keys(events).forEach(function(key){var aggr=events[key],width=.4;"CNA"===aggr.type?width=.8:"EXP"===aggr.type&&(width=.6);var indexes=aggr.events.map(function(e){return e.sample}).map(function(s){return samples.findIndex(function(sample){return sample===s})});data.push({base:indexes.map(function(i){return i+padding}),hoverinfo:"name",marker:{color:(0,_utils.getColor)(aggr.events[0])},name:(0,_utils.getDisplayName)(aggr.events[0]),orientation:"h",type:"bar",width:width,x:Array(aggr.events.length).fill(1).map(function(i){return i-2*padding}),y:(0,_utils.getGeneNames)(aggr.events)})}),data}},{key:"getLayout",value:function getLayout(){return{barmode:"stack",hovermode:"closest",xaxis:{showgrid:!1,showticklabels:!1,zeroline:!1},yaxis:{fixedrange:!0,showgrid:!1,zeroline:!1}}}},{key:"render",value:function render(){var otherProps={};return this.props.fullWidth&&(otherProps.style={width:"100%",height:"100%"},otherProps.useResizeHandler=!0),_react2.default.createElement(_reactPlotly2.default,_extends({data:this.getData(),layout:this.getLayout()},otherProps))}}]),OncoPrint}();OncoPrint.defaultProps={fullWidth:!1,padding:.05,sampleColor:"rgb(190, 190, 190)"},exports.default=OncoPrint},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _factory2=_interopRequireDefault(__webpack_require__(554)),_plotly2=_interopRequireDefault(__webpack_require__(556));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var PlotComponent=(0,_factory2.default)(_plotly2.default);exports.default=PlotComponent,module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();exports.default=function plotComponentFactory(Plotly){var hasReactAPIMethod=!!Plotly.react,PlotlyComponent=function(_Component){function PlotlyComponent(props){!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,PlotlyComponent);var _this=function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}(this,(PlotlyComponent.__proto__||Object.getPrototypeOf(PlotlyComponent)).call(this,props));return _this.p=Promise.resolve(),_this.fitHandler=null,_this.resizeHandler=null,_this.handlers={},_this.syncWindowResize=_this.syncWindowResize.bind(_this),_this.syncEventHandlers=_this.syncEventHandlers.bind(_this),_this.attachUpdateEvents=_this.attachUpdateEvents.bind(_this),_this.getRef=_this.getRef.bind(_this),_this.handleUpdate=_this.handleUpdate.bind(_this),_this.handleUpdateWithProps=_this.handleUpdateWithProps.bind(_this),_this}return function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}(PlotlyComponent,_Component),_createClass(PlotlyComponent,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this;this.p=this.p.then(function(){return Plotly.newPlot(_this2.el,{data:_this2.props.data,layout:_this2.resizedLayoutIfFit(_this2.props.layout),config:_this2.props.config,frames:_this2.props.frames})}).then(function(){return _this2.syncWindowResize(null,!1)}).then(this.syncEventHandlers).then(this.attachUpdateEvents).then(function(){return _this2.props.onInitialized&&_this2.props.onInitialized(_this2.el)}).catch(function(e){return console.error("Error while plotting:",e),_this2.props.onError&&_this2.props.onError()})}},{key:"componentWillUpdate",value:function componentWillUpdate(nextProps){var _this3=this;void 0!==nextProps.revision&&nextProps.revision===this.props.revision||nextProps.layout===this.props.layout&&nextProps.data===this.props.data&&nextProps.config===this.props.config&&nextProps.frames===this.props.frames||(this.p=this.p.then(function(){return hasReactAPIMethod?Plotly.react(_this3.el,{data:nextProps.data,layout:_this3.resizedLayoutIfFit(nextProps.layout),config:nextProps.config,frames:nextProps.frames}):(_this3.handlers={},Plotly.newPlot(_this3.el,{data:nextProps.data,layout:_this3.resizedLayoutIfFit(nextProps.layout),config:nextProps.config,frames:nextProps.frames}))}).then(function(){return _this3.syncEventHandlers(nextProps)}).then(function(){return _this3.syncWindowResize(nextProps)}).then(function(){hasReactAPIMethod||_this3.attachUpdateEvents()}).then(function(){return _this3.handleUpdateWithProps(nextProps)}).catch(function(err){console.error("Error while plotting:",err),_this3.props.onError&&_this3.props.onError(err)}))}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.props.onPurge&&this.props.onPurge(this.el),this.fitHandler&&isBrowser&&(window.removeEventListener("resize",this.fitHandler),this.fitHandler=null),this.resizeHandler&&isBrowser&&(window.removeEventListener("resize",this.resizeHandler),this.resizeHandler=null),this.removeUpdateEvents(),Plotly.purge(this.el)}},{key:"attachUpdateEvents",value:function attachUpdateEvents(){if(this.el&&this.el.removeListener)for(var i=0;i<updateEvents.length;i++)this.el.on(updateEvents[i],this.handleUpdate)}},{key:"removeUpdateEvents",value:function removeUpdateEvents(){if(this.el&&this.el.removeListener)for(var i=0;i<updateEvents.length;i++)this.el.removeListener(updateEvents[i],this.handleUpdate)}},{key:"handleUpdate",value:function handleUpdate(){this.handleUpdateWithProps(this.props)}},{key:"handleUpdateWithProps",value:function handleUpdateWithProps(props){props.onUpdate&&"function"==typeof props.onUpdate&&props.onUpdate(this.el)}},{key:"syncWindowResize",value:function syncWindowResize(propsIn,invoke){var _this4=this,props=propsIn||this.props;if(isBrowser){if(props.fit&&!this.fitHandler){if(this.fitHandler=function(){return Plotly.relayout(_this4.el,_this4.getSize())},window.addEventListener("resize",this.fitHandler),invoke)return this.fitHandler()}else!props.fit&&this.fitHandler&&(window.removeEventListener("resize",this.fitHandler),this.fitHandler=null);props.useResizeHandler&&!this.resizeHandler?(this.resizeHandler=function(){return Plotly.Plots.resize(_this4.el)},window.addEventListener("resize",this.resizeHandler)):!props.useResizeHandler&&this.resizeHandler&&(window.removeEventListener("resize",this.resizeHandler),this.resizeHandler=null)}}},{key:"getRef",value:function getRef(el){this.el=el,this.props.debug&&isBrowser&&(window.gd=this.el)}},{key:"syncEventHandlers",value:function syncEventHandlers(propsIn){for(var props=propsIn||this.props,i=0;i<eventNames.length;i++){var eventName=eventNames[i],prop=props["on"+eventName],hasHandler=!!this.handlers[eventName];prop&&!hasHandler?(this.handlers[eventName]=prop,this.el.on("plotly_"+eventName.toLowerCase(),this.handlers[eventName])):!prop&&hasHandler&&(this.el.removeListener("plotly_"+eventName.toLowerCase(),this.handlers[eventName]),delete this.handlers[eventName])}}},{key:"resizedLayoutIfFit",value:function resizedLayoutIfFit(layout){return this.props.fit?(0,_objectAssign2.default)({},layout,this.getSize(layout)):layout}},{key:"getSize",value:function getSize(layoutIn){var rect=void 0,layout=layoutIn||this.props.layout,layoutWidth=layout?layout.width:null,layoutHeight=layout?layout.height:null,hasWidth=(0,_fastIsnumeric2.default)(layoutWidth),hasHeight=(0,_fastIsnumeric2.default)(layoutHeight);return hasWidth&&hasHeight||(rect=this.el.parentElement.getBoundingClientRect()),{width:hasWidth?parseInt(layoutWidth):rect.width,height:hasHeight?parseInt(layoutHeight):rect.height}}},{key:"render",value:function render(){return _react2.default.createElement("div",{id:this.props.divId,style:this.props.style,ref:this.getRef,className:this.props.className})}}]),PlotlyComponent}(_react.Component);PlotlyComponent.propTypes={fit:_propTypes2.default.bool,data:_propTypes2.default.arrayOf(_propTypes2.default.object),config:_propTypes2.default.object,layout:_propTypes2.default.object,frames:_propTypes2.default.arrayOf(_propTypes2.default.object),revision:_propTypes2.default.number,onInitialized:_propTypes2.default.func,onPurge:_propTypes2.default.func,onError:_propTypes2.default.func,onUpdate:_propTypes2.default.func,debug:_propTypes2.default.bool,style:_propTypes2.default.object,className:_propTypes2.default.string,useResizeHandler:_propTypes2.default.bool,divId:_propTypes2.default.string};for(var i=0;i<eventNames.length;i++)PlotlyComponent.propTypes["on"+eventNames[i]]=_propTypes2.default.func;return PlotlyComponent.defaultProps={debug:!1,fit:!1,useResizeHandler:!1,data:[],style:{position:"relative",display:"inline-block"}},PlotlyComponent};var _react=__webpack_require__(0),_react2=_interopRequireDefault(_react),_propTypes2=_interopRequireDefault(__webpack_require__(2)),_fastIsnumeric2=_interopRequireDefault(__webpack_require__(555)),_objectAssign2=_interopRequireDefault(__webpack_require__(54));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var eventNames=["AfterExport","AfterPlot","Animated","AnimatingFrame","AnimationInterrupted","AutoSize","BeforeExport","ButtonClicked","Click","ClickAnnotation","Deselect","DoubleClick","Framework","Hover","Relayout","Restyle","Redraw","Selected","Selecting","SliderChange","SliderEnd","SliderStart","Transitioning","TransitionInterrupted","Unhover"],updateEvents=["plotly_restyle","plotly_redraw","plotly_relayout","plotly_doubleclick","plotly_animated"],isBrowser="undefined"!=typeof window;module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";module.exports=function(n){var type=typeof n;if("string"===type){var original=n;if(0===(n=+n)&&function allBlankCharCodes(str){for(var a,l=str.length,i=0;i<l;i++)if(((a=str.charCodeAt(i))<9||a>13)&&32!==a&&133!==a&&160!==a&&5760!==a&&6158!==a&&(a<8192||a>8205)&&8232!==a&&8233!==a&&8239!==a&&8287!==a&&8288!==a&&12288!==a&&65279!==a)return!1;return!0}(original))return!1}else if("number"!==type)return!1;return n-n<1}},function(module,exports,__webpack_require__){(function(global){var require,f;f=function(){var _$numerical_517={BADNUM:void 0,FP_SAFE:Number.MAX_VALUE/1e4,ONEAVGYEAR:315576e5,ONEAVGMONTH:26298e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:2440587.5,ALMOST_EQUAL:1-1e-6,MINUS_SIGN:"−"},_$d3_127={exports:{}};!function(){var d3={version:"3.5.17"},d3_arraySlice=[].slice,d3_array=function(list){return d3_arraySlice.call(list)},d3_document=this.document;function d3_documentElement(node){return node&&(node.ownerDocument||node.document||node).documentElement}function d3_window(node){return node&&(node.ownerDocument&&node.ownerDocument.defaultView||node.document&&node||node.defaultView)}if(d3_document)try{d3_array(d3_document.documentElement.childNodes)[0].nodeType}catch(e){d3_array=function(list){for(var i=list.length,array=new Array(i);i--;)array[i]=list[i];return array}}if(Date.now||(Date.now=function(){return+new Date}),d3_document)try{d3_document.createElement("DIV").style.setProperty("opacity",0,"")}catch(error){var d3_element_prototype=this.Element.prototype,d3_element_setAttribute=d3_element_prototype.setAttribute,d3_element_setAttributeNS=d3_element_prototype.setAttributeNS,d3_style_prototype=this.CSSStyleDeclaration.prototype,d3_style_setProperty=d3_style_prototype.setProperty;d3_element_prototype.setAttribute=function(name,value){d3_element_setAttribute.call(this,name,value+"")},d3_element_prototype.setAttributeNS=function(space,local,value){d3_element_setAttributeNS.call(this,space,local,value+"")},d3_style_prototype.setProperty=function(name,value,priority){d3_style_setProperty.call(this,name,value+"",priority)}}function d3_ascending(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}function d3_number(x){return null===x?NaN:+x}function d3_numeric(x){return!isNaN(x)}function d3_bisector(compare){return{left:function(a,x,lo,hi){for(arguments.length<3&&(lo=0),arguments.length<4&&(hi=a.length);lo<hi;){var mid=lo+hi>>>1;compare(a[mid],x)<0?lo=mid+1:hi=mid}return lo},right:function(a,x,lo,hi){for(arguments.length<3&&(lo=0),arguments.length<4&&(hi=a.length);lo<hi;){var mid=lo+hi>>>1;compare(a[mid],x)>0?hi=mid:lo=mid+1}return lo}}}d3.ascending=d3_ascending,d3.descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN},d3.min=function(array,f){var a,b,i=-1,n=array.length;if(1===arguments.length){for(;++i<n;)if(null!=(b=array[i])&&b>=b){a=b;break}for(;++i<n;)null!=(b=array[i])&&a>b&&(a=b)}else{for(;++i<n;)if(null!=(b=f.call(array,array[i],i))&&b>=b){a=b;break}for(;++i<n;)null!=(b=f.call(array,array[i],i))&&a>b&&(a=b)}return a},d3.max=function(array,f){var a,b,i=-1,n=array.length;if(1===arguments.length){for(;++i<n;)if(null!=(b=array[i])&&b>=b){a=b;break}for(;++i<n;)null!=(b=array[i])&&b>a&&(a=b)}else{for(;++i<n;)if(null!=(b=f.call(array,array[i],i))&&b>=b){a=b;break}for(;++i<n;)null!=(b=f.call(array,array[i],i))&&b>a&&(a=b)}return a},d3.extent=function(array,f){var a,b,c,i=-1,n=array.length;if(1===arguments.length){for(;++i<n;)if(null!=(b=array[i])&&b>=b){a=c=b;break}for(;++i<n;)null!=(b=array[i])&&(a>b&&(a=b),c<b&&(c=b))}else{for(;++i<n;)if(null!=(b=f.call(array,array[i],i))&&b>=b){a=c=b;break}for(;++i<n;)null!=(b=f.call(array,array[i],i))&&(a>b&&(a=b),c<b&&(c=b))}return[a,c]},d3.sum=function(array,f){var a,s=0,n=array.length,i=-1;if(1===arguments.length)for(;++i<n;)d3_numeric(a=+array[i])&&(s+=a);else for(;++i<n;)d3_numeric(a=+f.call(array,array[i],i))&&(s+=a);return s},d3.mean=function(array,f){var a,s=0,n=array.length,i=-1,j=n;if(1===arguments.length)for(;++i<n;)d3_numeric(a=d3_number(array[i]))?s+=a:--j;else for(;++i<n;)d3_numeric(a=d3_number(f.call(array,array[i],i)))?s+=a:--j;if(j)return s/j},d3.quantile=function(values,p){var H=(values.length-1)*p+1,h=Math.floor(H),v=+values[h-1],e=H-h;return e?v+e*(values[h]-v):v},d3.median=function(array,f){var a,numbers=[],n=array.length,i=-1;if(1===arguments.length)for(;++i<n;)d3_numeric(a=d3_number(array[i]))&&numbers.push(a);else for(;++i<n;)d3_numeric(a=d3_number(f.call(array,array[i],i)))&&numbers.push(a);if(numbers.length)return d3.quantile(numbers.sort(d3_ascending),.5)},d3.variance=function(array,f){var a,d,n=array.length,m=0,s=0,i=-1,j=0;if(1===arguments.length)for(;++i<n;)d3_numeric(a=d3_number(array[i]))&&(s+=(d=a-m)*(a-(m+=d/++j)));else for(;++i<n;)d3_numeric(a=d3_number(f.call(array,array[i],i)))&&(s+=(d=a-m)*(a-(m+=d/++j)));if(j>1)return s/(j-1)},d3.deviation=function(){var v=d3.variance.apply(this,arguments);return v?Math.sqrt(v):v};var d3_bisect=d3_bisector(d3_ascending);function d3_transposeLength(d){return d.length}d3.bisectLeft=d3_bisect.left,d3.bisect=d3.bisectRight=d3_bisect.right,d3.bisector=function(f){return d3_bisector(1===f.length?function(d,x){return d3_ascending(f(d),x)}:f)},d3.shuffle=function(array,i0,i1){(m=arguments.length)<3&&(i1=array.length,m<2&&(i0=0));for(var t,i,m=i1-i0;m;)i=Math.random()*m--|0,t=array[m+i0],array[m+i0]=array[i+i0],array[i+i0]=t;return array},d3.permute=function(array,indexes){for(var i=indexes.length,permutes=new Array(i);i--;)permutes[i]=array[indexes[i]];return permutes},d3.pairs=function(array){for(var i=0,n=array.length-1,p1=array[0],pairs=new Array(n<0?0:n);i<n;)pairs[i]=[p1,p1=array[++i]];return pairs},d3.transpose=function(matrix){if(!(n=matrix.length))return[];for(var i=-1,m=d3.min(matrix,d3_transposeLength),transpose=new Array(m);++i<m;)for(var n,j=-1,row=transpose[i]=new Array(n);++j<n;)row[j]=matrix[j][i];return transpose},d3.zip=function(){return d3.transpose(arguments)},d3.keys=function(map){var keys=[];for(var key in map)keys.push(key);return keys},d3.values=function(map){var values=[];for(var key in map)values.push(map[key]);return values},d3.entries=function(map){var entries=[];for(var key in map)entries.push({key:key,value:map[key]});return entries},d3.merge=function(arrays){for(var m,merged,array,n=arrays.length,i=-1,j=0;++i<n;)j+=arrays[i].length;for(merged=new Array(j);--n>=0;)for(m=(array=arrays[n]).length;--m>=0;)merged[--j]=array[m];return merged};var abs=Math.abs;function d3_class(ctor,properties){for(var key in properties)Object.defineProperty(ctor.prototype,key,{value:properties[key],enumerable:!1})}function d3_Map(){this._=Object.create(null)}d3.range=function(start,stop,step){if(arguments.length<3&&(step=1,arguments.length<2&&(stop=start,start=0)),(stop-start)/step==1/0)throw new Error("infinite range");var j,range=[],k=function d3_range_integerScale(x){var k=1;for(;x*k%1;)k*=10;return k}(abs(step)),i=-1;if(start*=k,stop*=k,(step*=k)<0)for(;(j=start+step*++i)>stop;)range.push(j/k);else for(;(j=start+step*++i)<stop;)range.push(j/k);return range},d3.map=function(object,f){var map=new d3_Map;if(object instanceof d3_Map)object.forEach(function(key,value){map.set(key,value)});else if(Array.isArray(object)){var o,i=-1,n=object.length;if(1===arguments.length)for(;++i<n;)map.set(i,object[i]);else for(;++i<n;)map.set(f.call(object,o=object[i],i),o)}else for(var key in object)map.set(key,object[key]);return map};var d3_map_proto="__proto__",d3_map_zero="\0";function d3_map_escape(key){return(key+="")===d3_map_proto||key[0]===d3_map_zero?d3_map_zero+key:key}function d3_map_unescape(key){return(key+="")[0]===d3_map_zero?key.slice(1):key}function d3_map_has(key){return d3_map_escape(key)in this._}function d3_map_remove(key){return(key=d3_map_escape(key))in this._&&delete this._[key]}function d3_map_keys(){var keys=[];for(var key in this._)keys.push(d3_map_unescape(key));return keys}function d3_map_size(){var size=0;for(var key in this._)++size;return size}function d3_map_empty(){for(var key in this._)return!1;return!0}function d3_Set(){this._=Object.create(null)}function d3_identity(d){return d}function d3_rebind(target,source,method){return function(){var value=method.apply(source,arguments);return value===source?target:value}}function d3_vendorSymbol(object,name){if(name in object)return name;name=name.charAt(0).toUpperCase()+name.slice(1);for(var i=0,n=d3_vendorPrefixes.length;i<n;++i){var prefixName=d3_vendorPrefixes[i]+name;if(prefixName in object)return prefixName}}d3_class(d3_Map,{has:d3_map_has,get:function(key){return this._[d3_map_escape(key)]},set:function(key,value){return this._[d3_map_escape(key)]=value},remove:d3_map_remove,keys:d3_map_keys,values:function(){var values=[];for(var key in this._)values.push(this._[key]);return values},entries:function(){var entries=[];for(var key in this._)entries.push({key:d3_map_unescape(key),value:this._[key]});return entries},size:d3_map_size,empty:d3_map_empty,forEach:function(f){for(var key in this._)f.call(this,d3_map_unescape(key),this._[key])}}),d3.nest=function(){var sortValues,rollup,nest={},keys=[],sortKeys=[];function map(mapType,array,depth){if(depth>=keys.length)return rollup?rollup.call(nest,array):sortValues?array.sort(sortValues):array;for(var keyValue,object,setter,values,i=-1,n=array.length,key=keys[depth++],valuesByKey=new d3_Map;++i<n;)(values=valuesByKey.get(keyValue=key(object=array[i])))?values.push(object):valuesByKey.set(keyValue,[object]);return mapType?(object=mapType(),setter=function(keyValue,values){object.set(keyValue,map(mapType,values,depth))}):(object={},setter=function(keyValue,values){object[keyValue]=map(mapType,values,depth)}),valuesByKey.forEach(setter),object}return nest.map=function(array,mapType){return map(mapType,array,0)},nest.entries=function(array){return function entries(map,depth){if(depth>=keys.length)return map;var array=[],sortKey=sortKeys[depth++];return map.forEach(function(key,keyMap){array.push({key:key,values:entries(keyMap,depth)})}),sortKey?array.sort(function(a,b){return sortKey(a.key,b.key)}):array}(map(d3.map,array,0),0)},nest.key=function(d){return keys.push(d),nest},nest.sortKeys=function(order){return sortKeys[keys.length-1]=order,nest},nest.sortValues=function(order){return sortValues=order,nest},nest.rollup=function(f){return rollup=f,nest},nest},d3.set=function(array){var set=new d3_Set;if(array)for(var i=0,n=array.length;i<n;++i)set.add(array[i]);return set},d3_class(d3_Set,{has:d3_map_has,add:function(key){return this._[d3_map_escape(key+="")]=!0,key},remove:d3_map_remove,values:d3_map_keys,size:d3_map_size,empty:d3_map_empty,forEach:function(f){for(var key in this._)f.call(this,d3_map_unescape(key))}}),d3.behavior={},d3.rebind=function(target,source){for(var method,i=1,n=arguments.length;++i<n;)target[method=arguments[i]]=d3_rebind(target,source,source[method]);return target};var d3_vendorPrefixes=["webkit","ms","moz","Moz","o","O"];function d3_noop(){}function d3_dispatch(){}function d3_dispatch_event(dispatch){var listeners=[],listenerByName=new d3_Map;function event(){for(var l,z=listeners,i=-1,n=z.length;++i<n;)(l=z[i].on)&&l.apply(this,arguments);return dispatch}return event.on=function(name,listener){var i,l=listenerByName.get(name);return arguments.length<2?l&&l.on:(l&&(l.on=null,listeners=listeners.slice(0,i=listeners.indexOf(l)).concat(listeners.slice(i+1)),listenerByName.remove(name)),listener&&listeners.push(listenerByName.set(name,{on:listener})),dispatch)},event}function d3_eventPreventDefault(){d3.event.preventDefault()}function d3_eventSource(){for(var s,e=d3.event;s=e.sourceEvent;)e=s;return e}function d3_eventDispatch(target){for(var dispatch=new d3_dispatch,i=0,n=arguments.length;++i<n;)dispatch[arguments[i]]=d3_dispatch_event(dispatch);return dispatch.of=function(thiz,argumentz){return function(e1){try{var e0=e1.sourceEvent=d3.event;e1.target=target,d3.event=e1,dispatch[e1.type].apply(thiz,argumentz)}finally{d3.event=e0}}},dispatch}d3.dispatch=function(){for(var dispatch=new d3_dispatch,i=-1,n=arguments.length;++i<n;)dispatch[arguments[i]]=d3_dispatch_event(dispatch);return dispatch},d3_dispatch.prototype.on=function(type,listener){var i=type.indexOf("."),name="";if(i>=0&&(name=type.slice(i+1),type=type.slice(0,i)),type)return arguments.length<2?this[type].on(name):this[type].on(name,listener);if(2===arguments.length){if(null==listener)for(type in this)this.hasOwnProperty(type)&&this[type].on(name,null);return this}},d3.event=null,d3.requote=function(s){return s.replace(d3_requote_re,"\\$&")};var d3_requote_re=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,d3_subclass={}.__proto__?function(object,prototype){object.__proto__=prototype}:function(object,prototype){for(var property in prototype)object[property]=prototype[property]};function d3_selection(groups){return d3_subclass(groups,d3_selectionPrototype),groups}var d3_select=function(s,n){return n.querySelector(s)},d3_selectAll=function(s,n){return n.querySelectorAll(s)},d3_selectMatches=function(n,s){var d3_selectMatcher=n.matches||n[d3_vendorSymbol(n,"matchesSelector")];return(d3_selectMatches=function(n,s){return d3_selectMatcher.call(n,s)})(n,s)};"function"==typeof Sizzle&&(d3_select=function(s,n){return Sizzle(s,n)[0]||null},d3_selectAll=Sizzle,d3_selectMatches=Sizzle.matchesSelector),d3.selection=function(){return d3.select(d3_document.documentElement)};var d3_selectionPrototype=d3.selection.prototype=[];function d3_selection_selector(selector){return"function"==typeof selector?selector:function(){return d3_select(selector,this)}}function d3_selection_selectorAll(selector){return"function"==typeof selector?selector:function(){return d3_selectAll(selector,this)}}d3_selectionPrototype.select=function(selector){var subgroup,subnode,group,node,subgroups=[];selector=d3_selection_selector(selector);for(var j=-1,m=this.length;++j<m;){subgroups.push(subgroup=[]),subgroup.parentNode=(group=this[j]).parentNode;for(var i=-1,n=group.length;++i<n;)(node=group[i])?(subgroup.push(subnode=selector.call(node,node.__data__,i,j)),subnode&&"__data__"in node&&(subnode.__data__=node.__data__)):subgroup.push(null)}return d3_selection(subgroups)},d3_selectionPrototype.selectAll=function(selector){var subgroup,node,subgroups=[];selector=d3_selection_selectorAll(selector);for(var j=-1,m=this.length;++j<m;)for(var group=this[j],i=-1,n=group.length;++i<n;)(node=group[i])&&(subgroups.push(subgroup=d3_array(selector.call(node,node.__data__,i,j))),subgroup.parentNode=node);return d3_selection(subgroups)};var d3_nsXhtml="http://www.w3.org/1999/xhtml",d3_nsPrefix={svg:"http://www.w3.org/2000/svg",xhtml:d3_nsXhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function d3_selection_attr(name,value){return name=d3.ns.qualify(name),null==value?name.local?function attrNullNS(){this.removeAttributeNS(name.space,name.local)}:function attrNull(){this.removeAttribute(name)}:"function"==typeof value?name.local?function attrFunctionNS(){var x=value.apply(this,arguments);null==x?this.removeAttributeNS(name.space,name.local):this.setAttributeNS(name.space,name.local,x)}:function attrFunction(){var x=value.apply(this,arguments);null==x?this.removeAttribute(name):this.setAttribute(name,x)}:name.local?function attrConstantNS(){this.setAttributeNS(name.space,name.local,value)}:function attrConstant(){this.setAttribute(name,value)}}function d3_collapse(s){return s.trim().replace(/\s+/g," ")}function d3_selection_classedRe(name){return new RegExp("(?:^|\\s+)"+d3.requote(name)+"(?:\\s+|$)","g")}function d3_selection_classes(name){return(name+"").trim().split(/^|\s+/)}function d3_selection_classed(name,value){var n=(name=d3_selection_classes(name).map(d3_selection_classedName)).length;return"function"==typeof value?function classedFunction(){for(var i=-1,x=value.apply(this,arguments);++i<n;)name[i](this,x)}:function classedConstant(){for(var i=-1;++i<n;)name[i](this,value)}}function d3_selection_classedName(name){var re=d3_selection_classedRe(name);return function(node,value){if(c=node.classList)return value?c.add(name):c.remove(name);var c=node.getAttribute("class")||"";value?(re.lastIndex=0,re.test(c)||node.setAttribute("class",d3_collapse(c+" "+name))):node.setAttribute("class",d3_collapse(c.replace(re," ")))}}function d3_selection_style(name,value,priority){return null==value?function styleNull(){this.style.removeProperty(name)}:"function"==typeof value?function styleFunction(){var x=value.apply(this,arguments);null==x?this.style.removeProperty(name):this.style.setProperty(name,x,priority)}:function styleConstant(){this.style.setProperty(name,value,priority)}}function d3_selection_property(name,value){return null==value?function propertyNull(){delete this[name]}:"function"==typeof value?function propertyFunction(){var x=value.apply(this,arguments);null==x?delete this[name]:this[name]=x}:function propertyConstant(){this[name]=value}}function d3_selection_creator(name){return"function"==typeof name?name:(name=d3.ns.qualify(name)).local?function createNS(){return this.ownerDocument.createElementNS(name.space,name.local)}:function create(){var document=this.ownerDocument,namespace=this.namespaceURI;return namespace===d3_nsXhtml&&document.documentElement.namespaceURI===d3_nsXhtml?document.createElement(name):document.createElementNS(namespace,name)}}function d3_selectionRemove(){var parent=this.parentNode;parent&&parent.removeChild(this)}function d3_selection_dataNode(data){return{__data__:data}}function d3_selection_filter(selector){return function(){return d3_selectMatches(this,selector)}}function d3_selection_each(groups,callback){for(var j=0,m=groups.length;j<m;j++)for(var node,group=groups[j],i=0,n=group.length;i<n;i++)(node=group[i])&&callback(node,i,j);return groups}function d3_selection_enter(selection){return d3_subclass(selection,d3_selection_enterPrototype),selection}d3.ns={prefix:d3_nsPrefix,qualify:function(name){var i=name.indexOf(":"),prefix=name;return i>=0&&"xmlns"!==(prefix=name.slice(0,i))&&(name=name.slice(i+1)),d3_nsPrefix.hasOwnProperty(prefix)?{space:d3_nsPrefix[prefix],local:name}:name}},d3_selectionPrototype.attr=function(name,value){if(arguments.length<2){if("string"==typeof name){var node=this.node();return(name=d3.ns.qualify(name)).local?node.getAttributeNS(name.space,name.local):node.getAttribute(name)}for(value in name)this.each(d3_selection_attr(value,name[value]));return this}return this.each(d3_selection_attr(name,value))},d3_selectionPrototype.classed=function(name,value){if(arguments.length<2){if("string"==typeof name){var node=this.node(),n=(name=d3_selection_classes(name)).length,i=-1;if(value=node.classList){for(;++i<n;)if(!value.contains(name[i]))return!1}else for(value=node.getAttribute("class");++i<n;)if(!d3_selection_classedRe(name[i]).test(value))return!1;return!0}for(value in name)this.each(d3_selection_classed(value,name[value]));return this}return this.each(d3_selection_classed(name,value))},d3_selectionPrototype.style=function(name,value,priority){var n=arguments.length;if(n<3){if("string"!=typeof name){for(priority in n<2&&(value=""),name)this.each(d3_selection_style(priority,name[priority],value));return this}if(n<2){var node=this.node();return d3_window(node).getComputedStyle(node,null).getPropertyValue(name)}priority=""}return this.each(d3_selection_style(name,value,priority))},d3_selectionPrototype.property=function(name,value){if(arguments.length<2){if("string"==typeof name)return this.node()[name];for(value in name)this.each(d3_selection_property(value,name[value]));return this}return this.each(d3_selection_property(name,value))},d3_selectionPrototype.text=function(value){return arguments.length?this.each("function"==typeof value?function(){var v=value.apply(this,arguments);this.textContent=null==v?"":v}:null==value?function(){this.textContent=""}:function(){this.textContent=value}):this.node().textContent},d3_selectionPrototype.html=function(value){return arguments.length?this.each("function"==typeof value?function(){var v=value.apply(this,arguments);this.innerHTML=null==v?"":v}:null==value?function(){this.innerHTML=""}:function(){this.innerHTML=value}):this.node().innerHTML},d3_selectionPrototype.append=function(name){return name=d3_selection_creator(name),this.select(function(){return this.appendChild(name.apply(this,arguments))})},d3_selectionPrototype.insert=function(name,before){return name=d3_selection_creator(name),before=d3_selection_selector(before),this.select(function(){return this.insertBefore(name.apply(this,arguments),before.apply(this,arguments)||null)})},d3_selectionPrototype.remove=function(){return this.each(d3_selectionRemove)},d3_selectionPrototype.data=function(value,key){var group,node,i=-1,n=this.length;if(!arguments.length){for(value=new Array(n=(group=this[0]).length);++i<n;)(node=group[i])&&(value[i]=node.__data__);return value}function bind(group,groupData){var i,node,nodeData,n=group.length,m=groupData.length,n0=Math.min(n,m),updateNodes=new Array(m),enterNodes=new Array(m),exitNodes=new Array(n);if(key){var keyValue,nodeByKeyValue=new d3_Map,keyValues=new Array(n);for(i=-1;++i<n;)(node=group[i])&&(nodeByKeyValue.has(keyValue=key.call(node,node.__data__,i))?exitNodes[i]=node:nodeByKeyValue.set(keyValue,node),keyValues[i]=keyValue);for(i=-1;++i<m;)(node=nodeByKeyValue.get(keyValue=key.call(groupData,nodeData=groupData[i],i)))?!0!==node&&(updateNodes[i]=node,node.__data__=nodeData):enterNodes[i]=d3_selection_dataNode(nodeData),nodeByKeyValue.set(keyValue,!0);for(i=-1;++i<n;)i in keyValues&&!0!==nodeByKeyValue.get(keyValues[i])&&(exitNodes[i]=group[i])}else{for(i=-1;++i<n0;)node=group[i],nodeData=groupData[i],node?(node.__data__=nodeData,updateNodes[i]=node):enterNodes[i]=d3_selection_dataNode(nodeData);for(;i<m;++i)enterNodes[i]=d3_selection_dataNode(groupData[i]);for(;i<n;++i)exitNodes[i]=group[i]}enterNodes.update=updateNodes,enterNodes.parentNode=updateNodes.parentNode=exitNodes.parentNode=group.parentNode,enter.push(enterNodes),update.push(updateNodes),exit.push(exitNodes)}var enter=d3_selection_enter([]),update=d3_selection([]),exit=d3_selection([]);if("function"==typeof value)for(;++i<n;)bind(group=this[i],value.call(group,group.parentNode.__data__,i));else for(;++i<n;)bind(group=this[i],value);return update.enter=function(){return enter},update.exit=function(){return exit},update},d3_selectionPrototype.datum=function(value){return arguments.length?this.property("__data__",value):this.property("__data__")},d3_selectionPrototype.filter=function(filter){var subgroup,group,node,subgroups=[];"function"!=typeof filter&&(filter=d3_selection_filter(filter));for(var j=0,m=this.length;j<m;j++){subgroups.push(subgroup=[]),subgroup.parentNode=(group=this[j]).parentNode;for(var i=0,n=group.length;i<n;i++)(node=group[i])&&filter.call(node,node.__data__,i,j)&&subgroup.push(node)}return d3_selection(subgroups)},d3_selectionPrototype.order=function(){for(var j=-1,m=this.length;++j<m;)for(var node,group=this[j],i=group.length-1,next=group[i];--i>=0;)(node=group[i])&&(next&&next!==node.nextSibling&&next.parentNode.insertBefore(node,next),next=node);return this},d3_selectionPrototype.sort=function(comparator){comparator=function d3_selection_sortComparator(comparator){arguments.length||(comparator=d3_ascending);return function(a,b){return a&&b?comparator(a.__data__,b.__data__):!a-!b}}.apply(this,arguments);for(var j=-1,m=this.length;++j<m;)this[j].sort(comparator);return this.order()},d3_selectionPrototype.each=function(callback){return d3_selection_each(this,function(node,i,j){callback.call(node,node.__data__,i,j)})},d3_selectionPrototype.call=function(callback){var args=d3_array(arguments);return callback.apply(args[0]=this,args),this},d3_selectionPrototype.empty=function(){return!this.node()},d3_selectionPrototype.node=function(){for(var j=0,m=this.length;j<m;j++)for(var group=this[j],i=0,n=group.length;i<n;i++){var node=group[i];if(node)return node}return null},d3_selectionPrototype.size=function(){var n=0;return d3_selection_each(this,function(){++n}),n};var d3_selection_enterPrototype=[];function d3_selection_on(type,listener,capture){var name="__on"+type,i=type.indexOf("."),wrap=d3_selection_onListener;i>0&&(type=type.slice(0,i));var filter=d3_selection_onFilters.get(type);function onRemove(){var l=this[name];l&&(this.removeEventListener(type,l,l.$),delete this[name])}return filter&&(type=filter,wrap=d3_selection_onFilter),i?listener?function onAdd(){var l=wrap(listener,d3_array(arguments));onRemove.call(this),this.addEventListener(type,this[name]=l,l.$=capture),l._=listener}:onRemove:listener?d3_noop:function removeAll(){var match,re=new RegExp("^__on([^.]+)"+d3.requote(type)+"$");for(var name in this)if(match=name.match(re)){var l=this[name];this.removeEventListener(match[1],l,l.$),delete this[name]}}}d3.selection.enter=d3_selection_enter,d3.selection.enter.prototype=d3_selection_enterPrototype,d3_selection_enterPrototype.append=d3_selectionPrototype.append,d3_selection_enterPrototype.empty=d3_selectionPrototype.empty,d3_selection_enterPrototype.node=d3_selectionPrototype.node,d3_selection_enterPrototype.call=d3_selectionPrototype.call,d3_selection_enterPrototype.size=d3_selectionPrototype.size,d3_selection_enterPrototype.select=function(selector){for(var subgroup,subnode,upgroup,group,node,subgroups=[],j=-1,m=this.length;++j<m;){upgroup=(group=this[j]).update,subgroups.push(subgroup=[]),subgroup.parentNode=group.parentNode;for(var i=-1,n=group.length;++i<n;)(node=group[i])?(subgroup.push(upgroup[i]=subnode=selector.call(group.parentNode,node.__data__,i,j)),subnode.__data__=node.__data__):subgroup.push(null)}return d3_selection(subgroups)},d3_selection_enterPrototype.insert=function(name,before){return arguments.length<2&&(before=function d3_selection_enterInsertBefore(enter){var i0,j0;return function(d,i,j){var node,group=enter[j].update,n=group.length;for(j!=j0&&(j0=j,i0=0),i>=i0&&(i0=i+1);!(node=group[i0])&&++i0<n;);return node}}(this)),d3_selectionPrototype.insert.call(this,name,before)},d3.select=function(node){var group;return"string"==typeof node?(group=[d3_select(node,d3_document)]).parentNode=d3_document.documentElement:(group=[node]).parentNode=d3_documentElement(node),d3_selection([group])},d3.selectAll=function(nodes){var group;return"string"==typeof nodes?(group=d3_array(d3_selectAll(nodes,d3_document))).parentNode=d3_document.documentElement:(group=d3_array(nodes)).parentNode=null,d3_selection([group])},d3_selectionPrototype.on=function(type,listener,capture){var n=arguments.length;if(n<3){if("string"!=typeof type){for(capture in n<2&&(listener=!1),type)this.each(d3_selection_on(capture,type[capture],listener));return this}if(n<2)return(n=this.node()["__on"+type])&&n._;capture=!1}return this.each(d3_selection_on(type,listener,capture))};var d3_selection_onFilters=d3.map({mouseenter:"mouseover",mouseleave:"mouseout"});function d3_selection_onListener(listener,argumentz){return function(e){var o=d3.event;d3.event=e,argumentz[0]=this.__data__;try{listener.apply(this,argumentz)}finally{d3.event=o}}}function d3_selection_onFilter(listener,argumentz){var l=d3_selection_onListener(listener,argumentz);return function(e){var related=e.relatedTarget;related&&(related===this||8&related.compareDocumentPosition(this))||l.call(this,e)}}d3_document&&d3_selection_onFilters.forEach(function(k){"on"+k in d3_document&&d3_selection_onFilters.remove(k)});var d3_event_dragSelect,d3_event_dragId=0;function d3_event_dragSuppress(node){var name=".dragsuppress-"+ ++d3_event_dragId,click="click"+name,w=d3.select(d3_window(node)).on("touchmove"+name,d3_eventPreventDefault).on("dragstart"+name,d3_eventPreventDefault).on("selectstart"+name,d3_eventPreventDefault);if(null==d3_event_dragSelect&&(d3_event_dragSelect=!("onselectstart"in node)&&d3_vendorSymbol(node.style,"userSelect")),d3_event_dragSelect){var style=d3_documentElement(node).style,select=style[d3_event_dragSelect];style[d3_event_dragSelect]="none"}return function(suppressClick){if(w.on(name,null),d3_event_dragSelect&&(style[d3_event_dragSelect]=select),suppressClick){var off=function(){w.on(click,null)};w.on(click,function(){d3_eventPreventDefault(),off()},!0),setTimeout(off,0)}}}d3.mouse=function(container){return d3_mousePoint(container,d3_eventSource())};var d3_mouse_bug44083=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function d3_mousePoint(container,e){e.changedTouches&&(e=e.changedTouches[0]);var svg=container.ownerSVGElement||container;if(svg.createSVGPoint){var point=svg.createSVGPoint();if(d3_mouse_bug44083<0){var window=d3_window(container);if(window.scrollX||window.scrollY){var ctm=(svg=d3.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();d3_mouse_bug44083=!(ctm.f||ctm.e),svg.remove()}}return d3_mouse_bug44083?(point.x=e.pageX,point.y=e.pageY):(point.x=e.clientX,point.y=e.clientY),[(point=point.matrixTransform(container.getScreenCTM().inverse())).x,point.y]}var rect=container.getBoundingClientRect();return[e.clientX-rect.left-container.clientLeft,e.clientY-rect.top-container.clientTop]}function d3_behavior_dragTouchId(){return d3.event.changedTouches[0].identifier}d3.touch=function(container,touches,identifier){if(arguments.length<3&&(identifier=touches,touches=d3_eventSource().changedTouches),touches)for(var touch,i=0,n=touches.length;i<n;++i)if((touch=touches[i]).identifier===identifier)return d3_mousePoint(container,touch)},d3.behavior.drag=function(){var event=d3_eventDispatch(drag,"drag","dragstart","dragend"),origin=null,mousedown=dragstart(d3_noop,d3.mouse,d3_window,"mousemove","mouseup"),touchstart=dragstart(d3_behavior_dragTouchId,d3.touch,d3_identity,"touchmove","touchend");function drag(){this.on("mousedown.drag",mousedown).on("touchstart.drag",touchstart)}function dragstart(id,position,subject,move,end){return function(){var dragOffset,target=d3.event.target.correspondingElement||d3.event.target,parent=this.parentNode,dispatch=event.of(this,arguments),dragged=0,dragId=id(),dragName=".drag"+(null==dragId?"":"-"+dragId),dragSubject=d3.select(subject(target)).on(move+dragName,function moved(){var dx,dy,position1=position(parent,dragId);if(!position1)return;dx=position1[0]-position0[0],dy=position1[1]-position0[1],dragged|=dx|dy,position0=position1,dispatch({type:"drag",x:position1[0]+dragOffset[0],y:position1[1]+dragOffset[1],dx:dx,dy:dy})}).on(end+dragName,function ended(){if(!position(parent,dragId))return;dragSubject.on(move+dragName,null).on(end+dragName,null),dragRestore(dragged),dispatch({type:"dragend"})}),dragRestore=d3_event_dragSuppress(target),position0=position(parent,dragId);dragOffset=origin?[(dragOffset=origin.apply(this,arguments)).x-position0[0],dragOffset.y-position0[1]]:[0,0],dispatch({type:"dragstart"})}}return drag.origin=function(x){return arguments.length?(origin=x,drag):origin},d3.rebind(drag,event,"on")},d3.touches=function(container,touches){return arguments.length<2&&(touches=d3_eventSource().touches),touches?d3_array(touches).map(function(touch){var point=d3_mousePoint(container,touch);return point.identifier=touch.identifier,point}):[]};var ε=1e-6,ε2=ε*ε,π=Math.PI,τ=2*π,τε=τ-ε,halfπ=π/2,d3_radians=π/180,d3_degrees=180/π;function d3_sgn(x){return x>0?1:x<0?-1:0}function d3_cross2d(a,b,c){return(b[0]-a[0])*(c[1]-a[1])-(b[1]-a[1])*(c[0]-a[0])}function d3_acos(x){return x>1?0:x<-1?π:Math.acos(x)}function d3_asin(x){return x>1?halfπ:x<-1?-halfπ:Math.asin(x)}function d3_cosh(x){return((x=Math.exp(x))+1/x)/2}function d3_haversin(x){return(x=Math.sin(x/2))*x}var ρ=Math.SQRT2;d3.interpolateZoom=function(p0,p1){var i,S,ux0=p0[0],uy0=p0[1],w0=p0[2],ux1=p1[0],uy1=p1[1],w1=p1[2],dx=ux1-ux0,dy=uy1-uy0,d2=dx*dx+dy*dy;if(d2<ε2)S=Math.log(w1/w0)/ρ,i=function(t){return[ux0+t*dx,uy0+t*dy,w0*Math.exp(ρ*t*S)]};else{var d1=Math.sqrt(d2),b0=(w1*w1-w0*w0+4*d2)/(2*w0*2*d1),b1=(w1*w1-w0*w0-4*d2)/(2*w1*2*d1),r0=Math.log(Math.sqrt(b0*b0+1)-b0),r1=Math.log(Math.sqrt(b1*b1+1)-b1);S=(r1-r0)/ρ,i=function(t){var s=t*S,coshr0=d3_cosh(r0),u=w0/(2*d1)*(coshr0*function d3_tanh(x){return((x=Math.exp(2*x))-1)/(x+1)}(ρ*s+r0)-function d3_sinh(x){return((x=Math.exp(x))-1/x)/2}(r0));return[ux0+u*dx,uy0+u*dy,w0*coshr0/d3_cosh(ρ*s+r0)]}}return i.duration=1e3*S,i},d3.behavior.zoom=function(){var translate0,center0,center,mousewheelTimer,touchtime,x0,x1,y0,y1,view={x:0,y:0,k:1},size=[960,500],scaleExtent=d3_behavior_zoomInfinity,duration=250,zooming=0,mousedown="mousedown.zoom",mousemove="mousemove.zoom",mouseup="mouseup.zoom",touchstart="touchstart.zoom",event=d3_eventDispatch(zoom,"zoomstart","zoom","zoomend");function zoom(g){g.on(mousedown,mousedowned).on(d3_behavior_zoomWheel+".zoom",mousewheeled).on("dblclick.zoom",dblclicked).on(touchstart,touchstarted)}function location(p){return[(p[0]-view.x)/view.k,(p[1]-view.y)/view.k]}function scaleTo(s){view.k=Math.max(scaleExtent[0],Math.min(scaleExtent[1],s))}function translateTo(p,l){l=function point(l){return[l[0]*view.k+view.x,l[1]*view.k+view.y]}(l),view.x+=p[0]-l[0],view.y+=p[1]-l[1]}function zoomTo(that,p,l,k){that.__chart__={x:view.x,y:view.y,k:view.k},scaleTo(Math.pow(2,k)),translateTo(center0=p,l),that=d3.select(that),duration>0&&(that=that.transition().duration(duration)),that.call(zoom.event)}function rescale(){x1&&x1.domain(x0.range().map(function(x){return(x-view.x)/view.k}).map(x0.invert)),y1&&y1.domain(y0.range().map(function(y){return(y-view.y)/view.k}).map(y0.invert))}function zoomstarted(dispatch){zooming++||dispatch({type:"zoomstart"})}function zoomed(dispatch){rescale(),dispatch({type:"zoom",scale:view.k,translate:[view.x,view.y]})}function zoomended(dispatch){--zooming||(dispatch({type:"zoomend"}),center0=null)}function mousedowned(){var that=this,dispatch=event.of(that,arguments),dragged=0,subject=d3.select(d3_window(that)).on(mousemove,function moved(){dragged=1,translateTo(d3.mouse(that),location0),zoomed(dispatch)}).on(mouseup,function ended(){subject.on(mousemove,null).on(mouseup,null),dragRestore(dragged),zoomended(dispatch)}),location0=location(d3.mouse(that)),dragRestore=d3_event_dragSuppress(that);d3_selection_interrupt.call(that),zoomstarted(dispatch)}function touchstarted(){var scale0,that=this,dispatch=event.of(that,arguments),locations0={},distance0=0,zoomName=".zoom-"+d3.event.changedTouches[0].identifier,touchmove="touchmove"+zoomName,touchend="touchend"+zoomName,targets=[],subject=d3.select(that),dragRestore=d3_event_dragSuppress(that);function relocate(){var touches=d3.touches(that);return scale0=view.k,touches.forEach(function(t){t.identifier in locations0&&(locations0[t.identifier]=location(t))}),touches}function started(){var target=d3.event.target;d3.select(target).on(touchmove,moved).on(touchend,ended),targets.push(target);for(var changed=d3.event.changedTouches,i=0,n=changed.length;i<n;++i)locations0[changed[i].identifier]=null;var touches=relocate(),now=Date.now();if(1===touches.length){if(now-touchtime<500){var p=touches[0];zoomTo(that,p,locations0[p.identifier],Math.floor(Math.log(view.k)/Math.LN2)+1),d3_eventPreventDefault()}touchtime=now}else if(touches.length>1){p=touches[0];var q=touches[1],dx=p[0]-q[0],dy=p[1]-q[1];distance0=dx*dx+dy*dy}}function moved(){var p0,l0,p1,l1,touches=d3.touches(that);d3_selection_interrupt.call(that);for(var i=0,n=touches.length;i<n;++i,l1=null)if(p1=touches[i],l1=locations0[p1.identifier]){if(l0)break;p0=p1,l0=l1}if(l1){var distance1=(distance1=p1[0]-p0[0])*distance1+(distance1=p1[1]-p0[1])*distance1,scale1=distance0&&Math.sqrt(distance1/distance0);p0=[(p0[0]+p1[0])/2,(p0[1]+p1[1])/2],l0=[(l0[0]+l1[0])/2,(l0[1]+l1[1])/2],scaleTo(scale1*scale0)}touchtime=null,translateTo(p0,l0),zoomed(dispatch)}function ended(){if(d3.event.touches.length){for(var changed=d3.event.changedTouches,i=0,n=changed.length;i<n;++i)delete locations0[changed[i].identifier];for(var identifier in locations0)return void relocate()}d3.selectAll(targets).on(zoomName,null),subject.on(mousedown,mousedowned).on(touchstart,touchstarted),dragRestore(),zoomended(dispatch)}started(),zoomstarted(dispatch),subject.on(mousedown,null).on(touchstart,started)}function mousewheeled(){var dispatch=event.of(this,arguments);mousewheelTimer?clearTimeout(mousewheelTimer):(d3_selection_interrupt.call(this),translate0=location(center0=center||d3.mouse(this)),zoomstarted(dispatch)),mousewheelTimer=setTimeout(function(){mousewheelTimer=null,zoomended(dispatch)},50),d3_eventPreventDefault(),scaleTo(Math.pow(2,.002*d3_behavior_zoomDelta())*view.k),translateTo(center0,translate0),zoomed(dispatch)}function dblclicked(){var p=d3.mouse(this),k=Math.log(view.k)/Math.LN2;zoomTo(this,p,location(p),d3.event.shiftKey?Math.ceil(k)-1:Math.floor(k)+1)}return d3_behavior_zoomWheel||(d3_behavior_zoomWheel="onwheel"in d3_document?(d3_behavior_zoomDelta=function(){return-d3.event.deltaY*(d3.event.deltaMode?120:1)},"wheel"):"onmousewheel"in d3_document?(d3_behavior_zoomDelta=function(){return d3.event.wheelDelta},"mousewheel"):(d3_behavior_zoomDelta=function(){return-d3.event.detail},"MozMousePixelScroll")),zoom.event=function(g){g.each(function(){var dispatch=event.of(this,arguments),view1=view;d3_transitionInheritId?d3.select(this).transition().each("start.zoom",function(){view=this.__chart__||{x:0,y:0,k:1},zoomstarted(dispatch)}).tween("zoom:zoom",function(){var dx=size[0],dy=size[1],cx=center0?center0[0]:dx/2,cy=center0?center0[1]:dy/2,i=d3.interpolateZoom([(cx-view.x)/view.k,(cy-view.y)/view.k,dx/view.k],[(cx-view1.x)/view1.k,(cy-view1.y)/view1.k,dx/view1.k]);return function(t){var l=i(t),k=dx/l[2];this.__chart__=view={x:cx-l[0]*k,y:cy-l[1]*k,k:k},zoomed(dispatch)}}).each("interrupt.zoom",function(){zoomended(dispatch)}).each("end.zoom",function(){zoomended(dispatch)}):(this.__chart__=view,zoomstarted(dispatch),zoomed(dispatch),zoomended(dispatch))})},zoom.translate=function(_){return arguments.length?(view={x:+_[0],y:+_[1],k:view.k},rescale(),zoom):[view.x,view.y]},zoom.scale=function(_){return arguments.length?(view={x:view.x,y:view.y,k:null},scaleTo(+_),rescale(),zoom):view.k},zoom.scaleExtent=function(_){return arguments.length?(scaleExtent=null==_?d3_behavior_zoomInfinity:[+_[0],+_[1]],zoom):scaleExtent},zoom.center=function(_){return arguments.length?(center=_&&[+_[0],+_[1]],zoom):center},zoom.size=function(_){return arguments.length?(size=_&&[+_[0],+_[1]],zoom):size},zoom.duration=function(_){return arguments.length?(duration=+_,zoom):duration},zoom.x=function(z){return arguments.length?(x1=z,x0=z.copy(),view={x:0,y:0,k:1},zoom):x1},zoom.y=function(z){return arguments.length?(y1=z,y0=z.copy(),view={x:0,y:0,k:1},zoom):y1},d3.rebind(zoom,event,"on")};var d3_behavior_zoomDelta,d3_behavior_zoomWheel,d3_behavior_zoomInfinity=[0,1/0];function d3_color(){}function d3_hsl(h,s,l){return this instanceof d3_hsl?(this.h=+h,this.s=+s,void(this.l=+l)):arguments.length<2?h instanceof d3_hsl?new d3_hsl(h.h,h.s,h.l):d3_rgb_parse(""+h,d3_rgb_hsl,d3_hsl):new d3_hsl(h,s,l)}d3.color=d3_color,d3_color.prototype.toString=function(){return this.rgb()+""},d3.hsl=d3_hsl;var d3_hslPrototype=d3_hsl.prototype=new d3_color;function d3_hsl_rgb(h,s,l){var m1,m2;function vv(h){return Math.round(255*function v(h){return h>360?h-=360:h<0&&(h+=360),h<60?m1+(m2-m1)*h/60:h<180?m2:h<240?m1+(m2-m1)*(240-h)/60:m1}(h))}return h=isNaN(h)?0:(h%=360)<0?h+360:h,s=isNaN(s)?0:s<0?0:s>1?1:s,m1=2*(l=l<0?0:l>1?1:l)-(m2=l<=.5?l*(1+s):l+s-l*s),new d3_rgb(vv(h+120),vv(h),vv(h-120))}function d3_hcl(h,c,l){return this instanceof d3_hcl?(this.h=+h,this.c=+c,void(this.l=+l)):arguments.length<2?h instanceof d3_hcl?new d3_hcl(h.h,h.c,h.l):d3_lab_hcl(h instanceof d3_lab?h.l:(h=d3_rgb_lab((h=d3.rgb(h)).r,h.g,h.b)).l,h.a,h.b):new d3_hcl(h,c,l)}d3_hslPrototype.brighter=function(k){return k=Math.pow(.7,arguments.length?k:1),new d3_hsl(this.h,this.s,this.l/k)},d3_hslPrototype.darker=function(k){return k=Math.pow(.7,arguments.length?k:1),new d3_hsl(this.h,this.s,k*this.l)},d3_hslPrototype.rgb=function(){return d3_hsl_rgb(this.h,this.s,this.l)},d3.hcl=d3_hcl;var d3_hclPrototype=d3_hcl.prototype=new d3_color;function d3_hcl_lab(h,c,l){return isNaN(h)&&(h=0),isNaN(c)&&(c=0),new d3_lab(l,Math.cos(h*=d3_radians)*c,Math.sin(h)*c)}function d3_lab(l,a,b){return this instanceof d3_lab?(this.l=+l,this.a=+a,void(this.b=+b)):arguments.length<2?l instanceof d3_lab?new d3_lab(l.l,l.a,l.b):l instanceof d3_hcl?d3_hcl_lab(l.h,l.c,l.l):d3_rgb_lab((l=d3_rgb(l)).r,l.g,l.b):new d3_lab(l,a,b)}d3_hclPrototype.brighter=function(k){return new d3_hcl(this.h,this.c,Math.min(100,this.l+d3_lab_K*(arguments.length?k:1)))},d3_hclPrototype.darker=function(k){return new d3_hcl(this.h,this.c,Math.max(0,this.l-d3_lab_K*(arguments.length?k:1)))},d3_hclPrototype.rgb=function(){return d3_hcl_lab(this.h,this.c,this.l).rgb()},d3.lab=d3_lab;var d3_lab_K=18,d3_lab_X=.95047,d3_lab_Y=1,d3_lab_Z=1.08883,d3_labPrototype=d3_lab.prototype=new d3_color;function d3_lab_rgb(l,a,b){var y=(l+16)/116,x=y+a/500,z=y-b/200;return new d3_rgb(d3_xyz_rgb(3.2404542*(x=d3_lab_xyz(x)*d3_lab_X)-1.5371385*(y=d3_lab_xyz(y)*d3_lab_Y)-.4985314*(z=d3_lab_xyz(z)*d3_lab_Z)),d3_xyz_rgb(-.969266*x+1.8760108*y+.041556*z),d3_xyz_rgb(.0556434*x-.2040259*y+1.0572252*z))}function d3_lab_hcl(l,a,b){return l>0?new d3_hcl(Math.atan2(b,a)*d3_degrees,Math.sqrt(a*a+b*b),l):new d3_hcl(NaN,NaN,l)}function d3_lab_xyz(x){return x>.206893034?x*x*x:(x-4/29)/7.787037}function d3_xyz_lab(x){return x>.008856?Math.pow(x,1/3):7.787037*x+4/29}function d3_xyz_rgb(r){return Math.round(255*(r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055))}function d3_rgb(r,g,b){return this instanceof d3_rgb?(this.r=~~r,this.g=~~g,void(this.b=~~b)):arguments.length<2?r instanceof d3_rgb?new d3_rgb(r.r,r.g,r.b):d3_rgb_parse(""+r,d3_rgb,d3_hsl_rgb):new d3_rgb(r,g,b)}function d3_rgbNumber(value){return new d3_rgb(value>>16,value>>8&255,255&value)}function d3_rgbString(value){return d3_rgbNumber(value)+""}d3_labPrototype.brighter=function(k){return new d3_lab(Math.min(100,this.l+d3_lab_K*(arguments.length?k:1)),this.a,this.b)},d3_labPrototype.darker=function(k){return new d3_lab(Math.max(0,this.l-d3_lab_K*(arguments.length?k:1)),this.a,this.b)},d3_labPrototype.rgb=function(){return d3_lab_rgb(this.l,this.a,this.b)},d3.rgb=d3_rgb;var d3_rgbPrototype=d3_rgb.prototype=new d3_color;function d3_rgb_hex(v){return v<16?"0"+Math.max(0,v).toString(16):Math.min(255,v).toString(16)}function d3_rgb_parse(format,rgb,hsl){var m1,m2,color,r=0,g=0,b=0;if(m1=/([a-z]+)\((.*)\)/.exec(format=format.toLowerCase()))switch(m2=m1[2].split(","),m1[1]){case"hsl":return hsl(parseFloat(m2[0]),parseFloat(m2[1])/100,parseFloat(m2[2])/100);case"rgb":return rgb(d3_rgb_parseNumber(m2[0]),d3_rgb_parseNumber(m2[1]),d3_rgb_parseNumber(m2[2]))}return(color=d3_rgb_names.get(format))?rgb(color.r,color.g,color.b):(null==format||"#"!==format.charAt(0)||isNaN(color=parseInt(format.slice(1),16))||(4===format.length?(r=(3840&color)>>4,r|=r>>4,g=240&color,g|=g>>4,b=15&color,b|=b<<4):7===format.length&&(r=(16711680&color)>>16,g=(65280&color)>>8,b=255&color)),rgb(r,g,b))}function d3_rgb_hsl(r,g,b){var h,s,min=Math.min(r/=255,g/=255,b/=255),max=Math.max(r,g,b),d=max-min,l=(max+min)/2;return d?(s=l<.5?d/(max+min):d/(2-max-min),h=r==max?(g-b)/d+(g<b?6:0):g==max?(b-r)/d+2:(r-g)/d+4,h*=60):(h=NaN,s=l>0&&l<1?0:h),new d3_hsl(h,s,l)}function d3_rgb_lab(r,g,b){var x=d3_xyz_lab((.4124564*(r=d3_rgb_xyz(r))+.3575761*(g=d3_rgb_xyz(g))+.1804375*(b=d3_rgb_xyz(b)))/d3_lab_X),y=d3_xyz_lab((.2126729*r+.7151522*g+.072175*b)/d3_lab_Y);return d3_lab(116*y-16,500*(x-y),200*(y-d3_xyz_lab((.0193339*r+.119192*g+.9503041*b)/d3_lab_Z)))}function d3_rgb_xyz(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function d3_rgb_parseNumber(c){var f=parseFloat(c);return"%"===c.charAt(c.length-1)?Math.round(2.55*f):f}d3_rgbPrototype.brighter=function(k){k=Math.pow(.7,arguments.length?k:1);var r=this.r,g=this.g,b=this.b,i=30;return r||g||b?(r&&r<i&&(r=i),g&&g<i&&(g=i),b&&b<i&&(b=i),new d3_rgb(Math.min(255,r/k),Math.min(255,g/k),Math.min(255,b/k))):new d3_rgb(i,i,i)},d3_rgbPrototype.darker=function(k){return new d3_rgb((k=Math.pow(.7,arguments.length?k:1))*this.r,k*this.g,k*this.b)},d3_rgbPrototype.hsl=function(){return d3_rgb_hsl(this.r,this.g,this.b)},d3_rgbPrototype.toString=function(){return"#"+d3_rgb_hex(this.r)+d3_rgb_hex(this.g)+d3_rgb_hex(this.b)};var d3_rgb_names=d3.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function d3_functor(v){return"function"==typeof v?v:function(){return v}}function d3_xhrType(response){return function(url,mimeType,callback){return 2===arguments.length&&"function"==typeof mimeType&&(callback=mimeType,mimeType=null),d3_xhr(url,mimeType,response,callback)}}function d3_xhr(url,mimeType,response,callback){var xhr={},dispatch=d3.dispatch("beforesend","progress","load","error"),headers={},request=new XMLHttpRequest,responseType=null;function respond(){var result,status=request.status;if(!status&&function d3_xhrHasResponse(request){var type=request.responseType;return type&&"text"!==type?request.response:request.responseText}(request)||status>=200&&status<300||304===status){try{result=response.call(xhr,request)}catch(e){return void dispatch.error.call(xhr,e)}dispatch.load.call(xhr,result)}else dispatch.error.call(xhr,request)}return!this.XDomainRequest||"withCredentials"in request||!/^(http(s)?:)?\/\//.test(url)||(request=new XDomainRequest),"onload"in request?request.onload=request.onerror=respond:request.onreadystatechange=function(){request.readyState>3&&respond()},request.onprogress=function(event){var o=d3.event;d3.event=event;try{dispatch.progress.call(xhr,request)}finally{d3.event=o}},xhr.header=function(name,value){return name=(name+"").toLowerCase(),arguments.length<2?headers[name]:(null==value?delete headers[name]:headers[name]=value+"",xhr)},xhr.mimeType=function(value){return arguments.length?(mimeType=null==value?null:value+"",xhr):mimeType},xhr.responseType=function(value){return arguments.length?(responseType=value,xhr):responseType},xhr.response=function(value){return response=value,xhr},["get","post"].forEach(function(method){xhr[method]=function(){return xhr.send.apply(xhr,[method].concat(d3_array(arguments)))}}),xhr.send=function(method,data,callback){if(2===arguments.length&&"function"==typeof data&&(callback=data,data=null),request.open(method,url,!0),null==mimeType||"accept"in headers||(headers.accept=mimeType+",*/*"),request.setRequestHeader)for(var name in headers)request.setRequestHeader(name,headers[name]);return null!=mimeType&&request.overrideMimeType&&request.overrideMimeType(mimeType),null!=responseType&&(request.responseType=responseType),null!=callback&&xhr.on("error",callback).on("load",function(request){callback(null,request)}),dispatch.beforesend.call(xhr,request),request.send(null==data?null:data),xhr},xhr.abort=function(){return request.abort(),xhr},d3.rebind(xhr,dispatch,"on"),null==callback?xhr:xhr.get(function d3_xhr_fixCallback(callback){return 1===callback.length?function(error,request){callback(null==error?request:null)}:callback}(callback))}d3_rgb_names.forEach(function(key,value){d3_rgb_names.set(key,d3_rgbNumber(value))}),d3.functor=d3_functor,d3.xhr=d3_xhrType(d3_identity),d3.dsv=function(delimiter,mimeType){var reFormat=new RegExp('["'+delimiter+"\n]"),delimiterCode=delimiter.charCodeAt(0);function dsv(url,row,callback){arguments.length<3&&(callback=row,row=null);var xhr=d3_xhr(url,mimeType,null==row?response:typedResponse(row),callback);return xhr.row=function(_){return arguments.length?xhr.response(null==(row=_)?response:typedResponse(_)):row},xhr}function response(request){return dsv.parse(request.responseText)}function typedResponse(f){return function(request){return dsv.parse(request.responseText,f)}}function formatRow(row){return row.map(formatValue).join(delimiter)}function formatValue(text){return reFormat.test(text)?'"'+text.replace(/\"/g,'""')+'"':text}return dsv.parse=function(text,f){var o;return dsv.parseRows(text,function(row,i){if(o)return o(row,i-1);var a=new Function("d","return {"+row.map(function(name,i){return JSON.stringify(name)+": d["+i+"]"}).join(",")+"}");o=f?function(row,i){return f(a(row),i)}:a})},dsv.parseRows=function(text,f){var t,eol,EOL={},EOF={},rows=[],N=text.length,I=0,n=0;function token(){if(I>=N)return EOF;if(eol)return eol=!1,EOL;var j=I;if(34===text.charCodeAt(j)){for(var i=j;i++<N;)if(34===text.charCodeAt(i)){if(34!==text.charCodeAt(i+1))break;++i}return I=i+2,13===(c=text.charCodeAt(i+1))?(eol=!0,10===text.charCodeAt(i+2)&&++I):10===c&&(eol=!0),text.slice(j+1,i).replace(/""/g,'"')}for(;I<N;){var c,k=1;if(10===(c=text.charCodeAt(I++)))eol=!0;else if(13===c)eol=!0,10===text.charCodeAt(I)&&(++I,++k);else if(c!==delimiterCode)continue;return text.slice(j,I-k)}return text.slice(j)}for(;(t=token())!==EOF;){for(var a=[];t!==EOL&&t!==EOF;)a.push(t),t=token();f&&null==(a=f(a,n++))||rows.push(a)}return rows},dsv.format=function(rows){if(Array.isArray(rows[0]))return dsv.formatRows(rows);var fieldSet=new d3_Set,fields=[];return rows.forEach(function(row){for(var field in row)fieldSet.has(field)||fields.push(fieldSet.add(field))}),[fields.map(formatValue).join(delimiter)].concat(rows.map(function(row){return fields.map(function(field){return formatValue(row[field])}).join(delimiter)})).join("\n")},dsv.formatRows=function(rows){return rows.map(formatRow).join("\n")},dsv},d3.csv=d3.dsv(",","text/csv"),d3.tsv=d3.dsv("\t","text/tab-separated-values");var d3_timer_queueHead,d3_timer_queueTail,d3_timer_interval,d3_timer_timeout,d3_timer_frame=this[d3_vendorSymbol(this,"requestAnimationFrame")]||function(callback){setTimeout(callback,17)};function d3_timer(callback,delay,then){var n=arguments.length;n<2&&(delay=0),n<3&&(then=Date.now());var timer={c:callback,t:then+delay,n:null};return d3_timer_queueTail?d3_timer_queueTail.n=timer:d3_timer_queueHead=timer,d3_timer_queueTail=timer,d3_timer_interval||(d3_timer_timeout=clearTimeout(d3_timer_timeout),d3_timer_interval=1,d3_timer_frame(d3_timer_step)),timer}function d3_timer_step(){var now=d3_timer_mark(),delay=d3_timer_sweep()-now;delay>24?(isFinite(delay)&&(clearTimeout(d3_timer_timeout),d3_timer_timeout=setTimeout(d3_timer_step,delay)),d3_timer_interval=0):(d3_timer_interval=1,d3_timer_frame(d3_timer_step))}function d3_timer_mark(){for(var now=Date.now(),timer=d3_timer_queueHead;timer;)now>=timer.t&&timer.c(now-timer.t)&&(timer.c=null),timer=timer.n;return now}function d3_timer_sweep(){for(var t0,t1=d3_timer_queueHead,time=1/0;t1;)t1.c?(t1.t<time&&(time=t1.t),t1=(t0=t1).n):t1=t0?t0.n=t1.n:d3_timer_queueHead=t1.n;return d3_timer_queueTail=t0,time}function d3_format_precision(x,p){return p-(x?Math.ceil(Math.log(x)/Math.LN10):1)}d3.timer=function(){d3_timer.apply(this,arguments)},d3.timer.flush=function(){d3_timer_mark(),d3_timer_sweep()},d3.round=function(x,n){return n?Math.round(x*(n=Math.pow(10,n)))/n:Math.round(x)};var d3_formatPrefixes=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(function d3_formatPrefix(d,i){var k=Math.pow(10,3*abs(8-i));return{scale:i>8?function(d){return d/k}:function(d){return d*k},symbol:d}});d3.formatPrefix=function(value,precision){var i=0;return(value=+value)&&(value<0&&(value*=-1),precision&&(value=d3.round(value,d3_format_precision(value,precision))),i=1+Math.floor(1e-12+Math.log(value)/Math.LN10),i=Math.max(-24,Math.min(24,3*Math.floor((i-1)/3)))),d3_formatPrefixes[8+i/3]};var d3_format_re=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,d3_format_types=d3.map({b:function(x){return x.toString(2)},c:function(x){return String.fromCharCode(x)},o:function(x){return x.toString(8)},x:function(x){return x.toString(16)},X:function(x){return x.toString(16).toUpperCase()},g:function(x,p){return x.toPrecision(p)},e:function(x,p){return x.toExponential(p)},f:function(x,p){return x.toFixed(p)},r:function(x,p){return(x=d3.round(x,d3_format_precision(x,p))).toFixed(Math.max(0,Math.min(20,d3_format_precision(x*(1+1e-15),p))))}});function d3_format_typeDefault(x){return x+""}var d3_time=d3.time={},d3_date=Date;function d3_date_utc(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}d3_date_utc.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){d3_time_prototype.setUTCDate.apply(this._,arguments)},setDay:function(){d3_time_prototype.setUTCDay.apply(this._,arguments)},setFullYear:function(){d3_time_prototype.setUTCFullYear.apply(this._,arguments)},setHours:function(){d3_time_prototype.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){d3_time_prototype.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){d3_time_prototype.setUTCMinutes.apply(this._,arguments)},setMonth:function(){d3_time_prototype.setUTCMonth.apply(this._,arguments)},setSeconds:function(){d3_time_prototype.setUTCSeconds.apply(this._,arguments)},setTime:function(){d3_time_prototype.setTime.apply(this._,arguments)}};var d3_time_prototype=Date.prototype;function d3_time_interval(local,step,number){function round(date){var d0=local(date),d1=offset(d0,1);return date-d0<d1-date?d0:d1}function ceil(date){return step(date=local(new d3_date(date-1)),1),date}function offset(date,k){return step(date=new d3_date(+date),k),date}function range(t0,t1,dt){var time=ceil(t0),times=[];if(dt>1)for(;time<t1;)number(time)%dt||times.push(new Date(+time)),step(time,1);else for(;time<t1;)times.push(new Date(+time)),step(time,1);return times}local.floor=local,local.round=round,local.ceil=ceil,local.offset=offset,local.range=range;var utc=local.utc=d3_time_interval_utc(local);return utc.floor=utc,utc.round=d3_time_interval_utc(round),utc.ceil=d3_time_interval_utc(ceil),utc.offset=d3_time_interval_utc(offset),utc.range=function range_utc(t0,t1,dt){try{d3_date=d3_date_utc;var utc=new d3_date_utc;return utc._=t0,range(utc,t1,dt)}finally{d3_date=Date}},local}function d3_time_interval_utc(method){return function(date,k){try{d3_date=d3_date_utc;var utc=new d3_date_utc;return utc._=date,method(utc,k)._}finally{d3_date=Date}}}d3_time.year=d3_time_interval(function(date){return(date=d3_time.day(date)).setMonth(0,1),date},function(date,offset){date.setFullYear(date.getFullYear()+offset)},function(date){return date.getFullYear()}),d3_time.years=d3_time.year.range,d3_time.years.utc=d3_time.year.utc.range,d3_time.day=d3_time_interval(function(date){var day=new d3_date(2e3,0);return day.setFullYear(date.getFullYear(),date.getMonth(),date.getDate()),day},function(date,offset){date.setDate(date.getDate()+offset)},function(date){return date.getDate()-1}),d3_time.days=d3_time.day.range,d3_time.days.utc=d3_time.day.utc.range,d3_time.dayOfYear=function(date){var year=d3_time.year(date);return Math.floor((date-year-6e4*(date.getTimezoneOffset()-year.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(day,i){i=7-i;var interval=d3_time[day]=d3_time_interval(function(date){return(date=d3_time.day(date)).setDate(date.getDate()-(date.getDay()+i)%7),date},function(date,offset){date.setDate(date.getDate()+7*Math.floor(offset))},function(date){var day=d3_time.year(date).getDay();return Math.floor((d3_time.dayOfYear(date)+(day+i)%7)/7)-(day!==i)});d3_time[day+"s"]=interval.range,d3_time[day+"s"].utc=interval.utc.range,d3_time[day+"OfYear"]=function(date){var day=d3_time.year(date).getDay();return Math.floor((d3_time.dayOfYear(date)+(day+i)%7)/7)}}),d3_time.week=d3_time.sunday,d3_time.weeks=d3_time.sunday.range,d3_time.weeks.utc=d3_time.sunday.utc.range,d3_time.weekOfYear=d3_time.sundayOfYear;var d3_time_formatPads={"-":"",_:" ",0:"0"},d3_time_numberRe=/^\s*\d+/,d3_time_percentRe=/^%/;function d3_time_formatPad(value,fill,width){var sign=value<0?"-":"",string=(sign?-value:value)+"",length=string.length;return sign+(length<width?new Array(width-length+1).join(fill)+string:string)}function d3_time_formatRe(names){return new RegExp("^(?:"+names.map(d3.requote).join("|")+")","i")}function d3_time_formatLookup(names){for(var map=new d3_Map,i=-1,n=names.length;++i<n;)map.set(names[i].toLowerCase(),i);return map}function d3_time_parseWeekdayNumber(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+1));return n?(date.w=+n[0],i+n[0].length):-1}function d3_time_parseWeekNumberSunday(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i));return n?(date.U=+n[0],i+n[0].length):-1}function d3_time_parseWeekNumberMonday(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i));return n?(date.W=+n[0],i+n[0].length):-1}function d3_time_parseFullYear(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+4));return n?(date.y=+n[0],i+n[0].length):-1}function d3_time_parseYear(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.y=function d3_time_expandYear(d){return d+(d>68?1900:2e3)}(+n[0]),i+n[0].length):-1}function d3_time_parseZone(date,string,i){return/^[+-]\d{4}$/.test(string=string.slice(i,i+5))?(date.Z=-string,i+5):-1}function d3_time_parseMonthNumber(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.m=n[0]-1,i+n[0].length):-1}function d3_time_parseDay(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.d=+n[0],i+n[0].length):-1}function d3_time_parseDayOfYear(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+3));return n?(date.j=+n[0],i+n[0].length):-1}function d3_time_parseHour24(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.H=+n[0],i+n[0].length):-1}function d3_time_parseMinutes(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.M=+n[0],i+n[0].length):-1}function d3_time_parseSeconds(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.S=+n[0],i+n[0].length):-1}function d3_time_parseMilliseconds(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+3));return n?(date.L=+n[0],i+n[0].length):-1}function d3_time_zone(d){var z=d.getTimezoneOffset(),zs=z>0?"-":"+",zh=abs(z)/60|0,zm=abs(z)%60;return zs+d3_time_formatPad(zh,"0",2)+d3_time_formatPad(zm,"0",2)}function d3_time_parseLiteralPercent(date,string,i){d3_time_percentRe.lastIndex=0;var n=d3_time_percentRe.exec(string.slice(i,i+1));return n?i+n[0].length:-1}function d3_time_formatMulti(formats){for(var n=formats.length,i=-1;++i<n;)formats[i][0]=this(formats[i][0]);return function(date){for(var i=0,f=formats[i];!f[1](date);)f=formats[++i];return f[0](date)}}d3.locale=function(locale){return{numberFormat:function d3_locale_numberFormat(locale){var locale_decimal=locale.decimal,locale_thousands=locale.thousands,locale_grouping=locale.grouping,locale_currency=locale.currency,formatGroup=locale_grouping&&locale_thousands?function(value,width){for(var i=value.length,t=[],j=0,g=locale_grouping[0],length=0;i>0&&g>0&&(length+g+1>width&&(g=Math.max(1,width-length)),t.push(value.substring(i-=g,i+g)),!((length+=g+1)>width));)g=locale_grouping[j=(j+1)%locale_grouping.length];return t.reverse().join(locale_thousands)}:d3_identity;return function(specifier){var match=d3_format_re.exec(specifier),fill=match[1]||" ",align=match[2]||">",sign=match[3]||"-",symbol=match[4]||"",zfill=match[5],width=+match[6],comma=match[7],precision=match[8],type=match[9],scale=1,prefix="",suffix="",integer=!1,exponent=!0;switch(precision&&(precision=+precision.substring(1)),(zfill||"0"===fill&&"="===align)&&(zfill=fill="0",align="="),type){case"n":comma=!0,type="g";break;case"%":scale=100,suffix="%",type="f";break;case"p":scale=100,suffix="%",type="r";break;case"b":case"o":case"x":case"X":"#"===symbol&&(prefix="0"+type.toLowerCase());case"c":exponent=!1;case"d":integer=!0,precision=0;break;case"s":scale=-1,type="r"}"$"===symbol&&(prefix=locale_currency[0],suffix=locale_currency[1]),"r"!=type||precision||(type="g"),null!=precision&&("g"==type?precision=Math.max(1,Math.min(21,precision)):"e"!=type&&"f"!=type||(precision=Math.max(0,Math.min(20,precision)))),type=d3_format_types.get(type)||d3_format_typeDefault;var zcomma=zfill&&comma;return function(value){var fullSuffix=suffix;if(integer&&value%1)return"";var negative=value<0||0===value&&1/value<0?(value=-value,"-"):"-"===sign?"":sign;if(scale<0){var unit=d3.formatPrefix(value,precision);value=unit.scale(value),fullSuffix=unit.symbol+suffix}else value*=scale;var before,after,i=(value=type(value,precision)).lastIndexOf(".");if(i<0){var j=exponent?value.lastIndexOf("e"):-1;j<0?(before=value,after=""):(before=value.substring(0,j),after=value.substring(j))}else before=value.substring(0,i),after=locale_decimal+value.substring(i+1);!zfill&&comma&&(before=formatGroup(before,1/0));var length=prefix.length+before.length+after.length+(zcomma?0:negative.length),padding=length<width?new Array(length=width-length+1).join(fill):"";return zcomma&&(before=formatGroup(padding+before,padding.length?width-after.length:1/0)),negative+=prefix,value=before+after,("<"===align?negative+value+padding:">"===align?padding+negative+value:"^"===align?padding.substring(0,length>>=1)+negative+value+padding.substring(length):negative+(zcomma?value:padding+value))+fullSuffix}}}(locale),timeFormat:function d3_locale_timeFormat(locale){var locale_dateTime=locale.dateTime,locale_date=locale.date,locale_time=locale.time,locale_periods=locale.periods,locale_days=locale.days,locale_shortDays=locale.shortDays,locale_months=locale.months,locale_shortMonths=locale.shortMonths;function d3_time_format(template){var n=template.length;function format(date){for(var c,p,f,string=[],i=-1,j=0;++i<n;)37===template.charCodeAt(i)&&(string.push(template.slice(j,i)),null!=(p=d3_time_formatPads[c=template.charAt(++i)])&&(c=template.charAt(++i)),(f=d3_time_formats[c])&&(c=f(date,null==p?"e"===c?" ":"0":p)),string.push(c),j=i+1);return string.push(template.slice(j,i)),string.join("")}return format.parse=function(string){var d={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(d3_time_parse(d,template,string,0)!=string.length)return null;"p"in d&&(d.H=d.H%12+12*d.p);var localZ=null!=d.Z&&d3_date!==d3_date_utc,date=new(localZ?d3_date_utc:d3_date);return"j"in d?date.setFullYear(d.y,0,d.j):"W"in d||"U"in d?("w"in d||(d.w="W"in d?1:0),date.setFullYear(d.y,0,1),date.setFullYear(d.y,0,"W"in d?(d.w+6)%7+7*d.W-(date.getDay()+5)%7:d.w+7*d.U-(date.getDay()+6)%7)):date.setFullYear(d.y,d.m,d.d),date.setHours(d.H+(d.Z/100|0),d.M+d.Z%100,d.S,d.L),localZ?date._:date},format.toString=function(){return template},format}function d3_time_parse(date,template,string,j){for(var c,p,t,i=0,n=template.length,m=string.length;i<n;){if(j>=m)return-1;if(37===(c=template.charCodeAt(i++))){if(t=template.charAt(i++),!(p=d3_time_parsers[t in d3_time_formatPads?template.charAt(i++):t])||(j=p(date,string,j))<0)return-1}else if(c!=string.charCodeAt(j++))return-1}return j}d3_time_format.utc=function(template){var local=d3_time_format(template);function format(date){try{var utc=new(d3_date=d3_date_utc);return utc._=date,local(utc)}finally{d3_date=Date}}return format.parse=function(string){try{d3_date=d3_date_utc;var date=local.parse(string);return date&&date._}finally{d3_date=Date}},format.toString=local.toString,format},d3_time_format.multi=d3_time_format.utc.multi=d3_time_formatMulti;var d3_time_periodLookup=d3.map(),d3_time_dayRe=d3_time_formatRe(locale_days),d3_time_dayLookup=d3_time_formatLookup(locale_days),d3_time_dayAbbrevRe=d3_time_formatRe(locale_shortDays),d3_time_dayAbbrevLookup=d3_time_formatLookup(locale_shortDays),d3_time_monthRe=d3_time_formatRe(locale_months),d3_time_monthLookup=d3_time_formatLookup(locale_months),d3_time_monthAbbrevRe=d3_time_formatRe(locale_shortMonths),d3_time_monthAbbrevLookup=d3_time_formatLookup(locale_shortMonths);locale_periods.forEach(function(p,i){d3_time_periodLookup.set(p.toLowerCase(),i)});var d3_time_formats={a:function(d){return locale_shortDays[d.getDay()]},A:function(d){return locale_days[d.getDay()]},b:function(d){return locale_shortMonths[d.getMonth()]},B:function(d){return locale_months[d.getMonth()]},c:d3_time_format(locale_dateTime),d:function(d,p){return d3_time_formatPad(d.getDate(),p,2)},e:function(d,p){return d3_time_formatPad(d.getDate(),p,2)},H:function(d,p){return d3_time_formatPad(d.getHours(),p,2)},I:function(d,p){return d3_time_formatPad(d.getHours()%12||12,p,2)},j:function(d,p){return d3_time_formatPad(1+d3_time.dayOfYear(d),p,3)},L:function(d,p){return d3_time_formatPad(d.getMilliseconds(),p,3)},m:function(d,p){return d3_time_formatPad(d.getMonth()+1,p,2)},M:function(d,p){return d3_time_formatPad(d.getMinutes(),p,2)},p:function(d){return locale_periods[+(d.getHours()>=12)]},S:function(d,p){return d3_time_formatPad(d.getSeconds(),p,2)},U:function(d,p){return d3_time_formatPad(d3_time.sundayOfYear(d),p,2)},w:function(d){return d.getDay()},W:function(d,p){return d3_time_formatPad(d3_time.mondayOfYear(d),p,2)},x:d3_time_format(locale_date),X:d3_time_format(locale_time),y:function(d,p){return d3_time_formatPad(d.getFullYear()%100,p,2)},Y:function(d,p){return d3_time_formatPad(d.getFullYear()%1e4,p,4)},Z:d3_time_zone,"%":function(){return"%"}},d3_time_parsers={a:function d3_time_parseWeekdayAbbrev(date,string,i){d3_time_dayAbbrevRe.lastIndex=0;var n=d3_time_dayAbbrevRe.exec(string.slice(i));return n?(date.w=d3_time_dayAbbrevLookup.get(n[0].toLowerCase()),i+n[0].length):-1},A:function d3_time_parseWeekday(date,string,i){d3_time_dayRe.lastIndex=0;var n=d3_time_dayRe.exec(string.slice(i));return n?(date.w=d3_time_dayLookup.get(n[0].toLowerCase()),i+n[0].length):-1},b:function d3_time_parseMonthAbbrev(date,string,i){d3_time_monthAbbrevRe.lastIndex=0;var n=d3_time_monthAbbrevRe.exec(string.slice(i));return n?(date.m=d3_time_monthAbbrevLookup.get(n[0].toLowerCase()),i+n[0].length):-1},B:function d3_time_parseMonth(date,string,i){d3_time_monthRe.lastIndex=0;var n=d3_time_monthRe.exec(string.slice(i));return n?(date.m=d3_time_monthLookup.get(n[0].toLowerCase()),i+n[0].length):-1},c:function d3_time_parseLocaleFull(date,string,i){return d3_time_parse(date,d3_time_formats.c.toString(),string,i)},d:d3_time_parseDay,e:d3_time_parseDay,H:d3_time_parseHour24,I:d3_time_parseHour24,j:d3_time_parseDayOfYear,L:d3_time_parseMilliseconds,m:d3_time_parseMonthNumber,M:d3_time_parseMinutes,p:function d3_time_parseAmPm(date,string,i){var n=d3_time_periodLookup.get(string.slice(i,i+=2).toLowerCase());return null==n?-1:(date.p=n,i)},S:d3_time_parseSeconds,U:d3_time_parseWeekNumberSunday,w:d3_time_parseWeekdayNumber,W:d3_time_parseWeekNumberMonday,x:function d3_time_parseLocaleDate(date,string,i){return d3_time_parse(date,d3_time_formats.x.toString(),string,i)},X:function d3_time_parseLocaleTime(date,string,i){return d3_time_parse(date,d3_time_formats.X.toString(),string,i)},y:d3_time_parseYear,Y:d3_time_parseFullYear,Z:d3_time_parseZone,"%":d3_time_parseLiteralPercent};return d3_time_format}(locale)}};var d3_locale_enUS=d3.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function d3_adder(){}d3.format=d3_locale_enUS.numberFormat,d3.geo={},d3_adder.prototype={s:0,t:0,add:function(y){d3_adderSum(y,this.t,d3_adderTemp),d3_adderSum(d3_adderTemp.s,this.s,this),this.s?this.t+=d3_adderTemp.t:this.s=d3_adderTemp.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var d3_adderTemp=new d3_adder;function d3_adderSum(a,b,o){var x=o.s=a+b,bv=x-a,av=x-bv;o.t=a-av+(b-bv)}function d3_geo_streamGeometry(geometry,listener){geometry&&d3_geo_streamGeometryType.hasOwnProperty(geometry.type)&&d3_geo_streamGeometryType[geometry.type](geometry,listener)}d3.geo.stream=function(object,listener){object&&d3_geo_streamObjectType.hasOwnProperty(object.type)?d3_geo_streamObjectType[object.type](object,listener):d3_geo_streamGeometry(object,listener)};var d3_geo_streamObjectType={Feature:function(feature,listener){d3_geo_streamGeometry(feature.geometry,listener)},FeatureCollection:function(object,listener){for(var features=object.features,i=-1,n=features.length;++i<n;)d3_geo_streamGeometry(features[i].geometry,listener)}},d3_geo_streamGeometryType={Sphere:function(object,listener){listener.sphere()},Point:function(object,listener){object=object.coordinates,listener.point(object[0],object[1],object[2])},MultiPoint:function(object,listener){for(var coordinates=object.coordinates,i=-1,n=coordinates.length;++i<n;)object=coordinates[i],listener.point(object[0],object[1],object[2])},LineString:function(object,listener){d3_geo_streamLine(object.coordinates,listener,0)},MultiLineString:function(object,listener){for(var coordinates=object.coordinates,i=-1,n=coordinates.length;++i<n;)d3_geo_streamLine(coordinates[i],listener,0)},Polygon:function(object,listener){d3_geo_streamPolygon(object.coordinates,listener)},MultiPolygon:function(object,listener){for(var coordinates=object.coordinates,i=-1,n=coordinates.length;++i<n;)d3_geo_streamPolygon(coordinates[i],listener)},GeometryCollection:function(object,listener){for(var geometries=object.geometries,i=-1,n=geometries.length;++i<n;)d3_geo_streamGeometry(geometries[i],listener)}};function d3_geo_streamLine(coordinates,listener,closed){var coordinate,i=-1,n=coordinates.length-closed;for(listener.lineStart();++i<n;)coordinate=coordinates[i],listener.point(coordinate[0],coordinate[1],coordinate[2]);listener.lineEnd()}function d3_geo_streamPolygon(coordinates,listener){var i=-1,n=coordinates.length;for(listener.polygonStart();++i<n;)d3_geo_streamLine(coordinates[i],listener,1);listener.polygonEnd()}d3.geo.area=function(object){return d3_geo_areaSum=0,d3.geo.stream(object,d3_geo_area),d3_geo_areaSum};var d3_geo_areaSum,d3_geo_centroidW0,d3_geo_centroidW1,d3_geo_centroidX0,d3_geo_centroidY0,d3_geo_centroidZ0,d3_geo_centroidX1,d3_geo_centroidY1,d3_geo_centroidZ1,d3_geo_centroidX2,d3_geo_centroidY2,d3_geo_centroidZ2,d3_geo_areaRingSum=new d3_adder,d3_geo_area={sphere:function(){d3_geo_areaSum+=4*π},point:d3_noop,lineStart:d3_noop,lineEnd:d3_noop,polygonStart:function(){d3_geo_areaRingSum.reset(),d3_geo_area.lineStart=d3_geo_areaRingStart},polygonEnd:function(){var area=2*d3_geo_areaRingSum;d3_geo_areaSum+=area<0?4*π+area:area,d3_geo_area.lineStart=d3_geo_area.lineEnd=d3_geo_area.point=d3_noop}};function d3_geo_areaRingStart(){var λ00,φ00,λ0,cosφ0,sinφ0;function nextPoint(λ,φ){φ=φ*d3_radians/2+π/4;var dλ=(λ*=d3_radians)-λ0,sdλ=dλ>=0?1:-1,adλ=sdλ*dλ,cosφ=Math.cos(φ),sinφ=Math.sin(φ),k=sinφ0*sinφ,u=cosφ0*cosφ+k*Math.cos(adλ),v=k*sdλ*Math.sin(adλ);d3_geo_areaRingSum.add(Math.atan2(v,u)),λ0=λ,cosφ0=cosφ,sinφ0=sinφ}d3_geo_area.point=function(λ,φ){d3_geo_area.point=nextPoint,λ0=(λ00=λ)*d3_radians,cosφ0=Math.cos(φ=(φ00=φ)*d3_radians/2+π/4),sinφ0=Math.sin(φ)},d3_geo_area.lineEnd=function(){nextPoint(λ00,φ00)}}function d3_geo_cartesian(spherical){var λ=spherical[0],φ=spherical[1],cosφ=Math.cos(φ);return[cosφ*Math.cos(λ),cosφ*Math.sin(λ),Math.sin(φ)]}function d3_geo_cartesianDot(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function d3_geo_cartesianCross(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function d3_geo_cartesianAdd(a,b){a[0]+=b[0],a[1]+=b[1],a[2]+=b[2]}function d3_geo_cartesianScale(vector,k){return[vector[0]*k,vector[1]*k,vector[2]*k]}function d3_geo_cartesianNormalize(d){var l=Math.sqrt(d[0]*d[0]+d[1]*d[1]+d[2]*d[2]);d[0]/=l,d[1]/=l,d[2]/=l}function d3_geo_spherical(cartesian){return[Math.atan2(cartesian[1],cartesian[0]),d3_asin(cartesian[2])]}function d3_geo_sphericalEqual(a,b){return abs(a[0]-b[0])<ε&&abs(a[1]-b[1])<ε}d3.geo.bounds=function(){var λ0,φ0,λ1,φ1,λ_,λ__,φ__,p0,dλSum,ranges,range,bound={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){bound.point=ringPoint,bound.lineStart=ringStart,bound.lineEnd=ringEnd,dλSum=0,d3_geo_area.polygonStart()},polygonEnd:function(){d3_geo_area.polygonEnd(),bound.point=point,bound.lineStart=lineStart,bound.lineEnd=lineEnd,d3_geo_areaRingSum<0?(λ0=-(λ1=180),φ0=-(φ1=90)):dλSum>ε?φ1=90:dλSum<-ε&&(φ0=-90),range[0]=λ0,range[1]=λ1}};function point(λ,φ){ranges.push(range=[λ0=λ,λ1=λ]),φ<φ0&&(φ0=φ),φ>φ1&&(φ1=φ)}function linePoint(λ,φ){var p=d3_geo_cartesian([λ*d3_radians,φ*d3_radians]);if(p0){var normal=d3_geo_cartesianCross(p0,p),inflection=d3_geo_cartesianCross([normal[1],-normal[0],0],normal);d3_geo_cartesianNormalize(inflection),inflection=d3_geo_spherical(inflection);var dλ=λ-λ_,s=dλ>0?1:-1,λi=inflection[0]*d3_degrees*s,antimeridian=abs(dλ)>180;if(antimeridian^(s*λ_<λi&&λi<s*λ))(φi=inflection[1]*d3_degrees)>φ1&&(φ1=φi);else if(antimeridian^(s*λ_<(λi=(λi+360)%360-180)&&λi<s*λ)){var φi;(φi=-inflection[1]*d3_degrees)<φ0&&(φ0=φi)}else φ<φ0&&(φ0=φ),φ>φ1&&(φ1=φ);antimeridian?λ<λ_?angle(λ0,λ)>angle(λ0,λ1)&&(λ1=λ):angle(λ,λ1)>angle(λ0,λ1)&&(λ0=λ):λ1>=λ0?(λ<λ0&&(λ0=λ),λ>λ1&&(λ1=λ)):λ>λ_?angle(λ0,λ)>angle(λ0,λ1)&&(λ1=λ):angle(λ,λ1)>angle(λ0,λ1)&&(λ0=λ)}else point(λ,φ);p0=p,λ_=λ}function lineStart(){bound.point=linePoint}function lineEnd(){range[0]=λ0,range[1]=λ1,bound.point=point,p0=null}function ringPoint(λ,φ){if(p0){var dλ=λ-λ_;dλSum+=abs(dλ)>180?dλ+(dλ>0?360:-360):dλ}else λ__=λ,φ__=φ;d3_geo_area.point(λ,φ),linePoint(λ,φ)}function ringStart(){d3_geo_area.lineStart()}function ringEnd(){ringPoint(λ__,φ__),d3_geo_area.lineEnd(),abs(dλSum)>ε&&(λ0=-(λ1=180)),range[0]=λ0,range[1]=λ1,p0=null}function angle(λ0,λ1){return(λ1-=λ0)<0?λ1+360:λ1}function compareRanges(a,b){return a[0]-b[0]}function withinRange(x,range){return range[0]<=range[1]?range[0]<=x&&x<=range[1]:x<range[0]||range[1]<x}return function(feature){if(φ1=λ1=-(λ0=φ0=1/0),ranges=[],d3.geo.stream(feature,bound),n=ranges.length){ranges.sort(compareRanges);for(var i=1,merged=[a=ranges[0]];i<n;++i)withinRange((b=ranges[i])[0],a)||withinRange(b[1],a)?(angle(a[0],b[1])>angle(a[0],a[1])&&(a[1]=b[1]),angle(b[0],a[1])>angle(a[0],a[1])&&(a[0]=b[0])):merged.push(a=b);for(var dλ,n,b,best=-1/0,a=(i=0,merged[n=merged.length-1]);i<=n;a=b,++i)b=merged[i],(dλ=angle(a[1],b[0]))>best&&(best=dλ,λ0=b[0],λ1=a[1])}return ranges=range=null,λ0===1/0||φ0===1/0?[[NaN,NaN],[NaN,NaN]]:[[λ0,φ0],[λ1,φ1]]}}(),d3.geo.centroid=function(object){d3_geo_centroidW0=d3_geo_centroidW1=d3_geo_centroidX0=d3_geo_centroidY0=d3_geo_centroidZ0=d3_geo_centroidX1=d3_geo_centroidY1=d3_geo_centroidZ1=d3_geo_centroidX2=d3_geo_centroidY2=d3_geo_centroidZ2=0,d3.geo.stream(object,d3_geo_centroid);var x=d3_geo_centroidX2,y=d3_geo_centroidY2,z=d3_geo_centroidZ2,m=x*x+y*y+z*z;return m<ε2&&(x=d3_geo_centroidX1,y=d3_geo_centroidY1,z=d3_geo_centroidZ1,d3_geo_centroidW1<ε&&(x=d3_geo_centroidX0,y=d3_geo_centroidY0,z=d3_geo_centroidZ0),(m=x*x+y*y+z*z)<ε2)?[NaN,NaN]:[Math.atan2(y,x)*d3_degrees,d3_asin(z/Math.sqrt(m))*d3_degrees]};var d3_geo_centroid={sphere:d3_noop,point:d3_geo_centroidPoint,lineStart:d3_geo_centroidLineStart,lineEnd:d3_geo_centroidLineEnd,polygonStart:function(){d3_geo_centroid.lineStart=d3_geo_centroidRingStart},polygonEnd:function(){d3_geo_centroid.lineStart=d3_geo_centroidLineStart}};function d3_geo_centroidPoint(λ,φ){λ*=d3_radians;var cosφ=Math.cos(φ*=d3_radians);d3_geo_centroidPointXYZ(cosφ*Math.cos(λ),cosφ*Math.sin(λ),Math.sin(φ))}function d3_geo_centroidPointXYZ(x,y,z){d3_geo_centroidX0+=(x-d3_geo_centroidX0)/++d3_geo_centroidW0,d3_geo_centroidY0+=(y-d3_geo_centroidY0)/d3_geo_centroidW0,d3_geo_centroidZ0+=(z-d3_geo_centroidZ0)/d3_geo_centroidW0}function d3_geo_centroidLineStart(){var x0,y0,z0;function nextPoint(λ,φ){λ*=d3_radians;var cosφ=Math.cos(φ*=d3_radians),x=cosφ*Math.cos(λ),y=cosφ*Math.sin(λ),z=Math.sin(φ),w=Math.atan2(Math.sqrt((w=y0*z-z0*y)*w+(w=z0*x-x0*z)*w+(w=x0*y-y0*x)*w),x0*x+y0*y+z0*z);d3_geo_centroidW1+=w,d3_geo_centroidX1+=w*(x0+(x0=x)),d3_geo_centroidY1+=w*(y0+(y0=y)),d3_geo_centroidZ1+=w*(z0+(z0=z)),d3_geo_centroidPointXYZ(x0,y0,z0)}d3_geo_centroid.point=function(λ,φ){λ*=d3_radians;var cosφ=Math.cos(φ*=d3_radians);x0=cosφ*Math.cos(λ),y0=cosφ*Math.sin(λ),z0=Math.sin(φ),d3_geo_centroid.point=nextPoint,d3_geo_centroidPointXYZ(x0,y0,z0)}}function d3_geo_centroidLineEnd(){d3_geo_centroid.point=d3_geo_centroidPoint}function d3_geo_centroidRingStart(){var λ00,φ00,x0,y0,z0;function nextPoint(λ,φ){λ*=d3_radians;var cosφ=Math.cos(φ*=d3_radians),x=cosφ*Math.cos(λ),y=cosφ*Math.sin(λ),z=Math.sin(φ),cx=y0*z-z0*y,cy=z0*x-x0*z,cz=x0*y-y0*x,m=Math.sqrt(cx*cx+cy*cy+cz*cz),u=x0*x+y0*y+z0*z,v=m&&-d3_acos(u)/m,w=Math.atan2(m,u);d3_geo_centroidX2+=v*cx,d3_geo_centroidY2+=v*cy,d3_geo_centroidZ2+=v*cz,d3_geo_centroidW1+=w,d3_geo_centroidX1+=w*(x0+(x0=x)),d3_geo_centroidY1+=w*(y0+(y0=y)),d3_geo_centroidZ1+=w*(z0+(z0=z)),d3_geo_centroidPointXYZ(x0,y0,z0)}d3_geo_centroid.point=function(λ,φ){λ00=λ,φ00=φ,d3_geo_centroid.point=nextPoint,λ*=d3_radians;var cosφ=Math.cos(φ*=d3_radians);x0=cosφ*Math.cos(λ),y0=cosφ*Math.sin(λ),z0=Math.sin(φ),d3_geo_centroidPointXYZ(x0,y0,z0)},d3_geo_centroid.lineEnd=function(){nextPoint(λ00,φ00),d3_geo_centroid.lineEnd=d3_geo_centroidLineEnd,d3_geo_centroid.point=d3_geo_centroidPoint}}function d3_geo_compose(a,b){function compose(x,y){return x=a(x,y),b(x[0],x[1])}return a.invert&&b.invert&&(compose.invert=function(x,y){return(x=b.invert(x,y))&&a.invert(x[0],x[1])}),compose}function d3_true(){return!0}function d3_geo_clipPolygon(segments,compare,clipStartInside,interpolate,listener){var subject=[],clip=[];if(segments.forEach(function(segment){if(!((n=segment.length-1)<=0)){var n,p0=segment[0],p1=segment[n];if(d3_geo_sphericalEqual(p0,p1)){listener.lineStart();for(var i=0;i<n;++i)listener.point((p0=segment[i])[0],p0[1]);listener.lineEnd()}else{var a=new d3_geo_clipPolygonIntersection(p0,segment,null,!0),b=new d3_geo_clipPolygonIntersection(p0,null,a,!1);a.o=b,subject.push(a),clip.push(b),b=new d3_geo_clipPolygonIntersection(p1,null,a=new d3_geo_clipPolygonIntersection(p1,segment,null,!1),!0),a.o=b,subject.push(a),clip.push(b)}}}),clip.sort(compare),d3_geo_clipPolygonLinkCircular(subject),d3_geo_clipPolygonLinkCircular(clip),subject.length){for(var i=0,entry=clipStartInside,n=clip.length;i<n;++i)clip[i].e=entry=!entry;for(var points,point,start=subject[0];;){for(var current=start,isSubject=!0;current.v;)if((current=current.n)===start)return;points=current.z,listener.lineStart();do{if(current.v=current.o.v=!0,current.e){if(isSubject)for(i=0,n=points.length;i<n;++i)listener.point((point=points[i])[0],point[1]);else interpolate(current.x,current.n.x,1,listener);current=current.n}else{if(isSubject)for(i=(points=current.p.z).length-1;i>=0;--i)listener.point((point=points[i])[0],point[1]);else interpolate(current.x,current.p.x,-1,listener);current=current.p}points=(current=current.o).z,isSubject=!isSubject}while(!current.v);listener.lineEnd()}}}function d3_geo_clipPolygonLinkCircular(array){if(n=array.length){for(var n,b,i=0,a=array[0];++i<n;)a.n=b=array[i],b.p=a,a=b;a.n=b=array[0],b.p=a}}function d3_geo_clipPolygonIntersection(point,points,other,entry){this.x=point,this.z=points,this.o=other,this.e=entry,this.v=!1,this.n=this.p=null}function d3_geo_clip(pointVisible,clipLine,interpolate,clipStart){return function(rotate,listener){var segments,line=clipLine(listener),rotatedClipStart=rotate.invert(clipStart[0],clipStart[1]),clip={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){clip.point=pointRing,clip.lineStart=ringStart,clip.lineEnd=ringEnd,segments=[],polygon=[]},polygonEnd:function(){clip.point=point,clip.lineStart=lineStart,clip.lineEnd=lineEnd,segments=d3.merge(segments);var clipStartInside=function d3_geo_pointInPolygon(point,polygon){var meridian=point[0],parallel=point[1],meridianNormal=[Math.sin(meridian),-Math.cos(meridian),0],polarAngle=0,winding=0;d3_geo_areaRingSum.reset();for(var i=0,n=polygon.length;i<n;++i){var ring=polygon[i],m=ring.length;if(m)for(var point0=ring[0],λ0=point0[0],φ0=point0[1]/2+π/4,sinφ0=Math.sin(φ0),cosφ0=Math.cos(φ0),j=1;;){j===m&&(j=0);var λ=(point=ring[j])[0],φ=point[1]/2+π/4,sinφ=Math.sin(φ),cosφ=Math.cos(φ),dλ=λ-λ0,sdλ=dλ>=0?1:-1,adλ=sdλ*dλ,antimeridian=adλ>π,k=sinφ0*sinφ;if(d3_geo_areaRingSum.add(Math.atan2(k*sdλ*Math.sin(adλ),cosφ0*cosφ+k*Math.cos(adλ))),polarAngle+=antimeridian?dλ+sdλ*τ:dλ,antimeridian^λ0>=meridian^λ>=meridian){var arc=d3_geo_cartesianCross(d3_geo_cartesian(point0),d3_geo_cartesian(point));d3_geo_cartesianNormalize(arc);var intersection=d3_geo_cartesianCross(meridianNormal,arc);d3_geo_cartesianNormalize(intersection);var φarc=(antimeridian^dλ>=0?-1:1)*d3_asin(intersection[2]);(parallel>φarc||parallel===φarc&&(arc[0]||arc[1]))&&(winding+=antimeridian^dλ>=0?1:-1)}if(!j++)break;λ0=λ,sinφ0=sinφ,cosφ0=cosφ,point0=point}}return(polarAngle<-ε||polarAngle<ε&&d3_geo_areaRingSum<-ε)^1&winding}(rotatedClipStart,polygon);segments.length?(polygonStarted||(listener.polygonStart(),polygonStarted=!0),d3_geo_clipPolygon(segments,d3_geo_clipSort,clipStartInside,interpolate,listener)):clipStartInside&&(polygonStarted||(listener.polygonStart(),polygonStarted=!0),listener.lineStart(),interpolate(null,null,1,listener),listener.lineEnd()),polygonStarted&&(listener.polygonEnd(),polygonStarted=!1),segments=polygon=null},sphere:function(){listener.polygonStart(),listener.lineStart(),interpolate(null,null,1,listener),listener.lineEnd(),listener.polygonEnd()}};function point(λ,φ){var point=rotate(λ,φ);pointVisible(λ=point[0],φ=point[1])&&listener.point(λ,φ)}function pointLine(λ,φ){var point=rotate(λ,φ);line.point(point[0],point[1])}function lineStart(){clip.point=pointLine,line.lineStart()}function lineEnd(){clip.point=point,line.lineEnd()}var polygon,ring,buffer=d3_geo_clipBufferListener(),ringListener=clipLine(buffer),polygonStarted=!1;function pointRing(λ,φ){ring.push([λ,φ]);var point=rotate(λ,φ);ringListener.point(point[0],point[1])}function ringStart(){ringListener.lineStart(),ring=[]}function ringEnd(){pointRing(ring[0][0],ring[0][1]),ringListener.lineEnd();var segment,clean=ringListener.clean(),ringSegments=buffer.buffer(),n=ringSegments.length;if(ring.pop(),polygon.push(ring),ring=null,n)if(1&clean){var point,i=-1;if((n=(segment=ringSegments[0]).length-1)>0){for(polygonStarted||(listener.polygonStart(),polygonStarted=!0),listener.lineStart();++i<n;)listener.point((point=segment[i])[0],point[1]);listener.lineEnd()}}else n>1&&2&clean&&ringSegments.push(ringSegments.pop().concat(ringSegments.shift())),segments.push(ringSegments.filter(d3_geo_clipSegmentLength1))}return clip}}function d3_geo_clipSegmentLength1(segment){return segment.length>1}function d3_geo_clipBufferListener(){var line,lines=[];return{lineStart:function(){lines.push(line=[])},point:function(λ,φ){line.push([λ,φ])},lineEnd:d3_noop,buffer:function(){var buffer=lines;return lines=[],line=null,buffer},rejoin:function(){lines.length>1&&lines.push(lines.pop().concat(lines.shift()))}}}function d3_geo_clipSort(a,b){return((a=a.x)[0]<0?a[1]-halfπ-ε:halfπ-a[1])-((b=b.x)[0]<0?b[1]-halfπ-ε:halfπ-b[1])}var d3_geo_clipAntimeridian=d3_geo_clip(d3_true,function d3_geo_clipAntimeridianLine(listener){var clean,λ0=NaN,φ0=NaN,sλ0=NaN;return{lineStart:function(){listener.lineStart(),clean=1},point:function(λ1,φ1){var sλ1=λ1>0?π:-π,dλ=abs(λ1-λ0);abs(dλ-π)<ε?(listener.point(λ0,φ0=(φ0+φ1)/2>0?halfπ:-halfπ),listener.point(sλ0,φ0),listener.lineEnd(),listener.lineStart(),listener.point(sλ1,φ0),listener.point(λ1,φ0),clean=0):sλ0!==sλ1&&dλ>=π&&(abs(λ0-sλ0)<ε&&(λ0-=sλ0*ε),abs(λ1-sλ1)<ε&&(λ1-=sλ1*ε),φ0=function d3_geo_clipAntimeridianIntersect(λ0,φ0,λ1,φ1){var cosφ0,cosφ1,sinλ0_λ1=Math.sin(λ0-λ1);return abs(sinλ0_λ1)>ε?Math.atan((Math.sin(φ0)*(cosφ1=Math.cos(φ1))*Math.sin(λ1)-Math.sin(φ1)*(cosφ0=Math.cos(φ0))*Math.sin(λ0))/(cosφ0*cosφ1*sinλ0_λ1)):(φ0+φ1)/2}(λ0,φ0,λ1,φ1),listener.point(sλ0,φ0),listener.lineEnd(),listener.lineStart(),listener.point(sλ1,φ0),clean=0),listener.point(λ0=λ1,φ0=φ1),sλ0=sλ1},lineEnd:function(){listener.lineEnd(),λ0=φ0=NaN},clean:function(){return 2-clean}}},function d3_geo_clipAntimeridianInterpolate(from,to,direction,listener){var φ;if(null==from)φ=direction*halfπ,listener.point(-π,φ),listener.point(0,φ),listener.point(π,φ),listener.point(π,0),listener.point(π,-φ),listener.point(0,-φ),listener.point(-π,-φ),listener.point(-π,0),listener.point(-π,φ);else if(abs(from[0]-to[0])>ε){var s=from[0]<to[0]?π:-π;φ=direction*s/2,listener.point(-s,φ),listener.point(0,φ),listener.point(s,φ)}else listener.point(to[0],to[1])},[-π,-π/2]);function d3_geom_clipLine(x0,y0,x1,y1){return function(line){var r,a=line.a,b=line.b,ax=a.x,ay=a.y,t0=0,t1=1,dx=b.x-ax,dy=b.y-ay;if(r=x0-ax,dx||!(r>0)){if(r/=dx,dx<0){if(r<t0)return;r<t1&&(t1=r)}else if(dx>0){if(r>t1)return;r>t0&&(t0=r)}if(r=x1-ax,dx||!(r<0)){if(r/=dx,dx<0){if(r>t1)return;r>t0&&(t0=r)}else if(dx>0){if(r<t0)return;r<t1&&(t1=r)}if(r=y0-ay,dy||!(r>0)){if(r/=dy,dy<0){if(r<t0)return;r<t1&&(t1=r)}else if(dy>0){if(r>t1)return;r>t0&&(t0=r)}if(r=y1-ay,dy||!(r<0)){if(r/=dy,dy<0){if(r>t1)return;r>t0&&(t0=r)}else if(dy>0){if(r<t0)return;r<t1&&(t1=r)}return t0>0&&(line.a={x:ax+t0*dx,y:ay+t0*dy}),t1<1&&(line.b={x:ax+t1*dx,y:ay+t1*dy}),line}}}}}}var d3_geo_clipExtentMAX=1e9;function d3_geo_clipExtent(x0,y0,x1,y1){return function(listener){var segments,polygon,ring,x__,y__,v__,x_,y_,v_,first,clean,listener_=listener,bufferListener=d3_geo_clipBufferListener(),clipLine=d3_geom_clipLine(x0,y0,x1,y1),clip={point:point,lineStart:function lineStart(){clip.point=linePoint,polygon&&polygon.push(ring=[]);first=!0,v_=!1,x_=y_=NaN},lineEnd:function lineEnd(){segments&&(linePoint(x__,y__),v__&&v_&&bufferListener.rejoin(),segments.push(bufferListener.buffer()));clip.point=point,v_&&listener.lineEnd()},polygonStart:function(){listener=bufferListener,segments=[],polygon=[],clean=!0},polygonEnd:function(){listener=listener_,segments=d3.merge(segments);var clipStartInside=function insidePolygon(p){for(var wn=0,n=polygon.length,y=p[1],i=0;i<n;++i)for(var b,j=1,v=polygon[i],m=v.length,a=v[0];j<m;++j)b=v[j],a[1]<=y?b[1]>y&&d3_cross2d(a,b,p)>0&&++wn:b[1]<=y&&d3_cross2d(a,b,p)<0&&--wn,a=b;return 0!==wn}([x0,y1]),inside=clean&&clipStartInside,visible=segments.length;(inside||visible)&&(listener.polygonStart(),inside&&(listener.lineStart(),interpolate(null,null,1,listener),listener.lineEnd()),visible&&d3_geo_clipPolygon(segments,compare,clipStartInside,interpolate,listener),listener.polygonEnd()),segments=polygon=ring=null}};function interpolate(from,to,direction,listener){var a=0,a1=0;if(null==from||(a=corner(from,direction))!==(a1=corner(to,direction))||comparePoints(from,to)<0^direction>0)do{listener.point(0===a||3===a?x0:x1,a>1?y1:y0)}while((a=(a+direction+4)%4)!==a1);else listener.point(to[0],to[1])}function pointVisible(x,y){return x0<=x&&x<=x1&&y0<=y&&y<=y1}function point(x,y){pointVisible(x,y)&&listener.point(x,y)}function linePoint(x,y){var v=pointVisible(x=Math.max(-d3_geo_clipExtentMAX,Math.min(d3_geo_clipExtentMAX,x)),y=Math.max(-d3_geo_clipExtentMAX,Math.min(d3_geo_clipExtentMAX,y)));if(polygon&&ring.push([x,y]),first)x__=x,y__=y,v__=v,first=!1,v&&(listener.lineStart(),listener.point(x,y));else if(v&&v_)listener.point(x,y);else{var l={a:{x:x_,y:y_},b:{x:x,y:y}};clipLine(l)?(v_||(listener.lineStart(),listener.point(l.a.x,l.a.y)),listener.point(l.b.x,l.b.y),v||listener.lineEnd(),clean=!1):v&&(listener.lineStart(),listener.point(x,y),clean=!1)}x_=x,y_=y,v_=v}return clip};function corner(p,direction){return abs(p[0]-x0)<ε?direction>0?0:3:abs(p[0]-x1)<ε?direction>0?2:1:abs(p[1]-y0)<ε?direction>0?1:0:direction>0?3:2}function compare(a,b){return comparePoints(a.x,b.x)}function comparePoints(a,b){var ca=corner(a,1),cb=corner(b,1);return ca!==cb?ca-cb:0===ca?b[1]-a[1]:1===ca?a[0]-b[0]:2===ca?a[1]-b[1]:b[0]-a[0]}}function d3_geo_conic(projectAt){var φ0=0,φ1=π/3,m=d3_geo_projectionMutator(projectAt),p=m(φ0,φ1);return p.parallels=function(_){return arguments.length?m(φ0=_[0]*π/180,φ1=_[1]*π/180):[φ0/π*180,φ1/π*180]},p}function d3_geo_conicEqualArea(φ0,φ1){var sinφ0=Math.sin(φ0),n=(sinφ0+Math.sin(φ1))/2,C=1+sinφ0*(2*n-sinφ0),ρ0=Math.sqrt(C)/n;function forward(λ,φ){var ρ=Math.sqrt(C-2*n*Math.sin(φ))/n;return[ρ*Math.sin(λ*=n),ρ0-ρ*Math.cos(λ)]}return forward.invert=function(x,y){var ρ0_y=ρ0-y;return[Math.atan2(x,ρ0_y)/n,d3_asin((C-(x*x+ρ0_y*ρ0_y)*n*n)/(2*n))]},forward}d3.geo.clipExtent=function(){var x0,y0,x1,y1,stream,clip,clipExtent={stream:function(output){return stream&&(stream.valid=!1),(stream=clip(output)).valid=!0,stream},extent:function(_){return arguments.length?(clip=d3_geo_clipExtent(x0=+_[0][0],y0=+_[0][1],x1=+_[1][0],y1=+_[1][1]),stream&&(stream.valid=!1,stream=null),clipExtent):[[x0,y0],[x1,y1]]}};return clipExtent.extent([[0,0],[960,500]])},(d3.geo.conicEqualArea=function(){return d3_geo_conic(d3_geo_conicEqualArea)}).raw=d3_geo_conicEqualArea,d3.geo.albers=function(){return d3.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},d3.geo.albersUsa=function(){var point,lower48Point,alaskaPoint,hawaiiPoint,lower48=d3.geo.albers(),alaska=d3.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),hawaii=d3.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),pointStream={point:function(x,y){point=[x,y]}};function albersUsa(coordinates){var x=coordinates[0],y=coordinates[1];return point=null,lower48Point(x,y),point||(alaskaPoint(x,y),point)||hawaiiPoint(x,y),point}return albersUsa.invert=function(coordinates){var k=lower48.scale(),t=lower48.translate(),x=(coordinates[0]-t[0])/k,y=(coordinates[1]-t[1])/k;return(y>=.12&&y<.234&&x>=-.425&&x<-.214?alaska:y>=.166&&y<.234&&x>=-.214&&x<-.115?hawaii:lower48).invert(coordinates)},albersUsa.stream=function(stream){var lower48Stream=lower48.stream(stream),alaskaStream=alaska.stream(stream),hawaiiStream=hawaii.stream(stream);return{point:function(x,y){lower48Stream.point(x,y),alaskaStream.point(x,y),hawaiiStream.point(x,y)},sphere:function(){lower48Stream.sphere(),alaskaStream.sphere(),hawaiiStream.sphere()},lineStart:function(){lower48Stream.lineStart(),alaskaStream.lineStart(),hawaiiStream.lineStart()},lineEnd:function(){lower48Stream.lineEnd(),alaskaStream.lineEnd(),hawaiiStream.lineEnd()},polygonStart:function(){lower48Stream.polygonStart(),alaskaStream.polygonStart(),hawaiiStream.polygonStart()},polygonEnd:function(){lower48Stream.polygonEnd(),alaskaStream.polygonEnd(),hawaiiStream.polygonEnd()}}},albersUsa.precision=function(_){return arguments.length?(lower48.precision(_),alaska.precision(_),hawaii.precision(_),albersUsa):lower48.precision()},albersUsa.scale=function(_){return arguments.length?(lower48.scale(_),alaska.scale(.35*_),hawaii.scale(_),albersUsa.translate(lower48.translate())):lower48.scale()},albersUsa.translate=function(_){if(!arguments.length)return lower48.translate();var k=lower48.scale(),x=+_[0],y=+_[1];return lower48Point=lower48.translate(_).clipExtent([[x-.455*k,y-.238*k],[x+.455*k,y+.238*k]]).stream(pointStream).point,alaskaPoint=alaska.translate([x-.307*k,y+.201*k]).clipExtent([[x-.425*k+ε,y+.12*k+ε],[x-.214*k-ε,y+.234*k-ε]]).stream(pointStream).point,hawaiiPoint=hawaii.translate([x-.205*k,y+.212*k]).clipExtent([[x-.214*k+ε,y+.166*k+ε],[x-.115*k-ε,y+.234*k-ε]]).stream(pointStream).point,albersUsa},albersUsa.scale(1070)};var d3_geo_pathAreaSum,d3_geo_pathAreaPolygon,d3_geo_pathBoundsX0,d3_geo_pathBoundsY0,d3_geo_pathBoundsX1,d3_geo_pathBoundsY1,d3_geo_pathArea={point:d3_noop,lineStart:d3_noop,lineEnd:d3_noop,polygonStart:function(){d3_geo_pathAreaPolygon=0,d3_geo_pathArea.lineStart=d3_geo_pathAreaRingStart},polygonEnd:function(){d3_geo_pathArea.lineStart=d3_geo_pathArea.lineEnd=d3_geo_pathArea.point=d3_noop,d3_geo_pathAreaSum+=abs(d3_geo_pathAreaPolygon/2)}};function d3_geo_pathAreaRingStart(){var x00,y00,x0,y0;function nextPoint(x,y){d3_geo_pathAreaPolygon+=y0*x-x0*y,x0=x,y0=y}d3_geo_pathArea.point=function(x,y){d3_geo_pathArea.point=nextPoint,x00=x0=x,y00=y0=y},d3_geo_pathArea.lineEnd=function(){nextPoint(x00,y00)}}var d3_geo_pathBounds={point:function d3_geo_pathBoundsPoint(x,y){x<d3_geo_pathBoundsX0&&(d3_geo_pathBoundsX0=x);x>d3_geo_pathBoundsX1&&(d3_geo_pathBoundsX1=x);y<d3_geo_pathBoundsY0&&(d3_geo_pathBoundsY0=y);y>d3_geo_pathBoundsY1&&(d3_geo_pathBoundsY1=y)},lineStart:d3_noop,lineEnd:d3_noop,polygonStart:d3_noop,polygonEnd:d3_noop};function d3_geo_pathBufferCircle(radius){return"m0,"+radius+"a"+radius+","+radius+" 0 1,1 0,"+-2*radius+"a"+radius+","+radius+" 0 1,1 0,"+2*radius+"z"}var d3_geo_lengthSum,d3_geo_pathCentroid={point:d3_geo_pathCentroidPoint,lineStart:d3_geo_pathCentroidLineStart,lineEnd:d3_geo_pathCentroidLineEnd,polygonStart:function(){d3_geo_pathCentroid.lineStart=d3_geo_pathCentroidRingStart},polygonEnd:function(){d3_geo_pathCentroid.point=d3_geo_pathCentroidPoint,d3_geo_pathCentroid.lineStart=d3_geo_pathCentroidLineStart,d3_geo_pathCentroid.lineEnd=d3_geo_pathCentroidLineEnd}};function d3_geo_pathCentroidPoint(x,y){d3_geo_centroidX0+=x,d3_geo_centroidY0+=y,++d3_geo_centroidZ0}function d3_geo_pathCentroidLineStart(){var x0,y0;function nextPoint(x,y){var dx=x-x0,dy=y-y0,z=Math.sqrt(dx*dx+dy*dy);d3_geo_centroidX1+=z*(x0+x)/2,d3_geo_centroidY1+=z*(y0+y)/2,d3_geo_centroidZ1+=z,d3_geo_pathCentroidPoint(x0=x,y0=y)}d3_geo_pathCentroid.point=function(x,y){d3_geo_pathCentroid.point=nextPoint,d3_geo_pathCentroidPoint(x0=x,y0=y)}}function d3_geo_pathCentroidLineEnd(){d3_geo_pathCentroid.point=d3_geo_pathCentroidPoint}function d3_geo_pathCentroidRingStart(){var x00,y00,x0,y0;function nextPoint(x,y){var dx=x-x0,dy=y-y0,z=Math.sqrt(dx*dx+dy*dy);d3_geo_centroidX1+=z*(x0+x)/2,d3_geo_centroidY1+=z*(y0+y)/2,d3_geo_centroidZ1+=z,d3_geo_centroidX2+=(z=y0*x-x0*y)*(x0+x),d3_geo_centroidY2+=z*(y0+y),d3_geo_centroidZ2+=3*z,d3_geo_pathCentroidPoint(x0=x,y0=y)}d3_geo_pathCentroid.point=function(x,y){d3_geo_pathCentroid.point=nextPoint,d3_geo_pathCentroidPoint(x00=x0=x,y00=y0=y)},d3_geo_pathCentroid.lineEnd=function(){nextPoint(x00,y00)}}function d3_geo_resample(project){var δ2=.5,cosMinDistance=Math.cos(30*d3_radians),maxDepth=16;function resample(stream){return(maxDepth?function resampleRecursive(stream){var λ00,x00,y00,a00,b00,c00,λ0,x0,y0,a0,b0,c0,resample={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){stream.polygonStart(),resample.lineStart=ringStart},polygonEnd:function(){stream.polygonEnd(),resample.lineStart=lineStart}};function point(x,y){x=project(x,y),stream.point(x[0],x[1])}function lineStart(){x0=NaN,resample.point=linePoint,stream.lineStart()}function linePoint(λ,φ){var c=d3_geo_cartesian([λ,φ]),p=project(λ,φ);resampleLineTo(x0,y0,λ0,a0,b0,c0,x0=p[0],y0=p[1],λ0=λ,a0=c[0],b0=c[1],c0=c[2],maxDepth,stream),stream.point(x0,y0)}function lineEnd(){resample.point=point,stream.lineEnd()}function ringStart(){lineStart(),resample.point=ringPoint,resample.lineEnd=ringEnd}function ringPoint(λ,φ){linePoint(λ00=λ,φ),x00=x0,y00=y0,a00=a0,b00=b0,c00=c0,resample.point=linePoint}function ringEnd(){resampleLineTo(x0,y0,λ0,a0,b0,c0,x00,y00,λ00,a00,b00,c00,maxDepth,stream),resample.lineEnd=lineEnd,lineEnd()}return resample}:function resampleNone(stream){return d3_geo_transformPoint(stream,function(x,y){x=project(x,y),stream.point(x[0],x[1])})})(stream)}function resampleLineTo(x0,y0,λ0,a0,b0,c0,x1,y1,λ1,a1,b1,c1,depth,stream){var dx=x1-x0,dy=y1-y0,d2=dx*dx+dy*dy;if(d2>4*δ2&&depth--){var a=a0+a1,b=b0+b1,c=c0+c1,m=Math.sqrt(a*a+b*b+c*c),φ2=Math.asin(c/=m),λ2=abs(abs(c)-1)<ε||abs(λ0-λ1)<ε?(λ0+λ1)/2:Math.atan2(b,a),p=project(λ2,φ2),x2=p[0],y2=p[1],dx2=x2-x0,dy2=y2-y0,dz=dy*dx2-dx*dy2;(dz*dz/d2>δ2||abs((dx*dx2+dy*dy2)/d2-.5)>.3||a0*a1+b0*b1+c0*c1<cosMinDistance)&&(resampleLineTo(x0,y0,λ0,a0,b0,c0,x2,y2,λ2,a/=m,b/=m,c,depth,stream),stream.point(x2,y2),resampleLineTo(x2,y2,λ2,a,b,c,x1,y1,λ1,a1,b1,c1,depth,stream))}}return resample.precision=function(_){return arguments.length?(maxDepth=(δ2=_*_)>0&&16,resample):Math.sqrt(δ2)},resample}function d3_geo_transform(stream){this.stream=stream}function d3_geo_transformPoint(stream,point){return{point:point,sphere:function(){stream.sphere()},lineStart:function(){stream.lineStart()},lineEnd:function(){stream.lineEnd()},polygonStart:function(){stream.polygonStart()},polygonEnd:function(){stream.polygonEnd()}}}function d3_geo_projection(project){return d3_geo_projectionMutator(function(){return project})()}function d3_geo_projectionMutator(projectAt){var project,rotate,projectRotate,δx,δy,stream,projectResample=d3_geo_resample(function(x,y){return[(x=project(x,y))[0]*k+δx,δy-x[1]*k]}),k=150,x=480,y=250,λ=0,φ=0,δλ=0,δφ=0,δγ=0,preclip=d3_geo_clipAntimeridian,postclip=d3_identity,clipAngle=null,clipExtent=null;function projection(point){return[(point=projectRotate(point[0]*d3_radians,point[1]*d3_radians))[0]*k+δx,δy-point[1]*k]}function invert(point){return(point=projectRotate.invert((point[0]-δx)/k,(δy-point[1])/k))&&[point[0]*d3_degrees,point[1]*d3_degrees]}function reset(){projectRotate=d3_geo_compose(rotate=d3_geo_rotation(δλ,δφ,δγ),project);var center=project(λ,φ);return δx=x-center[0]*k,δy=y+center[1]*k,invalidate()}function invalidate(){return stream&&(stream.valid=!1,stream=null),projection}return projection.stream=function(output){return stream&&(stream.valid=!1),(stream=d3_geo_projectionRadians(preclip(rotate,projectResample(postclip(output))))).valid=!0,stream},projection.clipAngle=function(_){return arguments.length?(preclip=null==_?(clipAngle=_,d3_geo_clipAntimeridian):function d3_geo_clipCircle(radius){var cr=Math.cos(radius),smallRadius=cr>0,notHemisphere=abs(cr)>ε;return d3_geo_clip(visible,function clipLine(listener){var point0,c0,v0,v00,clean;return{lineStart:function(){v00=v0=!1,clean=1},point:function(λ,φ){var point2,point1=[λ,φ],v=visible(λ,φ),c=smallRadius?v?0:code(λ,φ):v?code(λ+(λ<0?π:-π),φ):0;if(!point0&&(v00=v0=v)&&listener.lineStart(),v!==v0&&(point2=intersect(point0,point1),(d3_geo_sphericalEqual(point0,point2)||d3_geo_sphericalEqual(point1,point2))&&(point1[0]+=ε,point1[1]+=ε,v=visible(point1[0],point1[1]))),v!==v0)clean=0,v?(listener.lineStart(),point2=intersect(point1,point0),listener.point(point2[0],point2[1])):(point2=intersect(point0,point1),listener.point(point2[0],point2[1]),listener.lineEnd()),point0=point2;else if(notHemisphere&&point0&&smallRadius^v){var t;c&c0||!(t=intersect(point1,point0,!0))||(clean=0,smallRadius?(listener.lineStart(),listener.point(t[0][0],t[0][1]),listener.point(t[1][0],t[1][1]),listener.lineEnd()):(listener.point(t[1][0],t[1][1]),listener.lineEnd(),listener.lineStart(),listener.point(t[0][0],t[0][1])))}!v||point0&&d3_geo_sphericalEqual(point0,point1)||listener.point(point1[0],point1[1]),point0=point1,v0=v,c0=c},lineEnd:function(){v0&&listener.lineEnd(),point0=null},clean:function(){return clean|(v00&&v0)<<1}}},d3_geo_circleInterpolate(radius,6*d3_radians),smallRadius?[0,-radius]:[-π,radius-π]);function visible(λ,φ){return Math.cos(λ)*Math.cos(φ)>cr}function intersect(a,b,two){var n1=[1,0,0],n2=d3_geo_cartesianCross(d3_geo_cartesian(a),d3_geo_cartesian(b)),n2n2=d3_geo_cartesianDot(n2,n2),n1n2=n2[0],determinant=n2n2-n1n2*n1n2;if(!determinant)return!two&&a;var c1=cr*n2n2/determinant,c2=-cr*n1n2/determinant,n1xn2=d3_geo_cartesianCross(n1,n2),A=d3_geo_cartesianScale(n1,c1);d3_geo_cartesianAdd(A,d3_geo_cartesianScale(n2,c2));var u=n1xn2,w=d3_geo_cartesianDot(A,u),uu=d3_geo_cartesianDot(u,u),t2=w*w-uu*(d3_geo_cartesianDot(A,A)-1);if(!(t2<0)){var t=Math.sqrt(t2),q=d3_geo_cartesianScale(u,(-w-t)/uu);if(d3_geo_cartesianAdd(q,A),q=d3_geo_spherical(q),!two)return q;var z,λ0=a[0],λ1=b[0],φ0=a[1],φ1=b[1];λ1<λ0&&(z=λ0,λ0=λ1,λ1=z);var δλ=λ1-λ0,polar=abs(δλ-π)<ε;if(!polar&&φ1<φ0&&(z=φ0,φ0=φ1,φ1=z),polar||δλ<ε?polar?φ0+φ1>0^q[1]<(abs(q[0]-λ0)<ε?φ0:φ1):φ0<=q[1]&&q[1]<=φ1:δλ>π^(λ0<=q[0]&&q[0]<=λ1)){var q1=d3_geo_cartesianScale(u,(-w+t)/uu);return d3_geo_cartesianAdd(q1,A),[q,d3_geo_spherical(q1)]}}}function code(λ,φ){var r=smallRadius?radius:π-radius,code=0;return λ<-r?code|=1:λ>r&&(code|=2),φ<-r?code|=4:φ>r&&(code|=8),code}}((clipAngle=+_)*d3_radians),invalidate()):clipAngle},projection.clipExtent=function(_){return arguments.length?(clipExtent=_,postclip=_?d3_geo_clipExtent(_[0][0],_[0][1],_[1][0],_[1][1]):d3_identity,invalidate()):clipExtent},projection.scale=function(_){return arguments.length?(k=+_,reset()):k},projection.translate=function(_){return arguments.length?(x=+_[0],y=+_[1],reset()):[x,y]},projection.center=function(_){return arguments.length?(λ=_[0]%360*d3_radians,φ=_[1]%360*d3_radians,reset()):[λ*d3_degrees,φ*d3_degrees]},projection.rotate=function(_){return arguments.length?(δλ=_[0]%360*d3_radians,δφ=_[1]%360*d3_radians,δγ=_.length>2?_[2]%360*d3_radians:0,reset()):[δλ*d3_degrees,δφ*d3_degrees,δγ*d3_degrees]},d3.rebind(projection,projectResample,"precision"),function(){return project=projectAt.apply(this,arguments),projection.invert=project.invert&&invert,reset()}}function d3_geo_projectionRadians(stream){return d3_geo_transformPoint(stream,function(x,y){stream.point(x*d3_radians,y*d3_radians)})}function d3_geo_equirectangular(λ,φ){return[λ,φ]}function d3_geo_identityRotation(λ,φ){return[λ>π?λ-τ:λ<-π?λ+τ:λ,φ]}function d3_geo_rotation(δλ,δφ,δγ){return δλ?δφ||δγ?d3_geo_compose(d3_geo_rotationλ(δλ),d3_geo_rotationφγ(δφ,δγ)):d3_geo_rotationλ(δλ):δφ||δγ?d3_geo_rotationφγ(δφ,δγ):d3_geo_identityRotation}function d3_geo_forwardRotationλ(δλ){return function(λ,φ){return[(λ+=δλ)>π?λ-τ:λ<-π?λ+τ:λ,φ]}}function d3_geo_rotationλ(δλ){var rotation=d3_geo_forwardRotationλ(δλ);return rotation.invert=d3_geo_forwardRotationλ(-δλ),rotation}function d3_geo_rotationφγ(δφ,δγ){var cosδφ=Math.cos(δφ),sinδφ=Math.sin(δφ),cosδγ=Math.cos(δγ),sinδγ=Math.sin(δγ);function rotation(λ,φ){var cosφ=Math.cos(φ),x=Math.cos(λ)*cosφ,y=Math.sin(λ)*cosφ,z=Math.sin(φ),k=z*cosδφ+x*sinδφ;return[Math.atan2(y*cosδγ-k*sinδγ,x*cosδφ-z*sinδφ),d3_asin(k*cosδγ+y*sinδγ)]}return rotation.invert=function(λ,φ){var cosφ=Math.cos(φ),x=Math.cos(λ)*cosφ,y=Math.sin(λ)*cosφ,z=Math.sin(φ),k=z*cosδγ-y*sinδγ;return[Math.atan2(y*cosδγ+z*sinδγ,x*cosδφ+k*sinδφ),d3_asin(k*cosδφ-x*sinδφ)]},rotation}function d3_geo_circleInterpolate(radius,precision){var cr=Math.cos(radius),sr=Math.sin(radius);return function(from,to,direction,listener){var step=direction*precision;null!=from?(from=d3_geo_circleAngle(cr,from),to=d3_geo_circleAngle(cr,to),(direction>0?from<to:from>to)&&(from+=direction*τ)):(from=radius+direction*τ,to=radius-.5*step);for(var point,t=from;direction>0?t>to:t<to;t-=step)listener.point((point=d3_geo_spherical([cr,-sr*Math.cos(t),-sr*Math.sin(t)]))[0],point[1])}}function d3_geo_circleAngle(cr,point){var a=d3_geo_cartesian(point);a[0]-=cr,d3_geo_cartesianNormalize(a);var angle=d3_acos(-a[1]);return((-a[2]<0?-angle:angle)+2*Math.PI-ε)%(2*Math.PI)}function d3_geo_graticuleX(y0,y1,dy){var y=d3.range(y0,y1-ε,dy).concat(y1);return function(x){return y.map(function(y){return[x,y]})}}function d3_geo_graticuleY(x0,x1,dx){var x=d3.range(x0,x1-ε,dx).concat(x1);return function(y){return x.map(function(x){return[x,y]})}}function d3_source(d){return d.source}function d3_target(d){return d.target}d3.geo.path=function(){var projection,context,projectStream,contextStream,cacheStream,pointRadius=4.5;function path(object){return object&&("function"==typeof pointRadius&&contextStream.pointRadius(+pointRadius.apply(this,arguments)),cacheStream&&cacheStream.valid||(cacheStream=projectStream(contextStream)),d3.geo.stream(object,cacheStream)),contextStream.result()}function reset(){return cacheStream=null,path}return path.area=function(object){return d3_geo_pathAreaSum=0,d3.geo.stream(object,projectStream(d3_geo_pathArea)),d3_geo_pathAreaSum},path.centroid=function(object){return d3_geo_centroidX0=d3_geo_centroidY0=d3_geo_centroidZ0=d3_geo_centroidX1=d3_geo_centroidY1=d3_geo_centroidZ1=d3_geo_centroidX2=d3_geo_centroidY2=d3_geo_centroidZ2=0,d3.geo.stream(object,projectStream(d3_geo_pathCentroid)),d3_geo_centroidZ2?[d3_geo_centroidX2/d3_geo_centroidZ2,d3_geo_centroidY2/d3_geo_centroidZ2]:d3_geo_centroidZ1?[d3_geo_centroidX1/d3_geo_centroidZ1,d3_geo_centroidY1/d3_geo_centroidZ1]:d3_geo_centroidZ0?[d3_geo_centroidX0/d3_geo_centroidZ0,d3_geo_centroidY0/d3_geo_centroidZ0]:[NaN,NaN]},path.bounds=function(object){return d3_geo_pathBoundsX1=d3_geo_pathBoundsY1=-(d3_geo_pathBoundsX0=d3_geo_pathBoundsY0=1/0),d3.geo.stream(object,projectStream(d3_geo_pathBounds)),[[d3_geo_pathBoundsX0,d3_geo_pathBoundsY0],[d3_geo_pathBoundsX1,d3_geo_pathBoundsY1]]},path.projection=function(_){return arguments.length?(projectStream=(projection=_)?_.stream||function d3_geo_pathProjectStream(project){var resample=d3_geo_resample(function(x,y){return project([x*d3_degrees,y*d3_degrees])});return function(stream){return d3_geo_projectionRadians(resample(stream))}}(_):d3_identity,reset()):projection},path.context=function(_){return arguments.length?(contextStream=null==(context=_)?new function d3_geo_pathBuffer(){var pointCircle=d3_geo_pathBufferCircle(4.5),buffer=[],stream={point:point,lineStart:function(){stream.point=pointLineStart},lineEnd:lineEnd,polygonStart:function(){stream.lineEnd=lineEndPolygon},polygonEnd:function(){stream.lineEnd=lineEnd,stream.point=point},pointRadius:function(_){return pointCircle=d3_geo_pathBufferCircle(_),stream},result:function(){if(buffer.length){var result=buffer.join("");return buffer=[],result}}};function point(x,y){buffer.push("M",x,",",y,pointCircle)}function pointLineStart(x,y){buffer.push("M",x,",",y),stream.point=pointLine}function pointLine(x,y){buffer.push("L",x,",",y)}function lineEnd(){stream.point=point}function lineEndPolygon(){buffer.push("Z")}return stream}:new function d3_geo_pathContext(context){var pointRadius=4.5,stream={point:point,lineStart:function(){stream.point=pointLineStart},lineEnd:lineEnd,polygonStart:function(){stream.lineEnd=lineEndPolygon},polygonEnd:function(){stream.lineEnd=lineEnd,stream.point=point},pointRadius:function(_){return pointRadius=_,stream},result:d3_noop};function point(x,y){context.moveTo(x+pointRadius,y),context.arc(x,y,pointRadius,0,τ)}function pointLineStart(x,y){context.moveTo(x,y),stream.point=pointLine}function pointLine(x,y){context.lineTo(x,y)}function lineEnd(){stream.point=point}function lineEndPolygon(){context.closePath()}return stream}(_),"function"!=typeof pointRadius&&contextStream.pointRadius(pointRadius),reset()):context},path.pointRadius=function(_){return arguments.length?(pointRadius="function"==typeof _?_:(contextStream.pointRadius(+_),+_),path):pointRadius},path.projection(d3.geo.albersUsa()).context(null)},d3.geo.transform=function(methods){return{stream:function(stream){var transform=new d3_geo_transform(stream);for(var k in methods)transform[k]=methods[k];return transform}}},d3_geo_transform.prototype={point:function(x,y){this.stream.point(x,y)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},d3.geo.projection=d3_geo_projection,d3.geo.projectionMutator=d3_geo_projectionMutator,(d3.geo.equirectangular=function(){return d3_geo_projection(d3_geo_equirectangular)}).raw=d3_geo_equirectangular.invert=d3_geo_equirectangular,d3.geo.rotation=function(rotate){function forward(coordinates){return(coordinates=rotate(coordinates[0]*d3_radians,coordinates[1]*d3_radians))[0]*=d3_degrees,coordinates[1]*=d3_degrees,coordinates}return rotate=d3_geo_rotation(rotate[0]%360*d3_radians,rotate[1]*d3_radians,rotate.length>2?rotate[2]*d3_radians:0),forward.invert=function(coordinates){return(coordinates=rotate.invert(coordinates[0]*d3_radians,coordinates[1]*d3_radians))[0]*=d3_degrees,coordinates[1]*=d3_degrees,coordinates},forward},d3_geo_identityRotation.invert=d3_geo_equirectangular,d3.geo.circle=function(){var angle,interpolate,origin=[0,0],precision=6;function circle(){var center="function"==typeof origin?origin.apply(this,arguments):origin,rotate=d3_geo_rotation(-center[0]*d3_radians,-center[1]*d3_radians,0).invert,ring=[];return interpolate(null,null,1,{point:function(x,y){ring.push(x=rotate(x,y)),x[0]*=d3_degrees,x[1]*=d3_degrees}}),{type:"Polygon",coordinates:[ring]}}return circle.origin=function(x){return arguments.length?(origin=x,circle):origin},circle.angle=function(x){return arguments.length?(interpolate=d3_geo_circleInterpolate((angle=+x)*d3_radians,precision*d3_radians),circle):angle},circle.precision=function(_){return arguments.length?(interpolate=d3_geo_circleInterpolate(angle*d3_radians,(precision=+_)*d3_radians),circle):precision},circle.angle(90)},d3.geo.distance=function(a,b){var t,Δλ=(b[0]-a[0])*d3_radians,φ0=a[1]*d3_radians,φ1=b[1]*d3_radians,sinΔλ=Math.sin(Δλ),cosΔλ=Math.cos(Δλ),sinφ0=Math.sin(φ0),cosφ0=Math.cos(φ0),sinφ1=Math.sin(φ1),cosφ1=Math.cos(φ1);return Math.atan2(Math.sqrt((t=cosφ1*sinΔλ)*t+(t=cosφ0*sinφ1-sinφ0*cosφ1*cosΔλ)*t),sinφ0*sinφ1+cosφ0*cosφ1*cosΔλ)},d3.geo.graticule=function(){var x1,x0,X1,X0,y1,y0,Y1,Y0,x,y,X,Y,dx=10,dy=dx,DX=90,DY=360,precision=2.5;function graticule(){return{type:"MultiLineString",coordinates:lines()}}function lines(){return d3.range(Math.ceil(X0/DX)*DX,X1,DX).map(X).concat(d3.range(Math.ceil(Y0/DY)*DY,Y1,DY).map(Y)).concat(d3.range(Math.ceil(x0/dx)*dx,x1,dx).filter(function(x){return abs(x%DX)>ε}).map(x)).concat(d3.range(Math.ceil(y0/dy)*dy,y1,dy).filter(function(y){return abs(y%DY)>ε}).map(y))}return graticule.lines=function(){return lines().map(function(coordinates){return{type:"LineString",coordinates:coordinates}})},graticule.outline=function(){return{type:"Polygon",coordinates:[X(X0).concat(Y(Y1).slice(1),X(X1).reverse().slice(1),Y(Y0).reverse().slice(1))]}},graticule.extent=function(_){return arguments.length?graticule.majorExtent(_).minorExtent(_):graticule.minorExtent()},graticule.majorExtent=function(_){return arguments.length?(X0=+_[0][0],X1=+_[1][0],Y0=+_[0][1],Y1=+_[1][1],X0>X1&&(_=X0,X0=X1,X1=_),Y0>Y1&&(_=Y0,Y0=Y1,Y1=_),graticule.precision(precision)):[[X0,Y0],[X1,Y1]]},graticule.minorExtent=function(_){return arguments.length?(x0=+_[0][0],x1=+_[1][0],y0=+_[0][1],y1=+_[1][1],x0>x1&&(_=x0,x0=x1,x1=_),y0>y1&&(_=y0,y0=y1,y1=_),graticule.precision(precision)):[[x0,y0],[x1,y1]]},graticule.step=function(_){return arguments.length?graticule.majorStep(_).minorStep(_):graticule.minorStep()},graticule.majorStep=function(_){return arguments.length?(DX=+_[0],DY=+_[1],graticule):[DX,DY]},graticule.minorStep=function(_){return arguments.length?(dx=+_[0],dy=+_[1],graticule):[dx,dy]},graticule.precision=function(_){return arguments.length?(precision=+_,x=d3_geo_graticuleX(y0,y1,90),y=d3_geo_graticuleY(x0,x1,precision),X=d3_geo_graticuleX(Y0,Y1,90),Y=d3_geo_graticuleY(X0,X1,precision),graticule):precision},graticule.majorExtent([[-180,-90+ε],[180,90-ε]]).minorExtent([[-180,-80-ε],[180,80+ε]])},d3.geo.greatArc=function(){var source_,target_,source=d3_source,target=d3_target;function greatArc(){return{type:"LineString",coordinates:[source_||source.apply(this,arguments),target_||target.apply(this,arguments)]}}return greatArc.distance=function(){return d3.geo.distance(source_||source.apply(this,arguments),target_||target.apply(this,arguments))},greatArc.source=function(_){return arguments.length?(source=_,source_="function"==typeof _?null:_,greatArc):source},greatArc.target=function(_){return arguments.length?(target=_,target_="function"==typeof _?null:_,greatArc):target},greatArc.precision=function(){return arguments.length?greatArc:0},greatArc},d3.geo.interpolate=function(source,target){return function d3_geo_interpolate(x0,y0,x1,y1){var cy0=Math.cos(y0),sy0=Math.sin(y0),cy1=Math.cos(y1),sy1=Math.sin(y1),kx0=cy0*Math.cos(x0),ky0=cy0*Math.sin(x0),kx1=cy1*Math.cos(x1),ky1=cy1*Math.sin(x1),d=2*Math.asin(Math.sqrt(d3_haversin(y1-y0)+cy0*cy1*d3_haversin(x1-x0))),k=1/Math.sin(d),interpolate=d?function(t){var B=Math.sin(t*=d)*k,A=Math.sin(d-t)*k,x=A*kx0+B*kx1,y=A*ky0+B*ky1,z=A*sy0+B*sy1;return[Math.atan2(y,x)*d3_degrees,Math.atan2(z,Math.sqrt(x*x+y*y))*d3_degrees]}:function(){return[x0*d3_degrees,y0*d3_degrees]};return interpolate.distance=d,interpolate}(source[0]*d3_radians,source[1]*d3_radians,target[0]*d3_radians,target[1]*d3_radians)},d3.geo.length=function(object){return d3_geo_lengthSum=0,d3.geo.stream(object,d3_geo_length),d3_geo_lengthSum};var d3_geo_length={sphere:d3_noop,point:d3_noop,lineStart:function d3_geo_lengthLineStart(){var λ0,sinφ0,cosφ0;function nextPoint(λ,φ){var sinφ=Math.sin(φ*=d3_radians),cosφ=Math.cos(φ),t=abs((λ*=d3_radians)-λ0),cosΔλ=Math.cos(t);d3_geo_lengthSum+=Math.atan2(Math.sqrt((t=cosφ*Math.sin(t))*t+(t=cosφ0*sinφ-sinφ0*cosφ*cosΔλ)*t),sinφ0*sinφ+cosφ0*cosφ*cosΔλ),λ0=λ,sinφ0=sinφ,cosφ0=cosφ}d3_geo_length.point=function(λ,φ){λ0=λ*d3_radians,sinφ0=Math.sin(φ*=d3_radians),cosφ0=Math.cos(φ),d3_geo_length.point=nextPoint},d3_geo_length.lineEnd=function(){d3_geo_length.point=d3_geo_length.lineEnd=d3_noop}},lineEnd:d3_noop,polygonStart:d3_noop,polygonEnd:d3_noop};function d3_geo_azimuthal(scale,angle){function azimuthal(λ,φ){var cosλ=Math.cos(λ),cosφ=Math.cos(φ),k=scale(cosλ*cosφ);return[k*cosφ*Math.sin(λ),k*Math.sin(φ)]}return azimuthal.invert=function(x,y){var ρ=Math.sqrt(x*x+y*y),c=angle(ρ),sinc=Math.sin(c),cosc=Math.cos(c);return[Math.atan2(x*sinc,ρ*cosc),Math.asin(ρ&&y*sinc/ρ)]},azimuthal}var d3_geo_azimuthalEqualArea=d3_geo_azimuthal(function(cosλcosφ){return Math.sqrt(2/(1+cosλcosφ))},function(ρ){return 2*Math.asin(ρ/2)});(d3.geo.azimuthalEqualArea=function(){return d3_geo_projection(d3_geo_azimuthalEqualArea)}).raw=d3_geo_azimuthalEqualArea;var d3_geo_azimuthalEquidistant=d3_geo_azimuthal(function(cosλcosφ){var c=Math.acos(cosλcosφ);return c&&c/Math.sin(c)},d3_identity);function d3_geo_conicConformal(φ0,φ1){var cosφ0=Math.cos(φ0),t=function(φ){return Math.tan(π/4+φ/2)},n=φ0===φ1?Math.sin(φ0):Math.log(cosφ0/Math.cos(φ1))/Math.log(t(φ1)/t(φ0)),F=cosφ0*Math.pow(t(φ0),n)/n;if(!n)return d3_geo_mercator;function forward(λ,φ){F>0?φ<-halfπ+ε&&(φ=-halfπ+ε):φ>halfπ-ε&&(φ=halfπ-ε);var ρ=F/Math.pow(t(φ),n);return[ρ*Math.sin(n*λ),F-ρ*Math.cos(n*λ)]}return forward.invert=function(x,y){var ρ0_y=F-y,ρ=d3_sgn(n)*Math.sqrt(x*x+ρ0_y*ρ0_y);return[Math.atan2(x,ρ0_y)/n,2*Math.atan(Math.pow(F/ρ,1/n))-halfπ]},forward}function d3_geo_conicEquidistant(φ0,φ1){var cosφ0=Math.cos(φ0),n=φ0===φ1?Math.sin(φ0):(cosφ0-Math.cos(φ1))/(φ1-φ0),G=cosφ0/n+φ0;if(abs(n)<ε)return d3_geo_equirectangular;function forward(λ,φ){var ρ=G-φ;return[ρ*Math.sin(n*λ),G-ρ*Math.cos(n*λ)]}return forward.invert=function(x,y){var ρ0_y=G-y;return[Math.atan2(x,ρ0_y)/n,G-d3_sgn(n)*Math.sqrt(x*x+ρ0_y*ρ0_y)]},forward}(d3.geo.azimuthalEquidistant=function(){return d3_geo_projection(d3_geo_azimuthalEquidistant)}).raw=d3_geo_azimuthalEquidistant,(d3.geo.conicConformal=function(){return d3_geo_conic(d3_geo_conicConformal)}).raw=d3_geo_conicConformal,(d3.geo.conicEquidistant=function(){return d3_geo_conic(d3_geo_conicEquidistant)}).raw=d3_geo_conicEquidistant;var d3_geo_gnomonic=d3_geo_azimuthal(function(cosλcosφ){return 1/cosλcosφ},Math.atan);function d3_geo_mercator(λ,φ){return[λ,Math.log(Math.tan(π/4+φ/2))]}function d3_geo_mercatorProjection(project){var clipAuto,m=d3_geo_projection(project),scale=m.scale,translate=m.translate,clipExtent=m.clipExtent;return m.scale=function(){var v=scale.apply(m,arguments);return v===m?clipAuto?m.clipExtent(null):m:v},m.translate=function(){var v=translate.apply(m,arguments);return v===m?clipAuto?m.clipExtent(null):m:v},m.clipExtent=function(_){var v=clipExtent.apply(m,arguments);if(v===m){if(clipAuto=null==_){var k=π*scale(),t=translate();clipExtent([[t[0]-k,t[1]-k],[t[0]+k,t[1]+k]])}}else clipAuto&&(v=null);return v},m.clipExtent(null)}(d3.geo.gnomonic=function(){return d3_geo_projection(d3_geo_gnomonic)}).raw=d3_geo_gnomonic,d3_geo_mercator.invert=function(x,y){return[x,2*Math.atan(Math.exp(y))-halfπ]},(d3.geo.mercator=function(){return d3_geo_mercatorProjection(d3_geo_mercator)}).raw=d3_geo_mercator;var d3_geo_orthographic=d3_geo_azimuthal(function(){return 1},Math.asin);(d3.geo.orthographic=function(){return d3_geo_projection(d3_geo_orthographic)}).raw=d3_geo_orthographic;var d3_geo_stereographic=d3_geo_azimuthal(function(cosλcosφ){return 1/(1+cosλcosφ)},function(ρ){return 2*Math.atan(ρ)});function d3_geo_transverseMercator(λ,φ){return[Math.log(Math.tan(π/4+φ/2)),-λ]}function d3_geom_pointX(d){return d[0]}function d3_geom_pointY(d){return d[1]}function d3_geom_hullUpper(points){for(var n=points.length,hull=[0,1],hs=2,i=2;i<n;i++){for(;hs>1&&d3_cross2d(points[hull[hs-2]],points[hull[hs-1]],points[i])<=0;)--hs;hull[hs++]=i}return hull.slice(0,hs)}function d3_geom_hullOrder(a,b){return a[0]-b[0]||a[1]-b[1]}(d3.geo.stereographic=function(){return d3_geo_projection(d3_geo_stereographic)}).raw=d3_geo_stereographic,d3_geo_transverseMercator.invert=function(x,y){return[-y,2*Math.atan(Math.exp(x))-halfπ]},(d3.geo.transverseMercator=function(){var projection=d3_geo_mercatorProjection(d3_geo_transverseMercator),center=projection.center,rotate=projection.rotate;return projection.center=function(_){return _?center([-_[1],_[0]]):[(_=center())[1],-_[0]]},projection.rotate=function(_){return _?rotate([_[0],_[1],_.length>2?_[2]+90:90]):[(_=rotate())[0],_[1],_[2]-90]},rotate([0,0,90])}).raw=d3_geo_transverseMercator,d3.geom={},d3.geom.hull=function(vertices){var x=d3_geom_pointX,y=d3_geom_pointY;if(arguments.length)return hull(vertices);function hull(data){if(data.length<3)return[];var i,fx=d3_functor(x),fy=d3_functor(y),n=data.length,points=[],flippedPoints=[];for(i=0;i<n;i++)points.push([+fx.call(this,data[i],i),+fy.call(this,data[i],i),i]);for(points.sort(d3_geom_hullOrder),i=0;i<n;i++)flippedPoints.push([points[i][0],-points[i][1]]);var upper=d3_geom_hullUpper(points),lower=d3_geom_hullUpper(flippedPoints),skipLeft=lower[0]===upper[0],skipRight=lower[lower.length-1]===upper[upper.length-1],polygon=[];for(i=upper.length-1;i>=0;--i)polygon.push(data[points[upper[i]][2]]);for(i=+skipLeft;i<lower.length-skipRight;++i)polygon.push(data[points[lower[i]][2]]);return polygon}return hull.x=function(_){return arguments.length?(x=_,hull):x},hull.y=function(_){return arguments.length?(y=_,hull):y},hull},d3.geom.polygon=function(coordinates){return d3_subclass(coordinates,d3_geom_polygonPrototype),coordinates};var d3_geom_polygonPrototype=d3.geom.polygon.prototype=[];function d3_geom_polygonInside(p,a,b){return(b[0]-a[0])*(p[1]-a[1])<(b[1]-a[1])*(p[0]-a[0])}function d3_geom_polygonIntersect(c,d,a,b){var x1=c[0],x3=a[0],x21=d[0]-x1,x43=b[0]-x3,y1=c[1],y3=a[1],y21=d[1]-y1,y43=b[1]-y3,ua=(x43*(y1-y3)-y43*(x1-x3))/(y43*x21-x43*y21);return[x1+ua*x21,y1+ua*y21]}function d3_geom_polygonClosed(coordinates){var a=coordinates[0],b=coordinates[coordinates.length-1];return!(a[0]-b[0]||a[1]-b[1])}d3_geom_polygonPrototype.area=function(){for(var a,i=-1,n=this.length,b=this[n-1],area=0;++i<n;)a=b,b=this[i],area+=a[1]*b[0]-a[0]*b[1];return.5*area},d3_geom_polygonPrototype.centroid=function(k){var a,c,i=-1,n=this.length,x=0,y=0,b=this[n-1];for(arguments.length||(k=-1/(6*this.area()));++i<n;)a=b,b=this[i],c=a[0]*b[1]-b[0]*a[1],x+=(a[0]+b[0])*c,y+=(a[1]+b[1])*c;return[x*k,y*k]},d3_geom_polygonPrototype.clip=function(subject){for(var input,j,m,b,c,d,closed=d3_geom_polygonClosed(subject),i=-1,n=this.length-d3_geom_polygonClosed(this),a=this[n-1];++i<n;){for(input=subject.slice(),subject.length=0,b=this[i],c=input[(m=input.length-closed)-1],j=-1;++j<m;)d3_geom_polygonInside(d=input[j],a,b)?(d3_geom_polygonInside(c,a,b)||subject.push(d3_geom_polygonIntersect(c,d,a,b)),subject.push(d)):d3_geom_polygonInside(c,a,b)&&subject.push(d3_geom_polygonIntersect(c,d,a,b)),c=d;closed&&subject.push(subject[0]),a=b}return subject};var d3_geom_voronoiEdges,d3_geom_voronoiCells,d3_geom_voronoiBeaches,d3_geom_voronoiFirstCircle,d3_geom_voronoiCircles,d3_geom_voronoiBeachPool=[],d3_geom_voronoiCirclePool=[];function d3_geom_voronoiCreateBeach(site){var beach=d3_geom_voronoiBeachPool.pop()||new function d3_geom_voronoiBeach(){d3_geom_voronoiRedBlackNode(this),this.edge=this.site=this.circle=null};return beach.site=site,beach}function d3_geom_voronoiDetachBeach(beach){d3_geom_voronoiDetachCircle(beach),d3_geom_voronoiBeaches.remove(beach),d3_geom_voronoiBeachPool.push(beach),d3_geom_voronoiRedBlackNode(beach)}function d3_geom_voronoiRemoveBeach(beach){var circle=beach.circle,x=circle.x,y=circle.cy,vertex={x:x,y:y},previous=beach.P,next=beach.N,disappearing=[beach];d3_geom_voronoiDetachBeach(beach);for(var lArc=previous;lArc.circle&&abs(x-lArc.circle.x)<ε&&abs(y-lArc.circle.cy)<ε;)previous=lArc.P,disappearing.unshift(lArc),d3_geom_voronoiDetachBeach(lArc),lArc=previous;disappearing.unshift(lArc),d3_geom_voronoiDetachCircle(lArc);for(var rArc=next;rArc.circle&&abs(x-rArc.circle.x)<ε&&abs(y-rArc.circle.cy)<ε;)next=rArc.N,disappearing.push(rArc),d3_geom_voronoiDetachBeach(rArc),rArc=next;disappearing.push(rArc),d3_geom_voronoiDetachCircle(rArc);var iArc,nArcs=disappearing.length;for(iArc=1;iArc<nArcs;++iArc)rArc=disappearing[iArc],lArc=disappearing[iArc-1],d3_geom_voronoiSetEdgeEnd(rArc.edge,lArc.site,rArc.site,vertex);lArc=disappearing[0],(rArc=disappearing[nArcs-1]).edge=d3_geom_voronoiCreateEdge(lArc.site,rArc.site,null,vertex),d3_geom_voronoiAttachCircle(lArc),d3_geom_voronoiAttachCircle(rArc)}function d3_geom_voronoiAddBeach(site){for(var lArc,rArc,dxl,dxr,x=site.x,directrix=site.y,node=d3_geom_voronoiBeaches._;node;)if((dxl=d3_geom_voronoiLeftBreakPoint(node,directrix)-x)>ε)node=node.L;else{if(!((dxr=x-d3_geom_voronoiRightBreakPoint(node,directrix))>ε)){dxl>-ε?(lArc=node.P,rArc=node):dxr>-ε?(lArc=node,rArc=node.N):lArc=rArc=node;break}if(!node.R){lArc=node;break}node=node.R}var newArc=d3_geom_voronoiCreateBeach(site);if(d3_geom_voronoiBeaches.insert(lArc,newArc),lArc||rArc){if(lArc===rArc)return d3_geom_voronoiDetachCircle(lArc),rArc=d3_geom_voronoiCreateBeach(lArc.site),d3_geom_voronoiBeaches.insert(newArc,rArc),newArc.edge=rArc.edge=d3_geom_voronoiCreateEdge(lArc.site,newArc.site),d3_geom_voronoiAttachCircle(lArc),void d3_geom_voronoiAttachCircle(rArc);if(rArc){d3_geom_voronoiDetachCircle(lArc),d3_geom_voronoiDetachCircle(rArc);var lSite=lArc.site,ax=lSite.x,ay=lSite.y,bx=site.x-ax,by=site.y-ay,rSite=rArc.site,cx=rSite.x-ax,cy=rSite.y-ay,d=2*(bx*cy-by*cx),hb=bx*bx+by*by,hc=cx*cx+cy*cy,vertex={x:(cy*hb-by*hc)/d+ax,y:(bx*hc-cx*hb)/d+ay};d3_geom_voronoiSetEdgeEnd(rArc.edge,lSite,rSite,vertex),newArc.edge=d3_geom_voronoiCreateEdge(lSite,site,null,vertex),rArc.edge=d3_geom_voronoiCreateEdge(site,rSite,null,vertex),d3_geom_voronoiAttachCircle(lArc),d3_geom_voronoiAttachCircle(rArc)}else newArc.edge=d3_geom_voronoiCreateEdge(lArc.site,newArc.site)}}function d3_geom_voronoiLeftBreakPoint(arc,directrix){var site=arc.site,rfocx=site.x,rfocy=site.y,pby2=rfocy-directrix;if(!pby2)return rfocx;var lArc=arc.P;if(!lArc)return-1/0;var lfocx=(site=lArc.site).x,lfocy=site.y,plby2=lfocy-directrix;if(!plby2)return lfocx;var hl=lfocx-rfocx,aby2=1/pby2-1/plby2,b=hl/plby2;return aby2?(-b+Math.sqrt(b*b-2*aby2*(hl*hl/(-2*plby2)-lfocy+plby2/2+rfocy-pby2/2)))/aby2+rfocx:(rfocx+lfocx)/2}function d3_geom_voronoiRightBreakPoint(arc,directrix){var rArc=arc.N;if(rArc)return d3_geom_voronoiLeftBreakPoint(rArc,directrix);var site=arc.site;return site.y===directrix?site.x:1/0}function d3_geom_voronoiCell(site){this.site=site,this.edges=[]}function d3_geom_voronoiHalfEdgeOrder(a,b){return b.angle-a.angle}function d3_geom_voronoiAttachCircle(arc){var lArc=arc.P,rArc=arc.N;if(lArc&&rArc){var lSite=lArc.site,cSite=arc.site,rSite=rArc.site;if(lSite!==rSite){var bx=cSite.x,by=cSite.y,ax=lSite.x-bx,ay=lSite.y-by,cx=rSite.x-bx,d=2*(ax*(cy=rSite.y-by)-ay*cx);if(!(d>=-ε2)){var ha=ax*ax+ay*ay,hc=cx*cx+cy*cy,x=(cy*ha-ay*hc)/d,y=(ax*hc-cx*ha)/d,cy=y+by,circle=d3_geom_voronoiCirclePool.pop()||new function d3_geom_voronoiCircle(){d3_geom_voronoiRedBlackNode(this),this.x=this.y=this.arc=this.site=this.cy=null};circle.arc=arc,circle.site=cSite,circle.x=x+bx,circle.y=cy+Math.sqrt(x*x+y*y),circle.cy=cy,arc.circle=circle;for(var before=null,node=d3_geom_voronoiCircles._;node;)if(circle.y<node.y||circle.y===node.y&&circle.x<=node.x){if(!node.L){before=node.P;break}node=node.L}else{if(!node.R){before=node;break}node=node.R}d3_geom_voronoiCircles.insert(before,circle),before||(d3_geom_voronoiFirstCircle=circle)}}}}function d3_geom_voronoiDetachCircle(arc){var circle=arc.circle;circle&&(circle.P||(d3_geom_voronoiFirstCircle=circle.N),d3_geom_voronoiCircles.remove(circle),d3_geom_voronoiCirclePool.push(circle),d3_geom_voronoiRedBlackNode(circle),arc.circle=null)}function d3_geom_voronoiConnectEdge(edge,extent){var vb=edge.b;if(vb)return!0;var fm,fb,va=edge.a,x0=extent[0][0],x1=extent[1][0],y0=extent[0][1],y1=extent[1][1],lSite=edge.l,rSite=edge.r,lx=lSite.x,ly=lSite.y,rx=rSite.x,ry=rSite.y,fx=(lx+rx)/2,fy=(ly+ry)/2;if(ry===ly){if(fx<x0||fx>=x1)return;if(lx>rx){if(va){if(va.y>=y1)return}else va={x:fx,y:y0};vb={x:fx,y:y1}}else{if(va){if(va.y<y0)return}else va={x:fx,y:y1};vb={x:fx,y:y0}}}else if(fb=fy-(fm=(lx-rx)/(ry-ly))*fx,fm<-1||fm>1)if(lx>rx){if(va){if(va.y>=y1)return}else va={x:(y0-fb)/fm,y:y0};vb={x:(y1-fb)/fm,y:y1}}else{if(va){if(va.y<y0)return}else va={x:(y1-fb)/fm,y:y1};vb={x:(y0-fb)/fm,y:y0}}else if(ly<ry){if(va){if(va.x>=x1)return}else va={x:x0,y:fm*x0+fb};vb={x:x1,y:fm*x1+fb}}else{if(va){if(va.x<x0)return}else va={x:x1,y:fm*x1+fb};vb={x:x0,y:fm*x0+fb}}return edge.a=va,edge.b=vb,!0}function d3_geom_voronoiEdge(lSite,rSite){this.l=lSite,this.r=rSite,this.a=this.b=null}function d3_geom_voronoiCreateEdge(lSite,rSite,va,vb){var edge=new d3_geom_voronoiEdge(lSite,rSite);return d3_geom_voronoiEdges.push(edge),va&&d3_geom_voronoiSetEdgeEnd(edge,lSite,rSite,va),vb&&d3_geom_voronoiSetEdgeEnd(edge,rSite,lSite,vb),d3_geom_voronoiCells[lSite.i].edges.push(new d3_geom_voronoiHalfEdge(edge,lSite,rSite)),d3_geom_voronoiCells[rSite.i].edges.push(new d3_geom_voronoiHalfEdge(edge,rSite,lSite)),edge}function d3_geom_voronoiSetEdgeEnd(edge,lSite,rSite,vertex){edge.a||edge.b?edge.l===rSite?edge.b=vertex:edge.a=vertex:(edge.a=vertex,edge.l=lSite,edge.r=rSite)}function d3_geom_voronoiHalfEdge(edge,lSite,rSite){var va=edge.a,vb=edge.b;this.edge=edge,this.site=lSite,this.angle=rSite?Math.atan2(rSite.y-lSite.y,rSite.x-lSite.x):edge.l===lSite?Math.atan2(vb.x-va.x,va.y-vb.y):Math.atan2(va.x-vb.x,vb.y-va.y)}function d3_geom_voronoiRedBlackTree(){this._=null}function d3_geom_voronoiRedBlackNode(node){node.U=node.C=node.L=node.R=node.P=node.N=null}function d3_geom_voronoiRedBlackRotateLeft(tree,node){var p=node,q=node.R,parent=p.U;parent?parent.L===p?parent.L=q:parent.R=q:tree._=q,q.U=parent,p.U=q,p.R=q.L,p.R&&(p.R.U=p),q.L=p}function d3_geom_voronoiRedBlackRotateRight(tree,node){var p=node,q=node.L,parent=p.U;parent?parent.L===p?parent.L=q:parent.R=q:tree._=q,q.U=parent,p.U=q,p.L=q.R,p.L&&(p.L.U=p),q.R=p}function d3_geom_voronoiRedBlackFirst(node){for(;node.L;)node=node.L;return node}function d3_geom_voronoi(sites,bbox){var x0,y0,circle,site=sites.sort(d3_geom_voronoiVertexOrder).pop();for(d3_geom_voronoiEdges=[],d3_geom_voronoiCells=new Array(sites.length),d3_geom_voronoiBeaches=new d3_geom_voronoiRedBlackTree,d3_geom_voronoiCircles=new d3_geom_voronoiRedBlackTree;;)if(circle=d3_geom_voronoiFirstCircle,site&&(!circle||site.y<circle.y||site.y===circle.y&&site.x<circle.x))site.x===x0&&site.y===y0||(d3_geom_voronoiCells[site.i]=new d3_geom_voronoiCell(site),d3_geom_voronoiAddBeach(site),x0=site.x,y0=site.y),site=sites.pop();else{if(!circle)break;d3_geom_voronoiRemoveBeach(circle.arc)}bbox&&(function d3_geom_voronoiClipEdges(extent){for(var e,edges=d3_geom_voronoiEdges,clip=d3_geom_clipLine(extent[0][0],extent[0][1],extent[1][0],extent[1][1]),i=edges.length;i--;)(!d3_geom_voronoiConnectEdge(e=edges[i],extent)||!clip(e)||abs(e.a.x-e.b.x)<ε&&abs(e.a.y-e.b.y)<ε)&&(e.a=e.b=null,edges.splice(i,1))}(bbox),function d3_geom_voronoiCloseCells(extent){for(var x2,y2,x3,y3,cell,iHalfEdge,halfEdges,nHalfEdges,start,end,x0=extent[0][0],x1=extent[1][0],y0=extent[0][1],y1=extent[1][1],cells=d3_geom_voronoiCells,iCell=cells.length;iCell--;)if((cell=cells[iCell])&&cell.prepare())for(nHalfEdges=(halfEdges=cell.edges).length,iHalfEdge=0;iHalfEdge<nHalfEdges;)x3=(end=halfEdges[iHalfEdge].end()).x,y3=end.y,x2=(start=halfEdges[++iHalfEdge%nHalfEdges].start()).x,y2=start.y,(abs(x3-x2)>ε||abs(y3-y2)>ε)&&(halfEdges.splice(iHalfEdge,0,new d3_geom_voronoiHalfEdge((lSite=cell.site,va=end,vb=abs(x3-x0)<ε&&y1-y3>ε?{x:x0,y:abs(x2-x0)<ε?y2:y1}:abs(y3-y1)<ε&&x1-x3>ε?{x:abs(y2-y1)<ε?x2:x1,y:y1}:abs(x3-x1)<ε&&y3-y0>ε?{x:x1,y:abs(x2-x1)<ε?y2:y0}:abs(y3-y0)<ε&&x3-x0>ε?{x:abs(y2-y0)<ε?x2:x0,y:y0}:null,edge=void 0,edge=new d3_geom_voronoiEdge(lSite,null),edge.a=va,edge.b=vb,d3_geom_voronoiEdges.push(edge),edge),cell.site,null)),++nHalfEdges);var lSite,va,vb,edge}(bbox));var diagram={cells:d3_geom_voronoiCells,edges:d3_geom_voronoiEdges};return d3_geom_voronoiBeaches=d3_geom_voronoiCircles=d3_geom_voronoiEdges=d3_geom_voronoiCells=null,diagram}function d3_geom_voronoiVertexOrder(a,b){return b.y-a.y||b.x-a.x}d3_geom_voronoiCell.prototype.prepare=function(){for(var edge,halfEdges=this.edges,iHalfEdge=halfEdges.length;iHalfEdge--;)(edge=halfEdges[iHalfEdge].edge).b&&edge.a||halfEdges.splice(iHalfEdge,1);return halfEdges.sort(d3_geom_voronoiHalfEdgeOrder),halfEdges.length},d3_geom_voronoiHalfEdge.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},d3_geom_voronoiRedBlackTree.prototype={insert:function(after,node){var parent,grandpa,uncle;if(after){if(node.P=after,node.N=after.N,after.N&&(after.N.P=node),after.N=node,after.R){for(after=after.R;after.L;)after=after.L;after.L=node}else after.R=node;parent=after}else this._?(after=d3_geom_voronoiRedBlackFirst(this._),node.P=null,node.N=after,after.P=after.L=node,parent=after):(node.P=node.N=null,this._=node,parent=null);for(node.L=node.R=null,node.U=parent,node.C=!0,after=node;parent&&parent.C;)parent===(grandpa=parent.U).L?(uncle=grandpa.R)&&uncle.C?(parent.C=uncle.C=!1,grandpa.C=!0,after=grandpa):(after===parent.R&&(d3_geom_voronoiRedBlackRotateLeft(this,parent),parent=(after=parent).U),parent.C=!1,grandpa.C=!0,d3_geom_voronoiRedBlackRotateRight(this,grandpa)):(uncle=grandpa.L)&&uncle.C?(parent.C=uncle.C=!1,grandpa.C=!0,after=grandpa):(after===parent.L&&(d3_geom_voronoiRedBlackRotateRight(this,parent),parent=(after=parent).U),parent.C=!1,grandpa.C=!0,d3_geom_voronoiRedBlackRotateLeft(this,grandpa)),parent=after.U;this._.C=!1},remove:function(node){node.N&&(node.N.P=node.P),node.P&&(node.P.N=node.N),node.N=node.P=null;var sibling,next,red,parent=node.U,left=node.L,right=node.R;if(next=left?right?d3_geom_voronoiRedBlackFirst(right):left:right,parent?parent.L===node?parent.L=next:parent.R=next:this._=next,left&&right?(red=next.C,next.C=node.C,next.L=left,left.U=next,next!==right?(parent=next.U,next.U=node.U,node=next.R,parent.L=node,next.R=right,right.U=next):(next.U=parent,parent=next,node=next.R)):(red=node.C,node=next),node&&(node.U=parent),!red)if(node&&node.C)node.C=!1;else{do{if(node===this._)break;if(node===parent.L){if((sibling=parent.R).C&&(sibling.C=!1,parent.C=!0,d3_geom_voronoiRedBlackRotateLeft(this,parent),sibling=parent.R),sibling.L&&sibling.L.C||sibling.R&&sibling.R.C){sibling.R&&sibling.R.C||(sibling.L.C=!1,sibling.C=!0,d3_geom_voronoiRedBlackRotateRight(this,sibling),sibling=parent.R),sibling.C=parent.C,parent.C=sibling.R.C=!1,d3_geom_voronoiRedBlackRotateLeft(this,parent),node=this._;break}}else if((sibling=parent.L).C&&(sibling.C=!1,parent.C=!0,d3_geom_voronoiRedBlackRotateRight(this,parent),sibling=parent.L),sibling.L&&sibling.L.C||sibling.R&&sibling.R.C){sibling.L&&sibling.L.C||(sibling.R.C=!1,sibling.C=!0,d3_geom_voronoiRedBlackRotateLeft(this,sibling),sibling=parent.L),sibling.C=parent.C,parent.C=sibling.L.C=!1,d3_geom_voronoiRedBlackRotateRight(this,parent),node=this._;break}sibling.C=!0,node=parent,parent=parent.U}while(!node.C);node&&(node.C=!1)}}},d3.geom.voronoi=function(points){var x=d3_geom_pointX,y=d3_geom_pointY,fx=x,fy=y,clipExtent=d3_geom_voronoiClipExtent;if(points)return voronoi(points);function voronoi(data){var polygons=new Array(data.length),x0=clipExtent[0][0],y0=clipExtent[0][1],x1=clipExtent[1][0],y1=clipExtent[1][1];return d3_geom_voronoi(sites(data),clipExtent).cells.forEach(function(cell,i){var edges=cell.edges,site=cell.site;(polygons[i]=edges.length?edges.map(function(e){var s=e.start();return[s.x,s.y]}):site.x>=x0&&site.x<=x1&&site.y>=y0&&site.y<=y1?[[x0,y1],[x1,y1],[x1,y0],[x0,y0]]:[]).point=data[i]}),polygons}function sites(data){return data.map(function(d,i){return{x:Math.round(fx(d,i)/ε)*ε,y:Math.round(fy(d,i)/ε)*ε,i:i}})}return voronoi.links=function(data){return d3_geom_voronoi(sites(data)).edges.filter(function(edge){return edge.l&&edge.r}).map(function(edge){return{source:data[edge.l.i],target:data[edge.r.i]}})},voronoi.triangles=function(data){var triangles=[];return d3_geom_voronoi(sites(data)).cells.forEach(function(cell,i){for(var s0,a,b,c,site=cell.site,edges=cell.edges.sort(d3_geom_voronoiHalfEdgeOrder),j=-1,m=edges.length,e1=edges[m-1].edge,s1=e1.l===site?e1.r:e1.l;++j<m;)e1,s0=s1,s1=(e1=edges[j].edge).l===site?e1.r:e1.l,i<s0.i&&i<s1.i&&(b=s0,c=s1,((a=site).x-c.x)*(b.y-a.y)-(a.x-b.x)*(c.y-a.y)<0)&&triangles.push([data[i],data[s0.i],data[s1.i]])}),triangles},voronoi.x=function(_){return arguments.length?(fx=d3_functor(x=_),voronoi):x},voronoi.y=function(_){return arguments.length?(fy=d3_functor(y=_),voronoi):y},voronoi.clipExtent=function(_){return arguments.length?(clipExtent=null==_?d3_geom_voronoiClipExtent:_,voronoi):clipExtent===d3_geom_voronoiClipExtent?null:clipExtent},voronoi.size=function(_){return arguments.length?voronoi.clipExtent(_&&[[0,0],_]):clipExtent===d3_geom_voronoiClipExtent?null:clipExtent&&clipExtent[1]},voronoi};var d3_geom_voronoiClipExtent=[[-1e6,-1e6],[1e6,1e6]];function d3_geom_quadtreeCompatX(d){return d.x}function d3_geom_quadtreeCompatY(d){return d.y}function d3_interpolateRgb(a,b){a=d3.rgb(a),b=d3.rgb(b);var ar=a.r,ag=a.g,ab=a.b,br=b.r-ar,bg=b.g-ag,bb=b.b-ab;return function(t){return"#"+d3_rgb_hex(Math.round(ar+br*t))+d3_rgb_hex(Math.round(ag+bg*t))+d3_rgb_hex(Math.round(ab+bb*t))}}function d3_interpolateObject(a,b){var k,i={},c={};for(k in a)k in b?i[k]=d3_interpolate(a[k],b[k]):c[k]=a[k];for(k in b)k in a||(c[k]=b[k]);return function(t){for(k in i)c[k]=i[k](t);return c}}function d3_interpolateNumber(a,b){return a=+a,b=+b,function(t){return a*(1-t)+b*t}}function d3_interpolateString(a,b){var am,bm,bs,bi=d3_interpolate_numberA.lastIndex=d3_interpolate_numberB.lastIndex=0,i=-1,s=[],q=[];for(a+="",b+="";(am=d3_interpolate_numberA.exec(a))&&(bm=d3_interpolate_numberB.exec(b));)(bs=bm.index)>bi&&(bs=b.slice(bi,bs),s[i]?s[i]+=bs:s[++i]=bs),(am=am[0])===(bm=bm[0])?s[i]?s[i]+=bm:s[++i]=bm:(s[++i]=null,q.push({i:i,x:d3_interpolateNumber(am,bm)})),bi=d3_interpolate_numberB.lastIndex;return bi<b.length&&(bs=b.slice(bi),s[i]?s[i]+=bs:s[++i]=bs),s.length<2?q[0]?(b=q[0].x,function(t){return b(t)+""}):function(){return b}:(b=q.length,function(t){for(var o,i=0;i<b;++i)s[(o=q[i]).i]=o.x(t);return s.join("")})}d3.geom.delaunay=function(vertices){return d3.geom.voronoi().triangles(vertices)},d3.geom.quadtree=function(points,x1,y1,x2,y2){var compat,x=d3_geom_pointX,y=d3_geom_pointY;if(compat=arguments.length)return x=d3_geom_quadtreeCompatX,y=d3_geom_quadtreeCompatY,3===compat&&(y2=y1,x2=x1,y1=x1=0),quadtree(points);function quadtree(data){var d,xs,ys,i,n,x1_,y1_,x2_,y2_,fx=d3_functor(x),fy=d3_functor(y);if(null!=x1)x1_=x1,y1_=y1,x2_=x2,y2_=y2;else if(x2_=y2_=-(x1_=y1_=1/0),xs=[],ys=[],n=data.length,compat)for(i=0;i<n;++i)(d=data[i]).x<x1_&&(x1_=d.x),d.y<y1_&&(y1_=d.y),d.x>x2_&&(x2_=d.x),d.y>y2_&&(y2_=d.y),xs.push(d.x),ys.push(d.y);else for(i=0;i<n;++i){var x_=+fx(d=data[i],i),y_=+fy(d,i);x_<x1_&&(x1_=x_),y_<y1_&&(y1_=y_),x_>x2_&&(x2_=x_),y_>y2_&&(y2_=y_),xs.push(x_),ys.push(y_)}var dx=x2_-x1_,dy=y2_-y1_;function insert(n,d,x,y,x1,y1,x2,y2){if(!isNaN(x)&&!isNaN(y))if(n.leaf){var nx=n.x,ny=n.y;if(null!=nx)if(abs(nx-x)+abs(ny-y)<.01)insertChild(n,d,x,y,x1,y1,x2,y2);else{var nPoint=n.point;n.x=n.y=n.point=null,insertChild(n,nPoint,nx,ny,x1,y1,x2,y2),insertChild(n,d,x,y,x1,y1,x2,y2)}else n.x=x,n.y=y,n.point=d}else insertChild(n,d,x,y,x1,y1,x2,y2)}function insertChild(n,d,x,y,x1,y1,x2,y2){var xm=.5*(x1+x2),ym=.5*(y1+y2),right=x>=xm,below=y>=ym,i=below<<1|right;n.leaf=!1,n=n.nodes[i]||(n.nodes[i]={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(d){insert(root,d,+fx(d,++i),+fy(d,i),x1_,y1_,x2_,y2_)}}),right?x1=xm:x2=xm,below?y1=ym:y2=ym,insert(n,d,x,y,x1,y1,x2,y2)}dx>dy?y2_=y1_+dx:x2_=x1_+dy;var root={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(d){insert(root,d,+fx(d,++i),+fy(d,i),x1_,y1_,x2_,y2_)}};if(root.visit=function(f){!function d3_geom_quadtreeVisit(f,node,x1,y1,x2,y2){if(!f(node,x1,y1,x2,y2)){var sx=.5*(x1+x2),sy=.5*(y1+y2),children=node.nodes;children[0]&&d3_geom_quadtreeVisit(f,children[0],x1,y1,sx,sy),children[1]&&d3_geom_quadtreeVisit(f,children[1],sx,y1,x2,sy),children[2]&&d3_geom_quadtreeVisit(f,children[2],x1,sy,sx,y2),children[3]&&d3_geom_quadtreeVisit(f,children[3],sx,sy,x2,y2)}}(f,root,x1_,y1_,x2_,y2_)},root.find=function(point){return function d3_geom_quadtreeFind(root,x,y,x0,y0,x3,y3){var closestPoint,minDistance2=1/0;return function find(node,x1,y1,x2,y2){if(!(x1>x3||y1>y3||x2<x0||y2<y0)){if(point=node.point){var point,dx=x-node.x,dy=y-node.y,distance2=dx*dx+dy*dy;if(distance2<minDistance2){var distance=Math.sqrt(minDistance2=distance2);x0=x-distance,y0=y-distance,x3=x+distance,y3=y+distance,closestPoint=point}}for(var children=node.nodes,xm=.5*(x1+x2),ym=.5*(y1+y2),i=(y>=ym)<<1|x>=xm,j=i+4;i<j;++i)if(node=children[3&i])switch(3&i){case 0:find(node,x1,y1,xm,ym);break;case 1:find(node,xm,y1,x2,ym);break;case 2:find(node,x1,ym,xm,y2);break;case 3:find(node,xm,ym,x2,y2)}}}(root,x0,y0,x3,y3),closestPoint}(root,point[0],point[1],x1_,y1_,x2_,y2_)},i=-1,null==x1){for(;++i<n;)insert(root,data[i],xs[i],ys[i],x1_,y1_,x2_,y2_);--i}else data.forEach(root.add);return xs=ys=data=d=null,root}return quadtree.x=function(_){return arguments.length?(x=_,quadtree):x},quadtree.y=function(_){return arguments.length?(y=_,quadtree):y},quadtree.extent=function(_){return arguments.length?(null==_?x1=y1=x2=y2=null:(x1=+_[0][0],y1=+_[0][1],x2=+_[1][0],y2=+_[1][1]),quadtree):null==x1?null:[[x1,y1],[x2,y2]]},quadtree.size=function(_){return arguments.length?(null==_?x1=y1=x2=y2=null:(x1=y1=0,x2=+_[0],y2=+_[1]),quadtree):null==x1?null:[x2-x1,y2-y1]},quadtree},d3.interpolateRgb=d3_interpolateRgb,d3.interpolateObject=d3_interpolateObject,d3.interpolateNumber=d3_interpolateNumber,d3.interpolateString=d3_interpolateString;var d3_interpolate_numberA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,d3_interpolate_numberB=new RegExp(d3_interpolate_numberA.source,"g");function d3_interpolate(a,b){for(var f,i=d3.interpolators.length;--i>=0&&!(f=d3.interpolators[i](a,b)););return f}function d3_interpolateArray(a,b){var i,x=[],c=[],na=a.length,nb=b.length,n0=Math.min(a.length,b.length);for(i=0;i<n0;++i)x.push(d3_interpolate(a[i],b[i]));for(;i<na;++i)c[i]=a[i];for(;i<nb;++i)c[i]=b[i];return function(t){for(i=0;i<n0;++i)c[i]=x[i](t);return c}}d3.interpolate=d3_interpolate,d3.interpolators=[function(a,b){var t=typeof b;return("string"===t?d3_rgb_names.has(b.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(b)?d3_interpolateRgb:d3_interpolateString:b instanceof d3_color?d3_interpolateRgb:Array.isArray(b)?d3_interpolateArray:"object"===t&&isNaN(b)?d3_interpolateObject:d3_interpolateNumber)(a,b)}],d3.interpolateArray=d3_interpolateArray;var d3_ease_default=function(){return d3_identity},d3_ease=d3.map({linear:d3_ease_default,poly:function d3_ease_poly(e){return function(t){return Math.pow(t,e)}},quad:function(){return d3_ease_quad},cubic:function(){return d3_ease_cubic},sin:function(){return d3_ease_sin},exp:function(){return d3_ease_exp},circle:function(){return d3_ease_circle},elastic:function d3_ease_elastic(a,p){var s;arguments.length<2&&(p=.45);arguments.length?s=p/τ*Math.asin(1/a):(a=1,s=p/4);return function(t){return 1+a*Math.pow(2,-10*t)*Math.sin((t-s)*τ/p)}},back:function d3_ease_back(s){s||(s=1.70158);return function(t){return t*t*((s+1)*t-s)}},bounce:function(){return d3_ease_bounce}}),d3_ease_mode=d3.map({in:d3_identity,out:d3_ease_reverse,"in-out":d3_ease_reflect,"out-in":function(f){return d3_ease_reflect(d3_ease_reverse(f))}});function d3_ease_reverse(f){return function(t){return 1-f(1-t)}}function d3_ease_reflect(f){return function(t){return.5*(t<.5?f(2*t):2-f(2-2*t))}}function d3_ease_quad(t){return t*t}function d3_ease_cubic(t){return t*t*t}function d3_ease_cubicInOut(t){if(t<=0)return 0;if(t>=1)return 1;var t2=t*t,t3=t2*t;return 4*(t<.5?t3:3*(t-t2)+t3-.75)}function d3_ease_sin(t){return 1-Math.cos(t*halfπ)}function d3_ease_exp(t){return Math.pow(2,10*(t-1))}function d3_ease_circle(t){return 1-Math.sqrt(1-t*t)}function d3_ease_bounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function d3_interpolateRound(a,b){return b-=a,function(t){return Math.round(a+b*t)}}function d3_transform(m){var r0=[m.a,m.b],r1=[m.c,m.d],kx=d3_transformNormalize(r0),kz=d3_transformDot(r0,r1),ky=d3_transformNormalize(function d3_transformCombine(a,b,k){return a[0]+=k*b[0],a[1]+=k*b[1],a}(r1,r0,-kz))||0;r0[0]*r1[1]<r1[0]*r0[1]&&(r0[0]*=-1,r0[1]*=-1,kx*=-1,kz*=-1),this.rotate=(kx?Math.atan2(r0[1],r0[0]):Math.atan2(-r1[0],r1[1]))*d3_degrees,this.translate=[m.e,m.f],this.scale=[kx,ky],this.skew=ky?Math.atan2(kz,ky)*d3_degrees:0}function d3_transformDot(a,b){return a[0]*b[0]+a[1]*b[1]}function d3_transformNormalize(a){var k=Math.sqrt(d3_transformDot(a,a));return k&&(a[0]/=k,a[1]/=k),k}d3.ease=function(name){var i=name.indexOf("-"),t=i>=0?name.slice(0,i):name,m=i>=0?name.slice(i+1):"in";return t=d3_ease.get(t)||d3_ease_default,function d3_ease_clamp(f){return function(t){return t<=0?0:t>=1?1:f(t)}}((m=d3_ease_mode.get(m)||d3_identity)(t.apply(null,d3_arraySlice.call(arguments,1))))},d3.interpolateHcl=function d3_interpolateHcl(a,b){a=d3.hcl(a),b=d3.hcl(b);var ah=a.h,ac=a.c,al=a.l,bh=b.h-ah,bc=b.c-ac,bl=b.l-al;isNaN(bc)&&(bc=0,ac=isNaN(ac)?b.c:ac);isNaN(bh)?(bh=0,ah=isNaN(ah)?b.h:ah):bh>180?bh-=360:bh<-180&&(bh+=360);return function(t){return d3_hcl_lab(ah+bh*t,ac+bc*t,al+bl*t)+""}},d3.interpolateHsl=function d3_interpolateHsl(a,b){a=d3.hsl(a),b=d3.hsl(b);var ah=a.h,as=a.s,al=a.l,bh=b.h-ah,bs=b.s-as,bl=b.l-al;isNaN(bs)&&(bs=0,as=isNaN(as)?b.s:as);isNaN(bh)?(bh=0,ah=isNaN(ah)?b.h:ah):bh>180?bh-=360:bh<-180&&(bh+=360);return function(t){return d3_hsl_rgb(ah+bh*t,as+bs*t,al+bl*t)+""}},d3.interpolateLab=function d3_interpolateLab(a,b){a=d3.lab(a),b=d3.lab(b);var al=a.l,aa=a.a,ab=a.b,bl=b.l-al,ba=b.a-aa,bb=b.b-ab;return function(t){return d3_lab_rgb(al+bl*t,aa+ba*t,ab+bb*t)+""}},d3.interpolateRound=d3_interpolateRound,d3.transform=function(string){var g=d3_document.createElementNS(d3.ns.prefix.svg,"g");return(d3.transform=function(string){if(null!=string){g.setAttribute("transform",string);var t=g.transform.baseVal.consolidate()}return new d3_transform(t?t.matrix:d3_transformIdentity)})(string)},d3_transform.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var d3_transformIdentity={a:1,b:0,c:0,d:1,e:0,f:0};function d3_interpolateTransformPop(s){return s.length?s.pop()+",":""}function d3_interpolateTransform(a,b){var s=[],q=[];return a=d3.transform(a),b=d3.transform(b),function d3_interpolateTranslate(ta,tb,s,q){if(ta[0]!==tb[0]||ta[1]!==tb[1]){var i=s.push("translate(",null,",",null,")");q.push({i:i-4,x:d3_interpolateNumber(ta[0],tb[0])},{i:i-2,x:d3_interpolateNumber(ta[1],tb[1])})}else(tb[0]||tb[1])&&s.push("translate("+tb+")")}(a.translate,b.translate,s,q),function d3_interpolateRotate(ra,rb,s,q){ra!==rb?(ra-rb>180?rb+=360:rb-ra>180&&(ra+=360),q.push({i:s.push(d3_interpolateTransformPop(s)+"rotate(",null,")")-2,x:d3_interpolateNumber(ra,rb)})):rb&&s.push(d3_interpolateTransformPop(s)+"rotate("+rb+")")}(a.rotate,b.rotate,s,q),function d3_interpolateSkew(wa,wb,s,q){wa!==wb?q.push({i:s.push(d3_interpolateTransformPop(s)+"skewX(",null,")")-2,x:d3_interpolateNumber(wa,wb)}):wb&&s.push(d3_interpolateTransformPop(s)+"skewX("+wb+")")}(a.skew,b.skew,s,q),function d3_interpolateScale(ka,kb,s,q){if(ka[0]!==kb[0]||ka[1]!==kb[1]){var i=s.push(d3_interpolateTransformPop(s)+"scale(",null,",",null,")");q.push({i:i-4,x:d3_interpolateNumber(ka[0],kb[0])},{i:i-2,x:d3_interpolateNumber(ka[1],kb[1])})}else 1===kb[0]&&1===kb[1]||s.push(d3_interpolateTransformPop(s)+"scale("+kb+")")}(a.scale,b.scale,s,q),a=b=null,function(t){for(var o,i=-1,n=q.length;++i<n;)s[(o=q[i]).i]=o.x(t);return s.join("")}}function d3_uninterpolateNumber(a,b){return b=(b-=a=+a)||1/b,function(x){return(x-a)/b}}function d3_uninterpolateClamp(a,b){return b=(b-=a=+a)||1/b,function(x){return Math.max(0,Math.min(1,(x-a)/b))}}function d3_layout_bundlePath(link){for(var start=link.source,end=link.target,lca=function d3_layout_bundleLeastCommonAncestor(a,b){if(a===b)return a;var aNodes=d3_layout_bundleAncestors(a),bNodes=d3_layout_bundleAncestors(b),aNode=aNodes.pop(),bNode=bNodes.pop(),sharedNode=null;for(;aNode===bNode;)sharedNode=aNode,aNode=aNodes.pop(),bNode=bNodes.pop();return sharedNode}(start,end),points=[start];start!==lca;)start=start.parent,points.push(start);for(var k=points.length;end!==lca;)points.splice(k,0,end),end=end.parent;return points}function d3_layout_bundleAncestors(node){for(var ancestors=[],parent=node.parent;null!=parent;)ancestors.push(node),node=parent,parent=parent.parent;return ancestors.push(node),ancestors}function d3_layout_forceDragstart(d){d.fixed|=2}function d3_layout_forceDragend(d){d.fixed&=-7}function d3_layout_forceMouseover(d){d.fixed|=4,d.px=d.x,d.py=d.y}function d3_layout_forceMouseout(d){d.fixed&=-5}d3.interpolateTransform=d3_interpolateTransform,d3.layout={},d3.layout.bundle=function(){return function(links){for(var paths=[],i=-1,n=links.length;++i<n;)paths.push(d3_layout_bundlePath(links[i]));return paths}},d3.layout.chord=function(){var chords,groups,matrix,n,sortGroups,sortSubgroups,sortChords,chord={},padding=0;function relayout(){var k,x,x0,i,j,subgroups={},groupSums=[],groupIndex=d3.range(n),subgroupIndex=[];for(chords=[],groups=[],k=0,i=-1;++i<n;){for(x=0,j=-1;++j<n;)x+=matrix[i][j];groupSums.push(x),subgroupIndex.push(d3.range(n)),k+=x}for(sortGroups&&groupIndex.sort(function(a,b){return sortGroups(groupSums[a],groupSums[b])}),sortSubgroups&&subgroupIndex.forEach(function(d,i){d.sort(function(a,b){return sortSubgroups(matrix[i][a],matrix[i][b])})}),k=(τ-padding*n)/k,x=0,i=-1;++i<n;){for(x0=x,j=-1;++j<n;){var di=groupIndex[i],dj=subgroupIndex[di][j],v=matrix[di][dj],a0=x,a1=x+=v*k;subgroups[di+"-"+dj]={index:di,subindex:dj,startAngle:a0,endAngle:a1,value:v}}groups[di]={index:di,startAngle:x0,endAngle:x,value:groupSums[di]},x+=padding}for(i=-1;++i<n;)for(j=i-1;++j<n;){var source=subgroups[i+"-"+j],target=subgroups[j+"-"+i];(source.value||target.value)&&chords.push(source.value<target.value?{source:target,target:source}:{source:source,target:target})}sortChords&&resort()}function resort(){chords.sort(function(a,b){return sortChords((a.source.value+a.target.value)/2,(b.source.value+b.target.value)/2)})}return chord.matrix=function(x){return arguments.length?(n=(matrix=x)&&matrix.length,chords=groups=null,chord):matrix},chord.padding=function(x){return arguments.length?(padding=x,chords=groups=null,chord):padding},chord.sortGroups=function(x){return arguments.length?(sortGroups=x,chords=groups=null,chord):sortGroups},chord.sortSubgroups=function(x){return arguments.length?(sortSubgroups=x,chords=null,chord):sortSubgroups},chord.sortChords=function(x){return arguments.length?(sortChords=x,chords&&resort(),chord):sortChords},chord.chords=function(){return chords||relayout(),chords},chord.groups=function(){return groups||relayout(),groups},chord},d3.layout.force=function(){var timer,drag,alpha,distances,strengths,charges,force={},event=d3.dispatch("start","tick","end"),size=[1,1],friction=.9,linkDistance=d3_layout_forceLinkDistance,linkStrength=d3_layout_forceLinkStrength,charge=-30,chargeDistance2=d3_layout_forceChargeDistance2,gravity=.1,theta2=.64,nodes=[],links=[];function repulse(node){return function(quad,x1,_,x2){if(quad.point!==node){var dx=quad.cx-node.x,dy=quad.cy-node.y,dw=x2-x1,dn=dx*dx+dy*dy;if(dw*dw/theta2<dn){if(dn<chargeDistance2){var k=quad.charge/dn;node.px-=dx*k,node.py-=dy*k}return!0}if(quad.point&&dn&&dn<chargeDistance2){k=quad.pointCharge/dn;node.px-=dx*k,node.py-=dy*k}}return!quad.charge}}function dragmove(d){d.px=d3.event.x,d.py=d3.event.y,force.resume()}return force.tick=function(){if((alpha*=.99)<.005)return timer=null,event.end({type:"end",alpha:alpha=0}),!0;var q,i,o,s,t,l,k,x,y,n=nodes.length,m=links.length;for(i=0;i<m;++i)s=(o=links[i]).source,(l=(x=(t=o.target).x-s.x)*x+(y=t.y-s.y)*y)&&(x*=l=alpha*strengths[i]*((l=Math.sqrt(l))-distances[i])/l,y*=l,t.x-=x*(k=s.weight+t.weight?s.weight/(s.weight+t.weight):.5),t.y-=y*k,s.x+=x*(k=1-k),s.y+=y*k);if((k=alpha*gravity)&&(x=size[0]/2,y=size[1]/2,i=-1,k))for(;++i<n;)(o=nodes[i]).x+=(x-o.x)*k,o.y+=(y-o.y)*k;if(charge)for(!function d3_layout_forceAccumulate(quad,alpha,charges){var cx=0,cy=0;quad.charge=0;if(!quad.leaf)for(var c,nodes=quad.nodes,n=nodes.length,i=-1;++i<n;)null!=(c=nodes[i])&&(d3_layout_forceAccumulate(c,alpha,charges),quad.charge+=c.charge,cx+=c.charge*c.cx,cy+=c.charge*c.cy);if(quad.point){quad.leaf||(quad.point.x+=Math.random()-.5,quad.point.y+=Math.random()-.5);var k=alpha*charges[quad.point.index];quad.charge+=quad.pointCharge=k,cx+=k*quad.point.x,cy+=k*quad.point.y}quad.cx=cx/quad.charge;quad.cy=cy/quad.charge}(q=d3.geom.quadtree(nodes),alpha,charges),i=-1;++i<n;)(o=nodes[i]).fixed||q.visit(repulse(o));for(i=-1;++i<n;)(o=nodes[i]).fixed?(o.x=o.px,o.y=o.py):(o.x-=(o.px-(o.px=o.x))*friction,o.y-=(o.py-(o.py=o.y))*friction);event.tick({type:"tick",alpha:alpha})},force.nodes=function(x){return arguments.length?(nodes=x,force):nodes},force.links=function(x){return arguments.length?(links=x,force):links},force.size=function(x){return arguments.length?(size=x,force):size},force.linkDistance=function(x){return arguments.length?(linkDistance="function"==typeof x?x:+x,force):linkDistance},force.distance=force.linkDistance,force.linkStrength=function(x){return arguments.length?(linkStrength="function"==typeof x?x:+x,force):linkStrength},force.friction=function(x){return arguments.length?(friction=+x,force):friction},force.charge=function(x){return arguments.length?(charge="function"==typeof x?x:+x,force):charge},force.chargeDistance=function(x){return arguments.length?(chargeDistance2=x*x,force):Math.sqrt(chargeDistance2)},force.gravity=function(x){return arguments.length?(gravity=+x,force):gravity},force.theta=function(x){return arguments.length?(theta2=x*x,force):Math.sqrt(theta2)},force.alpha=function(x){return arguments.length?(x=+x,alpha?x>0?alpha=x:(timer.c=null,timer.t=NaN,timer=null,event.end({type:"end",alpha:alpha=0})):x>0&&(event.start({type:"start",alpha:alpha=x}),timer=d3_timer(force.tick)),force):alpha},force.start=function(){var i,neighbors,o,n=nodes.length,m=links.length,w=size[0],h=size[1];for(i=0;i<n;++i)(o=nodes[i]).index=i,o.weight=0;for(i=0;i<m;++i)"number"==typeof(o=links[i]).source&&(o.source=nodes[o.source]),"number"==typeof o.target&&(o.target=nodes[o.target]),++o.source.weight,++o.target.weight;for(i=0;i<n;++i)o=nodes[i],isNaN(o.x)&&(o.x=position("x",w)),isNaN(o.y)&&(o.y=position("y",h)),isNaN(o.px)&&(o.px=o.x),isNaN(o.py)&&(o.py=o.y);if(distances=[],"function"==typeof linkDistance)for(i=0;i<m;++i)distances[i]=+linkDistance.call(this,links[i],i);else for(i=0;i<m;++i)distances[i]=linkDistance;if(strengths=[],"function"==typeof linkStrength)for(i=0;i<m;++i)strengths[i]=+linkStrength.call(this,links[i],i);else for(i=0;i<m;++i)strengths[i]=linkStrength;if(charges=[],"function"==typeof charge)for(i=0;i<n;++i)charges[i]=+charge.call(this,nodes[i],i);else for(i=0;i<n;++i)charges[i]=charge;function position(dimension,size){if(!neighbors){for(neighbors=new Array(n),j=0;j<n;++j)neighbors[j]=[];for(j=0;j<m;++j){var o=links[j];neighbors[o.source.index].push(o.target),neighbors[o.target.index].push(o.source)}}for(var x,candidates=neighbors[i],j=-1,l=candidates.length;++j<l;)if(!isNaN(x=candidates[j][dimension]))return x;return Math.random()*size}return force.resume()},force.resume=function(){return force.alpha(.1)},force.stop=function(){return force.alpha(0)},force.drag=function(){if(drag||(drag=d3.behavior.drag().origin(d3_identity).on("dragstart.force",d3_layout_forceDragstart).on("drag.force",dragmove).on("dragend.force",d3_layout_forceDragend)),!arguments.length)return drag;this.on("mouseover.force",d3_layout_forceMouseover).on("mouseout.force",d3_layout_forceMouseout).call(drag)},d3.rebind(force,event,"on")};var d3_layout_forceLinkDistance=20,d3_layout_forceLinkStrength=1,d3_layout_forceChargeDistance2=1/0;function d3_layout_hierarchyRebind(object,hierarchy){return d3.rebind(object,hierarchy,"sort","children","value"),object.nodes=object,object.links=d3_layout_hierarchyLinks,object}function d3_layout_hierarchyVisitBefore(node,callback){for(var nodes=[node];null!=(node=nodes.pop());)if(callback(node),(children=node.children)&&(n=children.length))for(var n,children;--n>=0;)nodes.push(children[n])}function d3_layout_hierarchyVisitAfter(node,callback){for(var nodes=[node],nodes2=[];null!=(node=nodes.pop());)if(nodes2.push(node),(children=node.children)&&(n=children.length))for(var n,children,i=-1;++i<n;)nodes.push(children[i]);for(;null!=(node=nodes2.pop());)callback(node)}function d3_layout_hierarchyChildren(d){return d.children}function d3_layout_hierarchyValue(d){return d.value}function d3_layout_hierarchySort(a,b){return b.value-a.value}function d3_layout_hierarchyLinks(nodes){return d3.merge(nodes.map(function(parent){return(parent.children||[]).map(function(child){return{source:parent,target:child}})}))}d3.layout.hierarchy=function(){var sort=d3_layout_hierarchySort,children=d3_layout_hierarchyChildren,value=d3_layout_hierarchyValue;function hierarchy(root){var node,stack=[root],nodes=[];for(root.depth=0;null!=(node=stack.pop());)if(nodes.push(node),(childs=children.call(hierarchy,node,node.depth))&&(n=childs.length)){for(var n,childs,child;--n>=0;)stack.push(child=childs[n]),child.parent=node,child.depth=node.depth+1;value&&(node.value=0),node.children=childs}else value&&(node.value=+value.call(hierarchy,node,node.depth)||0),delete node.children;return d3_layout_hierarchyVisitAfter(root,function(node){var childs,parent;sort&&(childs=node.children)&&childs.sort(sort),value&&(parent=node.parent)&&(parent.value+=node.value)}),nodes}return hierarchy.sort=function(x){return arguments.length?(sort=x,hierarchy):sort},hierarchy.children=function(x){return arguments.length?(children=x,hierarchy):children},hierarchy.value=function(x){return arguments.length?(value=x,hierarchy):value},hierarchy.revalue=function(root){return value&&(d3_layout_hierarchyVisitBefore(root,function(node){node.children&&(node.value=0)}),d3_layout_hierarchyVisitAfter(root,function(node){var parent;node.children||(node.value=+value.call(hierarchy,node,node.depth)||0),(parent=node.parent)&&(parent.value+=node.value)})),root},hierarchy},d3.layout.partition=function(){var hierarchy=d3.layout.hierarchy(),size=[1,1];function partition(d,i){var nodes=hierarchy.call(this,d,i);return function position(node,x,dx,dy){var children=node.children;if(node.x=x,node.y=node.depth*dy,node.dx=dx,node.dy=dy,children&&(n=children.length)){var n,c,d,i=-1;for(dx=node.value?dx/node.value:0;++i<n;)position(c=children[i],x,d=c.value*dx,dy),x+=d}}(nodes[0],0,size[0],size[1]/function depth(node){var children=node.children,d=0;if(children&&(n=children.length))for(var n,i=-1;++i<n;)d=Math.max(d,depth(children[i]));return 1+d}(nodes[0])),nodes}return partition.size=function(x){return arguments.length?(size=x,partition):size},d3_layout_hierarchyRebind(partition,hierarchy)},d3.layout.pie=function(){var value=Number,sort=d3_layout_pieSortByValue,startAngle=0,endAngle=τ,padAngle=0;function pie(data){var v,n=data.length,values=data.map(function(d,i){return+value.call(pie,d,i)}),a=+("function"==typeof startAngle?startAngle.apply(this,arguments):startAngle),da=("function"==typeof endAngle?endAngle.apply(this,arguments):endAngle)-a,p=Math.min(Math.abs(da)/n,+("function"==typeof padAngle?padAngle.apply(this,arguments):padAngle)),pa=p*(da<0?-1:1),sum=d3.sum(values),k=sum?(da-n*pa)/sum:0,index=d3.range(n),arcs=[];return null!=sort&&index.sort(sort===d3_layout_pieSortByValue?function(i,j){return values[j]-values[i]}:function(i,j){return sort(data[i],data[j])}),index.forEach(function(i){arcs[i]={data:data[i],value:v=values[i],startAngle:a,endAngle:a+=v*k+pa,padAngle:p}}),arcs}return pie.value=function(_){return arguments.length?(value=_,pie):value},pie.sort=function(_){return arguments.length?(sort=_,pie):sort},pie.startAngle=function(_){return arguments.length?(startAngle=_,pie):startAngle},pie.endAngle=function(_){return arguments.length?(endAngle=_,pie):endAngle},pie.padAngle=function(_){return arguments.length?(padAngle=_,pie):padAngle},pie};var d3_layout_pieSortByValue={};function d3_layout_stackX(d){return d.x}function d3_layout_stackY(d){return d.y}function d3_layout_stackOut(d,y0,y){d.y0=y0,d.y=y}d3.layout.stack=function(){var values=d3_identity,order=d3_layout_stackOrderDefault,offset=d3_layout_stackOffsetZero,out=d3_layout_stackOut,x=d3_layout_stackX,y=d3_layout_stackY;function stack(data,index){if(!(n=data.length))return data;var series=data.map(function(d,i){return values.call(stack,d,i)}),points=series.map(function(d){return d.map(function(v,i){return[x.call(stack,v,i),y.call(stack,v,i)]})}),orders=order.call(stack,points,index);series=d3.permute(series,orders),points=d3.permute(points,orders);var n,i,j,o,offsets=offset.call(stack,points,index),m=series[0].length;for(j=0;j<m;++j)for(out.call(stack,series[0][j],o=offsets[j],points[0][j][1]),i=1;i<n;++i)out.call(stack,series[i][j],o+=points[i-1][j][1],points[i][j][1]);return data}return stack.values=function(x){return arguments.length?(values=x,stack):values},stack.order=function(x){return arguments.length?(order="function"==typeof x?x:d3_layout_stackOrders.get(x)||d3_layout_stackOrderDefault,stack):order},stack.offset=function(x){return arguments.length?(offset="function"==typeof x?x:d3_layout_stackOffsets.get(x)||d3_layout_stackOffsetZero,stack):offset},stack.x=function(z){return arguments.length?(x=z,stack):x},stack.y=function(z){return arguments.length?(y=z,stack):y},stack.out=function(z){return arguments.length?(out=z,stack):out},stack};var d3_layout_stackOrders=d3.map({"inside-out":function(data){var i,j,n=data.length,max=data.map(d3_layout_stackMaxIndex),sums=data.map(d3_layout_stackReduceSum),index=d3.range(n).sort(function(a,b){return max[a]-max[b]}),top=0,bottom=0,tops=[],bottoms=[];for(i=0;i<n;++i)j=index[i],top<bottom?(top+=sums[j],tops.push(j)):(bottom+=sums[j],bottoms.push(j));return bottoms.reverse().concat(tops)},reverse:function(data){return d3.range(data.length).reverse()},default:d3_layout_stackOrderDefault}),d3_layout_stackOffsets=d3.map({silhouette:function(data){var i,j,o,n=data.length,m=data[0].length,sums=[],max=0,y0=[];for(j=0;j<m;++j){for(i=0,o=0;i<n;i++)o+=data[i][j][1];o>max&&(max=o),sums.push(o)}for(j=0;j<m;++j)y0[j]=(max-sums[j])/2;return y0},wiggle:function(data){var i,j,k,s1,s2,s3,dx,o,o0,n=data.length,x=data[0],m=x.length,y0=[];for(y0[0]=o=o0=0,j=1;j<m;++j){for(i=0,s1=0;i<n;++i)s1+=data[i][j][1];for(i=0,s2=0,dx=x[j][0]-x[j-1][0];i<n;++i){for(k=0,s3=(data[i][j][1]-data[i][j-1][1])/(2*dx);k<i;++k)s3+=(data[k][j][1]-data[k][j-1][1])/dx;s2+=s3*data[i][j][1]}y0[j]=o-=s1?s2/s1*dx:0,o<o0&&(o0=o)}for(j=0;j<m;++j)y0[j]-=o0;return y0},expand:function(data){var i,j,o,n=data.length,m=data[0].length,k=1/n,y0=[];for(j=0;j<m;++j){for(i=0,o=0;i<n;i++)o+=data[i][j][1];if(o)for(i=0;i<n;i++)data[i][j][1]/=o;else for(i=0;i<n;i++)data[i][j][1]=k}for(j=0;j<m;++j)y0[j]=0;return y0},zero:d3_layout_stackOffsetZero});function d3_layout_stackOrderDefault(data){return d3.range(data.length)}function d3_layout_stackOffsetZero(data){for(var j=-1,m=data[0].length,y0=[];++j<m;)y0[j]=0;return y0}function d3_layout_stackMaxIndex(array){for(var k,i=1,j=0,v=array[0][1],n=array.length;i<n;++i)(k=array[i][1])>v&&(j=i,v=k);return j}function d3_layout_stackReduceSum(d){return d.reduce(d3_layout_stackSum,0)}function d3_layout_stackSum(p,d){return p+d[1]}function d3_layout_histogramBinSturges(range,values){return d3_layout_histogramBinFixed(range,Math.ceil(Math.log(values.length)/Math.LN2+1))}function d3_layout_histogramBinFixed(range,n){for(var x=-1,b=+range[0],m=(range[1]-b)/n,f=[];++x<=n;)f[x]=m*x+b;return f}function d3_layout_histogramRange(values){return[d3.min(values),d3.max(values)]}function d3_layout_packSort(a,b){return a.value-b.value}function d3_layout_packInsert(a,b){var c=a._pack_next;a._pack_next=b,b._pack_prev=a,b._pack_next=c,c._pack_prev=b}function d3_layout_packSplice(a,b){a._pack_next=b,b._pack_prev=a}function d3_layout_packIntersects(a,b){var dx=b.x-a.x,dy=b.y-a.y,dr=a.r+b.r;return.999*dr*dr>dx*dx+dy*dy}function d3_layout_packSiblings(node){if((nodes=node.children)&&(n=nodes.length)){var nodes,a,b,c,i,j,k,n,xMin=1/0,xMax=-1/0,yMin=1/0,yMax=-1/0;if(nodes.forEach(d3_layout_packLink),(a=nodes[0]).x=-a.r,a.y=0,bound(a),n>1&&((b=nodes[1]).x=b.r,b.y=0,bound(b),n>2))for(d3_layout_packPlace(a,b,c=nodes[2]),bound(c),d3_layout_packInsert(a,c),a._pack_prev=c,d3_layout_packInsert(c,b),b=a._pack_next,i=3;i<n;i++){d3_layout_packPlace(a,b,c=nodes[i]);var isect=0,s1=1,s2=1;for(j=b._pack_next;j!==b;j=j._pack_next,s1++)if(d3_layout_packIntersects(j,c)){isect=1;break}if(1==isect)for(k=a._pack_prev;k!==j._pack_prev&&!d3_layout_packIntersects(k,c);k=k._pack_prev,s2++);isect?(s1<s2||s1==s2&&b.r<a.r?d3_layout_packSplice(a,b=j):d3_layout_packSplice(a=k,b),i--):(d3_layout_packInsert(a,c),b=c,bound(c))}var cx=(xMin+xMax)/2,cy=(yMin+yMax)/2,cr=0;for(i=0;i<n;i++)(c=nodes[i]).x-=cx,c.y-=cy,cr=Math.max(cr,c.r+Math.sqrt(c.x*c.x+c.y*c.y));node.r=cr,nodes.forEach(d3_layout_packUnlink)}function bound(node){xMin=Math.min(node.x-node.r,xMin),xMax=Math.max(node.x+node.r,xMax),yMin=Math.min(node.y-node.r,yMin),yMax=Math.max(node.y+node.r,yMax)}}function d3_layout_packLink(node){node._pack_next=node._pack_prev=node}function d3_layout_packUnlink(node){delete node._pack_next,delete node._pack_prev}function d3_layout_packPlace(a,b,c){var db=a.r+c.r,dx=b.x-a.x,dy=b.y-a.y;if(db&&(dx||dy)){var da=b.r+c.r,dc=dx*dx+dy*dy,x=.5+((db*=db)-(da*=da))/(2*dc),y=Math.sqrt(Math.max(0,2*da*(db+dc)-(db-=dc)*db-da*da))/(2*dc);c.x=a.x+x*dx+y*dy,c.y=a.y+x*dy-y*dx}else c.x=a.x+db,c.y=a.y}function d3_layout_treeSeparation(a,b){return a.parent==b.parent?1:2}function d3_layout_treeLeft(v){var children=v.children;return children.length?children[0]:v.t}function d3_layout_treeRight(v){var n,children=v.children;return(n=children.length)?children[n-1]:v.t}function d3_layout_treeMove(wm,wp,shift){var change=shift/(wp.i-wm.i);wp.c-=change,wp.s+=shift,wm.c+=change,wp.z+=shift,wp.m+=shift}function d3_layout_treeAncestor(vim,v,ancestor){return vim.a.parent===v.parent?vim.a:ancestor}function d3_layout_treemapPadNull(node){return{x:node.x,y:node.y,dx:node.dx,dy:node.dy}}function d3_layout_treemapPad(node,padding){var x=node.x+padding[3],y=node.y+padding[0],dx=node.dx-padding[1]-padding[3],dy=node.dy-padding[0]-padding[2];return dx<0&&(x+=dx/2,dx=0),dy<0&&(y+=dy/2,dy=0),{x:x,y:y,dx:dx,dy:dy}}function d3_scaleExtent(domain){var start=domain[0],stop=domain[domain.length-1];return start<stop?[start,stop]:[stop,start]}function d3_scaleRange(scale){return scale.rangeExtent?scale.rangeExtent():d3_scaleExtent(scale.range())}function d3_scale_bilinear(domain,range,uninterpolate,interpolate){var u=uninterpolate(domain[0],domain[1]),i=interpolate(range[0],range[1]);return function(x){return i(u(x))}}function d3_scale_nice(domain,nice){var dx,i0=0,i1=domain.length-1,x0=domain[i0],x1=domain[i1];return x1<x0&&(dx=i0,i0=i1,i1=dx,dx=x0,x0=x1,x1=dx),domain[i0]=nice.floor(x0),domain[i1]=nice.ceil(x1),domain}function d3_scale_niceStep(step){return step?{floor:function(x){return Math.floor(x/step)*step},ceil:function(x){return Math.ceil(x/step)*step}}:d3_scale_niceIdentity}d3.layout.histogram=function(){var frequency=!0,valuer=Number,ranger=d3_layout_histogramRange,binner=d3_layout_histogramBinSturges;function histogram(data,i){for(var bin,x,bins=[],values=data.map(valuer,this),range=ranger.call(this,values,i),thresholds=binner.call(this,range,values,i),n=(i=-1,values.length),m=thresholds.length-1,k=frequency?1:1/n;++i<m;)(bin=bins[i]=[]).dx=thresholds[i+1]-(bin.x=thresholds[i]),bin.y=0;if(m>0)for(i=-1;++i<n;)(x=values[i])>=range[0]&&x<=range[1]&&((bin=bins[d3.bisect(thresholds,x,1,m)-1]).y+=k,bin.push(data[i]));return bins}return histogram.value=function(x){return arguments.length?(valuer=x,histogram):valuer},histogram.range=function(x){return arguments.length?(ranger=d3_functor(x),histogram):ranger},histogram.bins=function(x){return arguments.length?(binner="number"==typeof x?function(range){return d3_layout_histogramBinFixed(range,x)}:d3_functor(x),histogram):binner},histogram.frequency=function(x){return arguments.length?(frequency=!!x,histogram):frequency},histogram},d3.layout.pack=function(){var radius,hierarchy=d3.layout.hierarchy().sort(d3_layout_packSort),padding=0,size=[1,1];function pack(d,i){var nodes=hierarchy.call(this,d,i),root=nodes[0],w=size[0],h=size[1],r=null==radius?Math.sqrt:"function"==typeof radius?radius:function(){return radius};if(root.x=root.y=0,d3_layout_hierarchyVisitAfter(root,function(d){d.r=+r(d.value)}),d3_layout_hierarchyVisitAfter(root,d3_layout_packSiblings),padding){var dr=padding*(radius?1:Math.max(2*root.r/w,2*root.r/h))/2;d3_layout_hierarchyVisitAfter(root,function(d){d.r+=dr}),d3_layout_hierarchyVisitAfter(root,d3_layout_packSiblings),d3_layout_hierarchyVisitAfter(root,function(d){d.r-=dr})}return function d3_layout_packTransform(node,x,y,k){var children=node.children;node.x=x+=k*node.x;node.y=y+=k*node.y;node.r*=k;if(children)for(var i=-1,n=children.length;++i<n;)d3_layout_packTransform(children[i],x,y,k)}(root,w/2,h/2,radius?1:1/Math.max(2*root.r/w,2*root.r/h)),nodes}return pack.size=function(_){return arguments.length?(size=_,pack):size},pack.radius=function(_){return arguments.length?(radius=null==_||"function"==typeof _?_:+_,pack):radius},pack.padding=function(_){return arguments.length?(padding=+_,pack):padding},d3_layout_hierarchyRebind(pack,hierarchy)},d3.layout.tree=function(){var hierarchy=d3.layout.hierarchy().sort(null).value(null),separation=d3_layout_treeSeparation,size=[1,1],nodeSize=null;function tree(d,i){var nodes=hierarchy.call(this,d,i),root0=nodes[0],root1=function wrapTree(root0){var node1,root1={A:null,children:[root0]},queue=[root1];for(;null!=(node1=queue.pop());)for(var child,children=node1.children,i=0,n=children.length;i<n;++i)queue.push((children[i]=child={_:children[i],parent:node1,children:(child=children[i].children)&&child.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:i}).a=child);return root1.children[0]}(root0);if(d3_layout_hierarchyVisitAfter(root1,firstWalk),root1.parent.m=-root1.z,d3_layout_hierarchyVisitBefore(root1,secondWalk),nodeSize)d3_layout_hierarchyVisitBefore(root0,sizeNode);else{var left=root0,right=root0,bottom=root0;d3_layout_hierarchyVisitBefore(root0,function(node){node.x<left.x&&(left=node),node.x>right.x&&(right=node),node.depth>bottom.depth&&(bottom=node)});var tx=separation(left,right)/2-left.x,kx=size[0]/(right.x+separation(right,left)/2+tx),ky=size[1]/(bottom.depth||1);d3_layout_hierarchyVisitBefore(root0,function(node){node.x=(node.x+tx)*kx,node.y=node.depth*ky})}return nodes}function firstWalk(v){var children=v.children,siblings=v.parent.children,w=v.i?siblings[v.i-1]:null;if(children.length){!function d3_layout_treeShift(v){var w,shift=0,change=0,children=v.children,i=children.length;for(;--i>=0;)(w=children[i]).z+=shift,w.m+=shift,shift+=w.s+(change+=w.c)}(v);var midpoint=(children[0].z+children[children.length-1].z)/2;w?(v.z=w.z+separation(v._,w._),v.m=v.z-midpoint):v.z=midpoint}else w&&(v.z=w.z+separation(v._,w._));v.parent.A=function apportion(v,w,ancestor){if(w){for(var shift,vip=v,vop=v,vim=w,vom=vip.parent.children[0],sip=vip.m,sop=vop.m,sim=vim.m,som=vom.m;vim=d3_layout_treeRight(vim),vip=d3_layout_treeLeft(vip),vim&&vip;)vom=d3_layout_treeLeft(vom),(vop=d3_layout_treeRight(vop)).a=v,(shift=vim.z+sim-vip.z-sip+separation(vim._,vip._))>0&&(d3_layout_treeMove(d3_layout_treeAncestor(vim,v,ancestor),v,shift),sip+=shift,sop+=shift),sim+=vim.m,sip+=vip.m,som+=vom.m,sop+=vop.m;vim&&!d3_layout_treeRight(vop)&&(vop.t=vim,vop.m+=sim-sop),vip&&!d3_layout_treeLeft(vom)&&(vom.t=vip,vom.m+=sip-som,ancestor=v)}return ancestor}(v,w,v.parent.A||siblings[0])}function secondWalk(v){v._.x=v.z+v.parent.m,v.m+=v.parent.m}function sizeNode(node){node.x*=size[0],node.y=node.depth*size[1]}return tree.separation=function(x){return arguments.length?(separation=x,tree):separation},tree.size=function(x){return arguments.length?(nodeSize=null==(size=x)?sizeNode:null,tree):nodeSize?null:size},tree.nodeSize=function(x){return arguments.length?(nodeSize=null==(size=x)?null:sizeNode,tree):nodeSize?size:null},d3_layout_hierarchyRebind(tree,hierarchy)},d3.layout.cluster=function(){var hierarchy=d3.layout.hierarchy().sort(null).value(null),separation=d3_layout_treeSeparation,size=[1,1],nodeSize=!1;function cluster(d,i){var previousNode,nodes=hierarchy.call(this,d,i),root=nodes[0],x=0;d3_layout_hierarchyVisitAfter(root,function(node){var children=node.children;children&&children.length?(node.x=function d3_layout_clusterX(children){return children.reduce(function(x,child){return x+child.x},0)/children.length}(children),node.y=function d3_layout_clusterY(children){return 1+d3.max(children,function(child){return child.y})}(children)):(node.x=previousNode?x+=separation(node,previousNode):0,node.y=0,previousNode=node)});var left=function d3_layout_clusterLeft(node){var children=node.children;return children&&children.length?d3_layout_clusterLeft(children[0]):node}(root),right=function d3_layout_clusterRight(node){var n,children=node.children;return children&&(n=children.length)?d3_layout_clusterRight(children[n-1]):node}(root),x0=left.x-separation(left,right)/2,x1=right.x+separation(right,left)/2;return d3_layout_hierarchyVisitAfter(root,nodeSize?function(node){node.x=(node.x-root.x)*size[0],node.y=(root.y-node.y)*size[1]}:function(node){node.x=(node.x-x0)/(x1-x0)*size[0],node.y=(1-(root.y?node.y/root.y:1))*size[1]}),nodes}return cluster.separation=function(x){return arguments.length?(separation=x,cluster):separation},cluster.size=function(x){return arguments.length?(nodeSize=null==(size=x),cluster):nodeSize?null:size},cluster.nodeSize=function(x){return arguments.length?(nodeSize=null!=(size=x),cluster):nodeSize?size:null},d3_layout_hierarchyRebind(cluster,hierarchy)},d3.layout.treemap=function(){var stickies,hierarchy=d3.layout.hierarchy(),round=Math.round,size=[1,1],padding=null,pad=d3_layout_treemapPadNull,sticky=!1,mode="squarify",ratio=.5*(1+Math.sqrt(5));function scale(children,k){for(var child,area,i=-1,n=children.length;++i<n;)area=(child=children[i]).value*(k<0?0:k),child.area=isNaN(area)||area<=0?0:area}function squarify(node){var children=node.children;if(children&&children.length){var child,score,n,rect=pad(node),row=[],remaining=children.slice(),best=1/0,u="slice"===mode?rect.dx:"dice"===mode?rect.dy:"slice-dice"===mode?1&node.depth?rect.dy:rect.dx:Math.min(rect.dx,rect.dy);for(scale(remaining,rect.dx*rect.dy/node.value),row.area=0;(n=remaining.length)>0;)row.push(child=remaining[n-1]),row.area+=child.area,"squarify"!==mode||(score=worst(row,u))<=best?(remaining.pop(),best=score):(row.area-=row.pop().area,position(row,u,rect,!1),u=Math.min(rect.dx,rect.dy),row.length=row.area=0,best=1/0);row.length&&(position(row,u,rect,!0),row.length=row.area=0),children.forEach(squarify)}}function stickify(node){var children=node.children;if(children&&children.length){var child,rect=pad(node),remaining=children.slice(),row=[];for(scale(remaining,rect.dx*rect.dy/node.value),row.area=0;child=remaining.pop();)row.push(child),row.area+=child.area,null!=child.z&&(position(row,child.z?rect.dx:rect.dy,rect,!remaining.length),row.length=row.area=0);children.forEach(stickify)}}function worst(row,u){for(var r,s=row.area,rmax=0,rmin=1/0,i=-1,n=row.length;++i<n;)(r=row[i].area)&&(r<rmin&&(rmin=r),r>rmax&&(rmax=r));return u*=u,(s*=s)?Math.max(u*rmax*ratio/s,s/(u*rmin*ratio)):1/0}function position(row,u,rect,flush){var o,i=-1,n=row.length,x=rect.x,y=rect.y,v=u?round(row.area/u):0;if(u==rect.dx){for((flush||v>rect.dy)&&(v=rect.dy);++i<n;)(o=row[i]).x=x,o.y=y,o.dy=v,x+=o.dx=Math.min(rect.x+rect.dx-x,v?round(o.area/v):0);o.z=!0,o.dx+=rect.x+rect.dx-x,rect.y+=v,rect.dy-=v}else{for((flush||v>rect.dx)&&(v=rect.dx);++i<n;)(o=row[i]).x=x,o.y=y,o.dx=v,y+=o.dy=Math.min(rect.y+rect.dy-y,v?round(o.area/v):0);o.z=!1,o.dy+=rect.y+rect.dy-y,rect.x+=v,rect.dx-=v}}function treemap(d){var nodes=stickies||hierarchy(d),root=nodes[0];return root.x=root.y=0,root.value?(root.dx=size[0],root.dy=size[1]):root.dx=root.dy=0,stickies&&hierarchy.revalue(root),scale([root],root.dx*root.dy/root.value),(stickies?stickify:squarify)(root),sticky&&(stickies=nodes),nodes}return treemap.size=function(x){return arguments.length?(size=x,treemap):size},treemap.padding=function(x){if(!arguments.length)return padding;function padConstant(node){return d3_layout_treemapPad(node,x)}var type;return pad=null==(padding=x)?d3_layout_treemapPadNull:"function"==(type=typeof x)?function padFunction(node){var p=x.call(treemap,node,node.depth);return null==p?d3_layout_treemapPadNull(node):d3_layout_treemapPad(node,"number"==typeof p?[p,p,p,p]:p)}:"number"===type?(x=[x,x,x,x],padConstant):padConstant,treemap},treemap.round=function(x){return arguments.length?(round=x?Math.round:Number,treemap):round!=Number},treemap.sticky=function(x){return arguments.length?(sticky=x,stickies=null,treemap):sticky},treemap.ratio=function(x){return arguments.length?(ratio=x,treemap):ratio},treemap.mode=function(x){return arguments.length?(mode=x+"",treemap):mode},d3_layout_hierarchyRebind(treemap,hierarchy)},d3.random={normal:function(µ,σ){var n=arguments.length;return n<2&&(σ=1),n<1&&(µ=0),function(){var x,y,r;do{r=(x=2*Math.random()-1)*x+(y=2*Math.random()-1)*y}while(!r||r>1);return µ+σ*x*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(){var random=d3.random.normal.apply(d3,arguments);return function(){return Math.exp(random())}},bates:function(m){var random=d3.random.irwinHall(m);return function(){return random()/m}},irwinHall:function(m){return function(){for(var s=0,j=0;j<m;j++)s+=Math.random();return s}}},d3.scale={};var d3_scale_niceIdentity={floor:d3_identity,ceil:d3_identity};function d3_scale_polylinear(domain,range,uninterpolate,interpolate){var u=[],i=[],j=0,k=Math.min(domain.length,range.length)-1;for(domain[k]<domain[0]&&(domain=domain.slice().reverse(),range=range.slice().reverse());++j<=k;)u.push(uninterpolate(domain[j-1],domain[j])),i.push(interpolate(range[j-1],range[j]));return function(x){var j=d3.bisect(domain,x,1,k)-1;return i[j](u[j](x))}}function d3_scale_linearRebind(scale,linear){return d3.rebind(scale,linear,"range","rangeRound","interpolate","clamp")}function d3_scale_linearNice(domain,m){return d3_scale_nice(domain,d3_scale_niceStep(d3_scale_linearTickRange(domain,m)[2])),d3_scale_nice(domain,d3_scale_niceStep(d3_scale_linearTickRange(domain,m)[2])),domain}function d3_scale_linearTickRange(domain,m){null==m&&(m=10);var extent=d3_scaleExtent(domain),span=extent[1]-extent[0],step=Math.pow(10,Math.floor(Math.log(span/m)/Math.LN10)),err=m/span*step;return err<=.15?step*=10:err<=.35?step*=5:err<=.75&&(step*=2),extent[0]=Math.ceil(extent[0]/step)*step,extent[1]=Math.floor(extent[1]/step)*step+.5*step,extent[2]=step,extent}function d3_scale_linearTicks(domain,m){return d3.range.apply(d3,d3_scale_linearTickRange(domain,m))}function d3_scale_linearTickFormat(domain,m,format){var range=d3_scale_linearTickRange(domain,m);if(format){var match=d3_format_re.exec(format);if(match.shift(),"s"===match[8]){var prefix=d3.formatPrefix(Math.max(abs(range[0]),abs(range[1])));return match[7]||(match[7]="."+d3_scale_linearPrecision(prefix.scale(range[2]))),match[8]="f",format=d3.format(match.join("")),function(d){return format(prefix.scale(d))+prefix.symbol}}match[7]||(match[7]="."+function d3_scale_linearFormatPrecision(type,range){var p=d3_scale_linearPrecision(range[2]);return type in d3_scale_linearFormatSignificant?Math.abs(p-d3_scale_linearPrecision(Math.max(abs(range[0]),abs(range[1]))))+ +("e"!==type):p-2*("%"===type)}(match[8],range)),format=match.join("")}else format=",."+d3_scale_linearPrecision(range[2])+"f";return d3.format(format)}d3.scale.linear=function(){return function d3_scale_linear(domain,range,interpolate,clamp){var output,input;function rescale(){var linear=Math.min(domain.length,range.length)>2?d3_scale_polylinear:d3_scale_bilinear,uninterpolate=clamp?d3_uninterpolateClamp:d3_uninterpolateNumber;return output=linear(domain,range,uninterpolate,interpolate),input=linear(range,domain,uninterpolate,d3_interpolate),scale}function scale(x){return output(x)}scale.invert=function(y){return input(y)};scale.domain=function(x){return arguments.length?(domain=x.map(Number),rescale()):domain};scale.range=function(x){return arguments.length?(range=x,rescale()):range};scale.rangeRound=function(x){return scale.range(x).interpolate(d3_interpolateRound)};scale.clamp=function(x){return arguments.length?(clamp=x,rescale()):clamp};scale.interpolate=function(x){return arguments.length?(interpolate=x,rescale()):interpolate};scale.ticks=function(m){return d3_scale_linearTicks(domain,m)};scale.tickFormat=function(m,format){return d3_scale_linearTickFormat(domain,m,format)};scale.nice=function(m){return d3_scale_linearNice(domain,m),rescale()};scale.copy=function(){return d3_scale_linear(domain,range,interpolate,clamp)};return rescale()}([0,1],[0,1],d3_interpolate,!1)};var d3_scale_linearFormatSignificant={s:1,g:1,p:1,r:1,e:1};function d3_scale_linearPrecision(value){return-Math.floor(Math.log(value)/Math.LN10+.01)}d3.scale.log=function(){return function d3_scale_log(linear,base,positive,domain){function log(x){return(positive?Math.log(x<0?0:x):-Math.log(x>0?0:-x))/Math.log(base)}function pow(x){return positive?Math.pow(base,x):-Math.pow(base,-x)}function scale(x){return linear(log(x))}scale.invert=function(x){return pow(linear.invert(x))};scale.domain=function(x){return arguments.length?(positive=x[0]>=0,linear.domain((domain=x.map(Number)).map(log)),scale):domain};scale.base=function(_){return arguments.length?(base=+_,linear.domain(domain.map(log)),scale):base};scale.nice=function(){var niced=d3_scale_nice(domain.map(log),positive?Math:d3_scale_logNiceNegative);return linear.domain(niced),domain=niced.map(pow),scale};scale.ticks=function(){var extent=d3_scaleExtent(domain),ticks=[],u=extent[0],v=extent[1],i=Math.floor(log(u)),j=Math.ceil(log(v)),n=base%1?2:base;if(isFinite(j-i)){if(positive){for(;i<j;i++)for(var k=1;k<n;k++)ticks.push(pow(i)*k);ticks.push(pow(i))}else for(ticks.push(pow(i));i++<j;)for(var k=n-1;k>0;k--)ticks.push(pow(i)*k);for(i=0;ticks[i]<u;i++);for(j=ticks.length;ticks[j-1]>v;j--);ticks=ticks.slice(i,j)}return ticks};scale.tickFormat=function(n,format){if(!arguments.length)return d3_scale_logFormat;arguments.length<2?format=d3_scale_logFormat:"function"!=typeof format&&(format=d3.format(format));var k=Math.max(1,base*n/scale.ticks().length);return function(d){var i=d/pow(Math.round(log(d)));return i*base<base-.5&&(i*=base),i<=k?format(d):""}};scale.copy=function(){return d3_scale_log(linear.copy(),base,positive,domain)};return d3_scale_linearRebind(scale,linear)}(d3.scale.linear().domain([0,1]),10,!0,[1,10])};var d3_scale_logFormat=d3.format(".0e"),d3_scale_logNiceNegative={floor:function(x){return-Math.ceil(-x)},ceil:function(x){return-Math.floor(-x)}};function d3_scale_powPow(e){return function(x){return x<0?-Math.pow(-x,e):Math.pow(x,e)}}d3.scale.pow=function(){return function d3_scale_pow(linear,exponent,domain){var powp=d3_scale_powPow(exponent),powb=d3_scale_powPow(1/exponent);function scale(x){return linear(powp(x))}scale.invert=function(x){return powb(linear.invert(x))};scale.domain=function(x){return arguments.length?(linear.domain((domain=x.map(Number)).map(powp)),scale):domain};scale.ticks=function(m){return d3_scale_linearTicks(domain,m)};scale.tickFormat=function(m,format){return d3_scale_linearTickFormat(domain,m,format)};scale.nice=function(m){return scale.domain(d3_scale_linearNice(domain,m))};scale.exponent=function(x){return arguments.length?(powp=d3_scale_powPow(exponent=x),powb=d3_scale_powPow(1/exponent),linear.domain(domain.map(powp)),scale):exponent};scale.copy=function(){return d3_scale_pow(linear.copy(),exponent,domain)};return d3_scale_linearRebind(scale,linear)}(d3.scale.linear(),1,[0,1])},d3.scale.sqrt=function(){return d3.scale.pow().exponent(.5)},d3.scale.ordinal=function(){return function d3_scale_ordinal(domain,ranger){var index,range,rangeBand;function scale(x){return range[((index.get(x)||("range"===ranger.t?index.set(x,domain.push(x)):NaN))-1)%range.length]}function steps(start,step){return d3.range(domain.length).map(function(i){return start+step*i})}scale.domain=function(x){if(!arguments.length)return domain;domain=[],index=new d3_Map;for(var xi,i=-1,n=x.length;++i<n;)index.has(xi=x[i])||index.set(xi,domain.push(xi));return scale[ranger.t].apply(scale,ranger.a)};scale.range=function(x){return arguments.length?(range=x,rangeBand=0,ranger={t:"range",a:arguments},scale):range};scale.rangePoints=function(x,padding){arguments.length<2&&(padding=0);var start=x[0],stop=x[1],step=domain.length<2?(start=(start+stop)/2,0):(stop-start)/(domain.length-1+padding);return range=steps(start+step*padding/2,step),rangeBand=0,ranger={t:"rangePoints",a:arguments},scale};scale.rangeRoundPoints=function(x,padding){arguments.length<2&&(padding=0);var start=x[0],stop=x[1],step=domain.length<2?(start=stop=Math.round((start+stop)/2),0):(stop-start)/(domain.length-1+padding)|0;return range=steps(start+Math.round(step*padding/2+(stop-start-(domain.length-1+padding)*step)/2),step),rangeBand=0,ranger={t:"rangeRoundPoints",a:arguments},scale};scale.rangeBands=function(x,padding,outerPadding){arguments.length<2&&(padding=0),arguments.length<3&&(outerPadding=padding);var reverse=x[1]<x[0],start=x[reverse-0],stop=x[1-reverse],step=(stop-start)/(domain.length-padding+2*outerPadding);return range=steps(start+step*outerPadding,step),reverse&&range.reverse(),rangeBand=step*(1-padding),ranger={t:"rangeBands",a:arguments},scale};scale.rangeRoundBands=function(x,padding,outerPadding){arguments.length<2&&(padding=0),arguments.length<3&&(outerPadding=padding);var reverse=x[1]<x[0],start=x[reverse-0],stop=x[1-reverse],step=Math.floor((stop-start)/(domain.length-padding+2*outerPadding));return range=steps(start+Math.round((stop-start-(domain.length-padding)*step)/2),step),reverse&&range.reverse(),rangeBand=Math.round(step*(1-padding)),ranger={t:"rangeRoundBands",a:arguments},scale};scale.rangeBand=function(){return rangeBand};scale.rangeExtent=function(){return d3_scaleExtent(ranger.a[0])};scale.copy=function(){return d3_scale_ordinal(domain,ranger)};return scale.domain(domain)}([],{t:"range",a:[[]]})},d3.scale.category10=function(){return d3.scale.ordinal().range(d3_category10)},d3.scale.category20=function(){return d3.scale.ordinal().range(d3_category20)},d3.scale.category20b=function(){return d3.scale.ordinal().range(d3_category20b)},d3.scale.category20c=function(){return d3.scale.ordinal().range(d3_category20c)};var d3_category10=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(d3_rgbString),d3_category20=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(d3_rgbString),d3_category20b=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(d3_rgbString),d3_category20c=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(d3_rgbString);function d3_zero(){return 0}d3.scale.quantile=function(){return function d3_scale_quantile(domain,range){var thresholds;function rescale(){var k=0,q=range.length;for(thresholds=[];++k<q;)thresholds[k-1]=d3.quantile(domain,k/q);return scale}function scale(x){if(!isNaN(x=+x))return range[d3.bisect(thresholds,x)]}scale.domain=function(x){return arguments.length?(domain=x.map(d3_number).filter(d3_numeric).sort(d3_ascending),rescale()):domain};scale.range=function(x){return arguments.length?(range=x,rescale()):range};scale.quantiles=function(){return thresholds};scale.invertExtent=function(y){return(y=range.indexOf(y))<0?[NaN,NaN]:[y>0?thresholds[y-1]:domain[0],y<thresholds.length?thresholds[y]:domain[domain.length-1]]};scale.copy=function(){return d3_scale_quantile(domain,range)};return rescale()}([],[])},d3.scale.quantize=function(){return function d3_scale_quantize(x0,x1,range){var kx,i;function scale(x){return range[Math.max(0,Math.min(i,Math.floor(kx*(x-x0))))]}function rescale(){return kx=range.length/(x1-x0),i=range.length-1,scale}scale.domain=function(x){return arguments.length?(x0=+x[0],x1=+x[x.length-1],rescale()):[x0,x1]};scale.range=function(x){return arguments.length?(range=x,rescale()):range};scale.invertExtent=function(y){return[y=(y=range.indexOf(y))<0?NaN:y/kx+x0,y+1/kx]};scale.copy=function(){return d3_scale_quantize(x0,x1,range)};return rescale()}(0,1,[0,1])},d3.scale.threshold=function(){return function d3_scale_threshold(domain,range){function scale(x){if(x<=x)return range[d3.bisect(domain,x)]}scale.domain=function(_){return arguments.length?(domain=_,scale):domain};scale.range=function(_){return arguments.length?(range=_,scale):range};scale.invertExtent=function(y){return y=range.indexOf(y),[domain[y-1],domain[y]]};scale.copy=function(){return d3_scale_threshold(domain,range)};return scale}([.5],[0,1])},d3.scale.identity=function(){return function d3_scale_identity(domain){function identity(x){return+x}identity.invert=identity;identity.domain=identity.range=function(x){return arguments.length?(domain=x.map(identity),identity):domain};identity.ticks=function(m){return d3_scale_linearTicks(domain,m)};identity.tickFormat=function(m,format){return d3_scale_linearTickFormat(domain,m,format)};identity.copy=function(){return d3_scale_identity(domain)};return identity}([0,1])},d3.svg={},d3.svg.arc=function(){var innerRadius=d3_svg_arcInnerRadius,outerRadius=d3_svg_arcOuterRadius,cornerRadius=d3_zero,padRadius=d3_svg_arcAuto,startAngle=d3_svg_arcStartAngle,endAngle=d3_svg_arcEndAngle,padAngle=d3_svg_arcPadAngle;function arc(){var r0=Math.max(0,+innerRadius.apply(this,arguments)),r1=Math.max(0,+outerRadius.apply(this,arguments)),a0=startAngle.apply(this,arguments)-halfπ,a1=endAngle.apply(this,arguments)-halfπ,da=Math.abs(a1-a0),cw=a0>a1?0:1;if(r1<r0&&(rc=r1,r1=r0,r0=rc),da>=τε)return circleSegment(r1,cw)+(r0?circleSegment(r0,1-cw):"")+"Z";var rc,cr,rp,ap,x0,y0,x1,y1,x2,y2,x3,y3,p0=0,p1=0,path=[];if((ap=(+padAngle.apply(this,arguments)||0)/2)&&(rp=padRadius===d3_svg_arcAuto?Math.sqrt(r0*r0+r1*r1):+padRadius.apply(this,arguments),cw||(p1*=-1),r1&&(p1=d3_asin(rp/r1*Math.sin(ap))),r0&&(p0=d3_asin(rp/r0*Math.sin(ap)))),r1){x0=r1*Math.cos(a0+p1),y0=r1*Math.sin(a0+p1),x1=r1*Math.cos(a1-p1),y1=r1*Math.sin(a1-p1);var l1=Math.abs(a1-a0-2*p1)<=π?0:1;if(p1&&d3_svg_arcSweep(x0,y0,x1,y1)===cw^l1){var h1=(a0+a1)/2;x0=r1*Math.cos(h1),y0=r1*Math.sin(h1),x1=y1=null}}else x0=y0=0;if(r0){x2=r0*Math.cos(a1-p0),y2=r0*Math.sin(a1-p0),x3=r0*Math.cos(a0+p0),y3=r0*Math.sin(a0+p0);var l0=Math.abs(a0-a1+2*p0)<=π?0:1;if(p0&&d3_svg_arcSweep(x2,y2,x3,y3)===1-cw^l0){var h0=(a0+a1)/2;x2=r0*Math.cos(h0),y2=r0*Math.sin(h0),x3=y3=null}}else x2=y2=0;if(da>ε&&(rc=Math.min(Math.abs(r1-r0)/2,+cornerRadius.apply(this,arguments)))>.001){cr=r0<r1^cw?0:1;var rc1=rc,rc0=rc;if(da<π){var oc=null==x3?[x2,y2]:null==x1?[x0,y0]:d3_geom_polygonIntersect([x0,y0],[x3,y3],[x1,y1],[x2,y2]),ax=x0-oc[0],ay=y0-oc[1],bx=x1-oc[0],by=y1-oc[1],kc=1/Math.sin(Math.acos((ax*bx+ay*by)/(Math.sqrt(ax*ax+ay*ay)*Math.sqrt(bx*bx+by*by)))/2),lc=Math.sqrt(oc[0]*oc[0]+oc[1]*oc[1]);rc0=Math.min(rc,(r0-lc)/(kc-1)),rc1=Math.min(rc,(r1-lc)/(kc+1))}if(null!=x1){var t30=d3_svg_arcCornerTangents(null==x3?[x2,y2]:[x3,y3],[x0,y0],r1,rc1,cw),t12=d3_svg_arcCornerTangents([x1,y1],[x2,y2],r1,rc1,cw);rc===rc1?path.push("M",t30[0],"A",rc1,",",rc1," 0 0,",cr," ",t30[1],"A",r1,",",r1," 0 ",1-cw^d3_svg_arcSweep(t30[1][0],t30[1][1],t12[1][0],t12[1][1]),",",cw," ",t12[1],"A",rc1,",",rc1," 0 0,",cr," ",t12[0]):path.push("M",t30[0],"A",rc1,",",rc1," 0 1,",cr," ",t12[0])}else path.push("M",x0,",",y0);if(null!=x3){var t03=d3_svg_arcCornerTangents([x0,y0],[x3,y3],r0,-rc0,cw),t21=d3_svg_arcCornerTangents([x2,y2],null==x1?[x0,y0]:[x1,y1],r0,-rc0,cw);rc===rc0?path.push("L",t21[0],"A",rc0,",",rc0," 0 0,",cr," ",t21[1],"A",r0,",",r0," 0 ",cw^d3_svg_arcSweep(t21[1][0],t21[1][1],t03[1][0],t03[1][1]),",",1-cw," ",t03[1],"A",rc0,",",rc0," 0 0,",cr," ",t03[0]):path.push("L",t21[0],"A",rc0,",",rc0," 0 0,",cr," ",t03[0])}else path.push("L",x2,",",y2)}else path.push("M",x0,",",y0),null!=x1&&path.push("A",r1,",",r1," 0 ",l1,",",cw," ",x1,",",y1),path.push("L",x2,",",y2),null!=x3&&path.push("A",r0,",",r0," 0 ",l0,",",1-cw," ",x3,",",y3);return path.push("Z"),path.join("")}function circleSegment(r1,cw){return"M0,"+r1+"A"+r1+","+r1+" 0 1,"+cw+" 0,"+-r1+"A"+r1+","+r1+" 0 1,"+cw+" 0,"+r1}return arc.innerRadius=function(v){return arguments.length?(innerRadius=d3_functor(v),arc):innerRadius},arc.outerRadius=function(v){return arguments.length?(outerRadius=d3_functor(v),arc):outerRadius},arc.cornerRadius=function(v){return arguments.length?(cornerRadius=d3_functor(v),arc):cornerRadius},arc.padRadius=function(v){return arguments.length?(padRadius=v==d3_svg_arcAuto?d3_svg_arcAuto:d3_functor(v),arc):padRadius},arc.startAngle=function(v){return arguments.length?(startAngle=d3_functor(v),arc):startAngle},arc.endAngle=function(v){return arguments.length?(endAngle=d3_functor(v),arc):endAngle},arc.padAngle=function(v){return arguments.length?(padAngle=d3_functor(v),arc):padAngle},arc.centroid=function(){var r=(+innerRadius.apply(this,arguments)+ +outerRadius.apply(this,arguments))/2,a=(+startAngle.apply(this,arguments)+ +endAngle.apply(this,arguments))/2-halfπ;return[Math.cos(a)*r,Math.sin(a)*r]},arc};var d3_svg_arcAuto="auto";function d3_svg_arcInnerRadius(d){return d.innerRadius}function d3_svg_arcOuterRadius(d){return d.outerRadius}function d3_svg_arcStartAngle(d){return d.startAngle}function d3_svg_arcEndAngle(d){return d.endAngle}function d3_svg_arcPadAngle(d){return d&&d.padAngle}function d3_svg_arcSweep(x0,y0,x1,y1){return(x0-x1)*y0-(y0-y1)*x0>0?0:1}function d3_svg_arcCornerTangents(p0,p1,r1,rc,cw){var x01=p0[0]-p1[0],y01=p0[1]-p1[1],lo=(cw?rc:-rc)/Math.sqrt(x01*x01+y01*y01),ox=lo*y01,oy=-lo*x01,x1=p0[0]+ox,y1=p0[1]+oy,x2=p1[0]+ox,y2=p1[1]+oy,x3=(x1+x2)/2,y3=(y1+y2)/2,dx=x2-x1,dy=y2-y1,d2=dx*dx+dy*dy,r=r1-rc,D=x1*y2-x2*y1,d=(dy<0?-1:1)*Math.sqrt(Math.max(0,r*r*d2-D*D)),cx0=(D*dy-dx*d)/d2,cy0=(-D*dx-dy*d)/d2,cx1=(D*dy+dx*d)/d2,cy1=(-D*dx+dy*d)/d2,dx0=cx0-x3,dy0=cy0-y3,dx1=cx1-x3,dy1=cy1-y3;return dx0*dx0+dy0*dy0>dx1*dx1+dy1*dy1&&(cx0=cx1,cy0=cy1),[[cx0-ox,cy0-oy],[cx0*r1/r,cy0*r1/r]]}function d3_svg_line(projection){var x=d3_geom_pointX,y=d3_geom_pointY,defined=d3_true,interpolate=d3_svg_lineLinear,interpolateKey=interpolate.key,tension=.7;function line(data){var d,segments=[],points=[],i=-1,n=data.length,fx=d3_functor(x),fy=d3_functor(y);function segment(){segments.push("M",interpolate(projection(points),tension))}for(;++i<n;)defined.call(this,d=data[i],i)?points.push([+fx.call(this,d,i),+fy.call(this,d,i)]):points.length&&(segment(),points=[]);return points.length&&segment(),segments.length?segments.join(""):null}return line.x=function(_){return arguments.length?(x=_,line):x},line.y=function(_){return arguments.length?(y=_,line):y},line.defined=function(_){return arguments.length?(defined=_,line):defined},line.interpolate=function(_){return arguments.length?(interpolateKey="function"==typeof _?interpolate=_:(interpolate=d3_svg_lineInterpolators.get(_)||d3_svg_lineLinear).key,line):interpolateKey},line.tension=function(_){return arguments.length?(tension=_,line):tension},line}d3.svg.line=function(){return d3_svg_line(d3_identity)};var d3_svg_lineInterpolators=d3.map({linear:d3_svg_lineLinear,"linear-closed":d3_svg_lineLinearClosed,step:function d3_svg_lineStep(points){var i=0,n=points.length,p=points[0],path=[p[0],",",p[1]];for(;++i<n;)path.push("H",(p[0]+(p=points[i])[0])/2,"V",p[1]);n>1&&path.push("H",p[0]);return path.join("")},"step-before":d3_svg_lineStepBefore,"step-after":d3_svg_lineStepAfter,basis:d3_svg_lineBasis,"basis-open":function d3_svg_lineBasisOpen(points){if(points.length<4)return d3_svg_lineLinear(points);var pi,path=[],i=-1,n=points.length,px=[0],py=[0];for(;++i<3;)pi=points[i],px.push(pi[0]),py.push(pi[1]);path.push(d3_svg_lineDot4(d3_svg_lineBasisBezier3,px)+","+d3_svg_lineDot4(d3_svg_lineBasisBezier3,py)),--i;for(;++i<n;)pi=points[i],px.shift(),px.push(pi[0]),py.shift(),py.push(pi[1]),d3_svg_lineBasisBezier(path,px,py);return path.join("")},"basis-closed":function d3_svg_lineBasisClosed(points){var path,pi,i=-1,n=points.length,m=n+4,px=[],py=[];for(;++i<4;)pi=points[i%n],px.push(pi[0]),py.push(pi[1]);path=[d3_svg_lineDot4(d3_svg_lineBasisBezier3,px),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,py)],--i;for(;++i<m;)pi=points[i%n],px.shift(),px.push(pi[0]),py.shift(),py.push(pi[1]),d3_svg_lineBasisBezier(path,px,py);return path.join("")},bundle:function d3_svg_lineBundle(points,tension){var n=points.length-1;if(n)for(var p,t,x0=points[0][0],y0=points[0][1],dx=points[n][0]-x0,dy=points[n][1]-y0,i=-1;++i<=n;)p=points[i],t=i/n,p[0]=tension*p[0]+(1-tension)*(x0+t*dx),p[1]=tension*p[1]+(1-tension)*(y0+t*dy);return d3_svg_lineBasis(points)},cardinal:function d3_svg_lineCardinal(points,tension){return points.length<3?d3_svg_lineLinear(points):points[0]+d3_svg_lineHermite(points,d3_svg_lineCardinalTangents(points,tension))},"cardinal-open":function d3_svg_lineCardinalOpen(points,tension){return points.length<4?d3_svg_lineLinear(points):points[1]+d3_svg_lineHermite(points.slice(1,-1),d3_svg_lineCardinalTangents(points,tension))},"cardinal-closed":function d3_svg_lineCardinalClosed(points,tension){return points.length<3?d3_svg_lineLinearClosed(points):points[0]+d3_svg_lineHermite((points.push(points[0]),points),d3_svg_lineCardinalTangents([points[points.length-2]].concat(points,[points[1]]),tension))},monotone:function d3_svg_lineMonotone(points){return points.length<3?d3_svg_lineLinear(points):points[0]+d3_svg_lineHermite(points,function d3_svg_lineMonotoneTangents(points){var d,a,b,s,tangents=[],m=function d3_svg_lineFiniteDifferences(points){var i=0,j=points.length-1,m=[],p0=points[0],p1=points[1],d=m[0]=d3_svg_lineSlope(p0,p1);for(;++i<j;)m[i]=(d+(d=d3_svg_lineSlope(p0=p1,p1=points[i+1])))/2;return m[i]=d,m}(points),i=-1,j=points.length-1;for(;++i<j;)d=d3_svg_lineSlope(points[i],points[i+1]),abs(d)<ε?m[i]=m[i+1]=0:(a=m[i]/d,b=m[i+1]/d,(s=a*a+b*b)>9&&(s=3*d/Math.sqrt(s),m[i]=s*a,m[i+1]=s*b));i=-1;for(;++i<=j;)s=(points[Math.min(j,i+1)][0]-points[Math.max(0,i-1)][0])/(6*(1+m[i]*m[i])),tangents.push([s||0,m[i]*s||0]);return tangents}(points))}});function d3_svg_lineLinear(points){return points.length>1?points.join("L"):points+"Z"}function d3_svg_lineLinearClosed(points){return points.join("L")+"Z"}function d3_svg_lineStepBefore(points){for(var i=0,n=points.length,p=points[0],path=[p[0],",",p[1]];++i<n;)path.push("V",(p=points[i])[1],"H",p[0]);return path.join("")}function d3_svg_lineStepAfter(points){for(var i=0,n=points.length,p=points[0],path=[p[0],",",p[1]];++i<n;)path.push("H",(p=points[i])[0],"V",p[1]);return path.join("")}function d3_svg_lineHermite(points,tangents){if(tangents.length<1||points.length!=tangents.length&&points.length!=tangents.length+2)return d3_svg_lineLinear(points);var quad=points.length!=tangents.length,path="",p0=points[0],p=points[1],t0=tangents[0],t=t0,pi=1;if(quad&&(path+="Q"+(p[0]-2*t0[0]/3)+","+(p[1]-2*t0[1]/3)+","+p[0]+","+p[1],p0=points[1],pi=2),tangents.length>1){t=tangents[1],p=points[pi],pi++,path+="C"+(p0[0]+t0[0])+","+(p0[1]+t0[1])+","+(p[0]-t[0])+","+(p[1]-t[1])+","+p[0]+","+p[1];for(var i=2;i<tangents.length;i++,pi++)p=points[pi],t=tangents[i],path+="S"+(p[0]-t[0])+","+(p[1]-t[1])+","+p[0]+","+p[1]}if(quad){var lp=points[pi];path+="Q"+(p[0]+2*t[0]/3)+","+(p[1]+2*t[1]/3)+","+lp[0]+","+lp[1]}return path}function d3_svg_lineCardinalTangents(points,tension){for(var p0,tangents=[],a=(1-tension)/2,p1=points[0],p2=points[1],i=1,n=points.length;++i<n;)p0=p1,p1=p2,p2=points[i],tangents.push([a*(p2[0]-p0[0]),a*(p2[1]-p0[1])]);return tangents}function d3_svg_lineBasis(points){if(points.length<3)return d3_svg_lineLinear(points);var i=1,n=points.length,pi=points[0],x0=pi[0],y0=pi[1],px=[x0,x0,x0,(pi=points[1])[0]],py=[y0,y0,y0,pi[1]],path=[x0,",",y0,"L",d3_svg_lineDot4(d3_svg_lineBasisBezier3,px),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,py)];for(points.push(points[n-1]);++i<=n;)pi=points[i],px.shift(),px.push(pi[0]),py.shift(),py.push(pi[1]),d3_svg_lineBasisBezier(path,px,py);return points.pop(),path.push("L",pi),path.join("")}function d3_svg_lineDot4(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}d3_svg_lineInterpolators.forEach(function(key,value){value.key=key,value.closed=/-closed$/.test(key)});var d3_svg_lineBasisBezier1=[0,2/3,1/3,0],d3_svg_lineBasisBezier2=[0,1/3,2/3,0],d3_svg_lineBasisBezier3=[0,1/6,2/3,1/6];function d3_svg_lineBasisBezier(path,x,y){path.push("C",d3_svg_lineDot4(d3_svg_lineBasisBezier1,x),",",d3_svg_lineDot4(d3_svg_lineBasisBezier1,y),",",d3_svg_lineDot4(d3_svg_lineBasisBezier2,x),",",d3_svg_lineDot4(d3_svg_lineBasisBezier2,y),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,x),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,y))}function d3_svg_lineSlope(p0,p1){return(p1[1]-p0[1])/(p1[0]-p0[0])}function d3_svg_lineRadial(points){for(var point,r,a,i=-1,n=points.length;++i<n;)r=(point=points[i])[0],a=point[1]-halfπ,point[0]=r*Math.cos(a),point[1]=r*Math.sin(a);return points}function d3_svg_area(projection){var x0=d3_geom_pointX,x1=d3_geom_pointX,y0=0,y1=d3_geom_pointY,defined=d3_true,interpolate=d3_svg_lineLinear,interpolateKey=interpolate.key,interpolateReverse=interpolate,L="L",tension=.7;function area(data){var d,x,y,segments=[],points0=[],points1=[],i=-1,n=data.length,fx0=d3_functor(x0),fy0=d3_functor(y0),fx1=x0===x1?function(){return x}:d3_functor(x1),fy1=y0===y1?function(){return y}:d3_functor(y1);function segment(){segments.push("M",interpolate(projection(points1),tension),L,interpolateReverse(projection(points0.reverse()),tension),"Z")}for(;++i<n;)defined.call(this,d=data[i],i)?(points0.push([x=+fx0.call(this,d,i),y=+fy0.call(this,d,i)]),points1.push([+fx1.call(this,d,i),+fy1.call(this,d,i)])):points0.length&&(segment(),points0=[],points1=[]);return points0.length&&segment(),segments.length?segments.join(""):null}return area.x=function(_){return arguments.length?(x0=x1=_,area):x1},area.x0=function(_){return arguments.length?(x0=_,area):x0},area.x1=function(_){return arguments.length?(x1=_,area):x1},area.y=function(_){return arguments.length?(y0=y1=_,area):y1},area.y0=function(_){return arguments.length?(y0=_,area):y0},area.y1=function(_){return arguments.length?(y1=_,area):y1},area.defined=function(_){return arguments.length?(defined=_,area):defined},area.interpolate=function(_){return arguments.length?(interpolateKey="function"==typeof _?interpolate=_:(interpolate=d3_svg_lineInterpolators.get(_)||d3_svg_lineLinear).key,interpolateReverse=interpolate.reverse||interpolate,L=interpolate.closed?"M":"L",area):interpolateKey},area.tension=function(_){return arguments.length?(tension=_,area):tension},area}function d3_svg_chordRadius(d){return d.radius}function d3_svg_diagonalProjection(d){return[d.x,d.y]}function d3_svg_symbolSize(){return 64}function d3_svg_symbolType(){return"circle"}function d3_svg_symbolCircle(size){var r=Math.sqrt(size/π);return"M0,"+r+"A"+r+","+r+" 0 1,1 0,"+-r+"A"+r+","+r+" 0 1,1 0,"+r+"Z"}d3.svg.line.radial=function(){var line=d3_svg_line(d3_svg_lineRadial);return line.radius=line.x,delete line.x,line.angle=line.y,delete line.y,line},d3_svg_lineStepBefore.reverse=d3_svg_lineStepAfter,d3_svg_lineStepAfter.reverse=d3_svg_lineStepBefore,d3.svg.area=function(){return d3_svg_area(d3_identity)},d3.svg.area.radial=function(){var area=d3_svg_area(d3_svg_lineRadial);return area.radius=area.x,delete area.x,area.innerRadius=area.x0,delete area.x0,area.outerRadius=area.x1,delete area.x1,area.angle=area.y,delete area.y,area.startAngle=area.y0,delete area.y0,area.endAngle=area.y1,delete area.y1,area},d3.svg.chord=function(){var source=d3_source,target=d3_target,radius=d3_svg_chordRadius,startAngle=d3_svg_arcStartAngle,endAngle=d3_svg_arcEndAngle;function chord(d,i){var s=subgroup(this,source,d,i),t=subgroup(this,target,d,i);return"M"+s.p0+arc(s.r,s.p1,s.a1-s.a0)+(function equals(a,b){return a.a0==b.a0&&a.a1==b.a1}(s,t)?curve(s.r,s.p1,s.r,s.p0):curve(s.r,s.p1,t.r,t.p0)+arc(t.r,t.p1,t.a1-t.a0)+curve(t.r,t.p1,s.r,s.p0))+"Z"}function subgroup(self,f,d,i){var subgroup=f.call(self,d,i),r=radius.call(self,subgroup,i),a0=startAngle.call(self,subgroup,i)-halfπ,a1=endAngle.call(self,subgroup,i)-halfπ;return{r:r,a0:a0,a1:a1,p0:[r*Math.cos(a0),r*Math.sin(a0)],p1:[r*Math.cos(a1),r*Math.sin(a1)]}}function arc(r,p,a){return"A"+r+","+r+" 0 "+ +(a>π)+",1 "+p}function curve(r0,p0,r1,p1){return"Q 0,0 "+p1}return chord.radius=function(v){return arguments.length?(radius=d3_functor(v),chord):radius},chord.source=function(v){return arguments.length?(source=d3_functor(v),chord):source},chord.target=function(v){return arguments.length?(target=d3_functor(v),chord):target},chord.startAngle=function(v){return arguments.length?(startAngle=d3_functor(v),chord):startAngle},chord.endAngle=function(v){return arguments.length?(endAngle=d3_functor(v),chord):endAngle},chord},d3.svg.diagonal=function(){var source=d3_source,target=d3_target,projection=d3_svg_diagonalProjection;function diagonal(d,i){var p0=source.call(this,d,i),p3=target.call(this,d,i),m=(p0.y+p3.y)/2,p=[p0,{x:p0.x,y:m},{x:p3.x,y:m},p3];return"M"+(p=p.map(projection))[0]+"C"+p[1]+" "+p[2]+" "+p[3]}return diagonal.source=function(x){return arguments.length?(source=d3_functor(x),diagonal):source},diagonal.target=function(x){return arguments.length?(target=d3_functor(x),diagonal):target},diagonal.projection=function(x){return arguments.length?(projection=x,diagonal):projection},diagonal},d3.svg.diagonal.radial=function(){var diagonal=d3.svg.diagonal(),projection=d3_svg_diagonalProjection,projection_=diagonal.projection;return diagonal.projection=function(x){return arguments.length?projection_(function d3_svg_diagonalRadialProjection(projection){return function(){var d=projection.apply(this,arguments),r=d[0],a=d[1]-halfπ;return[r*Math.cos(a),r*Math.sin(a)]}}(projection=x)):projection},diagonal},d3.svg.symbol=function(){var type=d3_svg_symbolType,size=d3_svg_symbolSize;function symbol(d,i){return(d3_svg_symbols.get(type.call(this,d,i))||d3_svg_symbolCircle)(size.call(this,d,i))}return symbol.type=function(x){return arguments.length?(type=d3_functor(x),symbol):type},symbol.size=function(x){return arguments.length?(size=d3_functor(x),symbol):size},symbol};var d3_svg_symbols=d3.map({circle:d3_svg_symbolCircle,cross:function(size){var r=Math.sqrt(size/5)/2;return"M"+-3*r+","+-r+"H"+-r+"V"+-3*r+"H"+r+"V"+-r+"H"+3*r+"V"+r+"H"+r+"V"+3*r+"H"+-r+"V"+r+"H"+-3*r+"Z"},diamond:function(size){var ry=Math.sqrt(size/(2*d3_svg_symbolTan30)),rx=ry*d3_svg_symbolTan30;return"M0,"+-ry+"L"+rx+",0 0,"+ry+" "+-rx+",0Z"},square:function(size){var r=Math.sqrt(size)/2;return"M"+-r+","+-r+"L"+r+","+-r+" "+r+","+r+" "+-r+","+r+"Z"},"triangle-down":function(size){var rx=Math.sqrt(size/d3_svg_symbolSqrt3),ry=rx*d3_svg_symbolSqrt3/2;return"M0,"+ry+"L"+rx+","+-ry+" "+-rx+","+-ry+"Z"},"triangle-up":function(size){var rx=Math.sqrt(size/d3_svg_symbolSqrt3),ry=rx*d3_svg_symbolSqrt3/2;return"M0,"+-ry+"L"+rx+","+ry+" "+-rx+","+ry+"Z"}});d3.svg.symbolTypes=d3_svg_symbols.keys();var d3_svg_symbolSqrt3=Math.sqrt(3),d3_svg_symbolTan30=Math.tan(30*d3_radians);d3_selectionPrototype.transition=function(name){for(var subgroup,node,id=d3_transitionInheritId||++d3_transitionId,ns=d3_transitionNamespace(name),subgroups=[],transition=d3_transitionInherit||{time:Date.now(),ease:d3_ease_cubicInOut,delay:0,duration:250},j=-1,m=this.length;++j<m;){subgroups.push(subgroup=[]);for(var group=this[j],i=-1,n=group.length;++i<n;)(node=group[i])&&d3_transitionNode(node,i,ns,id,transition),subgroup.push(node)}return d3_transition(subgroups,ns,id)},d3_selectionPrototype.interrupt=function(name){return this.each(null==name?d3_selection_interrupt:d3_selection_interruptNS(d3_transitionNamespace(name)))};var d3_selection_interrupt=d3_selection_interruptNS(d3_transitionNamespace());function d3_selection_interruptNS(ns){return function(){var lock,activeId,active;(lock=this[ns])&&(active=lock[activeId=lock.active])&&(active.timer.c=null,active.timer.t=NaN,--lock.count?delete lock[activeId]:delete this[ns],lock.active+=.5,active.event&&active.event.interrupt.call(this,this.__data__,active.index))}}function d3_transition(groups,ns,id){return d3_subclass(groups,d3_transitionPrototype),groups.namespace=ns,groups.id=id,groups}var d3_transitionInheritId,d3_transitionInherit,d3_transitionPrototype=[],d3_transitionId=0;function d3_transition_tween(groups,name,value,tween){var id=groups.id,ns=groups.namespace;return d3_selection_each(groups,"function"==typeof value?function(node,i,j){node[ns][id].tween.set(name,tween(value.call(node,node.__data__,i,j)))}:(value=tween(value),function(node){node[ns][id].tween.set(name,value)}))}function d3_transition_text(b){return null==b&&(b=""),function(){this.textContent=b}}function d3_transitionNamespace(name){return null==name?"__transition__":"__transition_"+name+"__"}function d3_transitionNode(node,i,ns,id,inherit){var time,timer,duration,ease,tweens,lock=node[ns]||(node[ns]={active:0,count:0}),transition=lock[id];function start(elapsed){var activeId=lock.active,active=lock[activeId];for(var cancelId in active&&(active.timer.c=null,active.timer.t=NaN,--lock.count,delete lock[activeId],active.event&&active.event.interrupt.call(node,node.__data__,active.index)),lock)if(+cancelId<id){var cancel=lock[cancelId];cancel.timer.c=null,cancel.timer.t=NaN,--lock.count,delete lock[cancelId]}timer.c=tick,d3_timer(function(){return timer.c&&tick(elapsed||1)&&(timer.c=null,timer.t=NaN),1},0,time),lock.active=id,transition.event&&transition.event.start.call(node,node.__data__,i),tweens=[],transition.tween.forEach(function(key,value){(value=value.call(node,node.__data__,i))&&tweens.push(value)}),ease=transition.ease,duration=transition.duration}function tick(elapsed){for(var t=elapsed/duration,e=ease(t),n=tweens.length;n>0;)tweens[--n].call(node,e);if(t>=1)return transition.event&&transition.event.end.call(node,node.__data__,i),--lock.count?delete lock[id]:delete node[ns],1}transition||(time=inherit.time,timer=d3_timer(function schedule(elapsed){var delay=transition.delay;if(timer.t=delay+time,delay<=elapsed)return start(elapsed-delay);timer.c=start},0,time),transition=lock[id]={tween:new d3_Map,time:time,timer:timer,delay:inherit.delay,duration:inherit.duration,ease:inherit.ease,index:i},inherit=null,++lock.count)}d3_transitionPrototype.call=d3_selectionPrototype.call,d3_transitionPrototype.empty=d3_selectionPrototype.empty,d3_transitionPrototype.node=d3_selectionPrototype.node,d3_transitionPrototype.size=d3_selectionPrototype.size,d3.transition=function(selection,name){return selection&&selection.transition?d3_transitionInheritId?selection.transition(name):selection:d3.selection().transition(selection)},d3.transition.prototype=d3_transitionPrototype,d3_transitionPrototype.select=function(selector){var subgroup,subnode,node,id=this.id,ns=this.namespace,subgroups=[];selector=d3_selection_selector(selector);for(var j=-1,m=this.length;++j<m;){subgroups.push(subgroup=[]);for(var group=this[j],i=-1,n=group.length;++i<n;)(node=group[i])&&(subnode=selector.call(node,node.__data__,i,j))?("__data__"in node&&(subnode.__data__=node.__data__),d3_transitionNode(subnode,i,ns,id,node[ns][id]),subgroup.push(subnode)):subgroup.push(null)}return d3_transition(subgroups,ns,id)},d3_transitionPrototype.selectAll=function(selector){var subgroup,subnodes,node,subnode,transition,id=this.id,ns=this.namespace,subgroups=[];selector=d3_selection_selectorAll(selector);for(var j=-1,m=this.length;++j<m;)for(var group=this[j],i=-1,n=group.length;++i<n;)if(node=group[i]){transition=node[ns][id],subnodes=selector.call(node,node.__data__,i,j),subgroups.push(subgroup=[]);for(var k=-1,o=subnodes.length;++k<o;)(subnode=subnodes[k])&&d3_transitionNode(subnode,k,ns,id,transition),subgroup.push(subnode)}return d3_transition(subgroups,ns,id)},d3_transitionPrototype.filter=function(filter){var subgroup,node,subgroups=[];"function"!=typeof filter&&(filter=d3_selection_filter(filter));for(var j=0,m=this.length;j<m;j++){subgroups.push(subgroup=[]);for(var group,i=0,n=(group=this[j]).length;i<n;i++)(node=group[i])&&filter.call(node,node.__data__,i,j)&&subgroup.push(node)}return d3_transition(subgroups,this.namespace,this.id)},d3_transitionPrototype.tween=function(name,tween){var id=this.id,ns=this.namespace;return arguments.length<2?this.node()[ns][id].tween.get(name):d3_selection_each(this,null==tween?function(node){node[ns][id].tween.remove(name)}:function(node){node[ns][id].tween.set(name,tween)})},d3_transitionPrototype.attr=function(nameNS,value){if(arguments.length<2){for(value in nameNS)this.attr(value,nameNS[value]);return this}var interpolate="transform"==nameNS?d3_interpolateTransform:d3_interpolate,name=d3.ns.qualify(nameNS);function attrNull(){this.removeAttribute(name)}function attrNullNS(){this.removeAttributeNS(name.space,name.local)}return d3_transition_tween(this,"attr."+nameNS,value,name.local?function attrTweenNS(b){return null==b?attrNullNS:(b+="",function(){var i,a=this.getAttributeNS(name.space,name.local);return a!==b&&(i=interpolate(a,b),function(t){this.setAttributeNS(name.space,name.local,i(t))})})}:function attrTween(b){return null==b?attrNull:(b+="",function(){var i,a=this.getAttribute(name);return a!==b&&(i=interpolate(a,b),function(t){this.setAttribute(name,i(t))})})})},d3_transitionPrototype.attrTween=function(nameNS,tween){var name=d3.ns.qualify(nameNS);return this.tween("attr."+nameNS,name.local?function attrTweenNS(d,i){var f=tween.call(this,d,i,this.getAttributeNS(name.space,name.local));return f&&function(t){this.setAttributeNS(name.space,name.local,f(t))}}:function attrTween(d,i){var f=tween.call(this,d,i,this.getAttribute(name));return f&&function(t){this.setAttribute(name,f(t))}})},d3_transitionPrototype.style=function(name,value,priority){var n=arguments.length;if(n<3){if("string"!=typeof name){for(priority in n<2&&(value=""),name)this.style(priority,name[priority],value);return this}priority=""}function styleNull(){this.style.removeProperty(name)}return d3_transition_tween(this,"style."+name,value,function styleString(b){return null==b?styleNull:(b+="",function(){var i,a=d3_window(this).getComputedStyle(this,null).getPropertyValue(name);return a!==b&&(i=d3_interpolate(a,b),function(t){this.style.setProperty(name,i(t),priority)})})})},d3_transitionPrototype.styleTween=function(name,tween,priority){return arguments.length<3&&(priority=""),this.tween("style."+name,function styleTween(d,i){var f=tween.call(this,d,i,d3_window(this).getComputedStyle(this,null).getPropertyValue(name));return f&&function(t){this.style.setProperty(name,f(t),priority)}})},d3_transitionPrototype.text=function(value){return d3_transition_tween(this,"text",value,d3_transition_text)},d3_transitionPrototype.remove=function(){var ns=this.namespace;return this.each("end.transition",function(){var p;this[ns].count<2&&(p=this.parentNode)&&p.removeChild(this)})},d3_transitionPrototype.ease=function(value){var id=this.id,ns=this.namespace;return arguments.length<1?this.node()[ns][id].ease:("function"!=typeof value&&(value=d3.ease.apply(d3,arguments)),d3_selection_each(this,function(node){node[ns][id].ease=value}))},d3_transitionPrototype.delay=function(value){var id=this.id,ns=this.namespace;return arguments.length<1?this.node()[ns][id].delay:d3_selection_each(this,"function"==typeof value?function(node,i,j){node[ns][id].delay=+value.call(node,node.__data__,i,j)}:(value=+value,function(node){node[ns][id].delay=value}))},d3_transitionPrototype.duration=function(value){var id=this.id,ns=this.namespace;return arguments.length<1?this.node()[ns][id].duration:d3_selection_each(this,"function"==typeof value?function(node,i,j){node[ns][id].duration=Math.max(1,value.call(node,node.__data__,i,j))}:(value=Math.max(1,value),function(node){node[ns][id].duration=value}))},d3_transitionPrototype.each=function(type,listener){var id=this.id,ns=this.namespace;if(arguments.length<2){var inherit=d3_transitionInherit,inheritId=d3_transitionInheritId;try{d3_transitionInheritId=id,d3_selection_each(this,function(node,i,j){d3_transitionInherit=node[ns][id],type.call(node,node.__data__,i,j)})}finally{d3_transitionInherit=inherit,d3_transitionInheritId=inheritId}}else d3_selection_each(this,function(node){var transition=node[ns][id];(transition.event||(transition.event=d3.dispatch("start","end","interrupt"))).on(type,listener)});return this},d3_transitionPrototype.transition=function(){for(var subgroup,node,transition,id0=this.id,id1=++d3_transitionId,ns=this.namespace,subgroups=[],j=0,m=this.length;j<m;j++){subgroups.push(subgroup=[]);for(var group,i=0,n=(group=this[j]).length;i<n;i++)(node=group[i])&&d3_transitionNode(node,i,ns,id1,{time:(transition=node[ns][id0]).time,ease:transition.ease,delay:transition.delay+transition.duration,duration:transition.duration}),subgroup.push(node)}return d3_transition(subgroups,ns,id1)},d3.svg.axis=function(){var tickFormat_,scale=d3.scale.linear(),orient=d3_svg_axisDefaultOrient,innerTickSize=6,outerTickSize=6,tickPadding=3,tickArguments_=[10],tickValues=null;function axis(g){g.each(function(){var tickTransform,g=d3.select(this),scale0=this.__chart__||scale,scale1=this.__chart__=scale.copy(),ticks=null==tickValues?scale1.ticks?scale1.ticks.apply(scale1,tickArguments_):scale1.domain():tickValues,tickFormat=null==tickFormat_?scale1.tickFormat?scale1.tickFormat.apply(scale1,tickArguments_):d3_identity:tickFormat_,tick=g.selectAll(".tick").data(ticks,scale1),tickEnter=tick.enter().insert("g",".domain").attr("class","tick").style("opacity",ε),tickExit=d3.transition(tick.exit()).style("opacity",ε).remove(),tickUpdate=d3.transition(tick.order()).style("opacity",1),tickSpacing=Math.max(innerTickSize,0)+tickPadding,range=d3_scaleRange(scale1),path=g.selectAll(".domain").data([0]),pathUpdate=(path.enter().append("path").attr("class","domain"),d3.transition(path));tickEnter.append("line"),tickEnter.append("text");var x1,x2,y1,y2,lineEnter=tickEnter.select("line"),lineUpdate=tickUpdate.select("line"),text=tick.select("text").text(tickFormat),textEnter=tickEnter.select("text"),textUpdate=tickUpdate.select("text"),sign="top"===orient||"left"===orient?-1:1;if("bottom"===orient||"top"===orient?(tickTransform=d3_svg_axisX,x1="x",y1="y",x2="x2",y2="y2",text.attr("dy",sign<0?"0em":".71em").style("text-anchor","middle"),pathUpdate.attr("d","M"+range[0]+","+sign*outerTickSize+"V0H"+range[1]+"V"+sign*outerTickSize)):(tickTransform=d3_svg_axisY,x1="y",y1="x",x2="y2",y2="x2",text.attr("dy",".32em").style("text-anchor",sign<0?"end":"start"),pathUpdate.attr("d","M"+sign*outerTickSize+","+range[0]+"H0V"+range[1]+"H"+sign*outerTickSize)),lineEnter.attr(y2,sign*innerTickSize),textEnter.attr(y1,sign*tickSpacing),lineUpdate.attr(x2,0).attr(y2,sign*innerTickSize),textUpdate.attr(x1,0).attr(y1,sign*tickSpacing),scale1.rangeBand){var x=scale1,dx=x.rangeBand()/2;scale0=scale1=function(d){return x(d)+dx}}else scale0.rangeBand?scale0=scale1:tickExit.call(tickTransform,scale1,scale0);tickEnter.call(tickTransform,scale0,scale1),tickUpdate.call(tickTransform,scale1,scale1)})}return axis.scale=function(x){return arguments.length?(scale=x,axis):scale},axis.orient=function(x){return arguments.length?(orient=x in d3_svg_axisOrients?x+"":d3_svg_axisDefaultOrient,axis):orient},axis.ticks=function(){return arguments.length?(tickArguments_=d3_array(arguments),axis):tickArguments_},axis.tickValues=function(x){return arguments.length?(tickValues=x,axis):tickValues},axis.tickFormat=function(x){return arguments.length?(tickFormat_=x,axis):tickFormat_},axis.tickSize=function(x){var n=arguments.length;return n?(innerTickSize=+x,outerTickSize=+arguments[n-1],axis):innerTickSize},axis.innerTickSize=function(x){return arguments.length?(innerTickSize=+x,axis):innerTickSize},axis.outerTickSize=function(x){return arguments.length?(outerTickSize=+x,axis):outerTickSize},axis.tickPadding=function(x){return arguments.length?(tickPadding=+x,axis):tickPadding},axis.tickSubdivide=function(){return arguments.length&&axis},axis};var d3_svg_axisDefaultOrient="bottom",d3_svg_axisOrients={top:1,right:1,bottom:1,left:1};function d3_svg_axisX(selection,x0,x1){selection.attr("transform",function(d){var v0=x0(d);return"translate("+(isFinite(v0)?v0:x1(d))+",0)"})}function d3_svg_axisY(selection,y0,y1){selection.attr("transform",function(d){var v0=y0(d);return"translate(0,"+(isFinite(v0)?v0:y1(d))+")"})}d3.svg.brush=function(){var xExtentDomain,yExtentDomain,event=d3_eventDispatch(brush,"brushstart","brush","brushend"),x=null,y=null,xExtent=[0,0],yExtent=[0,0],xClamp=!0,yClamp=!0,resizes=d3_svg_brushResizes[0];function brush(g){g.each(function(){var g=d3.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",brushstart).on("touchstart.brush",brushstart),background=g.selectAll(".background").data([0]);background.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),g.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var resize=g.selectAll(".resize").data(resizes,d3_identity);resize.exit().remove(),resize.enter().append("g").attr("class",function(d){return"resize "+d}).style("cursor",function(d){return d3_svg_brushCursor[d]}).append("rect").attr("x",function(d){return/[ew]$/.test(d)?-3:null}).attr("y",function(d){return/^[ns]/.test(d)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),resize.style("display",brush.empty()?"none":null);var range,gUpdate=d3.transition(g),backgroundUpdate=d3.transition(background);x&&(range=d3_scaleRange(x),backgroundUpdate.attr("x",range[0]).attr("width",range[1]-range[0]),redrawX(gUpdate)),y&&(range=d3_scaleRange(y),backgroundUpdate.attr("y",range[0]).attr("height",range[1]-range[0]),redrawY(gUpdate)),redraw(gUpdate)})}function redraw(g){g.selectAll(".resize").attr("transform",function(d){return"translate("+xExtent[+/e$/.test(d)]+","+yExtent[+/^s/.test(d)]+")"})}function redrawX(g){g.select(".extent").attr("x",xExtent[0]),g.selectAll(".extent,.n>rect,.s>rect").attr("width",xExtent[1]-xExtent[0])}function redrawY(g){g.select(".extent").attr("y",yExtent[0]),g.selectAll(".extent,.e>rect,.w>rect").attr("height",yExtent[1]-yExtent[0])}function brushstart(){var center,offset,target=this,eventTarget=d3.select(d3.event.target),event_=event.of(target,arguments),g=d3.select(target),resizing=eventTarget.datum(),resizingX=!/^(n|s)$/.test(resizing)&&x,resizingY=!/^(e|w)$/.test(resizing)&&y,dragging=eventTarget.classed("extent"),dragRestore=d3_event_dragSuppress(target),origin=d3.mouse(target),w=d3.select(d3_window(target)).on("keydown.brush",function keydown(){32==d3.event.keyCode&&(dragging||(center=null,origin[0]-=xExtent[1],origin[1]-=yExtent[1],dragging=2),d3_eventPreventDefault())}).on("keyup.brush",function keyup(){32==d3.event.keyCode&&2==dragging&&(origin[0]+=xExtent[1],origin[1]+=yExtent[1],dragging=0,d3_eventPreventDefault())});if(d3.event.changedTouches?w.on("touchmove.brush",brushmove).on("touchend.brush",brushend):w.on("mousemove.brush",brushmove).on("mouseup.brush",brushend),g.interrupt().selectAll("*").interrupt(),dragging)origin[0]=xExtent[0]-origin[0],origin[1]=yExtent[0]-origin[1];else if(resizing){var ex=+/w$/.test(resizing),ey=+/^n/.test(resizing);offset=[xExtent[1-ex]-origin[0],yExtent[1-ey]-origin[1]],origin[0]=xExtent[ex],origin[1]=yExtent[ey]}else d3.event.altKey&&(center=origin.slice());function brushmove(){var point=d3.mouse(target),moved=!1;offset&&(point[0]+=offset[0],point[1]+=offset[1]),dragging||(d3.event.altKey?(center||(center=[(xExtent[0]+xExtent[1])/2,(yExtent[0]+yExtent[1])/2]),origin[0]=xExtent[+(point[0]<center[0])],origin[1]=yExtent[+(point[1]<center[1])]):center=null),resizingX&&move1(point,x,0)&&(redrawX(g),moved=!0),resizingY&&move1(point,y,1)&&(redrawY(g),moved=!0),moved&&(redraw(g),event_({type:"brush",mode:dragging?"move":"resize"}))}function move1(point,scale,i){var min,max,range=d3_scaleRange(scale),r0=range[0],r1=range[1],position=origin[i],extent=i?yExtent:xExtent,size=extent[1]-extent[0];if(dragging&&(r0-=position,r1-=size+position),min=(i?yClamp:xClamp)?Math.max(r0,Math.min(r1,point[i])):point[i],dragging?max=(min+=position)+size:(center&&(position=Math.max(r0,Math.min(r1,2*center[i]-min))),position<min?(max=min,min=position):max=position),extent[0]!=min||extent[1]!=max)return i?yExtentDomain=null:xExtentDomain=null,extent[0]=min,extent[1]=max,!0}function brushend(){brushmove(),g.style("pointer-events","all").selectAll(".resize").style("display",brush.empty()?"none":null),d3.select("body").style("cursor",null),w.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),dragRestore(),event_({type:"brushend"})}g.style("pointer-events","none").selectAll(".resize").style("display",null),d3.select("body").style("cursor",eventTarget.style("cursor")),event_({type:"brushstart"}),brushmove()}return brush.event=function(g){g.each(function(){var event_=event.of(this,arguments),extent1={x:xExtent,y:yExtent,i:xExtentDomain,j:yExtentDomain},extent0=this.__chart__||extent1;this.__chart__=extent1,d3_transitionInheritId?d3.select(this).transition().each("start.brush",function(){xExtentDomain=extent0.i,yExtentDomain=extent0.j,xExtent=extent0.x,yExtent=extent0.y,event_({type:"brushstart"})}).tween("brush:brush",function(){var xi=d3_interpolateArray(xExtent,extent1.x),yi=d3_interpolateArray(yExtent,extent1.y);return xExtentDomain=yExtentDomain=null,function(t){xExtent=extent1.x=xi(t),yExtent=extent1.y=yi(t),event_({type:"brush",mode:"resize"})}}).each("end.brush",function(){xExtentDomain=extent1.i,yExtentDomain=extent1.j,event_({type:"brush",mode:"resize"}),event_({type:"brushend"})}):(event_({type:"brushstart"}),event_({type:"brush",mode:"resize"}),event_({type:"brushend"}))})},brush.x=function(z){return arguments.length?(resizes=d3_svg_brushResizes[!(x=z)<<1|!y],brush):x},brush.y=function(z){return arguments.length?(resizes=d3_svg_brushResizes[!x<<1|!(y=z)],brush):y},brush.clamp=function(z){return arguments.length?(x&&y?(xClamp=!!z[0],yClamp=!!z[1]):x?xClamp=!!z:y&&(yClamp=!!z),brush):x&&y?[xClamp,yClamp]:x?xClamp:y?yClamp:null},brush.extent=function(z){var x0,x1,y0,y1,t;return arguments.length?(x&&(x0=z[0],x1=z[1],y&&(x0=x0[0],x1=x1[0]),xExtentDomain=[x0,x1],x.invert&&(x0=x(x0),x1=x(x1)),x1<x0&&(t=x0,x0=x1,x1=t),x0==xExtent[0]&&x1==xExtent[1]||(xExtent=[x0,x1])),y&&(y0=z[0],y1=z[1],x&&(y0=y0[1],y1=y1[1]),yExtentDomain=[y0,y1],y.invert&&(y0=y(y0),y1=y(y1)),y1<y0&&(t=y0,y0=y1,y1=t),y0==yExtent[0]&&y1==yExtent[1]||(yExtent=[y0,y1])),brush):(x&&(xExtentDomain?(x0=xExtentDomain[0],x1=xExtentDomain[1]):(x0=xExtent[0],x1=xExtent[1],x.invert&&(x0=x.invert(x0),x1=x.invert(x1)),x1<x0&&(t=x0,x0=x1,x1=t))),y&&(yExtentDomain?(y0=yExtentDomain[0],y1=yExtentDomain[1]):(y0=yExtent[0],y1=yExtent[1],y.invert&&(y0=y.invert(y0),y1=y.invert(y1)),y1<y0&&(t=y0,y0=y1,y1=t))),x&&y?[[x0,y0],[x1,y1]]:x?[x0,x1]:y&&[y0,y1])},brush.clear=function(){return brush.empty()||(xExtent=[0,0],yExtent=[0,0],xExtentDomain=yExtentDomain=null),brush},brush.empty=function(){return!!x&&xExtent[0]==xExtent[1]||!!y&&yExtent[0]==yExtent[1]},d3.rebind(brush,event,"on")};var d3_svg_brushCursor={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},d3_svg_brushResizes=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],d3_time_format=d3_time.format=d3_locale_enUS.timeFormat,d3_time_formatUtc=d3_time_format.utc,d3_time_formatIso=d3_time_formatUtc("%Y-%m-%dT%H:%M:%S.%LZ");function d3_time_formatIsoNative(date){return date.toISOString()}function d3_time_scale(linear,methods,format){function scale(x){return linear(x)}function tickMethod(extent,count){var target=(extent[1]-extent[0])/count,i=d3.bisect(d3_time_scaleSteps,target);return i==d3_time_scaleSteps.length?[methods.year,d3_scale_linearTickRange(extent.map(function(d){return d/31536e6}),count)[2]]:i?methods[target/d3_time_scaleSteps[i-1]<d3_time_scaleSteps[i]/target?i-1:i]:[d3_time_scaleMilliseconds,d3_scale_linearTickRange(extent,count)[2]]}return scale.invert=function(x){return d3_time_scaleDate(linear.invert(x))},scale.domain=function(x){return arguments.length?(linear.domain(x),scale):linear.domain().map(d3_time_scaleDate)},scale.nice=function(interval,skip){var domain=scale.domain(),extent=d3_scaleExtent(domain),method=null==interval?tickMethod(extent,10):"number"==typeof interval&&tickMethod(extent,interval);function skipped(date){return!isNaN(date)&&!interval.range(date,d3_time_scaleDate(+date+1),skip).length}return method&&(interval=method[0],skip=method[1]),scale.domain(d3_scale_nice(domain,skip>1?{floor:function(date){for(;skipped(date=interval.floor(date));)date=d3_time_scaleDate(date-1);return date},ceil:function(date){for(;skipped(date=interval.ceil(date));)date=d3_time_scaleDate(+date+1);return date}}:interval))},scale.ticks=function(interval,skip){var extent=d3_scaleExtent(scale.domain()),method=null==interval?tickMethod(extent,10):"number"==typeof interval?tickMethod(extent,interval):!interval.range&&[{range:interval},skip];return method&&(interval=method[0],skip=method[1]),interval.range(extent[0],d3_time_scaleDate(+extent[1]+1),skip<1?1:skip)},scale.tickFormat=function(){return format},scale.copy=function(){return d3_time_scale(linear.copy(),methods,format)},d3_scale_linearRebind(scale,linear)}function d3_time_scaleDate(t){return new Date(t)}d3_time_format.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?d3_time_formatIsoNative:d3_time_formatIso,d3_time_formatIsoNative.parse=function(string){var date=new Date(string);return isNaN(date)?null:date},d3_time_formatIsoNative.toString=d3_time_formatIso.toString,d3_time.second=d3_time_interval(function(date){return new d3_date(1e3*Math.floor(date/1e3))},function(date,offset){date.setTime(date.getTime()+1e3*Math.floor(offset))},function(date){return date.getSeconds()}),d3_time.seconds=d3_time.second.range,d3_time.seconds.utc=d3_time.second.utc.range,d3_time.minute=d3_time_interval(function(date){return new d3_date(6e4*Math.floor(date/6e4))},function(date,offset){date.setTime(date.getTime()+6e4*Math.floor(offset))},function(date){return date.getMinutes()}),d3_time.minutes=d3_time.minute.range,d3_time.minutes.utc=d3_time.minute.utc.range,d3_time.hour=d3_time_interval(function(date){var timezone=date.getTimezoneOffset()/60;return new d3_date(36e5*(Math.floor(date/36e5-timezone)+timezone))},function(date,offset){date.setTime(date.getTime()+36e5*Math.floor(offset))},function(date){return date.getHours()}),d3_time.hours=d3_time.hour.range,d3_time.hours.utc=d3_time.hour.utc.range,d3_time.month=d3_time_interval(function(date){return(date=d3_time.day(date)).setDate(1),date},function(date,offset){date.setMonth(date.getMonth()+offset)},function(date){return date.getMonth()}),d3_time.months=d3_time.month.range,d3_time.months.utc=d3_time.month.utc.range;var d3_time_scaleSteps=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],d3_time_scaleLocalMethods=[[d3_time.second,1],[d3_time.second,5],[d3_time.second,15],[d3_time.second,30],[d3_time.minute,1],[d3_time.minute,5],[d3_time.minute,15],[d3_time.minute,30],[d3_time.hour,1],[d3_time.hour,3],[d3_time.hour,6],[d3_time.hour,12],[d3_time.day,1],[d3_time.day,2],[d3_time.week,1],[d3_time.month,1],[d3_time.month,3],[d3_time.year,1]],d3_time_scaleLocalFormat=d3_time_format.multi([[".%L",function(d){return d.getMilliseconds()}],[":%S",function(d){return d.getSeconds()}],["%I:%M",function(d){return d.getMinutes()}],["%I %p",function(d){return d.getHours()}],["%a %d",function(d){return d.getDay()&&1!=d.getDate()}],["%b %d",function(d){return 1!=d.getDate()}],["%B",function(d){return d.getMonth()}],["%Y",d3_true]]),d3_time_scaleMilliseconds={range:function(start,stop,step){return d3.range(Math.ceil(start/step)*step,+stop,step).map(d3_time_scaleDate)},floor:d3_identity,ceil:d3_identity};d3_time_scaleLocalMethods.year=d3_time.year,d3_time.scale=function(){return d3_time_scale(d3.scale.linear(),d3_time_scaleLocalMethods,d3_time_scaleLocalFormat)};var d3_time_scaleUtcMethods=d3_time_scaleLocalMethods.map(function(m){return[m[0].utc,m[1]]}),d3_time_scaleUtcFormat=d3_time_formatUtc.multi([[".%L",function(d){return d.getUTCMilliseconds()}],[":%S",function(d){return d.getUTCSeconds()}],["%I:%M",function(d){return d.getUTCMinutes()}],["%I %p",function(d){return d.getUTCHours()}],["%a %d",function(d){return d.getUTCDay()&&1!=d.getUTCDate()}],["%b %d",function(d){return 1!=d.getUTCDate()}],["%B",function(d){return d.getUTCMonth()}],["%Y",d3_true]]);function d3_json(request){return JSON.parse(request.responseText)}function d3_html(request){var range=d3_document.createRange();return range.selectNode(d3_document.body),range.createContextualFragment(request.responseText)}d3_time_scaleUtcMethods.year=d3_time.year.utc,d3_time.scale.utc=function(){return d3_time_scale(d3.scale.linear(),d3_time_scaleUtcMethods,d3_time_scaleUtcFormat)},d3.text=d3_xhrType(function(request){return request.responseText}),d3.json=function(url,callback){return d3_xhr(url,"application/json",d3_json,callback)},d3.html=function(url,callback){return d3_xhr(url,"text/html",d3_html,callback)},d3.xml=d3_xhrType(function(request){return request.responseXML}),_$d3_127.exports?_$d3_127.exports=d3:this.d3=d3}(),_$d3_127=_$d3_127.exports;var _$fastIsnumeric_139=function(n){var type=typeof n;if("string"===type){var original=n;if(0===(n=+n)&&function allBlankCharCodes(str){for(var a,l=str.length,i=0;i<l;i++)if(((a=str.charCodeAt(i))<9||a>13)&&32!==a&&133!==a&&160!==a&&5760!==a&&6158!==a&&(a<8192||a>8205)&&8232!==a&&8233!==a&&8239!==a&&8287!==a&&8288!==a&&12288!==a&&65279!==a)return!1;return!0}(original))return!1}else if("number"!==type)return!1;return n-n<1},_$angles_522={},PI=Math.PI;_$angles_522.deg2rad=function(deg){return deg/180*PI},_$angles_522.rad2deg=function(rad){return rad/PI*180},_$angles_522.wrap360=function(deg){var out=deg%360;return out<0?out+360:out},_$angles_522.wrap180=function(deg){return Math.abs(deg)>180&&(deg-=360*Math.round(deg/360)),deg};var BADNUM=_$numerical_517.BADNUM,JUNK=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g,_$tinycolor_352={exports:{}};!function(Math){var trimLeft=/^\s+/,trimRight=/\s+$/,tinyCounter=0,mathRound=Math.round,mathMin=Math.min,mathMax=Math.max,mathRandom=Math.random;function tinycolor(color,opts){if(color=color||"",opts=opts||{},color instanceof tinycolor)return color;if(!(this instanceof tinycolor))return new tinycolor(color,opts);var rgb=function inputToRGB(color){var rgb={r:0,g:0,b:0},a=1,s=null,v=null,l=null,ok=!1,format=!1;"string"==typeof color&&(color=function stringInputToObject(color){color=color.replace(trimLeft,"").replace(trimRight,"").toLowerCase();var match,named=!1;if(names[color])color=names[color],named=!0;else if("transparent"==color)return{r:0,g:0,b:0,a:0,format:"name"};if(match=matchers.rgb.exec(color))return{r:match[1],g:match[2],b:match[3]};if(match=matchers.rgba.exec(color))return{r:match[1],g:match[2],b:match[3],a:match[4]};if(match=matchers.hsl.exec(color))return{h:match[1],s:match[2],l:match[3]};if(match=matchers.hsla.exec(color))return{h:match[1],s:match[2],l:match[3],a:match[4]};if(match=matchers.hsv.exec(color))return{h:match[1],s:match[2],v:match[3]};if(match=matchers.hsva.exec(color))return{h:match[1],s:match[2],v:match[3],a:match[4]};if(match=matchers.hex8.exec(color))return{r:parseIntFromHex(match[1]),g:parseIntFromHex(match[2]),b:parseIntFromHex(match[3]),a:convertHexToDecimal(match[4]),format:named?"name":"hex8"};if(match=matchers.hex6.exec(color))return{r:parseIntFromHex(match[1]),g:parseIntFromHex(match[2]),b:parseIntFromHex(match[3]),format:named?"name":"hex"};if(match=matchers.hex4.exec(color))return{r:parseIntFromHex(match[1]+""+match[1]),g:parseIntFromHex(match[2]+""+match[2]),b:parseIntFromHex(match[3]+""+match[3]),a:convertHexToDecimal(match[4]+""+match[4]),format:named?"name":"hex8"};if(match=matchers.hex3.exec(color))return{r:parseIntFromHex(match[1]+""+match[1]),g:parseIntFromHex(match[2]+""+match[2]),b:parseIntFromHex(match[3]+""+match[3]),format:named?"name":"hex"};return!1}(color));"object"==typeof color&&(isValidCSSUnit(color.r)&&isValidCSSUnit(color.g)&&isValidCSSUnit(color.b)?(rgb=function rgbToRgb(r,g,b){return{r:255*bound01(r,255),g:255*bound01(g,255),b:255*bound01(b,255)}}(color.r,color.g,color.b),ok=!0,format="%"===String(color.r).substr(-1)?"prgb":"rgb"):isValidCSSUnit(color.h)&&isValidCSSUnit(color.s)&&isValidCSSUnit(color.v)?(s=convertToPercentage(color.s),v=convertToPercentage(color.v),rgb=function hsvToRgb(h,s,v){h=6*bound01(h,360),s=bound01(s,100),v=bound01(v,100);var i=Math.floor(h),f=h-i,p=v*(1-s),q=v*(1-f*s),t=v*(1-(1-f)*s),mod=i%6;return{r:255*[v,q,p,p,t,v][mod],g:255*[t,v,v,q,p,p][mod],b:255*[p,p,t,v,v,q][mod]}}(color.h,s,v),ok=!0,format="hsv"):isValidCSSUnit(color.h)&&isValidCSSUnit(color.s)&&isValidCSSUnit(color.l)&&(s=convertToPercentage(color.s),l=convertToPercentage(color.l),rgb=function hslToRgb(h,s,l){var r,g,b;function hue2rgb(p,q,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?p+6*(q-p)*t:t<.5?q:t<2/3?p+(q-p)*(2/3-t)*6:p}if(h=bound01(h,360),s=bound01(s,100),l=bound01(l,100),0===s)r=g=b=l;else{var q=l<.5?l*(1+s):l+s-l*s,p=2*l-q;r=hue2rgb(p,q,h+1/3),g=hue2rgb(p,q,h),b=hue2rgb(p,q,h-1/3)}return{r:255*r,g:255*g,b:255*b}}(color.h,s,l),ok=!0,format="hsl"),color.hasOwnProperty("a")&&(a=color.a));return a=boundAlpha(a),{ok:ok,format:color.format||format,r:mathMin(255,mathMax(rgb.r,0)),g:mathMin(255,mathMax(rgb.g,0)),b:mathMin(255,mathMax(rgb.b,0)),a:a}}(color);this._originalInput=color,this._r=rgb.r,this._g=rgb.g,this._b=rgb.b,this._a=rgb.a,this._roundA=mathRound(100*this._a)/100,this._format=opts.format||rgb.format,this._gradientType=opts.gradientType,this._r<1&&(this._r=mathRound(this._r)),this._g<1&&(this._g=mathRound(this._g)),this._b<1&&(this._b=mathRound(this._b)),this._ok=rgb.ok,this._tc_id=tinyCounter++}function rgbToHsl(r,g,b){r=bound01(r,255),g=bound01(g,255),b=bound01(b,255);var h,s,max=mathMax(r,g,b),min=mathMin(r,g,b),l=(max+min)/2;if(max==min)h=s=0;else{var d=max-min;switch(s=l>.5?d/(2-max-min):d/(max+min),max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return{h:h,s:s,l:l}}function rgbToHsv(r,g,b){r=bound01(r,255),g=bound01(g,255),b=bound01(b,255);var h,s,max=mathMax(r,g,b),min=mathMin(r,g,b),v=max,d=max-min;if(s=0===max?0:d/max,max==min)h=0;else{switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return{h:h,s:s,v:v}}function rgbToHex(r,g,b,allow3Char){var hex=[pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))];return allow3Char&&hex[0].charAt(0)==hex[0].charAt(1)&&hex[1].charAt(0)==hex[1].charAt(1)&&hex[2].charAt(0)==hex[2].charAt(1)?hex[0].charAt(0)+hex[1].charAt(0)+hex[2].charAt(0):hex.join("")}function rgbaToArgbHex(r,g,b,a){return[pad2(convertDecimalToHex(a)),pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))].join("")}function desaturate(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.s-=amount/100,hsl.s=clamp01(hsl.s),tinycolor(hsl)}function saturate(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.s+=amount/100,hsl.s=clamp01(hsl.s),tinycolor(hsl)}function greyscale(color){return tinycolor(color).desaturate(100)}function lighten(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.l+=amount/100,hsl.l=clamp01(hsl.l),tinycolor(hsl)}function brighten(color,amount){amount=0===amount?0:amount||10;var rgb=tinycolor(color).toRgb();return rgb.r=mathMax(0,mathMin(255,rgb.r-mathRound(-amount/100*255))),rgb.g=mathMax(0,mathMin(255,rgb.g-mathRound(-amount/100*255))),rgb.b=mathMax(0,mathMin(255,rgb.b-mathRound(-amount/100*255))),tinycolor(rgb)}function darken(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.l-=amount/100,hsl.l=clamp01(hsl.l),tinycolor(hsl)}function spin(color,amount){var hsl=tinycolor(color).toHsl(),hue=(hsl.h+amount)%360;return hsl.h=hue<0?360+hue:hue,tinycolor(hsl)}function complement(color){var hsl=tinycolor(color).toHsl();return hsl.h=(hsl.h+180)%360,tinycolor(hsl)}function triad(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+120)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+240)%360,s:hsl.s,l:hsl.l})]}function tetrad(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+90)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+180)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+270)%360,s:hsl.s,l:hsl.l})]}function splitcomplement(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+72)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+216)%360,s:hsl.s,l:hsl.l})]}function analogous(color,results,slices){results=results||6,slices=slices||30;var hsl=tinycolor(color).toHsl(),part=360/slices,ret=[tinycolor(color)];for(hsl.h=(hsl.h-(part*results>>1)+720)%360;--results;)hsl.h=(hsl.h+part)%360,ret.push(tinycolor(hsl));return ret}function monochromatic(color,results){results=results||6;for(var hsv=tinycolor(color).toHsv(),h=hsv.h,s=hsv.s,v=hsv.v,ret=[],modification=1/results;results--;)ret.push(tinycolor({h:h,s:s,v:v})),v=(v+modification)%1;return ret}tinycolor.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var rgb=this.toRgb();return(299*rgb.r+587*rgb.g+114*rgb.b)/1e3},getLuminance:function(){var RsRGB,GsRGB,BsRGB,rgb=this.toRgb();return RsRGB=rgb.r/255,GsRGB=rgb.g/255,BsRGB=rgb.b/255,.2126*(RsRGB<=.03928?RsRGB/12.92:Math.pow((RsRGB+.055)/1.055,2.4))+.7152*(GsRGB<=.03928?GsRGB/12.92:Math.pow((GsRGB+.055)/1.055,2.4))+.0722*(BsRGB<=.03928?BsRGB/12.92:Math.pow((BsRGB+.055)/1.055,2.4))},setAlpha:function(value){return this._a=boundAlpha(value),this._roundA=mathRound(100*this._a)/100,this},toHsv:function(){var hsv=rgbToHsv(this._r,this._g,this._b);return{h:360*hsv.h,s:hsv.s,v:hsv.v,a:this._a}},toHsvString:function(){var hsv=rgbToHsv(this._r,this._g,this._b),h=mathRound(360*hsv.h),s=mathRound(100*hsv.s),v=mathRound(100*hsv.v);return 1==this._a?"hsv("+h+", "+s+"%, "+v+"%)":"hsva("+h+", "+s+"%, "+v+"%, "+this._roundA+")"},toHsl:function(){var hsl=rgbToHsl(this._r,this._g,this._b);return{h:360*hsl.h,s:hsl.s,l:hsl.l,a:this._a}},toHslString:function(){var hsl=rgbToHsl(this._r,this._g,this._b),h=mathRound(360*hsl.h),s=mathRound(100*hsl.s),l=mathRound(100*hsl.l);return 1==this._a?"hsl("+h+", "+s+"%, "+l+"%)":"hsla("+h+", "+s+"%, "+l+"%, "+this._roundA+")"},toHex:function(allow3Char){return rgbToHex(this._r,this._g,this._b,allow3Char)},toHexString:function(allow3Char){return"#"+this.toHex(allow3Char)},toHex8:function(allow4Char){return function rgbaToHex(r,g,b,a,allow4Char){var hex=[pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16)),pad2(convertDecimalToHex(a))];if(allow4Char&&hex[0].charAt(0)==hex[0].charAt(1)&&hex[1].charAt(0)==hex[1].charAt(1)&&hex[2].charAt(0)==hex[2].charAt(1)&&hex[3].charAt(0)==hex[3].charAt(1))return hex[0].charAt(0)+hex[1].charAt(0)+hex[2].charAt(0)+hex[3].charAt(0);return hex.join("")}(this._r,this._g,this._b,this._a,allow4Char)},toHex8String:function(allow4Char){return"#"+this.toHex8(allow4Char)},toRgb:function(){return{r:mathRound(this._r),g:mathRound(this._g),b:mathRound(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+mathRound(this._r)+", "+mathRound(this._g)+", "+mathRound(this._b)+")":"rgba("+mathRound(this._r)+", "+mathRound(this._g)+", "+mathRound(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:mathRound(100*bound01(this._r,255))+"%",g:mathRound(100*bound01(this._g,255))+"%",b:mathRound(100*bound01(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+mathRound(100*bound01(this._r,255))+"%, "+mathRound(100*bound01(this._g,255))+"%, "+mathRound(100*bound01(this._b,255))+"%)":"rgba("+mathRound(100*bound01(this._r,255))+"%, "+mathRound(100*bound01(this._g,255))+"%, "+mathRound(100*bound01(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(hexNames[rgbToHex(this._r,this._g,this._b,!0)]||!1)},toFilter:function(secondColor){var hex8String="#"+rgbaToArgbHex(this._r,this._g,this._b,this._a),secondHex8String=hex8String,gradientType=this._gradientType?"GradientType = 1, ":"";if(secondColor){var s=tinycolor(secondColor);secondHex8String="#"+rgbaToArgbHex(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+gradientType+"startColorstr="+hex8String+",endColorstr="+secondHex8String+")"},toString:function(format){var formatSet=!!format;format=format||this._format;var formattedString=!1,hasAlpha=this._a<1&&this._a>=0;return formatSet||!hasAlpha||"hex"!==format&&"hex6"!==format&&"hex3"!==format&&"hex4"!==format&&"hex8"!==format&&"name"!==format?("rgb"===format&&(formattedString=this.toRgbString()),"prgb"===format&&(formattedString=this.toPercentageRgbString()),"hex"!==format&&"hex6"!==format||(formattedString=this.toHexString()),"hex3"===format&&(formattedString=this.toHexString(!0)),"hex4"===format&&(formattedString=this.toHex8String(!0)),"hex8"===format&&(formattedString=this.toHex8String()),"name"===format&&(formattedString=this.toName()),"hsl"===format&&(formattedString=this.toHslString()),"hsv"===format&&(formattedString=this.toHsvString()),formattedString||this.toHexString()):"name"===format&&0===this._a?this.toName():this.toRgbString()},clone:function(){return tinycolor(this.toString())},_applyModification:function(fn,args){var color=fn.apply(null,[this].concat([].slice.call(args)));return this._r=color._r,this._g=color._g,this._b=color._b,this.setAlpha(color._a),this},lighten:function(){return this._applyModification(lighten,arguments)},brighten:function(){return this._applyModification(brighten,arguments)},darken:function(){return this._applyModification(darken,arguments)},desaturate:function(){return this._applyModification(desaturate,arguments)},saturate:function(){return this._applyModification(saturate,arguments)},greyscale:function(){return this._applyModification(greyscale,arguments)},spin:function(){return this._applyModification(spin,arguments)},_applyCombination:function(fn,args){return fn.apply(null,[this].concat([].slice.call(args)))},analogous:function(){return this._applyCombination(analogous,arguments)},complement:function(){return this._applyCombination(complement,arguments)},monochromatic:function(){return this._applyCombination(monochromatic,arguments)},splitcomplement:function(){return this._applyCombination(splitcomplement,arguments)},triad:function(){return this._applyCombination(triad,arguments)},tetrad:function(){return this._applyCombination(tetrad,arguments)}},tinycolor.fromRatio=function(color,opts){if("object"==typeof color){var newColor={};for(var i in color)color.hasOwnProperty(i)&&(newColor[i]="a"===i?color[i]:convertToPercentage(color[i]));color=newColor}return tinycolor(color,opts)},tinycolor.equals=function(color1,color2){return!(!color1||!color2)&&tinycolor(color1).toRgbString()==tinycolor(color2).toRgbString()},tinycolor.random=function(){return tinycolor.fromRatio({r:mathRandom(),g:mathRandom(),b:mathRandom()})},tinycolor.mix=function(color1,color2,amount){amount=0===amount?0:amount||50;var rgb1=tinycolor(color1).toRgb(),rgb2=tinycolor(color2).toRgb(),p=amount/100;return tinycolor({r:(rgb2.r-rgb1.r)*p+rgb1.r,g:(rgb2.g-rgb1.g)*p+rgb1.g,b:(rgb2.b-rgb1.b)*p+rgb1.b,a:(rgb2.a-rgb1.a)*p+rgb1.a})},tinycolor.readability=function(color1,color2){var c1=tinycolor(color1),c2=tinycolor(color2);return(Math.max(c1.getLuminance(),c2.getLuminance())+.05)/(Math.min(c1.getLuminance(),c2.getLuminance())+.05)},tinycolor.isReadable=function(color1,color2,wcag2){var wcag2Parms,out,readability=tinycolor.readability(color1,color2);switch(out=!1,(wcag2Parms=function validateWCAG2Parms(parms){var level,size;level=((parms=parms||{level:"AA",size:"small"}).level||"AA").toUpperCase(),size=(parms.size||"small").toLowerCase(),"AA"!==level&&"AAA"!==level&&(level="AA");"small"!==size&&"large"!==size&&(size="small");return{level:level,size:size}}(wcag2)).level+wcag2Parms.size){case"AAsmall":case"AAAlarge":out=readability>=4.5;break;case"AAlarge":out=readability>=3;break;case"AAAsmall":out=readability>=7}return out},tinycolor.mostReadable=function(baseColor,colorList,args){var readability,includeFallbackColors,level,size,bestColor=null,bestScore=0;includeFallbackColors=(args=args||{}).includeFallbackColors,level=args.level,size=args.size;for(var i=0;i<colorList.length;i++)(readability=tinycolor.readability(baseColor,colorList[i]))>bestScore&&(bestScore=readability,bestColor=tinycolor(colorList[i]));return tinycolor.isReadable(baseColor,bestColor,{level:level,size:size})||!includeFallbackColors?bestColor:(args.includeFallbackColors=!1,tinycolor.mostReadable(baseColor,["#fff","#000"],args))};var names=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames=tinycolor.hexNames=function flip(o){var flipped={};for(var i in o)o.hasOwnProperty(i)&&(flipped[o[i]]=i);return flipped}(names);function boundAlpha(a){return a=parseFloat(a),(isNaN(a)||a<0||a>1)&&(a=1),a}function bound01(n,max){(function isOnePointZero(n){return"string"==typeof n&&-1!=n.indexOf(".")&&1===parseFloat(n)})(n)&&(n="100%");var processPercent=function isPercentage(n){return"string"==typeof n&&-1!=n.indexOf("%")}(n);return n=mathMin(max,mathMax(0,parseFloat(n))),processPercent&&(n=parseInt(n*max,10)/100),Math.abs(n-max)<1e-6?1:n%max/parseFloat(max)}function clamp01(val){return mathMin(1,mathMax(0,val))}function parseIntFromHex(val){return parseInt(val,16)}function pad2(c){return 1==c.length?"0"+c:""+c}function convertToPercentage(n){return n<=1&&(n=100*n+"%"),n}function convertDecimalToHex(d){return Math.round(255*parseFloat(d)).toString(16)}function convertHexToDecimal(h){return parseIntFromHex(h)/255}var CSS_UNIT,PERMISSIVE_MATCH3,PERMISSIVE_MATCH4,matchers=(PERMISSIVE_MATCH3="[\\s|\\(]+("+(CSS_UNIT="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",PERMISSIVE_MATCH4="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",{CSS_UNIT:new RegExp(CSS_UNIT),rgb:new RegExp("rgb"+PERMISSIVE_MATCH3),rgba:new RegExp("rgba"+PERMISSIVE_MATCH4),hsl:new RegExp("hsl"+PERMISSIVE_MATCH3),hsla:new RegExp("hsla"+PERMISSIVE_MATCH4),hsv:new RegExp("hsv"+PERMISSIVE_MATCH3),hsva:new RegExp("hsva"+PERMISSIVE_MATCH4),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function isValidCSSUnit(color){return!!matchers.CSS_UNIT.exec(color)}_$tinycolor_352.exports?_$tinycolor_352.exports=tinycolor:window.tinycolor=tinycolor}(Math),_$tinycolor_352=_$tinycolor_352.exports;var _$scales_430={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},_$default_scale_420=_$scales_430.RdBu,_$isValidScaleArray_428=function isValidScaleArray(scl){var highestVal=0;if(!Array.isArray(scl)||scl.length<2)return!1;if(!scl[0]||!scl[scl.length-1])return!1;if(0!=+scl[0][0]||1!=+scl[scl.length-1][0])return!1;for(var i=0;i<scl.length;i++){var si=scl[i];if(2!==si.length||+si[0]<highestVal||!_$tinycolor_352(si[1]).isValid())return!1;highestVal=+si[0]}return!0},_$getScale_424=function getScale(scl,dflt){if(dflt||(dflt=_$default_scale_420),!scl)return dflt;function parseScale(){try{scl=_$scales_430[scl]||JSON.parse(scl)}catch(e){scl=dflt}}return"string"==typeof scl&&(parseScale(),"string"==typeof scl&&parseScale()),_$isValidScaleArray_428(scl)?scl:dflt},_$interactions_516={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DBLCLICKDELAY:300,DESELECTDIM:.2},_$is_array_540={},ab="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer:{isView:function(){return!1}},dv="undefined"==typeof DataView?function(){}:DataView;_$is_array_540.isTypedArray=function(a){return ab.isView(a)&&!(a instanceof dv)},_$is_array_540.isArrayOrTypedArray=function(a){return Array.isArray(a)||_$is_array_540.isTypedArray(a)};var _$isPlainObject_541=function isPlainObject(obj){return window&&window.process&&window.process.versions?"[object Object]"===Object.prototype.toString.call(obj):"[object Object]"===Object.prototype.toString.call(obj)&&Object.getPrototypeOf(obj)===Object.prototype},_$extend_528={},isArray=Array.isArray;function _extend(inputs,isDeep,keepAllKeys,noArrayCopies){var input,key,src,copy,copyIsArray,clone,target=inputs[0],length=inputs.length;if(2===length&&isArray(target)&&isArray(inputs[1])&&0===target.length){if(function primitivesLoopSplice(source,target){var i,value;for(i=0;i<source.length;i++){if(null!==(value=source[i])&&"object"==typeof value)return!1;void 0!==value&&(target[i]=value)}return!0}(inputs[1],target))return target;target.splice(0,target.length)}for(var i=1;i<length;i++)for(key in input=inputs[i])src=target[key],copy=input[key],noArrayCopies&&isArray(copy)?target[key]=copy:isDeep&&copy&&(_$isPlainObject_541(copy)||(copyIsArray=isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&isArray(src)?src:[]):clone=src&&_$isPlainObject_541(src)?src:{},target[key]=_extend([clone,copy],isDeep,keepAllKeys,noArrayCopies)):(void 0!==copy||keepAllKeys)&&(target[key]=copy);return target}_$extend_528.extendFlat=function(){return _extend(arguments,!1,!1,!1)},_$extend_528.extendDeep=function(){return _extend(arguments,!0,!1,!1)},_$extend_528.extendDeepAll=function(){return _extend(arguments,!0,!0,!1)},_$extend_528.extendDeepNoArrays=function(){return _extend(arguments,!0,!1,!0)};var _$plot_config_574={staticPlot:!1,editable:!1,edits:{annotationPosition:!1,annotationTail:!1,annotationText:!1,axisTitleText:!1,colorbarPosition:!1,colorbarTitleText:!1,legendPosition:!1,legendText:!1,shapePosition:!1,titleText:!1},autosizable:!1,queueLength:0,fillFrame:!1,frameMargins:0,scrollZoom:!1,doubleClick:"reset+autosize",showTips:!0,showAxisDragHandles:!0,showAxisRangeEntryBoxes:!0,showLink:!1,sendData:!0,linkText:"Edit chart",showSources:!1,displayModeBar:"hover",modeBarButtonsToRemove:[],modeBarButtonsToAdd:[],modeBarButtons:!1,displaylogo:!0,plotGlPixelRatio:2,setBackground:"transparent",topojsonURL:"https://cdn.plot.ly/",mapboxAccessToken:null,logging:1,globalTransforms:[],locale:"en-US",locales:{}},_$loggers_544={},loggers=_$loggers_544={};function apply(f,args){if(f.apply)f.apply(f,args);else for(var i=0;i<args.length;i++)f(args[i])}loggers.log=function(){if(_$plot_config_574.logging>1){for(var messages=["LOG:"],i=0;i<arguments.length;i++)messages.push(arguments[i]);apply(console.trace||console.log,messages)}},loggers.warn=function(){if(_$plot_config_574.logging>0){for(var messages=["WARN:"],i=0;i<arguments.length;i++)messages.push(arguments[i]);apply(console.trace||console.log,messages)}},loggers.error=function(){if(_$plot_config_574.logging>0){for(var messages=["ERROR:"],i=0;i<arguments.length;i++)messages.push(arguments[i]);apply(console.error,messages)}};var _$noop_548=function noop(){},_$pushUnique_552=function pushUnique(array,item){if(item instanceof RegExp){var i,itemStr=item.toString();for(i=0;i<array.length;i++)if(array[i]instanceof RegExp&&array[i].toString()===itemStr)return array;array.push(item)}else!item&&0!==item||-1!==array.indexOf(item)||array.push(item);return array},_$font_attributes_611=function(opts){var editType=opts.editType,colorEditType=opts.colorEditType;void 0===colorEditType&&(colorEditType=editType);var attrs={family:{valType:"string",noBlank:!0,strict:!0,editType:editType},size:{valType:"number",min:1,editType:editType},color:{valType:"color",editType:colorEditType},editType:editType};return opts.arrayOk&&(attrs.family.arrayOk=!0,attrs.size.arrayOk=!0,attrs.color.arrayOk=!0),attrs},_$attributes_445={hoverlabel:{bgcolor:{valType:"color",arrayOk:!0,editType:"none"},bordercolor:{valType:"color",arrayOk:!0,editType:"none"},font:_$font_attributes_611({arrayOk:!0,editType:"none"}),namelength:{valType:"integer",min:-1,arrayOk:!0,editType:"none"},editType:"calc"}},_$attributes_581={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes"},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",dflt:"",editType:"calc"},ids:{valType:"data_array",editType:"calc"},customdata:{valType:"data_array",editType:"calc"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:_$attributes_445.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"}},_$attributes_410={defaults:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],defaultLine:"#444",lightLine:"#eee",background:"#fff",borderLine:"#BEC8D9",lightFraction:1e3/11},globalFont=_$font_attributes_611({editType:"calc"});globalFont.family.dflt='"Open Sans", verdana, arial, sans-serif',globalFont.size.dflt=12,globalFont.color.dflt=_$attributes_410.defaultLine;var _$layout_attributes_638={font:globalFont,title:{valType:"string",editType:"layoutstyle"},titlefont:_$font_attributes_611({editType:"layoutstyle"}),autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},paper_bgcolor:{valType:"color",dflt:_$attributes_410.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:_$attributes_410.background,editType:"layoutstyle"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:_$attributes_410.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"}},_$registry_668={},extendFlat=_$extend_528.extendFlat,extendDeepAll=_$extend_528.extendDeepAll;function registerTraceModule(_module){var thisType=_module.name,categoriesIn=_module.categories,meta=_module.meta;if(_$registry_668.modules[thisType])_$loggers_544.log("Type "+thisType+" already registered");else{_$registry_668.subplotsRegistry[_module.basePlotModule.name]||function registerSubplot(_module){var plotType=_module.name;if(_$registry_668.subplotsRegistry[plotType])return void _$loggers_544.log("Plot type "+plotType+" already registered.");for(var componentName in findArrayRegexps(_module),_$registry_668.subplotsRegistry[plotType]=_module,_$registry_668.componentsRegistry)mergeComponentAttrsToSubplot(componentName,_module.name)}(_module.basePlotModule);for(var categoryObj={},i=0;i<categoriesIn.length;i++)categoryObj[categoriesIn[i]]=!0,_$registry_668.allCategories[categoriesIn[i]]=!0;for(var componentName in _$registry_668.modules[thisType]={_module:_module,categories:categoryObj},meta&&Object.keys(meta).length&&(_$registry_668.modules[thisType].meta=meta),_$registry_668.allTypes.push(thisType),_$registry_668.componentsRegistry)mergeComponentAttrsToTrace(componentName,thisType);_module.layoutAttributes&&extendFlat(_$registry_668.traceLayoutAttributes,_module.layoutAttributes)}}function registerComponentModule(_module){if("string"!=typeof _module.name)throw new Error("Component module *name* must be a string.");var name=_module.name;for(var traceType in _$registry_668.componentsRegistry[name]=_module,_module.layoutAttributes&&(_module.layoutAttributes._isLinkedToArray&&_$pushUnique_552(_$registry_668.layoutArrayContainers,name),findArrayRegexps(_module)),_$registry_668.modules)mergeComponentAttrsToTrace(name,traceType);for(var subplotName in _$registry_668.subplotsRegistry)mergeComponentAttrsToSubplot(name,subplotName);for(var transformType in _$registry_668.transformsRegistry)mergeComponentAttrsToTransform(name,transformType);_module.schema&&_module.schema.layout&&extendDeepAll(_$layout_attributes_638,_module.schema.layout)}function registerTransformModule(_module){if("string"!=typeof _module.name)throw new Error("Transform module *name* must be a string.");var prefix="Transform module "+_module.name,hasTransform="function"==typeof _module.transform,hasCalcTransform="function"==typeof _module.calcTransform;if(!hasTransform&&!hasCalcTransform)throw new Error(prefix+" is missing a *transform* or *calcTransform* method.");for(var componentName in hasTransform&&hasCalcTransform&&_$loggers_544.log([prefix+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),_$isPlainObject_541(_module.attributes)||_$loggers_544.log(prefix+" registered without an *attributes* object."),"function"!=typeof _module.supplyDefaults&&_$loggers_544.log(prefix+" registered without a *supplyDefaults* method."),_$registry_668.transformsRegistry[_module.name]=_module,_$registry_668.componentsRegistry)mergeComponentAttrsToTransform(componentName,_module.name)}function registerLocale(_module){var locale=_module.name,baseLocale=locale.split("-")[0],newDict=_module.dictionary,newFormat=_module.format,hasDict=newDict&&Object.keys(newDict).length,hasFormat=newFormat&&Object.keys(newFormat).length,locales=_$registry_668.localeRegistry,localeObj=locales[locale];if(localeObj||(locales[locale]=localeObj={}),baseLocale!==locale){var baseLocaleObj=locales[baseLocale];baseLocaleObj||(locales[baseLocale]=baseLocaleObj={}),hasDict&&baseLocaleObj.dictionary===localeObj.dictionary&&(baseLocaleObj.dictionary=newDict),hasFormat&&baseLocaleObj.format===localeObj.format&&(baseLocaleObj.format=newFormat)}hasDict&&(localeObj.dictionary=newDict),hasFormat&&(localeObj.format=newFormat)}function findArrayRegexps(_module){if(_module.layoutAttributes){var arrayAttrRegexps=_module.layoutAttributes._arrayAttrRegexps;if(arrayAttrRegexps)for(var i=0;i<arrayAttrRegexps.length;i++)_$pushUnique_552(_$registry_668.layoutArrayRegexes,arrayAttrRegexps[i])}}function mergeComponentAttrsToTrace(componentName,traceType){var componentSchema=_$registry_668.componentsRegistry[componentName].schema;if(componentSchema&&componentSchema.traces){var traceAttrs=componentSchema.traces[traceType];traceAttrs&&extendDeepAll(_$registry_668.modules[traceType]._module.attributes,traceAttrs)}}function mergeComponentAttrsToTransform(componentName,transformType){var componentSchema=_$registry_668.componentsRegistry[componentName].schema;if(componentSchema&&componentSchema.transforms){var transformAttrs=componentSchema.transforms[transformType];transformAttrs&&extendDeepAll(_$registry_668.transformsRegistry[transformType].attributes,transformAttrs)}}function mergeComponentAttrsToSubplot(componentName,subplotName){var componentSchema=_$registry_668.componentsRegistry[componentName].schema;if(componentSchema&&componentSchema.subplots){var subplotModule=_$registry_668.subplotsRegistry[subplotName],subplotAttrs=subplotModule.layoutAttributes,subplotAttr="subplot"===subplotModule.attr?subplotModule.name:subplotModule.attr;Array.isArray(subplotAttr)&&(subplotAttr=subplotAttr[0]);var componentLayoutAttrs=componentSchema.subplots[subplotAttr];subplotAttrs&&componentLayoutAttrs&&extendDeepAll(subplotAttrs,componentLayoutAttrs)}}function getTraceType(traceType){return"object"==typeof traceType&&(traceType=traceType.type),traceType}_$registry_668.modules={},_$registry_668.allCategories={},_$registry_668.allTypes=[],_$registry_668.subplotsRegistry={},_$registry_668.transformsRegistry={},_$registry_668.componentsRegistry={},_$registry_668.layoutArrayContainers=[],_$registry_668.layoutArrayRegexes=[],_$registry_668.traceLayoutAttributes={},_$registry_668.localeRegistry={},_$registry_668.apiMethodRegistry={},_$registry_668.register=function register(_modules){if(!_modules)throw new Error("No argument passed to Plotly.register.");_modules&&!Array.isArray(_modules)&&(_modules=[_modules]);for(var i=0;i<_modules.length;i++){var newModule=_modules[i];if(!newModule)throw new Error("Invalid module was attempted to be registered!");switch(newModule.moduleType){case"trace":registerTraceModule(newModule);break;case"transform":registerTransformModule(newModule);break;case"component":registerComponentModule(newModule);break;case"locale":registerLocale(newModule);break;case"apiMethod":var name=newModule.name;_$registry_668.apiMethodRegistry[name]=newModule.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},_$registry_668.getModule=function(trace){var _module=_$registry_668.modules[getTraceType(trace)];return!!_module&&_module._module},_$registry_668.traceIs=function(traceType,category){if("various"===(traceType=getTraceType(traceType)))return!1;var _module=_$registry_668.modules[traceType];return _module||(traceType&&"area"!==traceType&&_$loggers_544.log("Unrecognized trace type "+traceType+"."),_module=_$registry_668.modules[_$attributes_581.type.dflt]),!!_module.categories[category]},_$registry_668.getTransformIndices=function(data,type){for(var indices=[],transforms=data.transforms||[],i=0;i<transforms.length;i++)transforms[i].type===type&&indices.push(i);return indices},_$registry_668.hasTransform=function(data,type){for(var transforms=data.transforms||[],i=0;i<transforms.length;i++)if(transforms[i].type===type)return!0;return!1},_$registry_668.getComponentMethod=function(name,method){var _module=_$registry_668.componentsRegistry[name];return _module&&_module[method]||_$noop_548},_$registry_668.call=function(){var name=arguments[0],args=[].slice.call(arguments,1);return _$registry_668.apiMethodRegistry[name].apply(null,args)};var _$containerArrayMatch_568=function containerArrayMatch(astr){for(var arrayStr,match,rootContainers=_$registry_668.layoutArrayContainers,regexpContainers=_$registry_668.layoutArrayRegexes,rootPart=astr.split("[")[0],i=0;i<regexpContainers.length;i++)if((match=astr.match(regexpContainers[i]))&&0===match.index){arrayStr=match[0];break}if(arrayStr||(arrayStr=rootContainers[rootContainers.indexOf(rootPart)]),!arrayStr)return!1;var tail=astr.substr(arrayStr.length);return tail?!!(match=tail.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/))&&{array:arrayStr,index:Number(match[1]),property:match[3]||""}:{array:arrayStr,index:"",property:""}},isArrayOrTypedArray=_$is_array_540.isArrayOrTypedArray,_$nestedProperty_547=function nestedProperty(container,propStr){if(_$fastIsnumeric_139(propStr))propStr=String(propStr);else if("string"!=typeof propStr||"[-1]"===propStr.substr(propStr.length-4))throw"bad property string";for(var indexed,indices,i,j=0,propParts=propStr.split(".");j<propParts.length;){if(indexed=String(propParts[j]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/)){if(indexed[1])propParts[j]=indexed[1];else{if(0!==j)throw"bad property string";propParts.splice(0,1)}for(indices=indexed[2].substr(1,indexed[2].length-2).split("]["),i=0;i<indices.length;i++)j++,propParts.splice(j,0,Number(indices[i]))}j++}return"object"!=typeof container?function badContainer(container,propStr,propParts){return{set:function(){throw"bad container"},get:function(){},astr:propStr,parts:propParts,obj:container}}(container,propStr,propParts):{set:npSet(container,propParts,propStr),get:function npGet(cont,parts){return function(){var curPart,allSame,out,i,j,curCont=cont;for(i=0;i<parts.length-1;i++){if(-1===(curPart=parts[i])){for(allSame=!0,out=[],j=0;j<curCont.length;j++)out[j]=npGet(curCont[j],parts.slice(i+1))(),out[j]!==out[0]&&(allSame=!1);return allSame?out[0]:out}if("number"==typeof curPart&&!isArrayOrTypedArray(curCont))return;if("object"!=typeof(curCont=curCont[curPart])||null===curCont)return}if("object"==typeof curCont&&null!==curCont&&null!==(out=curCont[parts[i]]))return out}}(container,propParts),astr:propStr,parts:propParts,obj:container}};var INFO_PATTERNS=/(^|\.)((domain|range)(\.[xy])?|args|parallels)$/,ARGS_PATTERN=/(^|\.)args\[/;function isDeletable(val,propStr){if(!function emptyObj(obj){return void 0===obj||null===obj||"object"==typeof obj&&(isArrayOrTypedArray(obj)?!obj.length:!Object.keys(obj).length)}(val)||_$isPlainObject_541(val)&&"]"===propStr.charAt(propStr.length-1)||propStr.match(ARGS_PATTERN)&&void 0!==val)return!1;if(!isArrayOrTypedArray(val))return!0;if(propStr.match(INFO_PATTERNS))return!0;var match=_$containerArrayMatch_568(propStr);return match&&""===match.index}function npSet(cont,parts,propStr){return function(val){var curPart,i,curCont=cont,propPart="",containerLevels=[[cont,propPart]],toDelete=isDeletable(val,propStr);for(i=0;i<parts.length-1;i++){if("number"==typeof(curPart=parts[i])&&!isArrayOrTypedArray(curCont))throw"array index but container is not an array";if(-1===curPart){if(toDelete=!setArrayAll(curCont,parts.slice(i+1),val,propStr))break;return}if(!checkNewContainer(curCont,curPart,parts[i+1],toDelete))break;if("object"!=typeof(curCont=curCont[curPart])||null===curCont)throw"container is not an object";propPart=joinPropStr(propPart,curPart),containerLevels.push([curCont,propPart])}toDelete?(i===parts.length-1&&delete curCont[parts[i]],function pruneContainers(containerLevels){var i,j,curCont,propPart,keys,remainingKeys;for(i=containerLevels.length-1;i>=0;i--){if(curCont=containerLevels[i][0],propPart=containerLevels[i][1],remainingKeys=!1,isArrayOrTypedArray(curCont))for(j=curCont.length-1;j>=0;j--)isDeletable(curCont[j],joinPropStr(propPart,j))?remainingKeys?curCont[j]=void 0:curCont.pop():remainingKeys=!0;else if("object"==typeof curCont&&null!==curCont)for(keys=Object.keys(curCont),remainingKeys=!1,j=keys.length-1;j>=0;j--)isDeletable(curCont[keys[j]],joinPropStr(propPart,keys[j]))?delete curCont[keys[j]]:remainingKeys=!0;if(remainingKeys)return}}(containerLevels)):curCont[parts[i]]=val}}function joinPropStr(propStr,newPart){var toAdd=newPart;return _$fastIsnumeric_139(newPart)?toAdd="["+newPart+"]":propStr&&(toAdd="."+newPart),propStr+toAdd}function setArrayAll(containerArray,innerParts,val,propStr){var i,arrayVal=isArrayOrTypedArray(val),allSet=!0,thisVal=val,thisPropStr=propStr.replace("-1",0),deleteThis=!arrayVal&&isDeletable(val,thisPropStr),firstPart=innerParts[0];for(i=0;i<containerArray.length;i++)thisPropStr=propStr.replace("-1",i),arrayVal&&(deleteThis=isDeletable(thisVal=val[i%val.length],thisPropStr)),deleteThis&&(allSet=!1),checkNewContainer(containerArray,i,firstPart,deleteThis)&&npSet(containerArray[i],innerParts,propStr.replace("-1",i))(thisVal);return allSet}function checkNewContainer(container,part,nextPart,toDelete){if(void 0===container[part]){if(toDelete)return!1;container[part]="number"==typeof nextPart?[]:{}}return!0}var _$regex_554={counter:function(head,tail,openEnded){var fullTail=(tail||"")+(openEnded?"":"$");return"xy"===head?new RegExp("^x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+fullTail):new RegExp("^"+head+"([2-9]|[1-9][0-9]+)?"+fullTail)}},_$coerce_524={},counterRegex=(Object.keys(_$scales_430),_$regex_554.counter),DESELECTDIM=_$interactions_516.DESELECTDIM,wrap180=_$angles_522.wrap180,__isArrayOrTypedArray_524=_$is_array_540.isArrayOrTypedArray;_$coerce_524.valObjectMeta={data_array:{coerceFunction:function(v,propOut,dflt){__isArrayOrTypedArray_524(v)?propOut.set(v):void 0!==dflt&&propOut.set(dflt)}},enumerated:{coerceFunction:function(v,propOut,dflt,opts){opts.coerceNumber&&(v=+v),-1===opts.values.indexOf(v)?propOut.set(dflt):propOut.set(v)},validateFunction:function(v,opts){opts.coerceNumber&&(v=+v);for(var values=opts.values,i=0;i<values.length;i++){var k=String(values[i]);if("/"===k.charAt(0)&&"/"===k.charAt(k.length-1)){if(new RegExp(k.substr(1,k.length-2)).test(v))return!0}else if(v===values[i])return!0}return!1}},boolean:{coerceFunction:function(v,propOut,dflt){!0===v||!1===v?propOut.set(v):propOut.set(dflt)}},number:{coerceFunction:function(v,propOut,dflt,opts){!_$fastIsnumeric_139(v)||void 0!==opts.min&&v<opts.min||void 0!==opts.max&&v>opts.max?propOut.set(dflt):propOut.set(+v)}},integer:{coerceFunction:function(v,propOut,dflt,opts){v%1||!_$fastIsnumeric_139(v)||void 0!==opts.min&&v<opts.min||void 0!==opts.max&&v>opts.max?propOut.set(dflt):propOut.set(+v)}},string:{coerceFunction:function(v,propOut,dflt,opts){if("string"!=typeof v){var okToCoerce="number"==typeof v;!0!==opts.strict&&okToCoerce?propOut.set(String(v)):propOut.set(dflt)}else opts.noBlank&&!v?propOut.set(dflt):propOut.set(v)}},color:{coerceFunction:function(v,propOut,dflt){_$tinycolor_352(v).isValid()?propOut.set(v):propOut.set(dflt)}},colorlist:{coerceFunction:function(v,propOut,dflt){Array.isArray(v)&&v.length&&v.every(function isColor(color){return _$tinycolor_352(color).isValid()})?propOut.set(v):propOut.set(dflt)}},colorscale:{coerceFunction:function(v,propOut,dflt){propOut.set(_$getScale_424(v,dflt))}},angle:{coerceFunction:function(v,propOut,dflt){"auto"===v?propOut.set("auto"):_$fastIsnumeric_139(v)?propOut.set(wrap180(+v)):propOut.set(dflt)}},subplotid:{coerceFunction:function(v,propOut,dflt){"string"==typeof v&&counterRegex(dflt).test(v)?propOut.set(v):propOut.set(dflt)},validateFunction:function(v,opts){var dflt=opts.dflt;return v===dflt||"string"==typeof v&&!!counterRegex(dflt).test(v)}},flaglist:{coerceFunction:function(v,propOut,dflt,opts){if("string"==typeof v)if(-1===(opts.extras||[]).indexOf(v)){for(var vParts=v.split("+"),i=0;i<vParts.length;){var vi=vParts[i];-1===opts.flags.indexOf(vi)||vParts.indexOf(vi)<i?vParts.splice(i,1):i++}vParts.length?propOut.set(vParts.join("+")):propOut.set(dflt)}else propOut.set(v);else propOut.set(dflt)}},any:{coerceFunction:function(v,propOut,dflt){void 0===v?propOut.set(dflt):propOut.set(v)}},info_array:{coerceFunction:function(v,propOut,dflt,opts){function coercePart(v,opts,dflt){var out,propPart={set:function(v){out=v}};return void 0===dflt&&(dflt=opts.dflt),_$coerce_524.valObjectMeta[opts.valType].coerceFunction(v,propPart,dflt,opts),out}var twoD=2===opts.dimensions;if(Array.isArray(v)){var i,j,len2,vNew,items=opts.items,vOut=[],arrayItems=Array.isArray(items),len=arrayItems?items.length:v.length;if(dflt=Array.isArray(dflt)?dflt:[],twoD)for(i=0;i<len;i++){vOut[i]=[];var row=Array.isArray(v[i])?v[i]:[];for(len2=arrayItems?items[i].length:row.length,j=0;j<len2;j++)void 0!==(vNew=coercePart(row[j],arrayItems?items[i][j]:items,(dflt[i]||[])[j]))&&(vOut[i][j]=vNew)}else for(i=0;i<len;i++)void 0!==(vNew=coercePart(v[i],arrayItems?items[i]:items,dflt[i]))&&(vOut[i]=vNew);propOut.set(vOut)}else propOut.set(dflt)},validateFunction:function(v,opts){if(!Array.isArray(v))return!1;var items=opts.items,arrayItems=Array.isArray(items),twoD=2===opts.dimensions;if(!opts.freeLength&&v.length!==items.length)return!1;for(var i=0;i<v.length;i++)if(twoD){if(!Array.isArray(v[i])||!opts.freeLength&&v[i].length!==items[i].length)return!1;for(var j=0;j<v[i].length;j++)if(!_$coerce_524.validate(v[i][j],arrayItems?items[i][j]:items))return!1}else if(!_$coerce_524.validate(v[i],arrayItems?items[i]:items))return!1;return!0}}},_$coerce_524.coerce=function(containerIn,containerOut,attributes,attribute,dflt){var opts=_$nestedProperty_547(attributes,attribute).get(),propIn=_$nestedProperty_547(containerIn,attribute),propOut=_$nestedProperty_547(containerOut,attribute),v=propIn.get();return void 0===dflt&&(dflt=opts.dflt),opts.arrayOk&&__isArrayOrTypedArray_524(v)?(propOut.set(v),v):(_$coerce_524.valObjectMeta[opts.valType].coerceFunction(v,propOut,dflt,opts),propOut.get())},_$coerce_524.coerce2=function(containerIn,containerOut,attributes,attribute,dflt){var propIn=_$nestedProperty_547(containerIn,attribute),propOut=_$coerce_524.coerce(containerIn,containerOut,attributes,attribute,dflt),valIn=propIn.get();return void 0!==valIn&&null!==valIn&&propOut},_$coerce_524.coerceFont=function(coerce,attr,dfltObj){var out={};return dfltObj=dfltObj||{},out.family=coerce(attr+".family",dfltObj.family),out.size=coerce(attr+".size",dfltObj.size),out.color=coerce(attr+".color",dfltObj.color),out},_$coerce_524.coerceHoverinfo=function(traceIn,traceOut,layoutOut){var dflt,moduleAttrs=traceOut._module.attributes,attrs=moduleAttrs.hoverinfo?{hoverinfo:moduleAttrs.hoverinfo}:_$attributes_581,valObj=attrs.hoverinfo;if(1===layoutOut._dataLength){var flags="all"===valObj.dflt?valObj.flags.slice():valObj.dflt.split("+");flags.splice(flags.indexOf("name"),1),dflt=flags.join("+")}return _$coerce_524.coerce(traceIn,traceOut,attrs,"hoverinfo",dflt)},_$coerce_524.coerceSelectionMarkerOpacity=function(traceOut,coerce){if(traceOut.marker){var smoDflt,usmoDflt,mo=traceOut.marker.opacity;if(void 0!==mo)__isArrayOrTypedArray_524(mo)||traceOut.selected||traceOut.unselected||(smoDflt=mo,usmoDflt=DESELECTDIM*mo),coerce("selected.marker.opacity",smoDflt),coerce("unselected.marker.opacity",usmoDflt)}},_$coerce_524.validate=function(value,opts){var valObjectDef=_$coerce_524.valObjectMeta[opts.valType];if(opts.arrayOk&&__isArrayOrTypedArray_524(value))return!0;if(valObjectDef.validateFunction)return valObjectDef.validateFunction(value,opts);var failed={},out=failed,propMock={set:function(v){out=v}};return valObjectDef.coerceFunction(value,propMock,failed,opts),out!==failed};var MIN_MS,MAX_MS,_$mod_546=function mod(v,d){var out=v%d;return out<0?out+d:out},_$dates_525={},__BADNUM_525=_$numerical_517.BADNUM,ONEDAY=_$numerical_517.ONEDAY,ONEHOUR=_$numerical_517.ONEHOUR,ONEMIN=_$numerical_517.ONEMIN,ONESEC=_$numerical_517.ONESEC,EPOCHJD=_$numerical_517.EPOCHJD,utcFormat=_$d3_127.time.format.utc,DATETIME_REGEXP=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d:?\d\d)?)?)?)?)?\s*$/m,DATETIME_REGEXP_CN=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d:?\d\d)?)?)?)?)?\s*$/m,YFIRST=(new Date).getFullYear()-70;function isWorldCalendar(calendar){return calendar&&_$registry_668.componentsRegistry.calendars&&"string"==typeof calendar&&"gregorian"!==calendar}function lpad(val,digits){return String(val+Math.pow(10,digits)).substr(1)}_$dates_525.dateTick0=function(calendar,sunday){return isWorldCalendar(calendar)?sunday?_$registry_668.getComponentMethod("calendars","CANONICAL_SUNDAY")[calendar]:_$registry_668.getComponentMethod("calendars","CANONICAL_TICK")[calendar]:sunday?"2000-01-02":"2000-01-01"},_$dates_525.dfltRange=function(calendar){return isWorldCalendar(calendar)?_$registry_668.getComponentMethod("calendars","DFLTRANGE")[calendar]:["2000-01-01","2001-01-01"]},_$dates_525.isJSDate=function(v){return"object"==typeof v&&null!==v&&"function"==typeof v.getTime},_$dates_525.dateTime2ms=function(s,calendar){if(_$dates_525.isJSDate(s))return(s=Number(s)-s.getTimezoneOffset()*ONEMIN)>=MIN_MS&&s<=MAX_MS?s:__BADNUM_525;if("string"!=typeof s&&"number"!=typeof s)return __BADNUM_525;s=String(s);var isWorld=isWorldCalendar(calendar),s0=s.charAt(0);!isWorld||"G"!==s0&&"g"!==s0||(s=s.substr(1),calendar="");var isChinese=isWorld&&"chinese"===calendar.substr(0,7),match=s.match(isChinese?DATETIME_REGEXP_CN:DATETIME_REGEXP);if(!match)return __BADNUM_525;var y=match[1],m=match[3]||"1",d=Number(match[5]||1),H=Number(match[7]||0),M=Number(match[9]||0),S=Number(match[11]||0);if(isWorld){if(2===y.length)return __BADNUM_525;var cDate;y=Number(y);try{var calInstance=_$registry_668.getComponentMethod("calendars","getCal")(calendar);if(isChinese){var isIntercalary="i"===m.charAt(m.length-1);m=parseInt(m,10),cDate=calInstance.newDate(y,calInstance.toMonthIndex(y,m,isIntercalary),d)}else cDate=calInstance.newDate(y,Number(m),d)}catch(e){return __BADNUM_525}return cDate?(cDate.toJD()-EPOCHJD)*ONEDAY+H*ONEHOUR+M*ONEMIN+S*ONESEC:__BADNUM_525}y=2===y.length?(Number(y)+2e3-YFIRST)%100+YFIRST:Number(y),m-=1;var date=new Date(Date.UTC(2e3,m,d,H,M));return date.setUTCFullYear(y),date.getUTCMonth()!==m?__BADNUM_525:date.getUTCDate()!==d?__BADNUM_525:date.getTime()+S*ONESEC},MIN_MS=_$dates_525.MIN_MS=_$dates_525.dateTime2ms("-9999"),MAX_MS=_$dates_525.MAX_MS=_$dates_525.dateTime2ms("9999-12-31 23:59:59.9999"),_$dates_525.isDateTime=function(s,calendar){return _$dates_525.dateTime2ms(s,calendar)!==__BADNUM_525};var NINETYDAYS=90*ONEDAY,THREEHOURS=3*ONEHOUR,FIVEMIN=5*ONEMIN;function includeTime(dateStr,h,m,s,msec10){if((h||m||s||msec10)&&(dateStr+=" "+lpad(h,2)+":"+lpad(m,2),(s||msec10)&&(dateStr+=":"+lpad(s,2),msec10))){for(var digits=4;msec10%10==0;)digits-=1,msec10/=10;dateStr+="."+lpad(msec10,digits)}return dateStr}_$dates_525.ms2DateTime=function(ms,r,calendar){if("number"!=typeof ms||!(ms>=MIN_MS&&ms<=MAX_MS))return __BADNUM_525;r||(r=0);var dateStr,h,m,s,msec10,d,msecTenths=Math.floor(10*_$mod_546(ms+.05,1)),msRounded=Math.round(ms-msecTenths/10);if(isWorldCalendar(calendar)){var dateJD=Math.floor(msRounded/ONEDAY)+EPOCHJD,timeMs=Math.floor(_$mod_546(ms,ONEDAY));try{dateStr=_$registry_668.getComponentMethod("calendars","getCal")(calendar).fromJD(dateJD).formatDate("yyyy-mm-dd")}catch(e){dateStr=utcFormat("G%Y-%m-%d")(new Date(msRounded))}if("-"===dateStr.charAt(0))for(;dateStr.length<11;)dateStr="-0"+dateStr.substr(1);else for(;dateStr.length<10;)dateStr="0"+dateStr;h=r<NINETYDAYS?Math.floor(timeMs/ONEHOUR):0,m=r<NINETYDAYS?Math.floor(timeMs%ONEHOUR/ONEMIN):0,s=r<THREEHOURS?Math.floor(timeMs%ONEMIN/ONESEC):0,msec10=r<FIVEMIN?timeMs%ONESEC*10+msecTenths:0}else d=new Date(msRounded),dateStr=utcFormat("%Y-%m-%d")(d),h=r<NINETYDAYS?d.getUTCHours():0,m=r<NINETYDAYS?d.getUTCMinutes():0,s=r<THREEHOURS?d.getUTCSeconds():0,msec10=r<FIVEMIN?10*d.getUTCMilliseconds()+msecTenths:0;return includeTime(dateStr,h,m,s,msec10)},_$dates_525.ms2DateTimeLocal=function(ms){if(!(ms>=MIN_MS+ONEDAY&&ms<=MAX_MS-ONEDAY))return __BADNUM_525;var msecTenths=Math.floor(10*_$mod_546(ms+.05,1)),d=new Date(Math.round(ms-msecTenths/10));return includeTime(_$d3_127.time.format("%Y-%m-%d")(d),d.getHours(),d.getMinutes(),d.getSeconds(),10*d.getUTCMilliseconds()+msecTenths)},_$dates_525.cleanDate=function(v,dflt,calendar){if(_$dates_525.isJSDate(v)||"number"==typeof v){if(isWorldCalendar(calendar))return _$loggers_544.error("JS Dates and milliseconds are incompatible with world calendars",v),dflt;if(!(v=_$dates_525.ms2DateTimeLocal(+v))&&void 0!==dflt)return dflt}else if(!_$dates_525.isDateTime(v,calendar))return _$loggers_544.error("unrecognized date",v),dflt;return v};var fracMatch=/%\d?f/g;function modDateFormat(fmt,x,formatter,calendar){fmt=fmt.replace(fracMatch,function(match){var digits=Math.min(+match.charAt(1)||6,6);return(x/1e3%1+2).toFixed(digits).substr(2).replace(/0+$/,"")||"0"});var d=new Date(Math.floor(x+.05));if(isWorldCalendar(calendar))try{fmt=_$registry_668.getComponentMethod("calendars","worldCalFmt")(fmt,x,calendar)}catch(e){return"Invalid"}return formatter(fmt)(d)}var MAXSECONDS=[59,59.9,59.99,59.999,59.9999];_$dates_525.formatDate=function(x,fmt,tr,formatter,calendar,extraFormat){if(calendar=isWorldCalendar(calendar)&&calendar,!fmt)if("y"===tr)fmt=extraFormat.year;else if("m"===tr)fmt=extraFormat.month;else{if("d"!==tr)return function formatTime(x,tr){var timePart=_$mod_546(x+.05,ONEDAY),timeStr=lpad(Math.floor(timePart/ONEHOUR),2)+":"+lpad(_$mod_546(Math.floor(timePart/ONEMIN),60),2);if("M"!==tr){_$fastIsnumeric_139(tr)||(tr=0);var secStr=(100+Math.min(_$mod_546(x/ONESEC,60),MAXSECONDS[tr])).toFixed(tr).substr(1);tr>0&&(secStr=secStr.replace(/0+$/,"").replace(/[\.]$/,"")),timeStr+=":"+secStr}return timeStr}(x,tr)+"\n"+modDateFormat(extraFormat.dayMonthYear,x,formatter,calendar);fmt=extraFormat.dayMonth+"\n"+extraFormat.year}return modDateFormat(fmt,x,formatter,calendar)};var THREEDAYS=3*ONEDAY;_$dates_525.incrementMonth=function(ms,dMonth,calendar){calendar=isWorldCalendar(calendar)&&calendar;var timeMs=_$mod_546(ms,ONEDAY);if(ms=Math.round(ms-timeMs),calendar)try{var dateJD=Math.round(ms/ONEDAY)+EPOCHJD,calInstance=_$registry_668.getComponentMethod("calendars","getCal")(calendar),cDate=calInstance.fromJD(dateJD);return dMonth%12?calInstance.add(cDate,dMonth,"m"):calInstance.add(cDate,dMonth/12,"y"),(cDate.toJD()-EPOCHJD)*ONEDAY+timeMs}catch(e){_$loggers_544.error("invalid ms "+ms+" in calendar "+calendar)}var y=new Date(ms+THREEDAYS);return y.setUTCMonth(y.getUTCMonth()+dMonth)+timeMs-THREEDAYS},_$dates_525.findExactDates=function(data,calendar){for(var d,di,exactYears=0,exactMonths=0,exactDays=0,blankCount=0,calInstance=isWorldCalendar(calendar)&&_$registry_668.getComponentMethod("calendars","getCal")(calendar),i=0;i<data.length;i++)if(di=data[i],_$fastIsnumeric_139(di)){if(!(di%ONEDAY))if(calInstance)try{1===(d=calInstance.fromJD(di/ONEDAY+EPOCHJD)).day()?1===d.month()?exactYears++:exactMonths++:exactDays++}catch(e){}else 1===(d=new Date(di)).getUTCDate()?0===d.getUTCMonth()?exactYears++:exactMonths++:exactDays++}else blankCount++;exactDays+=exactMonths+=exactYears;var dataCount=data.length-blankCount;return{exactYears:exactYears/dataCount,exactMonths:exactMonths/dataCount,exactDays:exactDays/dataCount}};function baseFilter(item){return!0===item.visible}function calcDataFilter(item){return!0===item[0].trace.visible}var locationCache,workingPath,workingTextWidth,_$geometry2d_533={};function segmentsIntersect(x1,y1,x2,y2,x3,y3,x4,y4){var a=x2-x1,b=x3-x1,c=x4-x3,d=y2-y1,e=y3-y1,f=y4-y3,det=a*f-c*d;if(0===det)return null;var t=(b*f-c*e)/det,u=(b*d-a*e)/det;return u<0||u>1||t<0||t>1?null:{x:x1+a*t,y:y1+d*t}}function perpDistance2(xab,yab,l2_ab,xac,yac){var fc_ab=xac*xab+yac*yab;if(fc_ab<0)return xac*xac+yac*yac;if(fc_ab>l2_ab){var xbc=xac-xab,ybc=yac-yab;return xbc*xbc+ybc*ybc}var crossProduct=xac*yab-yac*xab;return crossProduct*crossProduct/l2_ab}_$geometry2d_533.segmentsIntersect=segmentsIntersect,_$geometry2d_533.segmentDistance=function segmentDistance(x1,y1,x2,y2,x3,y3,x4,y4){if(segmentsIntersect(x1,y1,x2,y2,x3,y3,x4,y4))return 0;var x12=x2-x1,y12=y2-y1,x34=x4-x3,y34=y4-y3,l2_12=x12*x12+y12*y12,l2_34=x34*x34+y34*y34,dist2=Math.min(perpDistance2(x12,y12,l2_12,x3-x1,y3-y1),perpDistance2(x12,y12,l2_12,x4-x1,y4-y1),perpDistance2(x34,y34,l2_34,x1-x3,y1-y3),perpDistance2(x34,y34,l2_34,x2-x3,y2-y3));return Math.sqrt(dist2)},_$geometry2d_533.getTextLocation=function getTextLocation(path,totalPathLen,positionOnPath,textWidth){if(path===workingPath&&textWidth===workingTextWidth||(locationCache={},workingPath=path,workingTextWidth=textWidth),locationCache[positionOnPath])return locationCache[positionOnPath];var p0=path.getPointAtLength(_$mod_546(positionOnPath-textWidth/2,totalPathLen)),p1=path.getPointAtLength(_$mod_546(positionOnPath+textWidth/2,totalPathLen)),theta=Math.atan((p1.y-p0.y)/(p1.x-p0.x)),pCenter=path.getPointAtLength(_$mod_546(positionOnPath,totalPathLen)),out={x:(4*pCenter.x+p0.x+p1.x)/6,y:(4*pCenter.y+p0.y+p1.y)/6,theta:theta};return locationCache[positionOnPath]=out,out},_$geometry2d_533.clearLocationCache=function(){workingPath=null},_$geometry2d_533.getVisibleSegment=function getVisibleSegment(path,bounds,buffer){var pt0,ptTotal,left=bounds.left,right=bounds.right,top=bounds.top,bottom=bounds.bottom,pMin=0,pTotal=path.getTotalLength(),pMax=pTotal;function getDistToPlot(len){var pt=path.getPointAtLength(len);0===len?pt0=pt:len===pTotal&&(ptTotal=pt);var dx=pt.x<left?left-pt.x:pt.x>right?pt.x-right:0,dy=pt.y<top?top-pt.y:pt.y>bottom?pt.y-bottom:0;return Math.sqrt(dx*dx+dy*dy)}for(var distToPlot=getDistToPlot(pMin);distToPlot;){if((pMin+=distToPlot+buffer)>pMax)return;distToPlot=getDistToPlot(pMin)}for(distToPlot=getDistToPlot(pMax);distToPlot;){if(pMin>(pMax-=distToPlot+buffer))return;distToPlot=getDistToPlot(pMax)}return{min:pMin,max:pMax,len:pMax-pMin,total:pTotal,isClosed:0===pMin&&pMax===pTotal&&Math.abs(pt0.x-ptTotal.x)<.1&&Math.abs(pt0.y-ptTotal.y)<.1}},_$geometry2d_533.findPointOnPath=function findPointOnPath(path,val,coord,opts){for(var mid,pt,diff,pathLength=(opts=opts||{}).pathLength||path.getTotalLength(),tolerance=opts.tolerance||.001,iterationLimit=opts.iterationLimit||30,mul=path.getPointAtLength(0)[coord]>path.getPointAtLength(pathLength)[coord]?-1:1,i=0,b0=0,b1=pathLength;i<iterationLimit;){if(mid=(b0+b1)/2,diff=(pt=path.getPointAtLength(mid))[coord]-val,Math.abs(diff)<tolerance)return pt;mul*diff>0?b1=mid:b0=mid,i++}return pt};var _$get_graph_div_534=function(gd){var gdElement;if("string"==typeof gd){if(null===(gdElement=document.getElementById(gd)))throw new Error("No DOM element with id '"+gd+"' exists on the page.");return gdElement}if(null===gd||void 0===gd)throw new Error("DOM element provided is null or undefined");return gd},_$identity_538=function identity(d){return d},SIMPLE_PROPERTY_REGEX=/^\w*$/,_$matrix_545={init2dArray:function(rowLength,colLength){for(var array=new Array(rowLength),i=0;i<rowLength;i++)array[i]=new Array(colLength);return array},transposeRagged:function(z){var i,j,maxlen=0,zlen=z.length;for(i=0;i<zlen;i++)maxlen=Math.max(maxlen,z[i].length);var t=new Array(maxlen);for(i=0;i<maxlen;i++)for(t[i]=new Array(zlen),j=0;j<zlen;j++)t[i][j]=z[j][i];return t},dot:function(x,y){if(!x.length||!y.length||x.length!==y.length)return null;var out,i,len=x.length;if(x[0].length)for(out=new Array(len),i=0;i<len;i++)out[i]=_$matrix_545.dot(x[i],y);else if(y[0].length){var yTranspose=_$matrix_545.transposeRagged(y);for(out=new Array(yTranspose.length),i=0;i<yTranspose.length;i++)out[i]=_$matrix_545.dot(x,yTranspose[i])}else for(out=0,i=0;i<len;i++)out+=x[i]*y[i];return out},translationMatrix:function(x,y){return[[1,0,x],[0,1,y],[0,0,1]]},rotationMatrix:function(alpha){var a=alpha*Math.PI/180;return[[Math.cos(a),-Math.sin(a),0],[Math.sin(a),Math.cos(a),0],[0,0,1]]},rotationXYMatrix:function(a,x,y){return _$matrix_545.dot(_$matrix_545.dot(_$matrix_545.translationMatrix(x,y),_$matrix_545.rotationMatrix(a)),_$matrix_545.translationMatrix(-x,-y))},apply2DTransform:function(transform){return function(){var args=arguments;3===args.length&&(args=args[0]);var xy=1===arguments.length?args[0]:[args[0],args[1]];return _$matrix_545.dot(transform,[xy[0],xy[1],1]).slice(0,2)}},apply2DTransform2:function(transform){var at=_$matrix_545.apply2DTransform(transform);return function(xys){return at(xys.slice(0,2)).concat(at(xys.slice(2,4)))}}},NOTEDATA=[],ASCEND=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,SIMPLEATTR=/^[^\.\[\]]+$/,__isArrayOrTypedArray_556=_$is_array_540.isArrayOrTypedArray,_$search_557={};function lessThan(a,b){return a<b}function lessOrEqual(a,b){return a<=b}function greaterThan(a,b){return a>b}function greaterOrEqual(a,b){return a>=b}_$search_557.findBin=function(val,bins,linelow){if(_$fastIsnumeric_139(bins.start))return linelow?Math.ceil((val-bins.start)/bins.size-1e-9)-1:Math.floor((val-bins.start)/bins.size+1e-9);var n,test,n1=0,n2=bins.length,c=0,binSize=n2>1?(bins[n2-1]-bins[0])/(n2-1):1;for(test=binSize>=0?linelow?lessThan:lessOrEqual:linelow?greaterOrEqual:greaterThan,val+=1e-9*binSize*(linelow?-1:1)*(binSize>=0?1:-1);n1<n2&&c++<100;)test(bins[n=Math.floor((n1+n2)/2)],val)?n1=n+1:n2=n;return c>90&&_$loggers_544.log("Long binary search..."),n1-1},_$search_557.sorterAsc=function(a,b){return a-b},_$search_557.sorterDes=function(a,b){return b-a},_$search_557.distinctVals=function(valsIn){var vals=valsIn.slice();vals.sort(_$search_557.sorterAsc);for(var l=vals.length-1,minDiff=vals[l]-vals[0]||1,errDiff=minDiff/(l||1)/1e4,v2=[vals[0]],i=0;i<l;i++)vals[i+1]>vals[i]+errDiff&&(minDiff=Math.min(minDiff,vals[i+1]-vals[i]),v2.push(vals[i+1]));return{vals:v2,minDiff:minDiff}},_$search_557.roundUp=function(val,arrayIn,reverse){for(var mid,low=0,high=arrayIn.length-1,c=0,dlow=reverse?0:1,dhigh=reverse?1:0,rounded=reverse?Math.ceil:Math.floor;low<high&&c++<100;)arrayIn[mid=rounded((low+high)/2)]<=val?low=mid+dlow:high=mid-dhigh;return arrayIn[low]};var _$stats_560={},__isArrayOrTypedArray_560=_$is_array_540.isArrayOrTypedArray;_$stats_560.aggNums=function(f,v,a,len){var i,b;if((!len||len>a.length)&&(len=a.length),_$fastIsnumeric_139(v)||(v=!1),__isArrayOrTypedArray_560(a[0])){for(b=new Array(len),i=0;i<len;i++)b[i]=_$stats_560.aggNums(f,v,a[i]);a=b}for(i=0;i<len;i++)_$fastIsnumeric_139(v)?_$fastIsnumeric_139(a[i])&&(v=f(+v,+a[i])):v=a[i];return v},_$stats_560.len=function(data){return _$stats_560.aggNums(function(a){return a+1},0,data)},_$stats_560.mean=function(data,len){return len||(len=_$stats_560.len(data)),_$stats_560.aggNums(function(a,b){return a+b},0,data)/len},_$stats_560.variance=function(data,len,mean){return len||(len=_$stats_560.len(data)),_$fastIsnumeric_139(mean)||(mean=_$stats_560.mean(data,len)),_$stats_560.aggNums(function(a,b){return a+Math.pow(b-mean,2)},0,data)/len},_$stats_560.stdev=function(data,len,mean){return Math.sqrt(_$stats_560.variance(data,len,mean))},_$stats_560.interp=function(arr,n){if(!_$fastIsnumeric_139(n))throw"n should be a finite number";if((n=n*arr.length-.5)<0)return arr[0];if(n>arr.length-1)return arr[arr.length-1];var frac=n%1;return frac*arr[Math.ceil(n)]+(1-frac)*arr[Math.floor(n)]};var _$throttle_563={},timerCache={};function _clearTimeout(cache){cache&&null!==cache.timer&&(clearTimeout(cache.timer),cache.timer=null)}_$throttle_563.throttle=function throttle(id,minInterval,callback){var cache=timerCache[id],now=Date.now();if(!cache){for(var idi in timerCache)timerCache[idi].ts<now-6e4&&delete timerCache[idi];cache=timerCache[id]={ts:0,timer:null}}function exec(){callback(),cache.ts=Date.now(),cache.onDone&&(cache.onDone(),cache.onDone=null)}_clearTimeout(cache),now>cache.ts+minInterval?exec():cache.timer=setTimeout(function(){exec(),cache.timer=null},minInterval)},_$throttle_563.done=function(id){var cache=timerCache[id];return cache&&cache.timer?new Promise(function(resolve){var previousOnDone=cache.onDone;cache.onDone=function onDone(){previousOnDone&&previousOnDone(),resolve(),cache.onDone=null}}):Promise.resolve()},_$throttle_563.clear=function(id){if(id)_clearTimeout(timerCache[id]),delete timerCache[id];else for(var idi in timerCache)_$throttle_563.clear(idi)};var _$toLogRange_564=function toLogRange(val,range){if(val>0)return Math.log(val)/Math.LN10;var newVal=Math.log(Math.min(range[0],range[1]))/Math.LN10;return _$fastIsnumeric_139(newVal)||(newVal=Math.log(Math.max(range[0],range[1]))/Math.LN10-6),newVal},_$lib_539={},FP_SAFE=_$numerical_517.FP_SAFE,__BADNUM_539=_$numerical_517.BADNUM,lib=_$lib_539={};lib.nestedProperty=_$nestedProperty_547,lib.keyedContainer=function keyedContainer(baseObj,path,keyName,valueName){var i,arr;keyName=keyName||"name",valueName=valueName||"value";var changeTypes={};arr=path&&path.length?_$nestedProperty_547(baseObj,path).get():baseObj,path=path||"",arr=arr||[];var indexLookup={};for(i=0;i<arr.length;i++)indexLookup[arr[i][keyName]]=i;var isSimpleValueProp=SIMPLE_PROPERTY_REGEX.test(valueName),obj={set:function(name,value){var changeType=null===value?4:0,idx=indexLookup[name];void 0===idx?(changeType|=3,idx=arr.length,indexLookup[name]=idx):value!==(isSimpleValueProp?arr[idx][valueName]:_$nestedProperty_547(arr[idx],valueName).get())&&(changeType|=2);var newValue=arr[idx]=arr[idx]||{};return newValue[keyName]=name,isSimpleValueProp?newValue[valueName]=value:_$nestedProperty_547(newValue,valueName).set(value),null!==value&&(changeType&=-5),changeTypes[idx]=changeTypes[idx]|changeType,obj},get:function(name){var idx=indexLookup[name];return void 0===idx?void 0:isSimpleValueProp?arr[idx][valueName]:_$nestedProperty_547(arr[idx],valueName).get()},rename:function(name,newName){var idx=indexLookup[name];return void 0===idx?obj:(changeTypes[idx]=1|changeTypes[idx],indexLookup[newName]=idx,delete indexLookup[name],arr[idx][keyName]=newName,obj)},remove:function(name){var idx=indexLookup[name];if(void 0===idx)return obj;var object=arr[idx];if(Object.keys(object).length>2)return changeTypes[idx]=2|changeTypes[idx],obj.set(name,null);if(isSimpleValueProp){for(i=idx;i<arr.length;i++)changeTypes[i]=3|changeTypes[i];for(i=idx;i<arr.length;i++)indexLookup[arr[i][keyName]]--;arr.splice(idx,1),delete indexLookup[name]}else _$nestedProperty_547(object,valueName).set(null),changeTypes[idx]=6|changeTypes[idx];return obj},constructUpdate:function(){for(var astr,idx,update={},changed=Object.keys(changeTypes),i=0;i<changed.length;i++)idx=changed[i],astr=path+"["+idx+"]",arr[idx]?(1&changeTypes[idx]&&(update[astr+"."+keyName]=arr[idx][keyName]),2&changeTypes[idx]&&(update[astr+"."+valueName]=isSimpleValueProp?4&changeTypes[idx]?null:arr[idx][valueName]:4&changeTypes[idx]?null:_$nestedProperty_547(arr[idx],valueName).get())):update[astr]=null;return update}};return obj},lib.relativeAttr=function(baseAttr,relativeAttr){for(;relativeAttr;){var match=baseAttr.match(ASCEND);if(match)baseAttr=match[1];else{if(!baseAttr.match(SIMPLEATTR))throw new Error("bad relativeAttr call:"+[baseAttr,relativeAttr]);baseAttr=""}if("^"!==relativeAttr.charAt(0))break;relativeAttr=relativeAttr.slice(1)}return baseAttr&&"["!==relativeAttr.charAt(0)?baseAttr+"."+relativeAttr:baseAttr+relativeAttr},lib.isPlainObject=_$isPlainObject_541,lib.mod=_$mod_546,lib.toLogRange=_$toLogRange_564,lib.relinkPrivateKeys=function relinkPrivateKeys(toContainer,fromContainer){for(var k in fromContainer){var fromVal=fromContainer[k],toVal=toContainer[k];if(toVal!==fromVal)if("_"===k.charAt(0)||"function"==typeof fromVal){if(k in toContainer)continue;toContainer[k]=fromVal}else if(__isArrayOrTypedArray_556(fromVal)&&__isArrayOrTypedArray_556(toVal)&&_$isPlainObject_541(fromVal[0])){if("customdata"===k||"ids"===k)continue;for(var minLen=Math.min(fromVal.length,toVal.length),j=0;j<minLen;j++)toVal[j]!==fromVal[j]&&_$isPlainObject_541(fromVal[j])&&_$isPlainObject_541(toVal[j])&&relinkPrivateKeys(toVal[j],fromVal[j])}else _$isPlainObject_541(fromVal)&&_$isPlainObject_541(toVal)&&(relinkPrivateKeys(toVal,fromVal),Object.keys(toVal).length||delete toContainer[k])}},lib.ensureArray=function ensureArray(out,n){return Array.isArray(out)||(out=[]),out.length=n,out},lib.isTypedArray=_$is_array_540.isTypedArray,lib.isArrayOrTypedArray=_$is_array_540.isArrayOrTypedArray,lib.valObjectMeta=_$coerce_524.valObjectMeta,lib.coerce=_$coerce_524.coerce,lib.coerce2=_$coerce_524.coerce2,lib.coerceFont=_$coerce_524.coerceFont,lib.coerceHoverinfo=_$coerce_524.coerceHoverinfo,lib.coerceSelectionMarkerOpacity=_$coerce_524.coerceSelectionMarkerOpacity,lib.validate=_$coerce_524.validate,lib.dateTime2ms=_$dates_525.dateTime2ms,lib.isDateTime=_$dates_525.isDateTime,lib.ms2DateTime=_$dates_525.ms2DateTime,lib.ms2DateTimeLocal=_$dates_525.ms2DateTimeLocal,lib.cleanDate=_$dates_525.cleanDate,lib.isJSDate=_$dates_525.isJSDate,lib.formatDate=_$dates_525.formatDate,lib.incrementMonth=_$dates_525.incrementMonth,lib.dateTick0=_$dates_525.dateTick0,lib.dfltRange=_$dates_525.dfltRange,lib.findExactDates=_$dates_525.findExactDates,lib.MIN_MS=_$dates_525.MIN_MS,lib.MAX_MS=_$dates_525.MAX_MS,lib.findBin=_$search_557.findBin,lib.sorterAsc=_$search_557.sorterAsc,lib.sorterDes=_$search_557.sorterDes,lib.distinctVals=_$search_557.distinctVals,lib.roundUp=_$search_557.roundUp,lib.aggNums=_$stats_560.aggNums,lib.len=_$stats_560.len,lib.mean=_$stats_560.mean,lib.variance=_$stats_560.variance,lib.stdev=_$stats_560.stdev,lib.interp=_$stats_560.interp,lib.init2dArray=_$matrix_545.init2dArray,lib.transposeRagged=_$matrix_545.transposeRagged,lib.dot=_$matrix_545.dot,lib.translationMatrix=_$matrix_545.translationMatrix,lib.rotationMatrix=_$matrix_545.rotationMatrix,lib.rotationXYMatrix=_$matrix_545.rotationXYMatrix,lib.apply2DTransform=_$matrix_545.apply2DTransform,lib.apply2DTransform2=_$matrix_545.apply2DTransform2,lib.deg2rad=_$angles_522.deg2rad,lib.rad2deg=_$angles_522.rad2deg,lib.wrap360=_$angles_522.wrap360,lib.wrap180=_$angles_522.wrap180,lib.segmentsIntersect=_$geometry2d_533.segmentsIntersect,lib.segmentDistance=_$geometry2d_533.segmentDistance,lib.getTextLocation=_$geometry2d_533.getTextLocation,lib.clearLocationCache=_$geometry2d_533.clearLocationCache,lib.getVisibleSegment=_$geometry2d_533.getVisibleSegment,lib.findPointOnPath=_$geometry2d_533.findPointOnPath,lib.extendFlat=_$extend_528.extendFlat,lib.extendDeep=_$extend_528.extendDeep,lib.extendDeepAll=_$extend_528.extendDeepAll,lib.extendDeepNoArrays=_$extend_528.extendDeepNoArrays,lib.log=_$loggers_544.log,lib.warn=_$loggers_544.warn,lib.error=_$loggers_544.error,lib.counterRegex=_$regex_554.counter,lib.throttle=_$throttle_563.throttle,lib.throttleDone=_$throttle_563.done,lib.clearThrottle=_$throttle_563.clear,lib.getGraphDiv=_$get_graph_div_534,lib._=function localize(gd,s){for(var locale=gd._context.locale,i=0;i<2;i++){for(var locales=gd._context.locales,j=0;j<2;j++){var dict=(locales[locale]||{}).dictionary;if(dict){var out=dict[s];if(out)return out}locales=_$registry_668.localeRegistry}var baseLocale=locale.split("-")[0];if(baseLocale===locale)break;locale=baseLocale}return s},lib.notifier=function(text,displayLength){if(-1===NOTEDATA.indexOf(text)){NOTEDATA.push(text);var ts=1e3;_$fastIsnumeric_139(displayLength)?ts=displayLength:"long"===displayLength&&(ts=3e3);var notifierContainer=_$d3_127.select("body").selectAll(".plotly-notifier").data([0]);notifierContainer.enter().append("div").classed("plotly-notifier",!0),notifierContainer.selectAll(".notifier-note").data(NOTEDATA).enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(thisText){var note=_$d3_127.select(this);note.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){note.transition().call(killNote)});for(var p=note.append("p"),lines=thisText.split(/<br\s*\/?>/g),i=0;i<lines.length;i++)i&&p.append("br"),p.append("span").text(lines[i]);note.transition().duration(700).style("opacity",1).transition().delay(ts).call(killNote)})}function killNote(transition){transition.duration(700).style("opacity",0).each("end",function(thisText){var thisIndex=NOTEDATA.indexOf(thisText);-1!==thisIndex&&NOTEDATA.splice(thisIndex,1),_$d3_127.select(this).remove()})}},lib.filterUnique=function filterUnique(array){for(var seen={},out=[],j=0,i=0;i<array.length;i++){var item=array[i];1!==seen[item]&&(seen[item]=1,out[j++]=item)}return out},lib.filterVisible=function filterVisible(container){for(var filterFn=function isCalcData(cont){return Array.isArray(cont)&&Array.isArray(cont[0])&&cont[0][0]&&cont[0][0].trace}(container)?calcDataFilter:baseFilter,out=[],i=0;i<container.length;i++){var item=container[i];filterFn(item)&&out.push(item)}return out},lib.pushUnique=_$pushUnique_552,lib.cleanNumber=function cleanNumber(v){return"string"==typeof v&&(v=v.replace(JUNK,"")),_$fastIsnumeric_139(v)?Number(v):BADNUM},lib.ensureNumber=function num(v){return _$fastIsnumeric_139(v)?(v=Number(v))<-FP_SAFE||v>FP_SAFE?__BADNUM_539:_$fastIsnumeric_139(v)?Number(v):__BADNUM_539:__BADNUM_539},lib.noop=_$noop_548,lib.identity=_$identity_538,lib.swapAttrs=function(cont,attrList,part1,part2){part1||(part1="x"),part2||(part2="y");for(var i=0;i<attrList.length;i++){var attr=attrList[i],xp=lib.nestedProperty(cont,attr.replace("?",part1)),yp=lib.nestedProperty(cont,attr.replace("?",part2)),temp=xp.get();xp.set(yp.get()),yp.set(temp)}},lib.raiseToTop=function raiseToTop(elem){elem.parentNode.appendChild(elem)},lib.cancelTransition=function(selection){return selection.transition().duration(0)},lib.constrain=function(v,v0,v1){return v0>v1?Math.max(v1,Math.min(v0,v)):Math.max(v0,Math.min(v1,v))},lib.bBoxIntersect=function(a,b,pad){return pad=pad||0,a.left<=b.right+pad&&b.left<=a.right+pad&&a.top<=b.bottom+pad&&b.top<=a.bottom+pad},lib.simpleMap=function(array,func,x1,x2){for(var len=array.length,out=new Array(len),i=0;i<len;i++)out[i]=func(array[i],x1,x2);return out},lib.randstr=function randstr(existing,bits,base){if(base||(base=16),void 0===bits&&(bits=24),bits<=0)return"0";var i,b,digits=Math.log(Math.pow(2,bits))/Math.log(base),res="";for(i=2;digits===1/0;i*=2)digits=Math.log(Math.pow(2,bits/i))/Math.log(base)*i;var rem=digits-Math.floor(digits);for(i=0;i<Math.floor(digits);i++)res=Math.floor(Math.random()*base).toString(base)+res;rem&&(b=Math.pow(base,rem),res=Math.floor(Math.random()*b).toString(base)+res);var parsed=parseInt(res,base);return existing&&existing.indexOf(res)>-1||parsed!==1/0&&parsed>=Math.pow(2,bits)?randstr(existing,bits,base):res},lib.OptionControl=function(opt,optname){opt||(opt={}),optname||(optname="opt");var self={optionList:[],_newoption:function(optObj){optObj[optname]=opt,self[optObj.name]=optObj,self.optionList.push(optObj)}};return self["_"+optname]=opt,self},lib.smooth=function(arrayIn,FWHM){if((FWHM=Math.round(FWHM)||0)<2)return arrayIn;var i,j,k,v,alen=arrayIn.length,alen2=2*alen,wlen=2*FWHM-1,w=new Array(wlen),arrayOut=new Array(alen);for(i=0;i<wlen;i++)w[i]=(1-Math.cos(Math.PI*(i+1)/FWHM))/(2*FWHM);for(i=0;i<alen;i++){for(v=0,j=0;j<wlen;j++)(k=i+j+1-FWHM)<-alen?k-=alen2*Math.round(k/alen2):k>=alen2&&(k-=alen2*Math.floor(k/alen2)),k<0?k=-1-k:k>=alen&&(k=alen2-1-k),v+=arrayIn[k]*w[j];arrayOut[i]=v}return arrayOut},lib.syncOrAsync=function(sequence,arg,finalStep){var ret;function continueAsync(){return lib.syncOrAsync(sequence,arg,finalStep)}for(;sequence.length;)if((ret=(0,sequence.splice(0,1)[0])(arg))&&ret.then)return ret.then(continueAsync).then(void 0,lib.promiseError);return finalStep&&finalStep(arg)},lib.stripTrailingSlash=function(str){return"/"===str.substr(-1)?str.substr(0,str.length-1):str},lib.noneOrAll=function(containerIn,containerOut,attrList){if(containerIn){var i,val,hasAny=!1,hasAll=!0;for(i=0;i<attrList.length;i++)void 0!==(val=containerIn[attrList[i]])&&null!==val?hasAny=!0:hasAll=!1;if(hasAny&&!hasAll)for(i=0;i<attrList.length;i++)containerIn[attrList[i]]=containerOut[attrList[i]]}},lib.mergeArray=function(traceAttr,cd,cdAttr){if(lib.isArrayOrTypedArray(traceAttr))for(var imax=Math.min(traceAttr.length,cd.length),i=0;i<imax;i++)cd[i][cdAttr]=traceAttr[i]},lib.fillArray=function(traceAttr,cd,cdAttr,fn){if(fn=fn||lib.identity,lib.isArrayOrTypedArray(traceAttr))for(var i=0;i<cd.length;i++)cd[i][cdAttr]=fn(traceAttr[i])},lib.castOption=function(trace,ptNumber,astr,fn){fn=fn||lib.identity;var val=lib.nestedProperty(trace,astr).get();return lib.isArrayOrTypedArray(val)?Array.isArray(ptNumber)&&lib.isArrayOrTypedArray(val[ptNumber[0]])?fn(val[ptNumber[0]][ptNumber[1]]):fn(val[ptNumber]):val},lib.extractOption=function(calcPt,trace,calcKey,traceKey){if(calcKey in calcPt)return calcPt[calcKey];var traceVal=lib.nestedProperty(trace,traceKey).get();return Array.isArray(traceVal)?void 0:traceVal},lib.tagSelected=function(calcTrace,trace,ptNumber2cdIndex){var ptIndex2ptNumber,v,selectedpoints=trace.selectedpoints,indexToPoints=trace._indexToPoints;if(indexToPoints)for(var k in ptIndex2ptNumber={},indexToPoints)for(var pts=indexToPoints[k],j=0;j<pts.length;j++)ptIndex2ptNumber[pts[j]]=k;function isCdIndexValid(v){return void 0!==v&&v<calcTrace.length}for(var i=0;i<selectedpoints.length;i++){var ptIndex=selectedpoints[i];if(_$fastIsnumeric_139(v=ptIndex)&&v>=0&&v%1==0){var ptNumber=ptIndex2ptNumber?ptIndex2ptNumber[ptIndex]:ptIndex,cdIndex=ptNumber2cdIndex?ptNumber2cdIndex[ptNumber]:ptNumber;isCdIndexValid(cdIndex)&&(calcTrace[cdIndex].selected=1)}}},lib.getTargetArray=function(trace,transformOpts){var target=transformOpts.target;if("string"==typeof target&&target){var array=lib.nestedProperty(trace,target).get();return!!Array.isArray(array)&&array}return!!Array.isArray(target)&&target},lib.minExtend=function(obj1,obj2){var objOut={};"object"!=typeof obj2&&(obj2={});var i,k,v,keys=Object.keys(obj1);for(i=0;i<keys.length;i++)v=obj1[k=keys[i]],"_"!==k.charAt(0)&&"function"!=typeof v&&("module"===k?objOut[k]=v:Array.isArray(v)?objOut[k]=v.slice(0,3):objOut[k]=v&&"object"==typeof v?lib.minExtend(obj1[k],obj2[k]):v);for(keys=Object.keys(obj2),i=0;i<keys.length;i++)"object"==typeof(v=obj2[k=keys[i]])&&k in objOut&&"object"==typeof objOut[k]||(objOut[k]=v);return objOut},lib.titleCase=function(s){return s.charAt(0).toUpperCase()+s.substr(1)},lib.containsAny=function(s,fragments){for(var i=0;i<fragments.length;i++)if(-1!==s.indexOf(fragments[i]))return!0;return!1},lib.isPlotDiv=function(el){var el3=_$d3_127.select(el);return el3.node()instanceof HTMLElement&&el3.size()&&el3.classed("js-plotly-plot")},lib.removeElement=function(el){var elParent=el&&el.parentNode;elParent&&elParent.removeChild(el)},lib.addStyleRule=function(selector,styleString){if(!lib.styleSheet){var style=document.createElement("style");style.appendChild(document.createTextNode("")),document.head.appendChild(style),lib.styleSheet=style.sheet}var styleSheet=lib.styleSheet;styleSheet.insertRule?styleSheet.insertRule(selector+"{"+styleString+"}",0):styleSheet.addRule?styleSheet.addRule(selector,styleString,0):lib.warn("addStyleRule failed")},lib.isIE=function(){return void 0!==window.navigator.msSaveBlob},lib.isD3Selection=function(obj){return obj&&"function"==typeof obj.classed},lib.objectFromPath=function(path,value){for(var tmpObj,keys=path.split("."),obj=tmpObj={},i=0;i<keys.length;i++){var key=keys[i],el=null,parts=keys[i].match(/(.*)\[([0-9]+)\]/);parts?(key=parts[1],el=parts[2],tmpObj=tmpObj[key]=[],i===keys.length-1?tmpObj[el]=value:tmpObj[el]={},tmpObj=tmpObj[el]):(i===keys.length-1?tmpObj[key]=value:tmpObj[key]={},tmpObj=tmpObj[key])}return obj};var dottedPropertyRegex=/^([^\[\.]+)\.(.+)?/,indexedPropertyRegex=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;lib.expandObjectPaths=function(data){var match,key,prop,datum,idx,dest,trailingPath;if("object"==typeof data&&!Array.isArray(data))for(key in data)data.hasOwnProperty(key)&&((match=key.match(dottedPropertyRegex))?(datum=data[key],prop=match[1],delete data[key],data[prop]=lib.extendDeepNoArrays(data[prop]||{},lib.objectFromPath(key,lib.expandObjectPaths(datum))[prop])):(match=key.match(indexedPropertyRegex))?(datum=data[key],prop=match[1],idx=parseInt(match[2]),delete data[key],data[prop]=data[prop]||[],"."===match[3]?(trailingPath=match[4],dest=data[prop][idx]=data[prop][idx]||{},lib.extendDeepNoArrays(dest,lib.objectFromPath(trailingPath,lib.expandObjectPaths(datum)))):data[prop][idx]=lib.expandObjectPaths(datum)):data[key]=lib.expandObjectPaths(data[key]));return data},lib.numSeparate=function(value,separators,separatethousands){if(separatethousands||(separatethousands=!1),"string"!=typeof separators||0===separators.length)throw new Error("Separator string required for formatting!");"number"==typeof value&&(value=String(value));var thousandsRe=/(\d+)(\d{3})/,decimalSep=separators.charAt(0),thouSep=separators.charAt(1),x=value.split("."),x1=x[0],x2=x.length>1?decimalSep+x[1]:"";if(thouSep&&(x.length>1||x1.length>4||separatethousands))for(;thousandsRe.test(x1);)x1=x1.replace(thousandsRe,"$1"+thouSep+"$2");return x1+x2};var TEMPLATE_STRING_REGEX=/%{([^\s%{}]*)}/g,__SIMPLE_PROPERTY_REGEX_539=/^\w*$/;lib.templateString=function(string,obj){var getterCache={};return string.replace(TEMPLATE_STRING_REGEX,function(dummy,key){return __SIMPLE_PROPERTY_REGEX_539.test(key)?obj[key]||"":(getterCache[key]=getterCache[key]||lib.nestedProperty(obj,key).get,getterCache[key]()||"")})};lib.subplotSort=function(a,b){for(var l=Math.min(a.length,b.length)+1,numA=0,numB=0,i=0;i<l;i++){var charA=a.charCodeAt(i)||0,charB=b.charCodeAt(i)||0,isNumA=charA>=48&&charA<=57,isNumB=charB>=48&&charB<=57;if(isNumA&&(numA=10*numA+charA-48),isNumB&&(numB=10*numB+charB-48),!isNumA||!isNumB){if(numA!==numB)return numA-numB;if(charA!==charB)return charA-charB}}return numB-numA};var randSeed=2e9;lib.seedPseudoRandom=function(){randSeed=2e9},lib.pseudoRandom=function(){var lastVal=randSeed;return randSeed=(69069*randSeed+1)%4294967296,Math.abs(randSeed-lastVal)<429496729?lib.pseudoRandom():randSeed/4294967296};var __extendFlat_569=_$lib_539.extendFlat,__isPlainObject_569=_$lib_539.isPlainObject,traceOpts={valType:"flaglist",extras:["none"],flags:["calc","calcIfAutorange","clearAxisTypes","plot","style","colorbars"]},layoutOpts={valType:"flaglist",extras:["none"],flags:["calc","calcIfAutorange","plot","legend","ticks","margins","layoutstyle","modebar","camera","arraydraw"]},traceEditTypeFlags=traceOpts.flags.slice().concat(["clearCalc","fullReplot"]),layoutEditTypeFlags=layoutOpts.flags.slice().concat("layoutReplot"),_$edit_types_569={traces:traceOpts,layout:layoutOpts,traceFlags:function(){return falseObj(traceEditTypeFlags)},layoutFlags:function(){return falseObj(layoutEditTypeFlags)},update:function(flags,attr){var editType=attr.editType;if(editType&&"none"!==editType)for(var editTypeParts=editType.split("+"),i=0;i<editTypeParts.length;i++)flags[editTypeParts[i]]=!0},overrideAll:overrideAll};function falseObj(keys){for(var out={},i=0;i<keys.length;i++)out[keys[i]]=!1;return out}function overrideAll(attrs,editTypeOverride,overrideContainers){var out=__extendFlat_569({},attrs);for(var key in out){var attr=out[key];__isPlainObject_569(attr)&&(out[key]=overrideOne(attr,editTypeOverride,overrideContainers,key))}return"from-root"===overrideContainers&&(out.editType=editTypeOverride),out}function overrideOne(attr,editTypeOverride,overrideContainers,key){if(attr.valType){var out=__extendFlat_569({},attr);if(out.editType=editTypeOverride,Array.isArray(attr.items)){out.items=new Array(attr.items.length);for(var i=0;i<attr.items.length;i++)out.items[i]=overrideOne(attr.items[i],editTypeOverride,"from-root")}return out}return overrideAll(attr,editTypeOverride,"_"===key.charAt(0)?"nested":"from-root")}var _$animation_attributes_579={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"]}}},_$frame_attributes_612={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}},_$attributes_435={dash:{valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"}},__counterRegex_589=_$regex_554.counter,_$constants_589={idRegex:{x:__counterRegex_589("x"),y:__counterRegex_589("y")},attrRegex:__counterRegex_589("[xy]axis"),xAxisMatch:__counterRegex_589("xaxis"),yAxisMatch:__counterRegex_589("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,MINDRAG:8,MINSELECT:12,MINZOOM:20,DRAGGERSIZE:20,BENDPX:1.5,REDRAWDELAY:50,SELECTDELAY:100,SELECTID:"-select",DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","maplayer","barlayer","carpetlayer","violinlayer","boxlayer","scatterlayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}},dash=_$attributes_435.dash,__extendFlat_596=_$extend_528.extendFlat,_$layout_attributes_596={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:_$attributes_410.defaultLine,editType:"ticks"},title:{valType:"string",editType:"ticks+margins"},titlefont:_$font_attributes_611({editType:"ticks+margins"}),type:{valType:"enumerated",values:["-","linear","log","date","category"],dflt:"-",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"plot+margins",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot+margins",impliedEdits:{"^autorange":!1}}],editType:"plot+margins",impliedEdits:{autorange:!1}},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[_$constants_589.idRegex.x.toString(),_$constants_589.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],dflt:"range",editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},tickmode:{valType:"enumerated",values:["auto","linear","array"],editType:"ticks+margins",impliedEdits:{tick0:void 0,dtick:void 0}},nticks:{valType:"integer",min:0,dflt:0,editType:"ticks+margins"},tick0:{valType:"any",editType:"ticks+margins",impliedEdits:{tickmode:"linear"}},dtick:{valType:"any",editType:"ticks+margins",impliedEdits:{tickmode:"linear"}},tickvals:{valType:"data_array",editType:"ticks+margins"},ticktext:{valType:"data_array",editType:"ticks+margins"},ticks:{valType:"enumerated",values:["outside","inside",""],editType:"ticks+margins"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:{valType:"number",min:0,dflt:5,editType:"ticks"},tickwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},tickcolor:{valType:"color",dflt:_$attributes_410.defaultLine,editType:"ticks"},showticklabels:{valType:"boolean",dflt:!0,editType:"ticks+margins"},automargin:{valType:"boolean",dflt:!1,editType:"ticks+margins"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:__extendFlat_596({},dash,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor"],dflt:"data",editType:"none"},tickfont:_$font_attributes_611({editType:"ticks+margins"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks+margins"},tickprefix:{valType:"string",dflt:"",editType:"ticks+margins"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks+margins"},ticksuffix:{valType:"string",dflt:"",editType:"ticks+margins"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks+margins"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks+margins"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks+margins"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks+margins"},tickformat:{valType:"string",dflt:"",editType:"ticks+margins"},tickformatstops:{_isLinkedToArray:"tickformatstop",dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks+margins"},{valType:"any",editType:"ticks+margins"}],editType:"ticks+margins"},value:{valType:"string",dflt:"",editType:"ticks+margins"},editType:"ticks+margins"},hoverformat:{valType:"string",dflt:"",editType:"none"},showline:{valType:"boolean",dflt:!1,editType:"layoutstyle"},linecolor:{valType:"color",dflt:_$attributes_410.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:{valType:"boolean",editType:"ticks"},gridcolor:{valType:"color",dflt:_$attributes_410.lightLine,editType:"ticks"},gridwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:_$attributes_410.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",_$constants_589.idRegex.x.toString(),_$constants_589.idRegex.y.toString()],editType:"plot+margins"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot+margins"},overlaying:{valType:"enumerated",values:["free",_$constants_589.idRegex.x.toString(),_$constants_589.idRegex.y.toString()],editType:"plot"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot+margins"},{valType:"number",min:0,max:1,editType:"plot+margins"}],dflt:[0,1],editType:"plot+margins"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot+margins"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks+margins"}}},__extendFlat_412=_$extend_528.extendFlat,_$attributes_412=(0,_$edit_types_569.overrideAll)({thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",dflt:1.02,min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",dflt:.5,min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle"},ypad:{valType:"number",min:0,dflt:10},outlinecolor:_$layout_attributes_596.linecolor,outlinewidth:_$layout_attributes_596.linewidth,bordercolor:_$layout_attributes_596.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:_$layout_attributes_596.tickmode,nticks:_$layout_attributes_596.nticks,tick0:_$layout_attributes_596.tick0,dtick:_$layout_attributes_596.dtick,tickvals:_$layout_attributes_596.tickvals,ticktext:_$layout_attributes_596.ticktext,ticks:__extendFlat_412({},_$layout_attributes_596.ticks,{dflt:""}),ticklen:_$layout_attributes_596.ticklen,tickwidth:_$layout_attributes_596.tickwidth,tickcolor:_$layout_attributes_596.tickcolor,showticklabels:_$layout_attributes_596.showticklabels,tickfont:_$font_attributes_611({}),tickangle:_$layout_attributes_596.tickangle,tickformat:_$layout_attributes_596.tickformat,tickformatstops:_$layout_attributes_596.tickformatstops,tickprefix:_$layout_attributes_596.tickprefix,showtickprefix:_$layout_attributes_596.showtickprefix,ticksuffix:_$layout_attributes_596.ticksuffix,showticksuffix:_$layout_attributes_596.showticksuffix,separatethousands:_$layout_attributes_596.separatethousands,exponentformat:_$layout_attributes_596.exponentformat,showexponent:_$layout_attributes_596.showexponent,title:{valType:"string"},titlefont:_$font_attributes_611({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}},"colorbars","from-root"),_$attributes_417={zauto:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{zmin:void 0,zmax:void 0}},zmin:{valType:"number",dflt:null,editType:"plot",impliedEdits:{zauto:!1}},zmax:{valType:"number",dflt:null,editType:"plot",impliedEdits:{zauto:!1}},colorscale:{valType:"colorscale",editType:"calc",impliedEdits:{autocolorscale:!1}},autocolorscale:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{colorscale:void 0}},reversescale:{valType:"boolean",dflt:!1,editType:"calc"},showscale:{valType:"boolean",dflt:!0,editType:"calc"}},__extendFlat_419=_$extend_528.extendFlat,_$makeColorScaleAttributes_419=function makeColorScaleAttributes(context,editTypeOverride,autoColorDflt){return{color:{valType:"color",arrayOk:!0,editType:editTypeOverride||"style"},colorscale:__extendFlat_419({},_$attributes_417.colorscale,{}),cauto:__extendFlat_419({},_$attributes_417.zauto,{impliedEdits:{cmin:void 0,cmax:void 0}}),cmax:__extendFlat_419({},_$attributes_417.zmax,{editType:editTypeOverride||_$attributes_417.zmax.editType,impliedEdits:{cauto:!1}}),cmin:__extendFlat_419({},_$attributes_417.zmin,{editType:editTypeOverride||_$attributes_417.zmin.editType,impliedEdits:{cauto:!1}}),autocolorscale:__extendFlat_419({},_$attributes_417.autocolorscale,{dflt:!1===autoColorDflt?autoColorDflt:_$attributes_417.autocolorscale.dflt}),reversescale:__extendFlat_419({},_$attributes_417.reversescale,{})}},_$color_411={},color=_$color_411={};color.defaults=_$attributes_410.defaults;var defaultLine=color.defaultLine=_$attributes_410.defaultLine;color.lightLine=_$attributes_410.lightLine;var background=color.background=_$attributes_410.background;function cleanOne(val){if(_$fastIsnumeric_139(val)||"string"!=typeof val)return val;var valTrim=val.trim();if("rgb"!==valTrim.substr(0,3))return val;var match=valTrim.match(/^rgba?\s*\(([^()]*)\)$/);if(!match)return val;var parts=match[1].trim().split(/\s*[\s,]\s*/),rgba="a"===valTrim.charAt(3)&&4===parts.length;if(!rgba&&3!==parts.length)return val;for(var i=0;i<parts.length;i++){if(!parts[i].length)return val;if(parts[i]=Number(parts[i]),!(parts[i]>=0))return val;if(3===i)parts[i]>1&&(parts[i]=1);else if(parts[i]>=1)return val}var rgbStr=Math.round(255*parts[0])+", "+Math.round(255*parts[1])+", "+Math.round(255*parts[2]);return rgba?"rgba("+rgbStr+", "+parts[3]+")":"rgb("+rgbStr+")"}color.tinyRGB=function(tc){var c=tc.toRgb();return"rgb("+Math.round(c.r)+", "+Math.round(c.g)+", "+Math.round(c.b)+")"},color.rgb=function(cstr){return color.tinyRGB(_$tinycolor_352(cstr))},color.opacity=function(cstr){return cstr?_$tinycolor_352(cstr).getAlpha():0},color.addOpacity=function(cstr,op){var c=_$tinycolor_352(cstr).toRgb();return"rgba("+Math.round(c.r)+", "+Math.round(c.g)+", "+Math.round(c.b)+", "+op+")"},color.combine=function(front,back){var fc=_$tinycolor_352(front).toRgb();if(1===fc.a)return _$tinycolor_352(front).toRgbString();var bc=_$tinycolor_352(back||background).toRgb(),bcflat=1===bc.a?bc:{r:255*(1-bc.a)+bc.r*bc.a,g:255*(1-bc.a)+bc.g*bc.a,b:255*(1-bc.a)+bc.b*bc.a},fcflat={r:bcflat.r*(1-fc.a)+fc.r*fc.a,g:bcflat.g*(1-fc.a)+fc.g*fc.a,b:bcflat.b*(1-fc.a)+fc.b*fc.a};return _$tinycolor_352(fcflat).toRgbString()},color.contrast=function(cstr,lightAmount,darkAmount){var tc=_$tinycolor_352(cstr);return 1!==tc.getAlpha()&&(tc=_$tinycolor_352(color.combine(cstr,background))),(tc.isDark()?lightAmount?tc.lighten(lightAmount):background:darkAmount?tc.darken(darkAmount):defaultLine).toString()},color.stroke=function(s,c){var tc=_$tinycolor_352(c);s.style({stroke:color.tinyRGB(tc),"stroke-opacity":tc.getAlpha()})},color.fill=function(s,c){var tc=_$tinycolor_352(c);s.style({fill:color.tinyRGB(tc),"fill-opacity":tc.getAlpha()})},color.clean=function(container){if(container&&"object"==typeof container){var i,j,key,val,keys=Object.keys(container);for(i=0;i<keys.length;i++)if(val=container[key=keys[i]],"color"===key.substr(key.length-5))if(Array.isArray(val))for(j=0;j<val.length;j++)val[j]=cleanOne(val[j]);else container[key]=cleanOne(val);else if("colorscale"===key.substr(key.length-10)&&Array.isArray(val))for(j=0;j<val.length;j++)Array.isArray(val[j])&&(val[j][1]=cleanOne(val[j][1]));else if(Array.isArray(val)){var el0=val[0];if(!Array.isArray(el0)&&el0&&"object"==typeof el0)for(j=0;j<val.length;j++)color.clean(val[j])}else val&&"object"==typeof val&&color.clean(val)}};var _$flipScale_423=function flipScale(scl){for(var si,N=scl.length,sclNew=new Array(N),i=N-1,j=0;i>=0;i--,j++)si=scl[i],sclNew[j]=[1-si[0],si[1]];return sclNew},_$calc_418=function calc(trace,vals,containerStr,cLetter){var container,inputContainer;containerStr?(container=_$lib_539.nestedProperty(trace,containerStr).get(),inputContainer=_$lib_539.nestedProperty(trace._input,containerStr).get()):(container=trace,inputContainer=trace._input);var autoAttr=cLetter+"auto",minAttr=cLetter+"min",maxAttr=cLetter+"max",auto=container[autoAttr],min=container[minAttr],max=container[maxAttr],scl=container.colorscale;!1===auto&&void 0!==min||(min=_$lib_539.aggNums(Math.min,null,vals)),!1===auto&&void 0!==max||(max=_$lib_539.aggNums(Math.max,null,vals)),min===max&&(min-=.5,max+=.5),container[minAttr]=min,container[maxAttr]=max,inputContainer[minAttr]=min,inputContainer[maxAttr]=max,inputContainer[autoAttr]=!1!==auto||void 0===min&&void 0===max,container.autocolorscale&&(scl=min*max<0?_$scales_430.RdBu:min>=0?_$scales_430.Reds:_$scales_430.Blues,inputContainer.colorscale=scl,container.reversescale&&(scl=_$flipScale_423(scl)),container.colorscale=scl)},_$handleTickLabelDefaults_604=function handleTickLabelDefaults(containerIn,containerOut,coerce,axType,options){var showAttrDflt=function getShowAttrDflt(containerIn){var showAttrs=["showexponent","showtickprefix","showticksuffix"].filter(function(a){return void 0!==containerIn[a]});if(showAttrs.every(function(a){return containerIn[a]===containerIn[showAttrs[0]]})||1===showAttrs.length)return containerIn[showAttrs[0]]}(containerIn);if(coerce("tickprefix")&&coerce("showtickprefix",showAttrDflt),coerce("ticksuffix",options.tickSuffixDflt)&&coerce("showticksuffix",showAttrDflt),coerce("showticklabels")){var font=options.font||{},dfltFontColor=containerOut.color===containerIn.color?containerOut.color:font.color;if(_$lib_539.coerceFont(coerce,"tickfont",{family:font.family,size:font.size,color:dfltFontColor}),coerce("tickangle"),"category"!==axType){var tickFormat=coerce("tickformat");!function tickformatstopsDefaults(tickformatIn,tickformatOut){var valueIn,valueOut,valuesIn=tickformatIn.tickformatstops,valuesOut=tickformatOut.tickformatstops=[];if(!Array.isArray(valuesIn))return;function coerce(attr,dflt){return _$lib_539.coerce(valueIn,valueOut,_$layout_attributes_596.tickformatstops,attr,dflt)}for(var i=0;i<valuesIn.length;i++)valueIn=valuesIn[i],valueOut={},coerce("dtickrange"),coerce("value"),valuesOut.push(valueOut)}(containerIn,containerOut),tickFormat||"date"===axType||(coerce("showexponent",showAttrDflt),coerce("exponentformat"),coerce("separatethousands"))}}};var _$handleTickDefaults_605=function handleTickDefaults(containerIn,containerOut,coerce,options){var tickLen=_$lib_539.coerce2(containerIn,containerOut,_$layout_attributes_596,"ticklen"),tickWidth=_$lib_539.coerce2(containerIn,containerOut,_$layout_attributes_596,"tickwidth"),tickColor=_$lib_539.coerce2(containerIn,containerOut,_$layout_attributes_596,"tickcolor",containerOut.color);coerce("ticks",options.outerTicks||tickLen||tickWidth||tickColor?"outside":"")||(delete containerOut.ticklen,delete containerOut.tickwidth,delete containerOut.tickcolor)},__ONEDAY_606=_$numerical_517.ONEDAY,_$handleTickValueDefaults_606=function handleTickValueDefaults(containerIn,containerOut,coerce,axType){var tickmodeDefault="auto";"array"!==containerIn.tickmode||"log"!==axType&&"date"!==axType||(containerIn.tickmode="auto"),Array.isArray(containerIn.tickvals)?tickmodeDefault="array":containerIn.dtick&&(tickmodeDefault="linear");var tickmode=coerce("tickmode",tickmodeDefault);if("auto"===tickmode)coerce("nticks");else if("linear"===tickmode){var dtickDflt="date"===axType?__ONEDAY_606:1,dtick=coerce("dtick",dtickDflt);if(_$fastIsnumeric_139(dtick))containerOut.dtick=dtick>0?Number(dtick):dtickDflt;else if("string"!=typeof dtick)containerOut.dtick=dtickDflt;else{var prefix=dtick.charAt(0),dtickNum=dtick.substr(1);((dtickNum=_$fastIsnumeric_139(dtickNum)?Number(dtickNum):0)<=0||!("date"===axType&&"M"===prefix&&dtickNum===Math.round(dtickNum)||"log"===axType&&"L"===prefix||"log"===axType&&"D"===prefix&&(1===dtickNum||2===dtickNum)))&&(containerOut.dtick=dtickDflt)}var tick0Dflt="date"===axType?_$lib_539.dateTick0(containerOut.calendar):0,tick0=coerce("tick0",tick0Dflt);"date"===axType?containerOut.tick0=_$lib_539.cleanDate(tick0,tick0Dflt):_$fastIsnumeric_139(tick0)&&"D1"!==dtick&&"D2"!==dtick?containerOut.tick0=Number(tick0):containerOut.tick0=tick0Dflt}else{void 0===coerce("tickvals")?containerOut.tickmode="auto":coerce("ticktext")}},_$isValidScale_427=function isValidScale(scl){return void 0!==_$scales_430[scl]||_$isValidScaleArray_428(scl)},_$colorScaleDefaults_421=function colorScaleDefaults(traceIn,traceOut,layout,coerce,opts){var autoColorscaleDftl,prefix=opts.prefix,cLetter=opts.cLetter,containerStr=prefix.slice(0,prefix.length-1),containerIn=prefix?_$lib_539.nestedProperty(traceIn,containerStr).get()||{}:traceIn,containerOut=prefix?_$lib_539.nestedProperty(traceOut,containerStr).get()||{}:traceOut,minIn=containerIn[cLetter+"min"],maxIn=containerIn[cLetter+"max"],sclIn=containerIn.colorscale;coerce(prefix+cLetter+"auto",!(_$fastIsnumeric_139(minIn)&&_$fastIsnumeric_139(maxIn)&&minIn<maxIn)),coerce(prefix+cLetter+"min"),coerce(prefix+cLetter+"max"),void 0!==sclIn&&(autoColorscaleDftl=!_$isValidScale_427(sclIn)),coerce(prefix+"autocolorscale",autoColorscaleDftl);var showScaleDftl,sclOut=coerce(prefix+"colorscale");(coerce(prefix+"reversescale")&&(containerOut.colorscale=_$flipScale_423(sclOut)),"marker.line."!==prefix)&&(prefix&&(showScaleDftl=function hasColorbar(container){return _$lib_539.isPlainObject(container.colorbar)}(containerIn)),coerce(prefix+"showscale",showScaleDftl)&&function colorbarDefaults(containerIn,containerOut,layout){var colorbarOut=containerOut.colorbar={},colorbarIn=containerIn.colorbar||{};function coerce(attr,dflt){return _$lib_539.coerce(colorbarIn,colorbarOut,_$attributes_412,attr,dflt)}coerce("thickness","fraction"===coerce("thicknessmode")?30/(layout.width-layout.margin.l-layout.margin.r):30),coerce("len","fraction"===coerce("lenmode")?1:layout.height-layout.margin.t-layout.margin.b),coerce("x"),coerce("xanchor"),coerce("xpad"),coerce("y"),coerce("yanchor"),coerce("ypad"),_$lib_539.noneOrAll(colorbarIn,colorbarOut,["x","y"]),coerce("outlinecolor"),coerce("outlinewidth"),coerce("bordercolor"),coerce("borderwidth"),coerce("bgcolor"),_$handleTickValueDefaults_606(colorbarIn,colorbarOut,coerce,"linear");var opts={outerTicks:!1,font:layout.font};_$handleTickLabelDefaults_604(colorbarIn,colorbarOut,coerce,"linear",opts),_$handleTickDefaults_605(colorbarIn,colorbarOut,coerce,"linear",opts),coerce("title",layout._dfltTitle.colorbar),_$lib_539.coerceFont(coerce,"titlefont",layout.font),coerce("titleside")}(containerIn,containerOut,layout))},_$hasColorscale_425=function hasColorscale(trace,containerStr){var container=containerStr?_$lib_539.nestedProperty(trace,containerStr).get()||{}:trace,color=container.color,isArrayWithOneNumber=!1;if(_$lib_539.isArrayOrTypedArray(color))for(var i=0;i<color.length;i++)if(_$fastIsnumeric_139(color[i])){isArrayWithOneNumber=!0;break}return _$lib_539.isPlainObject(container)&&(isArrayWithOneNumber||!0===container.showscale||_$fastIsnumeric_139(container.cmin)&&_$fastIsnumeric_139(container.cmax)||_$isValidScale_427(container.colorscale)||_$lib_539.isPlainObject(container.colorbar))};function colorArray2rbga(colorArray){var colorObj={r:colorArray[0],g:colorArray[1],b:colorArray[2],a:colorArray[3]};return _$tinycolor_352(colorObj).toRgbString()}var _$colorscale_426={};_$colorscale_426.scales=_$scales_430,_$colorscale_426.defaultScale=_$default_scale_420,_$colorscale_426.attributes=_$attributes_417,_$colorscale_426.handleDefaults=_$colorScaleDefaults_421,_$colorscale_426.calc=_$calc_418,_$colorscale_426.hasColorscale=_$hasColorscale_425,_$colorscale_426.isValidScale=_$isValidScale_427,_$colorscale_426.getScale=_$getScale_424,_$colorscale_426.flipScale=_$flipScale_423,_$colorscale_426.extractScale=function extractScale(scl,cmin,cmax){for(var N=scl.length,domain=new Array(N),range=new Array(N),i=0;i<N;i++){var si=scl[i];domain[i]=cmin+si[0]*(cmax-cmin),range[i]=si[1]}return{domain:domain,range:range}},_$colorscale_426.makeColorScaleFunc=function makeColorScaleFunc(specs,opts){opts=opts||{};for(var domain=specs.domain,range=specs.range,N=range.length,_range=new Array(N),i=0;i<N;i++){var rgba=_$tinycolor_352(range[i]).toRgb();_range[i]=[rgba.r,rgba.g,rgba.b,rgba.a]}var sclFunc,_sclFunc=_$d3_127.scale.linear().domain(domain).range(_range).clamp(!0),noNumericCheck=opts.noNumericCheck,returnArray=opts.returnArray;return(sclFunc=noNumericCheck&&returnArray?_sclFunc:noNumericCheck?function(v){return colorArray2rbga(_sclFunc(v))}:returnArray?function(v){return _$fastIsnumeric_139(v)?_sclFunc(v):_$tinycolor_352(v).isValid()?v:_$color_411.defaultLine}:function(v){return _$fastIsnumeric_139(v)?colorArray2rbga(_sclFunc(v)):_$tinycolor_352(v).isValid()?v:_$color_411.defaultLine}).domain=_sclFunc.domain,sclFunc.range=function(){return range},sclFunc};var _$symbol_defs_437={circle:{n:0,f:function(r){var rs=_$d3_127.round(r,2);return"M"+rs+",0A"+rs+","+rs+" 0 1,1 0,-"+rs+"A"+rs+","+rs+" 0 0,1 "+rs+",0Z"}},square:{n:1,f:function(r){var rs=_$d3_127.round(r,2);return"M"+rs+","+rs+"H-"+rs+"V-"+rs+"H"+rs+"Z"}},diamond:{n:2,f:function(r){var rd=_$d3_127.round(1.3*r,2);return"M"+rd+",0L0,"+rd+"L-"+rd+",0L0,-"+rd+"Z"}},cross:{n:3,f:function(r){var rc=_$d3_127.round(.4*r,2),rc2=_$d3_127.round(1.2*r,2);return"M"+rc2+","+rc+"H"+rc+"V"+rc2+"H-"+rc+"V"+rc+"H-"+rc2+"V-"+rc+"H-"+rc+"V-"+rc2+"H"+rc+"V-"+rc+"H"+rc2+"Z"}},x:{n:4,f:function(r){var rx=_$d3_127.round(.8*r/Math.sqrt(2),2),ne="l"+rx+","+rx,se="l"+rx+",-"+rx,sw="l-"+rx+",-"+rx,nw="l-"+rx+","+rx;return"M0,"+rx+ne+se+sw+se+sw+nw+sw+nw+ne+nw+ne+"Z"}},"triangle-up":{n:5,f:function(r){var rt=_$d3_127.round(2*r/Math.sqrt(3),2);return"M-"+rt+","+_$d3_127.round(r/2,2)+"H"+rt+"L0,-"+_$d3_127.round(r,2)+"Z"}},"triangle-down":{n:6,f:function(r){var rt=_$d3_127.round(2*r/Math.sqrt(3),2);return"M-"+rt+",-"+_$d3_127.round(r/2,2)+"H"+rt+"L0,"+_$d3_127.round(r,2)+"Z"}},"triangle-left":{n:7,f:function(r){var rt=_$d3_127.round(2*r/Math.sqrt(3),2);return"M"+_$d3_127.round(r/2,2)+",-"+rt+"V"+rt+"L-"+_$d3_127.round(r,2)+",0Z"}},"triangle-right":{n:8,f:function(r){var rt=_$d3_127.round(2*r/Math.sqrt(3),2);return"M-"+_$d3_127.round(r/2,2)+",-"+rt+"V"+rt+"L"+_$d3_127.round(r,2)+",0Z"}},"triangle-ne":{n:9,f:function(r){var r1=_$d3_127.round(.6*r,2),r2=_$d3_127.round(1.2*r,2);return"M-"+r2+",-"+r1+"H"+r1+"V"+r2+"Z"}},"triangle-se":{n:10,f:function(r){var r1=_$d3_127.round(.6*r,2),r2=_$d3_127.round(1.2*r,2);return"M"+r1+",-"+r2+"V"+r1+"H-"+r2+"Z"}},"triangle-sw":{n:11,f:function(r){var r1=_$d3_127.round(.6*r,2),r2=_$d3_127.round(1.2*r,2);return"M"+r2+","+r1+"H-"+r1+"V-"+r2+"Z"}},"triangle-nw":{n:12,f:function(r){var r1=_$d3_127.round(.6*r,2),r2=_$d3_127.round(1.2*r,2);return"M-"+r1+","+r2+"V-"+r1+"H"+r2+"Z"}},pentagon:{n:13,f:function(r){var x1=_$d3_127.round(.951*r,2),x2=_$d3_127.round(.588*r,2),y0=_$d3_127.round(-r,2),y1=_$d3_127.round(-.309*r,2);return"M"+x1+","+y1+"L"+x2+","+_$d3_127.round(.809*r,2)+"H-"+x2+"L-"+x1+","+y1+"L0,"+y0+"Z"}},hexagon:{n:14,f:function(r){var y0=_$d3_127.round(r,2),y1=_$d3_127.round(r/2,2),x=_$d3_127.round(r*Math.sqrt(3)/2,2);return"M"+x+",-"+y1+"V"+y1+"L0,"+y0+"L-"+x+","+y1+"V-"+y1+"L0,-"+y0+"Z"}},hexagon2:{n:15,f:function(r){var x0=_$d3_127.round(r,2),x1=_$d3_127.round(r/2,2),y=_$d3_127.round(r*Math.sqrt(3)/2,2);return"M-"+x1+","+y+"H"+x1+"L"+x0+",0L"+x1+",-"+y+"H-"+x1+"L-"+x0+",0Z"}},octagon:{n:16,f:function(r){var a=_$d3_127.round(.924*r,2),b=_$d3_127.round(.383*r,2);return"M-"+b+",-"+a+"H"+b+"L"+a+",-"+b+"V"+b+"L"+b+","+a+"H-"+b+"L-"+a+","+b+"V-"+b+"Z"}},star:{n:17,f:function(r){var rs=1.4*r,x1=_$d3_127.round(.225*rs,2),x2=_$d3_127.round(.951*rs,2),x3=_$d3_127.round(.363*rs,2),x4=_$d3_127.round(.588*rs,2),y0=_$d3_127.round(-rs,2),y1=_$d3_127.round(-.309*rs,2),y3=_$d3_127.round(.118*rs,2),y4=_$d3_127.round(.809*rs,2);return"M"+x1+","+y1+"H"+x2+"L"+x3+","+y3+"L"+x4+","+y4+"L0,"+_$d3_127.round(.382*rs,2)+"L-"+x4+","+y4+"L-"+x3+","+y3+"L-"+x2+","+y1+"H-"+x1+"L0,"+y0+"Z"}},hexagram:{n:18,f:function(r){var y=_$d3_127.round(.66*r,2),x1=_$d3_127.round(.38*r,2),x2=_$d3_127.round(.76*r,2);return"M-"+x2+",0l-"+x1+",-"+y+"h"+x2+"l"+x1+",-"+y+"l"+x1+","+y+"h"+x2+"l-"+x1+","+y+"l"+x1+","+y+"h-"+x2+"l-"+x1+","+y+"l-"+x1+",-"+y+"h-"+x2+"Z"}},"star-triangle-up":{n:19,f:function(r){var x=_$d3_127.round(r*Math.sqrt(3)*.8,2),y1=_$d3_127.round(.8*r,2),y2=_$d3_127.round(1.6*r,2),rc=_$d3_127.round(4*r,2),aPart="A "+rc+","+rc+" 0 0 1 ";return"M-"+x+","+y1+aPart+x+","+y1+aPart+"0,-"+y2+aPart+"-"+x+","+y1+"Z"}},"star-triangle-down":{n:20,f:function(r){var x=_$d3_127.round(r*Math.sqrt(3)*.8,2),y1=_$d3_127.round(.8*r,2),y2=_$d3_127.round(1.6*r,2),rc=_$d3_127.round(4*r,2),aPart="A "+rc+","+rc+" 0 0 1 ";return"M"+x+",-"+y1+aPart+"-"+x+",-"+y1+aPart+"0,"+y2+aPart+x+",-"+y1+"Z"}},"star-square":{n:21,f:function(r){var rp=_$d3_127.round(1.1*r,2),rc=_$d3_127.round(2*r,2),aPart="A "+rc+","+rc+" 0 0 1 ";return"M-"+rp+",-"+rp+aPart+"-"+rp+","+rp+aPart+rp+","+rp+aPart+rp+",-"+rp+aPart+"-"+rp+",-"+rp+"Z"}},"star-diamond":{n:22,f:function(r){var rp=_$d3_127.round(1.4*r,2),rc=_$d3_127.round(1.9*r,2),aPart="A "+rc+","+rc+" 0 0 1 ";return"M-"+rp+",0"+aPart+"0,"+rp+aPart+rp+",0"+aPart+"0,-"+rp+aPart+"-"+rp+",0Z"}},"diamond-tall":{n:23,f:function(r){var x=_$d3_127.round(.7*r,2),y=_$d3_127.round(1.4*r,2);return"M0,"+y+"L"+x+",0L0,-"+y+"L-"+x+",0Z"}},"diamond-wide":{n:24,f:function(r){var x=_$d3_127.round(1.4*r,2),y=_$d3_127.round(.7*r,2);return"M0,"+y+"L"+x+",0L0,-"+y+"L-"+x+",0Z"}},hourglass:{n:25,f:function(r){var rs=_$d3_127.round(r,2);return"M"+rs+","+rs+"H-"+rs+"L"+rs+",-"+rs+"H-"+rs+"Z"},noDot:!0},bowtie:{n:26,f:function(r){var rs=_$d3_127.round(r,2);return"M"+rs+","+rs+"V-"+rs+"L-"+rs+","+rs+"V-"+rs+"Z"},noDot:!0},"circle-cross":{n:27,f:function(r){var rs=_$d3_127.round(r,2);return"M0,"+rs+"V-"+rs+"M"+rs+",0H-"+rs+"M"+rs+",0A"+rs+","+rs+" 0 1,1 0,-"+rs+"A"+rs+","+rs+" 0 0,1 "+rs+",0Z"},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(r){var rs=_$d3_127.round(r,2),rc=_$d3_127.round(r/Math.sqrt(2),2);return"M"+rc+","+rc+"L-"+rc+",-"+rc+"M"+rc+",-"+rc+"L-"+rc+","+rc+"M"+rs+",0A"+rs+","+rs+" 0 1,1 0,-"+rs+"A"+rs+","+rs+" 0 0,1 "+rs+",0Z"},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(r){var rs=_$d3_127.round(r,2);return"M0,"+rs+"V-"+rs+"M"+rs+",0H-"+rs+"M"+rs+","+rs+"H-"+rs+"V-"+rs+"H"+rs+"Z"},needLine:!0,noDot:!0},"square-x":{n:30,f:function(r){var rs=_$d3_127.round(r,2);return"M"+rs+","+rs+"L-"+rs+",-"+rs+"M"+rs+",-"+rs+"L-"+rs+","+rs+"M"+rs+","+rs+"H-"+rs+"V-"+rs+"H"+rs+"Z"},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(r){var rd=_$d3_127.round(1.3*r,2);return"M"+rd+",0L0,"+rd+"L-"+rd+",0L0,-"+rd+"ZM0,-"+rd+"V"+rd+"M-"+rd+",0H"+rd},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(r){var rd=_$d3_127.round(1.3*r,2),r2=_$d3_127.round(.65*r,2);return"M"+rd+",0L0,"+rd+"L-"+rd+",0L0,-"+rd+"ZM-"+r2+",-"+r2+"L"+r2+","+r2+"M-"+r2+","+r2+"L"+r2+",-"+r2},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(r){var rc=_$d3_127.round(1.4*r,2);return"M0,"+rc+"V-"+rc+"M"+rc+",0H-"+rc},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(r){var rx=_$d3_127.round(r,2);return"M"+rx+","+rx+"L-"+rx+",-"+rx+"M"+rx+",-"+rx+"L-"+rx+","+rx},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(r){var rc=_$d3_127.round(1.2*r,2),rs=_$d3_127.round(.85*r,2);return"M0,"+rc+"V-"+rc+"M"+rc+",0H-"+rc+"M"+rs+","+rs+"L-"+rs+",-"+rs+"M"+rs+",-"+rs+"L-"+rs+","+rs},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(r){var r1=_$d3_127.round(r/2,2),r2=_$d3_127.round(r,2);return"M"+r1+","+r2+"V-"+r2+"m-"+r2+",0V"+r2+"M"+r2+","+r1+"H-"+r2+"m0,-"+r2+"H"+r2},needLine:!0,noFill:!0},"y-up":{n:37,f:function(r){var x=_$d3_127.round(1.2*r,2),y0=_$d3_127.round(1.6*r,2),y1=_$d3_127.round(.8*r,2);return"M-"+x+","+y1+"L0,0M"+x+","+y1+"L0,0M0,-"+y0+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(r){var x=_$d3_127.round(1.2*r,2),y0=_$d3_127.round(1.6*r,2),y1=_$d3_127.round(.8*r,2);return"M-"+x+",-"+y1+"L0,0M"+x+",-"+y1+"L0,0M0,"+y0+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(r){var y=_$d3_127.round(1.2*r,2),x0=_$d3_127.round(1.6*r,2),x1=_$d3_127.round(.8*r,2);return"M"+x1+","+y+"L0,0M"+x1+",-"+y+"L0,0M-"+x0+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(r){var y=_$d3_127.round(1.2*r,2),x0=_$d3_127.round(1.6*r,2),x1=_$d3_127.round(.8*r,2);return"M-"+x1+","+y+"L0,0M-"+x1+",-"+y+"L0,0M"+x0+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(r){var rc=_$d3_127.round(1.4*r,2);return"M"+rc+",0H-"+rc},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(r){var rc=_$d3_127.round(1.4*r,2);return"M0,"+rc+"V-"+rc},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(r){var rx=_$d3_127.round(r,2);return"M"+rx+",-"+rx+"L-"+rx+","+rx},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(r){var rx=_$d3_127.round(r,2);return"M"+rx+","+rx+"L-"+rx+",-"+rx},needLine:!0,noDot:!0,noFill:!0}},_$alignment_511={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}},_$xmlns_namespaces_519={xmlns:"http://www.w3.org/2000/xmlns/",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"};_$xmlns_namespaces_519.svgAttrs={xmlns:_$xmlns_namespaces_519.svg,"xmlns:xlink":_$xmlns_namespaces_519.xlink};var _$string_mappings_518={entityToUnicode:{mu:"μ","#956":"μ",amp:"&","#28":"&",lt:"<","#60":"<",gt:">","#62":">",nbsp:" ","#160":" ",times:"×","#215":"×",plusmn:"±","#177":"±",deg:"°","#176":"°"}},_$svg_text_utils_562={},LINE_SPACING=_$alignment_511.LINE_SPACING;function getSize(_selection,_dimension){return _selection.node().getBoundingClientRect()[_dimension]}var FIND_TEX=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;_$svg_text_utils_562.convertToTspans=function(_context,gd,_callback){var str=_context.text(),tex=!_context.attr("data-notex")&&"undefined"!=typeof MathJax&&str.match(FIND_TEX),parent=_$d3_127.select(_context.node().parentNode);if(!parent.empty()){var svgClass=_context.attr("class")?_context.attr("class").split(" ")[0]:"text";return svgClass+="-math",parent.selectAll("svg."+svgClass).remove(),parent.selectAll("g."+svgClass+"-group").remove(),_context.style("display",null).attr({"data-unformatted":str,"data-math":"N"}),tex?(gd&&gd._promises||[]).push(new Promise(function(resolve){_context.style("display","none");var fontSize=parseInt(_context.node().style.fontSize,10),config={fontSize:fontSize};!function texToSVG(_texString,_config,_callback){var randomID="math-output-"+_$lib_539.randstr([],64),tmpDiv=_$d3_127.select("body").append("div").attr({id:randomID}).style({visibility:"hidden",position:"absolute"}).style({"font-size":_config.fontSize+"px"}).text(function cleanEscapesForTex(s){return s.replace(LT_MATCH,"\\lt ").replace(GT_MATCH,"\\gt ")}(_texString));MathJax.Hub.Queue(["Typeset",MathJax.Hub,tmpDiv.node()],function(){var glyphDefs=_$d3_127.select("body").select("#MathJax_SVG_glyphs");if(tmpDiv.select(".MathJax_SVG").empty()||!tmpDiv.select("svg").node())_$lib_539.log("There was an error in the tex syntax.",_texString),_callback();else{var svgBBox=tmpDiv.select("svg").node().getBoundingClientRect();_callback(tmpDiv.select(".MathJax_SVG"),glyphDefs,svgBBox)}tmpDiv.remove()})}(tex[2],config,function(_svgEl,_glyphDefs,_svgBBox){parent.selectAll("svg."+svgClass).remove(),parent.selectAll("g."+svgClass+"-group").remove();var newSvg=_svgEl&&_svgEl.select("svg");if(!newSvg||!newSvg.node())return showText(),void resolve();var mathjaxGroup=parent.append("g").classed(svgClass+"-group",!0).attr({"pointer-events":"none","data-unformatted":str,"data-math":"Y"});mathjaxGroup.node().appendChild(newSvg.node()),_glyphDefs&&_glyphDefs.node()&&newSvg.node().insertBefore(_glyphDefs.node().cloneNode(!0),newSvg.node().firstChild),newSvg.attr({class:svgClass,height:_svgBBox.height,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var fill=_context.node().style.fill||"black";newSvg.select("g").attr({fill:fill,stroke:fill});var newSvgW=getSize(newSvg,"width"),newSvgH=getSize(newSvg,"height"),newX=+_context.attr("x")-newSvgW*{start:0,middle:.5,end:1}[_context.attr("text-anchor")||"start"],dy=-(fontSize||getSize(_context,"height"))/4;"y"===svgClass[0]?(mathjaxGroup.attr({transform:"rotate("+[-90,+_context.attr("x"),+_context.attr("y")]+") translate("+[-newSvgW/2,dy-newSvgH/2]+")"}),newSvg.attr({x:+_context.attr("x"),y:+_context.attr("y")})):"l"===svgClass[0]?newSvg.attr({x:_context.attr("x"),y:dy-newSvgH/2}):"a"===svgClass[0]?newSvg.attr({x:0,y:dy}):newSvg.attr({x:newX,y:+_context.attr("y")+dy-newSvgH/2}),_callback&&_callback.call(_context,mathjaxGroup),resolve(mathjaxGroup)})})):showText(),_context}function showText(){parent.empty()||(svgClass=_context.attr("class")+"-math",parent.select("svg."+svgClass).remove()),_context.text("").style("white-space","pre"),function buildSVGText(containerNode,str){str=function convertEntities(_str){return function replaceFromMapObject(_str,list){if(!_str)return"";for(var i=0;i<list.length;i++){var item=list[i];_str=_str.replace(item.regExp,item.sub)}return _str}(_str,ENTITY_TO_UNICODE)}(str).replace(NEWLINES," ");var currentNode,hasLink=!1,nodeStack=[],currentLine=-1;function newLine(){currentLine++;var lineNode=document.createElementNS(_$xmlns_namespaces_519.svg,"tspan");_$d3_127.select(lineNode).attr({class:"line",dy:currentLine*LINE_SPACING+"em"}),containerNode.appendChild(lineNode),currentNode=lineNode;var oldNodeStack=nodeStack;if(nodeStack=[{node:lineNode}],oldNodeStack.length>1)for(var i=1;i<oldNodeStack.length;i++)enterNode(oldNodeStack[i])}function enterNode(nodeSpec){var nodeType,type=nodeSpec.type,nodeAttrs={};if("a"===type){nodeType="a";var target=nodeSpec.target,href=nodeSpec.href,popup=nodeSpec.popup;href&&(nodeAttrs={"xlink:xlink:show":"_blank"===target||"_"!==target.charAt(0)?"new":"replace",target:target,"xlink:xlink:href":href},popup&&(nodeAttrs.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+popup+'");return false;'))}else nodeType="tspan";nodeSpec.style&&(nodeAttrs.style=nodeSpec.style);var newNode=document.createElementNS(_$xmlns_namespaces_519.svg,nodeType);if("sup"===type||"sub"===type){addTextNode(currentNode,ZERO_WIDTH_SPACE),currentNode.appendChild(newNode);var resetter=document.createElementNS(_$xmlns_namespaces_519.svg,"tspan");addTextNode(resetter,ZERO_WIDTH_SPACE),_$d3_127.select(resetter).attr("dy",RESET_DY[type]),nodeAttrs.dy=SHIFT_DY[type],currentNode.appendChild(newNode),currentNode.appendChild(resetter)}else currentNode.appendChild(newNode);_$d3_127.select(newNode).attr(nodeAttrs),currentNode=nodeSpec.node=newNode,nodeStack.push(nodeSpec)}function addTextNode(node,text){node.appendChild(document.createTextNode(text))}function exitNode(type){if(1!==nodeStack.length){var innerNode=nodeStack.pop();type!==innerNode.type&&_$lib_539.log("Start tag <"+innerNode.type+"> doesnt match end tag <"+type+">. Pretending it did match.",str),currentNode=nodeStack[nodeStack.length-1].node}else _$lib_539.log("Ignoring unexpected end tag </"+type+">.",str)}BR_TAG.test(str)?newLine():(currentNode=containerNode,nodeStack=[{node:containerNode}]);for(var parts=str.split(SPLIT_TAGS),i=0;i<parts.length;i++){var parti=parts[i],match=parti.match(ONE_TAG),tagType=match&&match[2].toLowerCase(),tagStyle=TAG_STYLES[tagType];if("br"===tagType)newLine();else if(void 0===tagStyle)addTextNode(currentNode,parti);else if(match[1])exitNode(tagType);else{var extra=match[4],nodeSpec={type:tagType},css=getQuotedMatch(extra,STYLEMATCH);if(css?(css=css.replace(COLORMATCH,"$1 fill:"),tagStyle&&(css+=";"+tagStyle)):tagStyle&&(css=tagStyle),css&&(nodeSpec.style=css),"a"===tagType){hasLink=!0;var href=getQuotedMatch(extra,HREFMATCH);if(href){var dummyAnchor=document.createElement("a");dummyAnchor.href=href,-1!==PROTOCOLS.indexOf(dummyAnchor.protocol)&&(nodeSpec.href=encodeURI(href),nodeSpec.target=getQuotedMatch(extra,TARGETMATCH)||"_blank",nodeSpec.popup=getQuotedMatch(extra,POPUPMATCH))}}enterNode(nodeSpec)}}return hasLink}(_context.node(),str)&&_context.style("pointer-events","all"),_$svg_text_utils_562.positionText(_context),_callback&&_callback.call(_context)}};var LT_MATCH=/(<|&lt;|&#60;)/g,GT_MATCH=/(>|&gt;|&#62;)/g;var TAG_STYLES={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},SHIFT_DY={sub:"0.3em",sup:"-0.6em"},RESET_DY={sub:"-0.21em",sup:"0.42em"},ZERO_WIDTH_SPACE="​",PROTOCOLS=["http:","https:","mailto:","",void 0,":"],STRIP_TAGS=new RegExp("</?("+Object.keys(TAG_STYLES).join("|")+")( [^>]*)?/?>","g"),ENTITY_TO_UNICODE=Object.keys(_$string_mappings_518.entityToUnicode).map(function(k){return{regExp:new RegExp("&"+k+";","g"),sub:_$string_mappings_518.entityToUnicode[k]}}),NEWLINES=/(\r\n?|\n)/g,SPLIT_TAGS=/(<[^<>]*>)/,ONE_TAG=/<(\/?)([^ >]*)(\s+(.*))?>/i,BR_TAG=/<br(\s+.*)?>/i,STYLEMATCH=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,HREFMATCH=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,TARGETMATCH=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,POPUPMATCH=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function getQuotedMatch(_str,re){if(!_str)return null;var match=_str.match(re);return match&&(match[3]||match[4])}var COLORMATCH=/(^|;)\s*color:/;function alignHTMLWith(_base,container,options){var thisRect,getTop,getLeft,alignH=options.horizontalAlign,alignV=options.verticalAlign||"top",bRect=_base.node().getBoundingClientRect(),cRect=container.node().getBoundingClientRect();return getTop="bottom"===alignV?function(){return bRect.bottom-thisRect.height}:"middle"===alignV?function(){return bRect.top+(bRect.height-thisRect.height)/2}:function(){return bRect.top},getLeft="right"===alignH?function(){return bRect.right-thisRect.width}:"center"===alignH?function(){return bRect.left+(bRect.width-thisRect.width)/2}:function(){return bRect.left},function(){return thisRect=this.node().getBoundingClientRect(),this.style({top:getTop()-cRect.top+"px",left:getLeft()-cRect.left+"px","z-index":1e3}),this}}_$svg_text_utils_562.plainText=function(_str){return(_str||"").replace(STRIP_TAGS," ")},_$svg_text_utils_562.lineCount=function lineCount(s){return s.selectAll("tspan.line").size()||1},_$svg_text_utils_562.positionText=function positionText(s,x,y){return s.each(function(){var text=_$d3_127.select(this);function setOrGet(attr,val){return void 0===val?null===(val=text.attr(attr))&&(text.attr(attr,0),val=0):text.attr(attr,val),val}var thisX=setOrGet("x",x),thisY=setOrGet("y",y);"text"===this.nodeName&&text.selectAll("tspan.line").attr({x:thisX,y:thisY})})},_$svg_text_utils_562.makeEditable=function(context,options){var gd=options.gd,_delegate=options.delegate,dispatch=_$d3_127.dispatch("edit","input","cancel"),handlerElement=_delegate||context;if(context.style({"pointer-events":_delegate?"none":"all"}),1!==context.size())throw new Error("boo");function handleClick(){!function appendEditable(){var container=_$d3_127.select(gd).select(".svg-container"),div=container.append("div"),cStyle=context.node().style,fontSize=parseFloat(cStyle.fontSize||12);div.classed("plugin-editable editable",!0).style({position:"absolute","font-family":cStyle.fontFamily||"Arial","font-size":fontSize,color:options.fill||cStyle.fill||"black",opacity:1,"background-color":options.background||"transparent",outline:"#ffffff33 1px solid",margin:[-fontSize/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(options.text||context.attr("data-unformatted")).call(alignHTMLWith(context,container,options)).on("blur",function(){gd._editing=!1,context.text(this.textContent).style({opacity:1});var mathjaxClass,svgClass=_$d3_127.select(this).attr("class");(mathjaxClass=svgClass?"."+svgClass.split(" ")[0]+"-math-group":"[class*=-math-group]")&&_$d3_127.select(context.node().parentNode).select(mathjaxClass).style({opacity:0});var text=this.textContent;_$d3_127.select(this).transition().duration(0).remove(),_$d3_127.select(document).on("mouseup",null),dispatch.edit.call(context,text)}).on("focus",function(){var editDiv=this;gd._editing=!0,_$d3_127.select(document).on("mouseup",function(){if(_$d3_127.event.target===editDiv)return!1;document.activeElement===div.node()&&div.node().blur()})}).on("keyup",function(){27===_$d3_127.event.which?(gd._editing=!1,context.style({opacity:1}),_$d3_127.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),dispatch.cancel.call(context,this.textContent)):(dispatch.input.call(context,this.textContent),_$d3_127.select(this).call(alignHTMLWith(context,container,options)))}).on("keydown",function(){13===_$d3_127.event.which&&this.blur()}).call(selectElementContents)}(),context.style({opacity:0});var mathjaxClass,svgClass=handlerElement.attr("class");(mathjaxClass=svgClass?"."+svgClass.split(" ")[0]+"-math-group":"[class*=-math-group]")&&_$d3_127.select(context.node().parentNode).select(mathjaxClass).style({opacity:0})}function selectElementContents(_el){var el=_el.node(),range=document.createRange();range.selectNodeContents(el);var sel=window.getSelection();sel.removeAllRanges(),sel.addRange(range),el.focus()}return options.immediate?handleClick():handlerElement.on("click",handleClick),_$d3_127.rebind(context,dispatch,"on")};var _$makeBubbleSizeFn_879=function makeBubbleSizeFn(trace){var marker=trace.marker,sizeRef=marker.sizeref||1,sizeMin=marker.sizemin||0,baseFn="area"===marker.sizemode?function(v){return Math.sqrt(v/sizeRef)}:function(v){return v/sizeRef};return function(v){var baseSize=baseFn(v/2);return _$fastIsnumeric_139(baseSize)&&baseSize>0?Math.max(baseSize,sizeMin):0}},_$subtypes_884={hasLines:function(trace){return trace.visible&&trace.mode&&-1!==trace.mode.indexOf("lines")},hasMarkers:function(trace){return trace.visible&&trace.mode&&-1!==trace.mode.indexOf("markers")},hasText:function(trace){return trace.visible&&trace.mode&&-1!==trace.mode.indexOf("text")},isBubble:function(trace){return _$lib_539.isPlainObject(trace.marker)&&_$lib_539.isArrayOrTypedArray(trace.marker.size)}},_$drawing_436={},__LINE_SPACING_436=_$alignment_511.LINE_SPACING,__DESELECTDIM_436=_$interactions_516.DESELECTDIM,drawing=_$drawing_436={};drawing.font=function(s,family,size,color){_$lib_539.isPlainObject(family)&&(color=family.color,size=family.size,family=family.family),family&&s.style("font-family",family),size+1&&s.style("font-size",size+"px"),color&&s.call(_$color_411.fill,color)},drawing.setPosition=function(s,x,y){s.attr("x",x).attr("y",y)},drawing.setSize=function(s,w,h){s.attr("width",w).attr("height",h)},drawing.setRect=function(s,x,y,w,h){s.call(drawing.setPosition,x,y).call(drawing.setSize,w,h)},drawing.translatePoint=function(d,sel,xa,ya){var x=xa.c2p(d.x),y=ya.c2p(d.y);return!!(_$fastIsnumeric_139(x)&&_$fastIsnumeric_139(y)&&sel.node())&&("text"===sel.node().nodeName?sel.attr("x",x).attr("y",y):sel.attr("transform","translate("+x+","+y+")"),!0)},drawing.translatePoints=function(s,xa,ya){s.each(function(d){var sel=_$d3_127.select(this);drawing.translatePoint(d,sel,xa,ya)})},drawing.hideOutsideRangePoint=function(d,sel,xa,ya,xcalendar,ycalendar){sel.attr("display",xa.isPtWithinRange(d,xcalendar)&&ya.isPtWithinRange(d,ycalendar)?null:"none")},drawing.hideOutsideRangePoints=function(traceGroups,subplot,selector){if(subplot._hasClipOnAxisFalse){selector=selector||".point,.textpoint";var xa=subplot.xaxis,ya=subplot.yaxis;traceGroups.each(function(d){var trace=d[0].trace,xcalendar=trace.xcalendar,ycalendar=trace.ycalendar;traceGroups.selectAll(selector).each(function(d){drawing.hideOutsideRangePoint(d,_$d3_127.select(this),xa,ya,xcalendar,ycalendar)})})}},drawing.crispRound=function(gd,lineWidth,dflt){return lineWidth&&_$fastIsnumeric_139(lineWidth)?gd._context.staticPlot?lineWidth:lineWidth<1?1:Math.round(lineWidth):dflt||0},drawing.singleLineStyle=function(d,s,lw,lc,ld){s.style("fill","none");var line=(((d||[])[0]||{}).trace||{}).line||{},lw1=lw||line.width||0,dash=ld||line.dash||"";_$color_411.stroke(s,lc||line.color),drawing.dashLine(s,dash,lw1)},drawing.lineGroupStyle=function(s,lw,lc,ld){s.style("fill","none").each(function(d){var line=(((d||[])[0]||{}).trace||{}).line||{},lw1=lw||line.width||0,dash=ld||line.dash||"";_$d3_127.select(this).call(_$color_411.stroke,lc||line.color).call(drawing.dashLine,dash,lw1)})},drawing.dashLine=function(s,dash,lineWidth){lineWidth=+lineWidth||0,dash=drawing.dashStyle(dash,lineWidth),s.style({"stroke-dasharray":dash,"stroke-width":lineWidth+"px"})},drawing.dashStyle=function(dash,lineWidth){lineWidth=+lineWidth||1;var dlw=Math.max(lineWidth,3);return"solid"===dash?dash="":"dot"===dash?dash=dlw+"px,"+dlw+"px":"dash"===dash?dash=3*dlw+"px,"+3*dlw+"px":"longdash"===dash?dash=5*dlw+"px,"+5*dlw+"px":"dashdot"===dash?dash=3*dlw+"px,"+dlw+"px,"+dlw+"px,"+dlw+"px":"longdashdot"===dash&&(dash=5*dlw+"px,"+2*dlw+"px,"+dlw+"px,"+2*dlw+"px"),dash},drawing.singleFillStyle=function(sel){var fillcolor=(((_$d3_127.select(sel.node()).data()[0]||[])[0]||{}).trace||{}).fillcolor;fillcolor&&sel.call(_$color_411.fill,fillcolor)},drawing.fillGroupStyle=function(s){s.style("stroke-width",0).each(function(d){var shape=_$d3_127.select(this);try{shape.call(_$color_411.fill,d[0].trace.fillcolor)}catch(e){_$lib_539.error(e,s),shape.remove()}})},drawing.symbolNames=[],drawing.symbolFuncs=[],drawing.symbolNeedLines={},drawing.symbolNoDot={},drawing.symbolNoFill={},drawing.symbolList=[],Object.keys(_$symbol_defs_437).forEach(function(k){var symDef=_$symbol_defs_437[k];drawing.symbolList=drawing.symbolList.concat([symDef.n,k,symDef.n+100,k+"-open"]),drawing.symbolNames[symDef.n]=k,drawing.symbolFuncs[symDef.n]=symDef.f,symDef.needLine&&(drawing.symbolNeedLines[symDef.n]=!0),symDef.noDot?drawing.symbolNoDot[symDef.n]=!0:drawing.symbolList=drawing.symbolList.concat([symDef.n+200,k+"-dot",symDef.n+300,k+"-open-dot"]),symDef.noFill&&(drawing.symbolNoFill[symDef.n]=!0)});var MAXSYMBOL=drawing.symbolNames.length,DOTPATH="M0,0.5L0.5,0L0,-0.5L-0.5,0Z";function makePointPath(symbolNumber,r){var base=symbolNumber%100;return drawing.symbolFuncs[base](r)+(symbolNumber>=200?DOTPATH:"")}drawing.symbolNumber=function(v){if("string"==typeof v){var vbase=0;v.indexOf("-open")>0&&(vbase=100,v=v.replace("-open","")),v.indexOf("-dot")>0&&(vbase+=200,v=v.replace("-dot","")),(v=drawing.symbolNames.indexOf(v))>=0&&(v+=vbase)}return v%100>=MAXSYMBOL||v>=400?0:Math.floor(Math.max(v,0))};var HORZGRADIENT={x1:1,x2:0,y1:0,y2:0},VERTGRADIENT={x1:0,x2:0,y1:1,y2:0};drawing.gradient=function(sel,gd,gradientID,type,color1,color2){var gradient=gd._fullLayout._defs.select(".gradients").selectAll("#"+gradientID).data([type+color1+color2],_$lib_539.identity);gradient.exit().remove(),gradient.enter().append("radial"===type?"radialGradient":"linearGradient").each(function(){var el=_$d3_127.select(this);"horizontal"===type?el.attr(HORZGRADIENT):"vertical"===type&&el.attr(VERTGRADIENT),el.attr("id",gradientID);var tc1=_$tinycolor_352(color1),tc2=_$tinycolor_352(color2);el.append("stop").attr({offset:"0%","stop-color":_$color_411.tinyRGB(tc2),"stop-opacity":tc2.getAlpha()}),el.append("stop").attr({offset:"100%","stop-color":_$color_411.tinyRGB(tc1),"stop-opacity":tc1.getAlpha()})}),sel.style({fill:"url(#"+gradientID+")","fill-opacity":null})},drawing.initGradients=function(gd){var gradientsGroup=gd._fullLayout._defs.selectAll(".gradients").data([0]);gradientsGroup.enter().append("g").classed("gradients",!0),gradientsGroup.selectAll("linearGradient,radialGradient").remove()},drawing.singlePointStyle=function(d,sel,trace,markerScale,lineScale,gd){var marker=trace.marker;!function singlePointStyle(d,sel,trace,markerScale,lineScale,marker,markerLine,gd){if(_$registry_668.traceIs(trace,"symbols")){var sizeFn=_$makeBubbleSizeFn_879(trace);sel.attr("d",function(d){var r;r="various"===d.ms||"various"===marker.size?3:_$subtypes_884.isBubble(trace)?sizeFn(d.ms):(marker.size||6)/2,d.mrc=r;var x=drawing.symbolNumber(d.mx||marker.symbol)||0;return d.om=x%200>=100,makePointPath(x,r)})}sel.style("opacity",function(d){return(d.mo+1||marker.opacity+1)-1});var fillColor,lineColor,lineWidth,perPointGradient=!1;if(d.so?(lineWidth=markerLine.outlierwidth,lineColor=markerLine.outliercolor,fillColor=marker.outliercolor):(lineWidth=(d.mlw+1||markerLine.width+1||(d.trace?d.trace.marker.line.width:0)+1)-1,lineColor="mlc"in d?d.mlcc=lineScale(d.mlc):_$lib_539.isArrayOrTypedArray(markerLine.color)?_$color_411.defaultLine:markerLine.color,_$lib_539.isArrayOrTypedArray(marker.color)&&(fillColor=_$color_411.defaultLine,perPointGradient=!0),fillColor="mc"in d?d.mcc=markerScale(d.mc):marker.color||"rgba(0,0,0,0)"),d.om)sel.call(_$color_411.stroke,fillColor).style({"stroke-width":(lineWidth||1)+"px",fill:"none"});else{sel.style("stroke-width",lineWidth+"px");var markerGradient=marker.gradient,gradientType=d.mgt;if(gradientType?perPointGradient=!0:gradientType=markerGradient&&markerGradient.type,gradientType&&"none"!==gradientType){var gradientColor=d.mgc;gradientColor?perPointGradient=!0:gradientColor=markerGradient.color;var gradientID="g"+gd._fullLayout._uid+"-"+trace.uid;perPointGradient&&(gradientID+="-"+d.i),sel.call(drawing.gradient,gd,gradientID,gradientType,fillColor,gradientColor)}else sel.call(_$color_411.fill,fillColor);lineWidth&&sel.call(_$color_411.stroke,lineColor)}}(d,sel,trace,markerScale,lineScale,marker,marker.line,gd)},drawing.pointStyle=function(s,trace,gd){if(s.size()){var marker=trace.marker,markerScale=drawing.tryColorscale(marker,""),lineScale=drawing.tryColorscale(marker,"line");s.each(function(d){drawing.singlePointStyle(d,_$d3_127.select(this),trace,markerScale,lineScale,gd)})}},drawing.makeSelectedPointStyleFns=function(trace){var out={},selectedAttrs=trace.selected||{},unselectedAttrs=trace.unselected||{},marker=trace.marker||{},selectedMarker=selectedAttrs.marker||{},unselectedMarker=unselectedAttrs.marker||{},mo=marker.opacity,smo=selectedMarker.opacity,usmo=unselectedMarker.opacity,smoIsDefined=void 0!==smo,usmoIsDefined=void 0!==usmo;out.opacityFn=function(d){var dmo=d.mo,dmoIsDefined=void 0!==dmo;if(dmoIsDefined||smoIsDefined||usmoIsDefined){if(!d.selected)return usmoIsDefined?usmo:__DESELECTDIM_436*(dmoIsDefined?dmo:mo);if(smoIsDefined)return smo}};var smc=selectedMarker.color,usmc=unselectedMarker.color;(smc||usmc)&&(out.colorFn=function(d){if(d.selected){if(smc)return smc}else if(usmc)return usmc});var sms=selectedMarker.size,usms=unselectedMarker.size,smsIsDefined=void 0!==sms,usmsIsDefined=void 0!==usms;return(smsIsDefined||usmsIsDefined)&&(out.sizeFn=function(d){var mrc=d.mrc;return d.selected?smsIsDefined?sms/2:mrc:usmsIsDefined?usms/2:mrc}),out},drawing.selectedPointStyle=function(s,trace){if(s.size()&&trace.selectedpoints){var fns=drawing.makeSelectedPointStyleFns(trace),marker=trace.marker||{};s.each(function(d){var pt=_$d3_127.select(this),mo2=fns.opacityFn(d);void 0!==mo2&&pt.style("opacity",mo2)}),fns.colorFn&&s.each(function(d){var pt=_$d3_127.select(this),mc2=fns.colorFn(d);mc2&&_$color_411.fill(pt,mc2)}),_$registry_668.traceIs(trace,"symbols")&&fns.sizeFn&&s.each(function(d){var pt=_$d3_127.select(this),mx=d.mx||marker.symbol||0,mrc2=fns.sizeFn(d);pt.attr("d",makePointPath(drawing.symbolNumber(mx),mrc2)),d.mrc2=mrc2})}},drawing.tryColorscale=function(marker,prefix){var cont=prefix?_$lib_539.nestedProperty(marker,prefix).get():marker,scl=cont.colorscale,colorArray=cont.color;return scl&&_$lib_539.isArrayOrTypedArray(colorArray)?_$colorscale_426.makeColorScaleFunc(_$colorscale_426.extractScale(scl,cont.cmin,cont.cmax)):_$lib_539.identity};var TEXTOFFSETSIGN={start:1,end:-1,middle:0,bottom:1,top:-1};function textPointPosition(s,textPosition,fontSize,markerRadius){var group=_$d3_127.select(s.node().parentNode),v=-1!==textPosition.indexOf("top")?"top":-1!==textPosition.indexOf("bottom")?"bottom":"middle",h=-1!==textPosition.indexOf("left")?"end":-1!==textPosition.indexOf("right")?"start":"middle",r=markerRadius?markerRadius/.8+1:0,numLines=(_$svg_text_utils_562.lineCount(s)-1)*__LINE_SPACING_436+1,dx=TEXTOFFSETSIGN[h]*r,dy=.75*fontSize+TEXTOFFSETSIGN[v]*r+(TEXTOFFSETSIGN[v]-1)*numLines*fontSize/2;s.attr("text-anchor",h),group.attr("transform","translate("+dx+","+dy+")")}function extracTextFontSize(d,trace){var fontSize=d.ts||trace.textfont.size;return _$fastIsnumeric_139(fontSize)&&fontSize>0?fontSize:0}drawing.textPointStyle=function(s,trace,gd){s.each(function(d){var p=_$d3_127.select(this),text=_$lib_539.extractOption(d,trace,"tx","text");if(text){var pos=d.tp||trace.textposition,fontSize=extracTextFontSize(d,trace);p.call(drawing.font,d.tf||trace.textfont.family,fontSize,d.tc||trace.textfont.color).text(text).call(_$svg_text_utils_562.convertToTspans,gd).call(textPointPosition,pos,fontSize,d.mrc)}else p.remove()})},drawing.selectedTextStyle=function(s,trace){if(s.size()&&trace.selectedpoints){var selectedAttrs=trace.selected||{},unselectedAttrs=trace.unselected||{};s.each(function(d){var tc2,tx=_$d3_127.select(this),tc=d.tc||trace.textfont.color,tp=d.tp||trace.textposition,fontSize=extracTextFontSize(d,trace),stc=(selectedAttrs.textfont||{}).color,utc=(unselectedAttrs.textfont||{}).color;d.selected?stc&&(tc2=stc):utc?tc2=utc:stc||(tc2=_$color_411.addOpacity(tc,__DESELECTDIM_436)),tc2&&_$color_411.fill(tx,tc2),textPointPosition(tx,tp,fontSize,d.mrc2||d.mrc)})}};var CatmullRomExp=.5;function makeTangent(prevpt,thispt,nextpt,smoothness){var d1x=prevpt[0]-thispt[0],d1y=prevpt[1]-thispt[1],d2x=nextpt[0]-thispt[0],d2y=nextpt[1]-thispt[1],d1a=Math.pow(d1x*d1x+d1y*d1y,CatmullRomExp/2),d2a=Math.pow(d2x*d2x+d2y*d2y,CatmullRomExp/2),numx=(d2a*d2a*d1x-d1a*d1a*d2x)*smoothness,numy=(d2a*d2a*d1y-d1a*d1a*d2y)*smoothness,denom1=3*d2a*(d1a+d2a),denom2=3*d1a*(d1a+d2a);return[[_$d3_127.round(thispt[0]+(denom1&&numx/denom1),2),_$d3_127.round(thispt[1]+(denom1&&numy/denom1),2)],[_$d3_127.round(thispt[0]-(denom2&&numx/denom2),2),_$d3_127.round(thispt[1]-(denom2&&numy/denom2),2)]]}drawing.smoothopen=function(pts,smoothness){if(pts.length<3)return"M"+pts.join("L");var i,path="M"+pts[0],tangents=[];for(i=1;i<pts.length-1;i++)tangents.push(makeTangent(pts[i-1],pts[i],pts[i+1],smoothness));for(path+="Q"+tangents[0][0]+" "+pts[1],i=2;i<pts.length-1;i++)path+="C"+tangents[i-2][1]+" "+tangents[i-1][0]+" "+pts[i];return path+="Q"+tangents[pts.length-3][1]+" "+pts[pts.length-1]},drawing.smoothclosed=function(pts,smoothness){if(pts.length<3)return"M"+pts.join("L")+"Z";var i,path="M"+pts[0],pLast=pts.length-1,tangents=[makeTangent(pts[pLast],pts[0],pts[1],smoothness)];for(i=1;i<pLast;i++)tangents.push(makeTangent(pts[i-1],pts[i],pts[i+1],smoothness));for(tangents.push(makeTangent(pts[pLast-1],pts[pLast],pts[0],smoothness)),i=1;i<=pLast;i++)path+="C"+tangents[i-1][1]+" "+tangents[i][0]+" "+pts[i];return path+="C"+tangents[pLast][1]+" "+tangents[0][0]+" "+pts[0]+"Z"};var STEPPATH={hv:function(p0,p1){return"H"+_$d3_127.round(p1[0],2)+"V"+_$d3_127.round(p1[1],2)},vh:function(p0,p1){return"V"+_$d3_127.round(p1[1],2)+"H"+_$d3_127.round(p1[0],2)},hvh:function(p0,p1){return"H"+_$d3_127.round((p0[0]+p1[0])/2,2)+"V"+_$d3_127.round(p1[1],2)+"H"+_$d3_127.round(p1[0],2)},vhv:function(p0,p1){return"V"+_$d3_127.round((p0[1]+p1[1])/2,2)+"H"+_$d3_127.round(p1[0],2)+"V"+_$d3_127.round(p1[1],2)}},STEPLINEAR=function(p0,p1){return"L"+_$d3_127.round(p1[0],2)+","+_$d3_127.round(p1[1],2)};drawing.steps=function(shape){var onestep=STEPPATH[shape]||STEPLINEAR;return function(pts){for(var path="M"+_$d3_127.round(pts[0][0],2)+","+_$d3_127.round(pts[0][1],2),i=1;i<pts.length;i++)path+=onestep(pts[i-1],pts[i]);return path}},drawing.makeTester=function(){var tester=_$d3_127.select("body").selectAll("#js-plotly-tester").data([0]);tester.enter().append("svg").attr("id","js-plotly-tester").attr(_$xmlns_namespaces_519.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"});var testref=tester.selectAll(".js-reference-point").data([0]);testref.enter().append("path").classed("js-reference-point",!0).attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"}),drawing.tester=tester,drawing.testref=testref},drawing.savedBBoxes={};var savedBBoxesCount=0;function nodeHash(node){var inputText=node.getAttribute("data-unformatted");if(null!==inputText)return inputText+node.getAttribute("data-math")+node.getAttribute("text-anchor")+node.getAttribute("style")}drawing.bBox=function(node,inTester,hash){var out,testNode,tester;if(hash||(hash=nodeHash(node)),hash){if(out=drawing.savedBBoxes[hash])return _$lib_539.extendFlat({},out)}else if(1===node.childNodes.length){var innerNode=node.childNodes[0];if(hash=nodeHash(innerNode)){var x=+innerNode.getAttribute("x")||0,y=+innerNode.getAttribute("y")||0,transform=innerNode.getAttribute("transform");if(!transform){var innerBB=drawing.bBox(innerNode,!1,hash);return x&&(innerBB.left+=x,innerBB.right+=x),y&&(innerBB.top+=y,innerBB.bottom+=y),innerBB}if(hash+="~"+x+"~"+y+"~"+transform,out=drawing.savedBBoxes[hash])return _$lib_539.extendFlat({},out)}}inTester?testNode=node:(tester=drawing.tester.node(),testNode=node.cloneNode(!0),tester.appendChild(testNode)),_$d3_127.select(testNode).attr("transform",null).call(_$svg_text_utils_562.positionText,0,0);var testRect=testNode.getBoundingClientRect(),refRect=drawing.testref.node().getBoundingClientRect();inTester||tester.removeChild(testNode);var bb={height:testRect.height,width:testRect.width,left:testRect.left-refRect.left,top:testRect.top-refRect.top,right:testRect.right-refRect.left,bottom:testRect.bottom-refRect.top};return savedBBoxesCount>=1e4&&(drawing.savedBBoxes={},savedBBoxesCount=0),hash&&(drawing.savedBBoxes[hash]=bb),savedBBoxesCount++,_$lib_539.extendFlat({},bb)},drawing.setClipUrl=function(s,localId){if(localId){var url="#"+localId,base=_$d3_127.select("base");base.size()&&base.attr("href")&&(url=window.location.href.split("#")[0]+url),s.attr("clip-path","url("+url+")")}else s.attr("clip-path",null)},drawing.getTranslate=function(element){var translate=(element[element.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,function(match,p1,p2){return[p1,p2].join(" ")}).split(" ");return{x:+translate[0]||0,y:+translate[1]||0}},drawing.setTranslate=function(element,x,y){var getter=element.attr?"attr":"getAttribute",setter=element.attr?"attr":"setAttribute",transform=element[getter]("transform")||"";return x=x||0,y=y||0,transform=transform.replace(/(\btranslate\(.*?\);?)/,"").trim(),transform=(transform+=" translate("+x+", "+y+")").trim(),element[setter]("transform",transform),transform},drawing.getScale=function(element){var translate=(element[element.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,function(match,p1,p2){return[p1,p2].join(" ")}).split(" ");return{x:+translate[0]||1,y:+translate[1]||1}},drawing.setScale=function(element,x,y){var getter=element.attr?"attr":"getAttribute",setter=element.attr?"attr":"setAttribute",transform=element[getter]("transform")||"";return x=x||1,y=y||1,transform=transform.replace(/(\bscale\(.*?\);?)/,"").trim(),transform=(transform+=" scale("+x+", "+y+")").trim(),element[setter]("transform",transform),transform},drawing.setPointGroupScale=function(selection,x,y){var t,scale,re;return x=x||1,y=y||1,scale=1===x&&1===y?"":" scale("+x+","+y+")",re=/\s*sc.*/,selection.each(function(){t=(this.getAttribute("transform")||"").replace(re,""),t=(t+=scale).trim(),this.setAttribute("transform",t)}),scale};var TEXT_POINT_LAST_TRANSLATION_RE=/translate\([^)]*\)\s*$/;drawing.setTextPointsScale=function(selection,xScale,yScale){selection.each(function(){var transforms,el=_$d3_127.select(this),text=el.select("text");if(text.node()){var x=parseFloat(text.attr("x")||0),y=parseFloat(text.attr("y")||0),existingTransform=(el.attr("transform")||"").match(TEXT_POINT_LAST_TRANSLATION_RE);transforms=1===xScale&&1===yScale?[]:["translate("+x+","+y+")","scale("+xScale+","+yScale+")","translate("+-x+","+-y+")"],existingTransform&&transforms.push(existingTransform),el.attr("transform",transforms.join(" "))}})};var _$constants_868={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20},__dash_862=_$attributes_435.dash,__extendFlat_862=_$extend_528.extendFlat,_$attributes_862={x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:__extendFlat_862({},__dash_862,{editType:"style"}),simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],dflt:"none",editType:"calc"},fillcolor:{valType:"color",editType:"style"},marker:__extendFlat_862({symbol:{valType:"enumerated",values:_$drawing_436.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style"},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calcIfAutorange"},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},showscale:{valType:"boolean",dflt:!1,editType:"calc"},colorbar:_$attributes_412,line:__extendFlat_862({width:{valType:"number",min:0,arrayOk:!0,editType:"style"},editType:"calc"},_$makeColorScaleAttributes_419()),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},_$makeColorScaleAttributes_419()),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:_$font_attributes_611({editType:"calc",colorEditType:"style",arrayOk:!0}),r:{valType:"data_array",editType:"calc"},t:{valType:"data_array",editType:"calc"}},scatterMarkerAttrs=_$attributes_862.marker,_$area_attributes_653={r:_$attributes_862.r,t:_$attributes_862.t,marker:{color:scatterMarkerAttrs.color,size:scatterMarkerAttrs.size,symbol:scatterMarkerAttrs.symbol,opacity:scatterMarkerAttrs.opacity,editType:"calc"}},__extendFlat_654=_$extend_528.extendFlat,__overrideAll_654=_$edit_types_569.overrideAll,domainAttr=__extendFlat_654({},_$layout_attributes_596.domain,{});function mergeAttrs(axisName,nonCommonAttrs){return __extendFlat_654({},nonCommonAttrs,{showline:{valType:"boolean"},showticklabels:{valType:"boolean"},tickorientation:{valType:"enumerated",values:["horizontal","vertical"]},ticklen:{valType:"number",min:0},tickcolor:{valType:"color"},ticksuffix:{valType:"string"},endpadding:{valType:"number"},visible:{valType:"boolean"}})}var _$axis_attributes_654=__overrideAll_654({radialaxis:mergeAttrs(0,{range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},domain:domainAttr,orientation:{valType:"number"}}),angularaxis:mergeAttrs(0,{range:{valType:"info_array",items:[{valType:"number",dflt:0},{valType:"number",dflt:360}]},domain:domainAttr}),layout:{direction:{valType:"enumerated",values:["clockwise","counterclockwise"]},orientation:{valType:"angle"}}},"plot","nested"),_$plot_schema_575={},__extendFlat_575=_$lib_539.extendFlat,__extendDeepAll_575=_$lib_539.extendDeepAll,IS_SUBPLOT_OBJ="_isSubplotObj",IS_LINKED_TO_ARRAY="_isLinkedToArray",UNDERSCORE_ATTRS=[IS_SUBPLOT_OBJ,IS_LINKED_TO_ARRAY,"_arrayAttrRegexps","_deprecated"];function recurseIntoValObject(valObject,parts,i){if(!valObject)return!1;if(valObject._isLinkedToArray)if(isIndex(parts[i]))i++;else if(i<parts.length)return!1;for(;i<parts.length;i++){var newValObject=valObject[parts[i]];if(!_$lib_539.isPlainObject(newValObject))break;if(valObject=newValObject,i===parts.length-1)break;if(valObject._isLinkedToArray){if(!isIndex(parts[++i]))return!1}else if("info_array"===valObject.valType){var index=parts[++i];if(!isIndex(index))return!1;var items=valObject.items;if(Array.isArray(items)){if(index>=items.length)return!1;if(2===valObject.dimensions){if(i++,parts.length===i)return valObject;var index2=parts[i];if(!isIndex(index2))return!1;valObject=items[index][index2]}else valObject=items[index]}else valObject=items}}return valObject}function isIndex(val){return val===Math.round(val)&&val>=0}function formatAttributes(attrs){return function mergeValTypeAndRole(attrs){_$plot_schema_575.crawl(attrs,function callback(attr,attrName,attrs){_$plot_schema_575.isValObject(attr)?"data_array"===attr.valType?(attr.role="data",attrs[attrName+"src"]={valType:"string",editType:"none"}):!0===attr.arrayOk&&(attrs[attrName+"src"]={valType:"string",editType:"none"}):_$lib_539.isPlainObject(attr)&&(attr.role="object")})}(attrs),function formatArrayContainers(attrs){_$plot_schema_575.crawl(attrs,function callback(attr,attrName,attrs){if(!attr)return;var itemName=attr[IS_LINKED_TO_ARRAY];if(!itemName)return;delete attr[IS_LINKED_TO_ARRAY],attrs[attrName]={items:{}},attrs[attrName].items[itemName]=attr,attrs[attrName].role="object"})}(attrs),attrs}function handleBasePlotModule(layoutAttributes,_module,astr){var np=_$lib_539.nestedProperty(layoutAttributes,astr),attrs=__extendDeepAll_575({},_module.layoutAttributes);attrs[IS_SUBPLOT_OBJ]=!0,np.set(attrs)}function insertAttrs(baseAttrs,newAttrs,astr){var np=_$lib_539.nestedProperty(baseAttrs,astr);np.set(__extendDeepAll_575(np.get()||{},newAttrs))}_$plot_schema_575.IS_SUBPLOT_OBJ=IS_SUBPLOT_OBJ,_$plot_schema_575.IS_LINKED_TO_ARRAY=IS_LINKED_TO_ARRAY,_$plot_schema_575.DEPRECATED="_deprecated",_$plot_schema_575.UNDERSCORE_ATTRS=UNDERSCORE_ATTRS,_$plot_schema_575.get=function(){var traces={};_$registry_668.allTypes.concat("area").forEach(function(type){traces[type]=function getTraceAttributes(type){var _module,basePlotModule;"area"===type?(_module={attributes:_$area_attributes_653},basePlotModule={}):(_module=_$registry_668.modules[type]._module,basePlotModule=_module.basePlotModule);var attributes={type:null};__extendDeepAll_575(attributes,_$attributes_581),__extendDeepAll_575(attributes,_module.attributes),basePlotModule.attributes&&__extendDeepAll_575(attributes,basePlotModule.attributes);attributes.type=type;var out={meta:_module.meta||{},attributes:formatAttributes(attributes)};if(_module.layoutAttributes){var layoutAttributes={};__extendDeepAll_575(layoutAttributes,_module.layoutAttributes),out.layoutAttributes=formatAttributes(layoutAttributes)}return out}(type)});var transforms={};return Object.keys(_$registry_668.transformsRegistry).forEach(function(type){transforms[type]=function getTransformAttributes(type){var _module=_$registry_668.transformsRegistry[type],attributes=__extendDeepAll_575({},_module.attributes);return Object.keys(_$registry_668.componentsRegistry).forEach(function(k){var _module=_$registry_668.componentsRegistry[k];_module.schema&&_module.schema.transforms&&_module.schema.transforms[type]&&Object.keys(_module.schema.transforms[type]).forEach(function(v){insertAttrs(attributes,_module.schema.transforms[type][v],v)})}),{attributes:formatAttributes(attributes)}}(type)}),{defs:{valObjects:_$lib_539.valObjectMeta,metaKeys:UNDERSCORE_ATTRS.concat(["description","role","editType","impliedEdits"]),editType:{traces:_$edit_types_569.traces,layout:_$edit_types_569.layout},impliedEdits:{}},traces:traces,layout:function getLayoutAttributes(){var key,_module,layoutAttributes={};for(key in __extendDeepAll_575(layoutAttributes,_$layout_attributes_638),_$registry_668.subplotsRegistry)if((_module=_$registry_668.subplotsRegistry[key]).layoutAttributes)if("cartesian"===_module.name)handleBasePlotModule(layoutAttributes,_module,"xaxis"),handleBasePlotModule(layoutAttributes,_module,"yaxis");else{var astr="subplot"===_module.attr?_module.name:_module.attr;handleBasePlotModule(layoutAttributes,_module,astr)}for(key in layoutAttributes=function assignPolarLayoutAttrs(layoutAttributes){return __extendFlat_575(layoutAttributes,{radialaxis:_$axis_attributes_654.radialaxis,angularaxis:_$axis_attributes_654.angularaxis}),__extendFlat_575(layoutAttributes,_$axis_attributes_654.layout),layoutAttributes}(layoutAttributes),_$registry_668.componentsRegistry){var schema=(_module=_$registry_668.componentsRegistry[key]).schema;if(schema&&(schema.subplots||schema.layout)){var subplots=schema.subplots;if(subplots&&subplots.xaxis&&!subplots.yaxis)for(var xkey in subplots.xaxis)delete layoutAttributes.yaxis[xkey]}else _module.layoutAttributes&&insertAttrs(layoutAttributes,_module.layoutAttributes,_module.name)}return{layoutAttributes:formatAttributes(layoutAttributes)}}(),transforms:transforms,frames:function getFramesAttributes(){var attrs={frames:_$lib_539.extendDeepAll({},_$frame_attributes_612)};return formatAttributes(attrs),attrs.frames}(),animation:formatAttributes(_$animation_attributes_579)}},_$plot_schema_575.crawl=function(attrs,callback,specifiedLevel,attrString){var level=specifiedLevel||0;attrString=attrString||"",Object.keys(attrs).forEach(function(attrName){var attr=attrs[attrName];if(-1===UNDERSCORE_ATTRS.indexOf(attrName)){var fullAttrString=(attrString?attrString+".":"")+attrName;callback(attr,attrName,attrs,level,fullAttrString),_$plot_schema_575.isValObject(attr)||_$lib_539.isPlainObject(attr)&&"impliedEdits"!==attrName&&_$plot_schema_575.crawl(attr,callback,level+1,fullAttrString)}})},_$plot_schema_575.isValObject=function(obj){return obj&&void 0!==obj.valType},_$plot_schema_575.findArrayAttributes=function(trace){var arrayAttributes=[],stack=[];function callback(attr,attrName,attrs,level){if(stack=stack.slice(0,level).concat([attrName]),attr&&("data_array"===attr.valType||!0===attr.arrayOk)&&!("colorbar"===stack[level-1]&&("ticktext"===attrName||"tickvals"===attrName))){var astr=function toAttrString(stack){return stack.join(".")}(stack),val=_$lib_539.nestedProperty(trace,astr).get();_$lib_539.isArrayOrTypedArray(val)&&arrayAttributes.push(astr)}}if(_$plot_schema_575.crawl(_$attributes_581,callback),trace._module&&trace._module.attributes&&_$plot_schema_575.crawl(trace._module.attributes,callback),trace.transforms)for(var transforms=trace.transforms,i=0;i<transforms.length;i++){var module=transforms[i]._module;module&&(stack=["transforms["+i+"]"],_$plot_schema_575.crawl(module.attributes,callback,1))}return trace._fullInput&&trace._fullInput._module&&trace._fullInput._module.attributes&&(_$plot_schema_575.crawl(trace._fullInput._module.attributes,callback),arrayAttributes=_$lib_539.filterUnique(arrayAttributes)),arrayAttributes},_$plot_schema_575.getTraceValObject=function(trace,parts){var moduleAttrs,valObject,head=parts[0],i=1;if("transforms"===head){if(!Array.isArray(trace.transforms))return!1;var tNum=parts[1];if(!isIndex(tNum)||tNum>=trace.transforms.length)return!1;valObject=(moduleAttrs=(_$registry_668.transformsRegistry[trace.transforms[tNum].type]||{}).attributes)&&moduleAttrs[parts[2]],i=3}else if("area"===trace.type)valObject=_$area_attributes_653[head];else{var _module=trace._module;if(_module||(_module=(_$registry_668.modules[trace.type||_$attributes_581.type.dflt]||{})._module),!_module)return!1;if(!(valObject=(moduleAttrs=_module.attributes)&&moduleAttrs[head])){var subplotModule=_module.basePlotModule;subplotModule&&subplotModule.attributes&&(valObject=subplotModule.attributes[head])}valObject||(valObject=_$attributes_581[head])}return recurseIntoValObject(valObject,parts,i)},_$plot_schema_575.getLayoutValObject=function(fullLayout,parts){return recurseIntoValObject(function layoutHeadAttr(fullLayout,head){var i,key,_module,attributes,basePlotModules=fullLayout._basePlotModules;if(basePlotModules){var out;for(i=0;i<basePlotModules.length;i++){if((_module=basePlotModules[i]).attrRegex&&_module.attrRegex.test(head)){if(_module.layoutAttrOverrides)return _module.layoutAttrOverrides;!out&&_module.layoutAttributes&&(out=_module.layoutAttributes)}var baseOverrides=_module.baseLayoutAttrOverrides;if(baseOverrides&&head in baseOverrides)return baseOverrides[head]}if(out)return out}var modules=fullLayout._modules;if(modules)for(i=0;i<modules.length;i++)if((attributes=modules[i].layoutAttributes)&&head in attributes)return attributes[head];for(key in _$registry_668.componentsRegistry)if(!(_module=_$registry_668.componentsRegistry[key]).schema&&head===_module.name)return _module.layoutAttributes;if(head in _$layout_attributes_638)return _$layout_attributes_638[head];if("radialaxis"===head||"angularaxis"===head)return _$axis_attributes_654[head];return _$axis_attributes_654.layout[head]||!1}(fullLayout,parts[0]),parts,1)};var _$axis_ids_587={id2name:function id2name(id){if("string"==typeof id&&id.match(_$constants_589.AX_ID_PATTERN)){var axNum=id.substr(1);return"1"===axNum&&(axNum=""),id.charAt(0)+"axis"+axNum}},name2id:function name2id(name){if(name.match(_$constants_589.AX_NAME_PATTERN)){var axNum=name.substr(5);return"1"===axNum&&(axNum=""),name.charAt(0)+axNum}},cleanId:function cleanId(id,axLetter){if(id.match(_$constants_589.AX_ID_PATTERN)&&(!axLetter||id.charAt(0)===axLetter)){var axNum=id.substr(1).replace(/^0+/,"");return"1"===axNum&&(axNum=""),id.charAt(0)+axNum}},list:function(gd,axLetter,only2d){var fullLayout=gd._fullLayout;if(!fullLayout)return[];var i,idList=_$axis_ids_587.listIds(gd,axLetter),out=new Array(idList.length);for(i=0;i<idList.length;i++){var idi=idList[i];out[i]=fullLayout[idi.charAt(0)+"axis"+idi.substr(1)]}if(!only2d){var sceneIds3D=fullLayout._subplots.gl3d||[];for(i=0;i<sceneIds3D.length;i++){var scene=fullLayout[sceneIds3D[i]];axLetter?out.push(scene[axLetter+"axis"]):out.push(scene.xaxis,scene.yaxis,scene.zaxis)}}return out},listIds:function(gd,axLetter){var fullLayout=gd._fullLayout;if(!fullLayout)return[];var subplotLists=fullLayout._subplots;return axLetter?subplotLists[axLetter+"axis"]:subplotLists.xaxis.concat(subplotLists.yaxis)},getFromId:function(gd,id,type){var fullLayout=gd._fullLayout;return"x"===type?id=id.replace(/y[0-9]*/,""):"y"===type&&(id=id.replace(/x[0-9]*/,"")),fullLayout[_$axis_ids_587.id2name(id)]},getFromTrace:function(gd,fullTrace,type){var fullLayout=gd._fullLayout,ax=null;if(_$registry_668.traceIs(fullTrace,"gl3d")){var scene=fullTrace.scene;"scene"===scene.substr(0,5)&&(ax=fullLayout[scene][type+"axis"])}else ax=_$axis_ids_587.getFromId(gd,fullTrace[type+"axis"]||type);return ax},idSort:function(id1,id2){var letter1=id1.charAt(0),letter2=id2.charAt(0);return letter1!==letter2?letter1>letter2?1:-1:+(id1.substr(1)||1)-+(id2.substr(1)||1)}},_$command_609={};function bindingValueHasChanged(gd,binding,cache){var container,value,obj,changed=!1;if("data"===binding.type)container=gd._fullData[null!==binding.traces?binding.traces[0]:0];else{if("layout"!==binding.type)return!1;container=gd._fullLayout}return value=_$lib_539.nestedProperty(container,binding.prop).get(),(obj=cache[binding.type]=cache[binding.type]||{}).hasOwnProperty(binding.prop)&&obj[binding.prop]!==value&&(changed=!0),obj[binding.prop]=value,{changed:changed,value:value}}function computeLayoutBindings(gd,args){var bindings=[],astr=args[0],aobj={};if("string"==typeof astr)aobj[astr]=args[1];else{if(!_$lib_539.isPlainObject(astr))return bindings;aobj=astr}return crawl(aobj,function(path,attrName,attr){bindings.push({type:"layout",prop:path,value:attr})},"",0),bindings}function computeDataBindings(gd,args){var traces,astr,val,aobj,bindings=[];if(astr=args[0],val=args[1],traces=args[2],aobj={},"string"==typeof astr)aobj[astr]=val;else{if(!_$lib_539.isPlainObject(astr))return bindings;aobj=astr,void 0===traces&&(traces=val)}return void 0===traces&&(traces=null),crawl(aobj,function(path,attrName,attr){var thisTraces;if(Array.isArray(attr)){var nAttr=Math.min(attr.length,gd.data.length);traces&&(nAttr=Math.min(nAttr,traces.length)),thisTraces=[];for(var j=0;j<nAttr;j++)thisTraces[j]=traces?traces[j]:j}else thisTraces=traces?traces.slice(0):null;if(null===thisTraces)Array.isArray(attr)&&(attr=attr[0]);else if(Array.isArray(thisTraces)){if(!Array.isArray(attr)){var tmp=attr;attr=[];for(var i=0;i<thisTraces.length;i++)attr[i]=tmp}attr.length=Math.min(thisTraces.length,attr.length)}bindings.push({type:"data",prop:path,traces:thisTraces,value:attr})},"",0),bindings}function crawl(attrs,callback,path,depth){Object.keys(attrs).forEach(function(attrName){var attr=attrs[attrName];if("_"!==attrName[0]){var thisPath=path+(depth>0?".":"")+attrName;_$lib_539.isPlainObject(attr)?crawl(attr,callback,thisPath,depth+1):callback(thisPath,attrName,attr)}})}_$command_609.manageCommandObserver=function(gd,container,commandList,onchange){var ret={},enabled=!0;container&&container._commandObserver&&(ret=container._commandObserver),ret.cache||(ret.cache={}),ret.lookupTable={};var binding=_$command_609.hasSimpleAPICommandBindings(gd,commandList,ret.lookupTable);if(container&&container._commandObserver){if(binding)return ret;if(container._commandObserver.remove)return container._commandObserver.remove(),container._commandObserver=null,ret}if(binding){bindingValueHasChanged(gd,binding,ret.cache),ret.check=function check(){if(enabled){var update=bindingValueHasChanged(gd,binding,ret.cache);return update.changed&&onchange&&void 0!==ret.lookupTable[update.value]&&(ret.disable(),Promise.resolve(onchange({value:update.value,type:binding.type,prop:binding.prop,traces:binding.traces,index:ret.lookupTable[update.value]})).then(ret.enable,ret.enable)),update.changed}};for(var checkEvents=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],i=0;i<checkEvents.length;i++)gd._internalOn(checkEvents[i],ret.check);ret.remove=function(){for(var i=0;i<checkEvents.length;i++)gd._removeInternalListener(checkEvents[i],ret.check)}}else _$lib_539.log("Unable to automatically bind plot updates to API command"),ret.lookupTable={},ret.remove=function(){};return ret.disable=function disable(){enabled=!1},ret.enable=function enable(){enabled=!0},container&&(container._commandObserver=ret),ret},_$command_609.hasSimpleAPICommandBindings=function(gd,commandList,bindingsByValue){var i,refBinding,n=commandList.length;for(i=0;i<n;i++){var binding,command=commandList[i],method=command.method,args=command.args;if(Array.isArray(args)||(args=[]),!method)return!1;var bindings=_$command_609.computeAPICommandBindings(gd,method,args);if(1!==bindings.length)return!1;if(refBinding){if((binding=bindings[0]).type!==refBinding.type)return!1;if(binding.prop!==refBinding.prop)return!1;if(Array.isArray(refBinding.traces)){if(!Array.isArray(binding.traces))return!1;binding.traces.sort();for(var j=0;j<refBinding.traces.length;j++)if(refBinding.traces[j]!==binding.traces[j])return!1}else if(binding.prop!==refBinding.prop)return!1}else refBinding=bindings[0],Array.isArray(refBinding.traces)&&refBinding.traces.sort();var value=(binding=bindings[0]).value;if(Array.isArray(value)){if(1!==value.length)return!1;value=value[0]}bindingsByValue&&(bindingsByValue[value]=i)}return refBinding},_$command_609.executeAPICommand=function(gd,method,args){if("skip"===method)return Promise.resolve();var _method=_$registry_668.apiMethodRegistry[method],allArgs=[gd];Array.isArray(args)||(args=[]);for(var i=0;i<args.length;i++)allArgs.push(args[i]);return _method.apply(null,allArgs).catch(function(err){return _$lib_539.warn("API call to Plotly."+method+" rejected.",err),Promise.reject(err)})},_$command_609.computeAPICommandBindings=function(gd,method,args){var bindings;switch(Array.isArray(args)||(args=[]),method){case"restyle":bindings=computeDataBindings(gd,args);break;case"relayout":bindings=computeLayoutBindings(gd,args);break;case"update":bindings=computeDataBindings(gd,[args[0],args[2]]).concat(computeLayoutBindings(gd,[args[1]]));break;case"animate":bindings=function computeAnimateBindings(gd,args){return Array.isArray(args[0])&&1===args[0].length&&-1!==["string","number"].indexOf(typeof args[0][0])?[{type:"layout",prop:"_currentFrame",value:args[0][0].toString()}]:[]}(0,args);break;default:bindings=[]}return bindings};var _$plots_647={},_=_$lib_539._,__BADNUM_647=_$numerical_517.BADNUM,plots=_$plots_647={},relinkPrivateKeys=_$lib_539.relinkPrivateKeys;_$lib_539.extendFlat(plots,_$registry_668),plots.attributes=_$attributes_581,plots.attributes.type.values=plots.allTypes,plots.fontAttrs=_$font_attributes_611,plots.layoutAttributes=_$layout_attributes_638,plots.fontWeight="normal";var transformsRegistry=plots.transformsRegistry;plots.executeAPICommand=_$command_609.executeAPICommand,plots.computeAPICommandBindings=_$command_609.computeAPICommandBindings,plots.manageCommandObserver=_$command_609.manageCommandObserver,plots.hasSimpleAPICommandBindings=_$command_609.hasSimpleAPICommandBindings,plots.redrawText=function(gd){if(!((gd=_$lib_539.getGraphDiv(gd)).data&&gd.data[0]&&gd.data[0].r))return new Promise(function(resolve){setTimeout(function(){_$registry_668.getComponentMethod("annotations","draw")(gd),_$registry_668.getComponentMethod("legend","draw")(gd),(gd.calcdata||[]).forEach(function(d){d[0]&&d[0].t&&d[0].t.cb&&d[0].t.cb()}),resolve(plots.previousPromises(gd))},300)})},plots.resize=function(gd){return gd=_$lib_539.getGraphDiv(gd),new Promise(function(resolve,reject){gd&&!function isHidden(gd){var display=window.getComputedStyle(gd).display;return!display||"none"===display}(gd)||reject(new Error("Resize must be passed a displayed plot div element.")),gd._redrawTimer&&clearTimeout(gd._redrawTimer),gd._redrawTimer=setTimeout(function(){if(gd.layout.width&&gd.layout.height)resolve(gd);else{delete gd.layout.width,delete gd.layout.height;var oldchanged=gd.changed;gd.autoplay=!0,_$registry_668.call("relayout",gd,{autosize:!0}).then(function(){gd.changed=oldchanged,resolve(gd)})}},100)})},plots.previousPromises=function(gd){if((gd._promises||[]).length)return Promise.all(gd._promises).then(function(){gd._promises=[]})},plots.addLinks=function(gd){if(gd._context.showLink||gd._context.showSources){var fullLayout=gd._fullLayout,linkContainer=fullLayout._paper.selectAll("text.js-plot-link-container").data([0]);linkContainer.enter().append("text").classed("js-plot-link-container",!0).style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:_$color_411.defaultLine,"pointer-events":"all"}).each(function(){var links=_$d3_127.select(this);links.append("tspan").classed("js-link-to-tool",!0),links.append("tspan").classed("js-link-spacer",!0),links.append("tspan").classed("js-sourcelinks",!0)});var text=linkContainer.node(),attrs={y:fullLayout._paper.attr("height")-9};document.body.contains(text)&&text.getComputedTextLength()>=fullLayout.width-20?(attrs["text-anchor"]="start",attrs.x=5):(attrs["text-anchor"]="end",attrs.x=fullLayout._paper.attr("width")-7),linkContainer.attr(attrs);var toolspan=linkContainer.select(".js-link-to-tool"),spacespan=linkContainer.select(".js-link-spacer"),sourcespan=linkContainer.select(".js-sourcelinks");gd._context.showSources&&gd._context.showSources(gd),gd._context.showLink&&function positionPlayWithData(gd,container){container.text("");var link=container.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(gd._context.linkText+" "+String.fromCharCode(187));if(gd._context.sendData)link.on("click",function(){plots.sendDataToCloud(gd)});else{var path=window.location.pathname.split("/"),query=window.location.search;link.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+path[2].split(".")[0]+"/"+path[1]+query})}}(gd,toolspan),spacespan.text(toolspan.text()&&sourcespan.text()?" - ":"")}},plots.sendDataToCloud=function(gd){gd.emit("plotly_beforeexport");var baseUrl=window.PLOTLYENV&&window.PLOTLYENV.BASE_URL||"https://plot.ly",hiddenformDiv=_$d3_127.select(gd).append("div").attr("id","hiddenform").style("display","none"),hiddenform=hiddenformDiv.append("form").attr({action:baseUrl+"/external",method:"post",target:"_blank"});return hiddenform.append("input").attr({type:"text",name:"data"}).node().value=plots.graphJson(gd,!1,"keepdata"),hiddenform.node().submit(),hiddenformDiv.remove(),gd.emit("plotly_afterexport"),!1};var collectableSubplotTypes,d3FormatKeys=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],extraFormatKeys=["year","month","dayMonth","dayMonthYear"];function remapTransformedArrays(cd0,newTrace){var i,astr,oldTrace=cd0.trace,arrayAttrs=oldTrace._arrayAttrs,transformedArrayHash={};for(i=0;i<arrayAttrs.length;i++)transformedArrayHash[astr=arrayAttrs[i]]=_$lib_539.nestedProperty(oldTrace,astr).get().slice();for(cd0.trace=newTrace,i=0;i<arrayAttrs.length;i++)astr=arrayAttrs[i],_$lib_539.nestedProperty(cd0.trace,astr).set(transformedArrayHash[astr])}function getFormatObj(gd,formatKeys){var locale=gd._context.locale,formatDone=!1,formatObj={};function includeFormat(newFormat){for(var formatFinished=!0,i=0;i<formatKeys.length;i++){var formatKey=formatKeys[i];formatObj[formatKey]||(newFormat[formatKey]?formatObj[formatKey]=newFormat[formatKey]:formatFinished=!1)}formatFinished&&(formatDone=!0)}for(var i=0;i<2;i++){for(var locales=gd._context.locales,j=0;j<2;j++){var formatj=(locales[locale]||{}).format;if(formatj&&(includeFormat(formatj),formatDone))break;locales=_$registry_668.localeRegistry}var baseLocale=locale.split("-")[0];if(formatDone||baseLocale===locale)break;locale=baseLocale}return formatDone||includeFormat(_$registry_668.localeRegistry.en.format),formatObj}function applyTransforms(fullTrace,fullData,layout,fullLayout){for(var container=fullTrace.transforms,dataOut=[fullTrace],i=0;i<container.length;i++){var transform=container[i],_module=transformsRegistry[transform.type];_module&&_module.transform&&(dataOut=_module.transform(dataOut,{transform:transform,fullTrace:fullTrace,fullData:fullData,layout:layout,fullLayout:fullLayout,transformIndex:i}))}return dataOut}function clearAxesCalc(axList){for(var i=0;i<axList.length;i++)axList[i].clearCalc()}plots.supplyDefaults=function(gd){var oldFullLayout=gd._fullLayout||{};if(oldFullLayout._skipDefaults)delete oldFullLayout._skipDefaults;else{var i,newFullLayout=gd._fullLayout={},newLayout=gd.layout||{},oldFullData=gd._fullData||[],newFullData=gd._fullData=[],newData=gd.data||[],context=gd._context||{};gd._transitionData||plots.createTransitionData(gd),newFullLayout._dfltTitle={plot:_(gd,"Click to enter Plot title"),x:_(gd,"Click to enter X axis title"),y:_(gd,"Click to enter Y axis title"),colorbar:_(gd,"Click to enter Colorscale title"),annotation:_(gd,"new text")},newFullLayout._traceWord=_(gd,"trace");var formatObj=getFormatObj(gd,d3FormatKeys);if(newFullLayout._mapboxAccessToken=context.mapboxAccessToken,oldFullLayout._initialAutoSizeIsDone){var oldWidth=oldFullLayout.width,oldHeight=oldFullLayout.height;plots.supplyLayoutGlobalDefaults(newLayout,newFullLayout,formatObj),newLayout.width||(newFullLayout.width=oldWidth),newLayout.height||(newFullLayout.height=oldHeight)}else{plots.supplyLayoutGlobalDefaults(newLayout,newFullLayout,formatObj);var missingWidthOrHeight=!newLayout.width||!newLayout.height,autosize=newFullLayout.autosize,autosizable=context.autosizable;missingWidthOrHeight&&(autosize||autosizable)?plots.plotAutoSize(gd,newLayout,newFullLayout):missingWidthOrHeight&&plots.sanitizeMargins(gd),!autosize&&missingWidthOrHeight&&(newLayout.width=newFullLayout.width,newLayout.height=newFullLayout.height)}newFullLayout._d3locale=function getFormatter(formatObj,separators){return formatObj.decimal=separators.charAt(0),formatObj.thousands=separators.charAt(1),_$d3_127.locale(formatObj)}(formatObj,newFullLayout.separators),newFullLayout._extraFormat=getFormatObj(gd,extraFormatKeys),newFullLayout._initialAutoSizeIsDone=!0,newFullLayout._dataLength=newData.length,newFullLayout._modules=[],newFullLayout._basePlotModules=[],newFullLayout._subplots=function emptySubplotLists(){var i,j,out={};if(!collectableSubplotTypes){collectableSubplotTypes=[];var subplotsRegistry=_$registry_668.subplotsRegistry;for(var subplotType in subplotsRegistry){var subplotModule=subplotsRegistry[subplotType],subplotAttr=subplotModule.attr;if(subplotAttr&&(collectableSubplotTypes.push(subplotType),Array.isArray(subplotAttr)))for(j=0;j<subplotAttr.length;j++)_$lib_539.pushUnique(collectableSubplotTypes,subplotAttr[j])}}for(i=0;i<collectableSubplotTypes.length;i++)out[collectableSubplotTypes[i]]=[];return out}(),newFullLayout._globalTransforms=(gd._context||{}).globalTransforms,plots.supplyDataDefaults(newData,newFullData,newLayout,newFullLayout),newFullLayout._has=plots._hasPlotType.bind(newFullLayout);var _modules=newFullLayout._modules;for(i=0;i<_modules.length;i++){var _module=_modules[i];_module.cleanData&&_module.cleanData(newFullData)}if(oldFullData.length===newData.length)for(i=0;i<newFullData.length;i++)relinkPrivateKeys(newFullData[i],oldFullData[i]);plots.supplyLayoutModuleDefaults(newLayout,newFullLayout,newFullData,gd._transitionData),newFullLayout._hasCartesian=newFullLayout._has("cartesian"),newFullLayout._hasGeo=newFullLayout._has("geo"),newFullLayout._hasGL3D=newFullLayout._has("gl3d"),newFullLayout._hasGL2D=newFullLayout._has("gl2d"),newFullLayout._hasTernary=newFullLayout._has("ternary"),newFullLayout._hasPie=newFullLayout._has("pie"),plots.cleanPlot(newFullData,newFullLayout,oldFullData,oldFullLayout),plots.linkSubplots(newFullData,newFullLayout,oldFullData,oldFullLayout),relinkPrivateKeys(newFullLayout,oldFullLayout),plots.doAutoMargin(gd);var axList=_$axis_ids_587.list(gd);for(i=0;i<axList.length;i++){axList[i].setScale()}if((gd.calcdata||[]).length===newFullData.length)for(i=0;i<newFullData.length;i++){var newTrace=newFullData[i],cd0=gd.calcdata[i][0];cd0&&cd0.trace&&(cd0.trace._hasCalcTransform?remapTransformedArrays(cd0,newTrace):cd0.trace=newTrace)}}},plots.createTransitionData=function(gd){gd._transitionData||(gd._transitionData={}),gd._transitionData._frames||(gd._transitionData._frames=[]),gd._transitionData._frameHash||(gd._transitionData._frameHash={}),gd._transitionData._counter||(gd._transitionData._counter=0),gd._transitionData._interruptCallbacks||(gd._transitionData._interruptCallbacks=[])},plots._hasPlotType=function(category){var i,basePlotModules=this._basePlotModules||[];for(i=0;i<basePlotModules.length;i++){if(basePlotModules[i].name===category)return!0}var modules=this._modules||[];for(i=0;i<modules.length;i++){var modulei=modules[i];if(modulei.categories&&modulei.categories.indexOf(category)>=0)return!0}return!1},plots.cleanPlot=function(newFullData,newFullLayout,oldFullData,oldFullLayout){var i,j,basePlotModules=oldFullLayout._basePlotModules||[];for(i=0;i<basePlotModules.length;i++){var _module=basePlotModules[i];_module.clean&&_module.clean(newFullData,newFullLayout,oldFullData,oldFullLayout)}var hasPaper=!!oldFullLayout._paper,hasInfoLayer=!!oldFullLayout._infolayer,hadGl=oldFullLayout._has&&oldFullLayout._has("gl"),hasGl=newFullLayout._has&&newFullLayout._has("gl");hadGl&&!hasGl&&void 0!==oldFullLayout._glcontainer&&(oldFullLayout._glcontainer.selectAll(".gl-canvas").remove(),oldFullLayout._glcanvas=null);oldLoop:for(i=0;i<oldFullData.length;i++){var oldUid=oldFullData[i].uid;for(j=0;j<newFullData.length;j++){if(oldUid===newFullData[j].uid)continue oldLoop}var query=".hm"+oldUid+",.contour"+oldUid+",.carpet"+oldUid+",#clip"+oldUid+",.trace"+oldUid;hasPaper&&oldFullLayout._paper.selectAll(query).remove(),hasInfoLayer&&(oldFullLayout._infolayer.selectAll(".cb"+oldUid).remove(),oldFullLayout._infolayer.selectAll("g.rangeslider-container").selectAll(query).remove())}oldFullLayout._zoomlayer&&oldFullLayout._zoomlayer.selectAll(".select-outline").remove()},plots.linkSubplots=function(newFullData,newFullLayout,oldFullData,oldFullLayout){var i,j,id,ax,oldSubplots=oldFullLayout._plots||{},newSubplots=newFullLayout._plots={},newSubplotList=newFullLayout._subplots,mockGd={_fullData:newFullData,_fullLayout:newFullLayout},ids=newSubplotList.cartesian.concat(newSubplotList.gl2d||[]);for(i=0;i<ids.length;i++){var plotinfo,oldSubplot=oldSubplots[id=ids[i]],xaxis=_$axis_ids_587.getFromId(mockGd,id,"x"),yaxis=_$axis_ids_587.getFromId(mockGd,id,"y");for(oldSubplot?((plotinfo=newSubplots[id]=oldSubplot).xaxis.layer!==xaxis.layer&&(plotinfo.xlines.attr("d",null),plotinfo.xaxislayer.selectAll("*").remove()),plotinfo.yaxis.layer!==yaxis.layer&&(plotinfo.ylines.attr("d",null),plotinfo.yaxislayer.selectAll("*").remove())):(plotinfo=newSubplots[id]={}).id=id,plotinfo.xaxis=xaxis,plotinfo.yaxis=yaxis,plotinfo._hasClipOnAxisFalse=!1,j=0;j<newFullData.length;j++){var trace=newFullData[j];if(trace.xaxis===plotinfo.xaxis._id&&trace.yaxis===plotinfo.yaxis._id&&!1===trace.cliponaxis){plotinfo._hasClipOnAxisFalse=!0;break}}}var axList=_$axis_ids_587.list(mockGd,null,!0);for(i=0;i<axList.length;i++){var mainAx=null;(ax=axList[i]).overlaying&&(mainAx=_$axis_ids_587.getFromId(mockGd,ax.overlaying))&&mainAx.overlaying&&(ax.overlaying=!1,mainAx=null),ax._mainAxis=mainAx||ax,mainAx&&(ax.domain=mainAx.domain.slice()),ax._anchorAxis="free"===ax.anchor?null:_$axis_ids_587.getFromId(mockGd,ax.anchor)}for(i=0;i<axList.length;i++){var isX="x"===(ax=axList[i])._id.charAt(0),anchorAx=ax._mainAxis._anchorAxis,mainSubplotID="",nextBestMainSubplotID="",anchorID="";if(anchorAx&&(anchorID=anchorAx._mainAxis._id,mainSubplotID=isX?ax._id+anchorID:anchorID+ax._id),!mainSubplotID||-1===ids.indexOf(mainSubplotID))for(mainSubplotID="",j=0;j<ids.length;j++){var yIndex=(id=ids[j]).indexOf("y"),idPart=isX?id.substr(0,yIndex):id.substr(yIndex),counterPart=isX?id.substr(yIndex):id.substr(0,yIndex);if(idPart===ax._id){nextBestMainSubplotID||(nextBestMainSubplotID=id);var counterAx=_$axis_ids_587.getFromId(mockGd,counterPart);if(anchorID&&counterAx.overlaying===anchorID){mainSubplotID=id;break}}}ax._mainSubplot=mainSubplotID||nextBestMainSubplotID}},plots.clearExpandedTraceDefaultColors=function(trace){var colorAttrs,path,i;for(path=[],(colorAttrs=trace._module._colorAttrs)||(trace._module._colorAttrs=colorAttrs=[],_$plot_schema_575.crawl(trace._module.attributes,function locateColorAttrs(attr,attrName,attrs,level){path[level]=attrName,path.length=level+1,"color"===attr.valType&&void 0===attr.dflt&&colorAttrs.push(path.join("."))})),i=0;i<colorAttrs.length;i++){_$lib_539.nestedProperty(trace,"_input."+colorAttrs[i]).get()||_$lib_539.nestedProperty(trace,colorAttrs[i]).set(null)}},plots.supplyDataDefaults=function(dataIn,dataOut,layout,fullLayout){var i,fullTrace,trace,modules=fullLayout._modules,basePlotModules=fullLayout._basePlotModules,cnt=0,colorCnt=0;function pushModule(fullTrace){dataOut.push(fullTrace);var _module=fullTrace._module;_module&&(!0===fullTrace.visible&&_$lib_539.pushUnique(modules,_module),_$lib_539.pushUnique(basePlotModules,fullTrace._module.basePlotModule),cnt++,!1!==fullTrace._input.visible&&colorCnt++)}fullLayout._transformModules=[];var carpetIndex={},carpetDependents=[];for(i=0;i<dataIn.length;i++){if(trace=dataIn[i],(fullTrace=plots.supplyTraceDefaults(trace,colorCnt,fullLayout,i)).index=i,fullTrace._input=trace,fullTrace._expandedIndex=cnt,fullTrace.transforms&&fullTrace.transforms.length)for(var expandedTraces=applyTransforms(fullTrace,dataOut,layout,fullLayout),j=0;j<expandedTraces.length;j++){var expandedTrace=expandedTraces[j],fullExpandedTrace=plots.supplyTraceDefaults(expandedTrace,cnt,fullLayout,i);relinkPrivateKeys(fullExpandedTrace,expandedTrace),expandedTrace.uid=fullExpandedTrace.uid=fullTrace.uid+j,fullExpandedTrace.index=i,fullExpandedTrace._input=trace,fullExpandedTrace._fullInput=fullTrace,fullExpandedTrace._expandedIndex=cnt,fullExpandedTrace._expandedInput=expandedTrace,pushModule(fullExpandedTrace)}else fullTrace._fullInput=fullTrace,fullTrace._expandedInput=fullTrace,pushModule(fullTrace);_$registry_668.traceIs(fullTrace,"carpetAxis")&&(carpetIndex[fullTrace.carpet]=fullTrace),_$registry_668.traceIs(fullTrace,"carpetDependent")&&carpetDependents.push(i)}for(i=0;i<carpetDependents.length;i++)if((fullTrace=dataOut[carpetDependents[i]]).visible){var carpetAxis=carpetIndex[fullTrace.carpet];fullTrace._carpet=carpetAxis,carpetAxis&&carpetAxis.visible?(fullTrace.xaxis=carpetAxis.xaxis,fullTrace.yaxis=carpetAxis.yaxis):fullTrace.visible=!1}},plots.supplyAnimationDefaults=function(opts){var i;opts=opts||{};var optsOut={};function coerce(attr,dflt){return _$lib_539.coerce(opts||{},optsOut,_$animation_attributes_579,attr,dflt)}if(coerce("mode"),coerce("direction"),coerce("fromcurrent"),Array.isArray(opts.frame))for(optsOut.frame=[],i=0;i<opts.frame.length;i++)optsOut.frame[i]=plots.supplyAnimationFrameDefaults(opts.frame[i]||{});else optsOut.frame=plots.supplyAnimationFrameDefaults(opts.frame||{});if(Array.isArray(opts.transition))for(optsOut.transition=[],i=0;i<opts.transition.length;i++)optsOut.transition[i]=plots.supplyAnimationTransitionDefaults(opts.transition[i]||{});else optsOut.transition=plots.supplyAnimationTransitionDefaults(opts.transition||{});return optsOut},plots.supplyAnimationFrameDefaults=function(opts){var optsOut={};function coerce(attr,dflt){return _$lib_539.coerce(opts||{},optsOut,_$animation_attributes_579.frame,attr,dflt)}return coerce("duration"),coerce("redraw"),optsOut},plots.supplyAnimationTransitionDefaults=function(opts){var optsOut={};function coerce(attr,dflt){return _$lib_539.coerce(opts||{},optsOut,_$animation_attributes_579.transition,attr,dflt)}return coerce("duration"),coerce("easing"),optsOut},plots.supplyFrameDefaults=function(frameIn){var frameOut={};function coerce(attr,dflt){return _$lib_539.coerce(frameIn,frameOut,_$frame_attributes_612,attr,dflt)}return coerce("group"),coerce("name"),coerce("traces"),coerce("baseframe"),coerce("data"),coerce("layout"),frameOut},plots.supplyTraceDefaults=function(traceIn,colorIndex,layout,traceInIndex){var i,colorway=layout.colorway||_$color_411.defaults,traceOut={},defaultColor=colorway[colorIndex%colorway.length];function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,plots.attributes,attr,dflt)}var visible=coerce("visible");coerce("type"),coerce("uid"),coerce("name",layout._traceWord+" "+traceInIndex);var _module=plots.getModule(traceOut);if(traceOut._module=_module,_module){var basePlotModule=_module.basePlotModule,subplotAttr=basePlotModule.attr;if(subplotAttr){var subplots=layout._subplots,subplotAttrs=basePlotModule.attributes,subplotId="";if("gl2d"!==basePlotModule.name||visible){if(Array.isArray(subplotAttr))for(i=0;i<subplotAttr.length;i++){var attri=subplotAttr[i],vali=_$lib_539.coerce(traceIn,traceOut,subplotAttrs,attri);subplots[attri]&&_$lib_539.pushUnique(subplots[attri],vali),subplotId+=vali}else subplotId=_$lib_539.coerce(traceIn,traceOut,subplotAttrs,subplotAttr);subplots[basePlotModule.name]&&_$lib_539.pushUnique(subplots[basePlotModule.name],subplotId)}}}return visible&&(coerce("customdata"),coerce("ids"),_$registry_668.traceIs(traceOut,"showLegend")&&(coerce("showlegend"),coerce("legendgroup")),_$registry_668.getComponentMethod("fx","supplyDefaults")(traceIn,traceOut,defaultColor,layout),_module&&(_module.supplyDefaults(traceIn,traceOut,defaultColor,layout),_$lib_539.coerceHoverinfo(traceIn,traceOut,layout)),_$registry_668.traceIs(traceOut,"noOpacity")||coerce("opacity"),_$registry_668.traceIs(traceOut,"notLegendIsolatable")&&(traceOut.visible=!!traceOut.visible),_module&&_module.selectPoints&&coerce("selectedpoints"),plots.supplyTransformDefaults(traceIn,traceOut,layout)),traceOut},plots.supplyTransformDefaults=function(traceIn,traceOut,layout){var globalTransforms=layout._globalTransforms||[],transformModules=layout._transformModules||[];if(Array.isArray(traceIn.transforms)||0!==globalTransforms.length)for(var containerIn=traceIn.transforms||[],transformList=globalTransforms.concat(containerIn),containerOut=traceOut.transforms=[],i=0;i<transformList.length;i++){var transformOut,transformIn=transformList[i],type=transformIn.type,_module=transformsRegistry[type],isFirstStage=!(transformIn._module&&transformIn._module===_module),doLaterStages=_module&&"function"==typeof _module.transform;_module||_$lib_539.warn("Unrecognized transform type "+type+"."),_module&&_module.supplyDefaults&&(isFirstStage||doLaterStages)?((transformOut=_module.supplyDefaults(transformIn,traceOut,layout,traceIn)).type=type,transformOut._module=_module,_$lib_539.pushUnique(transformModules,_module)):transformOut=_$lib_539.extendFlat({},transformIn),containerOut.push(transformOut)}},plots.supplyLayoutGlobalDefaults=function(layoutIn,layoutOut,formatObj){function coerce(attr,dflt){return _$lib_539.coerce(layoutIn,layoutOut,plots.layoutAttributes,attr,dflt)}var globalFont=_$lib_539.coerceFont(coerce,"font");coerce("title",layoutOut._dfltTitle.plot),_$lib_539.coerceFont(coerce,"titlefont",{family:globalFont.family,size:Math.round(1.4*globalFont.size),color:globalFont.color}),coerce("autosize",!(layoutIn.width&&layoutIn.height)),coerce("width"),coerce("height"),coerce("margin.l"),coerce("margin.r"),coerce("margin.t"),coerce("margin.b"),coerce("margin.pad"),coerce("margin.autoexpand"),layoutIn.width&&layoutIn.height&&plots.sanitizeMargins(layoutOut),_$registry_668.getComponentMethod("grid","sizeDefaults")(layoutIn,layoutOut),coerce("paper_bgcolor"),coerce("separators",formatObj.decimal+formatObj.thousands),coerce("hidesources"),coerce("colorway"),coerce("datarevision"),_$registry_668.getComponentMethod("calendars","handleDefaults")(layoutIn,layoutOut,"calendar"),_$registry_668.getComponentMethod("fx","supplyLayoutGlobalDefaults")(layoutIn,layoutOut,coerce)},plots.plotAutoSize=function plotAutoSize(gd,layout,fullLayout){var newWidth,newHeight,context=gd._context||{},frameMargins=context.frameMargins,isPlotDiv=_$lib_539.isPlotDiv(gd);if(isPlotDiv&&gd.emit("plotly_autosize"),context.fillFrame)newWidth=window.innerWidth,newHeight=window.innerHeight,document.body.style.overflow="hidden";else if(_$fastIsnumeric_139(frameMargins)&&frameMargins>0){var reservedMargins=function calculateReservedMargins(margins){var marginName,resultingMargin={left:0,right:0,bottom:0,top:0};if(margins)for(marginName in margins)margins.hasOwnProperty(marginName)&&(resultingMargin.left+=margins[marginName].left||0,resultingMargin.right+=margins[marginName].right||0,resultingMargin.bottom+=margins[marginName].bottom||0,resultingMargin.top+=margins[marginName].top||0);return resultingMargin}(gd._boundingBoxMargins),reservedWidth=reservedMargins.left+reservedMargins.right,reservedHeight=reservedMargins.bottom+reservedMargins.top,factor=1-2*frameMargins,gdBB=fullLayout._container&&fullLayout._container.node?fullLayout._container.node().getBoundingClientRect():{width:fullLayout.width,height:fullLayout.height};newWidth=Math.round(factor*(gdBB.width-reservedWidth)),newHeight=Math.round(factor*(gdBB.height-reservedHeight))}else{var computedStyle=isPlotDiv?window.getComputedStyle(gd):{};newWidth=parseFloat(computedStyle.width)||fullLayout.width,newHeight=parseFloat(computedStyle.height)||fullLayout.height}var minWidth=plots.layoutAttributes.width.min,minHeight=plots.layoutAttributes.height.min;newWidth<minWidth&&(newWidth=minWidth),newHeight<minHeight&&(newHeight=minHeight);var widthHasChanged=!layout.width&&Math.abs(fullLayout.width-newWidth)>1,heightHasChanged=!layout.height&&Math.abs(fullLayout.height-newHeight)>1;(heightHasChanged||widthHasChanged)&&(widthHasChanged&&(fullLayout.width=newWidth),heightHasChanged&&(fullLayout.height=newHeight)),gd._initialAutoSize||(gd._initialAutoSize={width:newWidth,height:newHeight}),plots.sanitizeMargins(fullLayout)},plots.supplyLayoutModuleDefaults=function(layoutIn,layoutOut,fullData,transitionData){var component,i,_module,componentsRegistry=_$registry_668.componentsRegistry,basePlotModules=layoutOut._basePlotModules,Cartesian=_$registry_668.subplotsRegistry.cartesian;for(component in componentsRegistry)(_module=componentsRegistry[component]).includeBasePlot&&_module.includeBasePlot(layoutIn,layoutOut);for(var subplotType in basePlotModules.length||basePlotModules.push(Cartesian),layoutOut._has("cartesian")&&(_$registry_668.getComponentMethod("grid","contentDefaults")(layoutIn,layoutOut),Cartesian.finalizeSubplots(layoutIn,layoutOut)),layoutOut._subplots)layoutOut._subplots[subplotType].sort(_$lib_539.subplotSort);for(i=0;i<basePlotModules.length;i++)(_module=basePlotModules[i]).supplyLayoutDefaults&&_module.supplyLayoutDefaults(layoutIn,layoutOut,fullData);var modules=layoutOut._modules;for(i=0;i<modules.length;i++)(_module=modules[i]).supplyLayoutDefaults&&_module.supplyLayoutDefaults(layoutIn,layoutOut,fullData);var transformModules=layoutOut._transformModules;for(i=0;i<transformModules.length;i++)(_module=transformModules[i]).supplyLayoutDefaults&&_module.supplyLayoutDefaults(layoutIn,layoutOut,fullData,transitionData);for(component in componentsRegistry)(_module=componentsRegistry[component]).supplyLayoutDefaults&&_module.supplyLayoutDefaults(layoutIn,layoutOut,fullData)},plots.purge=function(gd){var fullLayout=gd._fullLayout||{};void 0!==fullLayout._glcontainer&&(fullLayout._glcontainer.selectAll(".gl-canvas").remove(),fullLayout._glcontainer.remove(),fullLayout._glcanvas=null),void 0!==fullLayout._geocontainer&&fullLayout._geocontainer.remove(),fullLayout._modeBar&&fullLayout._modeBar.destroy(),gd._transitionData&&(gd._transitionData._interruptCallbacks&&(gd._transitionData._interruptCallbacks.length=0),gd._transitionData._animationRaf&&window.cancelAnimationFrame(gd._transitionData._animationRaf)),_$lib_539.clearThrottle(),delete gd.data,delete gd.layout,delete gd._fullData,delete gd._fullLayout,delete gd.calcdata,delete gd.framework,delete gd.empty,delete gd.fid,delete gd.undoqueue,delete gd.undonum,delete gd.autoplay,delete gd.changed,delete gd._promises,delete gd._redrawTimer,delete gd.firstscatter,delete gd._hmlumcount,delete gd._hmpixcount,delete gd._transitionData,delete gd._transitioning,delete gd._initialAutoSize,delete gd._transitioningWithDuration,delete gd._dragging,delete gd._dragged,delete gd._hoverdata,delete gd._snapshotInProgress,delete gd._editing,delete gd._replotPending,delete gd._mouseDownTime,delete gd._legendMouseDownTime,gd.removeAllListeners&&gd.removeAllListeners()},plots.style=function(gd){var i,_modules=gd._fullLayout._modules,styleModules=[];for(i=0;i<_modules.length;i++){var _module=_modules[i];_module.style&&_$lib_539.pushUnique(styleModules,_module.style)}for(i=0;i<styleModules.length;i++)styleModules[i](gd)},plots.sanitizeMargins=function(fullLayout){if(fullLayout&&fullLayout.margin){var correction,width=fullLayout.width,height=fullLayout.height,margin=fullLayout.margin,plotWidth=width-(margin.l+margin.r),plotHeight=height-(margin.t+margin.b);plotWidth<0&&(correction=(width-1)/(margin.l+margin.r),margin.l=Math.floor(correction*margin.l),margin.r=Math.floor(correction*margin.r)),plotHeight<0&&(correction=(height-1)/(margin.t+margin.b),margin.t=Math.floor(correction*margin.t),margin.b=Math.floor(correction*margin.b))}},plots.autoMargin=function(gd,id,o){var fullLayout=gd._fullLayout;if(fullLayout._pushmargin||(fullLayout._pushmargin={}),!1!==fullLayout.margin.autoexpand){if(o){var pad=void 0===o.pad?12:o.pad;o.l+o.r>.5*fullLayout.width&&(o.l=o.r=0),o.b+o.t>.5*fullLayout.height&&(o.b=o.t=0),fullLayout._pushmargin[id]={l:{val:o.x,size:o.l+pad},r:{val:o.x,size:o.r+pad},b:{val:o.y,size:o.b+pad},t:{val:o.y,size:o.t+pad}}}else delete fullLayout._pushmargin[id];fullLayout._replotting||plots.doAutoMargin(gd)}},plots.doAutoMargin=function(gd){var fullLayout=gd._fullLayout;fullLayout._size||(fullLayout._size={}),fullLayout._pushmargin||(fullLayout._pushmargin={});var gs=fullLayout._size,oldmargins=JSON.stringify(gs),ml=Math.max(fullLayout.margin.l||0,0),mr=Math.max(fullLayout.margin.r||0,0),mt=Math.max(fullLayout.margin.t||0,0),mb=Math.max(fullLayout.margin.b||0,0),pm=fullLayout._pushmargin;if(!1!==fullLayout.margin.autoexpand)for(var k1 in pm.base={l:{val:0,size:ml},r:{val:1,size:mr},t:{val:1,size:mt},b:{val:0,size:mb}},pm){var pushleft=pm[k1].l||{},pushbottom=pm[k1].b||{},fl=pushleft.val,pl=pushleft.size,fb=pushbottom.val,pb=pushbottom.size;for(var k2 in pm){if(_$fastIsnumeric_139(pl)&&pm[k2].r){var fr=pm[k2].r.val,pr=pm[k2].r.size;if(fr>fl){var newl=(pl*fr+(pr-fullLayout.width)*fl)/(fr-fl),newr=(pr*(1-fl)+(pl-fullLayout.width)*(1-fr))/(fr-fl);newl>=0&&newr>=0&&newl+newr>ml+mr&&(ml=newl,mr=newr)}}if(_$fastIsnumeric_139(pb)&&pm[k2].t){var ft=pm[k2].t.val,pt=pm[k2].t.size;if(ft>fb){var newb=(pb*ft+(pt-fullLayout.height)*fb)/(ft-fb),newt=(pt*(1-fb)+(pb-fullLayout.height)*(1-ft))/(ft-fb);newb>=0&&newt>=0&&newb+newt>mb+mt&&(mb=newb,mt=newt)}}}}if(gs.l=Math.round(ml),gs.r=Math.round(mr),gs.t=Math.round(mt),gs.b=Math.round(mb),gs.p=Math.round(fullLayout.margin.pad),gs.w=Math.round(fullLayout.width)-gs.l-gs.r,gs.h=Math.round(fullLayout.height)-gs.t-gs.b,!fullLayout._replotting&&"{}"!==oldmargins&&oldmargins!==JSON.stringify(fullLayout._size))return _$registry_668.call("plot",gd)},plots.graphJson=function(gd,dataonly,mode,output,useDefaults){(useDefaults&&dataonly&&!gd._fullData||useDefaults&&!dataonly&&!gd._fullLayout)&&plots.supplyDefaults(gd);var data=useDefaults?gd._fullData:gd.data,layout=useDefaults?gd._fullLayout:gd.layout,frames=(gd._transitionData||{})._frames;function stripObj(d){if("function"==typeof d)return null;if(_$lib_539.isPlainObject(d)){var v,src,o={};for(v in d)if("function"!=typeof d[v]&&-1===["_","["].indexOf(v.charAt(0))){if("keepdata"===mode){if("src"===v.substr(v.length-3))continue}else if("keepstream"===mode){if("string"==typeof(src=d[v+"src"])&&src.indexOf(":")>0&&!_$lib_539.isPlainObject(d.stream))continue}else if("keepall"!==mode&&"string"==typeof(src=d[v+"src"])&&src.indexOf(":")>0)continue;o[v]=stripObj(d[v])}return o}return Array.isArray(d)?d.map(stripObj):_$lib_539.isJSDate(d)?_$lib_539.ms2DateTimeLocal(+d):d}var obj={data:(data||[]).map(function(v){var d=stripObj(v);return dataonly&&delete d.fit,d})};return dataonly||(obj.layout=stripObj(layout)),gd.framework&&gd.framework.isPolar&&(obj=gd.framework.getConfig()),frames&&(obj.frames=stripObj(frames)),"object"===output?obj:JSON.stringify(obj)},plots.modifyFrames=function(gd,operations){var i,op,frame,_frames=gd._transitionData._frames,_frameHash=gd._transitionData._frameHash;for(i=0;i<operations.length;i++)switch((op=operations[i]).type){case"replace":frame=op.value;var oldName=(_frames[op.index]||{}).name,newName=frame.name;_frames[op.index]=_frameHash[newName]=frame,newName!==oldName&&(delete _frameHash[oldName],_frameHash[newName]=frame);break;case"insert":_frameHash[(frame=op.value).name]=frame,_frames.splice(op.index,0,frame);break;case"delete":delete _frameHash[(frame=_frames[op.index]).name],_frames.splice(op.index,1)}return Promise.resolve()},plots.computeFrame=function(gd,frameName){var i,traceIndices,traceIndex,destIndex,frameLookup=gd._transitionData._frameHash;if(!frameName)throw new Error("computeFrame must be given a string frame name");var framePtr=frameLookup[frameName.toString()];if(!framePtr)return!1;for(var frameStack=[framePtr],frameNameStack=[framePtr.name];framePtr.baseframe&&(framePtr=frameLookup[framePtr.baseframe.toString()])&&-1===frameNameStack.indexOf(framePtr.name);)frameStack.push(framePtr),frameNameStack.push(framePtr.name);for(var result={};framePtr=frameStack.pop();)if(framePtr.layout&&(result.layout=plots.extendLayout(result.layout,framePtr.layout)),framePtr.data){if(result.data||(result.data=[]),!(traceIndices=framePtr.traces))for(traceIndices=[],i=0;i<framePtr.data.length;i++)traceIndices[i]=i;for(result.traces||(result.traces=[]),i=0;i<framePtr.data.length;i++)void 0!==(traceIndex=traceIndices[i])&&null!==traceIndex&&(-1===(destIndex=result.traces.indexOf(traceIndex))&&(destIndex=result.data.length,result.traces[destIndex]=traceIndex),result.data[destIndex]=plots.extendTrace(result.data[destIndex],framePtr.data[i]))}return result},plots.recomputeFrameHash=function(gd){for(var hash=gd._transitionData._frameHash={},frames=gd._transitionData._frames,i=0;i<frames.length;i++){var frame=frames[i];frame&&frame.name&&(hash[frame.name]=frame)}},plots.extendObjectWithContainers=function(dest,src,containerPaths){var containerProp,containerVal,i,j,destProp,srcContainer,destContainer,copy=_$lib_539.extendDeepNoArrays({},src||{}),expandedObj=_$lib_539.expandObjectPaths(copy),containerObj={};if(containerPaths&&containerPaths.length)for(i=0;i<containerPaths.length;i++)void 0===(containerVal=(containerProp=_$lib_539.nestedProperty(expandedObj,containerPaths[i])).get())?_$lib_539.nestedProperty(containerObj,containerPaths[i]).set(null):(containerProp.set(null),_$lib_539.nestedProperty(containerObj,containerPaths[i]).set(containerVal));if(dest=_$lib_539.extendDeepNoArrays(dest||{},expandedObj),containerPaths&&containerPaths.length)for(i=0;i<containerPaths.length;i++)if(srcContainer=_$lib_539.nestedProperty(containerObj,containerPaths[i]).get()){for(destContainer=(destProp=_$lib_539.nestedProperty(dest,containerPaths[i])).get(),Array.isArray(destContainer)||(destContainer=[],destProp.set(destContainer)),j=0;j<srcContainer.length;j++){var srcObj=srcContainer[j];destContainer[j]=null===srcObj?null:plots.extendObjectWithContainers(destContainer[j],srcObj)}destProp.set(destContainer)}return dest},plots.dataArrayContainers=["transforms","dimensions"],plots.layoutArrayContainers=_$registry_668.layoutArrayContainers,plots.extendTrace=function(destTrace,srcTrace){return plots.extendObjectWithContainers(destTrace,srcTrace,plots.dataArrayContainers)},plots.extendLayout=function(destLayout,srcLayout){return plots.extendObjectWithContainers(destLayout,srcLayout,plots.layoutArrayContainers)},plots.transition=function(gd,data,layout,traces,frameOpts,transitionOpts){var i,traceIdx,dataLength=Array.isArray(data)?data.length:0,traceIndices=traces.slice(0,dataLength),transitionedTraces=[];var aborted=!1;for(i=0;i<traceIndices.length;i++){traceIdx=traceIndices[i];gd._fullData[traceIdx]._module}var seq=[plots.previousPromises,function interruptPreviousTransitions(){if(gd._transitionData)return gd._transitioning=!1,function executeCallbacks(list){var p=Promise.resolve();if(!list)return p;for(;list.length;)p=p.then(list.shift());return p}(gd._transitionData._interruptCallbacks)},function prepareTransitions(){var i;for(i=0;i<traceIndices.length;i++){var traceIdx=traceIndices[i],module=gd._fullData[traceIdx]._module;module&&(module.animatable&&transitionedTraces.push(traceIdx),gd.data[traceIndices[i]]=plots.extendTrace(gd.data[traceIndices[i]],data[i]))}var layoutUpdate=_$lib_539.expandObjectPaths(_$lib_539.extendDeepNoArrays({},layout)),axisAttrRe=/^[xy]axis[0-9]*$/;for(var attr in layoutUpdate)axisAttrRe.test(attr)&&delete layoutUpdate[attr].range;return plots.extendLayout(gd.layout,layoutUpdate),delete gd.calcdata,plots.supplyDefaults(gd),plots.doCalcdata(gd),_$registry_668.getComponentMethod("errorbars","calc")(gd),Promise.resolve()},plots.rehover,function executeTransitions(){return gd.emit("plotly_transitioning",[]),new Promise(function(resolve){gd._transitioning=!0,transitionOpts.duration>0&&(gd._transitioningWithDuration=!0),gd._transitionData._interruptCallbacks.push(function(){aborted=!0}),frameOpts.redraw&&gd._transitionData._interruptCallbacks.push(function(){return _$registry_668.call("redraw",gd)}),gd._transitionData._interruptCallbacks.push(function(){gd.emit("plotly_transitioninterrupted",[])});var traceTransitionOpts,j,numCallbacks=0,numCompleted=0;function makeCallback(){return numCallbacks++,function(){aborted||++numCompleted!==numCallbacks||function completeTransition(callback){if(gd._transitionData)return function flushCallbacks(list){if(list)for(;list.length;)list.shift()}(gd._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(frameOpts.redraw)return _$registry_668.call("redraw",gd)}).then(function(){gd._transitioning=!1,gd._transitioningWithDuration=!1,gd.emit("plotly_transitioned",[])}).then(callback)}(resolve)}}var basePlotModules=gd._fullLayout._basePlotModules,hasAxisTransition=!1;if(layout)for(j=0;j<basePlotModules.length;j++)if(basePlotModules[j].transitionAxes){var newLayout=_$lib_539.expandObjectPaths(layout);hasAxisTransition=basePlotModules[j].transitionAxes(gd,newLayout,transitionOpts,makeCallback)||hasAxisTransition}for(hasAxisTransition?(traceTransitionOpts=_$lib_539.extendFlat({},transitionOpts)).duration=0:traceTransitionOpts=transitionOpts,j=0;j<basePlotModules.length;j++)basePlotModules[j].plot(gd,transitionedTraces,traceTransitionOpts,makeCallback);setTimeout(makeCallback())})}],transitionStarting=_$lib_539.syncOrAsync(seq,gd);return transitionStarting&&transitionStarting.then||(transitionStarting=Promise.resolve()),transitionStarting.then(function(){return gd})},plots.doCalcdata=function(gd,traces){var trace,_module,i,j,axList=_$axis_ids_587.list(gd),fullData=gd._fullData,fullLayout=gd._fullLayout,calcdata=new Array(fullData.length),oldCalcdata=(gd.calcdata||[]).slice(0);for(gd.calcdata=calcdata,gd.firstscatter=!0,fullLayout._numBoxes=0,fullLayout._numViolins=0,fullLayout._violinScaleGroupStats={},gd._hmpixcount=0,gd._hmlumcount=0,fullLayout._piecolormap={},fullLayout._piecolorway=null,fullLayout._piedefaultcolorcount=0,i=0;i<fullData.length;i++)Array.isArray(traces)&&-1===traces.indexOf(i)&&(calcdata[i]=oldCalcdata[i]);for(i=0;i<fullData.length;i++)(trace=fullData[i])._arrayAttrs=_$plot_schema_575.findArrayAttributes(trace);var polarIds=fullLayout._subplots.polar||[];for(i=0;i<polarIds.length;i++)axList.push(fullLayout[polarIds[i]].radialaxis,fullLayout[polarIds[i]].angularaxis);clearAxesCalc(axList);var hasCalcTransform=!1;for(i=0;i<fullData.length;i++)if(!0===(trace=fullData[i]).visible&&trace.transforms)for((_module=trace._module)&&_module.calc&&_module.calc(gd,trace),j=0;j<trace.transforms.length;j++){var transform=trace.transforms[j];(_module=transformsRegistry[transform.type])&&_module.calcTransform&&(trace._hasCalcTransform=!0,hasCalcTransform=!0,_module.calcTransform(gd,trace,transform))}for(hasCalcTransform&&clearAxesCalc(axList),i=0;i<fullData.length;i++){var cd=[];if(!0===(trace=fullData[i]).visible){_module=trace._module;var transforms=trace.transforms||[];for(j=transforms.length-1;j>=0;j--)if(transforms[j].enabled){trace._indexToPoints=transforms[j]._indexToPoints;break}_module&&_module.calc&&(cd=_module.calc(gd,trace))}Array.isArray(cd)&&cd[0]||(cd=[{x:__BADNUM_647,y:__BADNUM_647}]),cd[0].t||(cd[0].t={}),cd[0].trace=trace,calcdata[i]=cd}_$registry_668.getComponentMethod("fx","calc")(gd)},plots.rehover=function(gd){gd._fullLayout._rehover&&gd._fullLayout._rehover()},plots.generalUpdatePerTraceModule=function(gd,subplot,subplotCalcData,subplotLayout){var i,traceHashOld=subplot.traceHash,traceHash={};for(i=0;i<subplotCalcData.length;i++){var calcTraces=subplotCalcData[i],trace=calcTraces[0].trace;trace.visible&&(traceHash[trace.type]=traceHash[trace.type]||[],traceHash[trace.type].push(calcTraces))}for(var moduleNameOld in traceHashOld)if(!traceHash[moduleNameOld]){var fakeCalcTrace=traceHashOld[moduleNameOld][0];fakeCalcTrace[0].trace.visible=!1,traceHash[moduleNameOld]=[fakeCalcTrace]}for(var moduleName in traceHash){var moduleCalcData=traceHash[moduleName];moduleCalcData[0][0].trace._module.plot(gd,subplot,_$lib_539.filterVisible(moduleCalcData),subplotLayout)}subplot.traceHash=traceHash};var _$titles_504={draw:function draw(gd,titleClass,options){var editAttr,cont=options.propContainer,prop=options.propName,placeholder=options.placeholder,traceIndex=options.traceIndex,avoid=options.avoid||{},attributes=options.attributes,transform=options.transform,group=options.containerGroup,fullLayout=gd._fullLayout,titlefont=cont.titlefont||{},font=titlefont.family,fontSize=titlefont.size,fontColor=titlefont.color,opacity=1,isplaceholder=!1,txt=(cont.title||"").trim();"title"===prop?editAttr="titleText":-1!==prop.indexOf("axis")?editAttr="axisTitleText":prop.indexOf(!0)&&(editAttr="colorbarTitleText");var editable=gd._context.edits[editAttr];""===txt?opacity=0:txt.replace(numStripRE," % ")===placeholder.replace(numStripRE," % ")&&(opacity=.2,isplaceholder=!0,editable||(txt=""));var elShouldExist=txt||editable;group||(group=fullLayout._infolayer.selectAll(".g-"+titleClass).data([0])).enter().append("g").classed("g-"+titleClass,!0);var el=group.selectAll("text").data(elShouldExist?[0]:[]);if(el.enter().append("text"),el.text(txt).attr("class",titleClass),el.exit().remove(),!elShouldExist)return group;function titleLayout(titleEl){_$lib_539.syncOrAsync([drawTitle,scootTitle],titleEl)}function drawTitle(titleEl){var transformVal;return transform?(transformVal="",transform.rotate&&(transformVal+="rotate("+[transform.rotate,attributes.x,attributes.y]+")"),transform.offset&&(transformVal+="translate(0, "+transform.offset+")")):transformVal=null,titleEl.attr("transform",transformVal),titleEl.style({"font-family":font,"font-size":_$d3_127.round(fontSize,2)+"px",fill:_$color_411.rgb(fontColor),opacity:opacity*_$color_411.opacity(fontColor),"font-weight":_$plots_647.fontWeight}).attr(attributes).call(_$svg_text_utils_562.convertToTspans,gd),_$plots_647.previousPromises(gd)}function scootTitle(titleElIn){var titleGroup=_$d3_127.select(titleElIn.node().parentNode);if(avoid&&avoid.selection&&avoid.side&&txt){titleGroup.attr("transform",null);var shift=0,backside={left:"right",right:"left",top:"bottom",bottom:"top"}[avoid.side],shiftSign=-1!==["left","top"].indexOf(avoid.side)?-1:1,pad=_$fastIsnumeric_139(avoid.pad)?avoid.pad:2,titlebb=_$drawing_436.bBox(titleGroup.node()),paperbb={left:0,top:0,right:fullLayout.width,bottom:fullLayout.height},maxshift=avoid.maxShift||(paperbb[avoid.side]-titlebb[avoid.side])*("left"===avoid.side||"top"===avoid.side?-1:1);if(maxshift<0)shift=maxshift;else{var offsetLeft=avoid.offsetLeft||0,offsetTop=avoid.offsetTop||0;titlebb.left-=offsetLeft,titlebb.right-=offsetLeft,titlebb.top-=offsetTop,titlebb.bottom-=offsetTop,avoid.selection.each(function(){var avoidbb=_$drawing_436.bBox(this);_$lib_539.bBoxIntersect(titlebb,avoidbb,pad)&&(shift=Math.max(shift,shiftSign*(avoidbb[avoid.side]-titlebb[backside])+pad))}),shift=Math.min(maxshift,shift)}if(shift>0||maxshift<0){var shiftTemplate={left:[-shift,0],right:[shift,0],top:[0,-shift],bottom:[0,shift]}[avoid.side];titleGroup.attr("transform","translate("+shiftTemplate+")")}}}el.call(titleLayout),editable&&(txt?el.on(".opacity",null):function setPlaceholder(){opacity=0,isplaceholder=!0,el.text(placeholder).on("mouseover.opacity",function(){_$d3_127.select(this).transition().duration(_$interactions_516.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){_$d3_127.select(this).transition().duration(_$interactions_516.HIDE_PLACEHOLDER).style("opacity",0)})}(),el.call(_$svg_text_utils_562.makeEditable,{gd:gd}).on("edit",function(text){void 0!==traceIndex?_$registry_668.call("restyle",gd,prop,text,traceIndex):_$registry_668.call("relayout",gd,prop,text)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(titleLayout)}).on("input",function(d){this.text(d||" ").call(_$svg_text_utils_562.positionText,attributes.x,attributes.y)}));return el.classed("js-placeholder",isplaceholder),group}},numStripRE=/ [XY][0-9]* /;var __FP_SAFE_583=_$numerical_517.FP_SAFE,_$autorange___getAutoRange=getAutoRange,_$autorange___makePadFn=makePadFn,_$autorange___doAutoRange=function doAutoRange(ax){ax._length||ax.setScale();var axIn,hasDeps=ax._min&&ax._max&&ax._min.length&&ax._max.length;ax.autorange&&hasDeps&&(ax.range=getAutoRange(ax),ax._r=ax.range.slice(),ax._rl=_$lib_539.simpleMap(ax._r,ax.r2l),(axIn=ax._input).range=ax.range.slice(),axIn.autorange=ax.autorange);if(ax._anchorAxis&&ax._anchorAxis.rangeslider){var axeRangeOpts=ax._anchorAxis.rangeslider[ax._name];axeRangeOpts&&"auto"===axeRangeOpts.rangemode&&(axeRangeOpts.range=hasDeps?getAutoRange(ax):ax._rangeInitial?ax._rangeInitial.slice():ax.range.slice()),(axIn=ax._anchorAxis._input).rangeslider[ax._name]=_$lib_539.extendFlat({},axeRangeOpts)}},_$autorange___expand=function expand(ax,data,options){if(!function needsAutorange(ax){return ax.autorange||ax._rangesliderAutorange}(ax)||!data)return;ax._min||(ax._min=[]);ax._max||(ax._max=[]);options||(options={});ax._m||ax.setScale();var i,j,k,v,di,dmin,dmax,ppadiplus,ppadiminus,includeThis,vmin,vmax,len=data.length,extrapad=options.padded||!1,tozero=options.tozero&&("linear"===ax.type||"-"===ax.type),isLog="log"===ax.type,hasArrayOption=!1;function makePadAccessor(item){if(Array.isArray(item))return hasArrayOption=!0,function(i){return Math.max(Number(item[i]||0),0)};var v=Math.max(Number(item||0),0);return function(){return v}}var ppadplus=makePadAccessor((ax._m>0?options.ppadplus:options.ppadminus)||options.ppad||0),ppadminus=makePadAccessor((ax._m>0?options.ppadminus:options.ppadplus)||options.ppad||0),vpadplus=makePadAccessor(options.vpadplus||options.vpad),vpadminus=makePadAccessor(options.vpadminus||options.vpad);if(!hasArrayOption){if(vmin=1/0,vmax=-1/0,isLog)for(i=0;i<len;i++)(v=data[i])<vmin&&v>0&&(vmin=v),v>vmax&&v<__FP_SAFE_583&&(vmax=v);else for(i=0;i<len;i++)(v=data[i])<vmin&&v>-__FP_SAFE_583&&(vmin=v),v>vmax&&v<__FP_SAFE_583&&(vmax=v);data=[vmin,vmax],len=2}function addItem(i){if(di=data[i],_$fastIsnumeric_139(di))for(ppadiplus=ppadplus(i),ppadiminus=ppadminus(i),vmin=di-vpadminus(i),vmax=di+vpadplus(i),isLog&&vmin<vmax/10&&(vmin=vmax/10),dmin=ax.c2l(vmin),dmax=ax.c2l(vmax),tozero&&(dmin=Math.min(0,dmin),dmax=Math.max(0,dmax)),k=0;k<2;k++){var newVal=k?dmax:dmin;if(goodNumber(newVal)){var extremes=k?ax._max:ax._min,newPad=k?ppadiplus:ppadiminus,atLeastAsExtreme=k?__greaterOrEqual_583:__lessOrEqual_583;for(includeThis=!0,j=0;j<extremes.length&&includeThis;j++){if(v=extremes[j],atLeastAsExtreme(v.val,newVal)&&v.pad>=newPad&&(v.extrapad||!extrapad)){includeThis=!1;break}atLeastAsExtreme(newVal,v.val)&&v.pad<=newPad&&(extrapad||!v.extrapad)&&(extremes.splice(j,1),j--)}if(includeThis){var clipAtZero=tozero&&0===newVal;extremes.push({val:newVal,pad:clipAtZero?0:newPad,extrapad:!clipAtZero&&extrapad})}}}}var iMax=Math.min(6,len);for(i=0;i<iMax;i++)addItem(i);for(i=len-1;i>=iMax;i--)addItem(i)};function getAutoRange(ax){var i,j,minpt,maxpt,minbest,maxbest,dp,dv,newRange=[],minmin=ax._min[0].val,maxmax=ax._max[0].val,mbest=0,axReverse=!1,getPad=makePadFn(ax);for(i=1;i<ax._min.length&&minmin===maxmax;i++)minmin=Math.min(minmin,ax._min[i].val);for(i=1;i<ax._max.length&&minmin===maxmax;i++)maxmax=Math.max(maxmax,ax._max[i].val);if(ax.range){var rng=_$lib_539.simpleMap(ax.range,ax.r2l);axReverse=rng[1]<rng[0]}for("reversed"===ax.autorange&&(axReverse=!0,ax.autorange=!0),i=0;i<ax._min.length;i++)for(minpt=ax._min[i],j=0;j<ax._max.length;j++)dv=(maxpt=ax._max[j]).val-minpt.val,dp=ax._length-getPad(minpt)-getPad(maxpt),dv>0&&dp>0&&dv/dp>mbest&&(minbest=minpt,maxbest=maxpt,mbest=dv/dp);if(minmin===maxmax){var lower=minmin-1,upper=minmin+1;newRange="tozero"===ax.rangemode?minmin<0?[lower,0]:[0,upper]:"nonnegative"===ax.rangemode?[Math.max(0,lower),Math.max(0,upper)]:[lower,upper]}else mbest&&("linear"!==ax.type&&"-"!==ax.type||("tozero"===ax.rangemode?(minbest.val>=0&&(minbest={val:0,pad:0}),maxbest.val<=0&&(maxbest={val:0,pad:0})):"nonnegative"===ax.rangemode&&(minbest.val-mbest*getPad(minbest)<0&&(minbest={val:0,pad:0}),maxbest.val<0&&(maxbest={val:1,pad:0})),mbest=(maxbest.val-minbest.val)/(ax._length-getPad(minbest)-getPad(maxbest))),newRange=[minbest.val-mbest*getPad(minbest),maxbest.val+mbest*getPad(maxbest)]);return newRange[0]===newRange[1]&&("tozero"===ax.rangemode?newRange=newRange[0]<0?[newRange[0],0]:newRange[0]>0?[0,newRange[0]]:[0,1]:(newRange=[newRange[0]-1,newRange[0]+1],"nonnegative"===ax.rangemode&&(newRange[0]=Math.max(0,newRange[0])))),axReverse&&newRange.reverse(),_$lib_539.simpleMap(newRange,ax.l2r||Number)}function makePadFn(ax){var extrappad=ax._length/20;return"domain"===ax.constrain&&ax._inputDomain&&(extrappad*=(ax._inputDomain[1]-ax._inputDomain[0])/(ax.domain[1]-ax.domain[0])),function getPad(pt){return pt.pad+(pt.extrapad?extrappad:0)}}function goodNumber(v){return _$fastIsnumeric_139(v)&&Math.abs(v)<__FP_SAFE_583}function __lessOrEqual_583(v0,v1){return v0<=v1}function __greaterOrEqual_583(v0,v1){return v0>=v1}var __BADNUM_585=_$numerical_517.BADNUM,_$autoType_585=function autoType(array,calendar){return function moreDates(a,calendar){for(var ai,dcnt=0,ncnt=0,inc=Math.max(1,(a.length-1)/1e3),i=0;i<a.length;i+=inc)ai=a[Math.round(i)],_$lib_539.isDateTime(ai,calendar)&&(dcnt+=1),_$fastIsnumeric_139(ai)&&(ncnt+=1);return dcnt>2*ncnt}(array,calendar)?"date":function category(a){for(var ai,inc=Math.max(1,(a.length-1)/1e3),curvenums=0,curvecats=0,i=0;i<a.length;i+=inc)ai=a[Math.round(i)],_$lib_539.cleanNumber(ai)!==__BADNUM_585?curvenums++:"string"==typeof ai&&""!==ai&&"None"!==ai&&curvecats++;return curvecats>2*curvenums}(array)?"category":function linearOK(array){if(!array)return!1;for(var i=0;i<array.length;i++)if(_$fastIsnumeric_139(array[i]))return!0;return!1}(array)?"linear":"-"};var cleanNumber=_$lib_539.cleanNumber,ms2DateTime=_$lib_539.ms2DateTime,dateTime2ms=_$lib_539.dateTime2ms,ensureNumber=_$lib_539.ensureNumber,__FP_SAFE_603=_$numerical_517.FP_SAFE,__BADNUM_603=_$numerical_517.BADNUM;function fromLog(v){return Math.pow(10,v)}var _$setConvert_603=function setConvert(ax,fullLayout){fullLayout=fullLayout||{};var axLetter=(ax._id||"x").charAt(0),clipMult=10;function toLog(v,clip){if(v>0)return Math.log(v)/Math.LN10;if(v<=0&&clip&&ax.range&&2===ax.range.length){var r0=ax.range[0],r1=ax.range[1];return.5*(r0+r1-3*clipMult*Math.abs(r0-r1))}return __BADNUM_603}function dt2ms(v,_,calendar){var ms=dateTime2ms(v,calendar||ax.calendar);if(ms===__BADNUM_603){if(!_$fastIsnumeric_139(v))return __BADNUM_603;ms=dateTime2ms(new Date(+v))}return ms}function ms2dt(v,r,calendar){return ms2DateTime(v,r,calendar||ax.calendar)}function getCategoryName(v){return ax._categories[Math.round(v)]}function getCategoryIndex(v){if(ax._categoriesMap){var index=ax._categoriesMap[v];if(void 0!==index)return index}if(_$fastIsnumeric_139(v))return+v}function l2p(v){return _$fastIsnumeric_139(v)?_$d3_127.round(ax._b+ax._m*v,2):__BADNUM_603}function p2l(px){return(px-ax._b)/ax._m}ax.c2l="log"===ax.type?toLog:ensureNumber,ax.l2c="log"===ax.type?fromLog:ensureNumber,ax.l2p=l2p,ax.p2l=p2l,ax.c2p="log"===ax.type?function(v,clip){return l2p(toLog(v,clip))}:l2p,ax.p2c="log"===ax.type?function(px){return fromLog(p2l(px))}:p2l,-1!==["linear","-"].indexOf(ax.type)?(ax.d2r=ax.r2d=ax.d2c=ax.r2c=ax.d2l=ax.r2l=cleanNumber,ax.c2d=ax.c2r=ax.l2d=ax.l2r=ensureNumber,ax.d2p=ax.r2p=function(v){return ax.l2p(cleanNumber(v))},ax.p2d=ax.p2r=p2l,ax.cleanPos=ensureNumber):"log"===ax.type?(ax.d2r=ax.d2l=function(v,clip){return toLog(cleanNumber(v),clip)},ax.r2d=ax.r2c=function(v){return fromLog(cleanNumber(v))},ax.d2c=ax.r2l=cleanNumber,ax.c2d=ax.l2r=ensureNumber,ax.c2r=toLog,ax.l2d=fromLog,ax.d2p=function(v,clip){return ax.l2p(ax.d2r(v,clip))},ax.p2d=function(px){return fromLog(p2l(px))},ax.r2p=function(v){return ax.l2p(cleanNumber(v))},ax.p2r=p2l,ax.cleanPos=ensureNumber):"date"===ax.type?(ax.d2r=ax.r2d=_$lib_539.identity,ax.d2c=ax.r2c=ax.d2l=ax.r2l=dt2ms,ax.c2d=ax.c2r=ax.l2d=ax.l2r=ms2dt,ax.d2p=ax.r2p=function(v,_,calendar){return ax.l2p(dt2ms(v,0,calendar))},ax.p2d=ax.p2r=function(px,r,calendar){return ms2dt(p2l(px),r,calendar)},ax.cleanPos=function(v){return _$lib_539.cleanDate(v,__BADNUM_603,ax.calendar)}):"category"===ax.type&&(ax.d2c=ax.d2l=function setCategoryIndex(v){if(null!==v&&void 0!==v){if(void 0===ax._categoriesMap&&(ax._categoriesMap={}),void 0!==ax._categoriesMap[v])return ax._categoriesMap[v];ax._categories.push(v);var curLength=ax._categories.length-1;return ax._categoriesMap[v]=curLength,curLength}return __BADNUM_603},ax.r2d=ax.c2d=ax.l2d=getCategoryName,ax.d2r=ax.d2l_noadd=getCategoryIndex,ax.r2c=function(v){var index=getCategoryIndex(v);return void 0!==index?index:ax.fraction2r(.5)},ax.l2r=ax.c2r=ensureNumber,ax.r2l=getCategoryIndex,ax.d2p=function(v){return ax.l2p(ax.r2c(v))},ax.p2d=function(px){return getCategoryName(p2l(px))},ax.r2p=ax.d2p,ax.p2r=p2l,ax.cleanPos=function(v){return"string"==typeof v&&""!==v?v:ensureNumber(v)}),ax.fraction2r=function(v){var rl0=ax.r2l(ax.range[0]),rl1=ax.r2l(ax.range[1]);return ax.l2r(rl0+v*(rl1-rl0))},ax.r2fraction=function(v){var rl0=ax.r2l(ax.range[0]),rl1=ax.r2l(ax.range[1]);return(ax.r2l(v)-rl0)/(rl1-rl0)},ax.cleanRange=function(rangeAttr,opts){opts||(opts={}),rangeAttr||(rangeAttr="range");var i,dflt,range=_$lib_539.nestedProperty(ax,rangeAttr).get();if(dflt=(dflt="date"===ax.type?_$lib_539.dfltRange(ax.calendar):"y"===axLetter?_$constants_589.DFLTRANGEY:opts.dfltRange||_$constants_589.DFLTRANGEX).slice(),range&&2===range.length)for("date"===ax.type&&(range[0]=_$lib_539.cleanDate(range[0],__BADNUM_603,ax.calendar),range[1]=_$lib_539.cleanDate(range[1],__BADNUM_603,ax.calendar)),i=0;i<2;i++)if("date"===ax.type){if(!_$lib_539.isDateTime(range[i],ax.calendar)){ax[rangeAttr]=dflt;break}if(ax.r2l(range[0])===ax.r2l(range[1])){var linCenter=_$lib_539.constrain(ax.r2l(range[0]),_$lib_539.MIN_MS+1e3,_$lib_539.MAX_MS-1e3);range[0]=ax.l2r(linCenter-1e3),range[1]=ax.l2r(linCenter+1e3);break}}else{if(!_$fastIsnumeric_139(range[i])){if(!_$fastIsnumeric_139(range[1-i])){ax[rangeAttr]=dflt;break}range[i]=range[1-i]*(i?10:.1)}if(range[i]<-__FP_SAFE_603?range[i]=-__FP_SAFE_603:range[i]>__FP_SAFE_603&&(range[i]=__FP_SAFE_603),range[0]===range[1]){var inc=Math.max(1,Math.abs(1e-6*range[0]));range[0]-=inc,range[1]+=inc}}else _$lib_539.nestedProperty(ax,rangeAttr).set(dflt)},ax.setScale=function(usePrivateRange){var gs=fullLayout._size;if(ax._categories||(ax._categories=[]),ax._categoriesMap||(ax._categoriesMap={}),ax.overlaying){var ax2=_$axis_ids_587.getFromId({_fullLayout:fullLayout},ax.overlaying);ax.domain=ax2.domain}var rangeAttr=usePrivateRange&&ax._r?"_r":"range",calendar=ax.calendar;ax.cleanRange(rangeAttr);var rl0=ax.r2l(ax[rangeAttr][0],calendar),rl1=ax.r2l(ax[rangeAttr][1],calendar);if("y"===axLetter?(ax._offset=gs.t+(1-ax.domain[1])*gs.h,ax._length=gs.h*(ax.domain[1]-ax.domain[0]),ax._m=ax._length/(rl0-rl1),ax._b=-ax._m*rl1):(ax._offset=gs.l+ax.domain[0]*gs.w,ax._length=gs.w*(ax.domain[1]-ax.domain[0]),ax._m=ax._length/(rl1-rl0),ax._b=-ax._m*rl0),!isFinite(ax._m)||!isFinite(ax._b))throw fullLayout._replotting=!1,new Error("Something went wrong with axis scaling")},ax.makeCalcdata=function(trace,axLetter){var arrayIn,arrayOut,i,len,axType=ax.type,cal="date"===axType&&trace[axLetter+"calendar"];if(axLetter in trace){if(arrayIn=trace[axLetter],len=trace._length||arrayIn.length,_$lib_539.isTypedArray(arrayIn)&&("linear"===axType||"log"===axType)){if(len===arrayIn.length)return arrayIn;if(arrayIn.subarray)return arrayIn.subarray(0,len)}for(arrayOut=new Array(len),i=0;i<len;i++)arrayOut[i]=ax.d2c(arrayIn[i],0,cal)}else{var v0=axLetter+"0"in trace?ax.d2c(trace[axLetter+"0"],0,cal):0,dv=trace["d"+axLetter]?Number(trace["d"+axLetter]):1;for(arrayIn=trace[{x:"y",y:"x"}[axLetter]],len=trace._length||arrayIn.length,arrayOut=new Array(len),i=0;i<len;i++)arrayOut[i]=v0+i*dv}return arrayOut},ax.isValidRange=function(range){return Array.isArray(range)&&2===range.length&&_$fastIsnumeric_139(ax.r2l(range[0]))&&_$fastIsnumeric_139(ax.r2l(range[1]))},ax.isPtWithinRange=function(d,calendar){var coord=ax.c2l(d[axLetter],null,calendar);return coord>=ax.r2l(ax.range[0])&&coord<=ax.r2l(ax.range[1])},ax.clearCalc=function(){ax._min=[],ax._max=[],ax._categories=(ax._initialCategories||[]).slice(),ax._categoriesMap={};for(var j=0;j<ax._categories.length;j++)ax._categoriesMap[ax._categories[j]]=j};var locale=fullLayout._d3locale;"date"===ax.type&&(ax._dateFormat=locale?locale.timeFormat.utc:_$d3_127.time.format.utc,ax._extraFormat=fullLayout._extraFormat),ax._separators=fullLayout.separators,ax._numFormat=locale?locale.numberFormat:_$d3_127.format,delete ax._minDtick,delete ax._forceTick0},_$axes_584={},ONEAVGYEAR=_$numerical_517.ONEAVGYEAR,ONEAVGMONTH=_$numerical_517.ONEAVGMONTH,__ONEDAY_584=_$numerical_517.ONEDAY,__ONEHOUR_584=_$numerical_517.ONEHOUR,__ONEMIN_584=_$numerical_517.ONEMIN,__ONESEC_584=_$numerical_517.ONESEC,MINUS_SIGN=_$numerical_517.MINUS_SIGN,__BADNUM_584=_$numerical_517.BADNUM,MID_SHIFT=_$alignment_511.MID_SHIFT,__LINE_SPACING_584=_$alignment_511.LINE_SPACING,axes=_$axes_584={};axes.setConvert=_$setConvert_603,axes.id2name=_$axis_ids_587.id2name,axes.name2id=_$axis_ids_587.name2id,axes.cleanId=_$axis_ids_587.cleanId,axes.list=_$axis_ids_587.list,axes.listIds=_$axis_ids_587.listIds,axes.getFromId=_$axis_ids_587.getFromId,axes.getFromTrace=_$axis_ids_587.getFromTrace,axes.expand=_$autorange___expand,axes.getAutoRange=_$autorange___getAutoRange,axes.coerceRef=function(containerIn,containerOut,gd,attr,dflt,extraOption){var axLetter=attr.charAt(attr.length-1),axlist=gd._fullLayout._subplots[axLetter+"axis"],refAttr=attr+"ref",attrDef={};return dflt||(dflt=axlist[0]||extraOption),extraOption||(extraOption=dflt),attrDef[refAttr]={valType:"enumerated",values:axlist.concat(extraOption?[extraOption]:[]),dflt:dflt},_$lib_539.coerce(containerIn,containerOut,attrDef,refAttr)},axes.coercePosition=function(containerOut,gd,coerce,axRef,attr,dflt){var cleanPos,pos;if("paper"===axRef||"pixel"===axRef)cleanPos=_$lib_539.ensureNumber,pos=coerce(attr,dflt);else{var ax=axes.getFromId(gd,axRef);pos=coerce(attr,dflt=ax.fraction2r(dflt)),cleanPos=ax.cleanPos}containerOut[attr]=cleanPos(pos)},axes.cleanPosition=function(pos,gd,axRef){return("paper"===axRef||"pixel"===axRef?_$lib_539.ensureNumber:axes.getFromId(gd,axRef).cleanPos)(pos)};var getDataConversions=axes.getDataConversions=function(gd,trace,target,targetArray){var ax,d2cTarget="x"===target||"y"===target||"z"===target?target:targetArray;if(Array.isArray(d2cTarget)){if(ax={type:_$autoType_585(targetArray),_categories:[]},axes.setConvert(ax),"category"===ax.type)for(var i=0;i<targetArray.length;i++)ax.d2c(targetArray[i])}else ax=axes.getFromTrace(gd,trace,d2cTarget);return ax?{d2c:ax.d2c,c2d:ax.c2d}:"ids"===d2cTarget?{d2c:toString,c2d:toString}:{d2c:toNum,c2d:toNum}};function toNum(v){return+v}function toString(v){return String(v)}axes.getDataToCoordFunc=function(gd,trace,target,targetArray){return getDataConversions(gd,trace,target,targetArray).d2c},axes.counterLetter=function(id){var axLetter=id.charAt(0);return"x"===axLetter?"y":"y"===axLetter?"x":void 0},axes.minDtick=function(ax,newDiff,newFirst,allow){-1===["log","category"].indexOf(ax.type)&&allow?void 0===ax._minDtick?(ax._minDtick=newDiff,ax._forceTick0=newFirst):ax._minDtick&&((ax._minDtick/newDiff+1e-6)%1<2e-6&&((newFirst-ax._forceTick0)/newDiff%1+1.000001)%1<2e-6?(ax._minDtick=newDiff,ax._forceTick0=newFirst):((newDiff/ax._minDtick+1e-6)%1>2e-6||((newFirst-ax._forceTick0)/ax._minDtick%1+1.000001)%1>2e-6)&&(ax._minDtick=0)):ax._minDtick=0},axes.saveRangeInitial=function(gd,overwrite){for(var axList=axes.list(gd,"",!0),hasOneAxisChanged=!1,i=0;i<axList.length;i++){var ax=axList[i],isNew=void 0===ax._rangeInitial,hasChanged=isNew||!(ax.range[0]===ax._rangeInitial[0]&&ax.range[1]===ax._rangeInitial[1]);(isNew&&!1===ax.autorange||overwrite&&hasChanged)&&(ax._rangeInitial=ax.range.slice(),hasOneAxisChanged=!0)}return hasOneAxisChanged},axes.saveShowSpikeInitial=function(gd,overwrite){for(var axList=axes.list(gd,"",!0),hasOneAxisChanged=!1,allSpikesEnabled="on",i=0;i<axList.length;i++){var ax=axList[i],isNew=void 0===ax._showSpikeInitial,hasChanged=isNew||!(ax.showspikes===ax._showspikes);(isNew||overwrite&&hasChanged)&&(ax._showSpikeInitial=ax.showspikes,hasOneAxisChanged=!0),"on"!==allSpikesEnabled||ax.showspikes||(allSpikesEnabled="off")}return gd._fullLayout._cartesianSpikesEnabled=allSpikesEnabled,hasOneAxisChanged},axes.autoBin=function(data,ax,nbins,is2d,calendar){var size0,dummyAx,dataMin=_$lib_539.aggNums(Math.min,null,data),dataMax=_$lib_539.aggNums(Math.max,null,data);if(calendar||(calendar=ax.calendar),"category"===ax.type)return{start:dataMin-.5,end:dataMax+.5,size:1,_dataSpan:dataMax-dataMin};if(nbins)size0=(dataMax-dataMin)/nbins;else{var distinctData=_$lib_539.distinctVals(data),msexp=Math.pow(10,Math.floor(Math.log(distinctData.minDiff)/Math.LN10)),minSize=msexp*_$lib_539.roundUp(distinctData.minDiff/msexp,[.9,1.9,4.9,9.9],!0);size0=Math.max(minSize,2*_$lib_539.stdev(data)/Math.pow(data.length,is2d?.25:.4)),_$fastIsnumeric_139(size0)||(size0=1)}dummyAx="log"===ax.type?{type:"linear",range:[dataMin,dataMax]}:{type:ax.type,range:_$lib_539.simpleMap([dataMin,dataMax],ax.c2r,0,calendar),calendar:calendar},axes.setConvert(dummyAx),axes.autoTicks(dummyAx,size0);var binEnd,binStart=axes.tickIncrement(axes.tickFirst(dummyAx),dummyAx.dtick,"reverse",calendar);if("number"==typeof dummyAx.dtick)binEnd=(binStart=function autoShiftNumericBins(binStart,data,ax,dataMin,dataMax){var edgecount=0,midcount=0,intcount=0,blankCount=0;function nearEdge(v){return(1+100*(v-binStart)/ax.dtick)%100<2}for(var i=0;i<data.length;i++)data[i]%1==0?intcount++:_$fastIsnumeric_139(data[i])||blankCount++,nearEdge(data[i])&&edgecount++,nearEdge(data[i]+ax.dtick/2)&&midcount++;var dataCount=data.length-blankCount;if(intcount===dataCount&&"date"!==ax.type)ax.dtick<1?binStart=dataMin-.5*ax.dtick:(binStart-=.5)+ax.dtick<dataMin&&(binStart+=ax.dtick);else if(midcount<.1*dataCount&&(edgecount>.3*dataCount||nearEdge(dataMin)||nearEdge(dataMax))){var binshift=ax.dtick/2;binStart+=binStart+binshift<dataMin?binshift:-binshift}return binStart}(binStart,data,dummyAx,dataMin,dataMax))+(1+Math.floor((dataMax-binStart)/dummyAx.dtick))*dummyAx.dtick;else for("M"===dummyAx.dtick.charAt(0)&&(binStart=function autoShiftMonthBins(binStart,data,dtick,dataMin,calendar){var stats=_$lib_539.findExactDates(data,calendar);if(stats.exactDays>.8){var numMonths=Number(dtick.substr(1));stats.exactYears>.8&&numMonths%12==0?binStart=axes.tickIncrement(binStart,"M6","reverse")+1.5*__ONEDAY_584:stats.exactMonths>.8?binStart=axes.tickIncrement(binStart,"M1","reverse")+15.5*__ONEDAY_584:binStart-=__ONEDAY_584/2;var nextBinStart=axes.tickIncrement(binStart,dtick);if(nextBinStart<=dataMin)return nextBinStart}return binStart}(binStart,data,dummyAx.dtick,dataMin,calendar)),binEnd=binStart,0;binEnd<=dataMax;)binEnd=axes.tickIncrement(binEnd,dummyAx.dtick,!1,calendar),0;return{start:ax.c2r(binStart,0,calendar),end:ax.c2r(binEnd,0,calendar),size:dummyAx.dtick,_dataSpan:dataMax-dataMin}},axes.prepTicks=function(ax){var rng=_$lib_539.simpleMap(ax.range,ax.r2l);if("auto"===ax.tickmode||!ax.dtick){var minPx,nt=ax.nticks;nt||("category"===ax.type?(minPx=ax.tickfont?1.2*(ax.tickfont.size||12):15,nt=ax._length/minPx):(minPx="y"===ax._id.charAt(0)?40:80,nt=_$lib_539.constrain(ax._length/minPx,4,9)+1),"radialaxis"===ax._name&&(nt*=2)),"array"===ax.tickmode&&(nt*=100),axes.autoTicks(ax,Math.abs(rng[1]-rng[0])/nt),ax._minDtick>0&&ax.dtick<2*ax._minDtick&&(ax.dtick=ax._minDtick,ax.tick0=ax.l2r(ax._forceTick0))}ax.tick0||(ax.tick0="date"===ax.type?"2000-01-01":0),autoTickRound(ax)},axes.calcTicks=function calcTicks(ax){axes.prepTicks(ax);var rng=_$lib_539.simpleMap(ax.range,ax.r2l);if("array"===ax.tickmode)return function arrayTicks(ax){var vali,i,vals=ax.tickvals,text=ax.ticktext,ticksOut=new Array(vals.length),rng=_$lib_539.simpleMap(ax.range,ax.r2l),r0expanded=1.0001*rng[0]-1e-4*rng[1],r1expanded=1.0001*rng[1]-1e-4*rng[0],tickMin=Math.min(r0expanded,r1expanded),tickMax=Math.max(r0expanded,r1expanded),j=0;Array.isArray(text)||(text=[]);var tickVal2l="category"===ax.type?ax.d2l_noadd:ax.d2l;"log"===ax.type&&"L"!==String(ax.dtick).charAt(0)&&(ax.dtick="L"+Math.pow(10,Math.floor(Math.min(ax.range[0],ax.range[1]))-1));for(i=0;i<vals.length;i++)(vali=tickVal2l(vals[i]))>tickMin&&vali<tickMax&&(void 0===text[i]?ticksOut[j]=axes.tickText(ax,vali):ticksOut[j]=tickTextObj(ax,vali,String(text[i])),j++);j<vals.length&&ticksOut.splice(j,vals.length-j);return ticksOut}(ax);ax._tmin=axes.tickFirst(ax);var startTick=1.0001*rng[0]-1e-4*rng[1],endTick=1.0001*rng[1]-1e-4*rng[0],axrev=rng[1]<rng[0];if(ax._tmin<startTick!==axrev)return[];var vals=[];"category"===ax.type&&(endTick=axrev?Math.max(-.5,endTick):Math.min(ax._categories.length-.5,endTick));for(var xPrevious=null,maxTicks=Math.max(1e3,ax._length||0),x=ax._tmin;(axrev?x>=endTick:x<=endTick)&&!(vals.length>maxTicks||x===xPrevious);x=axes.tickIncrement(x,ax.dtick,axrev,ax.calendar))xPrevious=x,vals.push(x);"angular"===ax._id&&360===Math.abs(rng[1]-rng[0])&&vals.pop(),ax._tmax=vals[vals.length-1],ax._prevDateHead="",ax._inCalcTicks=!0;for(var ticksOut=new Array(vals.length),i=0;i<vals.length;i++)ticksOut[i]=axes.tickText(ax,vals[i]);return ax._inCalcTicks=!1,ticksOut};var roundBase10=[2,5,10],roundBase24=[1,2,3,6,12],roundBase60=[1,2,5,10,15,30],roundDays=[1,2,3,7,14],roundLog1=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],roundLog2=[-.301,0,.301,.699,1],roundAngles=[15,30,45,90,180];function roundDTick(roughDTick,base,roundingSet){return base*_$lib_539.roundUp(roughDTick/base,roundingSet)}function autoTickRound(ax){var dtick=ax.dtick;if(ax._tickexponent=0,_$fastIsnumeric_139(dtick)||"string"==typeof dtick||(dtick=1),"category"===ax.type&&(ax._tickround=null),"date"===ax.type){var tick0ms=ax.r2l(ax.tick0),tick0str=ax.l2r(tick0ms).replace(/(^-|i)/g,""),tick0len=tick0str.length;if("M"===String(dtick).charAt(0))tick0len>10||"01-01"!==tick0str.substr(5)?ax._tickround="d":ax._tickround=+dtick.substr(1)%12==0?"y":"m";else if(dtick>=__ONEDAY_584&&tick0len<=10||dtick>=15*__ONEDAY_584)ax._tickround="d";else if(dtick>=__ONEMIN_584&&tick0len<=16||dtick>=__ONEHOUR_584)ax._tickround="M";else if(dtick>=__ONESEC_584&&tick0len<=19||dtick>=__ONEMIN_584)ax._tickround="S";else{var tick1len=ax.l2r(tick0ms+dtick).replace(/^-/,"").length;ax._tickround=Math.max(tick0len,tick1len)-20}}else if(_$fastIsnumeric_139(dtick)||"L"===dtick.charAt(0)){var rng=ax.range.map(ax.r2d||Number);_$fastIsnumeric_139(dtick)||(dtick=Number(dtick.substr(1))),ax._tickround=2-Math.floor(Math.log(dtick)/Math.LN10+.01);var maxend=Math.max(Math.abs(rng[0]),Math.abs(rng[1])),rangeexp=Math.floor(Math.log(maxend)/Math.LN10+.01);Math.abs(rangeexp)>3&&(isSIFormat(ax.exponentformat)&&!beyondSI(rangeexp)?ax._tickexponent=3*Math.round((rangeexp-1)/3):ax._tickexponent=rangeexp)}else ax._tickround=null}function tickTextObj(ax,x,text){var tf=ax.tickfont||{};return{x:x,dx:0,dy:0,text:text||"",fontSize:tf.size,font:tf.family,fontColor:tf.color}}axes.autoTicks=function(ax,roughDTick){var base;function getBase(v){return Math.pow(v,Math.floor(Math.log(roughDTick)/Math.LN10))}if("date"===ax.type){ax.tick0=_$lib_539.dateTick0(ax.calendar);var roughX2=2*roughDTick;roughX2>ONEAVGYEAR?(roughDTick/=ONEAVGYEAR,base=getBase(10),ax.dtick="M"+12*roundDTick(roughDTick,base,roundBase10)):roughX2>ONEAVGMONTH?(roughDTick/=ONEAVGMONTH,ax.dtick="M"+roundDTick(roughDTick,1,roundBase24)):roughX2>__ONEDAY_584?(ax.dtick=roundDTick(roughDTick,__ONEDAY_584,roundDays),ax.tick0=_$lib_539.dateTick0(ax.calendar,!0)):roughX2>__ONEHOUR_584?ax.dtick=roundDTick(roughDTick,__ONEHOUR_584,roundBase24):roughX2>__ONEMIN_584?ax.dtick=roundDTick(roughDTick,__ONEMIN_584,roundBase60):roughX2>__ONESEC_584?ax.dtick=roundDTick(roughDTick,__ONESEC_584,roundBase60):(base=getBase(10),ax.dtick=roundDTick(roughDTick,base,roundBase10))}else if("log"===ax.type){ax.tick0=0;var rng=_$lib_539.simpleMap(ax.range,ax.r2l);if(roughDTick>.7)ax.dtick=Math.ceil(roughDTick);else if(Math.abs(rng[1]-rng[0])<1){var nt=1.5*Math.abs((rng[1]-rng[0])/roughDTick);roughDTick=Math.abs(Math.pow(10,rng[1])-Math.pow(10,rng[0]))/nt,base=getBase(10),ax.dtick="L"+roundDTick(roughDTick,base,roundBase10)}else ax.dtick=roughDTick>.3?"D2":"D1"}else"category"===ax.type?(ax.tick0=0,ax.dtick=Math.ceil(Math.max(roughDTick,1))):"angular"===ax._id?(ax.tick0=0,base=1,ax.dtick=roundDTick(roughDTick,base,roundAngles)):(ax.tick0=0,base=getBase(10),ax.dtick=roundDTick(roughDTick,base,roundBase10));if(0===ax.dtick&&(ax.dtick=1),!_$fastIsnumeric_139(ax.dtick)&&"string"!=typeof ax.dtick){var olddtick=ax.dtick;throw ax.dtick=1,"ax.dtick error: "+String(olddtick)}},axes.tickIncrement=function(x,dtick,axrev,calendar){var axSign=axrev?-1:1;if(_$fastIsnumeric_139(dtick))return x+axSign*dtick;var tType=dtick.charAt(0),dtSigned=axSign*Number(dtick.substr(1));if("M"===tType)return _$lib_539.incrementMonth(x,dtSigned,calendar);if("L"===tType)return Math.log(Math.pow(10,x)+dtSigned)/Math.LN10;if("D"===tType){var tickset="D2"===dtick?roundLog2:roundLog1,x2=x+.01*axSign,frac=_$lib_539.roundUp(_$lib_539.mod(x2,1),tickset,axrev);return Math.floor(x2)+Math.log(_$d3_127.round(Math.pow(10,frac),1))/Math.LN10}throw"unrecognized dtick "+String(dtick)},axes.tickFirst=function(ax){var r2l=ax.r2l||Number,rng=_$lib_539.simpleMap(ax.range,r2l),axrev=rng[1]<rng[0],sRound=axrev?Math.floor:Math.ceil,r0=1.0001*rng[0]-1e-4*rng[1],dtick=ax.dtick,tick0=r2l(ax.tick0);if(_$fastIsnumeric_139(dtick)){var tmin=sRound((r0-tick0)/dtick)*dtick+tick0;return"category"===ax.type&&(tmin=_$lib_539.constrain(tmin,0,ax._categories.length-1)),tmin}var tType=dtick.charAt(0),dtNum=Number(dtick.substr(1));if("M"===tType){for(var t1,mult,newDTick,cnt=0,t0=tick0;cnt<10;){if(((t1=axes.tickIncrement(t0,dtick,axrev,ax.calendar))-r0)*(t0-r0)<=0)return axrev?Math.min(t0,t1):Math.max(t0,t1);mult=(r0-(t0+t1)/2)/(t1-t0),newDTick=tType+(Math.abs(Math.round(mult))||1)*dtNum,t0=axes.tickIncrement(t0,newDTick,mult<0?!axrev:axrev,ax.calendar),cnt++}return _$lib_539.error("tickFirst did not converge",ax),t0}if("L"===tType)return Math.log(sRound((Math.pow(10,r0)-tick0)/dtNum)*dtNum+tick0)/Math.LN10;if("D"===tType){var tickset="D2"===dtick?roundLog2:roundLog1,frac=_$lib_539.roundUp(_$lib_539.mod(r0,1),tickset,axrev);return Math.floor(r0)+Math.log(_$d3_127.round(Math.pow(10,frac),1))/Math.LN10}throw"unrecognized dtick "+String(dtick)},axes.tickText=function(ax,x,hover){var hideexp,i,out=tickTextObj(ax,x),arrayMode="array"===ax.tickmode,extraPrecision=hover||arrayMode,tickVal2l="category"===ax.type?ax.d2l_noadd:ax.d2l;if(arrayMode&&Array.isArray(ax.ticktext)){var rng=_$lib_539.simpleMap(ax.range,ax.r2l),minDiff=Math.abs(rng[1]-rng[0])/1e4;for(i=0;i<ax.ticktext.length&&!(Math.abs(x-tickVal2l(ax.tickvals[i]))<minDiff);i++);if(i<ax.ticktext.length)return out.text=String(ax.ticktext[i]),out}function isHidden(showAttr){var first_or_last;return void 0===showAttr||(hover?"none"===showAttr:(first_or_last={first:ax._tmin,last:ax._tmax}[showAttr],"all"!==showAttr&&x!==first_or_last))}return hideexp=hover?"never":"none"!==ax.exponentformat&&isHidden(ax.showexponent)?"hide":"","date"===ax.type?function formatDate(ax,out,hover,extraPrecision){var tr=ax._tickround,fmt=hover&&ax.hoverformat||axes.getTickFormat(ax);extraPrecision&&(tr=_$fastIsnumeric_139(tr)?4:{y:"m",m:"d",d:"M",M:"S",S:4}[tr]);var headStr,dateStr=_$lib_539.formatDate(out.x,fmt,tr,ax._dateFormat,ax.calendar,ax._extraFormat),splitIndex=dateStr.indexOf("\n");-1!==splitIndex&&(headStr=dateStr.substr(splitIndex+1),dateStr=dateStr.substr(0,splitIndex));extraPrecision&&("00:00:00"===dateStr||"00:00"===dateStr?(dateStr=headStr,headStr=""):8===dateStr.length&&(dateStr=dateStr.replace(/:00$/,"")));headStr&&(hover?"d"===tr?dateStr+=", "+headStr:dateStr=headStr+(dateStr?", "+dateStr:""):ax._inCalcTicks&&headStr===ax._prevDateHead||(dateStr+="<br>"+headStr,ax._prevDateHead=headStr));out.text=dateStr}(ax,out,hover,extraPrecision):"log"===ax.type?function formatLog(ax,out,hover,extraPrecision,hideexp){var dtick=ax.dtick,x=out.x,tickformat=ax.tickformat;"never"===hideexp&&(hideexp="");!extraPrecision||"string"==typeof dtick&&"L"===dtick.charAt(0)||(dtick="L3");if(tickformat||"string"==typeof dtick&&"L"===dtick.charAt(0))out.text=numFormat(Math.pow(10,x),ax,hideexp,extraPrecision);else if(_$fastIsnumeric_139(dtick)||"D"===dtick.charAt(0)&&_$lib_539.mod(x+.01,1)<.1){var p=Math.round(x);-1!==["e","E","power"].indexOf(ax.exponentformat)||isSIFormat(ax.exponentformat)&&beyondSI(p)?(out.text=0===p?1:1===p?"10":p>1?"10<sup>"+p+"</sup>":"10<sup>"+MINUS_SIGN+-p+"</sup>",out.fontSize*=1.25):(out.text=numFormat(Math.pow(10,x),ax,"","fakehover"),"D1"===dtick&&"y"===ax._id.charAt(0)&&(out.dy-=out.fontSize/6))}else{if("D"!==dtick.charAt(0))throw"unrecognized dtick "+String(dtick);out.text=String(Math.round(Math.pow(10,_$lib_539.mod(x,1)))),out.fontSize*=.75}if("D1"===ax.dtick){var firstChar=String(out.text).charAt(0);"0"!==firstChar&&"1"!==firstChar||("y"===ax._id.charAt(0)?out.dx-=out.fontSize/4:(out.dy+=out.fontSize/2,out.dx+=(ax.range[1]>ax.range[0]?1:-1)*out.fontSize*(x<0?.5:.25)))}}(ax,out,0,extraPrecision,hideexp):"category"===ax.type?function formatCategory(ax,out){var tt=ax._categories[Math.round(out.x)];void 0===tt&&(tt="");out.text=String(tt)}(ax,out):"angular"===ax._id?function formatAngle(ax,out,hover,extraPrecision,hideexp){if("radians"!==ax.thetaunit||hover)out.text=numFormat(out.x,ax,hideexp,extraPrecision);else{var num=out.x/180;if(0===num)out.text="0";else{var frac=function num2frac(num){function almostEq(a,b){return Math.abs(a-b)<=1e-6}var precision=function findPrecision(n){var e=1;for(;!almostEq(Math.round(n*e)/e,n);)e*=10;return e}(num),number=num*precision,gcd=Math.abs(function findGCD(a,b){return almostEq(b,0)?a:findGCD(b,a%b)}(number,precision));return[Math.round(number/gcd),Math.round(precision/gcd)]}(num);if(frac[1]>=100)out.text=numFormat(_$lib_539.deg2rad(out.x),ax,hideexp,extraPrecision);else{var isNeg=out.x<0;1===frac[1]?1===frac[0]?out.text="π":out.text=frac[0]+"π":out.text=["<sup>",frac[0],"</sup>","⁄","<sub>",frac[1],"</sub>","π"].join(""),isNeg&&(out.text=MINUS_SIGN+out.text)}}}}(ax,out,hover,extraPrecision,hideexp):function formatLinear(ax,out,hover,extraPrecision,hideexp){"never"===hideexp?hideexp="":"all"===ax.showexponent&&Math.abs(out.x/ax.dtick)<1e-6&&(hideexp="hide");out.text=numFormat(out.x,ax,hideexp,extraPrecision)}(ax,out,0,extraPrecision,hideexp),ax.tickprefix&&!isHidden(ax.showtickprefix)&&(out.text=ax.tickprefix+out.text),ax.ticksuffix&&!isHidden(ax.showticksuffix)&&(out.text+=ax.ticksuffix),out},axes.hoverLabelText=function(ax,val,val2){if(val2!==__BADNUM_584&&val2!==val)return axes.hoverLabelText(ax,val)+" - "+axes.hoverLabelText(ax,val2);var logOffScale="log"===ax.type&&val<=0,tx=axes.tickText(ax,ax.c2l(logOffScale?-val:val),"hover").text;return logOffScale?0===val?"0":MINUS_SIGN+tx:tx};var SIPREFIXES=["f","p","n","μ","m","","k","M","G","T"];function isSIFormat(exponentFormat){return"SI"===exponentFormat||"B"===exponentFormat}function beyondSI(exponent){return exponent>14||exponent<-15}function numFormat(v,ax,fmtoverride,hover){var isNeg=v<0,tickRound=ax._tickround,exponentFormat=fmtoverride||ax.exponentformat||"B",exponent=ax._tickexponent,tickformat=axes.getTickFormat(ax),separatethousands=ax.separatethousands;if(hover){var ah={exponentformat:exponentFormat,dtick:"none"===ax.showexponent?ax.dtick:_$fastIsnumeric_139(v)&&Math.abs(v)||1,range:"none"===ax.showexponent?ax.range.map(ax.r2d):[0,v||1]};autoTickRound(ah),tickRound=(Number(ah._tickround)||0)+4,exponent=ah._tickexponent,ax.hoverformat&&(tickformat=ax.hoverformat)}if(tickformat)return ax._numFormat(tickformat)(v).replace(/-/g,MINUS_SIGN);var signedExponent,e=Math.pow(10,-tickRound)/2;if("none"===exponentFormat&&(exponent=0),(v=Math.abs(v))<e)v="0",isNeg=!1;else{if(v+=e,exponent&&(v*=Math.pow(10,-exponent),tickRound+=exponent),0===tickRound)v=String(Math.floor(v));else if(tickRound<0){v=(v=String(Math.round(v))).substr(0,v.length+tickRound);for(var i=tickRound;i<0;i++)v+="0"}else{var dp=(v=String(v)).indexOf(".")+1;dp&&(v=v.substr(0,dp+tickRound).replace(/\.?0+$/,""))}v=_$lib_539.numSeparate(v,ax._separators,separatethousands)}exponent&&"hide"!==exponentFormat&&(isSIFormat(exponentFormat)&&beyondSI(exponent)&&(exponentFormat="power"),signedExponent=exponent<0?MINUS_SIGN+-exponent:"power"!==exponentFormat?"+"+exponent:String(exponent),"e"===exponentFormat?v+="e"+signedExponent:"E"===exponentFormat?v+="E"+signedExponent:"power"===exponentFormat?v+="×10<sup>"+signedExponent+"</sup>":"B"===exponentFormat&&9===exponent?v+="B":isSIFormat(exponentFormat)&&(v+=SIPREFIXES[exponent/3+5]));return isNeg?MINUS_SIGN+v:v}function mergeAxisGroups(intoSet,fromSet){for(var i=0;i<fromSet.length;i++)-1===intoSet.indexOf(fromSet[i])&&intoSet.push(fromSet[i])}function swapAxisGroup(gd,xIds,yIds){var i,j,xFullAxes=[],yFullAxes=[],layout=gd.layout;for(i=0;i<xIds.length;i++)xFullAxes.push(axes.getFromId(gd,xIds[i]));for(i=0;i<yIds.length;i++)yFullAxes.push(axes.getFromId(gd,yIds[i]));var allAxKeys=Object.keys(xFullAxes[0]),noSwapAttrs=["anchor","domain","overlaying","position","side","tickangle"],numericTypes=["linear","log"];for(i=0;i<allAxKeys.length;i++){var keyi=allAxKeys[i],xVal=xFullAxes[0][keyi],yVal=yFullAxes[0][keyi],allEqual=!0,coerceLinearX=!1,coerceLinearY=!1;if("_"!==keyi.charAt(0)&&"function"!=typeof xVal&&-1===noSwapAttrs.indexOf(keyi)){for(j=1;j<xFullAxes.length&&allEqual;j++){var xVali=xFullAxes[j][keyi];"type"===keyi&&-1!==numericTypes.indexOf(xVal)&&-1!==numericTypes.indexOf(xVali)&&xVal!==xVali?coerceLinearX=!0:xVali!==xVal&&(allEqual=!1)}for(j=1;j<yFullAxes.length&&allEqual;j++){var yVali=yFullAxes[j][keyi];"type"===keyi&&-1!==numericTypes.indexOf(yVal)&&-1!==numericTypes.indexOf(yVali)&&yVal!==yVali?coerceLinearY=!0:yFullAxes[j][keyi]!==yVal&&(allEqual=!1)}allEqual&&(coerceLinearX&&(layout[xFullAxes[0]._name].type="linear"),coerceLinearY&&(layout[yFullAxes[0]._name].type="linear"),swapAxisAttrs(layout,keyi,xFullAxes,yFullAxes,gd._fullLayout._dfltTitle))}}for(i=0;i<gd._fullLayout.annotations.length;i++){var ann=gd._fullLayout.annotations[i];-1!==xIds.indexOf(ann.xref)&&-1!==yIds.indexOf(ann.yref)&&_$lib_539.swapAttrs(layout.annotations[i],["?"])}}function swapAxisAttrs(layout,key,xFullAxes,yFullAxes,dfltTitle){var i,np=_$lib_539.nestedProperty,xVal=np(layout[xFullAxes[0]._name],key).get(),yVal=np(layout[yFullAxes[0]._name],key).get();for("title"===key&&(xVal===dfltTitle.x&&(xVal=dfltTitle.y),yVal===dfltTitle.y&&(yVal=dfltTitle.x)),i=0;i<xFullAxes.length;i++)np(layout,xFullAxes[i]._name+"."+key).set(yVal);for(i=0;i<yFullAxes.length;i++)np(layout,yFullAxes[i]._name+"."+key).set(xVal)}axes.getTickFormat=function(ax){var i,tickstop,dtick,range,convertFn,leftDtick,rightDtick;function convertToMs(dtick){return"string"!=typeof dtick?dtick:Number(dtick.replace("M",""))*ONEAVGMONTH}function compareLogTicks(left,right){var priority=["L","D"];if(typeof left==typeof right){if("number"==typeof left)return left-right;var leftPriority=priority.indexOf(left.charAt(0)),rightPriority=priority.indexOf(right.charAt(0));return leftPriority===rightPriority?Number(left.replace(/(L|D)/g,""))-Number(right.replace(/(L|D)/g,"")):leftPriority-rightPriority}return"number"==typeof left?1:-1}function isProperLogStop(dtick,range){var isLeftDtickNull=null===range[0],isRightDtickNull=null===range[1],isDtickInRangeLeft=compareLogTicks(dtick,range[0])>=0,isDtickInRangeRight=compareLogTicks(dtick,range[1])<=0;return(isLeftDtickNull||isDtickInRangeLeft)&&(isRightDtickNull||isDtickInRangeRight)}if(ax.tickformatstops&&ax.tickformatstops.length>0)switch(ax.type){case"date":case"linear":for(i=0;i<ax.tickformatstops.length;i++)if(dtick=ax.dtick,range=ax.tickformatstops[i].dtickrange,convertFn=void 0,void 0,void 0,convertFn=convertToMs||function(x){return x},leftDtick=range[0],rightDtick=range[1],(!leftDtick&&"number"!=typeof leftDtick||convertFn(leftDtick)<=convertFn(dtick))&&(!rightDtick&&"number"!=typeof rightDtick||convertFn(rightDtick)>=convertFn(dtick))){tickstop=ax.tickformatstops[i];break}break;case"log":for(i=0;i<ax.tickformatstops.length;i++)if(isProperLogStop(ax.dtick,ax.tickformatstops[i].dtickrange)){tickstop=ax.tickformatstops[i];break}}return tickstop?tickstop.value:ax.tickformat},axes.getSubplots=function(gd,ax){var subplotObj=gd._fullLayout._subplots,allSubplots=subplotObj.cartesian.concat(subplotObj.gl2d||[]),out=ax?axes.findSubplotsWithAxis(allSubplots,ax):allSubplots;return out.sort(function(a,b){var aParts=a.substr(1).split("y"),bParts=b.substr(1).split("y");return aParts[0]===bParts[0]?+aParts[1]-+bParts[1]:+aParts[0]-+bParts[0]}),out},axes.findSubplotsWithAxis=function(subplots,ax){for(var axMatch=new RegExp("x"===ax._id.charAt(0)?"^"+ax._id+"y":ax._id+"$"),subplotsWithAxis=[],i=0;i<subplots.length;i++){var sp=subplots[i];axMatch.test(sp)&&subplotsWithAxis.push(sp)}return subplotsWithAxis},axes.makeClipPaths=function(gd){var i,j,fullLayout=gd._fullLayout,fullWidth={_offset:0,_length:fullLayout.width,_id:""},fullHeight={_offset:0,_length:fullLayout.height,_id:""},xaList=axes.list(gd,"x",!0),yaList=axes.list(gd,"y",!0),clipList=[];for(i=0;i<xaList.length;i++)for(clipList.push({x:xaList[i],y:fullHeight}),j=0;j<yaList.length;j++)0===i&&clipList.push({x:fullWidth,y:yaList[j]}),clipList.push({x:xaList[i],y:yaList[j]});var axClips=fullLayout._clips.selectAll(".axesclip").data(clipList,function(d){return d.x._id+d.y._id});axClips.enter().append("clipPath").classed("axesclip",!0).attr("id",function(d){return"clip"+fullLayout._uid+d.x._id+d.y._id}).append("rect"),axClips.exit().remove(),axClips.each(function(d){_$d3_127.select(this).select("rect").attr({x:d.x._offset||0,y:d.y._offset||0,width:d.x._length||1,height:d.y._length||1})})},axes.doTicks=function(gd,axid,skipTitle){var ax,fullLayout=gd._fullLayout,independent=!1;if("object"==typeof axid)axid=(ax=axid)._id,independent=!0;else if(ax=axes.getFromId(gd,axid),"redraw"===axid&&fullLayout._paper.selectAll("g.subplot").each(function(subplot){var plotinfo=fullLayout._plots[subplot],xa=plotinfo.xaxis,ya=plotinfo.yaxis;plotinfo.xaxislayer.selectAll("."+xa._id+"tick").remove(),plotinfo.yaxislayer.selectAll("."+ya._id+"tick").remove(),plotinfo.gridlayer.selectAll("path").remove(),plotinfo.zerolinelayer.selectAll("path").remove(),fullLayout._infolayer.select(".g-"+xa._id+"title").remove(),fullLayout._infolayer.select(".g-"+ya._id+"title").remove()}),!axid||"redraw"===axid)return _$lib_539.syncOrAsync(axes.list(gd,"",!0).map(function(ax){return function(){if(ax._id){var axDone=axes.doTicks(gd,ax._id);return"redraw"===axid&&(ax._r=ax.range.slice(),ax._rl=_$lib_539.simpleMap(ax._r,ax.r2l)),axDone}}}));ax.setScale();var sides,transfn,tickpathfn,subplots,i,axLetter=axid.charAt(0),counterLetter=axes.counterLetter(axid),vals=axes.calcTicks(ax),datafn=function(d){return[d.text,d.x,ax.mirror,d.font,d.fontSize,d.fontColor].join("_")},tcls=axid+"tick",gcls=axid+"grid",zcls=axid+"zl",pad=(ax.linewidth||1)/2,labelStandoff="outside"===ax.ticks?ax.ticklen:0,labelShift=0,gridWidth=_$drawing_436.crispRound(gd,ax.gridwidth,1),zeroLineWidth=_$drawing_436.crispRound(gd,ax.zerolinewidth,gridWidth),tickWidth=_$drawing_436.crispRound(gd,ax.tickwidth,1);if(ax._counterangle&&"outside"===ax.ticks){var caRad=ax._counterangle*Math.PI/180;labelStandoff=ax.ticklen*Math.cos(caRad)+1,labelShift=ax.ticklen*Math.sin(caRad)}if(ax.showticklabels&&("outside"===ax.ticks||ax.showline)&&(labelStandoff+=.2*ax.tickfont.size),"x"===axLetter)sides=["bottom","top"],transfn=ax._transfn||function(d){return"translate("+(ax._offset+ax.l2p(d.x))+",0)"},tickpathfn=function(shift,len){if(ax._counterangle){var caRad=ax._counterangle*Math.PI/180;return"M0,"+shift+"l"+Math.sin(caRad)*len+","+Math.cos(caRad)*len}return"M0,"+shift+"v"+len};else if("y"===axLetter)sides=["left","right"],transfn=ax._transfn||function(d){return"translate(0,"+(ax._offset+ax.l2p(d.x))+")"},tickpathfn=function(shift,len){if(ax._counterangle){var caRad=ax._counterangle*Math.PI/180;return"M"+shift+",0l"+Math.cos(caRad)*len+","+-Math.sin(caRad)*len}return"M"+shift+",0h"+len};else{if("angular"!==axid)return void _$lib_539.warn("Unrecognized doTicks axis:",axid);sides=["left","right"],transfn=ax._transfn,tickpathfn=function(shift,len){return"M"+shift+",0h"+len}}var axside=ax.side||sides[0],ticksign=[-1,1,axside===sides[1]?1:-1];if("inside"!==ax.ticks==("x"===axLetter)&&(ticksign=ticksign.map(function(v){return-v})),ax.visible){ax._tickFilter&&(vals=vals.filter(ax._tickFilter));var valsClipped=vals.filter(clipEnds);if("angular"===ax._id&&(valsClipped=vals),independent){if(drawTicks(ax._axislayer,tickpathfn(ax._pos+pad*ticksign[2],ticksign[2]*ax.ticklen)),ax._counteraxis)drawGrid({gridlayer:ax._gridlayer,zerolinelayer:ax._zerolinelayer},ax._counteraxis);return drawLabels(ax._axislayer,ax._pos)}if(fullLayout._has("cartesian")){var finishedGrids={};(subplots=axes.getSubplots(gd,ax)).map(function(subplot){var plotinfo=fullLayout._plots[subplot],counterAxis=plotinfo[counterLetter+"axis"],mainCounterID=counterAxis._mainAxis._id;finishedGrids[mainCounterID]||(finishedGrids[mainCounterID]=1,drawGrid(plotinfo,counterAxis,subplot))});var mainSubplot=ax._mainSubplot,mainPlotinfo=fullLayout._plots[mainSubplot],tickSubplots=[];if(ax.ticks){var mainSign=ticksign[2],tickpath=tickpathfn(ax._mainLinePosition+pad*mainSign,mainSign*ax.ticklen);ax._anchorAxis&&ax.mirror&&!0!==ax.mirror&&(tickpath+=tickpathfn(ax._mainMirrorPosition-pad*mainSign,-mainSign*ax.ticklen)),drawTicks(mainPlotinfo[axLetter+"axislayer"],tickpath),tickSubplots=Object.keys(ax._linepositions)}return tickSubplots.map(function(subplot){var container=fullLayout._plots[subplot][axLetter+"axislayer"],linepositions=ax._linepositions[subplot]||[];function tickPathSide(sidei){var tsign=ticksign[sidei];return tickpathfn(linepositions[sidei]+pad*tsign,tsign*ax.ticklen)}drawTicks(container,tickPathSide(0)+tickPathSide(1))}),drawLabels(mainPlotinfo[axLetter+"axislayer"],ax._mainLinePosition)}}function clipEnds(d){var p=ax.l2p(d.x);return p>1&&p<ax._length-1}function drawTicks(container,tickpath){var ticks=container.selectAll("path."+tcls).data("inside"===ax.ticks?valsClipped:vals,datafn);tickpath&&ax.ticks?(ticks.enter().append("path").classed(tcls,1).classed("ticks",1).classed("crisp",1).call(_$color_411.stroke,ax.tickcolor).style("stroke-width",tickWidth+"px").attr("d",tickpath),ticks.attr("transform",transfn),ticks.exit().remove()):ticks.remove()}function drawLabels(container,position){var labelx,labely,labelanchor,labelpos0,flipit,tickLabels=container.selectAll("g."+tcls).data(vals,datafn);if(!_$fastIsnumeric_139(position))return tickLabels.remove(),void drawAxTitle();if(!ax.showticklabels)return tickLabels.remove(),drawAxTitle(),void calcBoundingBox();"x"===axLetter?(labelx=function(d){return d.dx+labelShift*flipit},labelpos0=position+(labelStandoff+pad)*(flipit="bottom"===axside?1:-1),labely=function(d){return d.dy+labelpos0+d.fontSize*("bottom"===axside?1:-.2)},labelanchor=function(angle){return _$fastIsnumeric_139(angle)&&0!==angle&&180!==angle?angle*flipit<0?"end":"start":"middle"}):"y"===axLetter?(flipit="right"===axside?1:-1,labely=function(d){return d.dy+d.fontSize*MID_SHIFT-labelShift*flipit},labelx=function(d){return d.dx+position+(labelStandoff+pad+(90===Math.abs(ax.tickangle)?d.fontSize/2:0))*flipit},labelanchor=function(angle){return _$fastIsnumeric_139(angle)&&90===Math.abs(angle)?"middle":"right"===axside?"start":"end"}):"angular"===axid&&(ax._labelShift=labelShift,ax._labelStandoff=labelStandoff,ax._pad=pad,labelx=ax._labelx,labely=ax._labely,labelanchor=ax._labelanchor);var maxFontSize=0,autoangle=0,labelsReady=[];function positionLabels(s,angle){s.each(function(d){var anchor=labelanchor(angle,d),thisLabel=_$d3_127.select(this),mathjaxGroup=thisLabel.select(".text-math-group"),transform=transfn.call(thisLabel.node(),d)+(_$fastIsnumeric_139(angle)&&0!=+angle?" rotate("+angle+","+labelx(d)+","+(labely(d)-d.fontSize/2)+")":""),anchorHeight=function getAnchorHeight(lineCount,lineHeight,angle){var h=(lineCount-1)*lineHeight;if("x"===axLetter){if(angle<-60||60<angle)return-.5*h;if("top"===axside)return-h}else{if((angle*="left"===axside?1:-1)<-30)return-h;if(angle<30)return-.5*h}return 0}(_$svg_text_utils_562.lineCount(thisLabel),__LINE_SPACING_584*d.fontSize,_$fastIsnumeric_139(angle)?+angle:0);if(anchorHeight&&(transform+=" translate(0, "+anchorHeight+")"),mathjaxGroup.empty())thisLabel.select("text").attr({transform:transform,"text-anchor":anchor});else{var mjShift=_$drawing_436.bBox(mathjaxGroup.node()).width*{end:-.5,start:.5}[anchor];mathjaxGroup.attr("transform",transform+(mjShift?"translate("+mjShift+",0)":""))}})}function calcBoundingBox(){if(ax.showticklabels){var gdBB=gd.getBoundingClientRect(),bBox=container.node().getBoundingClientRect();ax._boundingBox={width:bBox.width,height:bBox.height,left:bBox.left-gdBB.left,right:bBox.right-gdBB.left,top:bBox.top-gdBB.top,bottom:bBox.bottom-gdBB.top}}else{var pos,gs=fullLayout._size;"x"===axLetter?(pos="free"===ax.anchor?gs.t+gs.h*(1-ax.position):gs.t+gs.h*(1-ax._anchorAxis.domain[{bottom:0,top:1}[ax.side]]),ax._boundingBox={top:pos,bottom:pos,left:ax._offset,right:ax._offset+ax._length,width:ax._length,height:0}):(pos="free"===ax.anchor?gs.l+gs.w*ax.position:gs.l+gs.w*ax._anchorAxis.domain[{left:0,right:1}[ax.side]],ax._boundingBox={left:pos,right:pos,bottom:ax._offset+ax._length,top:ax._offset,height:ax._length,width:0})}if(subplots){var fullRange=ax._counterSpan=[1/0,-1/0];for(i=0;i<subplots.length;i++){var counterAxis=fullLayout._plots[subplots[i]]["x"===axLetter?"yaxis":"xaxis"];extendRange(fullRange,[counterAxis._offset,counterAxis._offset+counterAxis._length])}"free"===ax.anchor&&extendRange(fullRange,"x"===axLetter?[ax._boundingBox.bottom,ax._boundingBox.top]:[ax._boundingBox.right,ax._boundingBox.left])}function extendRange(range,newRange){range[0]=Math.min(range[0],newRange[0]),range[1]=Math.max(range[1],newRange[1])}}tickLabels.enter().append("g").classed(tcls,1).append("text").attr("text-anchor","middle").each(function(d){var thisLabel=_$d3_127.select(this),newPromise=gd._promises.length;thisLabel.call(_$svg_text_utils_562.positionText,labelx(d),labely(d)).call(_$drawing_436.font,d.font,d.fontSize,d.fontColor).text(d.text).call(_$svg_text_utils_562.convertToTspans,gd),(newPromise=gd._promises[newPromise])?labelsReady.push(gd._promises.pop().then(function(){positionLabels(thisLabel,ax.tickangle)})):positionLabels(thisLabel,ax.tickangle)}),tickLabels.exit().remove(),tickLabels.each(function(d){maxFontSize=Math.max(maxFontSize,d.fontSize)}),"angular"===axid&&tickLabels.each(function(d){_$d3_127.select(this).select("text").call(_$svg_text_utils_562.positionText,labelx(d),labely(d))}),positionLabels(tickLabels,ax._lastangle||ax.tickangle);var done=_$lib_539.syncOrAsync([function allLabelsReady(){return labelsReady.length&&Promise.all(labelsReady)},function fixLabelOverlaps(){if(positionLabels(tickLabels,ax.tickangle),"x"===axLetter&&!_$fastIsnumeric_139(ax.tickangle)&&("log"!==ax.type||"D"!==String(ax.dtick).charAt(0))){var lbbArray=[];for(tickLabels.each(function(d){var s=_$d3_127.select(this),thisLabel=s.select(".text-math-group"),x=ax.l2p(d.x);thisLabel.empty()&&(thisLabel=s.select("text"));var bb=_$drawing_436.bBox(thisLabel.node());lbbArray.push({top:0,bottom:10,height:10,left:x-bb.width/2,right:x+bb.width/2+2,width:bb.width+2})}),i=0;i<lbbArray.length-1;i++)if(_$lib_539.bBoxIntersect(lbbArray[i],lbbArray[i+1])){autoangle=30;break}autoangle&&(Math.abs((vals[vals.length-1].x-vals[0].x)*ax._m)/(vals.length-1)<2.5*maxFontSize&&(autoangle=90),positionLabels(tickLabels,autoangle)),ax._lastangle=autoangle}return drawAxTitle(),axid+" done"},calcBoundingBox,function doAutoMargins(){if(ax.automargin&&("x"===axLetter||"y"===axLetter)){var s=ax.side[0],push={x:0,y:0,r:0,l:0,t:0,b:0};"x"===axLetter?(push.y="free"===ax.anchor?ax.position:ax._anchorAxis.domain["t"===s?1:0],push[s]+=ax._boundingBox.height):(push.x="free"===ax.anchor?ax.position:ax._anchorAxis.domain["r"===s?1:0],push[s]+=ax._boundingBox.width),ax.title!==fullLayout._dfltTitle[axLetter]&&(push[s]+=ax.titlefont.size);var pushKey=ax._name+".automargin",prevPush=fullLayout._pushmargin[pushKey];(!prevPush||prevPush[s].size<push[s])&&_$plots_647.autoMargin(gd,pushKey,push)}}]);return done&&done.then&&gd._promises.push(done),done}function drawAxTitle(){if(!skipTitle){var ax=_$axis_ids_587.getFromId(gd,axid);if(!(ax.rangeslider&&ax.rangeslider.visible&&ax._boundingBox&&"bottom"===ax.side)){var transform,counterAxis,x,y,avoidSelection=_$d3_127.select(gd).selectAll("g."+axid+"tick"),avoid={selection:avoidSelection,side:ax.side},axLetter=axid.charAt(0),gs=gd._fullLayout._size,fontSize=ax.titlefont.size;if(avoidSelection.size()){var translation=_$drawing_436.getTranslate(avoidSelection.node().parentNode);avoid.offsetLeft=translation.x,avoid.offsetTop=translation.y}var titleStandoff=10+1.5*fontSize+(ax.linewidth?ax.linewidth-1:0);"x"===axLetter?(counterAxis="free"===ax.anchor?{_offset:gs.t+(1-(ax.position||0))*gs.h,_length:0}:_$axis_ids_587.getFromId(gd,ax.anchor),x=ax._offset+ax._length/2,y="top"===ax.side?-titleStandoff-fontSize*(ax.showticklabels?1:0):counterAxis._length+titleStandoff+fontSize*(ax.showticklabels?1.5:.5),y+=counterAxis._offset,avoid.side||(avoid.side="bottom")):(counterAxis="free"===ax.anchor?{_offset:gs.l+(ax.position||0)*gs.w,_length:0}:_$axis_ids_587.getFromId(gd,ax.anchor),y=ax._offset+ax._length/2,x="right"===ax.side?counterAxis._length+titleStandoff+fontSize*(ax.showticklabels?1:.5):-titleStandoff-fontSize*(ax.showticklabels?.5:0),x+=counterAxis._offset,transform={rotate:"-90",offset:0},avoid.side||(avoid.side="left")),_$titles_504.draw(gd,axid+"title",{propContainer:ax,propName:ax._name+".title",placeholder:fullLayout._dfltTitle[axLetter],avoid:avoid,transform:transform,attributes:{x:x,y:y,"text-anchor":"middle"}})}}}function traceHasBarsOrFill(trace,subplot){return!0===trace.visible&&trace.xaxis+trace.yaxis===subplot&&(!(!_$registry_668.traceIs(trace,"bar")||trace.orientation!=={x:"h",y:"v"}[axLetter])||trace.fill&&trace.fill.charAt(trace.fill.length-1)===axLetter)}function drawGrid(plotinfo,counteraxis,subplot){var gridcontainer=plotinfo.gridlayer.selectAll("."+axid),zlcontainer=plotinfo.zerolinelayer,gridvals=plotinfo["hidegrid"+axLetter]?[]:valsClipped,gridpath=ax._gridpath||("x"===axLetter?"M0,"+counteraxis._offset+"v":"M"+counteraxis._offset+",0h")+counteraxis._length,grid=gridcontainer.selectAll("path."+gcls).data(!1===ax.showgrid?[]:gridvals,datafn);if(grid.enter().append("path").classed(gcls,1).classed("crisp",1).attr("d",gridpath).each(function(d){ax.zeroline&&("linear"===ax.type||"-"===ax.type)&&Math.abs(d.x)<ax.dtick/100&&_$d3_127.select(this).remove()}),grid.attr("transform",transfn).call(_$color_411.stroke,ax.gridcolor||"#ddd").style("stroke-width",gridWidth+"px"),"function"==typeof gridpath&&grid.attr("d",gridpath),grid.exit().remove(),zlcontainer){for(var hasBarsOrFill=!1,i=0;i<gd._fullData.length;i++)if(traceHasBarsOrFill(gd._fullData[i],subplot)){hasBarsOrFill=!0;break}var rng=_$lib_539.simpleMap(ax.range,ax.r2l),showZl=rng[0]*rng[1]<=0&&ax.zeroline&&("linear"===ax.type||"-"===ax.type)&&gridvals.length&&(hasBarsOrFill||clipEnds({x:0})||!ax.showline),zl=zlcontainer.selectAll("path."+zcls).data(showZl?[{x:0,id:axid}]:[]);zl.enter().append("path").classed(zcls,1).classed("zl",1).classed("crisp",1).attr("d",gridpath).each(function(){zlcontainer.selectAll("path").sort(function(da,db){return _$axis_ids_587.idSort(da.id,db.id)})}),zl.attr("transform",transfn).call(_$color_411.stroke,ax.zerolinecolor||_$color_411.defaultLine).style("stroke-width",zeroLineWidth+"px"),zl.exit().remove()}}},axes.swap=function(gd,traces){for(var axGroups=function makeAxisGroups(gd,traces){var i,j,groups=[];for(i=0;i<traces.length;i++){var groupsi=[],xi=gd._fullData[traces[i]].xaxis,yi=gd._fullData[traces[i]].yaxis;if(xi&&yi){for(j=0;j<groups.length;j++)-1===groups[j].x.indexOf(xi)&&-1===groups[j].y.indexOf(yi)||groupsi.push(j);if(groupsi.length){var groupj,group0=groups[groupsi[0]];if(groupsi.length>1)for(j=1;j<groupsi.length;j++)groupj=groups[groupsi[j]],mergeAxisGroups(group0.x,groupj.x),mergeAxisGroups(group0.y,groupj.y);mergeAxisGroups(group0.x,[xi]),mergeAxisGroups(group0.y,[yi])}else groups.push({x:[xi],y:[yi]})}}return groups}(gd,traces),i=0;i<axGroups.length;i++)swapAxisGroup(gd,axGroups[i].x,axGroups[i].y)};var _$helpers_965={pointsAccessorFunction:function(transforms,opts){for(var tr,prevIndexToPoints,i=0;i<transforms.length&&(tr=transforms[i])!==opts;i++)tr._indexToPoints&&!1!==tr.enabled&&(prevIndexToPoints=tr._indexToPoints);return prevIndexToPoints?function(i){return prevIndexToPoints[i]}:function(i){return[i]}}},_$aggregate_962={},pointsAccessorFunction=_$helpers_965.pointsAccessorFunction,__BADNUM_962=_$numerical_517.BADNUM;_$aggregate_962.moduleType="transform",_$aggregate_962.name="aggregate";var attrs=_$aggregate_962.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},aggAttrs=attrs.aggregations;function aggregateOneArray(gd,trace,groupings,aggregation){if(aggregation.enabled){for(var attr=aggregation.target,targetNP=_$lib_539.nestedProperty(trace,attr),arrayIn=targetNP.get(),func=function getAggregateFunction(opts,conversions){var func=opts.func,d2c=conversions.d2c,c2d=conversions.c2d;switch(func){case"count":return count;case"first":return first;case"last":return last;case"sum":return function(array,indices){for(var total=0,i=0;i<indices.length;i++){var vi=d2c(array[indices[i]]);vi!==__BADNUM_962&&(total+=vi)}return c2d(total)};case"avg":return function(array,indices){for(var total=0,cnt=0,i=0;i<indices.length;i++){var vi=d2c(array[indices[i]]);vi!==__BADNUM_962&&(total+=vi,cnt++)}return cnt?c2d(total/cnt):__BADNUM_962};case"min":return function(array,indices){for(var out=1/0,i=0;i<indices.length;i++){var vi=d2c(array[indices[i]]);vi!==__BADNUM_962&&(out=Math.min(out,vi))}return out===1/0?__BADNUM_962:c2d(out)};case"max":return function(array,indices){for(var out=-1/0,i=0;i<indices.length;i++){var vi=d2c(array[indices[i]]);vi!==__BADNUM_962&&(out=Math.max(out,vi))}return out===-1/0?__BADNUM_962:c2d(out)};case"median":return function(array,indices){for(var sortCalc=[],i=0;i<indices.length;i++){var vi=d2c(array[indices[i]]);vi!==__BADNUM_962&&sortCalc.push(vi)}if(!sortCalc.length)return __BADNUM_962;sortCalc.sort();var mid=(sortCalc.length-1)/2;return c2d((sortCalc[Math.floor(mid)]+sortCalc[Math.ceil(mid)])/2)};case"mode":return function(array,indices){for(var counts={},maxCnt=0,out=__BADNUM_962,i=0;i<indices.length;i++){var vi=d2c(array[indices[i]]);if(vi!==__BADNUM_962){var counti=counts[vi]=(counts[vi]||0)+1;counti>maxCnt&&(maxCnt=counti,out=vi)}}return maxCnt?c2d(out):__BADNUM_962};case"rms":return function(array,indices){for(var total=0,cnt=0,i=0;i<indices.length;i++){var vi=d2c(array[indices[i]]);vi!==__BADNUM_962&&(total+=vi*vi,cnt++)}return cnt?c2d(Math.sqrt(total/cnt)):__BADNUM_962};case"stddev":return function(array,indices){var i,total=0,total2=0,cnt=1,v0=__BADNUM_962;for(i=0;i<indices.length&&v0===__BADNUM_962;i++)v0=d2c(array[indices[i]]);if(v0===__BADNUM_962)return __BADNUM_962;for(;i<indices.length;i++){var vi=d2c(array[indices[i]]);if(vi!==__BADNUM_962){var dv=vi-v0;total+=dv,total2+=dv*dv,cnt++}}var norm="sample"===opts.funcmode?cnt-1:cnt;return norm?Math.sqrt((total2-total*total/cnt)/norm):0}}}(aggregation,_$axes_584.getDataConversions(gd,trace,attr,arrayIn)),arrayOut=new Array(groupings.length),i=0;i<groupings.length;i++)arrayOut[i]=func(arrayIn,groupings[i]);targetNP.set(arrayOut)}}function count(array,indices){return indices.length}function first(array,indices){return array[indices[0]]}function last(array,indices){return array[indices[indices.length-1]]}_$aggregate_962.supplyDefaults=function(transformIn,traceOut){var i,transformOut={};function coerce(attr,dflt){return _$lib_539.coerce(transformIn,transformOut,attrs,attr,dflt)}if(!coerce("enabled"))return transformOut;var arrayAttrArray=_$plot_schema_575.findArrayAttributes(traceOut),arrayAttrs={};for(i=0;i<arrayAttrArray.length;i++)arrayAttrs[arrayAttrArray[i]]=1;var groups=coerce("groups");if(!Array.isArray(groups)){if(!arrayAttrs[groups])return void(transformOut.enabled=!1);arrayAttrs[groups]=0}var aggregationOut,aggregationsIn=transformIn.aggregations||[],aggregationsOut=transformOut.aggregations=new Array(aggregationsIn.length);function coercei(attr,dflt){return _$lib_539.coerce(aggregationsIn[i],aggregationOut,aggAttrs,attr,dflt)}for(i=0;i<aggregationsIn.length;i++){aggregationOut={_index:i};var target=coercei("target"),func=coercei("func");coercei("enabled")&&target&&(arrayAttrs[target]||"count"===func&&void 0===arrayAttrs[target])?("stddev"===func&&coercei("funcmode"),arrayAttrs[target]=0,aggregationsOut[i]=aggregationOut):aggregationsOut[i]={enabled:!1,_index:i}}for(i=0;i<arrayAttrArray.length;i++)arrayAttrs[arrayAttrArray[i]]&&aggregationsOut.push({target:arrayAttrArray[i],func:aggAttrs.func.dflt,enabled:!0,_index:-1});return transformOut},_$aggregate_962.calcTransform=function(gd,trace,opts){if(opts.enabled){var groups=opts.groups,groupArray=_$lib_539.getTargetArray(trace,{target:groups});if(groupArray){var i,vi,groupIndex,newGrouping,groupIndices={},indexToPoints={},groupings=[],originalPointsAccessor=pointsAccessorFunction(trace.transforms,opts);for(i=0;i<groupArray.length;i++)void 0===(groupIndex=groupIndices[vi=groupArray[i]])?(groupIndices[vi]=groupings.length,newGrouping=[i],groupings.push(newGrouping),indexToPoints[groupIndices[vi]]=originalPointsAccessor(i)):(groupings[groupIndex].push(i),indexToPoints[groupIndices[vi]]=(indexToPoints[groupIndices[vi]]||[]).concat(originalPointsAccessor(i)));opts._indexToPoints=indexToPoints;var aggregations=opts.aggregations;for(i=0;i<aggregations.length;i++)aggregateOneArray(gd,trace,groupings,aggregations[i]);"string"==typeof groups&&aggregateOneArray(gd,trace,groupings,{target:groups,func:"first",enabled:!0})}}};var _$aggregate_3=_$aggregate_962,_$attributes_582={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}},_$handleCategoryOrderDefaults_588=function handleCategoryOrderDefaults(containerIn,containerOut,coerce){if("category"===containerOut.type){var orderDefault,arrayIn=containerIn.categoryarray,isValidArray=Array.isArray(arrayIn)&&arrayIn.length>0;isValidArray&&(orderDefault="array");var order=coerce("categoryorder",orderDefault);"array"===order&&coerce("categoryarray"),isValidArray||"array"!==order||(containerOut.categoryorder="trace")}},colorMix=_$tinycolor_352.mix,lightFraction=_$attributes_410.lightFraction,_$handleLineGridDefaults_598=function handleLineGridDefaults(containerIn,containerOut,coerce,opts){var dfltColor=(opts=opts||{}).dfltColor;function coerce2(attr,dflt){return _$lib_539.coerce2(containerIn,containerOut,opts.attributes,attr,dflt)}var lineColor=coerce2("linecolor",dfltColor),lineWidth=coerce2("linewidth");coerce("showline",opts.showLine||!!lineColor||!!lineWidth)||(delete containerOut.linecolor,delete containerOut.linewidth);var gridColor=coerce2("gridcolor",colorMix(dfltColor,opts.bgColor,opts.blend||lightFraction).toRgbString()),gridWidth=coerce2("gridwidth");if(coerce("showgrid",opts.showGrid||!!gridColor||!!gridWidth)||(delete containerOut.gridcolor,delete containerOut.gridwidth),!opts.noZeroLine){var zeroLineColor=coerce2("zerolinecolor",dfltColor),zeroLineWidth=coerce2("zerolinewidth");coerce("zeroline",opts.showGrid||!!zeroLineColor||!!zeroLineWidth)||(delete containerOut.zerolinecolor,delete containerOut.zerolinewidth)}};function flattenUniqueSort(axisLetter,sortFunction,data){var i,j,tracePoints,category,insertionIndex,categoryArray=[],traceLines=data.map(function(d){return d[axisLetter]}),bisector=_$d3_127.bisector(sortFunction).left;for(i=0;i<traceLines.length;i++)for(tracePoints=traceLines[i],j=0;j<tracePoints.length;j++)null!==(category=tracePoints[j])&&void 0!==category&&((insertionIndex=bisector(categoryArray,category))<categoryArray.length&&categoryArray[insertionIndex]===category||categoryArray.splice(insertionIndex,0,category));return categoryArray}var _$orderedCategories_599=function orderedCategories(axisLetter,categoryorder,categoryarray,data){switch(categoryorder){case"array":return Array.isArray(categoryarray)?categoryarray.slice():[];case"category ascending":return flattenUniqueSort(axisLetter,_$d3_127.ascending,data);case"category descending":return flattenUniqueSort(axisLetter,_$d3_127.descending,data);case"trace":default:return[]}},_$handleAxisDefaults_586=function handleAxisDefaults(containerIn,containerOut,coerce,options,layoutOut){var letter=options.letter,font=options.font||{},visible=coerce("visible",!options.cheateronly),axType=containerOut.type;"date"===axType&&_$registry_668.getComponentMethod("calendars","handleDefaults")(containerIn,containerOut,"calendar",options.calendar);_$setConvert_603(containerOut,layoutOut);var autoRange=coerce("autorange",!containerOut.isValidRange(containerIn.range));if(containerOut._rangesliderAutorange=!1,autoRange&&coerce("rangemode"),coerce("range"),containerOut.cleanRange(),_$handleCategoryOrderDefaults_588(containerIn,containerOut,coerce),containerOut._initialCategories="category"===axType?_$orderedCategories_599(letter,containerOut.categoryorder,containerOut.categoryarray,options.data):[],"category"===axType||options.noHover||coerce("hoverformat"),!visible)return containerOut;var dfltColor=coerce("color"),dfltFontColor=dfltColor===containerIn.color?dfltColor:font.color;return coerce("title",layoutOut._dfltTitle[letter]),_$lib_539.coerceFont(coerce,"titlefont",{family:font.family,size:Math.round(1.2*font.size),color:dfltFontColor}),_$handleTickValueDefaults_606(containerIn,containerOut,coerce,axType),_$handleTickLabelDefaults_604(containerIn,containerOut,coerce,axType,options),_$handleTickDefaults_605(containerIn,containerOut,coerce,options),_$handleLineGridDefaults_598(containerIn,containerOut,coerce,{dfltColor:dfltColor,bgColor:options.bgColor,showGrid:options.showGrid,attributes:_$layout_attributes_596}),(containerOut.showline||containerOut.ticks)&&coerce("mirror"),options.automargin&&coerce("automargin"),containerOut},id2name=_$axis_ids_587.id2name,_$handleConstraintDefaults_590=function handleConstraintDefaults(containerIn,containerOut,coerce,allAxisIds,layoutOut){var constraintGroups=layoutOut._axisConstraintGroups,thisID=containerOut._id,letter=thisID.charAt(0);if(!containerOut.fixedrange&&(coerce("constrain"),_$lib_539.coerce(containerIn,containerOut,{constraintoward:{valType:"enumerated",values:"x"===letter?["left","center","right"]:["bottom","middle","top"],dflt:"x"===letter?"center":"middle"}},"constraintoward"),containerIn.scaleanchor)){var constraintOpts=function getConstraintOpts(constraintGroups,thisID,allAxisIds,layoutOut){var i,j,idj,axj,thisType=layoutOut[id2name(thisID)].type,linkableAxes=[];for(j=0;j<allAxisIds.length;j++)(idj=allAxisIds[j])!==thisID&&((axj=layoutOut[id2name(idj)]).type!==thisType||axj.fixedrange||linkableAxes.push(idj));for(i=0;i<constraintGroups.length;i++)if(constraintGroups[i][thisID]){var thisGroup=constraintGroups[i],linkableAxesNoLoops=[];for(j=0;j<linkableAxes.length;j++)idj=linkableAxes[j],thisGroup[idj]||linkableAxesNoLoops.push(idj);return{linkableAxes:linkableAxesNoLoops,thisGroup:thisGroup}}return{linkableAxes:linkableAxes,thisGroup:null}}(constraintGroups,thisID,allAxisIds,layoutOut),scaleanchor=_$lib_539.coerce(containerIn,containerOut,{scaleanchor:{valType:"enumerated",values:constraintOpts.linkableAxes}},"scaleanchor");if(scaleanchor){var scaleratio=coerce("scaleratio");scaleratio||(scaleratio=containerOut.scaleratio=1),function updateConstraintGroups(constraintGroups,thisGroup,thisID,scaleanchor,scaleratio){var i,j,groupi,keyj,thisGroupIndex;null===thisGroup?((thisGroup={})[thisID]=1,thisGroupIndex=constraintGroups.length,constraintGroups.push(thisGroup)):thisGroupIndex=constraintGroups.indexOf(thisGroup);var thisGroupKeys=Object.keys(thisGroup);for(i=0;i<constraintGroups.length;i++)if(groupi=constraintGroups[i],i!==thisGroupIndex&&groupi[scaleanchor]){var baseScale=groupi[scaleanchor];for(j=0;j<thisGroupKeys.length;j++)keyj=thisGroupKeys[j],groupi[keyj]=baseScale*scaleratio*thisGroup[keyj];return void constraintGroups.splice(thisGroupIndex,1)}if(1!==scaleratio)for(j=0;j<thisGroupKeys.length;j++)thisGroup[thisGroupKeys[j]]*=scaleratio;thisGroup[scaleanchor]=1}(constraintGroups,constraintOpts.thisGroup,thisID,scaleanchor,scaleratio)}else-1!==allAxisIds.indexOf(containerIn.scaleanchor)&&_$lib_539.warn("ignored "+containerOut._name+'.scaleanchor: "'+containerIn.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because the targetaxis has fixed range.')}};var _$handlePositionDefaults_600=function handlePositionDefaults(containerIn,containerOut,coerce,options){var dfltAnchor,dfltDomain,dfltSide,dfltPosition,counterAxes=options.counterAxes||[],overlayableAxes=options.overlayableAxes||[],letter=options.letter,grid=options.grid;grid&&(dfltDomain=grid._domains[letter][grid._axisMap[containerOut._id]],dfltAnchor=grid._anchors[containerOut._id],dfltDomain&&(dfltSide=grid[letter+"side"].split(" ")[0],dfltPosition=grid.domain[letter]["right"===dfltSide||"top"===dfltSide?1:0])),dfltDomain=dfltDomain||[0,1],dfltAnchor=dfltAnchor||(_$fastIsnumeric_139(containerIn.position)?"free":counterAxes[0]||"free"),dfltSide=dfltSide||("x"===letter?"bottom":"left"),dfltPosition=dfltPosition||0,"free"===_$lib_539.coerce(containerIn,containerOut,{anchor:{valType:"enumerated",values:["free"].concat(counterAxes),dflt:dfltAnchor}},"anchor")&&coerce("position",dfltPosition),_$lib_539.coerce(containerIn,containerOut,{side:{valType:"enumerated",values:"x"===letter?["bottom","top"]:["left","right"],dflt:dfltSide}},"side");var overlaying=!1;if(overlayableAxes.length&&(overlaying=_$lib_539.coerce(containerIn,containerOut,{overlaying:{valType:"enumerated",values:[!1].concat(overlayableAxes),dflt:!1}},"overlaying")),!overlaying){var domain=coerce("domain",dfltDomain);domain[0]>domain[1]-.01&&(containerOut.domain=dfltDomain),_$lib_539.noneOrAll(containerIn.domain,containerOut.domain,dfltDomain)}return coerce("layer"),containerOut},name2id=_$axis_ids_587.name2id,_$handleTypeDefaults_608=function handleTypeDefaults(containerIn,containerOut,coerce,data,name){name&&(containerOut._name=name,containerOut._id=name2id(name)),"-"===coerce("type")&&(!function setAutoType(ax,data){if("-"!==ax.type)return;var id=ax._id,axLetter=id.charAt(0);-1!==id.indexOf("scene")&&(id=axLetter);var d0=function getFirstNonEmptyTrace(data,id,axLetter){for(var i=0;i<data.length;i++){var trace=data[i];if((trace[axLetter+"axis"]||axLetter)===id){if(isBoxWithoutPositionCoords(trace,axLetter))return trace;if((trace[axLetter]||[]).length||trace[axLetter+"0"])return trace}}}(data,id,axLetter);if(!d0)return;if("histogram"===d0.type&&axLetter==={v:"y",h:"x"}[d0.orientation||"v"])return void(ax.type="linear");var calAttr=axLetter+"calendar",calendar=d0[calAttr];if(isBoxWithoutPositionCoords(d0,axLetter)){for(var trace,posLetter=getBoxPosLetter(d0),boxPositions=[],i=0;i<data.length;i++)trace=data[i],_$registry_668.traceIs(trace,"box-violin")&&(trace[axLetter+"axis"]||axLetter)===id&&(void 0!==trace[posLetter]?boxPositions.push(trace[posLetter][0]):void 0!==trace.name?boxPositions.push(trace.name):boxPositions.push("text"),trace[calAttr]!==calendar&&(calendar=void 0));ax.type=_$autoType_585(boxPositions,calendar)}else ax.type=_$autoType_585(d0[axLetter]||[d0[axLetter+"0"]],calendar)}(containerOut,data),"-"===containerOut.type?containerOut.type="linear":containerIn.type=containerOut.type)};function getBoxPosLetter(trace){return{v:"x",h:"y"}[trace.orientation||"v"]}function isBoxWithoutPositionCoords(trace,axLetter){var posLetter=getBoxPosLetter(trace),isBox=_$registry_668.traceIs(trace,"box-violin"),isCandlestick=_$registry_668.traceIs(trace._fullInput||{},"candlestick");return isBox&&!isCandlestick&&axLetter===posLetter&&void 0===trace[posLetter]&&void 0===trace[posLetter+"0"]}var axisRegex=_$constants_589.attrRegex,_$get_data_621={},SUBPLOT_PATTERN=_$constants_589.SUBPLOT_PATTERN;_$get_data_621.getSubplotCalcData=function(calcData,type,subplotId){var basePlotModule=_$registry_668.subplotsRegistry[type];if(!basePlotModule)return[];for(var attr=basePlotModule.attr,subplotCalcData=[],i=0;i<calcData.length;i++){var calcTrace=calcData[i];calcTrace[0].trace[attr]===subplotId&&subplotCalcData.push(calcTrace)}return subplotCalcData},_$get_data_621.getModuleCalcData=function(calcdata,typeOrModule){var moduleCalcData=[],_module="string"==typeof typeOrModule?_$registry_668.getModule(typeOrModule):typeOrModule;if(!_module)return moduleCalcData;for(var i=0;i<calcdata.length;i++){var cd=calcdata[i],trace=cd[0].trace;trace._module===_module&&!0===trace.visible&&moduleCalcData.push(cd)}return moduleCalcData},_$get_data_621.getSubplotData=function getSubplotData(data,type,subplotId){if(!_$registry_668.subplotsRegistry[type])return[];var trace,subplotX,subplotY,attr=_$registry_668.subplotsRegistry[type].attr,subplotData=[];if("gl2d"===type){var spmatch=subplotId.match(SUBPLOT_PATTERN);subplotX="x"+spmatch[1],subplotY="y"+spmatch[2]}for(var i=0;i<data.length;i++)trace=data[i],"gl2d"===type&&_$registry_668.traceIs(trace,"gl2d")?trace[attr[0]]===subplotX&&trace[attr[1]]===subplotY&&subplotData.push(trace):trace[attr]===subplotId&&subplotData.push(trace);return subplotData};var _$cartesian_595={},getModuleCalcData=_$get_data_621.getModuleCalcData;function plotOne(gd,plotinfo,cdSubplot,transitionOpts,makeOnCompleteCallback){var modules=gd._fullLayout._modules;plotinfo.plot&&plotinfo.plot.selectAll("g:not(.scatterlayer)").selectAll("g.trace").remove();for(var j=0;j<modules.length;j++){var _module=modules[j];if("cartesian"===_module.basePlotModule.name){var cdModule=getModuleCalcData(cdSubplot,_module);_module.plot&&_module.plot(gd,plotinfo,cdModule,transitionOpts,makeOnCompleteCallback)}}}function makeSubplotLayer(plotinfo){var plotgroup=plotinfo.plotgroup,id=plotinfo.id,xLayer=_$constants_589.layerValue2layerClass[plotinfo.xaxis.layer],yLayer=_$constants_589.layerValue2layerClass[plotinfo.yaxis.layer];if(plotinfo.mainplot){var mainplotinfo=plotinfo.mainplotinfo,mainplotgroup=mainplotinfo.plotgroup,xId=id+"-x",yId=id+"-y";plotinfo.gridlayer=mainplotinfo.gridlayer,plotinfo.zerolinelayer=mainplotinfo.zerolinelayer,joinLayer(mainplotinfo.overlinesBelow,"path",xId),joinLayer(mainplotinfo.overlinesBelow,"path",yId),joinLayer(mainplotinfo.overaxesBelow,"g",xId),joinLayer(mainplotinfo.overaxesBelow,"g",yId),plotinfo.plot=joinLayer(mainplotinfo.overplot,"g",id),joinLayer(mainplotinfo.overlinesAbove,"path",xId),joinLayer(mainplotinfo.overlinesAbove,"path",yId),joinLayer(mainplotinfo.overaxesAbove,"g",xId),joinLayer(mainplotinfo.overaxesAbove,"g",yId),plotinfo.xlines=mainplotgroup.select(".overlines-"+xLayer).select("."+xId),plotinfo.ylines=mainplotgroup.select(".overlines-"+yLayer).select("."+yId),plotinfo.xaxislayer=mainplotgroup.select(".overaxes-"+xLayer).select("."+xId),plotinfo.yaxislayer=mainplotgroup.select(".overaxes-"+yLayer).select("."+yId)}else{var backLayer=joinLayer(plotgroup,"g","layer-subplot");plotinfo.shapelayer=joinLayer(backLayer,"g","shapelayer"),plotinfo.imagelayer=joinLayer(backLayer,"g","imagelayer"),plotinfo.gridlayer=joinLayer(plotgroup,"g","gridlayer"),plotinfo.zerolinelayer=joinLayer(plotgroup,"g","zerolinelayer"),joinLayer(plotgroup,"path","xlines-below"),joinLayer(plotgroup,"path","ylines-below"),plotinfo.overlinesBelow=joinLayer(plotgroup,"g","overlines-below"),joinLayer(plotgroup,"g","xaxislayer-below"),joinLayer(plotgroup,"g","yaxislayer-below"),plotinfo.overaxesBelow=joinLayer(plotgroup,"g","overaxes-below"),plotinfo.plot=joinLayer(plotgroup,"g","plot"),plotinfo.overplot=joinLayer(plotgroup,"g","overplot"),joinLayer(plotgroup,"path","xlines-above"),joinLayer(plotgroup,"path","ylines-above"),plotinfo.overlinesAbove=joinLayer(plotgroup,"g","overlines-above"),joinLayer(plotgroup,"g","xaxislayer-above"),joinLayer(plotgroup,"g","yaxislayer-above"),plotinfo.overaxesAbove=joinLayer(plotgroup,"g","overaxes-above"),plotinfo.xlines=plotgroup.select(".xlines-"+xLayer),plotinfo.ylines=plotgroup.select(".ylines-"+yLayer),plotinfo.xaxislayer=plotgroup.select(".xaxislayer-"+xLayer),plotinfo.yaxislayer=plotgroup.select(".yaxislayer-"+yLayer)}joinLayer(plotinfo.gridlayer,"g",plotinfo.xaxis._id,plotinfo.xaxis._id),joinLayer(plotinfo.gridlayer,"g",plotinfo.yaxis._id,plotinfo.yaxis._id),plotinfo.gridlayer.selectAll("g").sort(_$axis_ids_587.idSort);for(var i=0;i<_$constants_589.traceLayerClasses.length;i++)joinLayer(plotinfo.plot,"g",_$constants_589.traceLayerClasses[i]);plotinfo.xlines.style("fill","none").classed("crisp",!0),plotinfo.ylines.style("fill","none").classed("crisp",!0)}function purgeSubplotLayers(layers,fullLayout){if(layers){var overlayIdsToRemove={};layers.each(function(subplotId){_$d3_127.select(this).remove(),removeSubplotExtras(subplotId,fullLayout),overlayIdsToRemove[subplotId]=!0});for(var subplots=fullLayout._plots,subplotIds=Object.keys(subplots),i=0;i<subplotIds.length;i++)for(var overlays=subplots[subplotIds[i]].overlays||[],j=0;j<overlays.length;j++){var overlayInfo=overlays[j];overlayIdsToRemove[overlayInfo.id]&&overlayInfo.plot.selectAll(".trace").remove()}}}function removeSubplotExtras(subplotId,fullLayout){fullLayout._draggers.selectAll("g."+subplotId).remove(),fullLayout._defs.select("#clip"+fullLayout._uid+subplotId+"plot").remove()}function joinLayer(parent,nodeType,className,dataVal){var layer=parent.selectAll("."+className).data([dataVal||0]);return layer.enter().append(nodeType).classed(className,!0),layer}_$cartesian_595.name="cartesian",_$cartesian_595.attr=["xaxis","yaxis"],_$cartesian_595.idRoot=["x","y"],_$cartesian_595.idRegex=_$constants_589.idRegex,_$cartesian_595.attrRegex=_$constants_589.attrRegex,_$cartesian_595.attributes=_$attributes_582,_$cartesian_595.layoutAttributes=_$layout_attributes_596,_$cartesian_595.supplyLayoutDefaults=function supplyLayoutDefaults(layoutIn,layoutOut,fullData){var i,xaCheater={},xaNonCheater={},outerTicks={},noGrids={};for(i=0;i<fullData.length;i++){var trace=fullData[i];if(_$registry_668.traceIs(trace,"cartesian")||_$registry_668.traceIs(trace,"gl2d")){var xaName=_$axis_ids_587.id2name(trace.xaxis),yaName=_$axis_ids_587.id2name(trace.yaxis);_$registry_668.traceIs(trace,"carpet")&&("carpet"!==trace.type||trace._cheater)||xaName&&(xaNonCheater[xaName]=1),"carpet"===trace.type&&trace._cheater&&xaName&&(xaCheater[xaName]=1),_$registry_668.traceIs(trace,"2dMap")&&(outerTicks[xaName]=!0,outerTicks[yaName]=!0),_$registry_668.traceIs(trace,"oriented")&&(noGrids["h"===trace.orientation?yaName:xaName]=!0)}}var subplots=layoutOut._subplots,xIds=subplots.xaxis,yIds=subplots.yaxis,xNames=_$lib_539.simpleMap(xIds,_$axis_ids_587.id2name),yNames=_$lib_539.simpleMap(yIds,_$axis_ids_587.id2name),axNames=xNames.concat(yNames),plot_bgcolor=_$color_411.background;xIds.length&&yIds.length&&(plot_bgcolor=_$lib_539.coerce(layoutIn,layoutOut,_$layout_attributes_638,"plot_bgcolor"));var axName,axLetter,axLayoutIn,axLayoutOut,bgColor=_$color_411.combine(plot_bgcolor,layoutOut.paper_bgcolor);function coerce(attr,dflt){return _$lib_539.coerce(axLayoutIn,axLayoutOut,_$layout_attributes_596,attr,dflt)}function coerce2(attr,dflt){return _$lib_539.coerce2(axLayoutIn,axLayoutOut,_$layout_attributes_596,attr,dflt)}function getCounterAxes(axLetter){return"x"===axLetter?yIds:xIds}var counterAxes={x:getCounterAxes("x"),y:getCounterAxes("y")};function getOverlayableAxes(axLetter,axName){for(var list="x"===axLetter?xNames:yNames,out=[],j=0;j<list.length;j++){var axName2=list[j];axName2===axName||(layoutIn[axName2]||{}).overlaying||out.push(_$axis_ids_587.name2id(axName2))}return out}for(i=0;i<axNames.length;i++){axName=axNames[i],_$lib_539.isPlainObject(layoutIn[axName])||(layoutIn[axName]={}),axLayoutIn=layoutIn[axName],axLayoutOut=layoutOut[axName]={},_$handleTypeDefaults_608(axLayoutIn,axLayoutOut,coerce,fullData,axName);var overlayableAxes=getOverlayableAxes(axLetter=axName.charAt(0),axName),defaultOptions={letter:axLetter,font:layoutOut.font,outerTicks:outerTicks[axName],showGrid:!noGrids[axName],data:fullData,bgColor:bgColor,calendar:layoutOut.calendar,automargin:!0,cheateronly:"x"===axLetter&&xaCheater[axName]&&!xaNonCheater[axName]};_$handleAxisDefaults_586(axLayoutIn,axLayoutOut,coerce,defaultOptions,layoutOut);var spikecolor=coerce2("spikecolor"),spikethickness=coerce2("spikethickness"),spikedash=coerce2("spikedash"),spikemode=coerce2("spikemode"),spikesnap=coerce2("spikesnap");coerce("showspikes",!!(spikecolor||spikethickness||spikedash||spikemode||spikesnap))||(delete axLayoutOut.spikecolor,delete axLayoutOut.spikethickness,delete axLayoutOut.spikedash,delete axLayoutOut.spikemode,delete axLayoutOut.spikesnap);var positioningOptions={letter:axLetter,counterAxes:counterAxes[axLetter],overlayableAxes:overlayableAxes,grid:layoutOut.grid};_$handlePositionDefaults_600(axLayoutIn,axLayoutOut,coerce,positioningOptions),axLayoutOut._input=axLayoutIn}var rangeSliderDefaults=_$registry_668.getComponentMethod("rangeslider","handleDefaults"),rangeSelectorDefaults=_$registry_668.getComponentMethod("rangeselector","handleDefaults");for(i=0;i<xNames.length;i++)axName=xNames[i],axLayoutIn=layoutIn[axName],axLayoutOut=layoutOut[axName],rangeSliderDefaults(layoutIn,layoutOut,axName),"date"===axLayoutOut.type&&rangeSelectorDefaults(axLayoutIn,axLayoutOut,layoutOut,yNames,axLayoutOut.calendar),coerce("fixedrange");for(i=0;i<yNames.length;i++){axName=yNames[i],axLayoutIn=layoutIn[axName],axLayoutOut=layoutOut[axName];var anchoredAxis=layoutOut[_$axis_ids_587.id2name(axLayoutOut.anchor)];coerce("fixedrange",anchoredAxis&&anchoredAxis.rangeslider&&anchoredAxis.rangeslider.visible)}layoutOut._axisConstraintGroups=[];var allAxisIds=counterAxes.x.concat(counterAxes.y);for(i=0;i<axNames.length;i++)axLetter=(axName=axNames[i]).charAt(0),axLayoutIn=layoutIn[axName],axLayoutOut=layoutOut[axName],_$handleConstraintDefaults_590(axLayoutIn,axLayoutOut,coerce,allAxisIds,layoutOut)},_$cartesian_595.transitionAxes=function transitionAxes(gd,newLayout,transitionOpts,makeOnCompleteCallback){var fullLayout=gd._fullLayout,axes=[];var onComplete,t1,t2,raf,updates=function computeUpdates(layout){var ai,attrList,axis,update,updates={};for(ai in layout)if((attrList=ai.split("."))[0].match(axisRegex)){var axisLetter=ai.charAt(0),axisName=attrList[0];if(axis=fullLayout[axisName],update={},Array.isArray(layout[ai])?update.to=layout[ai].slice(0):Array.isArray(layout[ai].range)&&(update.to=layout[ai].range.slice(0)),!update.to)continue;update.axisName=axisName,update.length=axis._length,axes.push(axisLetter),updates[axisLetter]=update}return updates}(newLayout),updatedAxisIds=Object.keys(updates),affectedSubplots=function computeAffectedSubplots(fullLayout,updatedAxisIds,updates){var plotName,toX,toY,plotinfos=fullLayout._plots,affectedSubplots=[];for(plotName in plotinfos){var plotinfo=plotinfos[plotName];if(-1===affectedSubplots.indexOf(plotinfo)){var x=plotinfo.xaxis._id,y=plotinfo.yaxis._id,fromX=plotinfo.xaxis.range,fromY=plotinfo.yaxis.range;plotinfo.xaxis._r=plotinfo.xaxis.range.slice(),plotinfo.yaxis._r=plotinfo.yaxis.range.slice(),toX=updates[x]?updates[x].to:fromX,toY=updates[y]?updates[y].to:fromY,fromX[0]===toX[0]&&fromX[1]===toX[1]&&fromY[0]===toY[0]&&fromY[1]===toY[1]||-1===updatedAxisIds.indexOf(x)&&-1===updatedAxisIds.indexOf(y)||affectedSubplots.push(plotinfo)}}return affectedSubplots}(fullLayout,updatedAxisIds,updates);if(!affectedSubplots.length)return function updateLayoutObjs(){function redrawObjs(objArray,method,shortCircuit){for(var i=0;i<objArray.length;i++)if(method(gd,i),shortCircuit)return}redrawObjs(fullLayout.annotations||[],_$registry_668.getComponentMethod("annotations","drawOne")),redrawObjs(fullLayout.shapes||[],_$registry_668.getComponentMethod("shapes","drawOne")),redrawObjs(fullLayout.images||[],_$registry_668.getComponentMethod("images","draw"),!0)}(),!1;function unsetSubplotTransform(subplot){var xa2=subplot.xaxis,ya2=subplot.yaxis;fullLayout._defs.select("#"+subplot.clipId+"> rect").call(_$drawing_436.setTranslate,0,0).call(_$drawing_436.setScale,1,1),subplot.plot.call(_$drawing_436.setTranslate,xa2._offset,ya2._offset).call(_$drawing_436.setScale,1,1);var traceGroups=subplot.plot.selectAll(".scatterlayer .trace");traceGroups.selectAll(".point").call(_$drawing_436.setPointGroupScale,1,1),traceGroups.selectAll(".textpoint").call(_$drawing_436.setTextPointsScale,1,1),traceGroups.call(_$drawing_436.hideOutsideRangePoints,subplot)}function updateSubplot(subplot,progress){var axis,r0,r1,xUpdate=updates[subplot.xaxis._id],yUpdate=updates[subplot.yaxis._id],viewBox=[];if(xUpdate){r0=(axis=gd._fullLayout[xUpdate.axisName])._r,r1=xUpdate.to,viewBox[0]=(r0[0]*(1-progress)+progress*r1[0]-r0[0])/(r0[1]-r0[0])*subplot.xaxis._length;var dx1=r0[1]-r0[0],dx2=r1[1]-r1[0];axis.range[0]=r0[0]*(1-progress)+progress*r1[0],axis.range[1]=r0[1]*(1-progress)+progress*r1[1],viewBox[2]=subplot.xaxis._length*(1-progress+progress*dx2/dx1)}else viewBox[0]=0,viewBox[2]=subplot.xaxis._length;if(yUpdate){r0=(axis=gd._fullLayout[yUpdate.axisName])._r,r1=yUpdate.to,viewBox[1]=(r0[1]*(1-progress)+progress*r1[1]-r0[1])/(r0[0]-r0[1])*subplot.yaxis._length;var dy1=r0[1]-r0[0],dy2=r1[1]-r1[0];axis.range[0]=r0[0]*(1-progress)+progress*r1[0],axis.range[1]=r0[1]*(1-progress)+progress*r1[1],viewBox[3]=subplot.yaxis._length*(1-progress+progress*dy2/dy1)}else viewBox[1]=0,viewBox[3]=subplot.yaxis._length;!function ticksAndAnnotations(xa,ya){var i,activeAxIds=[];for(activeAxIds=[xa._id,ya._id],i=0;i<activeAxIds.length;i++)_$axes_584.doTicks(gd,activeAxIds[i],!0);function redrawObjs(objArray,method,shortCircuit){for(i=0;i<objArray.length;i++){var obji=objArray[i];if(-1===activeAxIds.indexOf(obji.xref)&&-1===activeAxIds.indexOf(obji.yref)||method(gd,i),shortCircuit)return}}redrawObjs(fullLayout.annotations||[],_$registry_668.getComponentMethod("annotations","drawOne")),redrawObjs(fullLayout.shapes||[],_$registry_668.getComponentMethod("shapes","drawOne")),redrawObjs(fullLayout.images||[],_$registry_668.getComponentMethod("images","draw"),!0)}(subplot.xaxis,subplot.yaxis);var xa2=subplot.xaxis,ya2=subplot.yaxis,editX=!!xUpdate,editY=!!yUpdate,xScaleFactor=editX?xa2._length/viewBox[2]:1,yScaleFactor=editY?ya2._length/viewBox[3]:1,clipDx=editX?viewBox[0]:0,clipDy=editY?viewBox[1]:0,fracDx=editX?viewBox[0]/viewBox[2]*xa2._length:0,fracDy=editY?viewBox[1]/viewBox[3]*ya2._length:0,plotDx=xa2._offset-fracDx,plotDy=ya2._offset-fracDy;fullLayout._defs.select("#"+subplot.clipId+"> rect").call(_$drawing_436.setTranslate,clipDx,clipDy).call(_$drawing_436.setScale,1/xScaleFactor,1/yScaleFactor),subplot.plot.call(_$drawing_436.setTranslate,plotDx,plotDy).call(_$drawing_436.setScale,xScaleFactor,yScaleFactor).selectAll(".points").selectAll(".point").call(_$drawing_436.setPointGroupScale,1/xScaleFactor,1/yScaleFactor),subplot.plot.selectAll(".points").selectAll(".textpoint").call(_$drawing_436.setTextPointsScale,1/xScaleFactor,1/yScaleFactor)}makeOnCompleteCallback&&(onComplete=makeOnCompleteCallback());var easeFn=_$d3_127.ease(transitionOpts.easing);return gd._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(raf),raf=null,function transitionInterrupt(){for(var aobj={},i=0;i<updatedAxisIds.length;i++){var axi=gd._fullLayout[updatedAxisIds[i]+"axis"];aobj[axi._name+".range[0]"]=axi.range[0],aobj[axi._name+".range[1]"]=axi.range[1],axi.range=axi._r.slice()}return _$registry_668.call("relayout",gd,aobj).then(function(){for(var i=0;i<affectedSubplots.length;i++)unsetSubplotTransform(affectedSubplots[i])})}()}),t1=Date.now(),raf=window.requestAnimationFrame(function doFrame(){t2=Date.now();for(var tInterp=Math.min(1,(t2-t1)/transitionOpts.duration),progress=easeFn(tInterp),i=0;i<affectedSubplots.length;i++)updateSubplot(affectedSubplots[i],progress);t2-t1>transitionOpts.duration?(function transitionComplete(){for(var aobj={},i=0;i<updatedAxisIds.length;i++){var axi=gd._fullLayout[updates[updatedAxisIds[i]].axisName],to=updates[updatedAxisIds[i]].to;aobj[axi._name+".range[0]"]=to[0],aobj[axi._name+".range[1]"]=to[1],axi.range=to.slice()}return onComplete&&onComplete(),_$registry_668.call("relayout",gd,aobj).then(function(){for(var i=0;i<affectedSubplots.length;i++)unsetSubplotTransform(affectedSubplots[i])})}(),raf=window.cancelAnimationFrame(doFrame)):raf=window.requestAnimationFrame(doFrame)}),Promise.resolve()},_$cartesian_595.finalizeSubplots=function(layoutIn,layoutOut){var i,xi,yi,subplots=layoutOut._subplots,xList=subplots.xaxis,yList=subplots.yaxis,spSVG=subplots.cartesian,spAll=spSVG.concat(subplots.gl2d||[]),allX={},allY={};for(i=0;i<spAll.length;i++){var parts=spAll[i].split("y");allX[parts[0]]=1,allY["y"+parts[1]]=1}for(i=0;i<xList.length;i++)allX[xi=xList[i]]||(yi=(layoutIn[_$axis_ids_587.id2name(xi)]||{}).anchor,_$constants_589.idRegex.y.test(yi)||(yi="y"),spSVG.push(xi+yi),spAll.push(xi+yi),allY[yi]||(allY[yi]=1,_$lib_539.pushUnique(yList,yi)));for(i=0;i<yList.length;i++)allY[yi=yList[i]]||(xi=(layoutIn[_$axis_ids_587.id2name(yi)]||{}).anchor,_$constants_589.idRegex.x.test(xi)||(xi="x"),spSVG.push(xi+yi),spAll.push(xi+yi),allX[xi]||(allX[xi]=1,_$lib_539.pushUnique(xList,xi)));if(!spAll.length){for(var ki in xi="",yi="",layoutIn){if(_$constants_589.attrRegex.test(ki))"x"===ki.charAt(0)?(!xi||+ki.substr(5)<+xi.substr(5))&&(xi=ki):(!yi||+ki.substr(5)<+yi.substr(5))&&(yi=ki)}xi=xi?_$axis_ids_587.name2id(xi):"x",yi=yi?_$axis_ids_587.name2id(yi):"y",xList.push(xi),yList.push(yi),spSVG.push(xi+yi)}},_$cartesian_595.plot=function(gd,traces,transitionOpts,makeOnCompleteCallback){var i,fullLayout=gd._fullLayout,subplots=fullLayout._subplots.cartesian,calcdata=gd.calcdata;if(!Array.isArray(traces))for(traces=[],i=0;i<calcdata.length;i++)traces.push(i);for(fullLayout._glcanvas&&fullLayout._glcanvas.size()&&fullLayout._glcanvas.each(function(d){d.regl&&d.regl.clear({color:!0})}),i=0;i<subplots.length;i++){for(var pcd,subplot=subplots[i],subplotInfo=fullLayout._plots[subplot],cdSubplot=[],j=0;j<calcdata.length;j++){var cd=calcdata[j],trace=cd[0].trace;trace.xaxis+trace.yaxis===subplot&&((-1!==traces.indexOf(trace.index)||trace.carpet)&&(pcd&&pcd[0].trace.xaxis+pcd[0].trace.yaxis===subplot&&-1!==["tonextx","tonexty","tonext"].indexOf(trace.fill)&&-1===cdSubplot.indexOf(pcd)&&cdSubplot.push(pcd),cdSubplot.push(cd)),pcd=cd)}plotOne(gd,subplotInfo,cdSubplot,transitionOpts,makeOnCompleteCallback)}},_$cartesian_595.clean=function(newFullData,newFullLayout,oldFullData,oldFullLayout){var hadScatter,hasScatter,hadGl,hasGl,i,oldPlots,ids,subplotInfo,moduleName,oldModules=oldFullLayout._modules||[],newModules=newFullLayout._modules||[];for(i=0;i<oldModules.length;i++)"scatter"===(moduleName=oldModules[i].name)?hadScatter=!0:"scattergl"===moduleName&&(hadGl=!0);for(i=0;i<newModules.length;i++)"scatter"===(moduleName=newModules[i].name)?hasScatter=!0:"scattergl"===moduleName&&(hasGl=!0);if(hadScatter&&!hasScatter){for(oldPlots=oldFullLayout._plots,ids=Object.keys(oldPlots||{}),i=0;i<ids.length;i++)(subplotInfo=oldPlots[ids[i]]).plot&&subplotInfo.plot.select("g.scatterlayer").selectAll("g.trace").remove();oldFullLayout._infolayer.selectAll("g.rangeslider-container").select("g.scatterlayer").selectAll("g.trace").remove()}if(hadGl&&!hasGl)for(oldPlots=oldFullLayout._plots,ids=Object.keys(oldPlots||{}),i=0;i<ids.length;i++)(subplotInfo=oldPlots[ids[i]])._scene&&subplotInfo._scene.destroy();var oldSubplotList=oldFullLayout._subplots||{},newSubplotList=newFullLayout._subplots||{xaxis:[],yaxis:[]};if(oldSubplotList.xaxis&&oldSubplotList.yaxis){var oldAxIDs=oldSubplotList.xaxis.concat(oldSubplotList.yaxis),newAxIDs=newSubplotList.xaxis.concat(newSubplotList.yaxis);for(i=0;i<oldAxIDs.length;i++)-1===newAxIDs.indexOf(oldAxIDs[i])&&oldFullLayout._infolayer.selectAll(".g-"+oldAxIDs[i]+"title").remove()}var hadCartesian=oldFullLayout._has&&oldFullLayout._has("cartesian"),hasCartesian=newFullLayout._has&&newFullLayout._has("cartesian");if(hadCartesian&&!hasCartesian)purgeSubplotLayers(oldFullLayout._cartesianlayer.selectAll(".subplot"),oldFullLayout),oldFullLayout._defs.selectAll(".axesclip").remove(),delete oldFullLayout._axisConstraintGroups;else if(oldSubplotList.cartesian)for(i=0;i<oldSubplotList.cartesian.length;i++){var oldSubplotId=oldSubplotList.cartesian[i];if(-1===newSubplotList.cartesian.indexOf(oldSubplotId)){var selector="."+oldSubplotId+",."+oldSubplotId+"-x,."+oldSubplotId+"-y";oldFullLayout._cartesianlayer.selectAll(selector).remove(),removeSubplotExtras(oldSubplotId,oldFullLayout)}}},_$cartesian_595.drawFramework=function(gd){var fullLayout=gd._fullLayout,subplotData=function makeSubplotData(gd){for(var fullLayout=gd._fullLayout,subplots=Object.keys(fullLayout._plots),subplotData=[],overlays=[],i=0;i<subplots.length;i++){var subplot=subplots[i],plotinfo=fullLayout._plots[subplot],xa=plotinfo.xaxis,ya=plotinfo.yaxis,xa2=xa._mainAxis,ya2=ya._mainAxis,mainplot=xa2._id+ya2._id;mainplot!==subplot&&-1!==subplots.indexOf(mainplot)?(plotinfo.mainplot=mainplot,plotinfo.mainplotinfo=fullLayout._plots[mainplot],overlays.push(subplot)):subplotData.push(subplot)}return subplotData=subplotData.concat(overlays)}(gd),subplotLayers=fullLayout._cartesianlayer.selectAll(".subplot").data(subplotData,_$lib_539.identity);subplotLayers.enter().append("g").attr("class",function(name){return"subplot "+name}),subplotLayers.order(),subplotLayers.exit().call(purgeSubplotLayers,fullLayout),subplotLayers.each(function(name){var plotinfo=fullLayout._plots[name];(plotinfo.plotgroup=_$d3_127.select(this),plotinfo.overlays=[],makeSubplotLayer(plotinfo),plotinfo.mainplot)&&fullLayout._plots[plotinfo.mainplot].overlays.push(plotinfo);plotinfo.draglayer=joinLayer(fullLayout._draggers,"g",name)})},_$cartesian_595.rangePlot=function(gd,plotinfo,cdSubplot){makeSubplotLayer(plotinfo),plotOne(gd,plotinfo,cdSubplot),_$plots_647.style(gd)},_$cartesian_595.toSVG=function(gd){var imageRoot=gd._fullLayout._glimages,root=_$d3_127.select(gd).selectAll(".svg-container");root.filter(function(d,i){return i===root.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function canvasToImage(){var imageData=this.toDataURL("image/png");imageRoot.append("svg:image").attr({xmlns:_$xmlns_namespaces_519.svg,"xlink:href":imageData,preserveAspectRatio:"none",x:0,y:0,width:this.width,height:this.height})})};var mergeArray=_$lib_539.mergeArray,_$arraysToCalcdata_677=function arraysToCalcdata(cd,trace){for(var i=0;i<cd.length;i++)cd[i].i=i;mergeArray(trace.text,cd,"tx"),mergeArray(trace.hovertext,cd,"htx");var marker=trace.marker;if(marker){mergeArray(marker.opacity,cd,"mo"),mergeArray(marker.color,cd,"mc");var markerLine=marker.line;markerLine&&(mergeArray(markerLine.color,cd,"mlc"),mergeArray(markerLine.width,cd,"mlw"))}},__extendFlat_678=_$extend_528.extendFlat,textFontAttrs=_$font_attributes_611({editType:"calc",arrayOk:!0}),__scatterMarkerAttrs_678=_$attributes_862.marker,marker=__extendFlat_678({line:__extendFlat_678({width:__extendFlat_678({},__scatterMarkerAttrs_678.line.width,{dflt:0}),editType:"calc"},_$makeColorScaleAttributes_419()),editType:"calc"},_$makeColorScaleAttributes_419(),{showscale:__scatterMarkerAttrs_678.showscale,colorbar:_$attributes_412,opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"}}),_$attributes_678={x:_$attributes_862.x,x0:_$attributes_862.x0,dx:_$attributes_862.dx,y:_$attributes_862.y,y0:_$attributes_862.y0,dy:_$attributes_862.dy,text:_$attributes_862.text,hovertext:_$attributes_862.hovertext,textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"none",arrayOk:!0,editType:"calc"},textfont:__extendFlat_678({},textFontAttrs,{}),insidetextfont:__extendFlat_678({},textFontAttrs,{}),outsidetextfont:__extendFlat_678({},textFontAttrs,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:__extendFlat_678({},_$attributes_862.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:marker,selected:{marker:{opacity:_$attributes_862.selected.marker.opacity,color:_$attributes_862.selected.marker.color,editType:"style"},textfont:_$attributes_862.selected.textfont,editType:"style"},unselected:{marker:{opacity:_$attributes_862.unselected.marker.opacity,color:_$attributes_862.unselected.marker.color,editType:"style"},textfont:_$attributes_862.unselected.textfont,editType:"style"},r:_$attributes_862.r,t:_$attributes_862.t,_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}},_$calcSelection_864=function calcSelection(cd,trace){_$lib_539.isArrayOrTypedArray(trace.selectedpoints)&&_$lib_539.tagSelected(cd,trace)},__isArrayOrTypedArray_679=_$lib_539.isArrayOrTypedArray,_$handleStyleDefaults_690=function handleStyleDefaults(traceIn,traceOut,coerce,defaultColor,layout){coerce("marker.color",defaultColor),_$hasColorscale_425(traceIn,"marker")&&_$colorScaleDefaults_421(traceIn,traceOut,layout,coerce,{prefix:"marker.",cLetter:"c"}),coerce("marker.line.color",_$color_411.defaultLine),_$hasColorscale_425(traceIn,"marker.line")&&_$colorScaleDefaults_421(traceIn,traceOut,layout,coerce,{prefix:"marker.line.",cLetter:"c"}),coerce("marker.line.width"),coerce("marker.opacity"),coerce("selected.marker.color"),coerce("unselected.marker.color")},_$handleXYDefaults_886=function handleXYDefaults(traceIn,traceOut,layout,coerce){var len,x=coerce("x"),y=coerce("y");if(_$registry_668.getComponentMethod("calendars","handleTraceDefaults")(traceIn,traceOut,["x","y"],layout),x)y?len=Math.min(x.length,y.length):(len=x.length,coerce("y0"),coerce("dy"));else{if(!y)return 0;len=traceOut.y.length,coerce("x0"),coerce("dx")}return traceOut._length=len,len},_$hasHover_239={};(function(global){"use strict";var hasHover;hasHover="function"!=typeof global.matchMedia||!global.matchMedia("(hover: none)").matches,_$hasHover_239=hasHover}).call(this,void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var _$hasPassiveEvents_240=function detect(){var supported=!1;try{var opts=Object.defineProperty({},"passive",{get:function(){supported=!0}});window.addEventListener("test",null,opts),window.removeEventListener("test",null,opts)}catch(e){supported=!1}return supported}(),rootPosition={left:0,top:0},_$mouseEventOffset_263=function mouseEventOffset(ev,target,out){target=target||ev.currentTarget||ev.srcElement,Array.isArray(out)||(out=[0,0]);var cx=ev.clientX||0,cy=ev.clientY||0,rect=function getBoundingClientOffset(element){return element===window||element===document||element===document.body?rootPosition:element.getBoundingClientRect()}(target);return out[0]=cx-rect.left,out[1]=cy-rect.top,out};var cursorset=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]],_$constants_448={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"};function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}var _$EventEmitter_137=EventEmitter;function isFunction(arg){return"function"==typeof arg}function isObject(arg){return"object"==typeof arg&&null!==arg}function isUndefined(arg){return void 0===arg}EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(n){if(!function isNumber(arg){return"number"==typeof arg}(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");return this._maxListeners=n,this},EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(this._events||(this._events={}),"error"===type&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if((er=arguments[1])instanceof Error)throw er;var err=new Error('Uncaught, unspecified "error" event. ('+er+")");throw err.context=er,err}if(isUndefined(handler=this._events[type]))return!1;if(isFunction(handler))switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:args=Array.prototype.slice.call(arguments,1),handler.apply(this,args)}else if(isObject(handler))for(args=Array.prototype.slice.call(arguments,1),len=(listeners=handler.slice()).length,i=0;i<len;i++)listeners[i].apply(this,args);return!0},EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener),this._events[type]?isObject(this._events[type])?this._events[type].push(listener):this._events[type]=[this._events[type],listener]:this._events[type]=listener,isObject(this._events[type])&&!this._events[type].warned&&(m=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners)&&m>0&&this._events[type].length>m&&(this._events[type].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[type].length),"function"==typeof console.trace&&console.trace()),this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(type,listener){if(!isFunction(listener))throw TypeError("listener must be a function");var fired=!1;function g(){this.removeListener(type,g),fired||(fired=!0,listener.apply(this,arguments))}return g.listener=listener,this.on(type,g),this},EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;if(length=(list=this._events[type]).length,position=-1,list===listener||isFunction(list.listener)&&list.listener===listener)delete this._events[type],this._events.removeListener&&this.emit("removeListener",type,listener);else if(isObject(list)){for(i=length;i-- >0;)if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}if(position<0)return this;1===list.length?(list.length=0,delete this._events[type]):list.splice(position,1),this._events.removeListener&&this.emit("removeListener",type,listener)}return this},EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[type]&&delete this._events[type],this;if(0===arguments.length){for(key in this._events)"removeListener"!==key&&this.removeAllListeners(key);return this.removeAllListeners("removeListener"),this._events={},this}if(isFunction(listeners=this._events[type]))this.removeListener(type,listeners);else if(listeners)for(;listeners.length;)this.removeListener(type,listeners[listeners.length-1]);return delete this._events[type],this},EventEmitter.prototype.listeners=function(type){return this._events&&this._events[type]?isFunction(this._events[type])?[this._events[type]]:this._events[type].slice():[]},EventEmitter.prototype.listenerCount=function(type){if(this._events){var evlistener=this._events[type];if(isFunction(evlistener))return 1;if(evlistener)return evlistener.length}return 0},EventEmitter.listenerCount=function(emitter,type){return emitter.listenerCount(type)};var _$unhover_434,__EventEmitter_527=_$EventEmitter_137.EventEmitter,_$Events_527={init:function(plotObj){if(plotObj._ev instanceof __EventEmitter_527)return plotObj;var ev=new __EventEmitter_527,internalEv=new __EventEmitter_527;return plotObj._ev=ev,plotObj._internalEv=internalEv,plotObj.on=ev.on.bind(ev),plotObj.once=ev.once.bind(ev),plotObj.removeListener=ev.removeListener.bind(ev),plotObj.removeAllListeners=ev.removeAllListeners.bind(ev),plotObj._internalOn=internalEv.on.bind(internalEv),plotObj._internalOnce=internalEv.once.bind(internalEv),plotObj._removeInternalListener=internalEv.removeListener.bind(internalEv),plotObj._removeAllInternalListeners=internalEv.removeAllListeners.bind(internalEv),plotObj.emit=function(event,data){"undefined"!=typeof jQuery&&jQuery(plotObj).trigger(event,data),ev.emit(event,data),internalEv.emit(event,data)},plotObj},triggerHandler:function(plotObj,event,data){var jQueryHandlerValue,nodeEventHandlerValue;"undefined"!=typeof jQuery&&(jQueryHandlerValue=jQuery(plotObj).triggerHandler(event,data));var ev=plotObj._ev;if(!ev)return jQueryHandlerValue;var handlers=ev._events[event];if(!handlers)return jQueryHandlerValue;"function"==typeof handlers&&(handlers=[handlers]);for(var lastHandler=handlers.pop(),i=0;i<handlers.length;i++)handlers[i](data);return nodeEventHandlerValue=lastHandler(data),void 0!==jQueryHandlerValue?jQueryHandlerValue:nodeEventHandlerValue},purge:function(plotObj){return delete plotObj._ev,delete plotObj.on,delete plotObj.once,delete plotObj.removeListener,delete plotObj.removeAllListeners,delete plotObj.emit,delete plotObj._ev,delete plotObj._internalEv,delete plotObj._internalOn,delete plotObj._internalOnce,delete plotObj._removeInternalListener,delete plotObj._removeAllInternalListeners,plotObj}},unhover=_$unhover_434={};unhover.wrapped=function(gd,evt,subplot){(gd=_$get_graph_div_534(gd))._fullLayout&&_$throttle_563.clear(gd._fullLayout._uid+_$constants_448.HOVERID),unhover.raw(gd,evt,subplot)},unhover.raw=function unhoverRaw(gd,evt){var fullLayout=gd._fullLayout,oldhoverdata=gd._hoverdata;evt||(evt={}),evt.target&&!1===_$Events_527.triggerHandler(gd,"plotly_beforehover",evt)||(fullLayout._hoverlayer.selectAll("g").remove(),fullLayout._hoverlayer.selectAll("line").remove(),fullLayout._hoverlayer.selectAll("circle").remove(),gd._hoverdata=void 0,evt.target&&oldhoverdata&&gd.emit("plotly_unhover",{event:evt,points:oldhoverdata}))};var _$dragelement_433={},dragElement=_$dragelement_433={};function coverSlip(){var cover=document.createElement("div");cover.className="dragcover";var cStyle=cover.style;return cStyle.position="fixed",cStyle.left=0,cStyle.right=0,cStyle.top=0,cStyle.bottom=0,cStyle.zIndex=999999999,cStyle.background="none",document.body.appendChild(cover),cover}function pointerOffset(e){return _$mouseEventOffset_263(e.changedTouches?e.changedTouches[0]:e,document.body)}dragElement.align=function align(v,dv,v0,v1,anchor){var vmin=(v-v0)/(v1-v0),vmax=vmin+dv/(v1-v0),vc=(vmin+vmax)/2;return"left"===anchor||"bottom"===anchor?vmin:"center"===anchor||"middle"===anchor?vc:"right"===anchor||"top"===anchor?vmax:vmin<2/3-vc?vmin:vmax>4/3-vc?vmax:vc},dragElement.getCursor=function getCursor(x,y,xanchor,yanchor){return x="left"===xanchor?0:"center"===xanchor?1:"right"===xanchor?2:_$lib_539.constrain(Math.floor(3*x),0,2),y="bottom"===yanchor?0:"middle"===yanchor?1:"top"===yanchor?2:_$lib_539.constrain(Math.floor(3*y),0,2),cursorset[y][x]},dragElement.unhover=_$unhover_434.wrapped,dragElement.unhoverRaw=_$unhover_434.raw,dragElement.init=function init(options){var startX,startY,newMouseDownTime,cursor,dragCover,initialEvent,initialTarget,rightClick,gd=options.gd,numClicks=1,DBLCLICKDELAY=_$interactions_516.DBLCLICKDELAY,element=options.element;gd._mouseDownTime||(gd._mouseDownTime=0),element.style.pointerEvents="all",element.onmousedown=onStart,_$hasPassiveEvents_240?(element._ontouchstart&&element.removeEventListener("touchstart",element._ontouchstart),element._ontouchstart=onStart,element.addEventListener("touchstart",onStart,{passive:!1})):element.ontouchstart=onStart;var clampFn=options.clampFn||function _clampFn(dx,dy,minDrag){return Math.abs(dx)<minDrag&&(dx=0),Math.abs(dy)<minDrag&&(dy=0),[dx,dy]};function onStart(e){e.preventDefault(),gd._dragged=!1,gd._dragging=!0;var offset=pointerOffset(e);startX=offset[0],startY=offset[1],initialTarget=e.target,initialEvent=e,rightClick=2===e.buttons||e.ctrlKey,(newMouseDownTime=(new Date).getTime())-gd._mouseDownTime<DBLCLICKDELAY?numClicks+=1:(numClicks=1,gd._mouseDownTime=newMouseDownTime),options.prepFn&&options.prepFn(e,startX,startY),_$hasHover_239&&!rightClick?(dragCover=coverSlip()).style.cursor=window.getComputedStyle(element).cursor:_$hasHover_239||(dragCover=document,cursor=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(element).cursor),document.addEventListener("mousemove",onMove),document.addEventListener("mouseup",onDone),document.addEventListener("touchmove",onMove),document.addEventListener("touchend",onDone)}function onMove(e){e.preventDefault();var offset=pointerOffset(e),minDrag=options.minDrag||_$constants_589.MINDRAG,dxdy=clampFn(offset[0]-startX,offset[1]-startY,minDrag),dx=dxdy[0],dy=dxdy[1];(dx||dy)&&(gd._dragged=!0,dragElement.unhover(gd)),gd._dragged&&options.moveFn&&!rightClick&&options.moveFn(dx,dy)}function onDone(e){if(document.removeEventListener("mousemove",onMove),document.removeEventListener("mouseup",onDone),document.removeEventListener("touchmove",onMove),document.removeEventListener("touchend",onDone),e.preventDefault(),_$hasHover_239?_$lib_539.removeElement(dragCover):cursor&&(dragCover.documentElement.style.cursor=cursor,cursor=null),gd._dragging){if(gd._dragging=!1,(new Date).getTime()-gd._mouseDownTime>DBLCLICKDELAY&&(numClicks=Math.max(numClicks-1,1)),gd._dragged)options.doneFn&&options.doneFn(e);else if(options.clickFn&&options.clickFn(numClicks,initialEvent),!rightClick){var e2;try{e2=new MouseEvent("click",e)}catch(err){var offset=pointerOffset(e);(e2=document.createEvent("MouseEvents")).initMouseEvent("click",e.bubbles,e.cancelable,e.view,e.detail,e.screenX,e.screenY,offset[0],offset[1],e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget)}initialTarget.dispatchEvent(e2)}!function finishDrag(gd){gd._dragging=!1,gd._replotPending&&_$registry_668.call("plot",gd)}(gd),gd._dragged=!1}else gd._dragged=!1}},dragElement.coverSlip=coverSlip;function paste(traceAttr,cd,cdAttr,fn){fn=fn||_$lib_539.identity,Array.isArray(traceAttr)&&(cd[0][cdAttr]=fn(traceAttr))}var _$helpers_450={getSubplot:function getSubplot(trace){return trace.subplot||trace.xaxis+trace.yaxis||trace.geo},flat:function flat(subplots,v){for(var out=new Array(subplots.length),i=0;i<subplots.length;i++)out[i]=v;return out},p2c:function p2c(axArray,v){for(var out=new Array(axArray.length),i=0;i<axArray.length;i++)out[i]=axArray[i].p2c(v);return out},getDistanceFunction:function getDistanceFunction(mode,dx,dy,dxy){return"closest"===mode?dxy||_$helpers_450.quadrature(dx,dy):"x"===mode?dx:dy},getClosest:function getClosest(cd,distfn,pointData){if(!1!==pointData.index)pointData.index>=0&&pointData.index<cd.length?pointData.distance=0:pointData.index=!1;else for(var i=0;i<cd.length;i++){var newDistance=distfn(cd[i]);newDistance<=pointData.distance&&(pointData.index=i,pointData.distance=newDistance)}return pointData},inbox:function inbox(v0,v1,passVal){return v0*v1<0||0===v0?passVal:1/0},quadrature:function quadrature(dx,dy){return function(di){var x=dx(di),y=dy(di);return Math.sqrt(x*x+y*y)}},makeEventData:function makeEventData(pt,trace,cd){var pointNumber="index"in pt?pt.index:pt.pointNumber,out={data:trace._input,fullData:trace,curveNumber:trace.index,pointNumber:pointNumber};if(trace._indexToPoints){var pointIndices=trace._indexToPoints[pointNumber];1===pointIndices.length?out.pointIndex=pointIndices[0]:out.pointIndices=pointIndices}else out.pointIndex=pointNumber;return trace._module.eventData?out=trace._module.eventData(out,pt,trace,cd,pointNumber):("xVal"in pt?out.x=pt.xVal:"x"in pt&&(out.x=pt.x),"yVal"in pt?out.y=pt.yVal:"y"in pt&&(out.y=pt.y),pt.xa&&(out.xaxis=pt.xa),pt.ya&&(out.yaxis=pt.ya),void 0!==pt.zLabelVal&&(out.z=pt.zLabelVal)),_$helpers_450.appendArrayPointValue(out,trace,pointNumber),out},appendArrayPointValue:function(pointData,trace,pointNumber){var arrayAttrs=trace._arrayAttrs;if(arrayAttrs)for(var i=0;i<arrayAttrs.length;i++){var astr=arrayAttrs[i],key=getPointKey(astr);if(void 0===pointData[key]){var pointVal=getPointData(_$lib_539.nestedProperty(trace,astr).get(),pointNumber);void 0!==pointVal&&(pointData[key]=pointVal)}}},appendArrayMultiPointValues:function(pointData,trace,pointNumbers){var arrayAttrs=trace._arrayAttrs;if(arrayAttrs)for(var i=0;i<arrayAttrs.length;i++){var astr=arrayAttrs[i],key=getPointKey(astr);if(void 0===pointData[key]){for(var val=_$lib_539.nestedProperty(trace,astr).get(),keyVal=new Array(pointNumbers.length),j=0;j<pointNumbers.length;j++)keyVal[j]=getPointData(val,pointNumbers[j]);pointData[key]=keyVal}}}},pointKeyMap={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color"};function getPointKey(astr){return pointKeyMap[astr]||astr}function getPointData(val,pointNumber){return Array.isArray(pointNumber)?Array.isArray(val)&&Array.isArray(val[pointNumber[0]])?val[pointNumber[0]][pointNumber[1]]:void 0:val[pointNumber]}var _$setCursor_558=function setCursor(el3,csr){(el3.attr("class")||"").split(" ").forEach(function(cls){0===cls.indexOf("cursor-")&&el3.classed(cls,!1)}),csr&&el3.classed("cursor-"+csr,!0)},STASHATTR="data-savedcursor",_$overrideCursor_550=function overrideCursor(el3,csr){var savedCursor=el3.attr(STASHATTR);if(csr){if(!savedCursor){for(var classes=(el3.attr("class")||"").split(" "),i=0;i<classes.length;i++){var cls=classes[i];0===cls.indexOf("cursor-")&&el3.attr(STASHATTR,cls.substr(7)).classed(cls,!1)}el3.attr(STASHATTR)||el3.attr(STASHATTR,"!!")}_$setCursor_558(el3,csr)}else savedCursor&&(el3.attr(STASHATTR,null),"!!"===savedCursor?_$setCursor_558(el3):_$setCursor_558(el3,savedCursor))},_$hover_451={},YANGLE=_$constants_448.YANGLE,YA_RADIANS=Math.PI*YANGLE/180,YFACTOR=1/Math.sin(YA_RADIANS),YSHIFTX=Math.cos(YA_RADIANS),YSHIFTY=Math.sin(YA_RADIANS),HOVERARROWSIZE=_$constants_448.HOVERARROWSIZE,HOVERTEXTPAD=_$constants_448.HOVERTEXTPAD;function createHoverText(hoverData,opts,gd){var hovermode=opts.hovermode,rotateLabels=opts.rotateLabels,bgColor=opts.bgColor,container=opts.container,outerContainer=opts.outerContainer,commonLabelOpts=opts.commonLabelOpts||{},fontFamily=opts.fontFamily||_$constants_448.HOVERFONT,fontSize=opts.fontSize||_$constants_448.HOVERFONTSIZE,c0=hoverData[0],xa=c0.xa,ya=c0.ya,commonAttr="y"===hovermode?"yLabel":"xLabel",t0=c0[commonAttr],t00=(String(t0)||"").split(" ")[0],outerContainerBB=outerContainer.node().getBoundingClientRect(),outerTop=outerContainerBB.top,outerWidth=outerContainerBB.width,outerHeight=outerContainerBB.height,showCommonLabel=void 0!==t0&&c0.distance<=opts.hoverdistance&&("x"===hovermode||"y"===hovermode);if(showCommonLabel){var i,traceHoverinfo,allHaveZ=!0;for(i=0;i<hoverData.length;i++){allHaveZ&&void 0===hoverData[i].zLabel&&(allHaveZ=!1),traceHoverinfo=hoverData[i].hoverinfo||hoverData[i].trace.hoverinfo;var parts=Array.isArray(traceHoverinfo)?traceHoverinfo:traceHoverinfo.split("+");if(-1===parts.indexOf("all")&&-1===parts.indexOf(hovermode)){showCommonLabel=!1;break}}allHaveZ&&(showCommonLabel=!1)}var commonLabel=container.selectAll("g.axistext").data(showCommonLabel?[0]:[]);commonLabel.enter().append("g").classed("axistext",!0),commonLabel.exit().remove(),commonLabel.each(function(){var label=_$d3_127.select(this),lpath=label.selectAll("path").data([0]),ltext=label.selectAll("text").data([0]);lpath.enter().append("path").style({"stroke-width":"1px"}),lpath.style({fill:commonLabelOpts.bgcolor||_$color_411.defaultLine,stroke:commonLabelOpts.bordercolor||_$color_411.background}),ltext.enter().append("text").attr("data-notex",1),ltext.text(t0).call(_$drawing_436.font,commonLabelOpts.font.family||fontFamily,commonLabelOpts.font.size||fontSize,commonLabelOpts.font.color||_$color_411.background).call(_$svg_text_utils_562.positionText,0,0).call(_$svg_text_utils_562.convertToTspans,gd),label.attr("transform","");var tbb=ltext.node().getBoundingClientRect();if("x"===hovermode){ltext.attr("text-anchor","middle").call(_$svg_text_utils_562.positionText,0,"top"===xa.side?outerTop-tbb.bottom-HOVERARROWSIZE-HOVERTEXTPAD:outerTop-tbb.top+HOVERARROWSIZE+HOVERTEXTPAD);var topsign="top"===xa.side?"-":"";lpath.attr("d","M0,0L"+HOVERARROWSIZE+","+topsign+HOVERARROWSIZE+"H"+(HOVERTEXTPAD+tbb.width/2)+"v"+topsign+(2*HOVERTEXTPAD+tbb.height)+"H-"+(HOVERTEXTPAD+tbb.width/2)+"V"+topsign+HOVERARROWSIZE+"H-"+HOVERARROWSIZE+"Z"),label.attr("transform","translate("+(xa._offset+(c0.x0+c0.x1)/2)+","+(ya._offset+("top"===xa.side?0:ya._length))+")")}else{ltext.attr("text-anchor","right"===ya.side?"start":"end").call(_$svg_text_utils_562.positionText,("right"===ya.side?1:-1)*(HOVERTEXTPAD+HOVERARROWSIZE),outerTop-tbb.top-tbb.height/2);var leftsign="right"===ya.side?"":"-";lpath.attr("d","M0,0L"+leftsign+HOVERARROWSIZE+","+HOVERARROWSIZE+"V"+(HOVERTEXTPAD+tbb.height/2)+"h"+leftsign+(2*HOVERTEXTPAD+tbb.width)+"V-"+(HOVERTEXTPAD+tbb.height/2)+"H"+leftsign+HOVERARROWSIZE+"V-"+HOVERARROWSIZE+"Z"),label.attr("transform","translate("+(xa._offset+("right"===ya.side?xa._length:0))+","+(ya._offset+(c0.y0+c0.y1)/2)+")")}hoverData=hoverData.filter(function(d){return void 0!==d.zLabelVal||(d[commonAttr]||"").split(" ")[0]===t00})});var hoverLabels=container.selectAll("g.hovertext").data(hoverData,function(d){return[d.trace.index,d.index,d.x0,d.y0,d.name,d.attr,d.xa,d.ya||""].join(",")});return hoverLabels.enter().append("g").classed("hovertext",!0).each(function(){var g=_$d3_127.select(this);g.append("rect").call(_$color_411.fill,_$color_411.addOpacity(bgColor,.8)),g.append("text").classed("name",!0),g.append("path").style("stroke-width","1px"),g.append("text").classed("nums",!0).call(_$drawing_436.font,fontFamily,fontSize)}),hoverLabels.exit().remove(),hoverLabels.each(function(d){var g=_$d3_127.select(this).attr("transform",""),name="",text="",baseColor=_$color_411.opacity(d.color)?d.color:_$color_411.defaultLine,traceColor=_$color_411.combine(baseColor,bgColor),contrastColor=d.borderColor||_$color_411.contrast(traceColor);if(void 0!==d.nameOverride&&(d.name=d.nameOverride),d.name){name=_$svg_text_utils_562.plainText(d.name||"");var nameLength=Math.round(d.nameLength);nameLength>-1&&name.length>nameLength&&(name=nameLength>3?name.substr(0,nameLength-3)+"...":name.substr(0,nameLength))}void 0!==d.extraText&&(text+=d.extraText),void 0!==d.zLabel?(void 0!==d.xLabel&&(text+="x: "+d.xLabel+"<br>"),void 0!==d.yLabel&&(text+="y: "+d.yLabel+"<br>"),text+=(text?"z: ":"")+d.zLabel):showCommonLabel&&d[hovermode+"Label"]===t0?text=d[("x"===hovermode?"y":"x")+"Label"]||"":void 0===d.xLabel?void 0!==d.yLabel&&(text=d.yLabel):text=void 0===d.yLabel?d.xLabel:"("+d.xLabel+", "+d.yLabel+")",d.text&&!Array.isArray(d.text)&&(text+=(text?"<br>":"")+d.text),""===text&&(""===name&&g.remove(),text=name);var tx=g.select("text.nums").call(_$drawing_436.font,d.fontFamily||fontFamily,d.fontSize||fontSize,d.fontColor||contrastColor).text(text).attr("data-notex",1).call(_$svg_text_utils_562.positionText,0,0).call(_$svg_text_utils_562.convertToTspans,gd),tx2=g.select("text.name"),tx2width=0;name&&name!==text?(tx2.call(_$drawing_436.font,d.fontFamily||fontFamily,d.fontSize||fontSize,traceColor).text(name).attr("data-notex",1).call(_$svg_text_utils_562.positionText,0,0).call(_$svg_text_utils_562.convertToTspans,gd),tx2width=tx2.node().getBoundingClientRect().width+2*HOVERTEXTPAD):(tx2.remove(),g.select("rect").remove()),g.select("path").style({fill:traceColor,stroke:contrastColor});var anchorStartOK,anchorEndOK,tbb=tx.node().getBoundingClientRect(),htx=d.xa._offset+(d.x0+d.x1)/2,hty=d.ya._offset+(d.y0+d.y1)/2,dx=Math.abs(d.x1-d.x0),dy=Math.abs(d.y1-d.y0),txTotalWidth=tbb.width+HOVERARROWSIZE+HOVERTEXTPAD+tx2width;d.ty0=outerTop-tbb.top,d.bx=tbb.width+2*HOVERTEXTPAD,d.by=tbb.height+2*HOVERTEXTPAD,d.anchor="start",d.txwidth=tbb.width,d.tx2width=tx2width,d.offset=0,rotateLabels?(d.pos=htx,anchorStartOK=hty+dy/2+txTotalWidth<=outerHeight,anchorEndOK=hty-dy/2-txTotalWidth>=0,"top"!==d.idealAlign&&anchorStartOK||!anchorEndOK?anchorStartOK?(hty+=dy/2,d.anchor="start"):d.anchor="middle":(hty-=dy/2,d.anchor="end")):(d.pos=hty,anchorStartOK=htx+dx/2+txTotalWidth<=outerWidth,anchorEndOK=htx-dx/2-txTotalWidth>=0,"left"!==d.idealAlign&&anchorStartOK||!anchorEndOK?anchorStartOK?(htx+=dx/2,d.anchor="start"):d.anchor="middle":(htx-=dx/2,d.anchor="end")),tx.attr("text-anchor",d.anchor),tx2width&&tx2.attr("text-anchor",d.anchor),g.attr("transform","translate("+htx+","+hty+")"+(rotateLabels?"rotate("+YANGLE+")":""))}),hoverLabels}function alignHoverText(hoverLabels,rotateLabels){hoverLabels.each(function(d){var g=_$d3_127.select(this);if(d.del)g.remove();else{var horzSign="end"===d.anchor?-1:1,tx=g.select("text.nums"),alignShift={start:1,end:-1,middle:0}[d.anchor],txx=alignShift*(HOVERARROWSIZE+HOVERTEXTPAD),tx2x=txx+alignShift*(d.txwidth+HOVERTEXTPAD),offsetX=0,offsetY=d.offset;"middle"===d.anchor&&(txx-=d.tx2width/2,tx2x+=d.txwidth/2+HOVERTEXTPAD),rotateLabels&&(offsetY*=-YSHIFTY,offsetX=d.offset*YSHIFTX),g.select("path").attr("d","middle"===d.anchor?"M-"+(d.bx/2+d.tx2width/2)+","+(offsetY-d.by/2)+"h"+d.bx+"v"+d.by+"h-"+d.bx+"Z":"M0,0L"+(horzSign*HOVERARROWSIZE+offsetX)+","+(HOVERARROWSIZE+offsetY)+"v"+(d.by/2-HOVERARROWSIZE)+"h"+horzSign*d.bx+"v-"+d.by+"H"+(horzSign*HOVERARROWSIZE+offsetX)+"V"+(offsetY-HOVERARROWSIZE)+"Z"),tx.call(_$svg_text_utils_562.positionText,txx+offsetX,offsetY+d.ty0-d.by/2+HOVERTEXTPAD),d.tx2width&&(g.select("text.name").call(_$svg_text_utils_562.positionText,tx2x+alignShift*HOVERTEXTPAD+offsetX,offsetY+d.ty0-d.by/2+HOVERTEXTPAD),g.select("rect").call(_$drawing_436.setRect,tx2x+(alignShift-1)*d.tx2width/2+offsetX,offsetY-d.by/2-1,d.tx2width,d.by+2))}})}function cleanPoint(d,hovermode){var index=d.index,trace=d.trace||{},cd0=d.cd[0],cd=d.cd[index]||{},getVal=Array.isArray(index)?function(calcKey,traceKey){return _$lib_539.castOption(cd0,index,calcKey)||_$lib_539.extractOption({},trace,"",traceKey)}:function(calcKey,traceKey){return _$lib_539.extractOption(cd,trace,calcKey,traceKey)};function fill(key,calcKey,traceKey){var val=getVal(calcKey,traceKey);val&&(d[key]=val)}if(fill("hoverinfo","hi","hoverinfo"),fill("color","hbg","hoverlabel.bgcolor"),fill("borderColor","hbc","hoverlabel.bordercolor"),fill("fontFamily","htf","hoverlabel.font.family"),fill("fontSize","hts","hoverlabel.font.size"),fill("fontColor","htc","hoverlabel.font.color"),fill("nameLength","hnl","hoverlabel.namelength"),d.posref="y"===hovermode?d.xa._offset+(d.x0+d.x1)/2:d.ya._offset+(d.y0+d.y1)/2,d.x0=_$lib_539.constrain(d.x0,0,d.xa._length),d.x1=_$lib_539.constrain(d.x1,0,d.xa._length),d.y0=_$lib_539.constrain(d.y0,0,d.ya._length),d.y1=_$lib_539.constrain(d.y1,0,d.ya._length),void 0!==d.xLabelVal&&(d.xLabel="xLabel"in d?d.xLabel:_$axes_584.hoverLabelText(d.xa,d.xLabelVal),d.xVal=d.xa.c2d(d.xLabelVal)),void 0!==d.yLabelVal&&(d.yLabel="yLabel"in d?d.yLabel:_$axes_584.hoverLabelText(d.ya,d.yLabelVal),d.yVal=d.ya.c2d(d.yLabelVal)),void 0!==d.zLabelVal&&void 0===d.zLabel&&(d.zLabel=String(d.zLabelVal)),!(isNaN(d.xerr)||"log"===d.xa.type&&d.xerr<=0)){var xeText=_$axes_584.tickText(d.xa,d.xa.c2l(d.xerr),"hover").text;void 0!==d.xerrneg?d.xLabel+=" +"+xeText+" / -"+_$axes_584.tickText(d.xa,d.xa.c2l(d.xerrneg),"hover").text:d.xLabel+=" ± "+xeText,"x"===hovermode&&(d.distance+=1)}if(!(isNaN(d.yerr)||"log"===d.ya.type&&d.yerr<=0)){var yeText=_$axes_584.tickText(d.ya,d.ya.c2l(d.yerr),"hover").text;void 0!==d.yerrneg?d.yLabel+=" +"+yeText+" / -"+_$axes_584.tickText(d.ya,d.ya.c2l(d.yerrneg),"hover").text:d.yLabel+=" ± "+yeText,"y"===hovermode&&(d.distance+=1)}var infomode=d.hoverinfo||d.trace.hoverinfo;return"all"!==infomode&&(-1===(infomode=Array.isArray(infomode)?infomode:infomode.split("+")).indexOf("x")&&(d.xLabel=void 0),-1===infomode.indexOf("y")&&(d.yLabel=void 0),-1===infomode.indexOf("z")&&(d.zLabel=void 0),-1===infomode.indexOf("text")&&(d.text=void 0),-1===infomode.indexOf("name")&&(d.name=void 0)),d}function createSpikelines(closestPoints,opts){var xa,ya,container=opts.container,fullLayout=opts.fullLayout,evt=opts.event,showY=!!closestPoints.hLinePoint,showX=!!closestPoints.vLinePoint;if(container.selectAll(".spikeline").remove(),showX||showY){var contrastColor=_$color_411.combine(fullLayout.plot_bgcolor,fullLayout.paper_bgcolor);if(showY){var hLinePointX,hLinePointY,hLinePoint=closestPoints.hLinePoint;xa=hLinePoint&&hLinePoint.xa,"cursor"===(ya=hLinePoint&&hLinePoint.ya).spikesnap?(hLinePointX=evt.pointerX,hLinePointY=evt.pointerY):(hLinePointX=xa._offset+hLinePoint.x,hLinePointY=ya._offset+hLinePoint.y);var xBase,xEndSpike,dfltHLineColor=_$tinycolor_352.readability(hLinePoint.color,contrastColor)<1.5?_$color_411.contrast(contrastColor):hLinePoint.color,yMode=ya.spikemode,yThickness=ya.spikethickness,yColor=ya.spikecolor||dfltHLineColor,yBB=ya._boundingBox,xEdge=(yBB.left+yBB.right)/2<hLinePointX?yBB.right:yBB.left;-1===yMode.indexOf("toaxis")&&-1===yMode.indexOf("across")||(-1!==yMode.indexOf("toaxis")&&(xBase=xEdge,xEndSpike=hLinePointX),-1!==yMode.indexOf("across")&&(xBase=ya._counterSpan[0],xEndSpike=ya._counterSpan[1]),container.insert("line",":first-child").attr({x1:xBase,x2:xEndSpike,y1:hLinePointY,y2:hLinePointY,"stroke-width":yThickness,stroke:yColor,"stroke-dasharray":_$drawing_436.dashStyle(ya.spikedash,yThickness)}).classed("spikeline",!0).classed("crisp",!0),container.insert("line",":first-child").attr({x1:xBase,x2:xEndSpike,y1:hLinePointY,y2:hLinePointY,"stroke-width":yThickness+2,stroke:contrastColor}).classed("spikeline",!0).classed("crisp",!0)),-1!==yMode.indexOf("marker")&&container.insert("circle",":first-child").attr({cx:xEdge+("right"!==ya.side?yThickness:-yThickness),cy:hLinePointY,r:yThickness,fill:yColor}).classed("spikeline",!0)}if(showX){var vLinePointX,vLinePointY,vLinePoint=closestPoints.vLinePoint;xa=vLinePoint&&vLinePoint.xa,ya=vLinePoint&&vLinePoint.ya,"cursor"===xa.spikesnap?(vLinePointX=evt.pointerX,vLinePointY=evt.pointerY):(vLinePointX=xa._offset+vLinePoint.x,vLinePointY=ya._offset+vLinePoint.y);var yBase,yEndSpike,dfltVLineColor=_$tinycolor_352.readability(vLinePoint.color,contrastColor)<1.5?_$color_411.contrast(contrastColor):vLinePoint.color,xMode=xa.spikemode,xThickness=xa.spikethickness,xColor=xa.spikecolor||dfltVLineColor,xBB=xa._boundingBox,yEdge=(xBB.top+xBB.bottom)/2<vLinePointY?xBB.bottom:xBB.top;-1===xMode.indexOf("toaxis")&&-1===xMode.indexOf("across")||(-1!==xMode.indexOf("toaxis")&&(yBase=yEdge,yEndSpike=vLinePointY),-1!==xMode.indexOf("across")&&(yBase=xa._counterSpan[0],yEndSpike=xa._counterSpan[1]),container.insert("line",":first-child").attr({x1:vLinePointX,x2:vLinePointX,y1:yBase,y2:yEndSpike,"stroke-width":xThickness,stroke:xColor,"stroke-dasharray":_$drawing_436.dashStyle(xa.spikedash,xThickness)}).classed("spikeline",!0).classed("crisp",!0),container.insert("line",":first-child").attr({x1:vLinePointX,x2:vLinePointX,y1:yBase,y2:yEndSpike,"stroke-width":xThickness+2,stroke:contrastColor}).classed("spikeline",!0).classed("crisp",!0)),-1!==xMode.indexOf("marker")&&container.insert("circle",":first-child").attr({cx:vLinePointX,cy:yEdge-("top"!==xa.side?xThickness:-xThickness),r:xThickness,fill:xColor}).classed("spikeline",!0)}}}function spikesChanged(gd,oldspikepoints){return!oldspikepoints||(oldspikepoints.vLinePoint!==gd._spikepoints.vLinePoint||oldspikepoints.hLinePoint!==gd._spikepoints.hLinePoint)}_$hover_451.hover=function hover(gd,evt,subplot,noHoverEvent){gd=_$lib_539.getGraphDiv(gd),_$lib_539.throttle(gd._fullLayout._uid+_$constants_448.HOVERID,_$constants_448.HOVERMINTIME,function(){!function _hover(gd,evt,subplot,noHoverEvent){subplot||(subplot="xy");var subplots=Array.isArray(subplot)?subplot:[subplot],fullLayout=gd._fullLayout,plots=fullLayout._plots||[],plotinfo=plots[subplot],hasCartesian=fullLayout._has("cartesian");if(plotinfo){var overlayedSubplots=plotinfo.overlays.map(function(pi){return pi.id});subplots=subplots.concat(overlayedSubplots)}for(var len=subplots.length,xaArray=new Array(len),yaArray=new Array(len),supportsCompare=!1,i=0;i<len;i++){var spId=subplots[i],plotObj=plots[spId];if(plotObj)supportsCompare=!0,xaArray[i]=_$axes_584.getFromId(gd,plotObj.xaxis._id),yaArray[i]=_$axes_584.getFromId(gd,plotObj.yaxis._id);else{var _subplot=fullLayout[spId]._subplot;xaArray[i]=_subplot.xaxis,yaArray[i]=_subplot.yaxis}}var hovermode=evt.hovermode||fullLayout.hovermode;hovermode&&!supportsCompare&&(hovermode="closest");if(-1===["x","y","closest"].indexOf(hovermode)||!gd.calcdata||gd.querySelector(".zoombox")||gd._dragging)return _$dragelement_433.unhoverRaw(gd,evt);var xvalArray,yvalArray,itemnum,curvenum,cd,trace,subplotId,subploti,mode,xval,yval,pointData,closedataPreviousLength,hoverdistance=-1===fullLayout.hoverdistance?1/0:fullLayout.hoverdistance,spikedistance=-1===fullLayout.spikedistance?1/0:fullLayout.spikedistance,hoverData=[],searchData=[],spikePoints={hLinePoint:null,vLinePoint:null};if(Array.isArray(evt))for(hovermode="array",itemnum=0;itemnum<evt.length;itemnum++)"skip"!==(cd=gd.calcdata[evt[itemnum].curveNumber||0])[0].trace.hoverinfo&&searchData.push(cd);else{for(curvenum=0;curvenum<gd.calcdata.length;curvenum++)cd=gd.calcdata[curvenum],"skip"!==(trace=cd[0].trace).hoverinfo&&-1!==subplots.indexOf(_$helpers_450.getSubplot(trace))&&searchData.push(cd);var xpx,ypx,hasUserCalledHover=!evt.target;if(hasUserCalledHover)xpx="xpx"in evt?evt.xpx:xaArray[0]._length/2,evt.pointerX=xpx+xaArray[0]._offset,ypx="ypx"in evt?evt.ypx:yaArray[0]._length/2,evt.pointerY=ypx+yaArray[0]._offset;else{if(!1===_$Events_527.triggerHandler(gd,"plotly_beforehover",evt))return;var dbb=evt.target.getBoundingClientRect();if(xpx=evt.clientX-dbb.left,ypx=evt.clientY-dbb.top,xpx<0||xpx>dbb.width||ypx<0||ypx>dbb.height)return _$dragelement_433.unhoverRaw(gd,evt);evt.pointerX=evt.offsetX,evt.pointerY=evt.offsetY}if(xvalArray="xval"in evt?_$helpers_450.flat(subplots,evt.xval):_$helpers_450.p2c(xaArray,xpx),yvalArray="yval"in evt?_$helpers_450.flat(subplots,evt.yval):_$helpers_450.p2c(yaArray,ypx),!_$fastIsnumeric_139(xvalArray[0])||!_$fastIsnumeric_139(yvalArray[0]))return _$lib_539.warn("Fx.hover failed",evt,gd),_$dragelement_433.unhoverRaw(gd,evt)}var distance=1/0;for(curvenum=0;curvenum<searchData.length;curvenum++)if((cd=searchData[curvenum])&&cd[0]&&cd[0].trace&&!0===cd[0].trace.visible&&(trace=cd[0].trace,-1===["carpet","contourcarpet"].indexOf(trace._module.name))){if(subplotId=_$helpers_450.getSubplot(trace),subploti=subplots.indexOf(subplotId),mode=hovermode,pointData={cd:cd,trace:trace,xa:xaArray[subploti],ya:yaArray[subploti],maxHoverDistance:hoverdistance,maxSpikeDistance:spikedistance,index:!1,distance:Math.min(distance,hoverdistance),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:_$color_411.defaultLine,name:trace.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},fullLayout[subplotId]&&(pointData.subplot=fullLayout[subplotId]._subplot),closedataPreviousLength=hoverData.length,"array"===mode){var selection=evt[curvenum];"pointNumber"in selection?(pointData.index=selection.pointNumber,mode="closest"):(mode="","xval"in selection&&(xval=selection.xval,mode="x"),"yval"in selection&&(yval=selection.yval,mode=mode?"closest":"y"))}else xval=xvalArray[subploti],yval=yvalArray[subploti];if(0!==hoverdistance)if(trace._module&&trace._module.hoverPoints){var newPoints=trace._module.hoverPoints(pointData,xval,yval,mode,fullLayout._hoverlayer);if(newPoints)for(var newPoint,newPointNum=0;newPointNum<newPoints.length;newPointNum++)newPoint=newPoints[newPointNum],_$fastIsnumeric_139(newPoint.x0)&&_$fastIsnumeric_139(newPoint.y0)&&hoverData.push(cleanPoint(newPoint,hovermode))}else _$lib_539.log("Unrecognized trace type in hover:",trace);if("closest"===hovermode&&hoverData.length>closedataPreviousLength&&(hoverData.splice(0,closedataPreviousLength),distance=hoverData[0].distance),hasCartesian&&0!==spikedistance&&0===hoverData.length){pointData.distance=spikedistance,pointData.index=!1;var closestPoints=trace._module.hoverPoints(pointData,xval,yval,"closest",fullLayout._hoverlayer);if(closestPoints&&(closestPoints=closestPoints.filter(function(point){return point.spikeDistance<=spikedistance})),closestPoints&&closestPoints.length){var tmpPoint,closestVPoints=closestPoints.filter(function(point){return point.xa.showspikes});if(closestVPoints.length){var closestVPt=closestVPoints[0];_$fastIsnumeric_139(closestVPt.x0)&&_$fastIsnumeric_139(closestVPt.y0)&&(tmpPoint=fillSpikePoint(closestVPt),(!spikePoints.vLinePoint||spikePoints.vLinePoint.spikeDistance>tmpPoint.spikeDistance)&&(spikePoints.vLinePoint=tmpPoint))}var closestHPoints=closestPoints.filter(function(point){return point.ya.showspikes});if(closestHPoints.length){var closestHPt=closestHPoints[0];_$fastIsnumeric_139(closestHPt.x0)&&_$fastIsnumeric_139(closestHPt.y0)&&(tmpPoint=fillSpikePoint(closestHPt),(!spikePoints.hLinePoint||spikePoints.hLinePoint.spikeDistance>tmpPoint.spikeDistance)&&(spikePoints.hLinePoint=tmpPoint))}}}}function selectClosestPoint(pointsData,spikedistance){for(var thisSpikeDistance,resultPoint=null,minDistance=1/0,i=0;i<pointsData.length;i++)(thisSpikeDistance=pointsData[i].spikeDistance)<minDistance&&thisSpikeDistance<=spikedistance&&(resultPoint=pointsData[i],minDistance=thisSpikeDistance);return resultPoint}function fillSpikePoint(point){return point?{xa:point.xa,ya:point.ya,x:void 0!==point.xSpike?point.xSpike:(point.x0+point.x1)/2,y:void 0!==point.ySpike?point.ySpike:(point.y0+point.y1)/2,distance:point.distance,spikeDistance:point.spikeDistance,curveNumber:point.trace.index,color:point.color,pointNumber:point.index}:null}var spikelineOpts={fullLayout:fullLayout,container:fullLayout._hoverlayer,outerContainer:fullLayout._paperdiv,event:evt},oldspikepoints=gd._spikepoints,newspikepoints={vLinePoint:spikePoints.vLinePoint,hLinePoint:spikePoints.hLinePoint};if(gd._spikepoints=newspikepoints,hasCartesian&&0!==spikedistance&&0!==hoverData.length){var tmpHPointData=hoverData.filter(function(point){return point.ya.showspikes}),tmpHPoint=selectClosestPoint(tmpHPointData,spikedistance);spikePoints.hLinePoint=fillSpikePoint(tmpHPoint);var tmpVPointData=hoverData.filter(function(point){return point.xa.showspikes}),tmpVPoint=selectClosestPoint(tmpVPointData,spikedistance);spikePoints.vLinePoint=fillSpikePoint(tmpVPoint)}if(0===hoverData.length){var result=_$dragelement_433.unhoverRaw(gd,evt);return!hasCartesian||null===spikePoints.hLinePoint&&null===spikePoints.vLinePoint||spikesChanged(oldspikepoints)&&createSpikelines(spikePoints,spikelineOpts),result}hasCartesian&&spikesChanged(oldspikepoints)&&createSpikelines(spikePoints,spikelineOpts);hoverData.sort(function(d1,d2){return d1.distance-d2.distance});var oldhoverdata=gd._hoverdata,newhoverdata=[];for(itemnum=0;itemnum<hoverData.length;itemnum++){var pt=hoverData[itemnum];newhoverdata.push(_$helpers_450.makeEventData(pt,pt.trace,pt.cd))}gd._hoverdata=newhoverdata;var rotateLabels="y"===hovermode&&searchData.length>1,bgColor=_$color_411.combine(fullLayout.plot_bgcolor||_$color_411.background,fullLayout.paper_bgcolor),labelOpts={hovermode:hovermode,rotateLabels:rotateLabels,bgColor:bgColor,container:fullLayout._hoverlayer,outerContainer:fullLayout._paperdiv,commonLabelOpts:fullLayout.hoverlabel,hoverdistance:fullLayout.hoverdistance},hoverLabels=createHoverText(hoverData,labelOpts,gd);if(function hoverAvoidOverlaps(hoverData,ax,fullLayout){var donepositioning,topOverlap,bottomOverlap,i,j,pti,sumdp,nummoves=0,pointgroups=hoverData.map(function(d,i){var axis=d[ax];return[{i:i,dp:0,pos:d.pos,posref:d.posref,size:d.by*("x"===axis._id.charAt(0)?YFACTOR:1)/2,pmin:0,pmax:"x"===axis._id.charAt(0)?fullLayout.width:fullLayout.height}]}).sort(function(a,b){return a[0].posref-b[0].posref});function constrainGroup(grp){var minPt=grp[0],maxPt=grp[grp.length-1];if(topOverlap=minPt.pmin-minPt.pos-minPt.dp+minPt.size,bottomOverlap=maxPt.pos+maxPt.dp+maxPt.size-minPt.pmax,topOverlap>.01){for(j=grp.length-1;j>=0;j--)grp[j].dp+=topOverlap;donepositioning=!1}if(!(bottomOverlap<.01)){if(topOverlap<-.01){for(j=grp.length-1;j>=0;j--)grp[j].dp-=bottomOverlap;donepositioning=!1}if(donepositioning){var deleteCount=0;for(i=0;i<grp.length;i++)(pti=grp[i]).pos+pti.dp+pti.size>minPt.pmax&&deleteCount++;for(i=grp.length-1;i>=0&&!(deleteCount<=0);i--)(pti=grp[i]).pos>minPt.pmax-1&&(pti.del=!0,deleteCount--);for(i=0;i<grp.length&&!(deleteCount<=0);i++)if((pti=grp[i]).pos<minPt.pmin+1)for(pti.del=!0,deleteCount--,bottomOverlap=2*pti.size,j=grp.length-1;j>=0;j--)grp[j].dp-=bottomOverlap;for(i=grp.length-1;i>=0&&!(deleteCount<=0);i--)(pti=grp[i]).pos+pti.dp+pti.size>minPt.pmax&&(pti.del=!0,deleteCount--)}}}for(;!donepositioning&&nummoves<=hoverData.length;){for(nummoves++,donepositioning=!0,i=0;i<pointgroups.length-1;){var g0=pointgroups[i],g1=pointgroups[i+1],p0=g0[g0.length-1],p1=g1[0];if((topOverlap=p0.pos+p0.dp+p0.size-p1.pos-p1.dp+p1.size)>.01&&p0.pmin===p1.pmin&&p0.pmax===p1.pmax){for(j=g1.length-1;j>=0;j--)g1[j].dp+=topOverlap;for(g0.push.apply(g0,g1),pointgroups.splice(i+1,1),sumdp=0,j=g0.length-1;j>=0;j--)sumdp+=g0[j].dp;for(bottomOverlap=sumdp/g0.length,j=g0.length-1;j>=0;j--)g0[j].dp-=bottomOverlap;donepositioning=!1}else i++}pointgroups.forEach(constrainGroup)}for(i=pointgroups.length-1;i>=0;i--){var grp=pointgroups[i];for(j=grp.length-1;j>=0;j--){var pt=grp[j],hoverPt=hoverData[pt.i];hoverPt.offset=pt.dp,hoverPt.del=pt.del}}}(hoverData,rotateLabels?"xa":"ya",fullLayout),alignHoverText(hoverLabels,rotateLabels),evt.target&&evt.target.tagName){var hasClickToShow=_$registry_668.getComponentMethod("annotations","hasClickToShow")(gd,newhoverdata);_$overrideCursor_550(_$d3_127.select(evt.target),hasClickToShow?"pointer":"")}if(!evt.target||noHoverEvent||!function hoverChanged(gd,evt,oldhoverdata){if(!oldhoverdata||oldhoverdata.length!==gd._hoverdata.length)return!0;for(var i=oldhoverdata.length-1;i>=0;i--){var oldPt=oldhoverdata[i],newPt=gd._hoverdata[i];if(oldPt.curveNumber!==newPt.curveNumber||String(oldPt.pointNumber)!==String(newPt.pointNumber))return!0}return!1}(gd,0,oldhoverdata))return;oldhoverdata&&gd.emit("plotly_unhover",{event:evt,points:oldhoverdata});gd.emit("plotly_hover",{event:evt,points:gd._hoverdata,xaxes:xaArray,yaxes:yaArray,xvals:xvalArray,yvals:yvalArray})}(gd,evt,subplot,noHoverEvent)})},_$hover_451.loneHover=function loneHover(hoverItem,opts){var pointData={color:hoverItem.color||_$color_411.defaultLine,x0:hoverItem.x0||hoverItem.x||0,x1:hoverItem.x1||hoverItem.x||0,y0:hoverItem.y0||hoverItem.y||0,y1:hoverItem.y1||hoverItem.y||0,xLabel:hoverItem.xLabel,yLabel:hoverItem.yLabel,zLabel:hoverItem.zLabel,text:hoverItem.text,name:hoverItem.name,idealAlign:hoverItem.idealAlign,borderColor:hoverItem.borderColor,fontFamily:hoverItem.fontFamily,fontSize:hoverItem.fontSize,fontColor:hoverItem.fontColor,trace:{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0},container3=_$d3_127.select(opts.container),outerContainer3=opts.outerContainer?_$d3_127.select(opts.outerContainer):container3,fullOpts={hovermode:"closest",rotateLabels:!1,bgColor:opts.bgColor||_$color_411.background,container:container3,outerContainer:outerContainer3},hoverLabel=createHoverText([pointData],fullOpts,opts.gd);return alignHoverText(hoverLabel,fullOpts.rotateLabels),hoverLabel.node()};var hover=_$hover_451.hover,_$handleHoverLabelDefaults_452=function handleHoverLabelDefaults(contIn,contOut,coerce,opts){coerce("hoverlabel.bgcolor",(opts=opts||{}).bgcolor),coerce("hoverlabel.bordercolor",opts.bordercolor),coerce("hoverlabel.namelength",opts.namelength),_$lib_539.coerceFont(coerce,"hoverlabel.font",opts.font)},__fontAttrs_454=_$font_attributes_611({editType:"none"});__fontAttrs_454.family.dflt=_$constants_448.HOVERFONT,__fontAttrs_454.size.dflt=_$constants_448.HOVERFONTSIZE;var _$layout_attributes_454={dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","orbit","turntable"],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1],editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:20,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:__fontAttrs_454,namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"}};var _$fx_453={moduleType:"component",name:"fx",constants:_$constants_448,schema:{layout:_$layout_attributes_454},attributes:_$attributes_445,layoutAttributes:_$layout_attributes_454,supplyLayoutGlobalDefaults:function supplyLayoutGlobalDefaults(layoutIn,layoutOut){_$handleHoverLabelDefaults_452(0,0,function coerce(attr,dflt){return _$lib_539.coerce(layoutIn,layoutOut,_$layout_attributes_454,attr,dflt)})},supplyDefaults:function supplyDefaults(traceIn,traceOut,defaultColor,layout){_$handleHoverLabelDefaults_452(0,0,function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_445,attr,dflt)},layout.hoverlabel)},supplyLayoutDefaults:function supplyLayoutDefaults(layoutIn,layoutOut,fullData){function coerce(attr,dflt){return _$lib_539.coerce(layoutIn,layoutOut,_$layout_attributes_454,attr,dflt)}var hovermodeDflt;coerce("dragmode"),layoutOut._has("cartesian")?(layoutOut._isHoriz=function isHoriz(fullData){for(var out=!0,i=0;i<fullData.length;i++){var trace=fullData[i];if("h"!==trace.orientation){out=!1;break}}return out}(fullData),hovermodeDflt=layoutOut._isHoriz?"y":"x"):hovermodeDflt="closest",coerce("hovermode",hovermodeDflt)&&(coerce("hoverdistance"),coerce("spikedistance"));var hasMapbox=layoutOut._has("mapbox"),hasGeo=layoutOut._has("geo"),len=layoutOut._basePlotModules.length;"zoom"===layoutOut.dragmode&&((hasMapbox||hasGeo)&&1===len||hasMapbox&&hasGeo&&2===len)&&(layoutOut.dragmode="pan")},calc:function calc(gd){var calcdata=gd.calcdata,fullLayout=gd._fullLayout;function makeCoerceHoverInfo(trace){return function(val){return _$lib_539.coerceHoverinfo({hoverinfo:val},{_module:trace._module},fullLayout)}}for(var i=0;i<calcdata.length;i++){var cd=calcdata[i],trace=cd[0].trace;if(!_$registry_668.traceIs(trace,"pie")){var fillFn=_$registry_668.traceIs(trace,"2dMap")?paste:_$lib_539.fillArray;fillFn(trace.hoverinfo,cd,"hi",makeCoerceHoverInfo(trace)),trace.hoverlabel&&(fillFn(trace.hoverlabel.bgcolor,cd,"hbg"),fillFn(trace.hoverlabel.bordercolor,cd,"hbc"),fillFn(trace.hoverlabel.font.size,cd,"hts"),fillFn(trace.hoverlabel.font.color,cd,"htc"),fillFn(trace.hoverlabel.font.family,cd,"htf"),fillFn(trace.hoverlabel.namelength,cd,"hnl"))}}},getDistanceFunction:_$helpers_450.getDistanceFunction,getClosest:_$helpers_450.getClosest,inbox:_$helpers_450.inbox,quadrature:_$helpers_450.quadrature,appendArrayPointValue:_$helpers_450.appendArrayPointValue,castHoverOption:function castHoverOption(trace,ptNumber,attr){return _$lib_539.castOption(trace,ptNumber,"hoverlabel."+attr)},castHoverinfo:function castHoverinfo(trace,fullLayout,ptNumber){return _$lib_539.castOption(trace,ptNumber,"hoverinfo",function _coerce(val){return _$lib_539.coerceHoverinfo({hoverinfo:val},{_module:trace._module},fullLayout)})},hover:_$hover_451.hover,unhover:_$dragelement_433.unhover,loneHover:_$hover_451.loneHover,loneUnhover:function loneUnhover(containerOrSelection){var selection=_$lib_539.isD3Selection(containerOrSelection)?containerOrSelection:_$d3_127.select(containerOrSelection);selection.selectAll("g.hovertext").remove(),selection.selectAll(".spikeline").remove()},click:function click(gd,evt,subplot){var annotationsDone=_$registry_668.getComponentMethod("annotations","onClick")(gd,gd._hoverdata);function emitClick(){gd.emit("plotly_click",{points:gd._hoverdata,event:evt})}void 0!==subplot&&hover(gd,evt,subplot,!0),gd._hoverdata&&evt&&evt.target&&(annotationsDone&&annotationsDone.then?annotationsDone.then(emitClick):emitClick(),evt.stopImmediatePropagation&&evt.stopImmediatePropagation())}};var _$fillHoverText_870=function fillHoverText(calcPt,trace,contOut){var fill=Array.isArray(contOut)?function(v){contOut.push(v)}:function(v){contOut.text=v},htx=_$lib_539.extractOption(calcPt,trace,"htx","hovertext");if(isValid(htx))return fill(htx);var tx=_$lib_539.extractOption(calcPt,trace,"tx","text");return isValid(tx)?fill(tx):void 0};function isValid(v){return v||0===v}var _$hoverPoints_681=function hoverPoints(pointData,xval,yval,hovermode){var posVal,sizeVal,posLetter,sizeLetter,dx,dy,pRangeCalc,cd=pointData.cd,trace=cd[0].trace,t=cd[0].t,isClosest="closest"===hovermode,maxHoverDistance=pointData.maxHoverDistance,maxSpikeDistance=pointData.maxSpikeDistance;function thisBarMinPos(di){return di[posLetter]-di.w/2}function thisBarMaxPos(di){return di[posLetter]+di.w/2}var minPos=isClosest?thisBarMinPos:function(di){return Math.min(thisBarMinPos(di),di.p-t.bardelta/2)},maxPos=isClosest?thisBarMaxPos:function(di){return Math.max(thisBarMaxPos(di),di.p+t.bardelta/2)};function _positionFn(_minPos,_maxPos){return _$fx_453.inbox(_minPos-posVal,_maxPos-posVal,maxHoverDistance+Math.min(1,Math.abs(_maxPos-_minPos)/pRangeCalc)-1)}function positionFn(di){return _positionFn(minPos(di),maxPos(di))}function sizeFn(di){return _$fx_453.inbox(di.b-sizeVal,di[sizeLetter]-sizeVal,maxHoverDistance+(di[sizeLetter]-sizeVal)/(di[sizeLetter]-di.b)-1)}"h"===trace.orientation?(posVal=yval,sizeVal=xval,posLetter="y",sizeLetter="x",dx=sizeFn,dy=positionFn):(posVal=xval,sizeVal=yval,posLetter="x",sizeLetter="y",dy=sizeFn,dx=positionFn);var pa=pointData[posLetter+"a"],sa=pointData[sizeLetter+"a"];pRangeCalc=Math.abs(pa.r2c(pa.range[1])-pa.r2c(pa.range[0]));var distfn=_$fx_453.getDistanceFunction(hovermode,dx,dy,function dxy(di){return(dx(di)+dy(di))/2});if(_$fx_453.getClosest(cd,distfn,pointData),!1!==pointData.index){isClosest||(minPos=function(di){return Math.min(thisBarMinPos(di),di.p-t.bargroupwidth/2)},maxPos=function(di){return Math.max(thisBarMaxPos(di),di.p+t.bargroupwidth/2)});var di=cd[pointData.index],mc=di.mcc||trace.marker.color,mlc=di.mlcc||trace.marker.line.color,mlw=di.mlw||trace.marker.line.width;_$color_411.opacity(mc)?pointData.color=mc:_$color_411.opacity(mlc)&&mlw&&(pointData.color=mlc);var size=trace.base?di.b+di.s:di.s;pointData[sizeLetter+"0"]=pointData[sizeLetter+"1"]=sa.c2p(di[sizeLetter],!0),pointData[sizeLetter+"LabelVal"]=size;var extent=t.extents[t.extents.round(di.p)];return pointData[posLetter+"0"]=pa.c2p(isClosest?minPos(di):extent[0],!0),pointData[posLetter+"1"]=pa.c2p(isClosest?maxPos(di):extent[1],!0),pointData[posLetter+"LabelVal"]=di.p,pointData.spikeDistance=(sizeFn(di)+function thisBarPositionFn(di){return _positionFn(thisBarMinPos(di),thisBarMaxPos(di))}(di))/2+maxSpikeDistance-maxHoverDistance,pointData[posLetter+"Spike"]=pa.c2p(di.p,!0),_$fillHoverText_870(di,trace,pointData),_$registry_668.getComponentMethod("errorbars","hoverInfo")(di,trace,pointData),[pointData]}},_$layout_attributes_683={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}},_$layout_defaults_684=function(layoutIn,layoutOut,fullData){function coerce(attr,dflt){return _$lib_539.coerce(layoutIn,layoutOut,_$layout_attributes_683,attr,dflt)}for(var hasBars=!1,shouldBeGapless=!1,gappedAnyway=!1,usedSubplots={},i=0;i<fullData.length;i++){var trace=fullData[i];if(_$registry_668.traceIs(trace,"bar")){if(hasBars=!0,"overlay"!==layoutIn.barmode&&"stack"!==layoutIn.barmode){var subploti=trace.xaxis+trace.yaxis;usedSubplots[subploti]&&(gappedAnyway=!0),usedSubplots[subploti]=!0}if(trace.visible&&"histogram"===trace.type)"category"!==_$axes_584.getFromId({_fullLayout:layoutOut},trace["v"===trace.orientation?"xaxis":"yaxis"]).type&&(shouldBeGapless=!0)}}hasBars&&("overlay"!==coerce("barmode")&&coerce("barnorm"),coerce("bargap",shouldBeGapless&&!gappedAnyway?0:.2),coerce("bargroupgap"))},attributeText=_$attributes_678.text,attributeTextPosition=_$attributes_678.textposition,attributeTextFont=_$attributes_678.textfont,attributeInsideTextFont=_$attributes_678.insidetextfont,attributeOutsideTextFont=_$attributes_678.outsidetextfont,TEXTPAD=3,_$plot_685=function plot(gd,plotinfo,cdbar){var xa=plotinfo.xaxis,ya=plotinfo.yaxis,fullLayout=gd._fullLayout,bartraces=plotinfo.plot.select(".barlayer").selectAll("g.trace.bars").data(cdbar);bartraces.enter().append("g").attr("class","trace bars"),bartraces.each(function(d){d[0].node3=_$d3_127.select(this)}),bartraces.append("g").attr("class","points").each(function(d){var sel=_$d3_127.select(this),t=d[0].t,trace=d[0].trace,poffset=t.poffset,poffsetIsArray=Array.isArray(poffset);sel.selectAll("g.point").data(_$lib_539.identity).enter().append("g").classed("point",!0).each(function(di,i){var x0,x1,y0,y1,p0=di.p+(poffsetIsArray?poffset[i]:poffset),p1=p0+di.w,s0=di.b,s1=s0+di.s;if("h"===trace.orientation?(y0=ya.c2p(p0,!0),y1=ya.c2p(p1,!0),x0=xa.c2p(s0,!0),x1=xa.c2p(s1,!0),di.ct=[x1,(y0+y1)/2]):(x0=xa.c2p(p0,!0),x1=xa.c2p(p1,!0),y0=ya.c2p(s0,!0),y1=ya.c2p(s1,!0),di.ct=[(x0+x1)/2,y1]),_$fastIsnumeric_139(x0)&&_$fastIsnumeric_139(x1)&&_$fastIsnumeric_139(y0)&&_$fastIsnumeric_139(y1)&&x0!==x1&&y0!==y1){var lw=(di.mlw+1||trace.marker.line.width+1||(di.trace?di.trace.marker.line.width:0)+1)-1,offset=_$d3_127.round(lw/2%1,2);if(!gd._context.staticPlot){var fixpx=_$color_411.opacity(di.mc||trace.marker.color)<1||lw>.01?roundWithLine:function expandToVisible(v,vc){return Math.abs(v-vc)>=2?roundWithLine(v):v>vc?Math.ceil(v):Math.floor(v)};x1=fixpx(x1,x0=fixpx(x0,x1)),y1=fixpx(y1,y0=fixpx(y0,y1))}var bar=_$d3_127.select(this);bar.append("path").style("vector-effect","non-scaling-stroke").attr("d","M"+x0+","+y0+"V"+y1+"H"+x1+"V"+y0+"Z").call(_$drawing_436.setClipUrl,plotinfo.layerClipId),function appendBarText(gd,bar,calcTrace,i,x0,x1,y0,y1){var textPosition;function appendTextNode(bar,text,textFont){var textSelection=bar.append("text").text(text).attr({class:"bartext bartext-"+textPosition,transform:"","text-anchor":"middle","data-notex":1}).call(_$drawing_436.font,textFont).call(_$svg_text_utils_562.convertToTspans,gd);return textSelection}var trace=calcTrace[0].trace,orientation=trace.orientation,text=function getText(trace,index){var value=getValue(trace.text,index);return coerceString(attributeText,value)}(trace,i);if(!text)return;if("none"===(textPosition=function getTextPosition(trace,index){var value=getValue(trace.textposition,index);return function coerceEnumerated(attributeDefinition,value,defaultValue){return attributeDefinition.coerceNumber&&(value=+value),-1!==attributeDefinition.values.indexOf(value)?value:void 0!==defaultValue?defaultValue:attributeDefinition.dflt}(attributeTextPosition,value)}(trace,i)))return;var textSelection,textBB,textWidth,textHeight,transform,constrained,textFont=function getTextFont(trace,index,defaultValue){return getFontValue(attributeTextFont,trace.textfont,index,defaultValue)}(trace,i,gd._fullLayout.font),insideTextFont=function getInsideTextFont(trace,index,defaultValue){return getFontValue(attributeInsideTextFont,trace.insidetextfont,index,defaultValue)}(trace,i,textFont),outsideTextFont=function getOutsideTextFont(trace,index,defaultValue){return getFontValue(attributeOutsideTextFont,trace.outsidetextfont,index,defaultValue)}(trace,i,textFont),barmode=gd._fullLayout.barmode,inStackOrRelativeMode="stack"===barmode||"relative"===barmode,calcBar=calcTrace[i],isOutmostBar=!inStackOrRelativeMode||calcBar._outmost,barWidth=Math.abs(x1-x0)-2*TEXTPAD,barHeight=Math.abs(y1-y0)-2*TEXTPAD;"outside"===textPosition&&(isOutmostBar||(textPosition="inside"));if("auto"===textPosition)if(isOutmostBar){textPosition="inside",textSelection=appendTextNode(bar,text,insideTextFont),textBB=_$drawing_436.bBox(textSelection.node()),textWidth=textBB.width,textHeight=textBB.height;var textHasSize=textWidth>0&&textHeight>0,fitsInside=textWidth<=barWidth&&textHeight<=barHeight,fitsInsideIfRotated=textWidth<=barHeight&&textHeight<=barWidth,fitsInsideIfShrunk="h"===orientation?barWidth>=textWidth*(barHeight/textHeight):barHeight>=textHeight*(barWidth/textWidth);textHasSize&&(fitsInside||fitsInsideIfRotated||fitsInsideIfShrunk)?textPosition="inside":(textPosition="outside",textSelection.remove(),textSelection=null)}else textPosition="inside";if(!textSelection&&(textSelection=appendTextNode(bar,text,"outside"===textPosition?outsideTextFont:insideTextFont),textBB=_$drawing_436.bBox(textSelection.node()),textWidth=textBB.width,textHeight=textBB.height,textWidth<=0||textHeight<=0))return void textSelection.remove();"outside"===textPosition?(constrained="both"===trace.constraintext||"outside"===trace.constraintext,transform=function getTransformToMoveOutsideBar(x0,x1,y0,y1,textBB,orientation,constrained){var textpad,barWidth="h"===orientation?Math.abs(y1-y0):Math.abs(x1-x0);barWidth>2*TEXTPAD&&(textpad=TEXTPAD);var scale=1;constrained&&(scale="h"===orientation?Math.min(1,barWidth/textBB.height):Math.min(1,barWidth/textBB.width));var targetWidth,targetHeight,targetX,targetY,textX=(textBB.left+textBB.right)/2,textY=(textBB.top+textBB.bottom)/2;targetWidth=scale*textBB.width,targetHeight=scale*textBB.height,"h"===orientation?x1<x0?(targetX=x1-textpad-targetWidth/2,targetY=(y0+y1)/2):(targetX=x1+textpad+targetWidth/2,targetY=(y0+y1)/2):y1>y0?(targetX=(x0+x1)/2,targetY=y1+textpad+targetHeight/2):(targetX=(x0+x1)/2,targetY=y1-textpad-targetHeight/2);return getTransform(textX,textY,targetX,targetY,scale,!1)}(x0,x1,y0,y1,textBB,orientation,constrained)):(constrained="both"===trace.constraintext||"inside"===trace.constraintext,transform=function getTransformToMoveInsideBar(x0,x1,y0,y1,textBB,orientation,constrained){var targetWidth,targetHeight,targetX,targetY,textpad,rotate,scale,textWidth=textBB.width,textHeight=textBB.height,textX=(textBB.left+textBB.right)/2,textY=(textBB.top+textBB.bottom)/2,barWidth=Math.abs(x1-x0),barHeight=Math.abs(y1-y0);barWidth>2*TEXTPAD&&barHeight>2*TEXTPAD?(barWidth-=2*(textpad=TEXTPAD),barHeight-=2*textpad):textpad=0;textWidth<=barWidth&&textHeight<=barHeight?(rotate=!1,scale=1):textWidth<=barHeight&&textHeight<=barWidth?(rotate=!0,scale=1):textWidth<textHeight==barWidth<barHeight?(rotate=!1,scale=constrained?Math.min(barWidth/textWidth,barHeight/textHeight):1):(rotate=!0,scale=constrained?Math.min(barHeight/textWidth,barWidth/textHeight):1);rotate&&(rotate=90);rotate?(targetWidth=scale*textHeight,targetHeight=scale*textWidth):(targetWidth=scale*textWidth,targetHeight=scale*textHeight);"h"===orientation?x1<x0?(targetX=x1+textpad+targetWidth/2,targetY=(y0+y1)/2):(targetX=x1-textpad-targetWidth/2,targetY=(y0+y1)/2):y1>y0?(targetX=(x0+x1)/2,targetY=y1-textpad-targetHeight/2):(targetX=(x0+x1)/2,targetY=y1+textpad+targetHeight/2);return getTransform(textX,textY,targetX,targetY,scale,rotate)}(x0,x1,y0,y1,textBB,orientation,constrained));textSelection.attr("transform",transform)}(gd,bar,d,i,x0,x1,y0,y1),plotinfo.layerClipId&&_$drawing_436.hideOutsideRangePoint(d[i],bar.select("text"),xa,ya,trace.xcalendar,trace.ycalendar)}else _$d3_127.select(this).remove();function roundWithLine(v){return 0===fullLayout.bargap&&0===fullLayout.bargroupgap?_$d3_127.round(Math.round(v)-offset,2):v}})}),_$registry_668.getComponentMethod("errorbars","plot")(bartraces,plotinfo),bartraces.each(function(d){var hasClipOnAxisFalse=!1===d[0].trace.cliponaxis;_$drawing_436.setClipUrl(_$d3_127.select(this),hasClipOnAxisFalse?null:plotinfo.layerClipId)})};function getTransform(textX,textY,targetX,targetY,scale,rotate){var transformScale;return scale<1?transformScale="scale("+scale+") ":(scale=1,transformScale=""),"translate("+(targetX-scale*textX)+" "+(targetY-scale*textY)+")"+transformScale+(rotate?"rotate("+rotate+" "+textX+" "+textY+") ":"")}function getFontValue(attributeDefinition,attributeValue,index,defaultValue){var familyValue=getValue((attributeValue=attributeValue||{}).family,index),sizeValue=getValue(attributeValue.size,index),colorValue=getValue(attributeValue.color,index);return{family:coerceString(attributeDefinition.family,familyValue,defaultValue.family),size:function coerceNumber(attributeDefinition,value,defaultValue){if(_$fastIsnumeric_139(value)){value=+value;var min=attributeDefinition.min,max=attributeDefinition.max,isOutOfBounds=void 0!==min&&value<min||void 0!==max&&value>max;if(!isOutOfBounds)return value}return void 0!==defaultValue?defaultValue:attributeDefinition.dflt}(attributeDefinition.size,sizeValue,defaultValue.size),color:function coerceColor(attributeDefinition,value,defaultValue){return _$tinycolor_352(value).isValid()?value:void 0!==defaultValue?defaultValue:attributeDefinition.dflt}(attributeDefinition.color,colorValue,defaultValue.color)}}function getValue(arrayOrScalar,index){var value;return Array.isArray(arrayOrScalar)?index<arrayOrScalar.length&&(value=arrayOrScalar[index]):value=arrayOrScalar,value}function coerceString(attributeDefinition,value,defaultValue){if("string"==typeof value){if(value||!attributeDefinition.noBlank)return value}else if("number"==typeof value&&!attributeDefinition.strict)return String(value);return void 0!==defaultValue?defaultValue:attributeDefinition.dflt}var _$selectPoints_686=function selectPoints(searchInfo,polygon){var i,cd=searchInfo.cd,xa=searchInfo.xaxis,ya=searchInfo.yaxis,selection=[];if(!1===polygon)for(i=0;i<cd.length;i++)cd[i].selected=0;else for(i=0;i<cd.length;i++){var di=cd[i];polygon.contains(di.ct)?(selection.push({pointNumber:i,x:xa.c2d(di.x),y:ya.c2d(di.y)}),di.selected=1):di.selected=0}return selection},_$Sieve_688=Sieve,__BADNUM_688=_$numerical_517.BADNUM;function Sieve(traces,separateNegativeValues,dontMergeOverlappingData){this.traces=traces,this.separateNegativeValues=separateNegativeValues,this.dontMergeOverlappingData=dontMergeOverlappingData;for(var width1=1/0,positions=[],i=0;i<traces.length;i++){for(var trace=traces[i],j=0;j<trace.length;j++){var bar=trace[j];bar.p!==__BADNUM_688&&positions.push(bar.p)}trace[0]&&trace[0].width1&&(width1=Math.min(trace[0].width1,width1))}this.positions=positions;var dv=_$lib_539.distinctVals(positions);this.distinctPositions=dv.vals,1===dv.vals.length&&width1!==1/0?this.minDiff=width1:this.minDiff=Math.min(dv.minDiff,width1),this.binWidth=this.minDiff,this.bins={}}Sieve.prototype.put=function put(position,value){var label=this.getLabel(position,value),oldValue=this.bins[label]||0;return this.bins[label]=oldValue+value,oldValue},Sieve.prototype.get=function put(position,value){var label=this.getLabel(position,value);return this.bins[label]||0},Sieve.prototype.getLabel=function getLabel(position,value){return(value<0&&this.separateNegativeValues?"v":"^")+(this.dontMergeOverlappingData?position:Math.round(position/this.binWidth))};var __isArrayOrTypedArray_687=_$lib_539.isArrayOrTypedArray,__BADNUM_687=_$numerical_517.BADNUM,_$setPositions_687=function setPositions(gd,plotinfo){var i,xa=plotinfo.xaxis,ya=plotinfo.yaxis,fullTraces=gd._fullData,calcTraces=gd.calcdata,calcTracesHorizontal=[],calcTracesVertical=[];for(i=0;i<fullTraces.length;i++){var fullTrace=fullTraces[i];!0===fullTrace.visible&&_$registry_668.traceIs(fullTrace,"bar")&&fullTrace.xaxis===xa._id&&fullTrace.yaxis===ya._id&&("h"===fullTrace.orientation?calcTracesHorizontal.push(calcTraces[i]):calcTracesVertical.push(calcTraces[i]))}setGroupPositions(gd,xa,ya,calcTracesVertical),setGroupPositions(gd,ya,xa,calcTracesHorizontal)};function setGroupPositions(gd,pa,sa,calcTraces){if(calcTraces.length){var excluded,included,i,calcTrace,barmode=gd._fullLayout.barmode,group="group"===barmode;if("overlay"===barmode)setGroupPositionsInOverlayMode(gd,pa,sa,calcTraces);else if(group){for(excluded=[],included=[],i=0;i<calcTraces.length;i++)void 0===(calcTrace=calcTraces[i])[0].trace.offset?included.push(calcTrace):excluded.push(calcTrace);included.length&&function setGroupPositionsInGroupMode(gd,pa,sa,calcTraces){var barnorm=gd._fullLayout.barnorm,sieve=new _$Sieve_688(calcTraces,!1,!barnorm);(function setOffsetAndWidthInGroupMode(gd,pa,sieve){var i,calcTrace,calcTrace0,t,fullLayout=gd._fullLayout,bargap=fullLayout.bargap,bargroupgap=fullLayout.bargroupgap,positions=sieve.positions,distinctPositions=sieve.distinctPositions,minDiff=sieve.minDiff,calcTraces=sieve.traces,overlap=positions.length!==distinctPositions.length,nTraces=calcTraces.length,barGroupWidth=minDiff*(1-bargap),barWidthPlusGap=overlap?barGroupWidth/nTraces:barGroupWidth,barWidth=barWidthPlusGap*(1-bargroupgap);for(i=0;i<nTraces;i++){calcTrace=calcTraces[i],calcTrace0=calcTrace[0];var offsetFromCenter=overlap?((2*i+1-nTraces)*barWidthPlusGap-barWidth)/2:-barWidth/2;(t=calcTrace0.t).barwidth=barWidth,t.poffset=offsetFromCenter,t.bargroupwidth=barGroupWidth,t.bardelta=minDiff}sieve.binWidth=calcTraces[0][0].t.barwidth/100,applyAttributes(sieve),setBarCenterAndWidth(gd,pa,sieve),updatePositionAxis(gd,pa,sieve,overlap)})(gd,pa,sieve),barnorm?(sieveBars(gd,sa,sieve),normalizeBars(gd,sa,sieve)):setBaseAndTop(gd,sa,sieve)}(gd,pa,sa,included),excluded.length&&setGroupPositionsInOverlayMode(gd,pa,sa,excluded)}else{for(excluded=[],included=[],i=0;i<calcTraces.length;i++)void 0===(calcTrace=calcTraces[i])[0].trace.base?included.push(calcTrace):excluded.push(calcTrace);included.length&&function setGroupPositionsInStackOrRelativeMode(gd,pa,sa,calcTraces){var barmode=gd._fullLayout.barmode,stack="stack"===barmode,relative="relative"===barmode,barnorm=gd._fullLayout.barnorm,sieve=new _$Sieve_688(calcTraces,relative,!(barnorm||stack||relative));setOffsetAndWidth(gd,pa,sieve),function stackBars(gd,sa,sieve){var i,trace,j,bar,barnorm=gd._fullLayout.barnorm,sLetter=getAxisLetter(sa),traces=sieve.traces,sRange=[null,null];for(i=0;i<traces.length;i++)for(trace=traces[i],j=0;j<trace.length;j++)if((bar=trace[j]).s!==__BADNUM_687){var barBase=sieve.put(bar.p,bar.b+bar.s),barTop=barBase+bar.b+bar.s;bar.b=barBase,bar[sLetter]=barTop,barnorm||(_$fastIsnumeric_139(sa.c2l(barTop))&&expandRange(sRange,barTop),bar.hasB&&_$fastIsnumeric_139(sa.c2l(barBase))&&expandRange(sRange,barBase))}barnorm||_$axes_584.expand(sa,sRange,{tozero:!0,padded:!0})}(gd,sa,sieve);for(var i=0;i<calcTraces.length;i++)for(var calcTrace=calcTraces[i],j=0;j<calcTrace.length;j++){var bar=calcTrace[j];if(bar.s!==__BADNUM_687){var isOutmostBar=bar.b+bar.s===sieve.get(bar.p,bar.s);isOutmostBar&&(bar._outmost=!0)}}barnorm&&normalizeBars(gd,sa,sieve)}(gd,pa,sa,included),excluded.length&&setGroupPositionsInOverlayMode(gd,pa,sa,excluded)}!function collectExtents(calcTraces,pa){var i,j,cd,posLetter=pa._id.charAt(0),extents={},pMin=1/0,pMax=-1/0;for(i=0;i<calcTraces.length;i++)for(cd=calcTraces[i],j=0;j<cd.length;j++){var p=cd[j].p;_$fastIsnumeric_139(p)&&(pMin=Math.min(pMin,p),pMax=Math.max(pMax,p))}var roundFactor=1e4/(pMax-pMin),round=extents.round=function(p){return String(Math.round(roundFactor*(p-pMin)))};for(i=0;i<calcTraces.length;i++)for((cd=calcTraces[i])[0].t.extents=extents,j=0;j<cd.length;j++){var di=cd[j],p0=di[posLetter]-di.w/2;if(_$fastIsnumeric_139(p0)){var p1=di[posLetter]+di.w/2,pVal=round(di.p);extents[pVal]?extents[pVal]=[Math.min(p0,extents[pVal][0]),Math.max(p1,extents[pVal][1])]:extents[pVal]=[p0,p1]}}}(calcTraces,pa)}}function setGroupPositionsInOverlayMode(gd,pa,sa,calcTraces){for(var barnorm=gd._fullLayout.barnorm,dontMergeOverlappingData=!barnorm,i=0;i<calcTraces.length;i++){var calcTrace=calcTraces[i],sieve=new _$Sieve_688([calcTrace],!1,dontMergeOverlappingData);setOffsetAndWidth(gd,pa,sieve),barnorm?(sieveBars(gd,sa,sieve),normalizeBars(gd,sa,sieve)):setBaseAndTop(gd,sa,sieve)}}function setOffsetAndWidth(gd,pa,sieve){var i,t,fullLayout=gd._fullLayout,bargap=fullLayout.bargap,bargroupgap=fullLayout.bargroupgap,minDiff=sieve.minDiff,calcTraces=sieve.traces,barGroupWidth=minDiff*(1-bargap),barWidth=barGroupWidth*(1-bargroupgap),offsetFromCenter=-barWidth/2;for(i=0;i<calcTraces.length;i++)(t=calcTraces[i][0].t).barwidth=barWidth,t.poffset=offsetFromCenter,t.bargroupwidth=barGroupWidth,t.bardelta=minDiff;sieve.binWidth=calcTraces[0][0].t.barwidth/100,applyAttributes(sieve),setBarCenterAndWidth(gd,pa,sieve),updatePositionAxis(gd,pa,sieve)}function applyAttributes(sieve){var i,calcTrace,calcTrace0,fullTrace,j,t,calcTraces=sieve.traces;for(i=0;i<calcTraces.length;i++){fullTrace=(calcTrace0=(calcTrace=calcTraces[i])[0]).trace,t=calcTrace0.t;var newPoffset,offset=fullTrace.offset,initialPoffset=t.poffset;if(__isArrayOrTypedArray_687(offset)){for(newPoffset=offset.slice(0,calcTrace.length),j=0;j<newPoffset.length;j++)_$fastIsnumeric_139(newPoffset[j])||(newPoffset[j]=initialPoffset);for(j=newPoffset.length;j<calcTrace.length;j++)newPoffset.push(initialPoffset);t.poffset=newPoffset}else void 0!==offset&&(t.poffset=offset);var width=fullTrace.width,initialBarwidth=t.barwidth;if(__isArrayOrTypedArray_687(width)){var newBarwidth=width.slice(0,calcTrace.length);for(j=0;j<newBarwidth.length;j++)_$fastIsnumeric_139(newBarwidth[j])||(newBarwidth[j]=initialBarwidth);for(j=newBarwidth.length;j<calcTrace.length;j++)newBarwidth.push(initialBarwidth);if(t.barwidth=newBarwidth,void 0===offset){for(newPoffset=[],j=0;j<calcTrace.length;j++)newPoffset.push(initialPoffset+(initialBarwidth-newBarwidth[j])/2);t.poffset=newPoffset}}else void 0!==width&&(t.barwidth=width,void 0===offset&&(t.poffset=initialPoffset+(initialBarwidth-width)/2))}}function setBarCenterAndWidth(gd,pa,sieve){for(var calcTraces=sieve.traces,pLetter=getAxisLetter(pa),i=0;i<calcTraces.length;i++)for(var calcTrace=calcTraces[i],t=calcTrace[0].t,poffset=t.poffset,poffsetIsArray=Array.isArray(poffset),barwidth=t.barwidth,barwidthIsArray=Array.isArray(barwidth),j=0;j<calcTrace.length;j++){var calcBar=calcTrace[j],width=calcBar.w=barwidthIsArray?barwidth[j]:barwidth;calcBar[pLetter]=calcBar.p+(poffsetIsArray?poffset[j]:poffset)+width/2}}function updatePositionAxis(gd,pa,sieve,allowMinDtick){var calcTraces=sieve.traces,distinctPositions=sieve.distinctPositions,distinctPositions0=distinctPositions[0],minDiff=sieve.minDiff,vpad=minDiff/2;_$axes_584.minDtick(pa,minDiff,distinctPositions0,allowMinDtick);for(var pMin=Math.min.apply(Math,distinctPositions)-vpad,pMax=Math.max.apply(Math,distinctPositions)+vpad,i=0;i<calcTraces.length;i++){var calcTrace=calcTraces[i],calcTrace0=calcTrace[0],fullTrace=calcTrace0.trace;if(void 0!==fullTrace.width||void 0!==fullTrace.offset)for(var t=calcTrace0.t,poffset=t.poffset,barwidth=t.barwidth,poffsetIsArray=Array.isArray(poffset),barwidthIsArray=Array.isArray(barwidth),j=0;j<calcTrace.length;j++){var calcBar=calcTrace[j],calcBarOffset=poffsetIsArray?poffset[j]:poffset,calcBarWidth=barwidthIsArray?barwidth[j]:barwidth,l=calcBar.p+calcBarOffset,r=l+calcBarWidth;pMin=Math.min(pMin,l),pMax=Math.max(pMax,r)}}_$axes_584.expand(pa,[pMin,pMax],{padded:!1})}function expandRange(range,newValue){_$fastIsnumeric_139(range[0])?range[0]=Math.min(range[0],newValue):range[0]=newValue,_$fastIsnumeric_139(range[1])?range[1]=Math.max(range[1],newValue):range[1]=newValue}function setBaseAndTop(gd,sa,sieve){for(var traces=sieve.traces,sLetter=getAxisLetter(sa),sRange=[null,null],i=0;i<traces.length;i++)for(var trace=traces[i],j=0;j<trace.length;j++){var bar=trace[j],barBase=bar.b,barTop=barBase+bar.s;bar[sLetter]=barTop,_$fastIsnumeric_139(sa.c2l(barTop))&&expandRange(sRange,barTop),bar.hasB&&_$fastIsnumeric_139(sa.c2l(barBase))&&expandRange(sRange,barBase)}_$axes_584.expand(sa,sRange,{tozero:!0,padded:!0})}function sieveBars(gd,sa,sieve){for(var traces=sieve.traces,i=0;i<traces.length;i++)for(var trace=traces[i],j=0;j<trace.length;j++){var bar=trace[j];bar.s!==__BADNUM_687&&sieve.put(bar.p,bar.b+bar.s)}}function normalizeBars(gd,sa,sieve){var traces=sieve.traces,sLetter=getAxisLetter(sa),sTop="fraction"===gd._fullLayout.barnorm?1:100,sTiny=sTop/1e9,sMin=sa.l2c(sa.c2l(0)),sMax="stack"===gd._fullLayout.barmode?sTop:sMin,sRange=[sMin,sMax],padded=!1;function maybeExpand(newValue){_$fastIsnumeric_139(sa.c2l(newValue))&&(newValue<sMin-sTiny||newValue>sMax+sTiny||!_$fastIsnumeric_139(sMin))&&(padded=!0,expandRange(sRange,newValue))}for(var i=0;i<traces.length;i++)for(var trace=traces[i],j=0;j<trace.length;j++){var bar=trace[j];if(bar.s!==__BADNUM_687){var scale=Math.abs(sTop/sieve.get(bar.p,bar.s));bar.b*=scale,bar.s*=scale;var barBase=bar.b,barTop=barBase+bar.s;bar[sLetter]=barTop,maybeExpand(barTop),bar.hasB&&maybeExpand(barBase)}}_$axes_584.expand(sa,sRange,{tozero:!0,padded:padded})}function getAxisLetter(ax){return ax._id.charAt(0)}var _$style_689=function style(gd,cd){var s=cd?cd[0].node3:_$d3_127.select(gd).selectAll("g.trace.bars"),barcount=s.size(),fullLayout=gd._fullLayout;s.style("opacity",function(d){return d[0].trace.opacity}).each(function(d){("stack"===fullLayout.barmode&&barcount>1||0===fullLayout.bargap&&0===fullLayout.bargroupgap&&!d[0].trace.marker.line.width)&&_$d3_127.select(this).attr("shape-rendering","crispEdges")}),s.selectAll("g.points").each(function(d){var sel=_$d3_127.select(this),pts=sel.selectAll("path"),txs=sel.selectAll("text"),trace=d[0].trace;_$drawing_436.pointStyle(pts,trace,gd),_$drawing_436.selectedPointStyle(pts,trace),txs.each(function(d){var textFont,tx=_$d3_127.select(this);function cast(k){var cont=textFont[k];return Array.isArray(cont)?cont[d.i]:cont}tx.classed("bartext-inside")?textFont=trace.insidetextfont:tx.classed("bartext-outside")&&(textFont=trace.outsidetextfont),textFont||(textFont=trace.textfont),_$drawing_436.font(tx,cast("family"),cast("size"),cast("color"))}),_$drawing_436.selectedTextStyle(txs,trace)}),_$registry_668.getComponentMethod("errorbars","style")(s)},__extendFlat_415=_$extend_528.extendFlat,__LINE_SPACING_415=_$alignment_511.LINE_SPACING,cn={colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"},_$draw_415=function draw(gd,id){var opts={};function component(){var fullLayout=gd._fullLayout,gs=fullLayout._size;if("function"==typeof opts.fillcolor||"function"==typeof opts.line.color){var l,i,zrange=_$d3_127.extent(("function"==typeof opts.fillcolor?opts.fillcolor:opts.line.color).domain()),linelevels=[],filllevels=[],linecolormap="function"==typeof opts.line.color?opts.line.color:function(){return opts.line.color},fillcolormap="function"==typeof opts.fillcolor?opts.fillcolor:function(){return opts.fillcolor},l0=opts.levels.end+opts.levels.size/100,ls=opts.levels.size,zr0=1.001*zrange[0]-.001*zrange[1],zr1=1.001*zrange[1]-.001*zrange[0];for(i=0;i<1e5&&(l=opts.levels.start+i*ls,!(ls>0?l>=l0:l<=l0));i++)l>zr0&&l<zr1&&linelevels.push(l);if("function"==typeof opts.fillcolor)if(opts.filllevels)for(l0=opts.filllevels.end+opts.filllevels.size/100,ls=opts.filllevels.size,i=0;i<1e5&&(l=opts.filllevels.start+i*ls,!(ls>0?l>=l0:l<=l0));i++)l>zrange[0]&&l<zrange[1]&&filllevels.push(l);else(filllevels=linelevels.map(function(v){return v-opts.levels.size/2})).push(filllevels[filllevels.length-1]+opts.levels.size);else opts.fillcolor&&"string"==typeof opts.fillcolor&&(filllevels=[0]);opts.levels.size<0&&(linelevels.reverse(),filllevels.reverse());var titleEl,originalPlotHeight=fullLayout.height-fullLayout.margin.t-fullLayout.margin.b,originalPlotWidth=fullLayout.width-fullLayout.margin.l-fullLayout.margin.r,thickPx=Math.round(opts.thickness*("fraction"===opts.thicknessmode?originalPlotWidth:1)),thickFrac=thickPx/gs.w,lenPx=Math.round(opts.len*("fraction"===opts.lenmode?originalPlotHeight:1)),lenFrac=lenPx/gs.h,xpadFrac=opts.xpad/gs.w,yExtraPx=(opts.borderwidth+opts.outlinewidth)/2,ypadFrac=opts.ypad/gs.h,xLeft=Math.round(opts.x*gs.w+opts.xpad),xLeftFrac=opts.x-thickFrac*({middle:.5,right:1}[opts.xanchor]||0),yBottomFrac=opts.y+lenFrac*(({top:-.5,bottom:.5}[opts.yanchor]||0)-.5),yBottomPx=Math.round(gs.h*(1-yBottomFrac)),yTopPx=yBottomPx-lenPx,cbAxisIn={type:"linear",range:zrange,tickmode:opts.tickmode,nticks:opts.nticks,tick0:opts.tick0,dtick:opts.dtick,tickvals:opts.tickvals,ticktext:opts.ticktext,ticks:opts.ticks,ticklen:opts.ticklen,tickwidth:opts.tickwidth,tickcolor:opts.tickcolor,showticklabels:opts.showticklabels,tickfont:opts.tickfont,tickangle:opts.tickangle,tickformat:opts.tickformat,exponentformat:opts.exponentformat,separatethousands:opts.separatethousands,showexponent:opts.showexponent,showtickprefix:opts.showtickprefix,tickprefix:opts.tickprefix,showticksuffix:opts.showticksuffix,ticksuffix:opts.ticksuffix,title:opts.title,titlefont:opts.titlefont,showline:!0,anchor:"free",position:1},cbAxisOut={type:"linear",_id:"y"+id},axisOptions={letter:"y",font:fullLayout.font,noHover:!0,calendar:fullLayout.calendar};if(_$handleAxisDefaults_586(cbAxisIn,cbAxisOut,coerce,axisOptions,fullLayout),_$handlePositionDefaults_600(cbAxisIn,cbAxisOut,coerce,axisOptions),cbAxisOut.position=opts.x+xpadFrac+thickFrac,component.axis=cbAxisOut,-1!==["top","bottom"].indexOf(opts.titleside)&&(cbAxisOut.titleside=opts.titleside,cbAxisOut.titlex=opts.x+xpadFrac,cbAxisOut.titley=yBottomFrac+("top"===opts.titleside?lenFrac-ypadFrac:ypadFrac)),opts.line.color&&"auto"===opts.tickmode){cbAxisOut.tickmode="linear",cbAxisOut.tick0=opts.levels.start;var dtick=opts.levels.size,autoNtick=_$lib_539.constrain((yBottomPx-yTopPx)/50,4,15)+1,dtFactor=(zrange[1]-zrange[0])/((opts.nticks||autoNtick)*dtick);if(dtFactor>1){var dtexp=Math.pow(10,Math.floor(Math.log(dtFactor)/Math.LN10));dtick*=dtexp*_$lib_539.roundUp(dtFactor/dtexp,[2,5,10]),(Math.abs(opts.levels.start)/opts.levels.size+1e-6)%1<2e-6&&(cbAxisOut.tick0=0)}cbAxisOut.dtick=dtick}cbAxisOut.domain=[yBottomFrac+ypadFrac,yBottomFrac+lenFrac-ypadFrac],cbAxisOut.setScale();var container=fullLayout._infolayer.selectAll("g."+id).data([0]);container.enter().append("g").classed(id,!0).classed(cn.colorbar,!0).each(function(){var s=_$d3_127.select(this);s.append("rect").classed(cn.cbbg,!0),s.append("g").classed(cn.cbfills,!0),s.append("g").classed(cn.cblines,!0),s.append("g").classed(cn.cbaxis,!0).classed(cn.crisp,!0),s.append("g").classed(cn.cbtitleunshift,!0).append("g").classed(cn.cbtitle,!0),s.append("rect").classed(cn.cboutline,!0),s.select(".cbtitle").datum(0)}),container.attr("transform","translate("+Math.round(gs.l)+","+Math.round(gs.t)+")");var titleCont=container.select(".cbtitleunshift").attr("transform","translate(-"+Math.round(gs.l)+",-"+Math.round(gs.t)+")");cbAxisOut._axislayer=container.select(".cbaxis");var titleHeight=0;if(-1!==["top","bottom"].indexOf(opts.titleside)){var y,x=gs.l+(opts.x+xpadFrac)*gs.w,fontSize=cbAxisOut.titlefont.size;y="top"===opts.titleside?(1-(yBottomFrac+lenFrac-ypadFrac))*gs.h+gs.t+3+.75*fontSize:(1-(yBottomFrac+ypadFrac))*gs.h+gs.t-3-.25*fontSize,drawTitle(cbAxisOut._id+"title",{attributes:{x:x,y:y,"text-anchor":"start"}})}var t0,xf,yf,cbDone=_$lib_539.syncOrAsync([_$plots_647.previousPromises,function drawAxis(){if(-1!==["top","bottom"].indexOf(opts.titleside)){var titleGroup=container.select(".cbtitle"),titleText=titleGroup.select("text"),titleTrans=[-opts.outlinewidth/2,opts.outlinewidth/2],mathJaxNode=titleGroup.select(".h"+cbAxisOut._id+"title-math-group").node(),lineSize=15.6;if(titleText.node()&&(lineSize=parseInt(titleText.node().style.fontSize,10)*__LINE_SPACING_415),mathJaxNode?(titleHeight=_$drawing_436.bBox(mathJaxNode).height)>lineSize&&(titleTrans[1]-=(titleHeight-lineSize)/2):titleText.node()&&!titleText.classed(cn.jsPlaceholder)&&(titleHeight=_$drawing_436.bBox(titleText.node()).height),titleHeight){if(titleHeight+=5,"top"===opts.titleside)cbAxisOut.domain[1]-=titleHeight/gs.h,titleTrans[1]*=-1;else{cbAxisOut.domain[0]+=titleHeight/gs.h;var nlines=_$svg_text_utils_562.lineCount(titleText);titleTrans[1]+=(1-nlines)*lineSize}titleGroup.attr("transform","translate("+titleTrans+")"),cbAxisOut.setScale()}}container.selectAll(".cbfills,.cblines").attr("transform","translate(0,"+Math.round(gs.h*(1-cbAxisOut.domain[1]))+")"),cbAxisOut._axislayer.attr("transform","translate(0,"+Math.round(-gs.t)+")");var fills=container.select(".cbfills").selectAll("rect.cbfill").data(filllevels);fills.enter().append("rect").classed(cn.cbfill,!0).style("stroke","none"),fills.exit().remove(),fills.each(function(d,i){var z=[0===i?zrange[0]:(filllevels[i]+filllevels[i-1])/2,i===filllevels.length-1?zrange[1]:(filllevels[i]+filllevels[i+1])/2].map(cbAxisOut.c2p).map(Math.round);i!==filllevels.length-1&&(z[1]+=z[1]>z[0]?1:-1);var colorString=fillcolormap(d).replace("e-",""),opaqueColor=_$tinycolor_352(colorString).toHexString();_$d3_127.select(this).attr({x:xLeft,width:Math.max(thickPx,2),y:_$d3_127.min(z),height:Math.max(_$d3_127.max(z)-_$d3_127.min(z),2),fill:opaqueColor})});var lines=container.select(".cblines").selectAll("path.cbline").data(opts.line.color&&opts.line.width?linelevels:[]);return lines.enter().append("path").classed(cn.cbline,!0),lines.exit().remove(),lines.each(function(d){_$d3_127.select(this).attr("d","M"+xLeft+","+(Math.round(cbAxisOut.c2p(d))+opts.line.width/2%1)+"h"+thickPx).call(_$drawing_436.lineGroupStyle,opts.line.width,linecolormap(d),opts.line.dash)}),cbAxisOut._axislayer.selectAll("g."+cbAxisOut._id+"tick,path").remove(),cbAxisOut._pos=xLeft+thickPx+(opts.outlinewidth||0)/2-("outside"===opts.ticks?1:0),cbAxisOut.side="right",_$lib_539.syncOrAsync([function(){return _$axes_584.doTicks(gd,cbAxisOut,!0)},function(){if(-1===["top","bottom"].indexOf(opts.titleside)){var fontSize=cbAxisOut.titlefont.size,y=cbAxisOut._offset+cbAxisOut._length/2,x=gs.l+(cbAxisOut.position||0)*gs.w+("right"===cbAxisOut.side?10+fontSize*(cbAxisOut.showticklabels?1:.5):-10-fontSize*(cbAxisOut.showticklabels?.5:0));drawTitle("h"+cbAxisOut._id+"title",{avoid:{selection:_$d3_127.select(gd).selectAll("g."+cbAxisOut._id+"tick"),side:opts.titleside,offsetLeft:gs.l,offsetTop:0,maxShift:fullLayout.width},attributes:{x:x,y:y,"text-anchor":"middle"},transform:{rotate:"-90",offset:0}})}}])},_$plots_647.previousPromises,function positionCB(){var innerWidth=thickPx+opts.outlinewidth/2+_$drawing_436.bBox(cbAxisOut._axislayer.node()).width;if((titleEl=titleCont.select("text")).node()&&!titleEl.classed(cn.jsPlaceholder)){var titleWidth,mathJaxNode=titleCont.select(".h"+cbAxisOut._id+"title-math-group").node();titleWidth=mathJaxNode&&-1!==["top","bottom"].indexOf(opts.titleside)?_$drawing_436.bBox(mathJaxNode).width:_$drawing_436.bBox(titleCont.node()).right-xLeft-gs.l,innerWidth=Math.max(innerWidth,titleWidth)}var outerwidth=2*opts.xpad+innerWidth+opts.borderwidth+opts.outlinewidth/2,outerheight=yBottomPx-yTopPx;container.select(".cbbg").attr({x:xLeft-opts.xpad-(opts.borderwidth+opts.outlinewidth)/2,y:yTopPx-yExtraPx,width:Math.max(outerwidth,2),height:Math.max(outerheight+2*yExtraPx,2)}).call(_$color_411.fill,opts.bgcolor).call(_$color_411.stroke,opts.bordercolor).style({"stroke-width":opts.borderwidth}),container.selectAll(".cboutline").attr({x:xLeft,y:yTopPx+opts.ypad+("top"===opts.titleside?titleHeight:0),width:Math.max(thickPx,2),height:Math.max(outerheight-2*opts.ypad-titleHeight,2)}).call(_$color_411.stroke,opts.outlinecolor).style({fill:"None","stroke-width":opts.outlinewidth});var xoffset=({center:.5,right:1}[opts.xanchor]||0)*outerwidth;container.attr("transform","translate("+(gs.l-xoffset)+","+gs.t+")"),_$plots_647.autoMargin(gd,id,{x:opts.x,y:opts.y,l:outerwidth*({right:1,center:.5}[opts.xanchor]||0),r:outerwidth*({left:1,center:.5}[opts.xanchor]||0),t:outerheight*({bottom:1,middle:.5}[opts.yanchor]||0),b:outerheight*({top:1,middle:.5}[opts.yanchor]||0)})}],gd);if(cbDone&&cbDone.then&&(gd._promises||[]).push(cbDone),gd._context.edits.colorbarPosition)_$dragelement_433.init({element:container.node(),gd:gd,prepFn:function(){t0=container.attr("transform"),_$setCursor_558(container)},moveFn:function(dx,dy){container.attr("transform",t0+" translate("+dx+","+dy+")"),xf=_$dragelement_433.align(xLeftFrac+dx/gs.w,thickFrac,0,1,opts.xanchor),yf=_$dragelement_433.align(yBottomFrac-dy/gs.h,lenFrac,0,1,opts.yanchor);var csr=_$dragelement_433.getCursor(xf,yf,opts.xanchor,opts.yanchor);_$setCursor_558(container,csr)},doneFn:function(){_$setCursor_558(container),void 0!==xf&&void 0!==yf&&_$registry_668.call("restyle",gd,{"colorbar.x":xf,"colorbar.y":yf},getTrace().index)}});return cbDone}function coerce(attr,dflt){return _$lib_539.coerce(cbAxisIn,cbAxisOut,_$layout_attributes_596,attr,dflt)}function drawTitle(titleClass,titleOpts){var propName,trace=getTrace();propName=_$registry_668.traceIs(trace,"markerColorscale")?"marker.colorbar.title":"colorbar.title";var dfltTitleOpts={propContainer:cbAxisOut,propName:propName,traceIndex:trace.index,placeholder:fullLayout._dfltTitle.colorbar,containerGroup:container.select(".cbtitle")},otherClass="h"===titleClass.charAt(0)?titleClass.substr(1):"h"+titleClass;container.selectAll("."+otherClass+",."+otherClass+"-math-group").remove(),_$titles_504.draw(gd,titleClass,__extendFlat_415(dfltTitleOpts,titleOpts||{}))}fullLayout._infolayer.selectAll("g."+id).remove()}function getTrace(){var i,trace,idNum=id.substr(2);for(i=0;i<gd._fullData.length;i++)if((trace=gd._fullData[i]).uid===idNum)return trace}return Object.keys(_$attributes_412).forEach(function(k){opts[k]=null}),opts.fillcolor=null,opts.line={color:null,width:null,dash:null},opts.levels={start:null,end:null,size:null},opts.filllevels=null,Object.keys(opts).forEach(function(name){component[name]=function(v){return arguments.length?(opts[name]=_$lib_539.isPlainObject(opts[name])?_$lib_539.extendFlat(opts[name],v):v,component):opts[name]}}),component.options=function(o){return Object.keys(o).forEach(function(name){"function"==typeof component[name]&&component[name](o[name])}),component},component._opts=opts,component},_$colorbar_866=function colorbar(gd,cd){var trace=cd[0].trace,marker=trace.marker,cbId="cb"+trace.uid;if(gd._fullLayout._infolayer.selectAll("."+cbId).remove(),void 0!==marker&&marker.showscale){var vals=marker.color,cmin=marker.cmin,cmax=marker.cmax;_$fastIsnumeric_139(cmin)||(cmin=_$lib_539.aggNums(Math.min,null,vals)),_$fastIsnumeric_139(cmax)||(cmax=_$lib_539.aggNums(Math.max,null,vals));var cb=cd[0].t.cb=_$draw_415(gd,cbId),sclFunc=_$colorscale_426.makeColorScaleFunc(_$colorscale_426.extractScale(marker.colorscale,cmin,cmax),{noNumericCheck:!0});cb.fillcolor(sclFunc).filllevels({start:cmin,end:cmax,size:(cmax-cmin)/254}).options(marker.colorbar)()}else _$plots_647.autoMargin(gd,cbId)},Bar={};Bar.attributes=_$attributes_678,Bar.layoutAttributes=_$layout_attributes_683,Bar.supplyDefaults=function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_678,attr,dflt)}var coerceFont=_$lib_539.coerceFont;if(_$handleXYDefaults_886(traceIn,traceOut,layout,coerce)){coerce("orientation",traceOut.x&&!traceOut.y?"h":"v"),coerce("base"),coerce("offset"),coerce("width"),coerce("text"),coerce("hovertext");var textPosition=coerce("textposition"),hasBoth=Array.isArray(textPosition)||"auto"===textPosition,hasInside=hasBoth||"inside"===textPosition,hasOutside=hasBoth||"outside"===textPosition;if(hasInside||hasOutside){var textFont=coerceFont(coerce,"textfont",layout.font);hasInside&&coerceFont(coerce,"insidetextfont",textFont),hasOutside&&coerceFont(coerce,"outsidetextfont",textFont),coerce("constraintext"),coerce("selected.textfont.color"),coerce("unselected.textfont.color"),coerce("cliponaxis")}_$handleStyleDefaults_690(traceIn,traceOut,coerce,defaultColor,layout);var errorBarsSupplyDefaults=_$registry_668.getComponentMethod("errorbars","supplyDefaults");errorBarsSupplyDefaults(traceIn,traceOut,_$color_411.defaultLine,{axis:"y"}),errorBarsSupplyDefaults(traceIn,traceOut,_$color_411.defaultLine,{axis:"x",inherit:"y"}),_$lib_539.coerceSelectionMarkerOpacity(traceOut,coerce)}else traceOut.visible=!1},Bar.supplyLayoutDefaults=_$layout_defaults_684,Bar.calc=function calc(gd,trace){var sa,pos,size,i,scalendar,xa=_$axes_584.getFromId(gd,trace.xaxis||"x"),ya=_$axes_584.getFromId(gd,trace.yaxis||"y");"h"===(trace.orientation||(trace.x&&!trace.y?"h":"v"))?(sa=xa,size=xa.makeCalcdata(trace,"x"),pos=ya.makeCalcdata(trace,"y"),scalendar=trace.xcalendar):(sa=ya,size=ya.makeCalcdata(trace,"y"),pos=xa.makeCalcdata(trace,"x"),scalendar=trace.ycalendar);var serieslen=Math.min(pos.length,size.length),cd=new Array(serieslen);for(i=0;i<serieslen;i++)cd[i]={p:pos[i],s:size[i]},trace.ids&&(cd[i].id=String(trace.ids[i]));var b,base=trace.base;if(__isArrayOrTypedArray_679(base)){for(i=0;i<Math.min(base.length,cd.length);i++)b=sa.d2c(base[i],0,scalendar),_$fastIsnumeric_139(b)?(cd[i].b=+b,cd[i].hasB=1):cd[i].b=0;for(;i<cd.length;i++)cd[i].b=0}else{b=sa.d2c(base,0,scalendar);var hasBase=_$fastIsnumeric_139(b);for(b=hasBase?b:0,i=0;i<cd.length;i++)cd[i].b=b,hasBase&&(cd[i].hasB=1)}return _$hasColorscale_425(trace,"marker")&&_$calc_418(trace,trace.marker.color,"marker","c"),_$hasColorscale_425(trace,"marker.line")&&_$calc_418(trace,trace.marker.line.color,"marker.line","c"),_$arraysToCalcdata_677(cd,trace),_$calcSelection_864(cd,trace),cd},Bar.setPositions=_$setPositions_687,Bar.colorbar=_$colorbar_866,Bar.arraysToCalcdata=_$arraysToCalcdata_677,Bar.plot=_$plot_685,Bar.style=_$style_689,Bar.hoverPoints=_$hoverPoints_681,Bar.selectPoints=_$selectPoints_686,Bar.moduleType="trace",Bar.name="bar",Bar.basePlotModule=_$cartesian_595,Bar.categories=["cartesian","bar","oriented","markerColorscale","errorBarsOK","showLegend"],Bar.meta={};var _$bar_4=Bar,__extendFlat_691=_$extend_528.extendFlat,__scatterMarkerAttrs_691=_$attributes_862.marker,__scatterMarkerLineAttrs_691=__scatterMarkerAttrs_691.line,_$attributes_691={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},name:{valType:"string",editType:"calc+clearAxisTypes"},text:__extendFlat_691({},_$attributes_862.text,{}),whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calcIfAutorange"},notched:{valType:"boolean",editType:"calcIfAutorange"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calcIfAutorange"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],dflt:"outliers",editType:"calcIfAutorange"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],dflt:!1,editType:"calcIfAutorange"},jitter:{valType:"number",min:0,max:1,editType:"calcIfAutorange"},pointpos:{valType:"number",min:-2,max:2,editType:"calcIfAutorange"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:__extendFlat_691({},__scatterMarkerAttrs_691.symbol,{arrayOk:!1,editType:"plot"}),opacity:__extendFlat_691({},__scatterMarkerAttrs_691.opacity,{arrayOk:!1,dflt:1,editType:"style"}),size:__extendFlat_691({},__scatterMarkerAttrs_691.size,{arrayOk:!1,editType:"calcIfAutorange"}),color:__extendFlat_691({},__scatterMarkerAttrs_691.color,{arrayOk:!1,editType:"style"}),line:{color:__extendFlat_691({},__scatterMarkerLineAttrs_691.color,{arrayOk:!1,dflt:_$attributes_410.defaultLine,editType:"style"}),width:__extendFlat_691({},__scatterMarkerLineAttrs_691.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:_$attributes_862.fillcolor,selected:{marker:_$attributes_862.selected.marker,editType:"style"},unselected:{marker:_$attributes_862.unselected.marker,editType:"style"},hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}},____692=_$lib_539._,_$calc_692=function calc(gd,trace){var i,valAxis,valLetter,posAxis,posLetter,fullLayout=gd._fullLayout,xa=_$axes_584.getFromId(gd,trace.xaxis||"x"),ya=_$axes_584.getFromId(gd,trace.yaxis||"y"),cd=[],numKey="violin"===trace.type?"_numViolins":"_numBoxes";"h"===trace.orientation?(valAxis=xa,valLetter="x",posAxis=ya,posLetter="y"):(valAxis=ya,valLetter="y",posAxis=xa,posLetter="x");var val=valAxis.makeCalcdata(trace,valLetter),pos=function getPos(trace,posLetter,posAxis,val,num){if(posLetter in trace)return posAxis.makeCalcdata(trace,posLetter);var pos0;pos0=posLetter+"0"in trace?trace[posLetter+"0"]:"name"in trace&&("category"===posAxis.type||_$fastIsnumeric_139(trace.name)&&-1!==["linear","log"].indexOf(posAxis.type)||_$lib_539.isDateTime(trace.name)&&"date"===posAxis.type)?trace.name:num;var pos0c=posAxis.d2c(pos0,0,trace[posLetter+"calendar"]);return val.map(function(){return pos0c})}(trace,posLetter,posAxis,val,fullLayout[numKey]),dv=_$lib_539.distinctVals(pos),posDistinct=dv.vals,dPos=dv.minDiff/2,posBins=function makeBins(x,dx){for(var len=x.length,bins=new Array(len+1),i=0;i<len;i++)bins[i]=x[i]-dx;return bins[len]=x[len-1]+dx,bins}(posDistinct,dPos),vLen=val.length,pLen=posDistinct.length,ptsPerBin=function initNestedArray(len){for(var arr=new Array(len),i=0;i<len;i++)arr[i]=[];return arr}(pLen);for(i=0;i<vLen;i++){var v=val[i];if(_$fastIsnumeric_139(v)){var n=_$lib_539.findBin(pos[i],posBins);if(n>=0&&n<pLen){var pt={v:v,i:i};__arraysToCalcdata_692(pt,trace,i),ptsPerBin[n].push(pt)}}}for(i=0;i<pLen;i++)if(ptsPerBin[i].length>0){var pts=ptsPerBin[i].sort(sortByVal),boxVals=pts.map(extractVal),bvLen=boxVals.length,cdi={pos:posDistinct[i],pts:pts};cdi.min=boxVals[0],cdi.max=boxVals[bvLen-1],cdi.mean=_$lib_539.mean(boxVals,bvLen),cdi.sd=_$lib_539.stdev(boxVals,bvLen,cdi.mean),cdi.q1=_$lib_539.interp(boxVals,.25),cdi.med=_$lib_539.interp(boxVals,.5),cdi.q3=_$lib_539.interp(boxVals,.75),cdi.lf=Math.min(cdi.q1,boxVals[Math.min(_$lib_539.findBin(2.5*cdi.q1-1.5*cdi.q3,boxVals,!0)+1,bvLen-1)]),cdi.uf=Math.max(cdi.q3,boxVals[Math.max(_$lib_539.findBin(2.5*cdi.q3-1.5*cdi.q1,boxVals),0)]),cdi.lo=4*cdi.q1-3*cdi.q3,cdi.uo=4*cdi.q3-3*cdi.q1;var mci=1.57*(cdi.q3-cdi.q1)/Math.sqrt(bvLen);cdi.ln=cdi.med-mci,cdi.un=cdi.med+mci,cd.push(cdi)}return function __calcSelection_692(cd,trace){if(_$lib_539.isArrayOrTypedArray(trace.selectedpoints))for(var i=0;i<cd.length;i++){for(var pts=cd[i].pts||[],ptNumber2cdIndex={},j=0;j<pts.length;j++)ptNumber2cdIndex[pts[j].i]=j;_$lib_539.tagSelected(pts,trace,ptNumber2cdIndex)}}(cd,trace),_$axes_584.expand(valAxis,val,{padded:!0}),cd.length>0?(cd[0].t={num:fullLayout[numKey],dPos:dPos,posLetter:posLetter,valLetter:valLetter,labels:{med:____692(gd,"median:"),min:____692(gd,"min:"),q1:____692(gd,"q1:"),q3:____692(gd,"q3:"),max:____692(gd,"max:"),mean:"sd"===trace.boxmean?____692(gd,"mean ± σ:"):____692(gd,"mean:"),lf:____692(gd,"lower fence:"),uf:____692(gd,"upper fence:")}},trace._fullInput&&"candlestick"===trace._fullInput.type&&delete cd[0].t.labels,fullLayout[numKey]++,cd):[{t:{empty:!0}}]};function __arraysToCalcdata_692(pt,trace,i){var trace2calc={text:"tx"};for(var k in trace2calc)Array.isArray(trace[k])&&(pt[trace2calc[k]]=trace[k][i])}function sortByVal(a,b){return a.v-b.v}function extractVal(o){return o.v}function handleSampleDefaults(traceIn,traceOut,coerce,layout){var defaultOrientation,y=coerce("y"),x=coerce("x");if(y&&y.length)defaultOrientation="v",x||coerce("x0");else{if(!x||!x.length)return void(traceOut.visible=!1);defaultOrientation="h",coerce("y0")}_$registry_668.getComponentMethod("calendars","handleTraceDefaults")(traceIn,traceOut,["x","y"],layout),coerce("orientation",defaultOrientation)}function handlePointsDefaults(traceIn,traceOut,coerce,opts){var prefix=opts.prefix,outlierColorDflt=_$lib_539.coerce2(traceIn,traceOut,_$attributes_691,"marker.outliercolor"),lineoutliercolor=coerce("marker.line.outliercolor"),points=coerce(prefix+"points",outlierColorDflt||lineoutliercolor?"suspectedoutliers":void 0);points?(coerce("jitter","all"===points?.3:0),coerce("pointpos","all"===points?-1.5:0),coerce("marker.symbol"),coerce("marker.opacity"),coerce("marker.size"),coerce("marker.color",traceOut.line.color),coerce("marker.line.color"),coerce("marker.line.width"),"suspectedoutliers"===points&&(coerce("marker.line.outliercolor",traceOut.marker.color),coerce("marker.line.outlierwidth")),coerce("selected.marker.color"),coerce("unselected.marker.color"),coerce("selected.marker.size"),coerce("unselected.marker.size"),coerce("text")):delete traceOut.marker,coerce("hoveron"),_$lib_539.coerceSelectionMarkerOpacity(traceOut,coerce)}var _$defaults_693={supplyDefaults:function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_691,attr,dflt)}handleSampleDefaults(traceIn,traceOut,coerce,layout),!1!==traceOut.visible&&(coerce("line.color",(traceIn.marker||{}).color||defaultColor),coerce("line.width"),coerce("fillcolor",_$color_411.addOpacity(traceOut.line.color,.5)),coerce("whiskerwidth"),coerce("boxmean"),coerce("notched",void 0!==traceIn.notchwidth)&&coerce("notchwidth"),handlePointsDefaults(traceIn,traceOut,coerce,{prefix:"box"}))},handleSampleDefaults:handleSampleDefaults,handlePointsDefaults:handlePointsDefaults};function hoverOnBoxes(pointData,xval,yval,hovermode){var pLetter,vLetter,pAxis,vAxis,vVal,pVal,dx,dy,dPos,hoverPseudoDistance,spikePseudoDistance,dVal,cd=pointData.cd,xa=pointData.xa,ya=pointData.ya,trace=cd[0].trace,t=cd[0].t,isViolin="violin"===trace.type,closeBoxData=[],boxDelta=t.bdPos,shiftPos=function(di){return di.pos+t.bPos-pVal};isViolin&&"both"!==trace.side?("positive"===trace.side&&(dPos=function(di){var pos=shiftPos(di);return _$fx_453.inbox(pos,pos+boxDelta,hoverPseudoDistance)}),"negative"===trace.side&&(dPos=function(di){var pos=shiftPos(di);return _$fx_453.inbox(pos-boxDelta,pos,hoverPseudoDistance)})):dPos=function(di){var pos=shiftPos(di);return _$fx_453.inbox(pos-boxDelta,pos+boxDelta,hoverPseudoDistance)},dVal=isViolin?function(di){return _$fx_453.inbox(di.span[0]-vVal,di.span[1]-vVal,hoverPseudoDistance)}:function(di){return _$fx_453.inbox(di.min-vVal,di.max-vVal,hoverPseudoDistance)},"h"===trace.orientation?(vVal=xval,pVal=yval,dx=dVal,dy=dPos,pLetter="y",pAxis=ya,vLetter="x",vAxis=xa):(vVal=yval,pVal=xval,dx=dPos,dy=dVal,pLetter="x",pAxis=xa,vLetter="y",vAxis=ya);var pseudoDistance=Math.min(1,boxDelta/Math.abs(pAxis.r2c(pAxis.range[1])-pAxis.r2c(pAxis.range[0])));function dxy(di){return(dx(di)+dy(di))/2}hoverPseudoDistance=pointData.maxHoverDistance-pseudoDistance,spikePseudoDistance=pointData.maxSpikeDistance-pseudoDistance;var distfn=_$fx_453.getDistanceFunction(hovermode,dx,dy,dxy);if(_$fx_453.getClosest(cd,distfn,pointData),!1===pointData.index)return[];var di=cd[pointData.index],lc=trace.line.color,mc=(trace.marker||{}).color;_$color_411.opacity(lc)&&trace.line.width?pointData.color=lc:_$color_411.opacity(mc)&&trace.boxpoints?pointData.color=mc:pointData.color=trace.fillcolor,pointData[pLetter+"0"]=pAxis.c2p(di.pos+t.bPos-t.bdPos,!0),pointData[pLetter+"1"]=pAxis.c2p(di.pos+t.bPos+t.bdPos,!0),_$axes_584.tickText(pAxis,pAxis.c2l(di.pos),"hover").text,pointData[pLetter+"LabelVal"]=di.pos;var spikePosAttr=pLetter+"Spike";pointData.spikeDistance=dxy(di)*spikePseudoDistance/hoverPseudoDistance,pointData[spikePosAttr]=pAxis.c2p(di.pos,!0);var usedVals={},attrs=["med","min","q1","q3","max"];(trace.boxmean||(trace.meanline||{}).visible)&&attrs.push("mean"),(trace.boxpoints||trace.points)&&attrs.push("lf","uf");for(var i=0;i<attrs.length;i++){var attr=attrs[i];if(attr in di&&!(di[attr]in usedVals)){usedVals[di[attr]]=!0;var val=di[attr],valPx=vAxis.c2p(val,!0),pointData2=_$lib_539.extendFlat({},pointData);pointData2[vLetter+"0"]=pointData2[vLetter+"1"]=valPx,pointData2[vLetter+"LabelVal"]=val,pointData2[vLetter+"Label"]=(t.labels?t.labels[attr]+" ":"")+_$axes_584.hoverLabelText(vAxis,val),"mean"===attr&&"sd"in di&&"sd"===trace.boxmean&&(pointData2[vLetter+"err"]=di.sd),pointData.name="",pointData.spikeDistance=void 0,pointData[spikePosAttr]=void 0,closeBoxData.push(pointData2)}}return closeBoxData}function hoverOnPoints(pointData,xval,yval){for(var closePtData,di,pt,cd=pointData.cd,xa=pointData.xa,ya=pointData.ya,trace=cd[0].trace,xPx=xa.c2p(xval),yPx=ya.c2p(yval),distfn=_$fx_453.quadrature(function(di){var rad=Math.max(3,di.mrc||0);return Math.max(Math.abs(xa.c2p(di.x)-xPx)-rad,1-3/rad)},function(di){var rad=Math.max(3,di.mrc||0);return Math.max(Math.abs(ya.c2p(di.y)-yPx)-rad,1-3/rad)}),ijClosest=!1,i=0;i<cd.length;i++){di=cd[i];for(var j=0;j<(di.pts||[]).length;j++){var newDistance=distfn(pt=di.pts[j]);newDistance<=pointData.distance&&(pointData.distance=newDistance,ijClosest=[i,j])}}if(!ijClosest)return!1;pt=(di=cd[ijClosest[0]]).pts[ijClosest[1]];var xc=xa.c2p(pt.x,!0),yc=ya.c2p(pt.y,!0),rad=pt.mrc||1;closePtData=_$lib_539.extendFlat({},pointData,{index:pt.i,color:(trace.marker||{}).color,name:trace.name,x0:xc-rad,x1:xc+rad,xLabelVal:pt.x,y0:yc-rad,y1:yc+rad,yLabelVal:pt.y,spikeDistance:pointData.distance});var pLetter="h"===trace.orientation?"y":"x",pa="h"===trace.orientation?ya:xa;return closePtData[pLetter+"Spike"]=pa.c2p(di.pos,!0),_$fillHoverText_870(pt,trace,closePtData),closePtData}var _$hover_694={hoverPoints:function hoverPoints(pointData,xval,yval,hovermode){var closePtData,hoveron=pointData.cd[0].trace.hoveron,closeBoxData=[];return-1!==hoveron.indexOf("boxes")&&(closeBoxData=closeBoxData.concat(hoverOnBoxes(pointData,xval,yval,hovermode))),-1!==hoveron.indexOf("points")&&(closePtData=hoverOnPoints(pointData,xval,yval)),"closest"===hovermode?closePtData?[closePtData]:closeBoxData:closePtData?(closeBoxData.push(closePtData),closeBoxData):closeBoxData},hoverOnBoxes:hoverOnBoxes,hoverOnPoints:hoverOnPoints},_$layout_attributes_696={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}};function _supply(layoutIn,layoutOut,fullData,coerce,traceType){for(var hasTraceType,i=0;i<fullData.length;i++)if(fullData[i].type===traceType){hasTraceType=!0;break}hasTraceType&&(coerce(traceType+"mode"),coerce(traceType+"gap"),coerce(traceType+"groupgap"))}var _$layout_defaults_697={supplyLayoutDefaults:function supplyLayoutDefaults(layoutIn,layoutOut,fullData){_supply(0,0,fullData,function coerce(attr,dflt){return _$lib_539.coerce(layoutIn,layoutOut,_$layout_attributes_696,attr,dflt)},"box")},_supply:_supply},JITTERCOUNT=5,JITTERSPREAD=.01;function plotBoxAndWhiskers(sel,axes,trace,t){var bdPos0,bdPos1,posAxis=axes.pos,valAxis=axes.val,bPos=t.bPos,wdPos=t.wdPos||0,bPosPxOffset=t.bPosPxOffset||0,whiskerWidth=trace.whiskerwidth||0,notched=trace.notched||!1,nw=notched?1-2*trace.notchwidth:1;Array.isArray(t.bdPos)?(bdPos0=t.bdPos[0],bdPos1=t.bdPos[1]):(bdPos0=t.bdPos,bdPos1=t.bdPos),sel.selectAll("path.box").data(_$lib_539.identity).enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box").each(function(d){var pos=d.pos,posc=posAxis.c2p(pos+bPos,!0)+bPosPxOffset,pos0=posAxis.c2p(pos+bPos-bdPos0,!0)+bPosPxOffset,pos1=posAxis.c2p(pos+bPos+bdPos1,!0)+bPosPxOffset,posw0=posAxis.c2p(pos+bPos-wdPos,!0)+bPosPxOffset,posw1=posAxis.c2p(pos+bPos+wdPos,!0)+bPosPxOffset,posm0=posAxis.c2p(pos+bPos-bdPos0*nw,!0)+bPosPxOffset,posm1=posAxis.c2p(pos+bPos+bdPos1*nw,!0)+bPosPxOffset,q1=valAxis.c2p(d.q1,!0),q3=valAxis.c2p(d.q3,!0),m=_$lib_539.constrain(valAxis.c2p(d.med,!0),Math.min(q1,q3)+1,Math.max(q1,q3)-1),lf=valAxis.c2p(!1===trace.boxpoints?d.min:d.lf,!0),uf=valAxis.c2p(!1===trace.boxpoints?d.max:d.uf,!0),ln=valAxis.c2p(d.ln,!0),un=valAxis.c2p(d.un,!0);"h"===trace.orientation?_$d3_127.select(this).attr("d","M"+m+","+posm0+"V"+posm1+"M"+q1+","+pos0+"V"+pos1+(notched?"H"+ln+"L"+m+","+posm1+"L"+un+","+pos1:"")+"H"+q3+"V"+pos0+(notched?"H"+un+"L"+m+","+posm0+"L"+ln+","+pos0:"")+"ZM"+q1+","+posc+"H"+lf+"M"+q3+","+posc+"H"+uf+(0===whiskerWidth?"":"M"+lf+","+posw0+"V"+posw1+"M"+uf+","+posw0+"V"+posw1)):_$d3_127.select(this).attr("d","M"+posm0+","+m+"H"+posm1+"M"+pos0+","+q1+"H"+pos1+(notched?"V"+ln+"L"+posm1+","+m+"L"+pos1+","+un:"")+"V"+q3+"H"+pos0+(notched?"V"+un+"L"+posm0+","+m+"L"+pos0+","+ln:"")+"ZM"+posc+","+q1+"V"+lf+"M"+posc+","+q3+"V"+uf+(0===whiskerWidth?"":"M"+posw0+","+lf+"H"+posw1+"M"+posw0+","+uf+"H"+posw1))})}function plotPoints(sel,axes,trace,t){var xa=axes.x,ya=axes.y,bdPos=t.bdPos,bPos=t.bPos,mode=trace.boxpoints||trace.points;_$lib_539.seedPseudoRandom(),sel.selectAll("g.points").data(function(d){return d.forEach(function(v){v.t=t,v.trace=trace}),d}).enter().append("g").attr("class","points").selectAll("path").data(function(d){var i,newJitter,pts="all"===mode?d.pts:d.pts.filter(function(pt){return pt.v<d.lf||pt.v>d.uf}),typicalSpread=Math.max((d.max-d.min)/10,d.q3-d.q1),minSpread=1e-9*typicalSpread,spreadLimit=typicalSpread*JITTERSPREAD,jitterFactors=[],maxJitterFactor=0;if(trace.jitter){if(0===typicalSpread)for(maxJitterFactor=1,jitterFactors=new Array(pts.length),i=0;i<pts.length;i++)jitterFactors[i]=1;else for(i=0;i<pts.length;i++){var i0=Math.max(0,i-JITTERCOUNT),pmin=pts[i0].v,i1=Math.min(pts.length-1,i+JITTERCOUNT),pmax=pts[i1].v;"all"!==mode&&(pts[i].v<d.lf?pmax=Math.min(pmax,d.lf):pmin=Math.max(pmin,d.uf));var jitterFactor=Math.sqrt(spreadLimit*(i1-i0)/(pmax-pmin+minSpread))||0;jitterFactor=_$lib_539.constrain(Math.abs(jitterFactor),0,1),jitterFactors.push(jitterFactor),maxJitterFactor=Math.max(jitterFactor,maxJitterFactor)}newJitter=2*trace.jitter/maxJitterFactor}for(i=0;i<pts.length;i++){var pt=pts[i],v=pt.v,jitterOffset=trace.jitter?newJitter*jitterFactors[i]*(_$lib_539.pseudoRandom()-.5):0,posPx=d.pos+bPos+bdPos*(trace.pointpos+jitterOffset);"h"===trace.orientation?(pt.y=posPx,pt.x=v):(pt.x=posPx,pt.y=v),"suspectedoutliers"===mode&&v<d.uo&&v>d.lo&&(pt.so=!0)}return pts}).enter().append("path").classed("point",!0).call(_$drawing_436.translatePoints,xa,ya)}function plotBoxMean(sel,axes,trace,t){var bdPos0,bdPos1,posAxis=axes.pos,valAxis=axes.val,bPos=t.bPos,bPosPxOffset=t.bPosPxOffset||0;Array.isArray(t.bdPos)?(bdPos0=t.bdPos[0],bdPos1=t.bdPos[1]):(bdPos0=t.bdPos,bdPos1=t.bdPos),sel.selectAll("path.mean").data(_$lib_539.identity).enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}).each(function(d){var posc=posAxis.c2p(d.pos+bPos,!0)+bPosPxOffset,pos0=posAxis.c2p(d.pos+bPos-bdPos0,!0)+bPosPxOffset,pos1=posAxis.c2p(d.pos+bPos+bdPos1,!0)+bPosPxOffset,m=valAxis.c2p(d.mean,!0),sl=valAxis.c2p(d.mean-d.sd,!0),sh=valAxis.c2p(d.mean+d.sd,!0);"h"===trace.orientation?_$d3_127.select(this).attr("d","M"+m+","+pos0+"V"+pos1+("sd"===trace.boxmean?"m0,0L"+sl+","+posc+"L"+m+","+pos0+"L"+sh+","+posc+"Z":"")):_$d3_127.select(this).attr("d","M"+pos0+","+m+"H"+pos1+("sd"===trace.boxmean?"m0,0L"+posc+","+sl+"L"+pos0+","+m+"L"+posc+","+sh+"Z":""))})}var _$plot_698={plot:function plot(gd,plotinfo,cdbox){var fullLayout=gd._fullLayout,xa=plotinfo.xaxis,ya=plotinfo.yaxis;plotinfo.plot.select(".boxlayer").selectAll("g.trace.boxes").data(cdbox).enter().append("g").attr("class","trace boxes").each(function(d){var posAxis,valAxis,cd0=d[0],t=cd0.t,trace=cd0.trace,sel=cd0.node3=_$d3_127.select(this),numBoxes=fullLayout._numBoxes,group="group"===fullLayout.boxmode&&numBoxes>1,bdPos=t.dPos*(1-fullLayout.boxgap)*(1-fullLayout.boxgroupgap)/(group?numBoxes:1),bPos=group?2*t.dPos*((t.num+.5)/numBoxes-.5)*(1-fullLayout.boxgap):0,wdPos=bdPos*trace.whiskerwidth;!0!==trace.visible||t.empty?_$d3_127.select(this).remove():("h"===trace.orientation?(posAxis=ya,valAxis=xa):(posAxis=xa,valAxis=ya),t.bPos=bPos,t.bdPos=bdPos,t.wdPos=wdPos,plotBoxAndWhiskers(sel,{pos:posAxis,val:valAxis},trace,t),trace.boxpoints&&plotPoints(sel,{x:xa,y:ya},trace,t),trace.boxmean&&plotBoxMean(sel,{pos:posAxis,val:valAxis},trace,t))})},plotBoxAndWhiskers:plotBoxAndWhiskers,plotPoints:plotPoints,plotBoxMean:plotBoxMean},_$selectPoints_699=function selectPoints(searchInfo,polygon){var i,j,cd=searchInfo.cd,xa=searchInfo.xaxis,ya=searchInfo.yaxis,selection=[];if(!1===polygon)for(i=0;i<cd.length;i++)for(j=0;j<(cd[i].pts||[]).length;j++)cd[i].pts[j].selected=0;else for(i=0;i<cd.length;i++)for(j=0;j<(cd[i].pts||[]).length;j++){var pt=cd[i].pts[j],x=xa.c2p(pt.x),y=ya.c2p(pt.y);polygon.contains([x,y])?(selection.push({pointNumber:pt.i,x:xa.c2d(pt.x),y:ya.c2d(pt.y)}),pt.selected=1):pt.selected=0}return selection},orientations=["v","h"];function setPositionOffset(traceType,gd,boxList,posAxis,pad){var i,j,calcTrace,calcdata=gd.calcdata,fullLayout=gd._fullLayout,pointList=[],numKey="violin"===traceType?"_numViolins":"_numBoxes";for(i=0;i<boxList.length;i++)for(calcTrace=calcdata[boxList[i]],j=0;j<calcTrace.length;j++)pointList.push(calcTrace[j].pos);if(pointList.length){var boxdv=_$lib_539.distinctVals(pointList),dPos=boxdv.minDiff/2;for(pointList.length===boxdv.vals.length&&(fullLayout[numKey]=1),_$axes_584.minDtick(posAxis,boxdv.minDiff,boxdv.vals[0],!0),i=0;i<boxList.length;i++)(calcTrace=calcdata[boxList[i]])[0].t.dPos=dPos;var padfactor=(1-fullLayout[traceType+"gap"])*(1-fullLayout[traceType+"groupgap"])*dPos/fullLayout[numKey];_$axes_584.expand(posAxis,boxdv.vals,{vpadminus:dPos+pad[0]*padfactor,vpadplus:dPos+pad[1]*padfactor})}}var _$set_positions___setPositions=function setPositions(gd,plotinfo){for(var calcdata=gd.calcdata,xa=plotinfo.xaxis,ya=plotinfo.yaxis,i=0;i<orientations.length;i++){for(var orientation=orientations[i],posAxis="h"===orientation?ya:xa,boxList=[],minPad=0,maxPad=0,j=0;j<calcdata.length;j++){var cd=calcdata[j],t=cd[0].t,trace=cd[0].trace;!0!==trace.visible||"box"!==trace.type||t.empty||trace.orientation!==orientation||trace.xaxis!==xa._id||trace.yaxis!==ya._id||(boxList.push(j),!1!==trace.boxpoints&&(minPad=Math.max(minPad,trace.jitter-trace.pointpos-1),maxPad=Math.max(maxPad,trace.jitter+trace.pointpos-1)))}setPositionOffset("box",gd,boxList,posAxis,[minPad,maxPad])}},_$set_positions___setPositionOffset=setPositionOffset,Box={};Box.attributes=_$attributes_691,Box.layoutAttributes=_$layout_attributes_696,Box.supplyDefaults=_$defaults_693.supplyDefaults,Box.supplyLayoutDefaults=_$layout_defaults_697.supplyLayoutDefaults,Box.calc=_$calc_692,Box.setPositions=_$set_positions___setPositions,Box.plot=_$plot_698.plot,Box.style=function style(gd,cd){var s=cd?cd[0].node3:_$d3_127.select(gd).selectAll("g.trace.boxes");s.style("opacity",function(d){return d[0].trace.opacity}),s.each(function(d){var el=_$d3_127.select(this),trace=d[0].trace,lineWidth=trace.line.width;el.selectAll("path.box").style("stroke-width",lineWidth+"px").call(_$color_411.stroke,trace.line.color).call(_$color_411.fill,trace.fillcolor),el.selectAll("path.mean").style({"stroke-width":lineWidth,"stroke-dasharray":2*lineWidth+"px,"+lineWidth+"px"}).call(_$color_411.stroke,trace.line.color);var pts=el.selectAll("path.point");_$drawing_436.pointStyle(pts,trace,gd),_$drawing_436.selectedPointStyle(pts,trace)})},Box.hoverPoints=_$hover_694.hoverPoints,Box.selectPoints=_$selectPoints_699,Box.moduleType="trace",Box.name="box",Box.basePlotModule=_$cartesian_595,Box.categories=["cartesian","symbols","oriented","box-violin","showLegend"],Box.meta={};var _$Box_695=Box,_$box_5=_$Box_695,getOwnPropertySymbols=Object.getOwnPropertySymbols,hasOwnProperty=Object.prototype.hasOwnProperty,propIsEnumerable=Object.prototype.propertyIsEnumerable;var _$objectAssign_281=function shouldUseNative(){try{if(!Object.assign)return!1;var test1=new String("abc");if(test1[5]="de","5"===Object.getOwnPropertyNames(test1)[0])return!1;for(var test2={},i=0;i<10;i++)test2["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(test2).map(function(n){return test2[n]}).join(""))return!1;var test3={};return"abcdefghijklmnopqrst".split("").forEach(function(letter){test3[letter]=letter}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},test3)).join("")}catch(err){return!1}}()?Object.assign:function(target,source){for(var from,symbols,to=function toObject(val){if(null===val||void 0===val)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(val)}(target),s=1;s<arguments.length;s++){for(var key in from=Object(arguments[s]))hasOwnProperty.call(from,key)&&(to[key]=from[key]);if(getOwnPropertySymbols){symbols=getOwnPropertySymbols(from);for(var i=0;i<symbols.length;i++)propIsEnumerable.call(from,symbols[i])&&(to[symbols[i]]=from[symbols[i]])}}return to},_$main_388={};function Calendars(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}function CDate(calendar,year,month,day){if(this._calendar=calendar,this._year=year,this._month=month,this._day=day,0===this._calendar._validateLevel&&!this._calendar.isValid(this._year,this._month,this._day))throw(_exports.local.invalidDate||_exports.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function pad(value,length){return"000000".substring(0,length-(value=""+value).length)+value}function BaseCalendar(){this.shortYearCutoff="+10"}function GregorianCalendar(language){this.local=this.regionalOptions[language]||this.regionalOptions[""]}_$objectAssign_281(Calendars.prototype,{instance:function(name,language){name=(name||"gregorian").toLowerCase(),language=language||"";var cal=this._localCals[name+"-"+language];if(!cal&&this.calendars[name]&&(cal=new this.calendars[name](language),this._localCals[name+"-"+language]=cal),!cal)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,name);return cal},newDate:function(year,month,day,calendar,language){return(calendar=(null!=year&&year.year?year.calendar():"string"==typeof calendar?this.instance(calendar,language):calendar)||this.instance()).newDate(year,month,day)},substituteDigits:function(digits){return function(value){return(value+"").replace(/[0-9]/g,function(digit){return digits[digit]})}},substituteChineseDigits:function(digits,powers){return function(value){for(var localNumber="",power=0;value>0;){var units=value%10;localNumber=(0===units?"":digits[units]+powers[power])+localNumber,power++,value=Math.floor(value/10)}return 0===localNumber.indexOf(digits[1]+powers[1])&&(localNumber=localNumber.substr(1)),localNumber||digits[0]}}}),_$objectAssign_281(CDate.prototype,{newDate:function(year,month,day){return this._calendar.newDate(null==year?this:year,month,day)},year:function(year){return 0===arguments.length?this._year:this.set(year,"y")},month:function(month){return 0===arguments.length?this._month:this.set(month,"m")},day:function(day){return 0===arguments.length?this._day:this.set(day,"d")},date:function(year,month,day){if(!this._calendar.isValid(year,month,day))throw(_exports.local.invalidDate||_exports.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=year,this._month=month,this._day=day,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(offset,period){return this._calendar.add(this,offset,period)},set:function(value,period){return this._calendar.set(this,value,period)},compareTo:function(date){if(this._calendar.name!==date._calendar.name)throw(_exports.local.differentCalendars||_exports.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,date._calendar.local.name);var c=this._year!==date._year?this._year-date._year:this._month!==date._month?this.monthOfYear()-date.monthOfYear():this._day-date._day;return 0===c?0:c<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(jd){return this._calendar.fromJD(jd)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(jsd){return this._calendar.fromJSDate(jsd)},toString:function(){return(this.year()<0?"-":"")+pad(Math.abs(this.year()),4)+"-"+pad(this.month(),2)+"-"+pad(this.day(),2)}}),_$objectAssign_281(BaseCalendar.prototype,{_validateLevel:0,newDate:function(year,month,day){return null==year?this.today():(year.year&&(this._validate(year,month,day,_exports.local.invalidDate||_exports.regionalOptions[""].invalidDate),day=year.day(),month=year.month(),year=year.year()),new CDate(this,year,month,day))},today:function(){return this.fromJSDate(new Date)},epoch:function(year){return this._validate(year,this.minMonth,this.minDay,_exports.local.invalidYear||_exports.regionalOptions[""].invalidYear).year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(year){var date=this._validate(year,this.minMonth,this.minDay,_exports.local.invalidYear||_exports.regionalOptions[""].invalidYear);return(date.year()<0?"-":"")+pad(Math.abs(date.year()),4)},monthsInYear:function(year){return this._validate(year,this.minMonth,this.minDay,_exports.local.invalidYear||_exports.regionalOptions[""].invalidYear),12},monthOfYear:function(year,month){var date=this._validate(year,month,this.minDay,_exports.local.invalidMonth||_exports.regionalOptions[""].invalidMonth);return(date.month()+this.monthsInYear(date)-this.firstMonth)%this.monthsInYear(date)+this.minMonth},fromMonthOfYear:function(year,ord){var m=(ord+this.firstMonth-2*this.minMonth)%this.monthsInYear(year)+this.minMonth;return this._validate(year,m,this.minDay,_exports.local.invalidMonth||_exports.regionalOptions[""].invalidMonth),m},daysInYear:function(year){var date=this._validate(year,this.minMonth,this.minDay,_exports.local.invalidYear||_exports.regionalOptions[""].invalidYear);return this.leapYear(date)?366:365},dayOfYear:function(year,month,day){var date=this._validate(year,month,day,_exports.local.invalidDate||_exports.regionalOptions[""].invalidDate);return date.toJD()-this.newDate(date.year(),this.fromMonthOfYear(date.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(year,month,day){var date=this._validate(year,month,day,_exports.local.invalidDate||_exports.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(date))+2)%this.daysInWeek()},extraInfo:function(year,month,day){return this._validate(year,month,day,_exports.local.invalidDate||_exports.regionalOptions[""].invalidDate),{}},add:function(date,offset,period){return this._validate(date,this.minMonth,this.minDay,_exports.local.invalidDate||_exports.regionalOptions[""].invalidDate),this._correctAdd(date,this._add(date,offset,period),offset,period)},_add:function(date,offset,period){if(this._validateLevel++,"d"===period||"w"===period){var jd=date.toJD()+offset*("w"===period?this.daysInWeek():1),d=date.calendar().fromJD(jd);return this._validateLevel--,[d.year(),d.month(),d.day()]}try{var y=date.year()+("y"===period?offset:0),m=date.monthOfYear()+("m"===period?offset:0);d=date.day();"y"===period?(date.month()!==this.fromMonthOfYear(y,m)&&(m=this.newDate(y,date.month(),this.minDay).monthOfYear()),m=Math.min(m,this.monthsInYear(y)),d=Math.min(d,this.daysInMonth(y,this.fromMonthOfYear(y,m)))):"m"===period&&(!function(calendar){for(;m<calendar.minMonth;)y--,m+=calendar.monthsInYear(y);for(var yearMonths=calendar.monthsInYear(y);m>yearMonths-1+calendar.minMonth;)y++,m-=yearMonths,yearMonths=calendar.monthsInYear(y)}(this),d=Math.min(d,this.daysInMonth(y,this.fromMonthOfYear(y,m))));var ymd=[y,this.fromMonthOfYear(y,m),d];return this._validateLevel--,ymd}catch(e){throw this._validateLevel--,e}},_correctAdd:function(date,ymd,offset,period){if(!(this.hasYearZero||"y"!==period&&"m"!==period||0!==ymd[0]&&date.year()>0==ymd[0]>0)){var adj={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[period],dir=offset<0?-1:1;ymd=this._add(date,offset*adj[0]+dir*adj[1],adj[2])}return date.date(ymd[0],ymd[1],ymd[2])},set:function(date,value,period){this._validate(date,this.minMonth,this.minDay,_exports.local.invalidDate||_exports.regionalOptions[""].invalidDate);var y="y"===period?value:date.year(),m="m"===period?value:date.month(),d="d"===period?value:date.day();return"y"!==period&&"m"!==period||(d=Math.min(d,this.daysInMonth(y,m))),date.date(y,m,d)},isValid:function(year,month,day){this._validateLevel++;var valid=this.hasYearZero||0!==year;if(valid){var date=this.newDate(year,month,this.minDay);valid=month>=this.minMonth&&month-this.minMonth<this.monthsInYear(date)&&day>=this.minDay&&day-this.minDay<this.daysInMonth(date)}return this._validateLevel--,valid},toJSDate:function(year,month,day){var date=this._validate(year,month,day,_exports.local.invalidDate||_exports.regionalOptions[""].invalidDate);return _exports.instance().fromJD(this.toJD(date)).toJSDate()},fromJSDate:function(jsd){return this.fromJD(_exports.instance().fromJSDate(jsd).toJD())},_validate:function(year,month,day,error){if(year.year){if(0===this._validateLevel&&this.name!==year.calendar().name)throw(_exports.local.differentCalendars||_exports.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,year.calendar().local.name);return year}try{if(this._validateLevel++,1===this._validateLevel&&!this.isValid(year,month,day))throw error.replace(/\{0\}/,this.local.name);var date=this.newDate(year,month,day);return this._validateLevel--,date}catch(e){throw this._validateLevel--,e}}}),GregorianCalendar.prototype=new BaseCalendar,_$objectAssign_281(GregorianCalendar.prototype,{name:"Gregorian",jdEpoch:1721425.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(year){var date=this._validate(year,this.minMonth,this.minDay,_exports.local.invalidYear||_exports.regionalOptions[""].invalidYear);return(year=date.year()+(date.year()<0?1:0))%4==0&&(year%100!=0||year%400==0)},weekOfYear:function(year,month,day){var checkDate=this.newDate(year,month,day);return checkDate.add(4-(checkDate.dayOfWeek()||7),"d"),Math.floor((checkDate.dayOfYear()-1)/7)+1},daysInMonth:function(year,month){var date=this._validate(year,month,this.minDay,_exports.local.invalidMonth||_exports.regionalOptions[""].invalidMonth);return this.daysPerMonth[date.month()-1]+(2===date.month()&&this.leapYear(date.year())?1:0)},weekDay:function(year,month,day){return(this.dayOfWeek(year,month,day)||7)<6},toJD:function(year,month,day){var date=this._validate(year,month,day,_exports.local.invalidDate||_exports.regionalOptions[""].invalidDate);year=date.year(),month=date.month(),day=date.day(),year<0&&year++,month<3&&(month+=12,year--);var a=Math.floor(year/100),b=2-a+Math.floor(a/4);return Math.floor(365.25*(year+4716))+Math.floor(30.6001*(month+1))+day+b-1524.5},fromJD:function(jd){var z=Math.floor(jd+.5),a=Math.floor((z-1867216.25)/36524.25),b=(a=z+1+a-Math.floor(a/4))+1524,c=Math.floor((b-122.1)/365.25),d=Math.floor(365.25*c),e=Math.floor((b-d)/30.6001),day=b-d-Math.floor(30.6001*e),month=e-(e>13.5?13:1),year=c-(month>2.5?4716:4715);return year<=0&&year--,this.newDate(year,month,day)},toJSDate:function(year,month,day){var date=this._validate(year,month,day,_exports.local.invalidDate||_exports.regionalOptions[""].invalidDate),jsd=new Date(date.year(),date.month()-1,date.day());return jsd.setHours(0),jsd.setMinutes(0),jsd.setSeconds(0),jsd.setMilliseconds(0),jsd.setHours(jsd.getHours()>12?jsd.getHours()+2:0),jsd},fromJSDate:function(jsd){return this.newDate(jsd.getFullYear(),jsd.getMonth()+1,jsd.getDate())}});var _exports=_$main_388=new Calendars;_exports.cdate=CDate,_exports.baseCalendar=BaseCalendar,_exports.calendars.gregorian=GregorianCalendar;var gregorianCalendar=_$main_388.instance();function ChineseCalendar(language){this.local=this.regionalOptions[language||""]||this.regionalOptions[""]}ChineseCalendar.prototype=new _$main_388.baseCalendar,_$objectAssign_281(ChineseCalendar.prototype,{name:"Chinese",jdEpoch:1721425.5,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(date,padded){if("string"==typeof date){var match=date.match(MONTH_NUMBER_REGEXP);return match?match[0]:""}var year=this._validateYear(date),monthIndex=date.month(),month=""+this.toChineseMonth(year,monthIndex);return padded&&month.length<2&&(month="0"+month),this.isIntercalaryMonth(year,monthIndex)&&(month+="i"),month},monthNames:function(date){if("string"==typeof date){var match=date.match(MONTH_NAME_REGEXP);return match?match[0]:""}var year=this._validateYear(date),monthIndex=date.month(),monthName=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"][this.toChineseMonth(year,monthIndex)-1];return this.isIntercalaryMonth(year,monthIndex)&&(monthName="闰"+monthName),monthName},monthNamesShort:function(date){if("string"==typeof date){var match=date.match(MONTH_SHORT_NAME_REGEXP);return match?match[0]:""}var year=this._validateYear(date),monthIndex=date.month(),monthName=["一","二","三","四","五","六","七","八","九","十","十一","十二"][this.toChineseMonth(year,monthIndex)-1];return this.isIntercalaryMonth(year,monthIndex)&&(monthName="闰"+monthName),monthName},parseMonth:function(year,monthString){year=this._validateYear(year);var isIntercalary,month=parseInt(monthString);if(isNaN(month))"闰"===monthString[0]&&(isIntercalary=!0,monthString=monthString.substring(1)),"月"===monthString[monthString.length-1]&&(monthString=monthString.substring(0,monthString.length-1)),month=1+["一","二","三","四","五","六","七","八","九","十","十一","十二"].indexOf(monthString);else{var i=monthString[monthString.length-1];isIntercalary="i"===i||"I"===i}return this.toMonthIndex(year,month,isIntercalary)},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(year,error){if(year.year&&(year=year.year()),"number"!=typeof year||year<1888||year>2111)throw error.replace(/\{0\}/,this.local.name);return year},toMonthIndex:function(year,month,isIntercalary){var intercalaryMonth=this.intercalaryMonth(year);if(isIntercalary&&month!==intercalaryMonth||month<1||month>12)throw _$main_388.local.invalidMonth.replace(/\{0\}/,this.local.name);return intercalaryMonth?!isIntercalary&&month<=intercalaryMonth?month-1:month:month-1},toChineseMonth:function(year,monthIndex){year.year&&(monthIndex=(year=year.year()).month());var intercalaryMonth=this.intercalaryMonth(year);if(monthIndex<0||monthIndex>(intercalaryMonth?12:11))throw _$main_388.local.invalidMonth.replace(/\{0\}/,this.local.name);return intercalaryMonth?monthIndex<intercalaryMonth?monthIndex+1:monthIndex:monthIndex+1},intercalaryMonth:function(year){return year=this._validateYear(year),LUNAR_MONTH_DAYS[year-LUNAR_MONTH_DAYS[0]]>>13},isIntercalaryMonth:function(year,monthIndex){year.year&&(monthIndex=(year=year.year()).month());var intercalaryMonth=this.intercalaryMonth(year);return!!intercalaryMonth&&intercalaryMonth===monthIndex},leapYear:function(year){return 0!==this.intercalaryMonth(year)},weekOfYear:function(year,monthIndex,day){var firstThursday,validatedYear=this._validateYear(year,_$main_388.local.invalidyear),packedDate=CHINESE_NEW_YEAR[validatedYear-CHINESE_NEW_YEAR[0]],y=packedDate>>9&4095,m=packedDate>>5&15,d=31&packedDate;(firstThursday=gregorianCalendar.newDate(y,m,d)).add(4-(firstThursday.dayOfWeek()||7),"d");var offset=this.toJD(year,monthIndex,day)-firstThursday.toJD();return 1+Math.floor(offset/7)},monthsInYear:function(year){return this.leapYear(year)?13:12},daysInMonth:function(year,monthIndex){year.year&&(monthIndex=year.month(),year=year.year()),year=this._validateYear(year);var monthDaysTable=LUNAR_MONTH_DAYS[year-LUNAR_MONTH_DAYS[0]];if(monthIndex>(monthDaysTable>>13?12:11))throw _$main_388.local.invalidMonth.replace(/\{0\}/,this.local.name);return monthDaysTable&1<<12-monthIndex?30:29},weekDay:function(year,monthIndex,day){return(this.dayOfWeek(year,monthIndex,day)||7)<6},toJD:function(year,monthIndex,day){var date=this._validate(year,month,day,_$main_388.local.invalidDate);year=this._validateYear(date.year()),monthIndex=date.month(),day=date.day();var isIntercalary=this.isIntercalaryMonth(year,monthIndex),month=this.toChineseMonth(year,monthIndex),solar=function toSolar(yearOrDate,monthOrResult,day,isIntercalaryOrResult,result){var solarDate,lunarDate,daysFromNewYear;if("object"==typeof yearOrDate)lunarDate=yearOrDate,solarDate=monthOrResult||{};else{var isValidYear="number"==typeof yearOrDate&&yearOrDate>=1888&&yearOrDate<=2111;if(!isValidYear)throw new Error("Lunar year outside range 1888-2111");var isValidMonth="number"==typeof monthOrResult&&monthOrResult>=1&&monthOrResult<=12;if(!isValidMonth)throw new Error("Lunar month outside range 1 - 12");var isIntercalary,isValidDay="number"==typeof day&&day>=1&&day<=30;if(!isValidDay)throw new Error("Lunar day outside range 1 - 30");"object"==typeof isIntercalaryOrResult?(isIntercalary=!1,solarDate=isIntercalaryOrResult):(isIntercalary=!!isIntercalaryOrResult,solarDate=result||{}),lunarDate={year:yearOrDate,month:monthOrResult,day:day,isIntercalary:isIntercalary}}daysFromNewYear=lunarDate.day-1;var monthsFromNewYear,monthDaysTable=LUNAR_MONTH_DAYS[lunarDate.year-LUNAR_MONTH_DAYS[0]],intercalaryMonth=monthDaysTable>>13;monthsFromNewYear=intercalaryMonth?lunarDate.month>intercalaryMonth?lunarDate.month:lunarDate.isIntercalary?lunarDate.month:lunarDate.month-1:lunarDate.month-1;for(var i=0;i<monthsFromNewYear;i++){var daysInMonth=monthDaysTable&1<<12-i?30:29;daysFromNewYear+=daysInMonth}var packedDate=CHINESE_NEW_YEAR[lunarDate.year-CHINESE_NEW_YEAR[0]],jsDate=new Date(packedDate>>9&4095,(packedDate>>5&15)-1,(31&packedDate)+daysFromNewYear);return solarDate.year=jsDate.getFullYear(),solarDate.month=1+jsDate.getMonth(),solarDate.day=jsDate.getDate(),solarDate}(year,month,day,isIntercalary);return gregorianCalendar.toJD(solar.year,solar.month,solar.day)},fromJD:function(jd){var date=gregorianCalendar.fromJD(jd),lunar=function toLunar(yearOrDate,monthOrResult,day,result){var solarDate,lunarDate;if("object"==typeof yearOrDate)solarDate=yearOrDate,lunarDate=monthOrResult||{};else{var isValidYear="number"==typeof yearOrDate&&yearOrDate>=1888&&yearOrDate<=2111;if(!isValidYear)throw new Error("Solar year outside range 1888-2111");var isValidMonth="number"==typeof monthOrResult&&monthOrResult>=1&&monthOrResult<=12;if(!isValidMonth)throw new Error("Solar month outside range 1 - 12");var isValidDay="number"==typeof day&&day>=1&&day<=31;if(!isValidDay)throw new Error("Solar day outside range 1 - 31");solarDate={year:yearOrDate,month:monthOrResult,day:day},lunarDate=result||{}}var chineseNewYearPackedDate=CHINESE_NEW_YEAR[solarDate.year-CHINESE_NEW_YEAR[0]],packedDate=solarDate.year<<9|solarDate.month<<5|solarDate.day;lunarDate.year=packedDate>=chineseNewYearPackedDate?solarDate.year:solarDate.year-1,chineseNewYearPackedDate=CHINESE_NEW_YEAR[lunarDate.year-CHINESE_NEW_YEAR[0]];var daysFromNewYear,chineseNewYearJSDate=new Date(chineseNewYearPackedDate>>9&4095,(chineseNewYearPackedDate>>5&15)-1,31&chineseNewYearPackedDate),jsDate=new Date(solarDate.year,solarDate.month-1,solarDate.day);daysFromNewYear=Math.round((jsDate-chineseNewYearJSDate)/864e5);var i,monthDaysTable=LUNAR_MONTH_DAYS[lunarDate.year-LUNAR_MONTH_DAYS[0]];for(i=0;i<13;i++){var daysInMonth=monthDaysTable&1<<12-i?30:29;if(daysFromNewYear<daysInMonth)break;daysFromNewYear-=daysInMonth}var intercalaryMonth=monthDaysTable>>13;!intercalaryMonth||i<intercalaryMonth?(lunarDate.isIntercalary=!1,lunarDate.month=1+i):i===intercalaryMonth?(lunarDate.isIntercalary=!0,lunarDate.month=i):(lunarDate.isIntercalary=!1,lunarDate.month=i);return lunarDate.day=1+daysFromNewYear,lunarDate}(date.year(),date.month(),date.day()),monthIndex=this.toMonthIndex(lunar.year,lunar.month,lunar.isIntercalary);return this.newDate(lunar.year,monthIndex,lunar.day)},fromString:function(dateString){var match=dateString.match(DATE_REGEXP),year=this._validateYear(+match[1]),month=+match[2],isIntercalary=!!match[3],monthIndex=this.toMonthIndex(year,month,isIntercalary),day=+match[4];return this.newDate(year,monthIndex,day)},add:function(date,offset,period){var year=date.year(),monthIndex=date.month(),isIntercalary=this.isIntercalaryMonth(year,monthIndex),month=this.toChineseMonth(year,monthIndex),cdate=Object.getPrototypeOf(ChineseCalendar.prototype).add.call(this,date,offset,period);if("y"===period){var resultYear=cdate.year(),resultMonthIndex=cdate.month(),resultCanBeIntercalaryMonth=this.isIntercalaryMonth(resultYear,month),correctedMonthIndex=isIntercalary&&resultCanBeIntercalaryMonth?this.toMonthIndex(resultYear,month,!0):this.toMonthIndex(resultYear,month,!1);correctedMonthIndex!==resultMonthIndex&&cdate.month(correctedMonthIndex)}return cdate}});var DATE_REGEXP=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,MONTH_NUMBER_REGEXP=/^\d?\d[iI]?/m,MONTH_NAME_REGEXP=/^闰?十?[一二三四五六七八九]?月/m,MONTH_SHORT_NAME_REGEXP=/^闰?十?[一二三四五六七八九]?/m;_$main_388.calendars.chinese=ChineseCalendar;var LUNAR_MONTH_DAYS=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],CHINESE_NEW_YEAR=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904];function CopticCalendar(language){this.local=this.regionalOptions[language||""]||this.regionalOptions[""]}CopticCalendar.prototype=new _$main_388.baseCalendar,_$objectAssign_281(CopticCalendar.prototype,{name:"Coptic",jdEpoch:1825029.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(year){var date=this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear);return(year=date.year()+(date.year()<0?1:0))%4==3||year%4==-1},monthsInYear:function(year){return this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear||_$main_388.regionalOptions[""].invalidYear),13},weekOfYear:function(year,month,day){var checkDate=this.newDate(year,month,day);return checkDate.add(-checkDate.dayOfWeek(),"d"),Math.floor((checkDate.dayOfYear()-1)/7)+1},daysInMonth:function(year,month){var date=this._validate(year,month,this.minDay,_$main_388.local.invalidMonth);return this.daysPerMonth[date.month()-1]+(13===date.month()&&this.leapYear(date.year())?1:0)},weekDay:function(year,month,day){return(this.dayOfWeek(year,month,day)||7)<6},toJD:function(year,month,day){var date=this._validate(year,month,day,_$main_388.local.invalidDate);return(year=date.year())<0&&year++,date.day()+30*(date.month()-1)+365*(year-1)+Math.floor(year/4)+this.jdEpoch-1},fromJD:function(jd){var c=Math.floor(jd)+.5-this.jdEpoch,year=Math.floor((c-Math.floor((c+366)/1461))/365)+1;year<=0&&year--,c=Math.floor(jd)+.5-this.newDate(year,1,1).toJD();var month=Math.floor(c/30)+1,day=c-30*(month-1)+1;return this.newDate(year,month,day)}}),_$main_388.calendars.coptic=CopticCalendar;function DiscworldCalendar(language){this.local=this.regionalOptions[language||""]||this.regionalOptions[""]}DiscworldCalendar.prototype=new _$main_388.baseCalendar,_$objectAssign_281(DiscworldCalendar.prototype,{name:"Discworld",jdEpoch:1721425.5,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(year){return this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear),!1},monthsInYear:function(year){return this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear),13},daysInYear:function(year){return this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear),400},weekOfYear:function(year,month,day){var checkDate=this.newDate(year,month,day);return checkDate.add(-checkDate.dayOfWeek(),"d"),Math.floor((checkDate.dayOfYear()-1)/8)+1},daysInMonth:function(year,month){var date=this._validate(year,month,this.minDay,_$main_388.local.invalidMonth);return this.daysPerMonth[date.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(year,month,day){return(this._validate(year,month,day,_$main_388.local.invalidDate).day()+1)%8},weekDay:function(year,month,day){var dow=this.dayOfWeek(year,month,day);return dow>=2&&dow<=6},extraInfo:function(year,month,day){var date=this._validate(year,month,day,_$main_388.local.invalidDate);return{century:centuries[Math.floor((date.year()-1)/100)+1]||""}},toJD:function(year,month,day){var date=this._validate(year,month,day,_$main_388.local.invalidDate);return year=date.year()+(date.year()<0?1:0),month=date.month(),(day=date.day())+(month>1?16:0)+(month>2?32*(month-2):0)+400*(year-1)+this.jdEpoch-1},fromJD:function(jd){jd=Math.floor(jd+.5)-Math.floor(this.jdEpoch)-1;var year=Math.floor(jd/400)+1;jd-=400*(year-1),jd+=jd>15?16:0;var month=Math.floor(jd/32)+1,day=jd-32*(month-1)+1;return this.newDate(year<=0?year-1:year,month,day)}});var centuries={20:"Fruitbat",21:"Anchovy"};_$main_388.calendars.discworld=DiscworldCalendar;function EthiopianCalendar(language){this.local=this.regionalOptions[language||""]||this.regionalOptions[""]}EthiopianCalendar.prototype=new _$main_388.baseCalendar,_$objectAssign_281(EthiopianCalendar.prototype,{name:"Ethiopian",jdEpoch:1724220.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(year){var date=this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear);return(year=date.year()+(date.year()<0?1:0))%4==3||year%4==-1},monthsInYear:function(year){return this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear||_$main_388.regionalOptions[""].invalidYear),13},weekOfYear:function(year,month,day){var checkDate=this.newDate(year,month,day);return checkDate.add(-checkDate.dayOfWeek(),"d"),Math.floor((checkDate.dayOfYear()-1)/7)+1},daysInMonth:function(year,month){var date=this._validate(year,month,this.minDay,_$main_388.local.invalidMonth);return this.daysPerMonth[date.month()-1]+(13===date.month()&&this.leapYear(date.year())?1:0)},weekDay:function(year,month,day){return(this.dayOfWeek(year,month,day)||7)<6},toJD:function(year,month,day){var date=this._validate(year,month,day,_$main_388.local.invalidDate);return(year=date.year())<0&&year++,date.day()+30*(date.month()-1)+365*(year-1)+Math.floor(year/4)+this.jdEpoch-1},fromJD:function(jd){var c=Math.floor(jd)+.5-this.jdEpoch,year=Math.floor((c-Math.floor((c+366)/1461))/365)+1;year<=0&&year--,c=Math.floor(jd)+.5-this.newDate(year,1,1).toJD();var month=Math.floor(c/30)+1,day=c-30*(month-1)+1;return this.newDate(year,month,day)}}),_$main_388.calendars.ethiopian=EthiopianCalendar;function HebrewCalendar(language){this.local=this.regionalOptions[language||""]||this.regionalOptions[""]}function __mod_378(a,b){return a-b*Math.floor(a/b)}HebrewCalendar.prototype=new _$main_388.baseCalendar,_$objectAssign_281(HebrewCalendar.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(year){var date=this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear);return this._leapYear(date.year())},_leapYear:function(year){return __mod_378(7*(year=year<0?year+1:year)+1,19)<7},monthsInYear:function(year){return this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear),this._leapYear(year.year?year.year():year)?13:12},weekOfYear:function(year,month,day){var checkDate=this.newDate(year,month,day);return checkDate.add(-checkDate.dayOfWeek(),"d"),Math.floor((checkDate.dayOfYear()-1)/7)+1},daysInYear:function(year){return year=this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear).year(),this.toJD(-1===year?1:year+1,7,1)-this.toJD(year,7,1)},daysInMonth:function(year,month){return year.year&&(month=year.month(),year=year.year()),this._validate(year,month,this.minDay,_$main_388.local.invalidMonth),12===month&&this.leapYear(year)?30:8===month&&5===__mod_378(this.daysInYear(year),10)?30:9===month&&3===__mod_378(this.daysInYear(year),10)?29:this.daysPerMonth[month-1]},weekDay:function(year,month,day){return 6!==this.dayOfWeek(year,month,day)},extraInfo:function(year,month,day){var date=this._validate(year,month,day,_$main_388.local.invalidDate);return{yearType:(this.leapYear(date)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(date)%10-3]}},toJD:function(year,month,day){var date=this._validate(year,month,day,_$main_388.local.invalidDate);year=date.year(),month=date.month(),day=date.day();var adjYear=year<=0?year+1:year,jd=this.jdEpoch+this._delay1(adjYear)+this._delay2(adjYear)+day+1;if(month<7){for(var m=7;m<=this.monthsInYear(year);m++)jd+=this.daysInMonth(year,m);for(m=1;m<month;m++)jd+=this.daysInMonth(year,m)}else for(m=7;m<month;m++)jd+=this.daysInMonth(year,m);return jd},_delay1:function(year){var months=Math.floor((235*year-234)/19),parts=12084+13753*months,day=29*months+Math.floor(parts/25920);return __mod_378(3*(day+1),7)<3&&day++,day},_delay2:function(year){var last=this._delay1(year-1),present=this._delay1(year);return this._delay1(year+1)-present==356?2:present-last==382?1:0},fromJD:function(jd){jd=Math.floor(jd)+.5;for(var year=Math.floor(98496*(jd-this.jdEpoch)/35975351)-1;jd>=this.toJD(-1===year?1:year+1,7,1);)year++;for(var month=jd<this.toJD(year,1,1)?7:1;jd>this.toJD(year,month,this.daysInMonth(year,month));)month++;var day=jd-this.toJD(year,month,1)+1;return this.newDate(year,month,day)}}),_$main_388.calendars.hebrew=HebrewCalendar;function IslamicCalendar(language){this.local=this.regionalOptions[language||""]||this.regionalOptions[""]}IslamicCalendar.prototype=new _$main_388.baseCalendar,_$objectAssign_281(IslamicCalendar.prototype,{name:"Islamic",jdEpoch:1948439.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-khamīs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(year){return(11*this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear).year()+14)%30<11},weekOfYear:function(year,month,day){var checkDate=this.newDate(year,month,day);return checkDate.add(-checkDate.dayOfWeek(),"d"),Math.floor((checkDate.dayOfYear()-1)/7)+1},daysInYear:function(year){return this.leapYear(year)?355:354},daysInMonth:function(year,month){var date=this._validate(year,month,this.minDay,_$main_388.local.invalidMonth);return this.daysPerMonth[date.month()-1]+(12===date.month()&&this.leapYear(date.year())?1:0)},weekDay:function(year,month,day){return 5!==this.dayOfWeek(year,month,day)},toJD:function(year,month,day){var date=this._validate(year,month,day,_$main_388.local.invalidDate);return year=date.year(),month=date.month(),day=date.day(),year=year<=0?year+1:year,day+Math.ceil(29.5*(month-1))+354*(year-1)+Math.floor((3+11*year)/30)+this.jdEpoch-1},fromJD:function(jd){jd=Math.floor(jd)+.5;var year=Math.floor((30*(jd-this.jdEpoch)+10646)/10631);year=year<=0?year-1:year;var month=Math.min(12,Math.ceil((jd-29-this.toJD(year,1,1))/29.5)+1),day=jd-this.toJD(year,month,1)+1;return this.newDate(year,month,day)}}),_$main_388.calendars.islamic=IslamicCalendar;function JulianCalendar(language){this.local=this.regionalOptions[language||""]||this.regionalOptions[""]}JulianCalendar.prototype=new _$main_388.baseCalendar,_$objectAssign_281(JulianCalendar.prototype,{name:"Julian",jdEpoch:1721423.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(year){var date=this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear);return(year=date.year()<0?date.year()+1:date.year())%4==0},weekOfYear:function(year,month,day){var checkDate=this.newDate(year,month,day);return checkDate.add(4-(checkDate.dayOfWeek()||7),"d"),Math.floor((checkDate.dayOfYear()-1)/7)+1},daysInMonth:function(year,month){var date=this._validate(year,month,this.minDay,_$main_388.local.invalidMonth);return this.daysPerMonth[date.month()-1]+(2===date.month()&&this.leapYear(date.year())?1:0)},weekDay:function(year,month,day){return(this.dayOfWeek(year,month,day)||7)<6},toJD:function(year,month,day){var date=this._validate(year,month,day,_$main_388.local.invalidDate);return year=date.year(),month=date.month(),day=date.day(),year<0&&year++,month<=2&&(year--,month+=12),Math.floor(365.25*(year+4716))+Math.floor(30.6001*(month+1))+day-1524.5},fromJD:function(jd){var b=Math.floor(jd+.5)+1524,c=Math.floor((b-122.1)/365.25),d=Math.floor(365.25*c),e=Math.floor((b-d)/30.6001),month=e-Math.floor(e<14?1:13),year=c-Math.floor(month>2?4716:4715),day=b-d-Math.floor(30.6001*e);return year<=0&&year--,this.newDate(year,month,day)}}),_$main_388.calendars.julian=JulianCalendar;function MayanCalendar(language){this.local=this.regionalOptions[language||""]||this.regionalOptions[""]}function __mod_381(a,b){return a-b*Math.floor(a/b)}function amod(a,b){return __mod_381(a-1,b)+1}MayanCalendar.prototype=new _$main_388.baseCalendar,_$objectAssign_281(MayanCalendar.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(year){return this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear),!1},formatYear:function(year){year=this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear).year();var baktun=Math.floor(year/400);return year%=400,year+=year<0?400:0,baktun+"."+Math.floor(year/20)+"."+year%20},forYear:function(years){if((years=years.split(".")).length<3)throw"Invalid Mayan year";for(var year=0,i=0;i<years.length;i++){var y=parseInt(years[i],10);if(Math.abs(y)>19||i>0&&y<0)throw"Invalid Mayan year";year=20*year+y}return year},monthsInYear:function(year){return this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear),18},weekOfYear:function(year,month,day){return this._validate(year,month,day,_$main_388.local.invalidDate),0},daysInYear:function(year){return this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear),360},daysInMonth:function(year,month){return this._validate(year,month,this.minDay,_$main_388.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(year,month,day){return this._validate(year,month,day,_$main_388.local.invalidDate).day()},weekDay:function(year,month,day){return this._validate(year,month,day,_$main_388.local.invalidDate),!0},extraInfo:function(year,month,day){var jd=this._validate(year,month,day,_$main_388.local.invalidDate).toJD(),haab=this._toHaab(jd),tzolkin=this._toTzolkin(jd);return{haabMonthName:this.local.haabMonths[haab[0]-1],haabMonth:haab[0],haabDay:haab[1],tzolkinDayName:this.local.tzolkinMonths[tzolkin[0]-1],tzolkinDay:tzolkin[0],tzolkinTrecena:tzolkin[1]}},_toHaab:function(jd){var day=__mod_381((jd-=this.jdEpoch)+8+340,365);return[Math.floor(day/20)+1,__mod_381(day,20)]},_toTzolkin:function(jd){return[amod((jd-=this.jdEpoch)+20,20),amod(jd+4,13)]},toJD:function(year,month,day){var date=this._validate(year,month,day,_$main_388.local.invalidDate);return date.day()+20*date.month()+360*date.year()+this.jdEpoch},fromJD:function(jd){jd=Math.floor(jd)+.5-this.jdEpoch;var year=Math.floor(jd/360);jd%=360,jd+=jd<0?360:0;var month=Math.floor(jd/20),day=jd%20;return this.newDate(year,month,day)}}),_$main_388.calendars.mayan=MayanCalendar;function NanakshahiCalendar(language){this.local=this.regionalOptions[language||""]||this.regionalOptions[""]}NanakshahiCalendar.prototype=new _$main_388.baseCalendar;var gregorian=_$main_388.instance("gregorian");_$objectAssign_281(NanakshahiCalendar.prototype,{name:"Nanakshahi",jdEpoch:2257673.5,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(year){var date=this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear||_$main_388.regionalOptions[""].invalidYear);return gregorian.leapYear(date.year()+(date.year()<1?1:0)+1469)},weekOfYear:function(year,month,day){var checkDate=this.newDate(year,month,day);return checkDate.add(1-(checkDate.dayOfWeek()||7),"d"),Math.floor((checkDate.dayOfYear()-1)/7)+1},daysInMonth:function(year,month){var date=this._validate(year,month,this.minDay,_$main_388.local.invalidMonth);return this.daysPerMonth[date.month()-1]+(12===date.month()&&this.leapYear(date.year())?1:0)},weekDay:function(year,month,day){return(this.dayOfWeek(year,month,day)||7)<6},toJD:function(year,month,day){var date=this._validate(year,month,day,_$main_388.local.invalidMonth);(year=date.year())<0&&year++;for(var doy=date.day(),m=1;m<date.month();m++)doy+=this.daysPerMonth[m-1];return doy+gregorian.toJD(year+1468,3,13)},fromJD:function(jd){jd=Math.floor(jd+.5);for(var year=Math.floor((jd-(this.jdEpoch-1))/366);jd>=this.toJD(year+1,1,1);)year++;for(var day=jd-Math.floor(this.toJD(year,1,1)+.5)+1,month=1;day>this.daysInMonth(year,month);)day-=this.daysInMonth(year,month),month++;return this.newDate(year,month,day)}}),_$main_388.calendars.nanakshahi=NanakshahiCalendar;function NepaliCalendar(language){this.local=this.regionalOptions[language||""]||this.regionalOptions[""]}NepaliCalendar.prototype=new _$main_388.baseCalendar,_$objectAssign_281(NepaliCalendar.prototype,{name:"Nepali",jdEpoch:1700709.5,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(year){return this.daysInYear(year)!==this.daysPerYear},weekOfYear:function(year,month,day){var checkDate=this.newDate(year,month,day);return checkDate.add(-checkDate.dayOfWeek(),"d"),Math.floor((checkDate.dayOfYear()-1)/7)+1},daysInYear:function(year){if(year=this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear).year(),void 0===this.NEPALI_CALENDAR_DATA[year])return this.daysPerYear;for(var daysPerYear=0,month_number=this.minMonth;month_number<=12;month_number++)daysPerYear+=this.NEPALI_CALENDAR_DATA[year][month_number];return daysPerYear},daysInMonth:function(year,month){return year.year&&(month=year.month(),year=year.year()),this._validate(year,month,this.minDay,_$main_388.local.invalidMonth),void 0===this.NEPALI_CALENDAR_DATA[year]?this.daysPerMonth[month-1]:this.NEPALI_CALENDAR_DATA[year][month]},weekDay:function(year,month,day){return 6!==this.dayOfWeek(year,month,day)},toJD:function(nepaliYear,nepaliMonth,nepaliDay){var date=this._validate(nepaliYear,nepaliMonth,nepaliDay,_$main_388.local.invalidDate);nepaliYear=date.year(),nepaliMonth=date.month(),nepaliDay=date.day();var gregorianCalendar=_$main_388.instance(),gregorianDayOfYear=0,nepaliMonthToCheck=nepaliMonth,nepaliYearToCheck=nepaliYear;this._createMissingCalendarData(nepaliYear);var gregorianYear=nepaliYear-(nepaliMonthToCheck>9||9===nepaliMonthToCheck&&nepaliDay>=this.NEPALI_CALENDAR_DATA[nepaliYearToCheck][0]?56:57);for(9!==nepaliMonth&&(gregorianDayOfYear=nepaliDay,nepaliMonthToCheck--);9!==nepaliMonthToCheck;)nepaliMonthToCheck<=0&&(nepaliMonthToCheck=12,nepaliYearToCheck--),gregorianDayOfYear+=this.NEPALI_CALENDAR_DATA[nepaliYearToCheck][nepaliMonthToCheck],nepaliMonthToCheck--;return 9===nepaliMonth?(gregorianDayOfYear+=nepaliDay-this.NEPALI_CALENDAR_DATA[nepaliYearToCheck][0])<0&&(gregorianDayOfYear+=gregorianCalendar.daysInYear(gregorianYear)):gregorianDayOfYear+=this.NEPALI_CALENDAR_DATA[nepaliYearToCheck][9]-this.NEPALI_CALENDAR_DATA[nepaliYearToCheck][0],gregorianCalendar.newDate(gregorianYear,1,1).add(gregorianDayOfYear,"d").toJD()},fromJD:function(jd){var gregorianDate=_$main_388.instance().fromJD(jd),gregorianYear=gregorianDate.year(),gregorianDayOfYear=gregorianDate.dayOfYear(),nepaliYear=gregorianYear+56;this._createMissingCalendarData(nepaliYear);for(var nepaliMonth=9,dayOfFirstJanInPaush=this.NEPALI_CALENDAR_DATA[nepaliYear][0],daysSinceJanFirstToEndOfNepaliMonth=this.NEPALI_CALENDAR_DATA[nepaliYear][nepaliMonth]-dayOfFirstJanInPaush+1;gregorianDayOfYear>daysSinceJanFirstToEndOfNepaliMonth;)++nepaliMonth>12&&(nepaliMonth=1,nepaliYear++),daysSinceJanFirstToEndOfNepaliMonth+=this.NEPALI_CALENDAR_DATA[nepaliYear][nepaliMonth];var nepaliDayOfMonth=this.NEPALI_CALENDAR_DATA[nepaliYear][nepaliMonth]-(daysSinceJanFirstToEndOfNepaliMonth-gregorianDayOfYear);return this.newDate(nepaliYear,nepaliMonth,nepaliDayOfMonth)},_createMissingCalendarData:function(nepaliYear){var tmp_calendar_data=this.daysPerMonth.slice(0);tmp_calendar_data.unshift(17);for(var nepaliYearToCreate=nepaliYear-1;nepaliYearToCreate<nepaliYear+2;nepaliYearToCreate++)void 0===this.NEPALI_CALENDAR_DATA[nepaliYearToCreate]&&(this.NEPALI_CALENDAR_DATA[nepaliYearToCreate]=tmp_calendar_data)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2000:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),_$main_388.calendars.nepali=NepaliCalendar;function PersianCalendar(language){this.local=this.regionalOptions[language||""]||this.regionalOptions[""]}function __mod_384(a,b){return a-b*Math.floor(a/b)}PersianCalendar.prototype=new _$main_388.baseCalendar,_$objectAssign_281(PersianCalendar.prototype,{name:"Persian",jdEpoch:1948320.5,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Chæharshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Chæ","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(year){var date=this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear);return 682*((date.year()-(date.year()>0?474:473))%2820+474+38)%2816<682},weekOfYear:function(year,month,day){var checkDate=this.newDate(year,month,day);return checkDate.add(-(checkDate.dayOfWeek()+1)%7,"d"),Math.floor((checkDate.dayOfYear()-1)/7)+1},daysInMonth:function(year,month){var date=this._validate(year,month,this.minDay,_$main_388.local.invalidMonth);return this.daysPerMonth[date.month()-1]+(12===date.month()&&this.leapYear(date.year())?1:0)},weekDay:function(year,month,day){return 5!==this.dayOfWeek(year,month,day)},toJD:function(year,month,day){var date=this._validate(year,month,day,_$main_388.local.invalidDate);year=date.year(),month=date.month(),day=date.day();var epBase=year-(year>=0?474:473),epYear=474+__mod_384(epBase,2820);return day+(month<=7?31*(month-1):30*(month-1)+6)+Math.floor((682*epYear-110)/2816)+365*(epYear-1)+1029983*Math.floor(epBase/2820)+this.jdEpoch-1},fromJD:function(jd){var depoch=(jd=Math.floor(jd)+.5)-this.toJD(475,1,1),cycle=Math.floor(depoch/1029983),cyear=__mod_384(depoch,1029983),ycycle=2820;if(1029982!==cyear){var aux1=Math.floor(cyear/366),aux2=__mod_384(cyear,366);ycycle=Math.floor((2134*aux1+2816*aux2+2815)/1028522)+aux1+1}var year=ycycle+2820*cycle+474;year=year<=0?year-1:year;var yday=jd-this.toJD(year,1,1)+1,month=yday<=186?Math.ceil(yday/31):Math.ceil((yday-6)/30),day=jd-this.toJD(year,month,1)+1;return this.newDate(year,month,day)}}),_$main_388.calendars.persian=PersianCalendar,_$main_388.calendars.jalali=PersianCalendar;var __gregorianCalendar_385=_$main_388.instance();function TaiwanCalendar(language){this.local=this.regionalOptions[language||""]||this.regionalOptions[""]}TaiwanCalendar.prototype=new _$main_388.baseCalendar,_$objectAssign_281(TaiwanCalendar.prototype,{name:"Taiwan",jdEpoch:2419402.5,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(year){var date=this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear);year=this._t2gYear(date.year());return __gregorianCalendar_385.leapYear(year)},weekOfYear:function(year,month,day){var date=this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear);year=this._t2gYear(date.year());return __gregorianCalendar_385.weekOfYear(year,date.month(),date.day())},daysInMonth:function(year,month){var date=this._validate(year,month,this.minDay,_$main_388.local.invalidMonth);return this.daysPerMonth[date.month()-1]+(2===date.month()&&this.leapYear(date.year())?1:0)},weekDay:function(year,month,day){return(this.dayOfWeek(year,month,day)||7)<6},toJD:function(year,month,day){var date=this._validate(year,month,day,_$main_388.local.invalidDate);year=this._t2gYear(date.year());return __gregorianCalendar_385.toJD(year,date.month(),date.day())},fromJD:function(jd){var date=__gregorianCalendar_385.fromJD(jd),year=this._g2tYear(date.year());return this.newDate(year,date.month(),date.day())},_t2gYear:function(year){return year+this.yearsOffset+(year>=-this.yearsOffset&&year<=-1?1:0)},_g2tYear:function(year){return year-this.yearsOffset-(year>=1&&year<=this.yearsOffset?1:0)}}),_$main_388.calendars.taiwan=TaiwanCalendar;var __gregorianCalendar_386=_$main_388.instance();function ThaiCalendar(language){this.local=this.regionalOptions[language||""]||this.regionalOptions[""]}ThaiCalendar.prototype=new _$main_388.baseCalendar,_$objectAssign_281(ThaiCalendar.prototype,{name:"Thai",jdEpoch:1523098.5,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(year){var date=this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear);year=this._t2gYear(date.year());return __gregorianCalendar_386.leapYear(year)},weekOfYear:function(year,month,day){var date=this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear);year=this._t2gYear(date.year());return __gregorianCalendar_386.weekOfYear(year,date.month(),date.day())},daysInMonth:function(year,month){var date=this._validate(year,month,this.minDay,_$main_388.local.invalidMonth);return this.daysPerMonth[date.month()-1]+(2===date.month()&&this.leapYear(date.year())?1:0)},weekDay:function(year,month,day){return(this.dayOfWeek(year,month,day)||7)<6},toJD:function(year,month,day){var date=this._validate(year,month,day,_$main_388.local.invalidDate);year=this._t2gYear(date.year());return __gregorianCalendar_386.toJD(year,date.month(),date.day())},fromJD:function(jd){var date=__gregorianCalendar_386.fromJD(jd),year=this._g2tYear(date.year());return this.newDate(year,date.month(),date.day())},_t2gYear:function(year){return year-this.yearsOffset-(year>=1&&year<=this.yearsOffset?1:0)},_g2tYear:function(year){return year+this.yearsOffset+(year>=-this.yearsOffset&&year<=-1?1:0)}}),_$main_388.calendars.thai=ThaiCalendar;function UmmAlQuraCalendar(language){this.local=this.regionalOptions[language||""]||this.regionalOptions[""]}UmmAlQuraCalendar.prototype=new _$main_388.baseCalendar,_$objectAssign_281(UmmAlQuraCalendar.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thalāthā’","Yawm al-Arba‘ā’","Yawm al-Khamīs","Yawm al-Jum‘a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(year){var date=this._validate(year,this.minMonth,this.minDay,_$main_388.local.invalidYear);return 355===this.daysInYear(date.year())},weekOfYear:function(year,month,day){var checkDate=this.newDate(year,month,day);return checkDate.add(-checkDate.dayOfWeek(),"d"),Math.floor((checkDate.dayOfYear()-1)/7)+1},daysInYear:function(year){for(var daysCount=0,i=1;i<=12;i++)daysCount+=this.daysInMonth(year,i);return daysCount},daysInMonth:function(year,month){for(var mcjdn=this._validate(year,month,this.minDay,_$main_388.local.invalidMonth).toJD()-24e5+.5,index=0,i=0;i<ummalqura_dat.length;i++){if(ummalqura_dat[i]>mcjdn)return ummalqura_dat[index]-ummalqura_dat[index-1];index++}return 30},weekDay:function(year,month,day){return 5!==this.dayOfWeek(year,month,day)},toJD:function(year,month,day){var date=this._validate(year,month,day,_$main_388.local.invalidDate),index=12*(date.year()-1)+date.month()-15292;return date.day()+ummalqura_dat[index-1]-1+24e5-.5},fromJD:function(jd){for(var mcjdn=jd-24e5+.5,index=0,i=0;i<ummalqura_dat.length&&!(ummalqura_dat[i]>mcjdn);i++)index++;var lunation=index+15292,ii=Math.floor((lunation-1)/12),year=ii+1,month=lunation-12*ii,day=mcjdn-ummalqura_dat[index-1]+1;return this.newDate(year,month,day)},isValid:function(year,month,day){var valid=_$main_388.baseCalendar.prototype.isValid.apply(this,arguments);return valid&&(valid=(year=null!=year.year?year.year:year)>=1276&&year<=1500),valid},_validate:function(year,month,day,error){var date=_$main_388.baseCalendar.prototype._validate.apply(this,arguments);if(date.year<1276||date.year>1500)throw error.replace(/\{0\}/,this.local.name);return date}}),_$main_388.calendars.ummalqura=UmmAlQuraCalendar;var ummalqura_dat=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990];_$objectAssign_281(_$main_388.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),_$main_388.local=_$main_388.regionalOptions[""],_$objectAssign_281(_$main_388.cdate.prototype,{formatDate:function(format,settings){return"string"!=typeof format&&(settings=format,format=""),this._calendar.formatDate(format||"",this,settings)}}),_$objectAssign_281(_$main_388.baseCalendar.prototype,{UNIX_EPOCH:_$main_388.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:86400,TICKS_EPOCH:_$main_388.instance().jdEpoch,TICKS_PER_DAY:864e9,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(format,date,settings){if("string"!=typeof format&&(settings=date,date=format,format=""),!date)return"";if(date.calendar()!==this)throw _$main_388.local.invalidFormat||_$main_388.regionalOptions[""].invalidFormat;format=format||this.local.dateFormat;for(var match,value,shortNames,longNames,dayNamesShort=(settings=settings||{}).dayNamesShort||this.local.dayNamesShort,dayNames=settings.dayNames||this.local.dayNames,monthNumbers=settings.monthNumbers||this.local.monthNumbers,monthNamesShort=settings.monthNamesShort||this.local.monthNamesShort,monthNames=settings.monthNames||this.local.monthNames,doubled=(settings.calculateWeek||this.local.calculateWeek,function(match,step){for(var matches=1;iFormat+matches<format.length&&format.charAt(iFormat+matches)===match;)matches++;return iFormat+=matches-1,Math.floor(matches/(step||1))>1}),formatNumber=function(match,value,len,step){var num=""+value;if(doubled(match,step))for(;num.length<len;)num="0"+num;return num},calendar=this,formatMonth=function(date){return"function"==typeof monthNumbers?monthNumbers.call(calendar,date,doubled("m")):localiseNumbers(formatNumber("m",date.month(),2))},formatMonthName=function(date,useLongName){return useLongName?"function"==typeof monthNames?monthNames.call(calendar,date):monthNames[date.month()-calendar.minMonth]:"function"==typeof monthNamesShort?monthNamesShort.call(calendar,date):monthNamesShort[date.month()-calendar.minMonth]},digits=this.local.digits,localiseNumbers=function(value){return settings.localNumbers&&digits?digits(value):value},output="",literal=!1,iFormat=0;iFormat<format.length;iFormat++)if(literal)"'"!==format.charAt(iFormat)||doubled("'")?output+=format.charAt(iFormat):literal=!1;else switch(format.charAt(iFormat)){case"d":output+=localiseNumbers(formatNumber("d",date.day(),2));break;case"D":output+=(match="D",value=date.dayOfWeek(),shortNames=dayNamesShort,longNames=dayNames,doubled(match)?longNames[value]:shortNames[value]);break;case"o":output+=formatNumber("o",date.dayOfYear(),3);break;case"w":output+=formatNumber("w",date.weekOfYear(),2);break;case"m":output+=formatMonth(date);break;case"M":output+=formatMonthName(date,doubled("M"));break;case"y":output+=doubled("y",2)?date.year():(date.year()%100<10?"0":"")+date.year()%100;break;case"Y":doubled("Y",2),output+=date.formatYear();break;case"J":output+=date.toJD();break;case"@":output+=(date.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":output+=(date.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":doubled("'")?output+="'":literal=!0;break;default:output+=format.charAt(iFormat)}return output},parseDate:function(format,value,settings){if(null==value)throw _$main_388.local.invalidArguments||_$main_388.regionalOptions[""].invalidArguments;if(""===(value="object"==typeof value?value.toString():value+""))return null;format=format||this.local.dateFormat;var shortYearCutoff=(settings=settings||{}).shortYearCutoff||this.shortYearCutoff;shortYearCutoff="string"!=typeof shortYearCutoff?shortYearCutoff:this.today().year()%100+parseInt(shortYearCutoff,10);for(var dayNamesShort=settings.dayNamesShort||this.local.dayNamesShort,dayNames=settings.dayNames||this.local.dayNames,parseMonth=settings.parseMonth||this.local.parseMonth,monthNumbers=settings.monthNumbers||this.local.monthNumbers,monthNamesShort=settings.monthNamesShort||this.local.monthNamesShort,monthNames=settings.monthNames||this.local.monthNames,jd=-1,year=-1,month=-1,day=-1,doy=-1,shortYear=!1,literal=!1,doubled=function(match,step){for(var matches=1;iFormat+matches<format.length&&format.charAt(iFormat+matches)===match;)matches++;return iFormat+=matches-1,Math.floor(matches/(step||1))>1},getNumber=function(match,step){var isDoubled=doubled(match,step),size=[2,3,isDoubled?4:2,isDoubled?4:2,10,11,20]["oyYJ@!".indexOf(match)+1],digits=new RegExp("^-?\\d{1,"+size+"}"),num=value.substring(iValue).match(digits);if(!num)throw(_$main_388.local.missingNumberAt||_$main_388.regionalOptions[""].missingNumberAt).replace(/\{0\}/,iValue);return iValue+=num[0].length,parseInt(num[0],10)},calendar=this,getMonthNumber=function(){if("function"==typeof monthNumbers){doubled("m");var month=monthNumbers.call(calendar,value.substring(iValue));return iValue+=month.length,month}return getNumber("m")},getName=function(match,shortNames,longNames,step){for(var names=doubled(match,step)?longNames:shortNames,i=0;i<names.length;i++)if(value.substr(iValue,names[i].length).toLowerCase()===names[i].toLowerCase())return iValue+=names[i].length,i+calendar.minMonth;throw(_$main_388.local.unknownNameAt||_$main_388.regionalOptions[""].unknownNameAt).replace(/\{0\}/,iValue)},getMonthName=function(){if("function"==typeof monthNames){var month=doubled("M")?monthNames.call(calendar,value.substring(iValue)):monthNamesShort.call(calendar,value.substring(iValue));return iValue+=month.length,month}return getName("M",monthNamesShort,monthNames)},checkLiteral=function(){if(value.charAt(iValue)!==format.charAt(iFormat))throw(_$main_388.local.unexpectedLiteralAt||_$main_388.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,iValue);iValue++},iValue=0,iFormat=0;iFormat<format.length;iFormat++)if(literal)"'"!==format.charAt(iFormat)||doubled("'")?checkLiteral():literal=!1;else switch(format.charAt(iFormat)){case"d":day=getNumber("d");break;case"D":getName("D",dayNamesShort,dayNames);break;case"o":doy=getNumber("o");break;case"w":getNumber("w");break;case"m":month=getMonthNumber();break;case"M":month=getMonthName();break;case"y":var iSave=iFormat;shortYear=!doubled("y",2),iFormat=iSave,year=getNumber("y",2);break;case"Y":year=getNumber("Y",2);break;case"J":jd=getNumber("J")+.5,"."===value.charAt(iValue)&&(iValue++,getNumber("J"));break;case"@":jd=getNumber("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":jd=getNumber("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":iValue=value.length;break;case"'":doubled("'")?checkLiteral():literal=!0;break;default:checkLiteral()}if(iValue<value.length)throw _$main_388.local.unexpectedText||_$main_388.regionalOptions[""].unexpectedText;if(-1===year?year=this.today().year():year<100&&shortYear&&(year+=-1===shortYearCutoff?1900:this.today().year()-this.today().year()%100-(year<=shortYearCutoff?0:100)),"string"==typeof month&&(month=parseMonth.call(this,year,month)),doy>-1){month=1,day=doy;for(var dim=this.daysInMonth(year,month);day>dim;dim=this.daysInMonth(year,month))month++,day-=dim}return jd>-1?this.fromJD(jd):this.newDate(year,month,day)},determineDate:function(dateSpec,defaultDate,currentDate,dateFormat,settings){currentDate&&"object"!=typeof currentDate&&(settings=dateFormat,dateFormat=currentDate,currentDate=null),"string"!=typeof dateFormat&&(settings=dateFormat,dateFormat="");var calendar=this;return defaultDate=defaultDate?defaultDate.newDate():null,dateSpec=null==dateSpec?defaultDate:"string"==typeof dateSpec?function(offset){try{return calendar.parseDate(dateFormat,offset,settings)}catch(e){}for(var date=((offset=offset.toLowerCase()).match(/^c/)&&currentDate?currentDate.newDate():null)||calendar.today(),pattern=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,matches=pattern.exec(offset);matches;)date.add(parseInt(matches[1],10),matches[2]||"d"),matches=pattern.exec(offset);return date}(dateSpec):"number"==typeof dateSpec?isNaN(dateSpec)||dateSpec===1/0||dateSpec===-1/0?defaultDate:calendar.today().add(dateSpec,"d"):calendar.newDate(dateSpec)}});var _$calendars_408=_$main_388,__EPOCHJD_409=_$numerical_517.EPOCHJD,__ONEDAY_409=_$numerical_517.ONEDAY,__attributes_409={valType:"enumerated",values:Object.keys(_$calendars_408.calendars),editType:"calc",dflt:"gregorian"},handleDefaults=function(contIn,contOut,attr,dflt){var attrs={};return attrs[attr]=__attributes_409,_$lib_539.coerce(contIn,contOut,attrs,attr,dflt)},UNKNOWN="##",d3ToWorldCalendars={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:UNKNOWN,w:UNKNOWN,c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}};var allCals={};function getCal(calendar){var calendarObj=allCals[calendar];return calendarObj||(calendarObj=allCals[calendar]=_$calendars_408.instance(calendar))}function makeAttrs(description){return _$lib_539.extendFlat({},__attributes_409,{description:description})}function makeTraceAttrsDescription(coord){return"Sets the calendar system to use with `"+coord+"` date data."}var xAttrs={xcalendar:makeAttrs(makeTraceAttrsDescription("x"))},xyAttrs=_$lib_539.extendFlat({},xAttrs,{ycalendar:makeAttrs(makeTraceAttrsDescription("y"))}),xyzAttrs=_$lib_539.extendFlat({},xyAttrs,{zcalendar:makeAttrs(makeTraceAttrsDescription("z"))}),axisAttrs=makeAttrs(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" ")),_$calendars_6={moduleType:"component",name:"calendars",schema:{traces:{scatter:xyAttrs,bar:xyAttrs,box:xyAttrs,heatmap:xyAttrs,contour:xyAttrs,histogram:xyAttrs,histogram2d:xyAttrs,histogram2dcontour:xyAttrs,scatter3d:xyzAttrs,surface:xyzAttrs,mesh3d:xyzAttrs,scattergl:xyAttrs,ohlc:xAttrs,candlestick:xAttrs},layout:{calendar:makeAttrs(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:axisAttrs},yaxis:{calendar:axisAttrs},scene:{xaxis:{calendar:axisAttrs},yaxis:{calendar:axisAttrs},zaxis:{calendar:axisAttrs}},polar:{radialaxis:{calendar:axisAttrs}}},transforms:{filter:{valuecalendar:makeAttrs(["Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:makeAttrs(["Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:__attributes_409,handleDefaults:handleDefaults,handleTraceDefaults:function(traceIn,traceOut,coords,layout){for(var i=0;i<coords.length;i++)handleDefaults(traceIn,traceOut,coords[i]+"calendar",layout.calendar)},CANONICAL_SUNDAY:{chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},CANONICAL_TICK:{chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},DFLTRANGE:{chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},getCal:getCal,worldCalFmt:function worldCalFmt(fmt,x,calendar){for(var modifier,directive,directiveLen,directiveObj,replacementPart,dateJD=Math.floor((x+.05)/__ONEDAY_409)+__EPOCHJD_409,cDate=getCal(calendar).fromJD(dateJD),i=0;-1!==(i=fmt.indexOf("%",i));)"0"===(modifier=fmt.charAt(i+1))||"-"===modifier||"_"===modifier?(directiveLen=3,directive=fmt.charAt(i+2),"_"===modifier&&(modifier="-")):(directive=modifier,modifier="0",directiveLen=2),(directiveObj=d3ToWorldCalendars[directive])?(replacementPart=directiveObj===UNKNOWN?UNKNOWN:cDate.formatDate(directiveObj[modifier]),fmt=fmt.substr(0,i)+replacementPart+fmt.substr(i+directiveLen),i+=replacementPart.length):i+=directiveLen;return fmt}},__extendFlat_820=_$lib_539.extendFlat,__dash_820=_$attributes_435.dash,lineAttrs=_$attributes_862.line;function directionAttrs(lineColorDefault){return{name:{valType:"string",editType:"style"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},line:{color:__extendFlat_820({},lineAttrs.color,{dflt:lineColorDefault}),width:lineAttrs.width,dash:__dash_820,editType:"style"},editType:"style"}}var _$attributes_820={x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",dflt:[],editType:"calc"},high:{valType:"data_array",dflt:[],editType:"calc"},low:{valType:"data_array",dflt:[],editType:"calc"},close:{valType:"data_array",dflt:[],editType:"calc"},line:{width:__extendFlat_820({},lineAttrs.width,{}),dash:__extendFlat_820({},__dash_820,{}),editType:"style"},increasing:directionAttrs("#3D9970"),decreasing:directionAttrs("#FF4136"),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calcIfAutorange"}},__extendFlat_702=_$lib_539.extendFlat;function __directionAttrs_702(lineColorDefault){return{name:_$attributes_820.increasing.name,showlegend:_$attributes_820.increasing.showlegend,line:{color:__extendFlat_702({},_$attributes_691.line.color,{dflt:lineColorDefault}),width:_$attributes_691.line.width,editType:"style"},fillcolor:_$attributes_691.fillcolor,editType:"style"}}var _$attributes_702={x:_$attributes_820.x,open:_$attributes_820.open,high:_$attributes_820.high,low:_$attributes_820.low,close:_$attributes_820.close,line:{width:__extendFlat_702({},_$attributes_691.line.width,{}),editType:"style"},increasing:__directionAttrs_702(_$attributes_820.increasing.line.color.dflt),decreasing:__directionAttrs_702(_$attributes_820.decreasing.line.color.dflt),text:_$attributes_820.text,whiskerwidth:__extendFlat_702({},_$attributes_691.whiskerwidth,{dflt:0})},_$handleDirectionDefaults_822=function handleDirectionDefaults(traceIn,traceOut,coerce,direction){coerce(direction+".showlegend"),!1===traceIn.showlegend&&(traceOut[direction].showlegend=!1),coerce(direction+".name",traceOut.name+" - "+direction)},_$helpers_823={};_$helpers_823.pushDummyTransformOpts=function(traceIn,traceOut){var transformOpts={type:traceOut.type,_ephemeral:!0};Array.isArray(traceIn.transforms)?traceIn.transforms.push(transformOpts):traceIn.transforms=[transformOpts]},_$helpers_823.clearEphemeralTransformOpts=function(traceIn){var transformsIn=traceIn.transforms;if(Array.isArray(transformsIn)){for(var i=0;i<transformsIn.length;i++)transformsIn[i]._ephemeral&&transformsIn.splice(i,1);0===transformsIn.length&&delete traceIn.transforms}},_$helpers_823.copyOHLC=function(container,traceOut){container.open&&(traceOut.open=container.open),container.high&&(traceOut.high=container.high),container.low&&(traceOut.low=container.low),container.close&&(traceOut.close=container.close)},_$helpers_823.makeTransform=function(traceIn,state,direction){var out=_$lib_539.extendFlat([],traceIn.transforms);return out[state.transformIndex]={type:traceIn.type,direction:direction,open:traceIn.open,high:traceIn.high,low:traceIn.low,close:traceIn.close},out},_$helpers_823.getFilterFn=function(direction){return new function _getFilterFn(direction){var isPrevIncreasing=!0,cPrev=null;function _isIncreasing(o,c){return o===c?c>cPrev?isPrevIncreasing=!0:c<cPrev&&(isPrevIncreasing=!1):isPrevIncreasing=o<c,cPrev=c,isPrevIncreasing}return"increasing"===direction?function isIncreasing(o,c){return _$fastIsnumeric_139(o)&&_$fastIsnumeric_139(c)&&_isIncreasing(+o,+c)}:function isDecreasing(o,c){return _$fastIsnumeric_139(o)&&_$fastIsnumeric_139(c)&&!_isIncreasing(+o,+c)}}(direction)},_$helpers_823.addRangeSlider=function(data,layout){for(var hasOneVisibleTrace=!1,i=0;i<data.length;i++)if(!0===data[i].visible){hasOneVisibleTrace=!0;break}hasOneVisibleTrace&&(layout.xaxis||(layout.xaxis={}),layout.xaxis.rangeslider||(layout.xaxis.rangeslider={}))};var _$handleOHLC_825=function handleOHLC(traceIn,traceOut,coerce,layout){var len,x=coerce("x"),open=coerce("open"),high=coerce("high"),low=coerce("low"),close=coerce("close");return _$registry_668.getComponentMethod("calendars","handleTraceDefaults")(traceIn,traceOut,["x"],layout),len=Math.min(open.length,high.length,low.length,close.length),x&&(len=Math.min(len,x.length))<x.length&&(traceOut.x=x.slice(0,len)),len<open.length&&(traceOut.open=open.slice(0,len)),len<high.length&&(traceOut.high=high.slice(0,len)),len<low.length&&(traceOut.low=low.slice(0,len)),len<close.length&&(traceOut.close=close.slice(0,len)),len};function handleDirection(traceIn,traceOut,coerce,direction){_$handleDirectionDefaults_822(traceIn,traceOut,coerce,direction),coerce(direction+".line.color"),coerce(direction+".line.width",traceOut.line.width),coerce(direction+".fillcolor")}var _$transform_705={};function makeTrace(traceIn,state,direction){var traceOut={type:"box",boxpoints:!1,visible:traceIn.visible,hoverinfo:traceIn.hoverinfo,opacity:traceIn.opacity,xaxis:traceIn.xaxis,yaxis:traceIn.yaxis,transforms:_$helpers_823.makeTransform(traceIn,state,direction)},directionOpts=traceIn[direction];return directionOpts&&_$lib_539.extendFlat(traceOut,{x:traceIn.x||[0],xcalendar:traceIn.xcalendar,y:[].concat(traceIn.low).concat(traceIn.high),whiskerwidth:traceIn.whiskerwidth,text:traceIn.text,name:directionOpts.name,showlegend:directionOpts.showlegend,line:directionOpts.line,fillcolor:directionOpts.fillcolor}),traceOut}_$transform_705.moduleType="transform",_$transform_705.name="candlestick",_$transform_705.attributes={},_$transform_705.supplyDefaults=function(transformIn,traceOut,layout,traceIn){return _$helpers_823.clearEphemeralTransformOpts(traceIn),_$helpers_823.copyOHLC(transformIn,traceOut),transformIn},_$transform_705.transform=function transform(dataIn,state){for(var dataOut=[],i=0;i<dataIn.length;i++){var traceIn=dataIn[i];"candlestick"===traceIn.type?dataOut.push(makeTrace(traceIn,state,"increasing"),makeTrace(traceIn,state,"decreasing")):dataOut.push(traceIn)}return _$helpers_823.addRangeSlider(dataOut,state.layout),dataOut},_$transform_705.calcTransform=function calcTransform(gd,trace,opts){for(var o,h,l,c,direction=opts.direction,filterFn=_$helpers_823.getFilterFn(direction),open=trace.open,high=trace.high,low=trace.low,close=trace.close,len=open.length,x=[],y=[],appendX=trace._fullInput.x?function(i){var v=trace.x[i];x.push(v,v,v,v,v,v)}:function(i){x.push(i,i,i,i,i,i)},i=0;i<len;i++)filterFn(open[i],close[i])&&_$fastIsnumeric_139(high[i])&&_$fastIsnumeric_139(low[i])&&(appendX(i),o=open[i],h=high[i],l=low[i],c=close[i],y.push(l,o,c,c,c,h));trace.x=x,trace.y=y};var _$candlestick_704={moduleType:"trace",name:"candlestick",basePlotModule:_$cartesian_595,categories:["cartesian","showLegend","candlestick"],meta:{},attributes:_$attributes_702,supplyDefaults:function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_702,attr,dflt)}_$helpers_823.pushDummyTransformOpts(traceIn,traceOut),0!==_$handleOHLC_825(traceIn,traceOut,coerce,layout)?(coerce("line.width"),handleDirection(traceIn,traceOut,coerce,"increasing"),handleDirection(traceIn,traceOut,coerce,"decreasing"),coerce("text"),coerce("whiskerwidth")):traceOut.visible=!1}};_$registry_668.register(_$Box_695),_$registry_668.register(_$transform_705);var _$candlestick_7=_$candlestick_704,__overrideAll_710=_$edit_types_569.overrideAll,_$axis_attributes_710={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{valType:"string",editType:"calc"},titlefont:_$font_attributes_611({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:_$font_attributes_611({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc"},tickformatstops:__overrideAll_710(_$layout_attributes_596.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:_$attributes_410.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgridcolor:{valType:"color",dflt:_$attributes_410.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},editType:"calc"},carpetFont=_$font_attributes_611({editType:"calc"});carpetFont.family.dflt='"Open Sans", verdana, arial, sans-serif',carpetFont.size.dflt=12,carpetFont.color.dflt=_$attributes_410.defaultLine;var _$attributes_708={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:_$axis_attributes_710,baxis:_$axis_attributes_710,font:carpetFont,color:{valType:"color",dflt:_$attributes_410.defaultLine,editType:"plot"}},__isArrayOrTypedArray_707=_$lib_539.isArrayOrTypedArray,_$array_minmax_707=function(a){return function minMax(a,depth){if(!__isArrayOrTypedArray_707(a)||depth>=10)return null;var min=1/0;var max=-1/0;var n=a.length;for(var i=0;i<n;i++){var datum=a[i];if(__isArrayOrTypedArray_707(datum)){var result=minMax(datum,depth+1);result&&(min=Math.min(result[0],min),max=Math.max(result[1],max))}else min=Math.min(datum,min),max=Math.max(datum,max)}return[min,max]}(a,0)};var __extendFlat_714=_$extend_528.extendFlat,_$calcGridlines_714=function calcGridlines(trace,cd,axisLetter,crossAxisLetter){var i,j,j0,eps,bounds,n1,n2,n,value,v,j1,v0,v1,d,data=trace[axisLetter],axis=trace[axisLetter+"axis"],gridlines=axis._gridlines=[],minorgridlines=axis._minorgridlines=[],boundarylines=axis._boundarylines=[],crossData=trace[crossAxisLetter],crossAxis=trace[crossAxisLetter+"axis"];"array"===axis.tickmode&&(axis.tickvals=data.slice());var xcp=trace.xctrl,ycp=trace.yctrl,nea=xcp[0].length,neb=xcp.length,na=trace.a.length,nb=trace.b.length;_$axes_584.prepTicks(axis),"array"===axis.tickmode&&delete axis.tickvals;var stride=axis.smoothing?3:1;function constructValueGridline(value){var i,j,j0,tj,pxy,i0,ti,xy,dxydi0,dxydi1,dxydj0,dxydj1,xpoints=[],ypoints=[],ret={};if("b"===axisLetter)for(j=trace.b2j(value),j0=Math.floor(Math.max(0,Math.min(nb-2,j))),tj=j-j0,ret.length=nb,ret.crossLength=na,ret.xy=function(i){return trace.evalxy([],i,j)},ret.dxy=function(i0,ti){return trace.dxydi([],i0,j0,ti,tj)},i=0;i<na;i++)i0=Math.min(na-2,i),ti=i-i0,xy=trace.evalxy([],i,j),crossAxis.smoothing&&i>0&&(dxydi0=trace.dxydi([],i-1,j0,0,tj),xpoints.push(pxy[0]+dxydi0[0]/3),ypoints.push(pxy[1]+dxydi0[1]/3),dxydi1=trace.dxydi([],i-1,j0,1,tj),xpoints.push(xy[0]-dxydi1[0]/3),ypoints.push(xy[1]-dxydi1[1]/3)),xpoints.push(xy[0]),ypoints.push(xy[1]),pxy=xy;else for(i=trace.a2i(value),i0=Math.floor(Math.max(0,Math.min(na-2,i))),ti=i-i0,ret.length=na,ret.crossLength=nb,ret.xy=function(j){return trace.evalxy([],i,j)},ret.dxy=function(j0,tj){return trace.dxydj([],i0,j0,ti,tj)},j=0;j<nb;j++)j0=Math.min(nb-2,j),tj=j-j0,xy=trace.evalxy([],i,j),crossAxis.smoothing&&j>0&&(dxydj0=trace.dxydj([],i0,j-1,ti,0),xpoints.push(pxy[0]+dxydj0[0]/3),ypoints.push(pxy[1]+dxydj0[1]/3),dxydj1=trace.dxydj([],i0,j-1,ti,1),xpoints.push(xy[0]-dxydj1[0]/3),ypoints.push(xy[1]-dxydj1[1]/3)),xpoints.push(xy[0]),ypoints.push(xy[1]),pxy=xy;return ret.axisLetter=axisLetter,ret.axis=axis,ret.crossAxis=crossAxis,ret.value=value,ret.constvar=crossAxisLetter,ret.index=n,ret.x=xpoints,ret.y=ypoints,ret.smoothing=crossAxis.smoothing,ret}function constructArrayGridline(idx){var j,i0,j0,ti,tj,xpoints=[],ypoints=[],ret={};if(ret.length=data.length,ret.crossLength=crossData.length,"b"===axisLetter)for(j0=Math.max(0,Math.min(nb-2,idx)),tj=Math.min(1,Math.max(0,idx-j0)),ret.xy=function(i){return trace.evalxy([],i,idx)},ret.dxy=function(i0,ti){return trace.dxydi([],i0,j0,ti,tj)},j=0;j<nea;j++)xpoints[j]=xcp[idx*stride][j],ypoints[j]=ycp[idx*stride][j];else for(i0=Math.max(0,Math.min(na-2,idx)),ti=Math.min(1,Math.max(0,idx-i0)),ret.xy=function(j){return trace.evalxy([],idx,j)},ret.dxy=function(j0,tj){return trace.dxydj([],i0,j0,ti,tj)},j=0;j<neb;j++)xpoints[j]=xcp[j][idx*stride],ypoints[j]=ycp[j][idx*stride];return ret.axisLetter=axisLetter,ret.axis=axis,ret.crossAxis=crossAxis,ret.value=data[idx],ret.constvar=crossAxisLetter,ret.index=idx,ret.x=xpoints,ret.y=ypoints,ret.smoothing=crossAxis.smoothing,ret}if("array"===axis.tickmode){for(eps=5e-15,n1=(bounds=[Math.floor((data.length-1-axis.arraytick0)/axis.arraydtick*(1+eps)),Math.ceil(-axis.arraytick0/axis.arraydtick/(1+eps))].sort(function(a,b){return a-b}))[0]-1,n2=bounds[1]+1,n=n1;n<n2;n++)(j=axis.arraytick0+axis.arraydtick*n)<0||j>data.length-1||gridlines.push(__extendFlat_714(constructArrayGridline(j),{color:axis.gridcolor,width:axis.gridwidth}));for(n=n1;n<n2;n++)if(j0=axis.arraytick0+axis.arraydtick*n,j1=Math.min(j0+axis.arraydtick,data.length-1),!(j0<0||j0>data.length-1||j1<0||j1>data.length-1))for(v0=data[j0],v1=data[j1],i=0;i<axis.minorgridcount;i++)(d=j1-j0)<=0||(v=v0+(v1-v0)*(i+1)/(axis.minorgridcount+1)*(axis.arraydtick/d))<data[0]||v>data[data.length-1]||minorgridlines.push(__extendFlat_714(constructValueGridline(v),{color:axis.minorgridcolor,width:axis.minorgridwidth}));axis.startline&&boundarylines.push(__extendFlat_714(constructArrayGridline(0),{color:axis.startlinecolor,width:axis.startlinewidth})),axis.endline&&boundarylines.push(__extendFlat_714(constructArrayGridline(data.length-1),{color:axis.endlinecolor,width:axis.endlinewidth}))}else{for(eps=5e-15,n1=(bounds=[Math.floor((data[data.length-1]-axis.tick0)/axis.dtick*(1+eps)),Math.ceil((data[0]-axis.tick0)/axis.dtick/(1+eps))].sort(function(a,b){return a-b}))[0],n2=bounds[1],n=n1;n<=n2;n++)value=axis.tick0+axis.dtick*n,gridlines.push(__extendFlat_714(constructValueGridline(value),{color:axis.gridcolor,width:axis.gridwidth}));for(n=n1-1;n<n2+1;n++)for(value=axis.tick0+axis.dtick*n,i=0;i<axis.minorgridcount;i++)(v=value+axis.dtick*(i+1)/(axis.minorgridcount+1))<data[0]||v>data[data.length-1]||minorgridlines.push(__extendFlat_714(constructValueGridline(v),{color:axis.minorgridcolor,width:axis.minorgridwidth}));axis.startline&&boundarylines.push(__extendFlat_714(constructValueGridline(data[0]),{color:axis.startlinecolor,width:axis.startlinewidth})),axis.endline&&boundarylines.push(__extendFlat_714(constructValueGridline(data[data.length-1]),{color:axis.endlinecolor,width:axis.endlinewidth}))}},__extendFlat_715=_$extend_528.extendFlat,_$calcLabels_715=function calcLabels(trace,axis){var i,tobj,gridline,labels=axis._labels=[],gridlines=axis._gridlines;for(i=0;i<gridlines.length;i++)gridline=gridlines[i],-1!==["start","both"].indexOf(axis.showticklabels)&&(tobj=_$axes_584.tickText(axis,gridline.value),__extendFlat_715(tobj,{prefix:void 0,suffix:void 0,endAnchor:!0,xy:gridline.xy(0),dxy:gridline.dxy(0,0),axis:gridline.axis,length:gridline.crossAxis.length,font:gridline.axis.tickfont,isFirst:0===i,isLast:i===gridlines.length-1}),labels.push(tobj)),-1!==["end","both"].indexOf(axis.showticklabels)&&(tobj=_$axes_584.tickText(axis,gridline.value),__extendFlat_715(tobj,{endAnchor:!1,xy:gridline.xy(gridline.crossLength-1),dxy:gridline.dxy(gridline.crossLength-2,1),axis:gridline.axis,length:gridline.crossAxis.length,font:gridline.axis.tickfont,isFirst:0===i,isLast:i===gridlines.length-1}),labels.push(tobj))},__isArrayOrTypedArray_717=_$lib_539.isArrayOrTypedArray,__isArrayOrTypedArray_729=_$lib_539.isArrayOrTypedArray,_$mapArray_729=function mapArray(out,data,func){var i,j;for(Array.isArray(out)?out.length>data.length&&(out=out.slice(0,data.length)):out=[],i=0;i<data.length;i++)for(__isArrayOrTypedArray_729(out[i])?out[i].length>data.length&&(out[i]=out[i].slice(0,data.length)):out[i]=[],j=0;j<data[0].length;j++)out[i][j]=func(data[i][j]);return out},_$smoothFill2dArray_733=function smoothFill2dArray(data,a,b){var i,j,k,ip=[],jp=[],ni=data[0].length,nj=data.length;function avgSurrounding(i,j){var val,sum=0,cnt=0;return i>0&&void 0!==(val=data[j][i-1])&&(cnt++,sum+=val),i<ni-1&&void 0!==(val=data[j][i+1])&&(cnt++,sum+=val),j>0&&void 0!==(val=data[j-1][i])&&(cnt++,sum+=val),j<nj-1&&void 0!==(val=data[j+1][i])&&(cnt++,sum+=val),sum/Math.max(1,cnt)}var dxp,dxm,dap,dam,dbp,dbm,c,d,diff,reldiff,overrelaxation,dmax=0;for(i=0;i<ni;i++)for(j=0;j<nj;j++)void 0===data[j][i]&&(ip.push(i),jp.push(j),data[j][i]=avgSurrounding(i,j)),dmax=Math.max(dmax,Math.abs(data[j][i]));if(!ip.length)return data;var resid=0,iter=0,n=ip.length;do{for(resid=0,k=0;k<n;k++){i=ip[k],j=jp[k];var d0,d1,x0,x1,i0,j0,boundaryCnt=0,newVal=0;0===i?(x0=a[i0=Math.min(ni-1,2)],x1=a[1],d0=data[j][i0],newVal+=(d1=data[j][1])+(d1-d0)*(a[0]-x1)/(x1-x0),boundaryCnt++):i===ni-1&&(x0=a[i0=Math.max(0,ni-3)],x1=a[ni-2],d0=data[j][i0],newVal+=(d1=data[j][ni-2])+(d1-d0)*(a[ni-1]-x1)/(x1-x0),boundaryCnt++),(0===i||i===ni-1)&&j>0&&j<nj-1&&(dxp=b[j+1]-b[j],newVal+=((dxm=b[j]-b[j-1])*data[j+1][i]+dxp*data[j-1][i])/(dxm+dxp),boundaryCnt++),0===j?(x0=b[j0=Math.min(nj-1,2)],x1=b[1],d0=data[j0][i],newVal+=(d1=data[1][i])+(d1-d0)*(b[0]-x1)/(x1-x0),boundaryCnt++):j===nj-1&&(x0=b[j0=Math.max(0,nj-3)],x1=b[nj-2],d0=data[j0][i],newVal+=(d1=data[nj-2][i])+(d1-d0)*(b[nj-1]-x1)/(x1-x0),boundaryCnt++),(0===j||j===nj-1)&&i>0&&i<ni-1&&(dxp=a[i+1]-a[i],newVal+=((dxm=a[i]-a[i-1])*data[j][i+1]+dxp*data[j][i-1])/(dxm+dxp),boundaryCnt++),boundaryCnt?newVal/=boundaryCnt:(dap=a[i+1]-a[i],dam=a[i]-a[i-1],d=(dbp=b[j+1]-b[j])*(dbm=b[j]-b[j-1])*(dbp+dbm),newVal=((c=dap*dam*(dap+dam))*(dbm*data[j+1][i]+dbp*data[j-1][i])+d*(dam*data[j][i+1]+dap*data[j][i-1]))/(d*(dam+dap)+c*(dbm+dbp))),resid+=(reldiff=(diff=newVal-data[j][i])/dmax)*reldiff,overrelaxation=boundaryCnt?0:.85,data[j][i]+=diff*(1+overrelaxation)}resid=Math.sqrt(resid)}while(iter++<100&&resid>1e-5);return _$lib_539.log("Smoother converged to",resid,"after",iter,"iterations"),data},_$clean2dArray_775=function clean2dArray(zOld,transpose){var rowlen,collen,getCollen,old2new,i,j;function cleanZvalue(v){if(_$fastIsnumeric_139(v))return+v}if(transpose){for(rowlen=0,i=0;i<zOld.length;i++)rowlen=Math.max(rowlen,zOld[i].length);if(0===rowlen)return!1;getCollen=function(zOld){return zOld.length},old2new=function(zOld,i,j){return zOld[j][i]}}else rowlen=zOld.length,getCollen=function(zOld,i){return zOld[i].length},old2new=function(zOld,i,j){return zOld[i][j]};var zNew=new Array(rowlen);for(i=0;i<rowlen;i++)for(collen=getCollen(zOld,i),zNew[i]=new Array(collen),j=0;j<collen;j++)zNew[i][j]=cleanZvalue(old2new(zOld,i,j));return zNew},addOpacity=_$color_411.addOpacity,_$handleAxisDefaults_711=function handleAxisDefaults(containerIn,containerOut,options){var letter=options.letter,font=options.font||{},attributes=_$attributes_708[letter+"axis"];function coerce(attr,dflt){return _$lib_539.coerce(containerIn,containerOut,attributes,attr,dflt)}function coerce2(attr,dflt){return _$lib_539.coerce2(containerIn,containerOut,attributes,attr,dflt)}options.name&&(containerOut._name=options.name,containerOut._id=options.name);var axType=coerce("type");("-"===axType&&(options.data&&function __setAutoType_711(ax,data){if("-"!==ax.type)return;var axLetter=ax._id.charAt(0),calendar=ax[axLetter+"calendar"];ax.type=_$autoType_585(data,calendar)}(containerOut,options.data),"-"===containerOut.type?containerOut.type="linear":axType=containerIn.type=containerOut.type),coerce("smoothing"),coerce("cheatertype"),coerce("showticklabels"),coerce("labelprefix",letter+" = "),coerce("labelsuffix"),coerce("showtickprefix"),coerce("showticksuffix"),coerce("separatethousands"),coerce("tickformat"),coerce("exponentformat"),coerce("showexponent"),coerce("categoryorder"),coerce("tickmode"),coerce("tickvals"),coerce("ticktext"),coerce("tick0"),coerce("dtick"),"array"===containerOut.tickmode&&(coerce("arraytick0"),coerce("arraydtick")),coerce("labelpadding"),containerOut._hovertitle=letter,"date"===axType)&&_$registry_668.getComponentMethod("calendars","handleDefaults")(containerIn,containerOut,"calendar",options.calendar);_$setConvert_603(containerOut,options.fullLayout);var dfltColor=coerce("color",options.dfltColor),dfltFontColor=dfltColor===containerIn.color?dfltColor:font.color;coerce("title"),_$lib_539.coerceFont(coerce,"titlefont",{family:font.family,size:Math.round(1.2*font.size),color:dfltFontColor}),coerce("titleoffset"),coerce("tickangle"),coerce("autorange",!containerOut.isValidRange(containerIn.range))&&coerce("rangemode"),coerce("range"),containerOut.cleanRange(),coerce("fixedrange"),_$handleTickValueDefaults_606(containerIn,containerOut,coerce,axType),_$handleTickLabelDefaults_604(containerIn,containerOut,coerce,axType,options),_$handleCategoryOrderDefaults_588(containerIn,containerOut,coerce);var gridColor=coerce2("gridcolor",addOpacity(dfltColor,.3)),gridWidth=coerce2("gridwidth"),showGrid=coerce("showgrid");showGrid||(delete containerOut.gridcolor,delete containerOut.gridwidth);var startLineColor=coerce2("startlinecolor",dfltColor),startLineWidth=coerce2("startlinewidth",gridWidth);coerce("startline",containerOut.showgrid||!!startLineColor||!!startLineWidth)||(delete containerOut.startlinecolor,delete containerOut.startlinewidth);var endLineColor=coerce2("endlinecolor",dfltColor),endLineWidth=coerce2("endlinewidth",gridWidth);return coerce("endline",containerOut.showgrid||!!endLineColor||!!endLineWidth)||(delete containerOut.endlinecolor,delete containerOut.endlinewidth),showGrid?(coerce("minorgridcount"),coerce("minorgridwidth",gridWidth),coerce("minorgridcolor",addOpacity(gridColor,.06)),containerOut.minorgridcount||(delete containerOut.minorgridwidth,delete containerOut.minorgridcolor)):(delete containerOut.gridcolor,delete containerOut.gridWidth),containerOut._initialCategories="category"===axType?_$orderedCategories_599(letter,containerOut.categoryorder,containerOut.categoryarray,options.data):[],"none"===containerOut.showticklabels&&(delete containerOut.tickfont,delete containerOut.tickangle,delete containerOut.showexponent,delete containerOut.exponentformat,delete containerOut.tickformat,delete containerOut.showticksuffix,delete containerOut.showtickprefix),containerOut.showticksuffix||delete containerOut.ticksuffix,containerOut.showtickprefix||delete containerOut.tickprefix,coerce("tickmode"),(!containerOut.title||containerOut.title&&0===containerOut.title.length)&&(delete containerOut.titlefont,delete containerOut.titleoffset),containerOut};var _$handleABDefaults_706=function handleABDefaults(traceIn,traceOut,fullLayout,coerce,dfltColor){coerce("a")||(coerce("da"),coerce("a0")),coerce("b")||(coerce("db"),coerce("b0")),function mimickAxisDefaults(traceIn,traceOut,fullLayout,dfltColor){["aaxis","baxis"].forEach(function(axName){var axLetter=axName.charAt(0),axIn=traceIn[axName]||{},axOut={},defaultOptions={tickfont:"x",id:axLetter+"axis",letter:axLetter,font:traceOut.font,name:axName,data:traceIn[axLetter],calendar:traceOut.calendar,dfltColor:dfltColor,bgColor:fullLayout.paper_bgcolor,fullLayout:fullLayout};_$handleAxisDefaults_711(axIn,axOut,defaultOptions),axOut._categories=axOut._categories||[],traceOut[axName]=axOut,traceIn[axName]||"-"===axIn.type||(traceIn[axName]={type:axIn.type})})}(traceIn,traceOut,fullLayout,dfltColor)};var _$makeControlPoints_716=function makeControlPoints(p0,p1,p2,smoothness){var d1x=p0[0]-p1[0],d1y=p0[1]-p1[1],d2x=p2[0]-p1[0],d2y=p2[1]-p1[1],d1a=Math.pow(d1x*d1x+d1y*d1y,.25),d2a=Math.pow(d2x*d2x+d2y*d2y,.25),numx=(d2a*d2a*d1x-d1a*d1a*d2x)*smoothness,numy=(d2a*d2a*d1y-d1a*d1a*d2y)*smoothness,denom1=d2a*(d1a+d2a)*3,denom2=d1a*(d1a+d2a)*3;return[[p1[0]+(denom1&&numx/denom1),p1[1]+(denom1&&numy/denom1)],[p1[0]-(denom2&&numx/denom2),p1[1]-(denom2&&numy/denom2)]]},ensureArray=_$lib_539.ensureArray;function inferCubicControlPoint(p0,p2,p3){var p2e0=-.5*p3[0]+1.5*p2[0],p2e1=-.5*p3[1]+1.5*p2[1];return[(2*p2e0+p0[0])/3,(2*p2e1+p0[1])/3]}var _$constants___RELATIVE_CULL_TOLERANCE=1e-6,search=_$search_557.findBin,_$setConvert_732=function setConvert(trace){var a=trace.a,b=trace.b,na=trace.a.length,nb=trace.b.length,aax=trace.aaxis,bax=trace.baxis,amin=a[0],amax=a[na-1],bmin=b[0],bmax=b[nb-1],arange=a[a.length-1]-a[0],brange=b[b.length-1]-b[0],atol=arange*_$constants___RELATIVE_CULL_TOLERANCE,btol=brange*_$constants___RELATIVE_CULL_TOLERANCE;amin-=atol,amax+=atol,bmin-=btol,bmax+=btol,trace.isVisible=function(a,b){return a>amin&&a<amax&&b>bmin&&b<bmax},trace.isOccluded=function(a,b){return a<amin||a>amax||b<bmin||b>bmax},aax.c2p=function(v){return v},bax.c2p=function(v){return v},trace.setScale=function(){var arrays,asmoothing,bsmoothing,x=trace._x,y=trace._y,result=function computeControlPoints(xe,ye,x,y,asmoothing,bsmoothing){var i,j,ie,je,xej,yej,xj,yj,cp,p1,na=x[0].length,nb=x.length,nea=asmoothing?3*na-2:na,neb=bsmoothing?3*nb-2:nb;for(xe=ensureArray(xe,neb),ye=ensureArray(ye,neb),ie=0;ie<neb;ie++)xe[ie]=ensureArray(xe[ie],nea),ye[ie]=ensureArray(ye[ie],nea);for(j=0,je=0;j<nb;j++,je+=bsmoothing?3:1)for(xej=xe[je],yej=ye[je],xj=x[j],yj=y[j],i=0,ie=0;i<na;i++,ie+=asmoothing?3:1)xej[ie]=xj[i],yej[ie]=yj[i];if(asmoothing)for(j=0,je=0;j<nb;j++,je+=bsmoothing?3:1){for(i=1,ie=3;i<na-1;i++,ie+=3)cp=_$makeControlPoints_716([x[j][i-1],y[j][i-1]],[x[j][i],y[j][i]],[x[j][i+1],y[j][i+1]],asmoothing),xe[je][ie-1]=cp[0][0],ye[je][ie-1]=cp[0][1],xe[je][ie+1]=cp[1][0],ye[je][ie+1]=cp[1][1];p1=inferCubicControlPoint([xe[je][0],ye[je][0]],[xe[je][2],ye[je][2]],[xe[je][3],ye[je][3]]),xe[je][1]=p1[0],ye[je][1]=p1[1],p1=inferCubicControlPoint([xe[je][nea-1],ye[je][nea-1]],[xe[je][nea-3],ye[je][nea-3]],[xe[je][nea-4],ye[je][nea-4]]),xe[je][nea-2]=p1[0],ye[je][nea-2]=p1[1]}if(bsmoothing)for(ie=0;ie<nea;ie++){for(je=3;je<neb-3;je+=3)cp=_$makeControlPoints_716([xe[je-3][ie],ye[je-3][ie]],[xe[je][ie],ye[je][ie]],[xe[je+3][ie],ye[je+3][ie]],bsmoothing),xe[je-1][ie]=cp[0][0],ye[je-1][ie]=cp[0][1],xe[je+1][ie]=cp[1][0],ye[je+1][ie]=cp[1][1];p1=inferCubicControlPoint([xe[0][ie],ye[0][ie]],[xe[2][ie],ye[2][ie]],[xe[3][ie],ye[3][ie]]),xe[1][ie]=p1[0],ye[1][ie]=p1[1],p1=inferCubicControlPoint([xe[neb-1][ie],ye[neb-1][ie]],[xe[neb-3][ie],ye[neb-3][ie]],[xe[neb-4][ie],ye[neb-4][ie]]),xe[neb-2][ie]=p1[0],ye[neb-2][ie]=p1[1]}if(asmoothing&&bsmoothing)for(je=1;je<neb;je+=(je+1)%3==0?2:1){for(ie=3;ie<nea-3;ie+=3)cp=_$makeControlPoints_716([xe[je][ie-3],ye[je][ie-3]],[xe[je][ie],ye[je][ie]],[xe[je][ie+3],ye[je][ie+3]],asmoothing),xe[je][ie-1]=.5*(xe[je][ie-1]+cp[0][0]),ye[je][ie-1]=.5*(ye[je][ie-1]+cp[0][1]),xe[je][ie+1]=.5*(xe[je][ie+1]+cp[1][0]),ye[je][ie+1]=.5*(ye[je][ie+1]+cp[1][1]);p1=inferCubicControlPoint([xe[je][0],ye[je][0]],[xe[je][2],ye[je][2]],[xe[je][3],ye[je][3]]),xe[je][1]=.5*(xe[je][1]+p1[0]),ye[je][1]=.5*(ye[je][1]+p1[1]),p1=inferCubicControlPoint([xe[je][nea-1],ye[je][nea-1]],[xe[je][nea-3],ye[je][nea-3]],[xe[je][nea-4],ye[je][nea-4]]),xe[je][nea-2]=.5*(xe[je][nea-2]+p1[0]),ye[je][nea-2]=.5*(ye[je][nea-2]+p1[1])}return[xe,ye]}(trace.xctrl,trace.yctrl,x,y,aax.smoothing,bax.smoothing);trace.xctrl=result[0],trace.yctrl=result[1],trace.evalxy=function(arrays,na,nb,asmoothing,bsmoothing){var imax=na-2,jmax=nb-2;return asmoothing&&bsmoothing?function(out,i,j){var f0,f1,f2,f3,ak,k;out||(out=[]);var i0=Math.max(0,Math.min(Math.floor(i),imax)),j0=Math.max(0,Math.min(Math.floor(j),jmax)),u=Math.max(0,Math.min(1,i-i0)),v=Math.max(0,Math.min(1,j-j0));i0*=3,j0*=3;var u2=u*u,u3=u2*u,ou=1-u,ou2=ou*ou,ou3=ou2*ou,v2=v*v,v3=v2*v,ov=1-v,ov2=ov*ov,ov3=ov2*ov;for(k=0;k<arrays.length;k++)f0=ou3*(ak=arrays[k])[j0][i0]+3*(ou2*u*ak[j0][i0+1]+ou*u2*ak[j0][i0+2])+u3*ak[j0][i0+3],f1=ou3*ak[j0+1][i0]+3*(ou2*u*ak[j0+1][i0+1]+ou*u2*ak[j0+1][i0+2])+u3*ak[j0+1][i0+3],f2=ou3*ak[j0+2][i0]+3*(ou2*u*ak[j0+2][i0+1]+ou*u2*ak[j0+2][i0+2])+u3*ak[j0+2][i0+3],f3=ou3*ak[j0+3][i0]+3*(ou2*u*ak[j0+3][i0+1]+ou*u2*ak[j0+3][i0+2])+u3*ak[j0+3][i0+3],out[k]=ov3*f0+3*(ov2*v*f1+ov*v2*f2)+v3*f3;return out}:asmoothing?function(out,i,j){out||(out=[]);var f0,f1,f2,f3,k,ak,i0=Math.max(0,Math.min(Math.floor(i),imax)),j0=Math.max(0,Math.min(Math.floor(j),jmax)),u=Math.max(0,Math.min(1,i-i0)),v=Math.max(0,Math.min(1,j-j0));i0*=3;var u2=u*u,u3=u2*u,ou=1-u,ou2=ou*ou,ou3=ou2*ou,ov=1-v;for(k=0;k<arrays.length;k++)f0=ov*(ak=arrays[k])[j0][i0]+v*ak[j0+1][i0],f1=ov*ak[j0][i0+1]+v*ak[j0+1][i0+1],f2=ov*ak[j0][i0+2]+v*ak[j0+1][i0+1],f3=ov*ak[j0][i0+3]+v*ak[j0+1][i0+1],out[k]=ou3*f0+3*(ou2*u*f1+ou*u2*f2)+u3*f3;return out}:bsmoothing?function(out,i,j){out||(out=[]);var f0,f1,f2,f3,k,ak,i0=Math.max(0,Math.min(Math.floor(i),imax)),j0=Math.max(0,Math.min(Math.floor(j),jmax)),u=Math.max(0,Math.min(1,i-i0)),v=Math.max(0,Math.min(1,j-j0));j0*=3;var v2=v*v,v3=v2*v,ov=1-v,ov2=ov*ov,ov3=ov2*ov,ou=1-u;for(k=0;k<arrays.length;k++)f0=ou*(ak=arrays[k])[j0][i0]+u*ak[j0][i0+1],f1=ou*ak[j0+1][i0]+u*ak[j0+1][i0+1],f2=ou*ak[j0+2][i0]+u*ak[j0+2][i0+1],f3=ou*ak[j0+3][i0]+u*ak[j0+3][i0+1],out[k]=ov3*f0+3*(ov2*v*f1+ov*v2*f2)+v3*f3;return out}:function(out,i,j){out||(out=[]);var f0,f1,k,ak,i0=Math.max(0,Math.min(Math.floor(i),imax)),j0=Math.max(0,Math.min(Math.floor(j),jmax)),u=Math.max(0,Math.min(1,i-i0)),v=Math.max(0,Math.min(1,j-j0)),ov=1-v,ou=1-u;for(k=0;k<arrays.length;k++)f0=ou*(ak=arrays[k])[j0][i0]+u*ak[j0][i0+1],f1=ou*ak[j0+1][i0]+u*ak[j0+1][i0+1],out[k]=ov*f0+v*f1;return out}}([trace.xctrl,trace.yctrl],na,nb,aax.smoothing,bax.smoothing),trace.dxydi=(arrays=[trace.xctrl,trace.yctrl],asmoothing=aax.smoothing,bsmoothing=bax.smoothing,asmoothing&&bsmoothing?function(out,i0,j0,u,v){var f0,f1,f2,f3,ak,k;out||(out=[]),i0*=3,j0*=3;var u2=u*u,ou=1-u,ou2=ou*ou,ouu2=ou*u*2,a=-3*ou2,b=3*(ou2-ouu2),c=3*(ouu2-u2),d=3*u2,v2=v*v,v3=v2*v,ov=1-v,ov2=ov*ov,ov3=ov2*ov;for(k=0;k<arrays.length;k++)f0=a*(ak=arrays[k])[j0][i0]+b*ak[j0][i0+1]+c*ak[j0][i0+2]+d*ak[j0][i0+3],f1=a*ak[j0+1][i0]+b*ak[j0+1][i0+1]+c*ak[j0+1][i0+2]+d*ak[j0+1][i0+3],f2=a*ak[j0+2][i0]+b*ak[j0+2][i0+1]+c*ak[j0+2][i0+2]+d*ak[j0+2][i0+3],f3=a*ak[j0+3][i0]+b*ak[j0+3][i0+1]+c*ak[j0+3][i0+2]+d*ak[j0+3][i0+3],out[k]=ov3*f0+3*(ov2*v*f1+ov*v2*f2)+v3*f3;return out}:asmoothing?function(out,i0,j0,u,v){var f0,f1,k,ak;out||(out=[]),i0*=3;var u2=u*u,ou=1-u,ou2=ou*ou,ouu2=ou*u*2,a=-3*ou2,b=3*(ou2-ouu2),c=3*(ouu2-u2),d=3*u2,ov=1-v;for(k=0;k<arrays.length;k++)f0=a*(ak=arrays[k])[j0][i0]+b*ak[j0][i0+1]+c*ak[j0][i0+2]+d*ak[j0][i0+3],f1=a*ak[j0+1][i0]+b*ak[j0+1][i0+1]+c*ak[j0+1][i0+2]+d*ak[j0+1][i0+3],out[k]=ov*f0+v*f1;return out}:bsmoothing?function(out,i0,j0,u,v){var f0,f1,f2,f3,k,ak;out||(out=[]),j0*=3;var v2=v*v,v3=v2*v,ov=1-v,ov2=ov*ov,ov3=ov2*ov;for(k=0;k<arrays.length;k++)f0=(ak=arrays[k])[j0][i0+1]-ak[j0][i0],f1=ak[j0+1][i0+1]-ak[j0+1][i0],f2=ak[j0+2][i0+1]-ak[j0+2][i0],f3=ak[j0+3][i0+1]-ak[j0+3][i0],out[k]=ov3*f0+3*(ov2*v*f1+ov*v2*f2)+v3*f3;return out}:function(out,i0,j0,u,v){var f0,f1,k,ak;out||(out=[]);var ov=1-v;for(k=0;k<arrays.length;k++)f0=(ak=arrays[k])[j0][i0+1]-ak[j0][i0],f1=ak[j0+1][i0+1]-ak[j0+1][i0],out[k]=ov*f0+v*f1;return out}),trace.dxydj=function(arrays,asmoothing,bsmoothing){return asmoothing&&bsmoothing?function(out,i0,j0,u,v){var f0,f1,f2,f3,ak,k;out||(out=[]),i0*=3,j0*=3;var u2=u*u,u3=u2*u,ou=1-u,ou2=ou*ou,ou3=ou2*ou,v2=v*v,ov=1-v,ov2=ov*ov,ovv2=ov*v*2,a=-3*ov2,b=3*(ov2-ovv2),c=3*(ovv2-v2),d=3*v2;for(k=0;k<arrays.length;k++)f0=a*(ak=arrays[k])[j0][i0]+b*ak[j0+1][i0]+c*ak[j0+2][i0]+d*ak[j0+3][i0],f1=a*ak[j0][i0+1]+b*ak[j0+1][i0+1]+c*ak[j0+2][i0+1]+d*ak[j0+3][i0+1],f2=a*ak[j0][i0+2]+b*ak[j0+1][i0+2]+c*ak[j0+2][i0+2]+d*ak[j0+3][i0+2],f3=a*ak[j0][i0+3]+b*ak[j0+1][i0+3]+c*ak[j0+2][i0+3]+d*ak[j0+3][i0+3],out[k]=ou3*f0+3*(ou2*u*f1+ou*u2*f2)+u3*f3;return out}:asmoothing?function(out,i0,j0,v,u){var f0,f1,f2,f3,k,ak;out||(out=[]),i0*=3;var u2=u*u,u3=u2*u,ou=1-u,ou2=ou*ou,ou3=ou2*ou;for(k=0;k<arrays.length;k++)f0=(ak=arrays[k])[j0+1][i0]-ak[j0][i0],f1=ak[j0+1][i0+1]-ak[j0][i0+1],f2=ak[j0+1][i0+2]-ak[j0][i0+2],f3=ak[j0+1][i0+3]-ak[j0][i0+3],out[k]=ou3*f0+3*(ou2*u*f1+ou*u2*f2)+u3*f3;return out}:bsmoothing?function(out,i0,j0,u,v){var f0,f1,k,ak;out||(out=[]),j0*=3;var ou=1-u,v2=v*v,ov=1-v,ov2=ov*ov,ovv2=ov*v*2,a=-3*ov2,b=3*(ov2-ovv2),c=3*(ovv2-v2),d=3*v2;for(k=0;k<arrays.length;k++)f0=a*(ak=arrays[k])[j0][i0]+b*ak[j0+1][i0]+c*ak[j0+2][i0]+d*ak[j0+3][i0],f1=a*ak[j0][i0+1]+b*ak[j0+1][i0+1]+c*ak[j0+2][i0+1]+d*ak[j0+3][i0+1],out[k]=ou*f0+u*f1;return out}:function(out,i0,j0,v,u){var f0,f1,k,ak;out||(out=[]);var ov=1-v;for(k=0;k<arrays.length;k++)f0=(ak=arrays[k])[j0+1][i0]-ak[j0][i0],f1=ak[j0+1][i0+1]-ak[j0][i0+1],out[k]=ov*f0+v*f1;return out}}([trace.xctrl,trace.yctrl],aax.smoothing,bax.smoothing)},trace.i2a=function(i){var i0=Math.max(0,Math.floor(i[0]),na-2),ti=i[0]-i0;return(1-ti)*a[i0]+ti*a[i0+1]},trace.j2b=function(j){var j0=Math.max(0,Math.floor(j[1]),na-2),tj=j[1]-j0;return(1-tj)*b[j0]+tj*b[j0+1]},trace.ij2ab=function(ij){return[trace.i2a(ij[0]),trace.j2b(ij[1])]},trace.a2i=function(aval){var i0=Math.max(0,Math.min(search(aval,a),na-2)),a0=a[i0],a1=a[i0+1];return Math.max(0,Math.min(na-1,i0+(aval-a0)/(a1-a0)))},trace.b2j=function(bval){var j0=Math.max(0,Math.min(search(bval,b),nb-2)),b0=b[j0],b1=b[j0+1];return Math.max(0,Math.min(nb-1,j0+(bval-b0)/(b1-b0)))},trace.ab2ij=function(ab){return[trace.a2i(ab[0]),trace.b2j(ab[1])]},trace.i2c=function(i,j){return trace.evalxy([],i,j)},trace.ab2xy=function(aval,bval,extrapolate){if(!extrapolate&&(aval<a[0]||aval>a[na-1]|bval<b[0]||bval>b[nb-1]))return[!1,!1];var i=trace.a2i(aval),j=trace.b2j(bval),pt=trace.evalxy([],i,j);if(extrapolate){var i0,ti,j0,tj,iex=0,jex=0,der=[];aval<a[0]?(i0=0,ti=0,iex=(aval-a[0])/(a[1]-a[0])):aval>a[na-1]?(i0=na-2,ti=1,iex=(aval-a[na-1])/(a[na-1]-a[na-2])):ti=i-(i0=Math.max(0,Math.min(na-2,Math.floor(i)))),bval<b[0]?(j0=0,tj=0,jex=(bval-b[0])/(b[1]-b[0])):bval>b[nb-1]?(j0=nb-2,tj=1,jex=(bval-b[nb-1])/(b[nb-1]-b[nb-2])):tj=j-(j0=Math.max(0,Math.min(nb-2,Math.floor(j)))),iex&&(trace.dxydi(der,i0,j0,ti,tj),pt[0]+=der[0]*iex,pt[1]+=der[1]*iex),jex&&(trace.dxydj(der,i0,j0,ti,tj),pt[0]+=der[0]*jex,pt[1]+=der[1]*jex)}return pt},trace.c2p=function(xy,xa,ya){return[xa.c2p(xy[0]),ya.c2p(xy[1])]},trace.p2x=function(p,xa,ya){return[xa.p2c(p[0]),ya.p2c(p[1])]},trace.dadi=function(i){var i0=Math.max(0,Math.min(a.length-2,i));return a[i0+1]-a[i0]},trace.dbdj=function(j){var j0=Math.max(0,Math.min(b.length-2,j));return b[j0+1]-b[j0]},trace.dxyda=function(i0,j0,u,v){var dxydi=trace.dxydi(null,i0,j0,u,v),dadi=trace.dadi(i0,u);return[dxydi[0]/dadi,dxydi[1]/dadi]},trace.dxydb=function(i0,j0,u,v){var dxydj=trace.dxydj(null,i0,j0,u,v),dbdj=trace.dbdj(j0,v);return[dxydj[0]/dbdj,dxydj[1]/dbdj]},trace.dxyda_rough=function(a,b,reldiff){var h=arange*(reldiff||.1),plus=trace.ab2xy(a+h,b,!0),minus=trace.ab2xy(a-h,b,!0);return[.5*(plus[0]-minus[0])/h,.5*(plus[1]-minus[1])/h]},trace.dxydb_rough=function(a,b,reldiff){var h=brange*(reldiff||.1),plus=trace.ab2xy(a,b+h,!0),minus=trace.ab2xy(a,b-h,!0);return[.5*(plus[0]-minus[0])/h,.5*(plus[1]-minus[1])/h]},trace.dpdx=function(xa){return xa._m},trace.dpdy=function(ya){return ya._m}},__isArrayOrTypedArray_724=_$lib_539.isArrayOrTypedArray,_$has_columns_724=function(data){return __isArrayOrTypedArray_724(data[0])},__BADNUM_777=_$numerical_517.BADNUM,_$convertColumnData_777=function convertColumnData(trace,ax1,ax2,var1Name,var2Name,arrayVarNames){var1Name=var1Name||"x",var2Name=var2Name||"y",arrayVarNames=arrayVarNames||["z"];var i,j,arrayVar,col1=trace[var1Name].slice(),col2=trace[var2Name].slice(),textCol=trace.text,colLen=Math.min(col1.length,col2.length),hasColumnText=void 0!==textCol&&!Array.isArray(textCol[0]),col1Calendar=trace[var1Name+"calendar"],col2Calendar=trace[var2Name+"calendar"];for(i=0;i<arrayVarNames.length;i++)(arrayVar=trace[arrayVarNames[i]])&&(colLen=Math.min(colLen,arrayVar.length));for(colLen<col1.length&&(col1=col1.slice(0,colLen)),colLen<col2.length&&(col2=col2.slice(0,colLen)),i=0;i<colLen;i++)col1[i]=ax1.d2c(col1[i],0,col1Calendar),col2[i]=ax2.d2c(col2[i],0,col2Calendar);var i1,i2,text,col1dv=_$lib_539.distinctVals(col1),col1vals=col1dv.vals,col2dv=_$lib_539.distinctVals(col2),col2vals=col2dv.vals,newArrays=[];for(i=0;i<arrayVarNames.length;i++)newArrays[i]=_$lib_539.init2dArray(col2vals.length,col1vals.length);for(hasColumnText&&(text=_$lib_539.init2dArray(col2vals.length,col1vals.length)),i=0;i<colLen;i++)if(col1[i]!==__BADNUM_777&&col2[i]!==__BADNUM_777){for(i1=_$lib_539.findBin(col1[i]+col1dv.minDiff/2,col1vals),i2=_$lib_539.findBin(col2[i]+col2dv.minDiff/2,col2vals),j=0;j<arrayVarNames.length;j++)arrayVar=trace[arrayVarNames[j]],newArrays[j][i2][i1]=arrayVar[i];hasColumnText&&(text[i2][i1]=textCol[i])}for(trace["_input_"+var1Name]=trace[var1Name],trace["_input_"+var2Name]=trace[var2Name],trace[var1Name]=col1vals,trace[var2Name]=col2vals,j=0;j<arrayVarNames.length;j++)trace["_input_"+arrayVarNames[j]]=trace[arrayVarNames[j]],trace[arrayVarNames[j]]=newArrays[j];hasColumnText&&(trace.text=text)},_$makePath_727=function makePath(xp,yp,isBicubic){if(0===xp.length)return"";var i,path=[],stride=isBicubic?3:1;for(i=0;i<xp.length;i+=stride)path.push(xp[i]+","+yp[i]),isBicubic&&i<xp.length-stride&&(path.push("C"),path.push([xp[i+1]+","+yp[i+1],xp[i+2]+","+yp[i+2]+" "].join(" ")));return path.join(isBicubic?"":"L")},__isArrayOrTypedArray_728=_$lib_539.isArrayOrTypedArray,_$mapArray_728=function mapArray(out,data,func){var i;for(__isArrayOrTypedArray_728(out)?out.length>data.length&&(out=out.slice(0,data.length)):out=[],i=0;i<data.length;i++)out[i]=func(data[i]);return out},_$orientText_730=function orientText(trace,xaxis,yaxis,xy,dxy,refDxy){var dx=dxy[0]*trace.dpdx(xaxis),dy=dxy[1]*trace.dpdy(yaxis),flip=1,offsetMultiplier=1;if(refDxy){var l1=Math.sqrt(dxy[0]*dxy[0]+dxy[1]*dxy[1]),l2=Math.sqrt(refDxy[0]*refDxy[0]+refDxy[1]*refDxy[1]),dot=(dxy[0]*refDxy[0]+dxy[1]*refDxy[1])/l1/l2;offsetMultiplier=Math.max(0,dot)}var angle=180*Math.atan2(dy,dx)/Math.PI;return angle<-90?(angle+=180,flip=-flip):angle>90&&(angle-=180,flip=-flip),{angle:angle,flip:flip,p:trace.c2p(xy,xaxis,yaxis),offsetMultplier:offsetMultiplier}};function makeg(el,type,klass){var join=el.selectAll(type+"."+klass).data([0]);return join.enter().append(type).classed(klass,!0),join}function __plotOne_731(gd,plotinfo,cd){var t=cd[0],trace=cd[0].trace,xa=plotinfo.xaxis,ya=plotinfo.yaxis,aax=trace.aaxis,bax=trace.baxis,fullLayout=gd._fullLayout,gridLayer=plotinfo.plot.selectAll(".carpetlayer"),clipLayer=fullLayout._clips,axisLayer=makeg(gridLayer,"g","carpet"+trace.uid).classed("trace",!0),minorLayer=makeg(axisLayer,"g","minorlayer"),majorLayer=makeg(axisLayer,"g","majorlayer"),boundaryLayer=makeg(axisLayer,"g","boundarylayer"),labelLayer=makeg(axisLayer,"g","labellayer");axisLayer.style("opacity",trace.opacity),drawGridLines(xa,ya,majorLayer,aax,"a",aax._gridlines),drawGridLines(xa,ya,majorLayer,bax,"b",bax._gridlines),drawGridLines(xa,ya,minorLayer,aax,"a",aax._minorgridlines),drawGridLines(xa,ya,minorLayer,bax,"b",bax._minorgridlines),drawGridLines(xa,ya,boundaryLayer,aax,"a-boundary",aax._boundarylines),drawGridLines(xa,ya,boundaryLayer,bax,"b-boundary",bax._boundarylines),function drawAxisTitles(gd,layer,trace,t,xa,ya,labelOrientationA,labelOrientationB){var a,b,xy,dxy;a=.5*(trace.a[0]+trace.a[trace.a.length-1]),b=trace.b[0],xy=trace.ab2xy(a,b,!0),dxy=trace.dxyda_rough(a,b),void 0===labelOrientationA.angle&&_$lib_539.extendFlat(labelOrientationA,_$orientText_730(trace,xa,ya,xy,trace.dxydb_rough(a,b)));drawAxisTitle(gd,layer,trace,t,xy,dxy,trace.aaxis,xa,ya,labelOrientationA,"a-title"),a=trace.a[0],b=.5*(trace.b[0]+trace.b[trace.b.length-1]),xy=trace.ab2xy(a,b,!0),dxy=trace.dxydb_rough(a,b),void 0===labelOrientationB.angle&&_$lib_539.extendFlat(labelOrientationB,_$orientText_730(trace,xa,ya,xy,trace.dxyda_rough(a,b)));drawAxisTitle(gd,layer,trace,t,xy,dxy,trace.baxis,xa,ya,labelOrientationB,"b-title")}(gd,labelLayer,trace,t,xa,ya,drawAxisLabels(gd,xa,ya,trace,t,labelLayer,aax._labels,"a-label"),drawAxisLabels(gd,xa,ya,trace,t,labelLayer,bax._labels,"b-label")),function drawClipPath(trace,t,layer,xaxis,yaxis){var seg,xp,yp,i,clip=layer.select("#"+trace._clipPathId);clip.size()||(clip=layer.append("clipPath").classed("carpetclip",!0));var path=makeg(clip,"path","carpetboundary"),segments=t.clipsegments,segs=[];for(i=0;i<segments.length;i++)seg=segments[i],xp=_$mapArray_728([],seg.x,xaxis.c2p),yp=_$mapArray_728([],seg.y,yaxis.c2p),segs.push(_$makePath_727(xp,yp,seg.bicubic));var clipPathData="M"+segs.join("L")+"Z";clip.attr("id",trace._clipPathId),path.attr("d",clipPathData)}(trace,t,clipLayer,xa,ya)}function drawGridLines(xaxis,yaxis,layer,axis,axisLetter,gridlines){var lineClass="const-"+axisLetter+"-lines",gridJoin=layer.selectAll("."+lineClass).data(gridlines);gridJoin.enter().append("path").classed(lineClass,!0).style("vector-effect","non-scaling-stroke"),gridJoin.each(function(d){var gridline=d,x=gridline.x,y=gridline.y,xp=_$mapArray_728([],x,xaxis.c2p),yp=_$mapArray_728([],y,yaxis.c2p),path="M"+_$makePath_727(xp,yp,gridline.smoothing);_$d3_127.select(this).attr("d",path).style("stroke-width",gridline.width).style("stroke",gridline.color).style("fill","none")}),gridJoin.exit().remove()}function drawAxisLabels(gd,xaxis,yaxis,trace,t,layer,labels,labelClass){var labelJoin=layer.selectAll("text."+labelClass).data(labels);labelJoin.enter().append("text").classed(labelClass,!0);var maxExtent=0,labelOrientation={};return labelJoin.each(function(label,i){var orientation;if("auto"===label.axis.tickangle)orientation=_$orientText_730(trace,xaxis,yaxis,label.xy,label.dxy);else{var angle=(label.axis.tickangle+180)*Math.PI/180;orientation=_$orientText_730(trace,xaxis,yaxis,label.xy,[Math.cos(angle),Math.sin(angle)])}i||(labelOrientation={angle:orientation.angle,flip:orientation.flip});var direction=(label.endAnchor?-1:1)*orientation.flip,labelEl=_$d3_127.select(this).attr({"text-anchor":direction>0?"start":"end","data-notex":1}).call(_$drawing_436.font,label.font).text(label.text).call(_$svg_text_utils_562.convertToTspans,gd),bbox=_$drawing_436.bBox(this);labelEl.attr("transform","translate("+orientation.p[0]+","+orientation.p[1]+") rotate("+orientation.angle+")translate("+label.axis.labelpadding*direction+","+.3*bbox.height+")"),maxExtent=Math.max(maxExtent,bbox.width+label.axis.labelpadding)}),labelJoin.exit().remove(),labelOrientation.maxExtent=maxExtent,labelOrientation}var lineSpacing=_$alignment_511.LINE_SPACING,midShift=(1-_$alignment_511.MID_SHIFT)/lineSpacing+1;function drawAxisTitle(gd,layer,trace,t,xy,dxy,axis,xa,ya,labelOrientation,labelClass){var data=[];axis.title&&data.push(axis.title);var titleJoin=layer.selectAll("text."+labelClass).data(data),offset=labelOrientation.maxExtent;titleJoin.enter().append("text").classed(labelClass,!0),titleJoin.each(function(){var orientation=_$orientText_730(trace,xa,ya,xy,dxy);-1===["start","both"].indexOf(axis.showticklabels)&&(offset=0);var titleSize=axis.titlefont.size;offset+=titleSize+axis.titleoffset;var angleDiff=(labelOrientation.angle+(labelOrientation.flip<0?180:0)-orientation.angle+450)%360,reverseTitle=angleDiff>90&&angleDiff<270,el=_$d3_127.select(this);el.text(axis.title||"").call(_$svg_text_utils_562.convertToTspans,gd),reverseTitle&&(offset=(-_$svg_text_utils_562.lineCount(el)+midShift)*lineSpacing*titleSize-offset),el.attr("transform","translate("+orientation.p[0]+","+orientation.p[1]+") rotate("+orientation.angle+") translate(0,"+offset+")").classed("user-select-none",!0).attr("text-anchor","middle").call(_$drawing_436.font,axis.titlefont)}),titleJoin.exit().remove()}var Carpet={};Carpet.attributes=_$attributes_708,Carpet.supplyDefaults=function supplyDefaults(traceIn,traceOut,dfltColor,fullLayout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_708,attr,dflt)}traceOut._clipPathId="clip"+traceOut.uid+"carpet";var defaultColor=coerce("color",_$attributes_410.defaultLine);if(_$lib_539.coerceFont(coerce,"font"),coerce("carpet"),_$handleABDefaults_706(traceIn,traceOut,fullLayout,coerce,defaultColor),traceOut.a&&traceOut.b){traceOut.a.length<3&&(traceOut.aaxis.smoothing=0),traceOut.b.length<3&&(traceOut.baxis.smoothing=0);var len=function handleXYDefaults(traceIn,traceOut,coerce){var cols=[],x=coerce("x");x&&!_$has_columns_724(x)&&cols.push("x"),traceOut._cheater=!x;var y=coerce("y");if(y&&!_$has_columns_724(y)&&cols.push("y"),x||y)return cols.length&&_$convertColumnData_777(traceOut,traceOut.aaxis,traceOut.baxis,"a","b",cols),!0}(0,traceOut,coerce);_$setConvert_732(traceOut),traceOut._cheater&&coerce("cheaterslope"),len||(traceOut.visible=!1)}else traceOut.visible=!1},Carpet.plot=function plot(gd,plotinfo,cdcarpet){for(var i=0;i<cdcarpet.length;i++)__plotOne_731(gd,plotinfo,cdcarpet[i])},Carpet.calc=function calc(gd,trace){var x,xa=_$axes_584.getFromId(gd,trace.xaxis||"x"),ya=_$axes_584.getFromId(gd,trace.yaxis||"y"),aax=trace.aaxis,bax=trace.baxis,a=trace._a=trace.a,b=trace._b=trace.b,t={},y=trace.y;x=trace._cheater?function(a,b,cheaterslope){var i,j,ascal,bscal,bval,xval,data=[],na=__isArrayOrTypedArray_717(a)?a.length:a,nb=__isArrayOrTypedArray_717(b)?b.length:b,adata=__isArrayOrTypedArray_717(a)?a:null,bdata=__isArrayOrTypedArray_717(b)?b:null;adata&&(ascal=(adata.length-1)/(adata[adata.length-1]-adata[0])/(na-1)),bdata&&(bscal=(bdata.length-1)/(bdata[bdata.length-1]-bdata[0])/(nb-1));var xmin=1/0,xmax=-1/0;for(j=0;j<nb;j++)for(data[j]=[],bval=bdata?(bdata[j]-bdata[0])*bscal:j/(nb-1),i=0;i<na;i++)xval=(adata?(adata[i]-adata[0])*ascal:i/(na-1))-bval*cheaterslope,xmin=Math.min(xval,xmin),xmax=Math.max(xval,xmax),data[j][i]=xval;var slope=1/(xmax-xmin),offset=-xmin*slope;for(j=0;j<nb;j++)for(i=0;i<na;i++)data[j][i]=slope*data[j][i]+offset;return data}("index"===aax.cheatertype?a.length:a,"index"===bax.cheatertype?b.length:b,trace.cheaterslope):trace.x;trace._x=x=_$clean2dArray_775(x),trace._y=y=_$clean2dArray_775(y),_$smoothFill2dArray_733(x,a,b),_$smoothFill2dArray_733(y,a,b),trace.setScale(),t.xp=trace.xp=_$mapArray_729(trace.xp,x,xa.c2p),t.yp=trace.yp=_$mapArray_729(trace.yp,y,ya.c2p);var xrange=_$array_minmax_707(x),yrange=_$array_minmax_707(y),dx=.5*(xrange[1]-xrange[0]),xc=.5*(xrange[1]+xrange[0]),dy=.5*(yrange[1]-yrange[0]),yc=.5*(yrange[1]+yrange[0]);return xrange=[xc-1.3*dx,xc+1.3*dx],yrange=[yc-1.3*dy,yc+1.3*dy],_$axes_584.expand(xa,xrange,{padded:!0}),_$axes_584.expand(ya,yrange,{padded:!0}),_$calcGridlines_714(trace,0,"a","b"),_$calcGridlines_714(trace,0,"b","a"),_$calcLabels_715(0,aax),_$calcLabels_715(0,bax),t.clipsegments=function makeClipPath(xctrl,yctrl,aax,bax){var i,x,y,segments=[],asmoothing=!!aax.smoothing,bsmoothing=!!bax.smoothing,nea1=xctrl[0].length-1,neb1=xctrl.length-1;for(i=0,x=[],y=[];i<=nea1;i++)x[i]=xctrl[0][i],y[i]=yctrl[0][i];for(segments.push({x:x,y:y,bicubic:asmoothing}),i=0,x=[],y=[];i<=neb1;i++)x[i]=xctrl[i][nea1],y[i]=yctrl[i][nea1];for(segments.push({x:x,y:y,bicubic:bsmoothing}),i=nea1,x=[],y=[];i>=0;i--)x[nea1-i]=xctrl[neb1][i],y[nea1-i]=yctrl[neb1][i];for(segments.push({x:x,y:y,bicubic:asmoothing}),i=neb1,x=[],y=[];i>=0;i--)x[neb1-i]=xctrl[i][0],y[neb1-i]=yctrl[i][0];return segments.push({x:x,y:y,bicubic:bsmoothing}),segments}(trace.xctrl,trace.yctrl,aax,bax),t.x=x,t.y=y,t.a=a,t.b=b,[t]},Carpet.animatable=!0,Carpet.moduleType="trace",Carpet.name="carpet",Carpet.basePlotModule=_$cartesian_595,Carpet.categories=["cartesian","carpet","carpetAxis","notLegendIsolatable"],Carpet.meta={};var _$carpet_8=Carpet,_$topojsonClient_355={exports:{}};!function(global,factory){"object"==typeof _$topojsonClient_355.exports?factory(_$topojsonClient_355.exports):factory(global.topojson=global.topojson||{})}(this,function(exports){"use strict";var identity=function(x){return x},transform=function(topology){if(null==(transform=topology.transform))return identity;var transform,x0,y0,kx=transform.scale[0],ky=transform.scale[1],dx=transform.translate[0],dy=transform.translate[1];return function(point,i){return i||(x0=y0=0),point[0]=(x0+=point[0])*kx+dx,point[1]=(y0+=point[1])*ky+dy,point}},bbox=function(topology){var bbox=topology.bbox;function bboxPoint(p0){p1[0]=p0[0],p1[1]=p0[1],t(p1),p1[0]<x0&&(x0=p1[0]),p1[0]>x1&&(x1=p1[0]),p1[1]<y0&&(y0=p1[1]),p1[1]>y1&&(y1=p1[1])}function bboxGeometry(o){switch(o.type){case"GeometryCollection":o.geometries.forEach(bboxGeometry);break;case"Point":bboxPoint(o.coordinates);break;case"MultiPoint":o.coordinates.forEach(bboxPoint)}}if(!bbox){var p0,name,t=transform(topology),p1=new Array(2),x0=1/0,y0=x0,x1=-x0,y1=-x0;for(name in topology.arcs.forEach(function(arc){for(var i=-1,n=arc.length;++i<n;)p0=arc[i],p1[0]=p0[0],p1[1]=p0[1],t(p1,i),p1[0]<x0&&(x0=p1[0]),p1[0]>x1&&(x1=p1[0]),p1[1]<y0&&(y0=p1[1]),p1[1]>y1&&(y1=p1[1])}),topology.objects)bboxGeometry(topology.objects[name]);bbox=topology.bbox=[x0,y0,x1,y1]}return bbox},reverse=function(array,n){for(var t,j=array.length,i=j-n;i<--j;)t=array[i],array[i++]=array[j],array[j]=t};function feature$1(topology,o){var id=o.id,bbox=o.bbox,properties=null==o.properties?{}:o.properties,geometry=object(topology,o);return null==id&&null==bbox?{type:"Feature",properties:properties,geometry:geometry}:null==bbox?{type:"Feature",id:id,properties:properties,geometry:geometry}:{type:"Feature",id:id,bbox:bbox,properties:properties,geometry:geometry}}function object(topology,o){var transformPoint=transform(topology),arcs=topology.arcs;function arc(i,points){points.length&&points.pop();for(var a=arcs[i<0?~i:i],k=0,n=a.length;k<n;++k)points.push(transformPoint(a[k].slice(),k));i<0&&reverse(points,n)}function point(p){return transformPoint(p.slice())}function line(arcs){for(var points=[],i=0,n=arcs.length;i<n;++i)arc(arcs[i],points);return points.length<2&&points.push(points[0].slice()),points}function ring(arcs){for(var points=line(arcs);points.length<4;)points.push(points[0].slice());return points}function polygon(arcs){return arcs.map(ring)}return function geometry(o){var coordinates,type=o.type;switch(type){case"GeometryCollection":return{type:type,geometries:o.geometries.map(geometry)};case"Point":coordinates=point(o.coordinates);break;case"MultiPoint":coordinates=o.coordinates.map(point);break;case"LineString":coordinates=line(o.arcs);break;case"MultiLineString":coordinates=o.arcs.map(line);break;case"Polygon":coordinates=polygon(o.arcs);break;case"MultiPolygon":coordinates=o.arcs.map(polygon);break;default:return null}return{type:type,coordinates:coordinates}}(o)}var stitch=function(topology,arcs){var stitchedArcs={},fragmentByStart={},fragmentByEnd={},fragments=[],emptyIndex=-1;function flush(fragmentByEnd,fragmentByStart){for(var k in fragmentByEnd){var f=fragmentByEnd[k];delete fragmentByStart[f.start],delete f.start,delete f.end,f.forEach(function(i){stitchedArcs[i<0?~i:i]=1}),fragments.push(f)}}return arcs.forEach(function(i,j){var t,arc=topology.arcs[i<0?~i:i];arc.length<3&&!arc[1][0]&&!arc[1][1]&&(t=arcs[++emptyIndex],arcs[emptyIndex]=i,arcs[j]=t)}),arcs.forEach(function(i){var f,g,e=function ends(i){var p1,arc=topology.arcs[i<0?~i:i],p0=arc[0];topology.transform?(p1=[0,0],arc.forEach(function(dp){p1[0]+=dp[0],p1[1]+=dp[1]})):p1=arc[arc.length-1];return i<0?[p1,p0]:[p0,p1]}(i),start=e[0],end=e[1];if(f=fragmentByEnd[start])if(delete fragmentByEnd[f.end],f.push(i),f.end=end,g=fragmentByStart[end]){delete fragmentByStart[g.start];var fg=g===f?f:f.concat(g);fragmentByStart[fg.start=f.start]=fragmentByEnd[fg.end=g.end]=fg}else fragmentByStart[f.start]=fragmentByEnd[f.end]=f;else if(f=fragmentByStart[end])if(delete fragmentByStart[f.start],f.unshift(i),f.start=start,g=fragmentByEnd[start]){delete fragmentByEnd[g.end];var gf=g===f?f:g.concat(f);fragmentByStart[gf.start=g.start]=fragmentByEnd[gf.end=f.end]=gf}else fragmentByStart[f.start]=fragmentByEnd[f.end]=f;else fragmentByStart[(f=[i]).start=start]=fragmentByEnd[f.end=end]=f}),flush(fragmentByEnd,fragmentByStart),flush(fragmentByStart,fragmentByEnd),arcs.forEach(function(i){stitchedArcs[i<0?~i:i]||fragments.push([i])}),fragments};function meshArcs(topology,object$$1,filter){var arcs,i,n;if(arguments.length>1)arcs=function extractArcs(topology,object$$1,filter){var geom,arcs=[],geomsByArc=[];function extract0(i){var j=i<0?~i:i;(geomsByArc[j]||(geomsByArc[j]=[])).push({i:i,g:geom})}function extract1(arcs){arcs.forEach(extract0)}function extract2(arcs){arcs.forEach(extract1)}return function geometry(o){switch(geom=o,o.type){case"GeometryCollection":o.geometries.forEach(geometry);break;case"LineString":extract1(o.arcs);break;case"MultiLineString":case"Polygon":extract2(o.arcs);break;case"MultiPolygon":!function extract3(arcs){arcs.forEach(extract2)}(o.arcs)}}(object$$1),geomsByArc.forEach(null==filter?function(geoms){arcs.push(geoms[0].i)}:function(geoms){filter(geoms[0].g,geoms[geoms.length-1].g)&&arcs.push(geoms[0].i)}),arcs}(0,object$$1,filter);else for(i=0,arcs=new Array(n=topology.arcs.length);i<n;++i)arcs[i]=i;return{type:"MultiLineString",arcs:stitch(topology,arcs)}}function mergeArcs(topology,objects){var polygonsByArc={},polygons=[],groups=[];function extract(polygon){polygon.forEach(function(ring){ring.forEach(function(arc){(polygonsByArc[arc=arc<0?~arc:arc]||(polygonsByArc[arc]=[])).push(polygon)})}),polygons.push(polygon)}function area(ring){return function planarRingArea(ring){for(var a,i=-1,n=ring.length,b=ring[n-1],area=0;++i<n;)a=b,b=ring[i],area+=a[0]*b[1]-a[1]*b[0];return Math.abs(area)}(object(topology,{type:"Polygon",arcs:[ring]}).coordinates[0])}return objects.forEach(function geometry(o){switch(o.type){case"GeometryCollection":o.geometries.forEach(geometry);break;case"Polygon":extract(o.arcs);break;case"MultiPolygon":o.arcs.forEach(extract)}}),polygons.forEach(function(polygon){if(!polygon._){var group=[],neighbors=[polygon];for(polygon._=1,groups.push(group);polygon=neighbors.pop();)group.push(polygon),polygon.forEach(function(ring){ring.forEach(function(arc){polygonsByArc[arc<0?~arc:arc].forEach(function(polygon){polygon._||(polygon._=1,neighbors.push(polygon))})})})}}),polygons.forEach(function(polygon){delete polygon._}),{type:"MultiPolygon",arcs:groups.map(function(polygons){var n,arcs=[];if(polygons.forEach(function(polygon){polygon.forEach(function(ring){ring.forEach(function(arc){polygonsByArc[arc<0?~arc:arc].length<2&&arcs.push(arc)})})}),(n=(arcs=stitch(topology,arcs)).length)>1)for(var ki,t,i=1,k=area(arcs[0]);i<n;++i)(ki=area(arcs[i]))>k&&(t=arcs[0],arcs[0]=arcs[i],arcs[i]=t,k=ki);return arcs})}}var bisect=function(a,x){for(var lo=0,hi=a.length;lo<hi;){var mid=lo+hi>>>1;a[mid]<x?lo=mid+1:hi=mid}return lo};exports.bbox=bbox,exports.feature=function(topology,o){return"GeometryCollection"===o.type?{type:"FeatureCollection",features:o.geometries.map(function(o){return feature$1(topology,o)})}:feature$1(topology,o)},exports.mesh=function(topology){return object(topology,meshArcs.apply(this,arguments))},exports.meshArcs=meshArcs,exports.merge=function(topology){return object(topology,mergeArcs.apply(this,arguments))},exports.mergeArcs=mergeArcs,exports.neighbors=function(objects){var indexesByArc={},neighbors=objects.map(function(){return[]});function line(arcs,i){arcs.forEach(function(a){a<0&&(a=~a);var o=indexesByArc[a];o?o.push(i):indexesByArc[a]=[i]})}function polygon(arcs,i){arcs.forEach(function(arc){line(arc,i)})}var geometryType={LineString:line,MultiLineString:polygon,Polygon:polygon,MultiPolygon:function(arcs,i){arcs.forEach(function(arc){polygon(arc,i)})}};for(var i in objects.forEach(function geometry(o,i){"GeometryCollection"===o.type?o.geometries.forEach(function(o){geometry(o,i)}):o.type in geometryType&&geometryType[o.type](o.arcs,i)}),indexesByArc)for(var indexes=indexesByArc[i],m=indexes.length,j=0;j<m;++j)for(var k=j+1;k<m;++k){var n,ij=indexes[j],ik=indexes[k];(n=neighbors[ij])[i=bisect(n,ik)]!==ik&&n.splice(i,0,ik),(n=neighbors[ik])[i=bisect(n,ij)]!==ij&&n.splice(i,0,ij)}return neighbors},exports.quantize=function(topology,n){if(!((n=Math.floor(n))>=2))throw new Error("n must be ≥2");if(topology.transform)throw new Error("already quantized");var name,bb=bbox(topology),dx=bb[0],kx=(bb[2]-dx)/(n-1)||1,dy=bb[1],ky=(bb[3]-dy)/(n-1)||1;function quantizePoint(p){p[0]=Math.round((p[0]-dx)/kx),p[1]=Math.round((p[1]-dy)/ky)}function quantizeGeometry(o){switch(o.type){case"GeometryCollection":o.geometries.forEach(quantizeGeometry);break;case"Point":quantizePoint(o.coordinates);break;case"MultiPoint":o.coordinates.forEach(quantizePoint)}}for(name in topology.arcs.forEach(function(arc){for(var pj,x1,y1,i=1,j=1,n=arc.length,pi=arc[0],x0=pi[0]=Math.round((pi[0]-dx)/kx),y0=pi[1]=Math.round((pi[1]-dy)/ky);i<n;++i)pi=arc[i],x1=Math.round((pi[0]-dx)/kx),y1=Math.round((pi[1]-dy)/ky),x1===x0&&y1===y0||((pj=arc[j++])[0]=x1-x0,x0=x1,pj[1]=y1-y0,y0=y1);j<2&&((pj=arc[j++])[0]=0,pj[1]=0),arc.length=j}),topology.objects)quantizeGeometry(topology.objects[name]);return topology.transform={scale:[kx,ky],translate:[dx,dy]},topology},exports.transform=transform,exports.untransform=function(topology){if(null==(transform=topology.transform))return identity;var transform,x0,y0,kx=transform.scale[0],ky=transform.scale[1],dx=transform.translate[0],dy=transform.translate[1];return function(point,i){i||(x0=y0=0);var x1=Math.round((point[0]-dx)/kx),y1=Math.round((point[1]-dy)/ky);return point[0]=x1-x0,x0=x1,point[1]=y1-y0,y0=y1,point}},Object.defineProperty(exports,"__esModule",{value:!0})}),_$topojsonClient_355=_$topojsonClient_355.exports;var _$constants_613={projNames:{equirectangular:"equirectangular",mercator:"mercator",orthographic:"orthographic","natural earth":"naturalEarth",kavrayskiy7:"kavrayskiy7",miller:"miller",robinson:"robinson",eckert4:"eckert4","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant","conic equal area":"conicEqualArea","conic conformal":"conicConformal","conic equidistant":"conicEquidistant",gnomonic:"gnomonic",stereographic:"stereographic",mollweide:"mollweide",hammer:"hammer","transverse mercator":"transverseMercator","albers usa":"albersUsa","winkel tripel":"winkel3",aitoff:"aitoff",sinusoidal:"sinusoidal"},axesNames:["lonaxis","lataxis"],lonaxisSpan:{orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},lataxisSpan:{"conic conformal":150,stereographic:179.5,"*":180},scopeDefaults:{world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},clipPad:.001,precision:.1,landColor:"#F0DC82",waterColor:"#3399FF",locationmodeToLayer:{"ISO-3":"countries","USA-states":"subunits","country names":"countries"},sphereSVG:{type:"Sphere"},fillLayers:{ocean:1,land:1,lakes:1},lineLayers:{subunits:1,countries:1,coastlines:1,rivers:1,frame:1},layers:["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],layersForChoropleth:["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],layerNameToAdjective:{ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},_$topojson_utils_565={},topojsonUtils=_$topojson_utils_565={},locationmodeToLayer=_$constants_613.locationmodeToLayer,topojsonFeature=_$topojsonClient_355.feature;topojsonUtils.getTopojsonName=function(geoLayout){return[geoLayout.scope.replace(/ /g,"-"),"_",geoLayout.resolution.toString(),"m"].join("")},topojsonUtils.getTopojsonPath=function(topojsonURL,topojsonName){return topojsonURL+topojsonName+".json"},topojsonUtils.getTopojsonFeatures=function(trace,topojson){var layer=locationmodeToLayer[trace.locationmode],obj=topojson.objects[layer];return topojsonFeature(topojson,obj).features};var _$BuildLog_296=function BuildLog(){var my,nextSegmentId=0,curVert=!1;function push(type,data){return my.list.push({type:type,data:data?JSON.parse(JSON.stringify(data)):void 0}),my}return my={list:[],segmentId:function(){return nextSegmentId++},checkIntersection:function(seg1,seg2){return push("check",{seg1:seg1,seg2:seg2})},segmentChop:function(seg,end){return push("div_seg",{seg:seg,pt:end}),push("chop",{seg:seg,pt:end})},statusRemove:function(seg){return push("pop_seg",{seg:seg})},segmentUpdate:function(seg){return push("seg_update",{seg:seg})},segmentNew:function(seg,primary){return push("new_seg",{seg:seg,primary:primary})},segmentRemove:function(seg){return push("rem_seg",{seg:seg})},tempStatus:function(seg,above,below){return push("temp_status",{seg:seg,above:above,below:below})},rewind:function(seg){return push("rewind",{seg:seg})},status:function(seg,above,below){return push("status",{seg:seg,above:above,below:below})},vert:function(x){return x===curVert?my:(curVert=x,push("vert",{x:x}))},log:function(data){return"string"!=typeof data&&(data=JSON.stringify(data,!1,"  ")),push("log",{txt:data})},reset:function(){return push("reset")},selected:function(segs){return push("selected",{segs:segs})},chainStart:function(seg){return push("chain_start",{seg:seg})},chainRemoveHead:function(index,pt){return push("chain_rem_head",{index:index,pt:pt})},chainRemoveTail:function(index,pt){return push("chain_rem_tail",{index:index,pt:pt})},chainNew:function(pt1,pt2){return push("chain_new",{pt1:pt1,pt2:pt2})},chainMatch:function(index){return push("chain_match",{index:index})},chainClose:function(index){return push("chain_close",{index:index})},chainAddHead:function(index,pt){return push("chain_add_head",{index:index,pt:pt})},chainAddTail:function(index,pt){return push("chain_add_tail",{index:index,pt:pt})},chainConnect:function(index1,index2){return push("chain_con",{index1:index1,index2:index2})},chainReverse:function(index){return push("chain_rev",{index:index})},chainJoin:function(index1,index2){return push("chain_join",{index1:index1,index2:index2})},done:function(){return push("done")}}};var _$GeoJSON_298={toPolygon:function(PolyBool,geojson){function GeoPoly(coords){if(coords.length<=0)return PolyBool.segments({inverted:!1,regions:[]});function LineString(ls){var reg=ls.slice(0,ls.length-1);return PolyBool.segments({inverted:!1,regions:[reg]})}for(var out=LineString(coords[0]),i=1;i<coords.length;i++)out=PolyBool.selectDifference(PolyBool.combine(out,LineString(coords[i])));return out}if("Polygon"===geojson.type)return PolyBool.polygon(GeoPoly(geojson.coordinates));if("MultiPolygon"===geojson.type){for(var out=PolyBool.segments({inverted:!1,regions:[]}),i=0;i<geojson.coordinates.length;i++)out=PolyBool.selectUnion(PolyBool.combine(out,GeoPoly(geojson.coordinates[i])));return PolyBool.polygon(out)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(PolyBool,eps,poly){function regionInsideRegion(r1,r2){return eps.pointInsideRegion([.5*(r1[0][0]+r1[1][0]),.5*(r1[0][1]+r1[1][1])],r2)}function newNode(region){return{region:region,children:[]}}poly=PolyBool.polygon(PolyBool.segments(poly));var roots=newNode(null);function addChild(root,region){for(var i=0;i<root.children.length;i++){if(regionInsideRegion(region,(child=root.children[i]).region))return void addChild(child,region)}var node=newNode(region);for(i=0;i<root.children.length;i++){var child;regionInsideRegion((child=root.children[i]).region,region)&&(node.children.push(child),root.children.splice(i,1),i--)}root.children.push(node)}for(var i=0;i<poly.regions.length;i++){var region=poly.regions[i];region.length<3||addChild(roots,region)}function forceWinding(region,clockwise){for(var winding=0,last_x=region[region.length-1][0],last_y=region[region.length-1][1],copy=[],i=0;i<region.length;i++){var curr_x=region[i][0],curr_y=region[i][1];copy.push([curr_x,curr_y]),winding+=curr_y*last_x-curr_x*last_y,last_x=curr_x,last_y=curr_y}return winding<0!==clockwise&&copy.reverse(),copy.push([copy[0][0],copy[0][1]]),copy}var geopolys=[];function addExterior(node){var poly=[forceWinding(node.region,!1)];geopolys.push(poly);for(var i=0;i<node.children.length;i++)poly.push(getInterior(node.children[i]))}function getInterior(node){for(var i=0;i<node.children.length;i++)addExterior(node.children[i]);return forceWinding(node.region,!0)}for(i=0;i<roots.children.length;i++)addExterior(roots.children[i]);return geopolys.length<=0?{type:"Polygon",coordinates:[]}:1==geopolys.length?{type:"Polygon",coordinates:geopolys[0]}:{type:"MultiPolygon",coordinates:geopolys}}},_$LinkedList_300={create:function(){var my={root:{root:!0,next:null},exists:function(node){return null!==node&&node!==my.root},isEmpty:function(){return null===my.root.next},getHead:function(){return my.root.next},insertBefore:function(node,check){for(var last=my.root,here=my.root.next;null!==here;){if(check(here))return node.prev=here.prev,node.next=here,here.prev.next=node,void(here.prev=node);last=here,here=here.next}last.next=node,node.prev=last,node.next=null},findTransition:function(check){for(var prev=my.root,here=my.root.next;null!==here&&!check(here);)prev=here,here=here.next;return{before:prev===my.root?null:prev,after:here,insert:function(node){return node.prev=prev,node.next=here,prev.next=node,null!==here&&(here.prev=node),node}}}};return my},node:function(data){return data.prev=null,data.next=null,data.remove=function(){data.prev.next=data.next,data.next&&(data.next.prev=data.prev),data.prev=null,data.next=null},data}};var _$Intersecter_299=function Intersecter(selfIntersection,eps,buildLog){function segmentCopy(start,end,seg){return{id:buildLog?buildLog.segmentId():-1,start:start,end:end,myFill:{above:seg.myFill.above,below:seg.myFill.below},otherFill:null}}var event_root=_$LinkedList_300.create();function eventAdd(ev,other_pt){event_root.insertBefore(ev,function(here){return function eventCompare(p1_isStart,p1_1,p1_2,p2_isStart,p2_1,p2_2){var comp=eps.pointsCompare(p1_1,p2_1);return 0!==comp?comp:eps.pointsSame(p1_2,p2_2)?0:p1_isStart!==p2_isStart?p1_isStart?1:-1:eps.pointAboveOrOnLine(p1_2,p2_isStart?p2_1:p2_2,p2_isStart?p2_2:p2_1)?1:-1}(ev.isStart,ev.pt,other_pt,here.isStart,here.pt,here.other.pt)<0})}function eventAddSegment(seg,primary){var ev_start=function eventAddSegmentStart(seg,primary){var ev_start=_$LinkedList_300.node({isStart:!0,pt:seg.start,seg:seg,primary:primary,other:null,status:null});return eventAdd(ev_start,seg.end),ev_start}(seg,primary);return function eventAddSegmentEnd(ev_start,seg,primary){var ev_end=_$LinkedList_300.node({isStart:!1,pt:seg.end,seg:seg,primary:primary,other:ev_start,status:null});ev_start.other=ev_end,eventAdd(ev_end,ev_start.pt)}(ev_start,seg,primary),ev_start}function eventDivide(ev,pt){var ns=segmentCopy(pt,ev.seg.end,ev.seg);return function eventUpdateEnd(ev,end){buildLog&&buildLog.segmentChop(ev.seg,end),ev.other.remove(),ev.seg.end=end,ev.other.pt=end,eventAdd(ev.other,ev.pt)}(ev,pt),eventAddSegment(ns,ev.primary)}function calculate(primaryPolyInverted,secondaryPolyInverted){var status_root=_$LinkedList_300.create();function statusFindSurrounding(ev){return status_root.findTransition(function(here){return function statusCompare(ev1,ev2){var a1=ev1.seg.start,a2=ev1.seg.end,b1=ev2.seg.start,b2=ev2.seg.end;return eps.pointsCollinear(a1,b1,b2)?eps.pointsCollinear(a2,b1,b2)?1:eps.pointAboveOrOnLine(a2,b1,b2)?1:-1:eps.pointAboveOrOnLine(a1,b1,b2)?1:-1}(ev,here.ev)>0})}function checkIntersection(ev1,ev2){var seg1=ev1.seg,seg2=ev2.seg,a1=seg1.start,a2=seg1.end,b1=seg2.start,b2=seg2.end;buildLog&&buildLog.checkIntersection(seg1,seg2);var i=eps.linesIntersect(a1,a2,b1,b2);if(!1===i){if(!eps.pointsCollinear(a1,a2,b1))return!1;if(eps.pointsSame(a1,b2)||eps.pointsSame(a2,b1))return!1;var a1_equ_b1=eps.pointsSame(a1,b1),a2_equ_b2=eps.pointsSame(a2,b2);if(a1_equ_b1&&a2_equ_b2)return ev2;var a1_between=!a1_equ_b1&&eps.pointBetween(a1,b1,b2),a2_between=!a2_equ_b2&&eps.pointBetween(a2,b1,b2);if(a1_equ_b1)return a2_between?eventDivide(ev2,a2):eventDivide(ev1,b2),ev2;a1_between&&(a2_equ_b2||(a2_between?eventDivide(ev2,a2):eventDivide(ev1,b2)),eventDivide(ev2,a1))}else 0===i.alongA&&(-1===i.alongB?eventDivide(ev1,b1):0===i.alongB?eventDivide(ev1,i.pt):1===i.alongB&&eventDivide(ev1,b2)),0===i.alongB&&(-1===i.alongA?eventDivide(ev2,a1):0===i.alongA?eventDivide(ev2,i.pt):1===i.alongA&&eventDivide(ev2,a2));return!1}for(var segments=[];!event_root.isEmpty();){var ev=event_root.getHead();if(buildLog&&buildLog.vert(ev.pt[0]),ev.isStart){buildLog&&buildLog.segmentNew(ev.seg,ev.primary);var surrounding=statusFindSurrounding(ev),above=surrounding.before?surrounding.before.ev:null,below=surrounding.after?surrounding.after.ev:null;function checkBothIntersections(){if(above){var eve=checkIntersection(ev,above);if(eve)return eve}return!!below&&checkIntersection(ev,below)}buildLog&&buildLog.tempStatus(ev.seg,!!above&&above.seg,!!below&&below.seg);var inside,toggle,eve=checkBothIntersections();if(eve)selfIntersection?(toggle=null===ev.seg.myFill.below||ev.seg.myFill.above!==ev.seg.myFill.below)&&(eve.seg.myFill.above=!eve.seg.myFill.above):eve.seg.otherFill=ev.seg.myFill,buildLog&&buildLog.segmentUpdate(eve.seg),ev.other.remove(),ev.remove();if(event_root.getHead()!==ev){buildLog&&buildLog.rewind(ev.seg);continue}selfIntersection?(toggle=null===ev.seg.myFill.below||ev.seg.myFill.above!==ev.seg.myFill.below,ev.seg.myFill.below=below?below.seg.myFill.above:primaryPolyInverted,ev.seg.myFill.above=toggle?!ev.seg.myFill.below:ev.seg.myFill.below):null===ev.seg.otherFill&&(inside=below?ev.primary===below.primary?below.seg.otherFill.above:below.seg.myFill.above:ev.primary?secondaryPolyInverted:primaryPolyInverted,ev.seg.otherFill={above:inside,below:inside}),buildLog&&buildLog.status(ev.seg,!!above&&above.seg,!!below&&below.seg),ev.other.status=surrounding.insert(_$LinkedList_300.node({ev:ev}))}else{var st=ev.status;if(null===st)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(status_root.exists(st.prev)&&status_root.exists(st.next)&&checkIntersection(st.prev.ev,st.next.ev),buildLog&&buildLog.statusRemove(st.ev.seg),st.remove(),!ev.primary){var s=ev.seg.myFill;ev.seg.myFill=ev.seg.otherFill,ev.seg.otherFill=s}segments.push(ev.seg)}event_root.getHead().remove()}return buildLog&&buildLog.done(),segments}return selfIntersection?{addRegion:function(region){for(var pt1,start,end,pt2=region[region.length-1],i=0;i<region.length;i++){pt1=pt2,pt2=region[i];var forward=eps.pointsCompare(pt1,pt2);0!==forward&&eventAddSegment((start=forward<0?pt1:pt2,end=forward<0?pt2:pt1,{id:buildLog?buildLog.segmentId():-1,start:start,end:end,myFill:{above:null,below:null},otherFill:null}),!0)}},calculate:function(inverted){return calculate(inverted,!1)}}:{calculate:function(segments1,inverted1,segments2,inverted2){return segments1.forEach(function(seg){eventAddSegment(segmentCopy(seg.start,seg.end,seg),!0)}),segments2.forEach(function(seg){eventAddSegment(segmentCopy(seg.start,seg.end,seg),!1)}),calculate(inverted1,inverted2)}}};var _$SegmentChainer_301=function SegmentChainer(segments,eps,buildLog){var chains=[],regions=[];return segments.forEach(function(seg){var pt1=seg.start,pt2=seg.end;if(eps.pointsSame(pt1,pt2))console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");else{buildLog&&buildLog.chainStart(seg);for(var first_match={index:0,matches_head:!1,matches_pt1:!1},second_match={index:0,matches_head:!1,matches_pt1:!1},next_match=first_match,i=0;i<chains.length;i++){var head=(chain=chains[i])[0],tail=(chain[1],chain[chain.length-1]);if(chain[chain.length-2],eps.pointsSame(head,pt1)){if(setMatch(i,!0,!0))break}else if(eps.pointsSame(head,pt2)){if(setMatch(i,!0,!1))break}else if(eps.pointsSame(tail,pt1)){if(setMatch(i,!1,!0))break}else if(eps.pointsSame(tail,pt2)&&setMatch(i,!1,!1))break}if(next_match===first_match)return chains.push([pt1,pt2]),void(buildLog&&buildLog.chainNew(pt1,pt2));if(next_match===second_match){buildLog&&buildLog.chainMatch(first_match.index);var index=first_match.index,pt=first_match.matches_pt1?pt2:pt1,addToHead=first_match.matches_head,chain=chains[index],grow=addToHead?chain[0]:chain[chain.length-1],grow2=addToHead?chain[1]:chain[chain.length-2],oppo=addToHead?chain[chain.length-1]:chain[0],oppo2=addToHead?chain[chain.length-2]:chain[1];return eps.pointsCollinear(grow2,grow,pt)&&(addToHead?(buildLog&&buildLog.chainRemoveHead(first_match.index,pt),chain.shift()):(buildLog&&buildLog.chainRemoveTail(first_match.index,pt),chain.pop()),grow=grow2),eps.pointsSame(oppo,pt)?(chains.splice(index,1),eps.pointsCollinear(oppo2,oppo,grow)&&(addToHead?(buildLog&&buildLog.chainRemoveTail(first_match.index,grow),chain.pop()):(buildLog&&buildLog.chainRemoveHead(first_match.index,grow),chain.shift())),buildLog&&buildLog.chainClose(first_match.index),void regions.push(chain)):void(addToHead?(buildLog&&buildLog.chainAddHead(first_match.index,pt),chain.unshift(pt)):(buildLog&&buildLog.chainAddTail(first_match.index,pt),chain.push(pt)))}var F=first_match.index,S=second_match.index;buildLog&&buildLog.chainConnect(F,S);var reverseF=chains[F].length<chains[S].length;first_match.matches_head?second_match.matches_head?reverseF?(reverseChain(F),appendChain(F,S)):(reverseChain(S),appendChain(S,F)):appendChain(S,F):second_match.matches_head?appendChain(F,S):reverseF?(reverseChain(F),appendChain(S,F)):(reverseChain(S),appendChain(F,S))}function setMatch(index,matches_head,matches_pt1){return next_match.index=index,next_match.matches_head=matches_head,next_match.matches_pt1=matches_pt1,next_match===first_match?(next_match=second_match,!1):(next_match=null,!0)}function reverseChain(index){buildLog&&buildLog.chainReverse(index),chains[index].reverse()}function appendChain(index1,index2){var chain1=chains[index1],chain2=chains[index2],tail=chain1[chain1.length-1],tail2=chain1[chain1.length-2],head=chain2[0],head2=chain2[1];eps.pointsCollinear(tail2,tail,head)&&(buildLog&&buildLog.chainRemoveTail(index1,tail),chain1.pop(),tail=tail2),eps.pointsCollinear(tail,head,head2)&&(buildLog&&buildLog.chainRemoveHead(index2,head),chain2.shift()),buildLog&&buildLog.chainJoin(index1,index2),chains[index1]=chain1.concat(chain2),chains.splice(index2,1)}}),regions};function select(segments,selection,buildLog){var result=[];return segments.forEach(function(seg){var index=(seg.myFill.above?8:0)+(seg.myFill.below?4:0)+(seg.otherFill&&seg.otherFill.above?2:0)+(seg.otherFill&&seg.otherFill.below?1:0);0!==selection[index]&&result.push({id:buildLog?buildLog.segmentId():-1,start:seg.start,end:seg.end,myFill:{above:1===selection[index],below:2===selection[index]},otherFill:null})}),buildLog&&buildLog.selected(result),result}var PolyBool,_$SegmentSelector_302={union:function(segments,buildLog){return select(segments,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],buildLog)},intersect:function(segments,buildLog){return select(segments,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],buildLog)},difference:function(segments,buildLog){return select(segments,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],buildLog)},differenceRev:function(segments,buildLog){return select(segments,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],buildLog)},xor:function(segments,buildLog){return select(segments,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],buildLog)}},buildLog=!1,epsilon=function Epsilon(eps){"number"!=typeof eps&&(eps=1e-10);var my={epsilon:function(v){return"number"==typeof v&&(eps=v),eps},pointAboveOrOnLine:function(pt,left,right){var Ax=left[0],Ay=left[1],Bx=right[0],By=right[1],Cx=pt[0];return(Bx-Ax)*(pt[1]-Ay)-(By-Ay)*(Cx-Ax)>=-eps},pointBetween:function(p,left,right){var d_py_ly=p[1]-left[1],d_rx_lx=right[0]-left[0],d_px_lx=p[0]-left[0],d_ry_ly=right[1]-left[1],dot=d_px_lx*d_rx_lx+d_py_ly*d_ry_ly;return!(dot<eps||dot-(d_rx_lx*d_rx_lx+d_ry_ly*d_ry_ly)>-eps)},pointsSameX:function(p1,p2){return Math.abs(p1[0]-p2[0])<eps},pointsSameY:function(p1,p2){return Math.abs(p1[1]-p2[1])<eps},pointsSame:function(p1,p2){return my.pointsSameX(p1,p2)&&my.pointsSameY(p1,p2)},pointsCompare:function(p1,p2){return my.pointsSameX(p1,p2)?my.pointsSameY(p1,p2)?0:p1[1]<p2[1]?-1:1:p1[0]<p2[0]?-1:1},pointsCollinear:function(pt1,pt2,pt3){var dx1=pt1[0]-pt2[0],dy1=pt1[1]-pt2[1],dx2=pt2[0]-pt3[0],dy2=pt2[1]-pt3[1];return Math.abs(dx1*dy2-dx2*dy1)<eps},linesIntersect:function(a0,a1,b0,b1){var adx=a1[0]-a0[0],ady=a1[1]-a0[1],bdx=b1[0]-b0[0],bdy=b1[1]-b0[1],axb=adx*bdy-ady*bdx;if(Math.abs(axb)<eps)return!1;var dx=a0[0]-b0[0],dy=a0[1]-b0[1],A=(bdx*dy-bdy*dx)/axb,B=(adx*dy-ady*dx)/axb,ret={alongA:0,alongB:0,pt:[a0[0]+A*adx,a0[1]+A*ady]};return ret.alongA=A<=-eps?-2:A<eps?-1:A-1<=-eps?0:A-1<eps?1:2,ret.alongB=B<=-eps?-2:B<eps?-1:B-1<=-eps?0:B-1<eps?1:2,ret},pointInsideRegion:function(pt,region){for(var x=pt[0],y=pt[1],last_x=region[region.length-1][0],last_y=region[region.length-1][1],inside=!1,i=0;i<region.length;i++){var curr_x=region[i][0],curr_y=region[i][1];curr_y-y>eps!=last_y-y>eps&&(last_x-curr_x)*(y-curr_y)/(last_y-curr_y)+curr_x-x>eps&&(inside=!inside),last_x=curr_x,last_y=curr_y}return inside}};return my}();function operate(poly1,poly2,selector){var seg1=PolyBool.segments(poly1),seg2=PolyBool.segments(poly2),seg3=selector(PolyBool.combine(seg1,seg2));return PolyBool.polygon(seg3)}PolyBool={buildLog:function(bl){return!0===bl?buildLog=_$BuildLog_296():!1===bl&&(buildLog=!1),!1!==buildLog&&buildLog.list},epsilon:function(v){return epsilon.epsilon(v)},segments:function(poly){var i=_$Intersecter_299(!0,epsilon,buildLog);return poly.regions.forEach(i.addRegion),{segments:i.calculate(poly.inverted),inverted:poly.inverted}},combine:function(segments1,segments2){return{combined:_$Intersecter_299(!1,epsilon,buildLog).calculate(segments1.segments,segments1.inverted,segments2.segments,segments2.inverted),inverted1:segments1.inverted,inverted2:segments2.inverted}},selectUnion:function(combined){return{segments:_$SegmentSelector_302.union(combined.combined,buildLog),inverted:combined.inverted1||combined.inverted2}},selectIntersect:function(combined){return{segments:_$SegmentSelector_302.intersect(combined.combined,buildLog),inverted:combined.inverted1&&combined.inverted2}},selectDifference:function(combined){return{segments:_$SegmentSelector_302.difference(combined.combined,buildLog),inverted:combined.inverted1&&!combined.inverted2}},selectDifferenceRev:function(combined){return{segments:_$SegmentSelector_302.differenceRev(combined.combined,buildLog),inverted:!combined.inverted1&&combined.inverted2}},selectXor:function(combined){return{segments:_$SegmentSelector_302.xor(combined.combined,buildLog),inverted:combined.inverted1!==combined.inverted2}},polygon:function(segments){return{regions:_$SegmentChainer_301(segments.segments,epsilon,buildLog),inverted:segments.inverted}},polygonFromGeoJSON:function(geojson){return _$GeoJSON_298.toPolygon(PolyBool,geojson)},polygonToGeoJSON:function(poly){return _$GeoJSON_298.fromPolygon(PolyBool,epsilon,poly)},union:function(poly1,poly2){return operate(poly1,poly2,PolyBool.selectUnion)},intersect:function(poly1,poly2){return operate(poly1,poly2,PolyBool.selectIntersect)},difference:function(poly1,poly2){return operate(poly1,poly2,PolyBool.selectDifference)},differenceRev:function(poly1,poly2){return operate(poly1,poly2,PolyBool.selectDifferenceRev)},xor:function(poly1,poly2){return operate(poly1,poly2,PolyBool.selectXor)}},"object"==typeof window&&(window.PolyBool=PolyBool);var _$PolyBool_295=PolyBool,_$polygon_551={},dot=_$matrix_545.dot,__BADNUM_551=_$numerical_517.BADNUM,polygon=_$polygon_551={};polygon.tester=function tester(ptsIn){if(Array.isArray(ptsIn[0][0]))return polygon.multitester(ptsIn);var i,pts=ptsIn.slice(),xmin=pts[0][0],xmax=xmin,ymin=pts[0][1],ymax=ymin;for(pts.push(pts[0]),i=1;i<pts.length;i++)xmin=Math.min(xmin,pts[i][0]),xmax=Math.max(xmax,pts[i][0]),ymin=Math.min(ymin,pts[i][1]),ymax=Math.max(ymax,pts[i][1]);var rectFirstEdgeTest,isRect=!1;5===pts.length&&(pts[0][0]===pts[1][0]?pts[2][0]===pts[3][0]&&pts[0][1]===pts[3][1]&&pts[1][1]===pts[2][1]&&(isRect=!0,rectFirstEdgeTest=function(pt){return pt[0]===pts[0][0]}):pts[0][1]===pts[1][1]&&pts[2][1]===pts[3][1]&&pts[0][0]===pts[3][0]&&pts[1][0]===pts[2][0]&&(isRect=!0,rectFirstEdgeTest=function(pt){return pt[1]===pts[0][1]}));var degenerate=!0,lastPt=pts[0];for(i=1;i<pts.length;i++)if(lastPt[0]!==pts[i][0]||lastPt[1]!==pts[i][1]){degenerate=!1;break}return{xmin:xmin,xmax:xmax,ymin:ymin,ymax:ymax,pts:pts,contains:isRect?function rectContains(pt,omitFirstEdge){var x=pt[0],y=pt[1];return!(x===__BADNUM_551||x<xmin||x>xmax||y===__BADNUM_551||y<ymin||y>ymax||omitFirstEdge&&rectFirstEdgeTest(pt))}:function contains(pt,omitFirstEdge){var x=pt[0],y=pt[1];if(x===__BADNUM_551||x<xmin||x>xmax||y===__BADNUM_551||y<ymin||y>ymax)return!1;var i,x0,y0,xmini,ycross,imax=pts.length,x1=pts[0][0],y1=pts[0][1],crossings=0;for(i=1;i<imax;i++)if(x0=x1,y0=y1,x1=pts[i][0],y1=pts[i][1],!(x<(xmini=Math.min(x0,x1))||x>Math.max(x0,x1)||y>Math.max(y0,y1)))if(y<Math.min(y0,y1))x!==xmini&&crossings++;else{if(y===(ycross=x1===x0?y:y0+(x-x0)*(y1-y0)/(x1-x0)))return 1!==i||!omitFirstEdge;y<=ycross&&x!==xmini&&crossings++}return crossings%2==1},isRect:isRect,degenerate:degenerate}},polygon.multitester=function multitester(list){for(var testers=[],xmin=list[0][0][0],xmax=xmin,ymin=list[0][0][1],ymax=ymin,i=0;i<list.length;i++){var tester=polygon.tester(list[i]);tester.subtract=list[i].subtract,testers.push(tester),xmin=Math.min(xmin,tester.xmin),xmax=Math.max(xmax,tester.xmax),ymin=Math.min(ymin,tester.ymin),ymax=Math.max(ymax,tester.ymax)}return{xmin:xmin,xmax:xmax,ymin:ymin,ymax:ymax,pts:[],contains:function contains(pt,arg){for(var yes=!1,i=0;i<testers.length;i++)testers[i].contains(pt,arg)&&(yes=!1===testers[i].subtract);return yes},isRect:!1,degenerate:!1}};var isBent=polygon.isSegmentBent=function isBent(pts,start,end,tolerance){var i,part,partParallel,startPt=pts[start],segment=[pts[end][0]-startPt[0],pts[end][1]-startPt[1]],segmentSquared=dot(segment,segment),segmentLen=Math.sqrt(segmentSquared),unitPerp=[-segment[1]/segmentLen,segment[0]/segmentLen];for(i=start+1;i<end;i++)if(part=[pts[i][0]-startPt[0],pts[i][1]-startPt[1]],(partParallel=dot(part,segment))<0||partParallel>segmentSquared||Math.abs(dot(part,unitPerp))>tolerance)return!0;return!1};polygon.filter=function filter(pts,tolerance){var ptsFiltered=[pts[0]],doneRawIndex=0,doneFilteredIndex=0;function addPt(pt){pts.push(pt);var prevFilterLen=ptsFiltered.length,iLast=doneRawIndex;ptsFiltered.splice(doneFilteredIndex+1);for(var i=iLast+1;i<pts.length;i++)(i===pts.length-1||isBent(pts,iLast,i+1,tolerance))&&(ptsFiltered.push(pts[i]),ptsFiltered.length<prevFilterLen-2&&(doneRawIndex=i,doneFilteredIndex=ptsFiltered.length-1),iLast=i)}pts.length>1&&addPt(pts.pop());return{addPt:addPt,raw:pts,filtered:ptsFiltered}};var makeEventData=_$helpers_450.makeEventData,filteredPolygon=_$polygon_551.filter,polygonTester=_$polygon_551.tester,multipolygonTester=_$polygon_551.multitester,MINSELECT=_$constants_589.MINSELECT;function getAxId(ax){return ax._id}var _$prepSelect_602=function prepSelect(e,startX,startY,dragOptions,mode){var filterPoly,testPoly,mergedPolygons,currentPolygon,gd=dragOptions.gd,fullLayout=gd._fullLayout,zoomLayer=fullLayout._zoomlayer,dragBBox=dragOptions.element.getBoundingClientRect(),plotinfo=dragOptions.plotinfo,xs=plotinfo.xaxis._offset,ys=plotinfo.yaxis._offset,x0=startX-dragBBox.left,y0=startY-dragBBox.top,x1=x0,y1=y0,path0="M"+x0+","+y0,pw=dragOptions.xaxes[0]._length,ph=dragOptions.yaxes[0]._length,xAxisIds=dragOptions.xaxes.map(getAxId),yAxisIds=dragOptions.yaxes.map(getAxId),allAxes=dragOptions.xaxes.concat(dragOptions.yaxes),subtract=e.altKey;(e.shiftKey||e.altKey)&&plotinfo.selection&&plotinfo.selection.polygons&&!dragOptions.polygons?(dragOptions.polygons=plotinfo.selection.polygons,dragOptions.mergedPolygons=plotinfo.selection.mergedPolygons):(!e.shiftKey&&!e.altKey||(e.shiftKey||e.altKey)&&!plotinfo.selection)&&(plotinfo.selection={},plotinfo.selection.polygons=dragOptions.polygons=[],plotinfo.selection.mergedPolygons=dragOptions.mergedPolygons=[]),"lasso"===mode&&(filterPoly=filteredPolygon([[x0,y0]],_$constants_589.BENDPX));var outlines=zoomLayer.selectAll("path.select-outline-"+plotinfo.id).data([1,2]);outlines.enter().append("path").attr("class",function(d){return"select-outline select-outline-"+d+" select-outline-"+plotinfo.id}).attr("transform","translate("+xs+", "+ys+")").attr("d",path0+"Z");var i,cd,trace,searchInfo,eventData,fillRangeItems,corners=zoomLayer.append("path").attr("class","zoombox-corners").style({fill:_$color_411.background,stroke:_$color_411.defaultLine,"stroke-width":1}).attr("transform","translate("+xs+", "+ys+")").attr("d","M0,0Z"),searchTraces=[],throttleID=fullLayout._uid+_$constants_589.SELECTID,selection=[];for(i=0;i<gd.calcdata.length;i++)if(!0===(trace=(cd=gd.calcdata[i])[0].trace).visible&&trace._module&&trace._module.selectPoints)if(dragOptions.subplot)trace.subplot!==dragOptions.subplot&&trace.geo!==dragOptions.subplot||searchTraces.push({selectPoints:trace._module.selectPoints,style:trace._module.style,cd:cd,xaxis:dragOptions.xaxes[0],yaxis:dragOptions.yaxes[0]});else{if(-1===xAxisIds.indexOf(trace.xaxis))continue;if(-1===yAxisIds.indexOf(trace.yaxis))continue;searchTraces.push({selectPoints:trace._module.selectPoints,style:trace._module.style,cd:cd,xaxis:_$axes_584.getFromId(gd,trace.xaxis),yaxis:_$axes_584.getFromId(gd,trace.yaxis)})}function axValue(ax){var index="y"===ax._id.charAt(0)?1:0;return function(v){return ax.p2d(v[index])}}function ascending(a,b){return a-b}fillRangeItems=plotinfo.fillRangeItems?plotinfo.fillRangeItems:"select"===mode?function(eventData,poly){var ranges=eventData.range={};for(i=0;i<allAxes.length;i++){var ax=allAxes[i],axLetter=ax._id.charAt(0);ranges[ax._id]=[ax.p2d(poly[axLetter+"min"]),ax.p2d(poly[axLetter+"max"])].sort(ascending)}}:function(eventData,poly,filterPoly){var dataPts=eventData.lassoPoints={};for(i=0;i<allAxes.length;i++){var ax=allAxes[i];dataPts[ax._id]=filterPoly.filtered.map(axValue(ax))}},dragOptions.moveFn=function(dx0,dy0){x1=Math.max(0,Math.min(pw,dx0+x0)),y1=Math.max(0,Math.min(ph,dy0+y0));var dx=Math.abs(x1-x0),dy=Math.abs(y1-y0);"select"===mode?dy<Math.min(.6*dx,MINSELECT)?((currentPolygon=[[x0,0],[x0,ph],[x1,ph],[x1,0]]).xmin=Math.min(x0,x1),currentPolygon.xmax=Math.max(x0,x1),currentPolygon.ymin=Math.min(0,ph),currentPolygon.ymax=Math.max(0,ph),corners.attr("d","M"+currentPolygon.xmin+","+(y0-MINSELECT)+"h-4v"+2*MINSELECT+"h4ZM"+(currentPolygon.xmax-1)+","+(y0-MINSELECT)+"h4v"+2*MINSELECT+"h-4Z")):dx<Math.min(.6*dy,MINSELECT)?((currentPolygon=[[0,y0],[0,y1],[pw,y1],[pw,y0]]).xmin=Math.min(0,pw),currentPolygon.xmax=Math.max(0,pw),currentPolygon.ymin=Math.min(y0,y1),currentPolygon.ymax=Math.max(y0,y1),corners.attr("d","M"+(x0-MINSELECT)+","+currentPolygon.ymin+"v-4h"+2*MINSELECT+"v4ZM"+(x0-MINSELECT)+","+(currentPolygon.ymax-1)+"v4h"+2*MINSELECT+"v-4Z")):((currentPolygon=[[x0,y0],[x0,y1],[x1,y1],[x1,y0]]).xmin=Math.min(x0,x1),currentPolygon.xmax=Math.max(x0,x1),currentPolygon.ymin=Math.min(y0,y1),currentPolygon.ymax=Math.max(y0,y1),corners.attr("d","M0,0Z")):"lasso"===mode&&(filterPoly.addPt([x1,y1]),currentPolygon=filterPoly.filtered),dragOptions.polygons&&dragOptions.polygons.length?(mergedPolygons=function mergePolygons(list,poly,subtract){if(subtract)return _$PolyBool_295.difference({regions:list,inverted:!1},{regions:[poly],inverted:!1}).regions;return _$PolyBool_295.union({regions:list,inverted:!1},{regions:[poly],inverted:!1}).regions}(dragOptions.mergedPolygons,currentPolygon,subtract),currentPolygon.subtract=subtract,testPoly=multipolygonTester(dragOptions.polygons.concat([currentPolygon]))):(mergedPolygons=[currentPolygon],testPoly=polygonTester(currentPolygon));var paths=[];for(i=0;i<mergedPolygons.length;i++){var ppts=mergedPolygons[i];paths.push(ppts.join("L")+"L"+ppts[0])}outlines.attr("d","M"+paths.join("M")+"Z"),_$throttle_563.throttle(throttleID,_$constants_589.SELECTDELAY,function(){selection=[];var thisSelection,traceSelection,traceSelections=[];for(i=0;i<searchTraces.length;i++)if(traceSelection=(searchInfo=searchTraces[i]).selectPoints(searchInfo,testPoly),traceSelections.push(traceSelection),thisSelection=fillSelectionItem(traceSelection,searchInfo),selection.length)for(var j=0;j<thisSelection.length;j++)selection.push(thisSelection[j]);else selection=thisSelection;updateSelectedState(gd,searchTraces,eventData={points:selection}),fillRangeItems(eventData,currentPolygon,filterPoly),dragOptions.gd.emit("plotly_selecting",eventData)})},dragOptions.clickFn=function(numClicks,evt){corners.remove(),_$throttle_563.done(throttleID).then(function(){if(_$throttle_563.clear(throttleID),2===numClicks){for(outlines.remove(),i=0;i<searchTraces.length;i++)(searchInfo=searchTraces[i]).selectPoints(searchInfo,!1);updateSelectedState(gd,searchTraces),gd.emit("plotly_deselect",null)}else gd.emit("plotly_selected",void 0);_$fx_453.click(gd,evt)})},dragOptions.doneFn=function(){corners.remove(),_$throttle_563.done(throttleID).then(function(){_$throttle_563.clear(throttleID),dragOptions.gd.emit("plotly_selected",eventData),currentPolygon&&dragOptions.polygons&&(currentPolygon.subtract=subtract,dragOptions.polygons.push(currentPolygon),dragOptions.mergedPolygons.length=0,[].push.apply(dragOptions.mergedPolygons,mergedPolygons))})}};function updateSelectedState(gd,searchTraces,eventData){var i,searchInfo,trace;if(eventData){var pts=eventData.points||[];for(i=0;i<searchTraces.length;i++)(trace=searchTraces[i].cd[0].trace).selectedpoints=[],trace._input.selectedpoints=[];for(i=0;i<pts.length;i++){var pt=pts[i],data=pt.data,fullData=pt.fullData;pt.pointIndices?([].push.apply(data.selectedpoints,pt.pointIndices),[].push.apply(fullData.selectedpoints,pt.pointIndices)):(data.selectedpoints.push(pt.pointIndex),fullData.selectedpoints.push(pt.pointIndex))}}else for(i=0;i<searchTraces.length;i++)delete(trace=searchTraces[i].cd[0].trace).selectedpoints,delete trace._input.selectedpoints,searchTraces[i].cd[0].t&&searchTraces[i].cd[0].t.scene&&searchTraces[i].cd[0].t.scene.clearSelect();for(i=0;i<searchTraces.length;i++)(searchInfo=searchTraces[i]).style&&searchInfo.style(gd,searchInfo.cd)}function fillSelectionItem(selection,searchInfo){if(Array.isArray(selection))for(var cd=searchInfo.cd,trace=searchInfo.cd[0].trace,i=0;i<selection.length;i++)selection[i]=makeEventData(selection[i],trace,cd);return selection}var _$addProjectionsToD3_619=function addProjectionsToD3(d3){function d3_geo_projectFeature(object,stream){return{type:"Feature",id:object.id,properties:object.properties,geometry:d3_geo_projectGeometry(object.geometry,stream)}}function d3_geo_projectGeometry(geometry,stream){if(!geometry)return null;if("GeometryCollection"===geometry.type)return{type:"GeometryCollection",geometries:object.geometries.map(function(geometry){return d3_geo_projectGeometry(geometry,stream)})};if(!d3_geo_projectGeometryType.hasOwnProperty(geometry.type))return null;var sink=d3_geo_projectGeometryType[geometry.type];return d3.geo.stream(geometry,stream(sink)),sink.result()}d3.geo.project=function(object,projection){var stream=projection.stream;if(!stream)throw new Error("not yet supported");return(object&&d3_geo_projectObjectType.hasOwnProperty(object.type)?d3_geo_projectObjectType[object.type]:d3_geo_projectGeometry)(object,stream)};var d3_geo_projectObjectType={Feature:d3_geo_projectFeature,FeatureCollection:function(object,stream){return{type:"FeatureCollection",features:object.features.map(function(feature){return d3_geo_projectFeature(feature,stream)})}}},d3_geo_projectPoints=[],d3_geo_projectLines=[],d3_geo_projectPoint={point:function(x,y){d3_geo_projectPoints.push([x,y])},result:function(){var result=d3_geo_projectPoints.length?d3_geo_projectPoints.length<2?{type:"Point",coordinates:d3_geo_projectPoints[0]}:{type:"MultiPoint",coordinates:d3_geo_projectPoints}:null;return d3_geo_projectPoints=[],result}},d3_geo_projectLine={lineStart:d3_geo_projectNoop,point:function(x,y){d3_geo_projectPoints.push([x,y])},lineEnd:function(){d3_geo_projectPoints.length&&(d3_geo_projectLines.push(d3_geo_projectPoints),d3_geo_projectPoints=[])},result:function(){var result=d3_geo_projectLines.length?d3_geo_projectLines.length<2?{type:"LineString",coordinates:d3_geo_projectLines[0]}:{type:"MultiLineString",coordinates:d3_geo_projectLines}:null;return d3_geo_projectLines=[],result}},d3_geo_projectPolygon={polygonStart:d3_geo_projectNoop,lineStart:d3_geo_projectNoop,point:function(x,y){d3_geo_projectPoints.push([x,y])},lineEnd:function(){var n=d3_geo_projectPoints.length;if(n){do{d3_geo_projectPoints.push(d3_geo_projectPoints[0].slice())}while(++n<4);d3_geo_projectLines.push(d3_geo_projectPoints),d3_geo_projectPoints=[]}},polygonEnd:d3_geo_projectNoop,result:function(){if(!d3_geo_projectLines.length)return null;var polygons=[],holes=[];return d3_geo_projectLines.forEach(function(ring){!function d3_geo_projectClockwise(ring){if((n=ring.length)<4)return!1;for(var n,i=0,area=ring[n-1][1]*ring[0][0]-ring[n-1][0]*ring[0][1];++i<n;)area+=ring[i-1][1]*ring[i][0]-ring[i-1][0]*ring[i][1];return area<=0}(ring)?holes.push(ring):polygons.push([ring])}),holes.forEach(function(hole){var point=hole[0];polygons.some(function(polygon){if(function d3_geo_projectContains(ring,point){for(var x=point[0],y=point[1],contains=!1,i=0,n=ring.length,j=n-1;i<n;j=i++){var pi=ring[i],xi=pi[0],yi=pi[1],pj=ring[j],xj=pj[0],yj=pj[1];yi>y^yj>y&&x<(xj-xi)*(y-yi)/(yj-yi)+xi&&(contains=!contains)}return contains}(polygon[0],point))return polygon.push(hole),!0})||polygons.push([hole])}),d3_geo_projectLines=[],polygons.length?polygons.length>1?{type:"MultiPolygon",coordinates:polygons}:{type:"Polygon",coordinates:polygons[0]}:null}},d3_geo_projectGeometryType={Point:d3_geo_projectPoint,MultiPoint:d3_geo_projectPoint,LineString:d3_geo_projectLine,MultiLineString:d3_geo_projectLine,Polygon:d3_geo_projectPolygon,MultiPolygon:d3_geo_projectPolygon,Sphere:d3_geo_projectPolygon};function d3_geo_projectNoop(){}var ε=1e-6,ε2=ε*ε,π=Math.PI,halfπ=π/2,radians=(Math.sqrt(π),π/180),degrees=180/π;function asin(x){return x>1?halfπ:x<-1?-halfπ:Math.asin(x)}function acos(x){return x>1?0:x<-1?π:Math.acos(x)}var projection=d3.geo.projection,projectionMutator=d3.geo.projectionMutator;function eckert4(λ,φ){var k=(2+halfπ)*Math.sin(φ);φ/=2;for(var i=0,δ=1/0;i<10&&Math.abs(δ)>ε;i++){var cosφ=Math.cos(φ);φ-=δ=(φ+Math.sin(φ)*(cosφ+2)-k)/(2*cosφ*(1+cosφ))}return[2/Math.sqrt(π*(4+π))*λ*(1+Math.cos(φ)),2*Math.sqrt(π/(4+π))*Math.sin(φ)]}d3.geo.interrupt=function(project){var bounds,lobes=[[[[-π,0],[0,halfπ],[π,0]]],[[[-π,0],[0,-halfπ],[π,0]]]];function forward(λ,φ){for(var sign=φ<0?-1:1,hemilobes=lobes[+(φ<0)],i=0,n=hemilobes.length-1;i<n&&λ>hemilobes[i][2][0];++i);var coordinates=project(λ-hemilobes[i][1][0],φ);return coordinates[0]+=project(hemilobes[i][1][0],sign*φ>sign*hemilobes[i][0][1]?hemilobes[i][0][1]:φ)[0],coordinates}project.invert&&(forward.invert=function(x,y){for(var hemibounds=bounds[+(y<0)],hemilobes=lobes[+(y<0)],i=0,n=hemibounds.length;i<n;++i){var b=hemibounds[i];if(b[0][0]<=x&&x<b[1][0]&&b[0][1]<=y&&y<b[1][1]){var coordinates=project.invert(x-project(hemilobes[i][1][0],0)[0],y);return coordinates[0]+=hemilobes[i][1][0],pointEqual(forward(coordinates[0],coordinates[1]),[x,y])?coordinates:null}}});var projection=d3.geo.projection(forward),stream_=projection.stream;function resample(coordinates,m){for(var p1,dx,dy,i=-1,n=coordinates.length,p0=coordinates[0],resampled=[];++i<n;){dx=((p1=coordinates[i])[0]-p0[0])/m,dy=(p1[1]-p0[1])/m;for(var j=0;j<m;++j)resampled.push([p0[0]+j*dx,p0[1]+j*dy]);p0=p1}return resampled.push(p1),resampled}function pointEqual(a,b){return Math.abs(a[0]-b[0])<ε&&Math.abs(a[1]-b[1])<ε}return projection.stream=function(stream){var rotate=projection.rotate(),rotateStream=stream_(stream),sphereStream=(projection.rotate([0,0]),stream_(stream));return projection.rotate(rotate),rotateStream.sphere=function(){d3.geo.stream(function sphere(){for(var ε=1e-6,coordinates=[],i=0,n=lobes[0].length;i<n;++i){var lobe=lobes[0][i],λ0=180*lobe[0][0]/π,φ0=180*lobe[0][1]/π,φ1=180*lobe[1][1]/π,λ2=180*lobe[2][0]/π,φ2=180*lobe[2][1]/π;coordinates.push(resample([[λ0+ε,φ0+ε],[λ0+ε,φ1-ε],[λ2-ε,φ1-ε],[λ2-ε,φ2+ε]],30))}for(var i=lobes[1].length-1;i>=0;--i){var lobe=lobes[1][i],λ0=180*lobe[0][0]/π,φ0=180*lobe[0][1]/π,φ1=180*lobe[1][1]/π,λ2=180*lobe[2][0]/π,φ2=180*lobe[2][1]/π;coordinates.push(resample([[λ2-ε,φ2-ε],[λ2-ε,φ1+ε],[λ0+ε,φ1+ε],[λ0+ε,φ0-ε]],30))}return{type:"Polygon",coordinates:[d3.merge(coordinates)]}}(),sphereStream)},rotateStream},projection.lobes=function(_){return arguments.length?(lobes=_.map(function(lobes){return lobes.map(function(lobe){return[[lobe[0][0]*π/180,lobe[0][1]*π/180],[lobe[1][0]*π/180,lobe[1][1]*π/180],[lobe[2][0]*π/180,lobe[2][1]*π/180]]})}),function reset(){bounds=lobes.map(function(hemilobes){return hemilobes.map(function(lobe){var t,x0=project(lobe[0][0],lobe[0][1])[0],x1=project(lobe[2][0],lobe[2][1])[0],y0=project(lobe[1][0],lobe[0][1])[1],y1=project(lobe[1][0],lobe[1][1])[1];return y0>y1&&(t=y0,y0=y1,y1=t),[[x0,y0],[x1,y1]]})})}(),projection):lobes.map(function(lobes){return lobes.map(function(lobe){return[[180*lobe[0][0]/π,180*lobe[0][1]/π],[180*lobe[1][0]/π,180*lobe[1][1]/π],[180*lobe[2][0]/π,180*lobe[2][1]/π]]})})},projection},eckert4.invert=function(x,y){var A=.5*y*Math.sqrt((4+π)/π),k=asin(A),c=Math.cos(k);return[x/(2/Math.sqrt(π*(4+π))*(1+c)),asin((k+A*(c+2))/(2+halfπ))]},(d3.geo.eckert4=function(){return projection(eckert4)}).raw=eckert4;var hammerAzimuthalEqualArea=d3.geo.azimuthalEqualArea.raw;function hammer(A,B){if(arguments.length<2&&(B=A),1===B)return hammerAzimuthalEqualArea;if(B===1/0)return hammerQuarticAuthalic;function forward(λ,φ){var coordinates=hammerAzimuthalEqualArea(λ/B,φ);return coordinates[0]*=A,coordinates}return forward.invert=function(x,y){var coordinates=hammerAzimuthalEqualArea.invert(x/A,y);return coordinates[0]*=B,coordinates},forward}function hammerQuarticAuthalic(λ,φ){return[λ*Math.cos(φ)/Math.cos(φ/=2),2*Math.sin(φ)]}function kavrayskiy7(λ,φ){return[3*λ/(2*π)*Math.sqrt(π*π/3-φ*φ),φ]}function miller(λ,φ){return[λ,1.25*Math.log(Math.tan(π/4+.4*φ))]}function mollweideBromleyθ(Cp){return function(θ){var δ,Cpsinθ=Cp*Math.sin(θ),i=30;do{θ-=δ=(θ+Math.sin(θ)-Cpsinθ)/(1+Math.cos(θ))}while(Math.abs(δ)>ε&&--i>0);return θ/2}}hammerQuarticAuthalic.invert=function(x,y){var φ=2*asin(y/2);return[x*Math.cos(φ/2)/Math.cos(φ),φ]},(d3.geo.hammer=function hammerProjection(){var B=2,m=projectionMutator(hammer),p=m(B);return p.coefficient=function(_){return arguments.length?m(B=+_):B},p}).raw=hammer,kavrayskiy7.invert=function(x,y){return[2/3*π*x/Math.sqrt(π*π/3-y*y),y]},(d3.geo.kavrayskiy7=function(){return projection(kavrayskiy7)}).raw=kavrayskiy7,miller.invert=function(x,y){return[x,2.5*Math.atan(Math.exp(.8*y))-.625*π]},(d3.geo.miller=function(){return projection(miller)}).raw=miller,mollweideBromleyθ(π);var mollweide=function mollweideBromley(Cx,Cy,Cp){var θ=mollweideBromleyθ(Cp);function forward(λ,φ){return[Cx*λ*Math.cos(φ=θ(φ)),Cy*Math.sin(φ)]}return forward.invert=function(x,y){var θ=asin(y/Cy);return[x/(Cx*Math.cos(θ)),asin((2*θ+Math.sin(2*θ))/Cp)]},forward}(Math.SQRT2/halfπ,Math.SQRT2,π);function naturalEarth(λ,φ){var φ2=φ*φ,φ4=φ2*φ2;return[λ*(.8707-.131979*φ2+φ4*(φ4*(.003971*φ2-.001529*φ4)-.013791)),φ*(1.007226+φ2*(.015085+φ4*(.028874*φ2-.044475-.005916*φ4)))]}(d3.geo.mollweide=function(){return projection(mollweide)}).raw=mollweide,naturalEarth.invert=function(x,y){var δ,φ=y,i=25;do{var φ2=φ*φ,φ4=φ2*φ2;φ-=δ=(φ*(1.007226+φ2*(.015085+φ4*(.028874*φ2-.044475-.005916*φ4)))-y)/(1.007226+φ2*(.045255+φ4*(.259866*φ2-.311325-.005916*11*φ4)))}while(Math.abs(δ)>ε&&--i>0);return[x/(.8707+(φ2=φ*φ)*(φ2*(φ2*φ2*φ2*(.003971-.001529*φ2)-.013791)-.131979)),φ]},(d3.geo.naturalEarth=function(){return projection(naturalEarth)}).raw=naturalEarth;var robinsonConstants=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function robinson(λ,φ){var k,i=Math.min(18,36*Math.abs(φ)/π),i0=Math.floor(i),di=i-i0,ax=(k=robinsonConstants[i0])[0],ay=k[1],bx=(k=robinsonConstants[++i0])[0],by=k[1],cx=(k=robinsonConstants[Math.min(19,++i0)])[0],cy=k[1];return[λ*(bx+di*(cx-ax)/2+di*di*(cx-2*bx+ax)/2),(φ>0?halfπ:-halfπ)*(by+di*(cy-ay)/2+di*di*(cy-2*by+ay)/2)]}function sinusoidal(λ,φ){return[λ*Math.cos(φ),φ]}function aitoff(λ,φ){var cosφ=Math.cos(φ),sinciα=function sinci(x){return x?x/Math.sin(x):1}(acos(cosφ*Math.cos(λ/=2)));return[2*cosφ*Math.sin(λ)*sinciα,Math.sin(φ)*sinciα]}function winkel3(λ,φ){var coordinates=aitoff(λ,φ);return[(coordinates[0]+λ/halfπ)/2,(coordinates[1]+φ)/2]}robinsonConstants.forEach(function(d){d[1]*=1.0144}),robinson.invert=function(x,y){var yy=y/halfπ,φ=90*yy,i=Math.min(18,Math.abs(φ/5)),i0=Math.max(0,Math.floor(i));do{var ay=robinsonConstants[i0][1],by=robinsonConstants[i0+1][1],cy=robinsonConstants[Math.min(19,i0+2)][1],u=cy-ay,v=cy-2*by+ay,t=2*(Math.abs(yy)-by)/u,c=v/u,di=t*(1-c*t*(1-2*c*t));if(di>=0||1===i0){φ=(y>=0?5:-5)*(di+i);var δ,j=50;do{di=(i=Math.min(18,Math.abs(φ)/5))-(i0=Math.floor(i)),ay=robinsonConstants[i0][1],by=robinsonConstants[i0+1][1],cy=robinsonConstants[Math.min(19,i0+2)][1],φ-=(δ=(y>=0?halfπ:-halfπ)*(by+di*(cy-ay)/2+di*di*(cy-2*by+ay)/2)-y)*degrees}while(Math.abs(δ)>ε2&&--j>0);break}}while(--i0>=0);var ax=robinsonConstants[i0][0],bx=robinsonConstants[i0+1][0],cx=robinsonConstants[Math.min(19,i0+2)][0];return[x/(bx+di*(cx-ax)/2+di*di*(cx-2*bx+ax)/2),φ*radians]},(d3.geo.robinson=function(){return projection(robinson)}).raw=robinson,sinusoidal.invert=function(x,y){return[x/Math.cos(y),y]},(d3.geo.sinusoidal=function(){return projection(sinusoidal)}).raw=sinusoidal,aitoff.invert=function(x,y){if(!(x*x+4*y*y>π*π+ε)){var λ=x,φ=y,i=25;do{var F,sinλ=Math.sin(λ),sinλ_2=Math.sin(λ/2),cosλ_2=Math.cos(λ/2),sinφ=Math.sin(φ),cosφ=Math.cos(φ),sin_2φ=Math.sin(2*φ),sin2φ=sinφ*sinφ,cos2φ=cosφ*cosφ,sin2λ_2=sinλ_2*sinλ_2,C=1-cos2φ*cosλ_2*cosλ_2,E=C?acos(cosφ*cosλ_2)*Math.sqrt(F=1/C):F=0,fx=2*E*cosφ*sinλ_2-x,fy=E*sinφ-y,δxδλ=F*(cos2φ*sin2λ_2+E*cosφ*cosλ_2*sin2φ),δxδφ=F*(.5*sinλ*sin_2φ-2*E*sinφ*sinλ_2),δyδλ=.25*F*(sin_2φ*sinλ_2-E*sinφ*cos2φ*sinλ),δyδφ=F*(sin2φ*cosλ_2+E*sin2λ_2*cosφ),denominator=δxδφ*δyδλ-δyδφ*δxδλ;if(!denominator)break;var δλ=(fy*δxδφ-fx*δyδφ)/denominator,δφ=(fx*δyδλ-fy*δxδλ)/denominator;λ-=δλ,φ-=δφ}while((Math.abs(δλ)>ε||Math.abs(δφ)>ε)&&--i>0);return[λ,φ]}},(d3.geo.aitoff=function(){return projection(aitoff)}).raw=aitoff,winkel3.invert=function(x,y){var λ=x,φ=y,i=25;do{var F,cosφ=Math.cos(φ),sinφ=Math.sin(φ),sin_2φ=Math.sin(2*φ),sin2φ=sinφ*sinφ,cos2φ=cosφ*cosφ,sinλ=Math.sin(λ),cosλ_2=Math.cos(λ/2),sinλ_2=Math.sin(λ/2),sin2λ_2=sinλ_2*sinλ_2,C=1-cos2φ*cosλ_2*cosλ_2,E=C?acos(cosφ*cosλ_2)*Math.sqrt(F=1/C):F=0,fx=.5*(2*E*cosφ*sinλ_2+λ/halfπ)-x,fy=.5*(E*sinφ+φ)-y,δxδλ=.5*F*(cos2φ*sin2λ_2+E*cosφ*cosλ_2*sin2φ)+.5/halfπ,δxδφ=F*(sinλ*sin_2φ/4-E*sinφ*sinλ_2),δyδλ=.125*F*(sin_2φ*sinλ_2-E*sinφ*cos2φ*sinλ),δyδφ=.5*F*(sin2φ*cosλ_2+E*sin2λ_2*cosφ)+.5,denominator=δxδφ*δyδλ-δyδφ*δxδλ,δλ=(fy*δxδφ-fx*δyδφ)/denominator,δφ=(fx*δyδλ-fy*δxδλ)/denominator;λ-=δλ,φ-=δφ}while((Math.abs(δλ)>ε||Math.abs(δφ)>ε)&&--i>0);return[λ,φ]},(d3.geo.winkel3=function(){return projection(winkel3)}).raw=winkel3},radians=Math.PI/180,degrees=180/Math.PI,zoomstartStyle={cursor:"pointer"},zoomendStyle={cursor:"auto"};var _$createGeoZoom_620=function createGeoZoom(geo,geoLayout){var projection=geo.projection;return(geoLayout._isScoped?zoomScoped:geoLayout._isClipped?zoomClipped:zoomNonClipped)(geo,projection)};function initZoom(geo,projection){return _$d3_127.behavior.zoom().translate(projection.translate()).scale(projection.scale())}function sync(geo,projection,cb){var id=geo.id,gd=geo.graphDiv,userOpts=gd.layout[id],fullOpts=gd._fullLayout[id],eventData={};function set(propStr,val){var fullNp=_$lib_539.nestedProperty(fullOpts,propStr);fullNp.get()!==val&&(fullNp.set(val),_$lib_539.nestedProperty(userOpts,propStr).set(val),eventData[id+"."+propStr]=val)}cb(set),set("projection.scale",projection.scale()/geo.fitScale),gd.emit("plotly_relayout",eventData)}function zoomScoped(geo,projection){var zoom=initZoom(0,projection);function syncCb(set){var center=projection.invert(geo.midPt);set("center.lon",center[0]),set("center.lat",center[1])}return zoom.on("zoomstart",function handleZoomstart(){_$d3_127.select(this).style(zoomstartStyle)}).on("zoom",function handleZoom(){projection.scale(_$d3_127.event.scale).translate(_$d3_127.event.translate),geo.render()}).on("zoomend",function handleZoomend(){_$d3_127.select(this).style(zoomendStyle),sync(geo,projection,syncCb)}),zoom}function zoomNonClipped(geo,projection){var mouse0,rotate0,translate0,lastRotate,zoomPoint,mouse1,rotate1,point1,zoom=initZoom(0,projection),INSIDETOLORANCEPXS=2;function position(x){return projection.invert(x)}function syncCb(set){var rotate=projection.rotate(),center=projection.invert(geo.midPt);set("projection.rotation.lon",-rotate[0]),set("center.lon",center[0]),set("center.lat",center[1])}return zoom.on("zoomstart",function handleZoomstart(){_$d3_127.select(this).style(zoomstartStyle),mouse0=_$d3_127.mouse(this),rotate0=projection.rotate(),translate0=projection.translate(),lastRotate=rotate0,zoomPoint=position(mouse0)}).on("zoom",function handleZoom(){if(mouse1=_$d3_127.mouse(this),function outside(x){var pt=projection(position(x));return Math.abs(pt[0]-x[0])>INSIDETOLORANCEPXS||Math.abs(pt[1]-x[1])>INSIDETOLORANCEPXS}(mouse0))return zoom.scale(projection.scale()),void zoom.translate(projection.translate());projection.scale(_$d3_127.event.scale),projection.translate([translate0[0],_$d3_127.event.translate[1]]),zoomPoint?position(mouse1)&&(point1=position(mouse1),rotate1=[lastRotate[0]+(point1[0]-zoomPoint[0]),rotate0[1],rotate0[2]],projection.rotate(rotate1),lastRotate=rotate1):zoomPoint=position(mouse0=mouse1),geo.render()}).on("zoomend",function handleZoomend(){_$d3_127.select(this).style(zoomendStyle),sync(geo,projection,syncCb)}),zoom}function zoomClipped(geo,projection){var zoomPoint,view={r:projection.rotate(),k:projection.scale()},zoom=initZoom(0,projection),event=function d3_eventDispatch(target){var i=0,n=arguments.length,argumentz=[];for(;++i<n;)argumentz.push(arguments[i]);var dispatch=_$d3_127.dispatch.apply(null,argumentz);return dispatch.of=function(thiz,argumentz){return function(e1){var e0;try{e0=e1.sourceEvent=_$d3_127.event,e1.target=target,_$d3_127.event=e1,dispatch[e1.type].apply(thiz,argumentz)}finally{_$d3_127.event=e0}}},dispatch}(zoom,"zoomstart","zoom","zoomend"),zooming=0,zoomOn=zoom.on;function syncCb(set){var _rotate=projection.rotate();set("projection.rotation.lon",-_rotate[0]),set("projection.rotation.lat",-_rotate[1])}return zoom.on("zoomstart",function(){_$d3_127.select(this).style(zoomstartStyle);var mouse0=_$d3_127.mouse(this),rotate0=projection.rotate(),lastRotate=rotate0,translate0=projection.translate(),q=function quaternionFromEuler(euler){var lambda=.5*euler[0]*radians,phi=.5*euler[1]*radians,gamma=.5*euler[2]*radians,sinLambda=Math.sin(lambda),cosLambda=Math.cos(lambda),sinPhi=Math.sin(phi),cosPhi=Math.cos(phi),sinGamma=Math.sin(gamma),cosGamma=Math.cos(gamma);return[cosLambda*cosPhi*cosGamma+sinLambda*sinPhi*sinGamma,sinLambda*cosPhi*cosGamma-cosLambda*sinPhi*sinGamma,cosLambda*sinPhi*cosGamma+sinLambda*cosPhi*sinGamma,cosLambda*cosPhi*sinGamma-sinLambda*sinPhi*cosGamma]}(rotate0);zoomPoint=position(projection,mouse0),zoomOn.call(zoom,"zoom",function(){var mouse1=_$d3_127.mouse(this);if(projection.scale(view.k=_$d3_127.event.scale),zoomPoint){if(position(projection,mouse1)){projection.rotate(rotate0).translate(translate0);var point1=position(projection,mouse1),between=function rotateBetween(a,b){if(!a||!b)return;var axis=function cross(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}(a,b),norm=Math.sqrt(__dot_620(axis,axis)),halfgamma=.5*Math.acos(Math.max(-1,Math.min(1,__dot_620(a,b)))),k=Math.sin(halfgamma)/norm;return norm&&[Math.cos(halfgamma),axis[2]*k,-axis[1]*k,axis[0]*k]}(zoomPoint,point1),newEuler=function eulerFromQuaternion(q){return[Math.atan2(2*(q[0]*q[1]+q[2]*q[3]),1-2*(q[1]*q[1]+q[2]*q[2]))*degrees,Math.asin(Math.max(-1,Math.min(1,2*(q[0]*q[2]-q[3]*q[1]))))*degrees,Math.atan2(2*(q[0]*q[3]+q[1]*q[2]),1-2*(q[2]*q[2]+q[3]*q[3]))*degrees]}(function multiply(a,b){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],b0=b[0],b1=b[1],b2=b[2],b3=b[3];return[a0*b0-a1*b1-a2*b2-a3*b3,a0*b1+a1*b0+a2*b3-a3*b2,a0*b2-a1*b3+a2*b0+a3*b1,a0*b3+a1*b2-a2*b1+a3*b0]}(q,between)),rotateAngles=view.r=function unRoll(rotateAngles,pt,lastRotate){var ptRotated=rotateCartesian(pt,2,rotateAngles[0]);ptRotated=rotateCartesian(ptRotated=rotateCartesian(ptRotated,1,rotateAngles[1]),0,rotateAngles[2]-lastRotate[2]);var b,newYaw1,x=pt[0],y=pt[1],z=pt[2],f=ptRotated[0],g=ptRotated[1],h=ptRotated[2],theta=Math.atan2(y,x)*degrees,a=Math.sqrt(x*x+y*y);Math.abs(g)>a?(newYaw1=(g>0?90:-90)-theta,b=0):(newYaw1=Math.asin(g/a)*degrees-theta,b=Math.sqrt(a*a-g*g));var newYaw2=180-newYaw1-2*theta,newPitch1=(Math.atan2(h,f)-Math.atan2(z,b))*degrees,newPitch2=(Math.atan2(h,f)-Math.atan2(z,-b))*degrees,dist1=angleDistance(lastRotate[0],lastRotate[1],newYaw1,newPitch1),dist2=angleDistance(lastRotate[0],lastRotate[1],newYaw2,newPitch2);return dist1<=dist2?[newYaw1,newPitch1,lastRotate[2]]:[newYaw2,newPitch2,lastRotate[2]]}(newEuler,zoomPoint,lastRotate);isFinite(rotateAngles[0])&&isFinite(rotateAngles[1])&&isFinite(rotateAngles[2])||(rotateAngles=lastRotate),projection.rotate(rotateAngles),lastRotate=rotateAngles}}else zoomPoint=position(projection,mouse0=mouse1);!function zoomed(dispatch){dispatch({type:"zoom"})}(event.of(this,arguments))}),function zoomstarted(dispatch){zooming++||dispatch({type:"zoomstart"})}(event.of(this,arguments))}).on("zoomend",function(){_$d3_127.select(this).style(zoomendStyle),zoomOn.call(zoom,"zoom",null),function zoomended(dispatch){--zooming||dispatch({type:"zoomend"})}(event.of(this,arguments)),sync(geo,projection,syncCb)}).on("zoom.redraw",function(){geo.render()}),_$d3_127.rebind(zoom,event,"on")}function position(projection,point){var spherical=projection.invert(point);return spherical&&isFinite(spherical[0])&&isFinite(spherical[1])&&function cartesian(spherical){var lambda=spherical[0]*radians,phi=spherical[1]*radians,cosPhi=Math.cos(phi);return[cosPhi*Math.cos(lambda),cosPhi*Math.sin(lambda),Math.sin(phi)]}(spherical)}function angleDistance(yaw0,pitch0,yaw1,pitch1){var dYaw=angleMod(yaw1-yaw0),dPitch=angleMod(pitch1-pitch0);return Math.sqrt(dYaw*dYaw+dPitch*dPitch)}function angleMod(angle){return(angle%360+540)%360-180}function rotateCartesian(vector,axis,angle){var angleRads=angle*radians,vectorOut=vector.slice(),ax1=0===axis?1:0,ax2=2===axis?1:2,cosa=Math.cos(angleRads),sina=Math.sin(angleRads);return vectorOut[ax1]=vector[ax1]*cosa-vector[ax2]*sina,vectorOut[ax2]=vector[ax2]*cosa+vector[ax1]*sina,vectorOut}function __dot_620(a,b){for(var s=0,i=0,n=a.length;i<n;++i)s+=a[i]*b[i];return s}var __topojsonFeature_614=_$topojsonClient_355.feature;function Geo(opts){this.id=opts.id,this.graphDiv=opts.graphDiv,this.container=opts.container,this.topojsonURL=opts.topojsonURL,this.isStatic=opts.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}_$addProjectionsToD3_619(_$d3_127);var proto=Geo.prototype,_$createGeo_614=function createGeo(opts){return new Geo(opts)};proto.plot=function(geoCalcData,fullLayout,promises){var _this=this,geoLayout=fullLayout[this.id],topojsonNameNew=_$topojson_utils_565.getTopojsonName(geoLayout);null===_this.topojson||topojsonNameNew!==_this.topojsonName?(_this.topojsonName=topojsonNameNew,void 0===PlotlyGeoAssets.topojson[_this.topojsonName]?promises.push(_this.fetchTopojson().then(function(topojson){PlotlyGeoAssets.topojson[_this.topojsonName]=topojson,_this.topojson=topojson,_this.update(geoCalcData,fullLayout)})):(_this.topojson=PlotlyGeoAssets.topojson[_this.topojsonName],_this.update(geoCalcData,fullLayout))):_this.update(geoCalcData,fullLayout)},proto.fetchTopojson=function(){var topojsonPath=_$topojson_utils_565.getTopojsonPath(this.topojsonURL,this.topojsonName);return new Promise(function(resolve,reject){_$d3_127.json(topojsonPath,function(err,topojson){if(err)return 404===err.status?reject(new Error(["plotly.js could not find topojson file at",topojsonPath,".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):reject(new Error(["unexpected error while fetching topojson file at",topojsonPath].join(" ")));resolve(topojson)})})},proto.update=function(geoCalcData,fullLayout){var geoLayout=fullLayout[this.id];if(!this.updateProjection(fullLayout,geoLayout)){this.hasChoropleth=!1;for(var i=0;i<geoCalcData.length;i++)if("choropleth"===geoCalcData[i][0].trace.type){this.hasChoropleth=!0;break}this.viewInitial||this.saveViewInitial(geoLayout),this.updateBaseLayers(fullLayout,geoLayout),this.updateDims(fullLayout,geoLayout),this.updateFx(fullLayout,geoLayout),_$plots_647.generalUpdatePerTraceModule(this.graphDiv,this,geoCalcData,geoLayout);var scatterLayer=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=scatterLayer.selectAll(".point"),this.dataPoints.text=scatterLayer.selectAll("text"),this.dataPaths.line=scatterLayer.selectAll(".js-line");var choroplethLayer=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=choroplethLayer.selectAll("path"),this.render()}},proto.updateProjection=function(fullLayout,geoLayout){var gs=fullLayout._size,domain=geoLayout.domain,projLayout=geoLayout.projection,rotation=projLayout.rotation||{},center=geoLayout.center||{},projection=this.projection=function getProjection(geoLayout){for(var projType=geoLayout.projection.type,projection=_$d3_127.geo[_$constants_613.projNames[projType]](),clipAngle=geoLayout._isClipped?_$constants_613.lonaxisSpan[projType]/2:null,methods=["center","rotate","parallels","clipExtent"],dummyFn=function(_){return _?projection:[]},i=0;i<methods.length;i++){var m=methods[i];"function"!=typeof projection[m]&&(projection[m]=dummyFn)}projection.isLonLatOverEdges=function(lonlat){if(null===projection(lonlat))return!0;if(clipAngle){var r=projection.rotate();return _$d3_127.geo.distance(lonlat,[-r[0],-r[1]])>clipAngle*Math.PI/180}return!1},projection.getPath=function(){return _$d3_127.geo.path().projection(projection)},projection.getBounds=function(object){return projection.getPath().bounds(object)},projection.fitExtent=function(extent,object){var w=extent[1][0]-extent[0][0],h=extent[1][1]-extent[0][1],clip=projection.clipExtent&&projection.clipExtent();projection.scale(150).translate([0,0]),clip&&projection.clipExtent(null);var b=projection.getBounds(object),k=Math.min(w/(b[1][0]-b[0][0]),h/(b[1][1]-b[0][1])),x=+extent[0][0]+(w-k*(b[1][0]+b[0][0]))/2,y=+extent[0][1]+(h-k*(b[1][1]+b[0][1]))/2;return clip&&projection.clipExtent(clip),projection.scale(150*k).translate([x,y])},projection.precision(_$constants_613.precision),clipAngle&&projection.clipAngle(clipAngle-_$constants_613.clipPad);return projection}(geoLayout);projection.center([center.lon-rotation.lon,center.lat-rotation.lat]).rotate([-rotation.lon,-rotation.lat,rotation.roll]).parallels(projLayout.parallels);var extent=[[gs.l+gs.w*domain.x[0],gs.t+gs.h*(1-domain.y[1])],[gs.l+gs.w*domain.x[1],gs.t+gs.h*(1-domain.y[0])]],lonaxis=geoLayout.lonaxis,lataxis=geoLayout.lataxis,rangeBox=function makeRangeBox(lon,lat){var clipPad=_$constants_613.clipPad,lon0=lon[0]+clipPad,lon1=lon[1]-clipPad,lat0=lat[0]+clipPad,lat1=lat[1]-clipPad;lon0>0&&lon1<0&&(lon1+=360);var dlon4=(lon1-lon0)/4;return{type:"Polygon",coordinates:[[[lon0,lat0],[lon0,lat1],[lon0+dlon4,lat1],[lon0+2*dlon4,lat1],[lon0+3*dlon4,lat1],[lon1,lat1],[lon1,lat0],[lon1-dlon4,lat0],[lon1-2*dlon4,lat0],[lon1-3*dlon4,lat0],[lon0,lat0]]]}}(lonaxis.range,lataxis.range);projection.fitExtent(extent,rangeBox);var b=this.bounds=projection.getBounds(rangeBox),s=this.fitScale=projection.scale(),t=projection.translate();if(!isFinite(b[0][0])||!isFinite(b[0][1])||!isFinite(b[1][0])||!isFinite(b[1][1])||isNaN(t[0])||isNaN(t[0])){for(var gd=this.graphDiv,attrToUnset=["projection.rotation","center","lonaxis.range","lataxis.range"],msg="Invalid geo settings, relayout'ing to default view.",updateObj={},i=0;i<attrToUnset.length;i++)updateObj[this.id+"."+attrToUnset[i]]=null;return this.viewInitial=null,_$lib_539.warn(msg),gd._promises.push(_$registry_668.call("relayout",gd,updateObj)),msg}var midPt=this.midPt=[(b[0][0]+b[1][0])/2,(b[0][1]+b[1][1])/2];if(projection.scale(projLayout.scale*s).translate([t[0]+(midPt[0]-t[0]),t[1]+(midPt[1]-t[1])]).clipExtent(b),geoLayout._isAlbersUsa){var centerPx=projection([center.lon,center.lat]),tt=projection.translate();projection.translate([tt[0]-(centerPx[0]-tt[0]),tt[1]-(centerPx[1]-tt[1])])}},proto.updateBaseLayers=function(fullLayout,geoLayout){var _this=this,topojson=_this.topojson,layers=_this.layers,basePaths=_this.basePaths;function isAxisLayer(d){return"lonaxis"===d||"lataxis"===d}function isLineLayer(d){return Boolean(_$constants_613.lineLayers[d])}function isFillLayer(d){return Boolean(_$constants_613.fillLayers[d])}var layerData=(this.hasChoropleth?_$constants_613.layersForChoropleth:_$constants_613.layers).filter(function(d){return isLineLayer(d)||isFillLayer(d)?geoLayout["show"+d]:!isAxisLayer(d)||geoLayout[d].showgrid}),join=_this.framework.selectAll(".layer").data(layerData,String);join.exit().each(function(d){delete layers[d],delete basePaths[d],_$d3_127.select(this).remove()}),join.enter().append("g").attr("class",function(d){return"layer "+d}).each(function(d){var layer=layers[d]=_$d3_127.select(this);"bg"===d?_this.bgRect=layer.append("rect").style("pointer-events","all"):isAxisLayer(d)?basePaths[d]=layer.append("path").style("fill","none"):"backplot"===d?layer.append("g").classed("choroplethlayer",!0):"frontplot"===d?layer.append("g").classed("scatterlayer",!0):isLineLayer(d)?basePaths[d]=layer.append("path").style("fill","none").style("stroke-miterlimit",2):isFillLayer(d)&&(basePaths[d]=layer.append("path").style("stroke","none"))}),join.order(),join.each(function(d){var path=basePaths[d],adj=_$constants_613.layerNameToAdjective[d];"frame"===d?path.datum(_$constants_613.sphereSVG):isLineLayer(d)||isFillLayer(d)?path.datum(__topojsonFeature_614(topojson,topojson.objects[d])):isAxisLayer(d)&&path.datum(function makeGraticule(axisName,geoLayout){var dtick=geoLayout[axisName].dtick,scopeDefaults=_$constants_613.scopeDefaults[geoLayout.scope],lonaxisRange=scopeDefaults.lonaxisRange,lataxisRange=scopeDefaults.lataxisRange,step="lonaxis"===axisName?[dtick]:[0,dtick];return _$d3_127.geo.graticule().extent([[lonaxisRange[0],lataxisRange[0]],[lonaxisRange[1],lataxisRange[1]]]).step(step)}(d,geoLayout)).call(_$color_411.stroke,geoLayout[d].gridcolor).call(_$drawing_436.dashLine,"",geoLayout[d].gridwidth),isLineLayer(d)?path.call(_$color_411.stroke,geoLayout[adj+"color"]).call(_$drawing_436.dashLine,"",geoLayout[adj+"width"]):isFillLayer(d)&&path.call(_$color_411.fill,geoLayout[adj+"color"])})},proto.updateDims=function(fullLayout,geoLayout){var b=this.bounds,hFrameWidth=(geoLayout.framewidth||0)/2,l=b[0][0]-hFrameWidth,t=b[0][1]-hFrameWidth,w=b[1][0]-l+hFrameWidth,h=b[1][1]-t+hFrameWidth;_$drawing_436.setRect(this.clipRect,l,t,w,h),this.bgRect.call(_$drawing_436.setRect,l,t,w,h).call(_$color_411.fill,geoLayout.bgcolor),this.xaxis._offset=l,this.xaxis._length=w,this.yaxis._offset=t,this.yaxis._length=h},proto.updateFx=function(fullLayout,geoLayout){var _this=this,gd=_this.graphDiv,bgRect=_this.bgRect,dragMode=fullLayout.dragmode;if(!_this.isStatic){if("pan"===dragMode)bgRect.node().onmousedown=null,bgRect.call(_$createGeoZoom_620(_this,geoLayout)),bgRect.on("dblclick.zoom",function zoomReset(){var viewInitial=_this.viewInitial,updateObj={};for(var k in viewInitial)updateObj[_this.id+"."+k]=viewInitial[k];_$registry_668.call("relayout",gd,updateObj),gd.emit("plotly_doubleclick",null)});else if("select"===dragMode||"lasso"===dragMode){var fillRangeItems;bgRect.on(".zoom",null),"select"===dragMode?fillRangeItems=function(eventData,poly){(eventData.range={})[_this.id]=[invert([poly.xmin,poly.ymin]),invert([poly.xmax,poly.ymax])]}:"lasso"===dragMode&&(fillRangeItems=function(eventData,poly,pts){(eventData.lassoPoints={})[_this.id]=pts.filtered.map(invert)});var dragOptions={element:_this.bgRect.node(),gd:gd,plotinfo:{xaxis:_this.xaxis,yaxis:_this.yaxis,fillRangeItems:fillRangeItems},xaxes:[_this.xaxis],yaxes:[_this.yaxis],subplot:_this.id,clickFn:function(numClicks){2===numClicks&&fullLayout._zoomlayer.selectAll(".select-outline").remove()},prepFn:function(e,startX,startY){_$prepSelect_602(e,startX,startY,dragOptions,dragMode)}};_$dragelement_433.init(dragOptions)}bgRect.on("mousemove",function(){var lonlat=_this.projection.invert(_$d3_127.mouse(this));if(!lonlat||isNaN(lonlat[0])||isNaN(lonlat[1]))return _$dragelement_433.unhover(gd,_$d3_127.event);_this.xaxis.p2c=function(){return lonlat[0]},_this.yaxis.p2c=function(){return lonlat[1]},_$fx_453.hover(gd,_$d3_127.event,_this.id)}),bgRect.on("mouseout",function(){_$dragelement_433.unhover(gd,_$d3_127.event)}),bgRect.on("click",function(){_$fx_453.click(gd,_$d3_127.event)})}function invert(lonlat){return _this.projection.invert([lonlat[0]+_this.xaxis._offset,lonlat[1]+_this.yaxis._offset])}},proto.makeFramework=function(){var _this=this,fullLayout=_this.graphDiv._fullLayout,clipId="clip"+fullLayout._uid+_this.id;_this.clipDef=fullLayout._clips.append("clipPath").attr("id",clipId),_this.clipRect=_this.clipDef.append("rect"),_this.framework=_$d3_127.select(_this.container).append("g").attr("class","geo "+_this.id).call(_$drawing_436.setClipUrl,clipId),_this.project=function(v){var px=_this.projection(v);return px?[px[0]-_this.xaxis._offset,px[1]-_this.yaxis._offset]:[null,null]},_this.xaxis={_id:"x",c2p:function(v){return _this.project(v)[0]}},_this.yaxis={_id:"y",c2p:function(v){return _this.project(v)[1]}},_this.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},_$axes_584.setConvert(_this.mockAxis,fullLayout)},proto.saveViewInitial=function(geoLayout){var center=geoLayout.center||{},projLayout=geoLayout.projection,rotation=projLayout.rotation||{};geoLayout._isScoped?this.viewInitial={"center.lon":center.lon,"center.lat":center.lat,"projection.scale":projLayout.scale}:geoLayout._isClipped?this.viewInitial={"projection.scale":projLayout.scale,"projection.rotation.lon":rotation.lon,"projection.rotation.lat":rotation.lat}:this.viewInitial={"center.lon":center.lon,"center.lat":center.lat,"projection.scale":projLayout.scale,"projection.rotation.lon":rotation.lon}},proto.render=function(){var k,projection=this.projection,pathFn=projection.getPath();function translatePoints(d){var lonlatPx=projection(d.lonlat);return lonlatPx?"translate("+lonlatPx[0]+","+lonlatPx[1]+")":null}function hideShowPoints(d){return projection.isLonLatOverEdges(d.lonlat)?"none":null}for(k in this.basePaths)this.basePaths[k].attr("d",pathFn);for(k in this.dataPaths)this.dataPaths[k].attr("d",function(d){return pathFn(d.geojson)});for(k in this.dataPoints)this.dataPoints[k].attr("display",hideShowPoints).attr("transform",translatePoints)};var _$domain_610={},__extendFlat_610=_$extend_528.extendFlat;_$domain_610.attributes=function(opts,extra){opts=opts||{},extra=extra||{};var base={valType:"info_array",editType:opts.editType,items:[{valType:"number",min:0,max:1,editType:opts.editType},{valType:"number",min:0,max:1,editType:opts.editType}],dflt:[0,1]},out=(opts.name&&opts.name,opts.trace,extra.description&&extra.description,{x:__extendFlat_610({},base,{}),y:__extendFlat_610({},base,{}),editType:opts.editType});return opts.noGridCell||(out.row={valType:"integer",min:0,dflt:0,editType:opts.editType},out.column={valType:"integer",min:0,dflt:0,editType:opts.editType}),out},_$domain_610.defaults=function(containerOut,layout,coerce,dfltDomains){var dfltX=dfltDomains&&dfltDomains.x||[0,1],dfltY=dfltDomains&&dfltDomains.y||[0,1],grid=layout.grid;if(grid){var column=coerce("domain.column");void 0!==column&&(column<grid.columns?dfltX=grid._domains.x[column]:delete containerOut.domain.column);var row=coerce("domain.row");void 0!==row&&(row<grid.rows?dfltY=grid._domains.y[row]:delete containerOut.domain.row)}coerce("domain.x",dfltX),coerce("domain.y",dfltY)};var domainAttrs=_$domain_610.attributes,__overrideAll_618=_$edit_types_569.overrideAll,geoAxesAttrs={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number"},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:_$attributes_410.lightLine},gridwidth:{valType:"number",min:0,dflt:1}},_$layout_attributes_618=__overrideAll_618({domain:domainAttrs({name:"geo"},{}),resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:Object.keys(_$constants_613.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:Object.keys(_$constants_613.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:_$attributes_410.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:_$constants_613.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:_$constants_613.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:_$constants_613.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:_$constants_613.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:_$attributes_410.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:_$attributes_410.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:_$attributes_410.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:_$attributes_410.background},lonaxis:geoAxesAttrs,lataxis:geoAxesAttrs},"plot","from-root"),handleDomainDefaults=_$domain_610.defaults,_$handleSubplotDefaults_660=function handleSubplotDefaults(layoutIn,layoutOut,fullData,opts){var subplotLayoutIn,subplotLayoutOut,subplotType=opts.type,subplotAttributes=opts.attributes,handleDefaults=opts.handleDefaults,partition=opts.partition||"x",ids=layoutOut._subplots[subplotType],idsLength=ids.length;function coerce(attr,dflt){return _$lib_539.coerce(subplotLayoutIn,subplotLayoutOut,subplotAttributes,attr,dflt)}for(var i=0;i<idsLength;i++){var id=ids[i];subplotLayoutIn=layoutIn[id]?layoutIn[id]:layoutIn[id]={},layoutOut[id]=subplotLayoutOut={};var dfltDomains={};dfltDomains[partition]=[i/idsLength,(i+1)/idsLength],handleDomainDefaults(subplotLayoutOut,layoutOut,coerce,dfltDomains),opts.id=id,handleDefaults(subplotLayoutIn,subplotLayoutOut,coerce,opts)}},axesNames=_$constants_613.axesNames;function handleGeoDefaults(geoLayoutIn,geoLayoutOut,coerce){var resolution=coerce("resolution"),scope=coerce("scope"),scopeParams=_$constants_613.scopeDefaults[scope],projType=coerce("projection.type",scopeParams.projType),isAlbersUsa=geoLayoutOut._isAlbersUsa="albers usa"===projType;isAlbersUsa&&(scope=geoLayoutOut.scope="usa");var isScoped=geoLayoutOut._isScoped="world"!==scope,isConic=geoLayoutOut._isConic=-1!==projType.indexOf("conic");geoLayoutOut._isClipped=!!_$constants_613.lonaxisSpan[projType];for(var i=0;i<axesNames.length;i++){var rangeDflt,axisName=axesNames[i],dtickDflt=[30,10][i];if(isScoped)rangeDflt=scopeParams[axisName+"Range"];else{var dfltSpans=_$constants_613[axisName+"Span"],hSpan=(dfltSpans[projType]||dfltSpans["*"])/2,rot=coerce("projection.rotation."+axisName.substr(0,3),scopeParams.projRotate[i]);rangeDflt=[rot-hSpan,rot+hSpan]}coerce(axisName+".tick0",coerce(axisName+".range",rangeDflt)[0]),coerce(axisName+".dtick",dtickDflt),coerce(axisName+".showgrid")&&(coerce(axisName+".gridcolor"),coerce(axisName+".gridwidth"))}var lonRange=geoLayoutOut.lonaxis.range,latRange=geoLayoutOut.lataxis.range,lon0=lonRange[0],lon1=lonRange[1];lon0>0&&lon1<0&&(lon1+=360);var projLon,centerLonDflt,centerLatDflt,centerLon=(lon0+lon1)/2;if(!isAlbersUsa){var dfltProjRotate=isScoped?scopeParams.projRotate:[centerLon,0,0];projLon=coerce("projection.rotation.lon",dfltProjRotate[0]),coerce("projection.rotation.lat",dfltProjRotate[1]),coerce("projection.rotation.roll",dfltProjRotate[2]),coerce("showcoastlines",!isScoped)&&(coerce("coastlinecolor"),coerce("coastlinewidth")),coerce("showocean")&&coerce("oceancolor")}(isAlbersUsa?(centerLonDflt=-96.6,centerLatDflt=38.7):(centerLonDflt=isScoped?centerLon:projLon,centerLatDflt=(latRange[0]+latRange[1])/2),coerce("center.lon",centerLonDflt),coerce("center.lat",centerLatDflt),isConic)&&coerce("projection.parallels",scopeParams.projParallels||[0,60]);coerce("projection.scale"),coerce("showland")&&coerce("landcolor"),coerce("showlakes")&&coerce("lakecolor"),coerce("showrivers")&&(coerce("rivercolor"),coerce("riverwidth")),coerce("showcountries",isScoped&&"usa"!==scope)&&(coerce("countrycolor"),coerce("countrywidth")),("usa"===scope||"north america"===scope&&50===resolution)&&(coerce("showsubunits",!0),coerce("subunitcolor"),coerce("subunitwidth")),isScoped||coerce("showframe",!0)&&(coerce("framecolor"),coerce("framewidth")),coerce("bgcolor")}var _$geo_615={},getSubplotCalcData=_$get_data_621.getSubplotCalcData,__counterRegex_615=_$lib_539.counterRegex,GEO="geo";_$geo_615.name=GEO,_$geo_615.attr=GEO,_$geo_615.idRoot=GEO,_$geo_615.idRegex=_$geo_615.attrRegex=__counterRegex_615(GEO),_$geo_615.attributes={geo:{valType:"subplotid",dflt:"geo",editType:"calc"}},_$geo_615.layoutAttributes=_$layout_attributes_618,_$geo_615.supplyLayoutDefaults=function supplyLayoutDefaults(layoutIn,layoutOut,fullData){_$handleSubplotDefaults_660(layoutIn,layoutOut,0,{type:"geo",attributes:_$layout_attributes_618,handleDefaults:handleGeoDefaults,partition:"y"})},_$geo_615.plot=function plotGeo(gd){var fullLayout=gd._fullLayout,calcData=gd.calcdata,geoIds=fullLayout._subplots.geo;void 0===window.PlotlyGeoAssets&&(window.PlotlyGeoAssets={topojson:{}});for(var i=0;i<geoIds.length;i++){var geoId=geoIds[i],geoCalcData=getSubplotCalcData(calcData,GEO,geoId),geo=fullLayout[geoId]._subplot;geo||(geo=_$createGeo_614({id:geoId,graphDiv:gd,container:fullLayout._geolayer.node(),topojsonURL:gd._context.topojsonURL,staticPlot:gd._context.staticPlot}),fullLayout[geoId]._subplot=geo),geo.plot(geoCalcData,fullLayout,gd._promises)}},_$geo_615.clean=function(newFullData,newFullLayout,oldFullData,oldFullLayout){for(var oldGeoKeys=oldFullLayout._subplots.geo||[],i=0;i<oldGeoKeys.length;i++){var oldGeoKey=oldGeoKeys[i],oldGeo=oldFullLayout[oldGeoKey]._subplot;!newFullLayout[oldGeoKey]&&oldGeo&&(oldGeo.framework.remove(),oldGeo.clipDef.remove())}},_$geo_615.updateFx=function(fullLayout){for(var subplotIds=fullLayout._subplots.geo,i=0;i<subplotIds.length;i++){var subplotLayout=fullLayout[subplotIds[i]];subplotLayout._subplot.updateFx(fullLayout,subplotLayout)}};var __dash_900=_$attributes_435.dash,__extendFlat_900=_$extend_528.extendFlat,__overrideAll_900=_$edit_types_569.overrideAll,__scatterMarkerAttrs_900=_$attributes_862.marker,scatterLineAttrs=_$attributes_862.line,__scatterMarkerLineAttrs_900=__scatterMarkerAttrs_900.line,_$attributes_900=__overrideAll_900({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names"],dflt:"ISO-3"},mode:__extendFlat_900({},_$attributes_862.mode,{dflt:"markers"}),text:__extendFlat_900({},_$attributes_862.text,{}),hovertext:__extendFlat_900({},_$attributes_862.hovertext,{}),textfont:_$attributes_862.textfont,textposition:_$attributes_862.textposition,line:{color:scatterLineAttrs.color,width:scatterLineAttrs.width,dash:__dash_900},connectgaps:_$attributes_862.connectgaps,marker:__extendFlat_900({symbol:__scatterMarkerAttrs_900.symbol,opacity:__scatterMarkerAttrs_900.opacity,size:__scatterMarkerAttrs_900.size,sizeref:__scatterMarkerAttrs_900.sizeref,sizemin:__scatterMarkerAttrs_900.sizemin,sizemode:__scatterMarkerAttrs_900.sizemode,showscale:__scatterMarkerAttrs_900.showscale,colorbar:__scatterMarkerAttrs_900.colorbar,line:__extendFlat_900({width:__scatterMarkerLineAttrs_900.width},_$makeColorScaleAttributes_419()),gradient:__scatterMarkerAttrs_900.gradient},_$makeColorScaleAttributes_419()),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:_$attributes_862.fillcolor,selected:_$attributes_862.selected,unselected:_$attributes_862.unselected,hoverinfo:__extendFlat_900({},_$attributes_581.hoverinfo,{flags:["lon","lat","location","text","name"]})},"calc","nested"),__extendFlat_735=_$extend_528.extendFlat,__extendDeepAll_735=_$extend_528.extendDeepAll,scatterGeoMarkerLineAttrs=_$attributes_900.marker.line,_$attributes_735=__extendFlat_735({locations:{valType:"data_array",editType:"calc"},locationmode:_$attributes_900.locationmode,z:{valType:"data_array",editType:"calc"},text:__extendFlat_735({},_$attributes_900.text,{}),marker:{line:{color:scatterGeoMarkerLineAttrs.color,width:__extendFlat_735({},scatterGeoMarkerLineAttrs.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:_$attributes_900.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:_$attributes_900.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:__extendFlat_735({},_$attributes_581.hoverinfo,{editType:"calc",flags:["location","z","text","name"]})},__extendDeepAll_735({},_$attributes_417,{zmax:{editType:"calc"},zmin:{editType:"calc"}}),{colorbar:_$attributes_412}),_$arraysToCalcdata_861=function arraysToCalcdata(cd,trace){for(var i=0;i<cd.length;i++)cd[i].i=i;_$lib_539.mergeArray(trace.text,cd,"tx"),_$lib_539.mergeArray(trace.hovertext,cd,"htx"),_$lib_539.mergeArray(trace.customdata,cd,"data"),_$lib_539.mergeArray(trace.textposition,cd,"tp"),trace.textfont&&(_$lib_539.mergeArray(trace.textfont.size,cd,"ts"),_$lib_539.mergeArray(trace.textfont.color,cd,"tc"),_$lib_539.mergeArray(trace.textfont.family,cd,"tf"));var marker=trace.marker;if(marker){_$lib_539.mergeArray(marker.size,cd,"ms"),_$lib_539.mergeArray(marker.opacity,cd,"mo"),_$lib_539.mergeArray(marker.symbol,cd,"mx"),_$lib_539.mergeArray(marker.color,cd,"mc");var markerLine=marker.line;marker.line&&(_$lib_539.mergeArray(markerLine.color,cd,"mlc"),_$lib_539.mergeArray(markerLine.width,cd,"mlw"));var markerGradient=marker.gradient;markerGradient&&"none"!==markerGradient.type&&(_$lib_539.mergeArray(markerGradient.type,cd,"mgt"),_$lib_539.mergeArray(markerGradient.color,cd,"mgc"))}},__BADNUM_736=_$numerical_517.BADNUM;var _$countryRegex_113={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|ç)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|é)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|é)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|ã)o.?tom(e|é)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"},_$geo_location_utils_531={},countryIds=Object.keys(_$countryRegex_113),locationmodeToIdFinder={"ISO-3":_$lib_539.identity,"USA-states":_$lib_539.identity,"country names":function countryNameToISO3(countryName){for(var i=0;i<countryIds.length;i++){var iso3=countryIds[i],regex=new RegExp(_$countryRegex_113[iso3]);if(regex.test(countryName.trim().toLowerCase()))return iso3}return _$lib_539.log("Unrecognized country name: "+countryName+"."),!1}};_$geo_location_utils_531.locationToFeature=function(locationmode,location,features){if(!location||"string"!=typeof location)return!1;var locationId=function getLocationId(locationmode,location){return(0,locationmodeToIdFinder[locationmode])(location)}(locationmode,location);if(locationId){for(var i=0;i<features.length;i++){var feature=features[i];if(feature.id===locationId)return feature}_$lib_539.log(["Location with id",locationId,"does not have a matching topojson feature at this resolution."].join(" "))}return!1};var _$style_743=function style(gd,calcTrace){calcTrace&&function styleTrace(gd,calcTrace){var trace=calcTrace[0].trace,locs=calcTrace[0].node3.selectAll(".choroplethlocation"),marker=trace.marker||{},markerLine=marker.line||{},sclFunc=_$colorscale_426.makeColorScaleFunc(_$colorscale_426.extractScale(trace.colorscale,trace.zmin,trace.zmax));locs.each(function(d){_$d3_127.select(this).attr("fill",sclFunc(d.z)).call(_$color_411.stroke,d.mlc||markerLine.color).call(_$drawing_436.dashLine,"",d.mlw||markerLine.width||0).style("opacity",marker.opacity)}),_$drawing_436.selectedPointStyle(locs,trace)}(0,calcTrace)};var getTopojsonFeatures=_$topojson_utils_565.getTopojsonFeatures,locationToFeature=_$geo_location_utils_531.locationToFeature;function calcGeoJSON(calcTrace,topojson){for(var trace=calcTrace[0].trace,len=calcTrace.length,features=getTopojsonFeatures(trace,topojson),i=0;i<len;i++){var calcPt=calcTrace[i],feature=locationToFeature(trace.locationmode,calcPt.loc,features);feature?(calcPt.geojson=feature,calcPt.ct=feature.properties.ct,calcPt.index=i,calcPt._polygons=feature2polygons(feature)):calcPt.geojson=null}}function feature2polygons(feature){var appendPolygon,j,k,m,geometry=feature.geometry,coords=geometry.coordinates,loc=feature.id,polygons=[];function doesCrossAntiMerdian(pts){for(var l=0;l<pts.length-1;l++)if(pts[l][0]>0&&pts[l+1][0]<0)return l;return null}switch(appendPolygon="RUS"===loc||"FJI"===loc?function(_pts){var pts;if(null===doesCrossAntiMerdian(_pts))pts=_pts;else for(pts=new Array(_pts.length),m=0;m<_pts.length;m++)pts[m]=[_pts[m][0]<0?_pts[m][0]+360:_pts[m][0],_pts[m][1]];polygons.push(_$polygon_551.tester(pts))}:"ATA"===loc?function(pts){var crossAntiMeridianIndex=doesCrossAntiMerdian(pts);if(null===crossAntiMeridianIndex)return polygons.push(_$polygon_551.tester(pts));var stitch=new Array(pts.length+1),si=0;for(m=0;m<pts.length;m++)m>crossAntiMeridianIndex?stitch[si++]=[pts[m][0]+360,pts[m][1]]:m===crossAntiMeridianIndex?(stitch[si++]=pts[m],stitch[si++]=[pts[m][0],-90]):stitch[si++]=pts[m];var tester=_$polygon_551.tester(stitch);tester.pts.pop(),polygons.push(tester)}:function(pts){polygons.push(_$polygon_551.tester(pts))},geometry.type){case"MultiPolygon":for(j=0;j<coords.length;j++)for(k=0;k<coords[j].length;k++)appendPolygon(coords[j][k]);break;case"Polygon":for(j=0;j<coords.length;j++)appendPolygon(coords[j])}return polygons}var _$colorbar_776=function colorbar(gd,cd){var trace=cd[0].trace,cbId="cb"+trace.uid,zmin=trace.zmin,zmax=trace.zmax;if(_$fastIsnumeric_139(zmin)||(zmin=_$lib_539.aggNums(Math.min,null,trace.z)),_$fastIsnumeric_139(zmax)||(zmax=_$lib_539.aggNums(Math.max,null,trace.z)),gd._fullLayout._infolayer.selectAll("."+cbId).remove(),trace.showscale){var cb=cd[0].t.cb=_$draw_415(gd,cbId),sclFunc=_$colorscale_426.makeColorScaleFunc(_$colorscale_426.extractScale(trace.colorscale,zmin,zmax),{noNumericCheck:!0});cb.fillcolor(sclFunc).filllevels({start:zmin,end:zmax,size:(zmax-zmin)/254}).options(trace.colorbar)()}else _$plots_647.autoMargin(gd,cbId)},Choropleth={};Choropleth.attributes=_$attributes_735,Choropleth.supplyDefaults=function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_735,attr,dflt)}var len,locations=coerce("locations");if(locations&&(len=locations.length),locations&&len){var z=coerce("z");_$lib_539.isArrayOrTypedArray(z)?(z.length>len&&(traceOut.z=z.slice(0,len)),coerce("locationmode"),coerce("text"),coerce("marker.line.color"),coerce("marker.line.width"),coerce("marker.opacity"),_$colorScaleDefaults_421(traceIn,traceOut,layout,coerce,{prefix:"",cLetter:"z"}),_$lib_539.coerceSelectionMarkerOpacity(traceOut,coerce)):traceOut.visible=!1}else traceOut.visible=!1},Choropleth.colorbar=_$colorbar_776,Choropleth.calc=function calc(gd,trace){for(var len=trace.locations.length,calcTrace=new Array(len),i=0;i<len;i++){var calcPt=calcTrace[i]={},loc=trace.locations[i],z=trace.z[i];calcPt.loc="string"==typeof loc?loc:null,calcPt.z=_$fastIsnumeric_139(z)?z:__BADNUM_736}return _$arraysToCalcdata_861(calcTrace,trace),_$calc_418(trace,trace.z,"","z"),_$calcSelection_864(calcTrace,trace),calcTrace},Choropleth.plot=function plot(gd,geo,calcData){for(var i=0;i<calcData.length;i++)calcGeoJSON(calcData[i],geo.topojson);var gTraces=geo.layers.backplot.select(".choroplethlayer").selectAll("g.trace.choropleth").data(calcData,function keyFunc(d){return d[0].trace.uid});gTraces.enter().append("g").attr("class","trace choropleth"),gTraces.exit().remove(),gTraces.each(function(calcTrace){var paths=(calcTrace[0].node3=_$d3_127.select(this)).selectAll("path.choroplethlocation").data(_$lib_539.identity);paths.enter().append("path").classed("choroplethlocation",!0),paths.exit().remove(),_$style_743(0,calcTrace)})},Choropleth.style=_$style_743,Choropleth.hoverPoints=function hoverPoints(pointData,xval,yval){var pt,i,j,isInside,cd=pointData.cd,trace=cd[0].trace,geo=pointData.subplot;for(i=0;i<cd.length;i++)if(isInside=!1,(pt=cd[i])._polygons){for(j=0;j<pt._polygons.length;j++)pt._polygons[j].contains([xval,yval])&&(isInside=!isInside),pt._polygons[j].contains([xval+360,yval])&&(isInside=!isInside);if(isInside)break}if(isInside&&pt)return pointData.x0=pointData.x1=pointData.xa.c2p(pt.ct),pointData.y0=pointData.y1=pointData.ya.c2p(pt.ct),pointData.index=pt.index,pointData.location=pt.loc,pointData.z=pt.z,function makeHoverInfo(pointData,trace,pt,axis){var hoverinfo=pt.hi||trace.hoverinfo,parts="all"===hoverinfo?_$attributes_735.hoverinfo.flags:hoverinfo.split("+"),hasName=-1!==parts.indexOf("name"),hasLocation=-1!==parts.indexOf("location"),hasZ=-1!==parts.indexOf("z"),hasText=-1!==parts.indexOf("text"),text=[];!hasName&&hasLocation?pointData.nameOverride=pt.loc:(hasName&&(pointData.nameOverride=trace.name),hasLocation&&text.push(pt.loc)),hasZ&&text.push(function formatter(val){return _$axes_584.tickText(axis,axis.c2l(val),"hover").text}(pt.z)),hasText&&_$fillHoverText_870(pt,trace,text),pointData.extraText=text.join("<br>")}(pointData,trace,pt,geo.mockAxis),[pointData]},Choropleth.eventData=function eventData(out,pt){return out.location=pt.location,out.z=pt.z,out},Choropleth.selectPoints=function selectPoints(searchInfo,polygon){var i,di,ct,x,y,cd=searchInfo.cd,xa=searchInfo.xaxis,ya=searchInfo.yaxis,selection=[];if(!1===polygon)for(i=0;i<cd.length;i++)cd[i].selected=0;else for(i=0;i<cd.length;i++)(ct=(di=cd[i]).ct)&&(x=xa.c2p(ct),y=ya.c2p(ct),polygon.contains([x,y])?(selection.push({pointNumber:i,lon:ct[0],lat:ct[1]}),di.selected=1):di.selected=0);return selection},Choropleth.moduleType="trace",Choropleth.name="choropleth",Choropleth.basePlotModule=_$geo_615,Choropleth.categories=["geo","noOpacity"],Choropleth.meta={};var _$choropleth_9=Choropleth,_$filter_ops_512={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}},__extendFlat_773=_$extend_528.extendFlat,_$attributes_773=__extendFlat_773({},{z:{valType:"data_array",editType:"calc"},x:__extendFlat_773({},_$attributes_862.x,{impliedEdits:{xtype:"array"}}),x0:__extendFlat_773({},_$attributes_862.x0,{impliedEdits:{xtype:"scaled"}}),dx:__extendFlat_773({},_$attributes_862.dx,{impliedEdits:{xtype:"scaled"}}),y:__extendFlat_773({},_$attributes_862.y,{impliedEdits:{ytype:"array"}}),y0:__extendFlat_773({},_$attributes_862.y0,{impliedEdits:{ytype:"scaled"}}),dy:__extendFlat_773({},_$attributes_862.dy,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},zhoverformat:{valType:"string",dflt:"",editType:"none"}},_$attributes_417,{autocolorscale:__extendFlat_773({},_$attributes_417.autocolorscale,{dflt:!1})},{colorbar:_$attributes_412}),__dash_744=_$attributes_435.dash,__extendFlat_744=_$extend_528.extendFlat,COMPARISON_OPS2=_$filter_ops_512.COMPARISON_OPS2,INTERVAL_OPS=_$filter_ops_512.INTERVAL_OPS,__scatterLineAttrs_744=_$attributes_862.line,_$attributes_744=__extendFlat_744({z:_$attributes_773.z,x:_$attributes_773.x,x0:_$attributes_773.x0,dx:_$attributes_773.dx,y:_$attributes_773.y,y0:_$attributes_773.y0,dy:_$attributes_773.dy,text:_$attributes_773.text,transpose:_$attributes_773.transpose,xtype:_$attributes_773.xtype,ytype:_$attributes_773.ytype,zhoverformat:_$attributes_773.zhoverformat,connectgaps:_$attributes_773.connectgaps,fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:_$font_attributes_611({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot"},operation:{valType:"enumerated",values:[].concat(COMPARISON_OPS2).concat(INTERVAL_OPS),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:__extendFlat_744({},__scatterLineAttrs_744.color,{editType:"style+colorbars"}),width:__extendFlat_744({},__scatterLineAttrs_744.width,{editType:"style+colorbars"}),dash:__dash_744,smoothing:__extendFlat_744({},__scatterLineAttrs_744.smoothing,{}),editType:"plot"}},_$attributes_417,{autocolorscale:__extendFlat_744({},_$attributes_417.autocolorscale,{dflt:!1}),zmin:__extendFlat_744({},_$attributes_417.zmin,{editType:"calc"}),zmax:__extendFlat_744({},_$attributes_417.zmax,{editType:"calc"})},{colorbar:_$attributes_412}),__extendFlat_763=_$lib_539.extendFlat,_$setContours_763=function setContours(trace){var contours=trace.contours;if(trace.autocontour){var dummyAx=autoContours(trace.zmin,trace.zmax,trace.ncontours);contours.size=dummyAx.dtick,contours.start=_$axes_584.tickFirst(dummyAx),dummyAx.range.reverse(),contours.end=_$axes_584.tickFirst(dummyAx),contours.start===trace.zmin&&(contours.start+=contours.size),contours.end===trace.zmax&&(contours.end-=contours.size),contours.start>contours.end&&(contours.start=contours.end=(contours.start+contours.end)/2),trace._input.contours||(trace._input.contours={}),__extendFlat_763(trace._input.contours,{start:contours.start,end:contours.end,size:contours.size}),trace._input.autocontour=!0}else if("constraint"!==contours.type){var sizeOut,start=contours.start,end=contours.end,inputContours=trace._input.contours;if(start>end&&(contours.start=inputContours.start=end,end=contours.end=inputContours.end=start,start=contours.start),!(contours.size>0))sizeOut=start===end?1:autoContours(start,end,trace.ncontours).dtick,inputContours.size=contours.size=sizeOut}};function autoContours(start,end,ncontours){var dummyAx={type:"linear",range:[start,end]};return _$axes_584.autoTicks(dummyAx,(end-start)/(ncontours||15)),dummyAx}var _$maxRowLength_785=function maxRowLength(z){for(var len=0,i=0;i<z.length;i++)len=Math.max(len,z[i].length);return len},_$findEmpties_779=function findEmpties(z){var prevRow,i,j,thisPt,p,neighborCount,newNeighborHash,foundNewNeighbors,empties=[],neighborHash={},noNeighborList=[],nextRow=z[0],row=[],blank=[0,0,0],rowLength=_$maxRowLength_785(z);for(i=0;i<z.length;i++)for(prevRow=row,row=nextRow,nextRow=z[i+1]||[],j=0;j<rowLength;j++)void 0===row[j]&&((neighborCount=(void 0!==row[j-1]?1:0)+(void 0!==row[j+1]?1:0)+(void 0!==prevRow[j]?1:0)+(void 0!==nextRow[j]?1:0))?(0===i&&neighborCount++,0===j&&neighborCount++,i===z.length-1&&neighborCount++,j===row.length-1&&neighborCount++,neighborCount<4&&(neighborHash[[i,j]]=[i,j,neighborCount]),empties.push([i,j,neighborCount])):noNeighborList.push([i,j]));for(;noNeighborList.length;){for(newNeighborHash={},foundNewNeighbors=!1,p=noNeighborList.length-1;p>=0;p--)(neighborCount=((neighborHash[[(i=(thisPt=noNeighborList[p])[0])-1,j=thisPt[1]]]||blank)[2]+(neighborHash[[i+1,j]]||blank)[2]+(neighborHash[[i,j-1]]||blank)[2]+(neighborHash[[i,j+1]]||blank)[2])/20)&&(newNeighborHash[thisPt]=[i,j,neighborCount],noNeighborList.splice(p,1),foundNewNeighbors=!0);if(!foundNewNeighbors)throw"findEmpties iterated with no new neighbors";for(thisPt in newNeighborHash)neighborHash[thisPt]=newNeighborHash[thisPt],empties.push(newNeighborHash[thisPt])}return empties.sort(function(a,b){return b[2]-a[2]})},__isArrayOrTypedArray_780=_$lib_539.isArrayOrTypedArray,_$has_columns_780=function(trace){return!__isArrayOrTypedArray_780(trace.z[0])},NEIGHBORSHIFTS=[[-1,0],[1,0],[0,-1],[0,1]];function correctionOvershoot(maxFractionalChange){return.5-.25*Math.min(1,.5*maxFractionalChange)}var _$interp2d_783=function interp2d(z,emptyPoints,savedInterpZ){var i,thisPt,maxFractionalChange=1;if(Array.isArray(savedInterpZ))for(i=0;i<emptyPoints.length;i++)z[(thisPt=emptyPoints[i])[0]][thisPt[1]]=savedInterpZ[thisPt[0]][thisPt[1]];else iterateInterp2d(z,emptyPoints);for(i=0;i<emptyPoints.length&&!(emptyPoints[i][2]<4);i++);for(emptyPoints=emptyPoints.slice(i),i=0;i<100&&maxFractionalChange>.01;i++)maxFractionalChange=iterateInterp2d(z,emptyPoints,correctionOvershoot(maxFractionalChange));return maxFractionalChange>.01&&_$lib_539.log("interp2d didn't converge quickly",maxFractionalChange),z};function iterateInterp2d(z,emptyPoints,overshoot){var thisPt,i,j,p,q,neighborShift,neighborRow,neighborVal,neighborCount,neighborSum,initialVal,minNeighbor,maxNeighbor,maxFractionalChange=0;for(p=0;p<emptyPoints.length;p++){for(i=(thisPt=emptyPoints[p])[0],j=thisPt[1],initialVal=z[i][j],neighborSum=0,neighborCount=0,q=0;q<4;q++)(neighborRow=z[i+(neighborShift=NEIGHBORSHIFTS[q])[0]])&&void 0!==(neighborVal=neighborRow[j+neighborShift[1]])&&(0===neighborSum?minNeighbor=maxNeighbor=neighborVal:(minNeighbor=Math.min(minNeighbor,neighborVal),maxNeighbor=Math.max(maxNeighbor,neighborVal)),neighborCount++,neighborSum+=neighborVal);if(0===neighborCount)throw"iterateInterp2d order is wrong: no defined neighbors";z[i][j]=neighborSum/neighborCount,void 0===initialVal?neighborCount<4&&(maxFractionalChange=1):(z[i][j]=(1+overshoot)*z[i][j]-overshoot*initialVal,maxNeighbor>minNeighbor&&(maxFractionalChange=Math.max(maxFractionalChange,Math.abs(z[i][j]-initialVal)/(maxNeighbor-minNeighbor))))}return maxFractionalChange}var __isArrayOrTypedArray_784=_$lib_539.isArrayOrTypedArray,_$makeBoundArray_784=function makeBoundArray(trace,arrayIn,v0In,dvIn,numbricks,ax){var v0,dv,i,arrayOut=[],isContour=_$registry_668.traceIs(trace,"contour"),isHist=_$registry_668.traceIs(trace,"histogram"),isGL2D=_$registry_668.traceIs(trace,"gl2d");if(__isArrayOrTypedArray_784(arrayIn)&&arrayIn.length>1&&!isHist&&"category"!==ax.type){var len=arrayIn.length;if(!(len<=numbricks))return isContour?arrayIn.slice(0,numbricks):arrayIn.slice(0,numbricks+1);if(isContour||isGL2D)arrayOut=arrayIn.slice(0,numbricks);else if(1===numbricks)arrayOut=[arrayIn[0]-.5,arrayIn[0]+.5];else{for(arrayOut=[1.5*arrayIn[0]-.5*arrayIn[1]],i=1;i<len;i++)arrayOut.push(.5*(arrayIn[i-1]+arrayIn[i]));arrayOut.push(1.5*arrayIn[len-1]-.5*arrayIn[len-2])}if(len<numbricks){var lastPt=arrayOut[arrayOut.length-1],delta=lastPt-arrayOut[arrayOut.length-2];for(i=len;i<numbricks;i++)lastPt+=delta,arrayOut.push(lastPt)}}else{dv=dvIn||1;var calendar=trace[ax._id.charAt(0)+"calendar"];for(v0=isHist||"category"===ax.type?ax.r2c(v0In,0,calendar)||0:__isArrayOrTypedArray_784(arrayIn)&&1===arrayIn.length?arrayIn[0]:void 0===v0In?0:ax.d2c(v0In,0,calendar),i=isContour||isGL2D?0:-.5;i<numbricks;i++)arrayOut.push(v0+dv*i)}return arrayOut},_$doAvg_794=function doAvg(size,counts){for(var nMax=size.length,total=0,i=0;i<nMax;i++)counts[i]?(size[i]/=counts[i],total+=size[i]):size[i]=null;return total},_$bin_functions_796={count:function(n,i,size){return size[n]++,1},sum:function(n,i,size,counterData){var v=counterData[i];return _$fastIsnumeric_139(v)?(v=Number(v),size[n]+=v,v):0},avg:function(n,i,size,counterData,counts){var v=counterData[i];return _$fastIsnumeric_139(v)&&(v=Number(v),size[n]+=v,counts[n]++),0},min:function(n,i,size,counterData){var v=counterData[i];if(_$fastIsnumeric_139(v)){if(v=Number(v),!_$fastIsnumeric_139(size[n]))return size[n]=v,v;if(size[n]>v){var delta=v-size[n];return size[n]=v,delta}}return 0},max:function(n,i,size,counterData){var v=counterData[i];if(_$fastIsnumeric_139(v)){if(v=Number(v),!_$fastIsnumeric_139(size[n]))return size[n]=v,v;if(size[n]<v){var delta=v-size[n];return size[n]=v,delta}}return 0}},oneYear=_$numerical_517.ONEAVGYEAR,oneMonth=_$numerical_517.ONEAVGMONTH,oneDay=_$numerical_517.ONEDAY,oneHour=_$numerical_517.ONEHOUR,oneMin=_$numerical_517.ONEMIN,oneSec=_$numerical_517.ONESEC,tickIncrement=_$axes_584.tickIncrement,_$getBinSpanLabelRound_797=function getBinSpanLabelRound(leftGap,rightGap,binEdges,pa,calendar){var digit,disambiguateEdges,dv0=-1.1*rightGap,dv1=-.1*rightGap,dv2=leftGap-dv1,edge0=binEdges[0],edge1=binEdges[1],leftDigit=Math.min(biggestDigitChanged(edge0+dv1,edge0+dv2,pa,calendar),biggestDigitChanged(edge1+dv1,edge1+dv2,pa,calendar)),rightDigit=Math.min(biggestDigitChanged(edge0+dv0,edge0+dv1,pa,calendar),biggestDigitChanged(edge1+dv0,edge1+dv1,pa,calendar));if(leftDigit>rightDigit&&rightDigit<Math.abs(edge1-edge0)/4e3?(digit=leftDigit,disambiguateEdges=!1):(digit=Math.min(leftDigit,rightDigit),disambiguateEdges=!0),"date"===pa.type&&digit>oneDay){var dashExclude=digit===oneYear?1:6,increment=digit===oneYear?"M12":"M1";return function(v,isRightEdge){var dateStr=pa.c2d(v,oneYear,calendar),dashPos=dateStr.indexOf("-",dashExclude);dashPos>0&&(dateStr=dateStr.substr(0,dashPos));var roundedV=pa.d2c(dateStr,0,calendar);if(roundedV<v){var nextV=tickIncrement(roundedV,increment,!1,calendar);(roundedV+nextV)/2<v+leftGap&&(roundedV=nextV)}return isRightEdge&&disambiguateEdges?tickIncrement(roundedV,increment,!0,calendar):roundedV}}return function(v,isRightEdge){var roundedV=digit*Math.round(v/digit);return roundedV+digit/10<v&&roundedV+.9*digit<v+leftGap&&(roundedV+=digit),isRightEdge&&disambiguateEdges&&(roundedV-=digit),roundedV}};function biggestDigitChanged(v1,v2,pa,calendar){if(v1*v2<=0)return 1/0;for(var dv=Math.abs(v2-v1),isDate="date"===pa.type,digit=biggestGuaranteedDigitChanged(dv,isDate),i=0;i<10;i++){var nextDigit=biggestGuaranteedDigitChanged(80*digit,isDate);if(digit===nextDigit)break;if(!didDigitChange(nextDigit,v1,v2,isDate,pa,calendar))break;digit=nextDigit}return digit}function biggestGuaranteedDigitChanged(dv,isDate){return isDate&&dv>oneSec?dv>oneDay?dv>1.1*oneYear?oneYear:dv>1.1*oneMonth?oneMonth:oneDay:dv>oneHour?oneHour:dv>oneMin?oneMin:oneSec:Math.pow(10,Math.floor(Math.log(dv)/Math.LN10))}function didDigitChange(digit,v1,v2,isDate,pa,calendar){if(isDate&&digit>oneDay){var dateParts1=dateParts(v1,pa,calendar),dateParts2=dateParts(v2,pa,calendar),parti=digit===oneYear?0:1;return dateParts1[parti]!==dateParts2[parti]}return Math.floor(v2/digit)-Math.floor(v1/digit)>.1}function dateParts(v,pa,calendar){var parts=pa.c2d(v,oneYear,calendar).split("-");return""===parts[0]&&(parts.unshift(),parts[0]="-"+parts[0]),parts}var cleanDate=_$lib_539.cleanDate,__ONEDAY_799=_$numerical_517.ONEDAY,__BADNUM_799=_$numerical_517.BADNUM,_$cleanBins_799=function cleanBins(trace,ax,binDirection){var axType=ax.type,binAttr=binDirection+"bins",bins=trace[binAttr];bins||(bins=trace[binAttr]={});var cleanBound="date"===axType?function(v){return v||0===v?cleanDate(v,__BADNUM_799,bins.calendar):null}:function(v){return _$fastIsnumeric_139(v)?Number(v):null};bins.start=cleanBound(bins.start),bins.end=cleanBound(bins.end);var sizeDflt="date"===axType?__ONEDAY_799:1,binSize=bins.size;if(_$fastIsnumeric_139(binSize))bins.size=binSize>0?Number(binSize):sizeDflt;else if("string"!=typeof binSize)bins.size=sizeDflt;else{var prefix=binSize.charAt(0),sizeNum=binSize.substr(1);((sizeNum=_$fastIsnumeric_139(sizeNum)?Number(sizeNum):0)<=0||"date"!==axType||"M"!==prefix||sizeNum!==Math.round(sizeNum))&&(bins.size=sizeDflt)}var autoBinAttr="autobin"+binDirection;"boolean"!=typeof trace[autoBinAttr]&&(trace[autoBinAttr]=trace._fullInput[autoBinAttr]=trace._input[autoBinAttr]=!((bins.start||0===bins.start)&&(bins.end||0===bins.end))),trace[autoBinAttr]||(delete trace["nbins"+binDirection],delete trace._fullInput["nbins"+binDirection])},_$norm_functions_804={percent:function(size,total){for(var nMax=size.length,norm=100/total,n=0;n<nMax;n++)size[n]*=norm},probability:function(size,total){for(var nMax=size.length,n=0;n<nMax;n++)size[n]/=total},density:function(size,total,inc,yinc){var nMax=size.length;yinc=yinc||1;for(var n=0;n<nMax;n++)size[n]*=inc[n]*yinc},"probability density":function(size,total,inc,yinc){var nMax=size.length;yinc&&(total/=yinc);for(var n=0;n<nMax;n++)size[n]*=inc[n]/total}};function cleanAndAutobin(trace,axLetter,data,ax,r2c,c2r,calendar){var binSpecAttr=axLetter+"bins",autoBinAttr="autobin"+axLetter,binSpec=trace[binSpecAttr];_$cleanBins_799(trace,ax,axLetter),!trace[autoBinAttr]&&binSpec&&null!==binSpec.start&&null!==binSpec.end||(binSpec=_$axes_584.autoBin(data,ax,trace["nbins"+axLetter],"2d",calendar),"histogram2dcontour"===trace.type&&(binSpec.start=c2r(_$axes_584.tickIncrement(r2c(binSpec.start),binSpec.size,!0,calendar)),binSpec.end=c2r(_$axes_584.tickIncrement(r2c(binSpec.end),binSpec.size,!1,calendar))),trace._input[binSpecAttr]=trace[binSpecAttr]=binSpec,trace._input[autoBinAttr]=trace[autoBinAttr])}function makeIncrements(len,bins,dv,nonuniform){var i,out=new Array(len);if(nonuniform)for(i=0;i<len;i++)out[i]=1/(bins[i+1]-bins[i]);else{var inc=1/dv;for(i=0;i<len;i++)out[i]=inc}return out}function binsToCalc(r2c,bins){return{start:r2c(bins.start),end:r2c(bins.end),size:bins.size}}function getRanges(edges,uniqueVals,gapLow,gapHigh,ax,calendar){var i,len=edges.length-1,out=new Array(len);if(uniqueVals)for(i=0;i<len;i++)out[i]=[uniqueVals[i],uniqueVals[i]];else{var roundFn=_$getBinSpanLabelRound_797(gapLow,gapHigh,edges,ax,calendar);for(i=0;i<len;i++)out[i]=[roundFn(edges[i]),roundFn(edges[i+1],!0)]}return out}var _$calc_774=function calc(gd,trace){var x,x0,dx,y,y0,dy,z,i,binned,xa=_$axes_584.getFromId(gd,trace.xaxis||"x"),ya=_$axes_584.getFromId(gd,trace.yaxis||"y"),isContour=_$registry_668.traceIs(trace,"contour"),isHist=_$registry_668.traceIs(trace,"histogram"),isGL2D=_$registry_668.traceIs(trace,"gl2d"),zsmooth=isContour?"best":trace.zsmooth;function noZsmooth(msg){zsmooth=trace._input.zsmooth=trace.zsmooth=!1,_$lib_539.warn('cannot use zsmooth: "fast": '+msg)}if(xa._minDtick=0,ya._minDtick=0,isHist?(x=(binned=function calc(gd,trace){var i,j,n,m,xa=_$axes_584.getFromId(gd,trace.xaxis||"x"),x=trace.x?xa.makeCalcdata(trace,"x"):[],ya=_$axes_584.getFromId(gd,trace.yaxis||"y"),y=trace.y?ya.makeCalcdata(trace,"y"):[],xcalendar=trace.xcalendar,ycalendar=trace.ycalendar,xr2c=function(v){return xa.r2c(v,0,xcalendar)},yr2c=function(v){return ya.r2c(v,0,ycalendar)},xc2r=function(v){return xa.c2r(v,0,xcalendar)},yc2r=function(v){return ya.c2r(v,0,ycalendar)},serieslen=Math.min(x.length,y.length);x.length>serieslen&&x.splice(serieslen,x.length-serieslen),y.length>serieslen&&y.splice(serieslen,y.length-serieslen),cleanAndAutobin(trace,"x",x,xa,xr2c,xc2r,xcalendar),cleanAndAutobin(trace,"y",y,ya,yr2c,yc2r,ycalendar);var z=[],onecol=[],zerocol=[],nonuniformBinsX="string"==typeof trace.xbins.size,nonuniformBinsY="string"==typeof trace.ybins.size,xEdges=[],yEdges=[],xbins=nonuniformBinsX?xEdges:trace.xbins,ybins=nonuniformBinsY?yEdges:trace.ybins,total=0,counts=[],inputPoints=[],norm=trace.histnorm,func=trace.histfunc,densitynorm=-1!==norm.indexOf("density"),sizeinit="max"===func||"min"===func?null:0,binfunc=_$bin_functions_796.count,normfunc=_$norm_functions_804[norm],doavg=!1,xinc=[],yinc=[],rawCounterData="z"in trace?trace.z:"marker"in trace&&Array.isArray(trace.marker.color)?trace.marker.color:"";rawCounterData&&"count"!==func&&(doavg="avg"===func,binfunc=_$bin_functions_796[func]);var binSpec=trace.xbins,binStart=xr2c(binSpec.start),binEnd=xr2c(binSpec.end)+(binStart-_$axes_584.tickIncrement(binStart,binSpec.size,!1,xcalendar))/1e6;for(i=binStart;i<binEnd;i=_$axes_584.tickIncrement(i,binSpec.size,!1,xcalendar))onecol.push(sizeinit),xEdges.push(i),doavg&&zerocol.push(0);xEdges.push(i);var nx=onecol.length,x0c=xr2c(trace.xbins.start),dx=(i-x0c)/nx,x0=xc2r(x0c+dx/2);for(binStart=yr2c((binSpec=trace.ybins).start),binEnd=yr2c(binSpec.end)+(binStart-_$axes_584.tickIncrement(binStart,binSpec.size,!1,ycalendar))/1e6,i=binStart;i<binEnd;i=_$axes_584.tickIncrement(i,binSpec.size,!1,ycalendar)){z.push(onecol.slice()),yEdges.push(i);var ipCol=new Array(nx);for(j=0;j<nx;j++)ipCol[j]=[];inputPoints.push(ipCol),doavg&&counts.push(zerocol.slice())}yEdges.push(i);var ny=z.length,y0c=yr2c(trace.ybins.start),dy=(i-y0c)/ny,y0=yc2r(y0c+dy/2);densitynorm&&(xinc=makeIncrements(onecol.length,xbins,dx,nonuniformBinsX),yinc=makeIncrements(z.length,ybins,dy,nonuniformBinsY)),nonuniformBinsX||"date"!==xa.type||(xbins=binsToCalc(xr2c,xbins)),nonuniformBinsY||"date"!==ya.type||(ybins=binsToCalc(yr2c,ybins));var uniqueValsPerX=!0,uniqueValsPerY=!0,xVals=new Array(nx),yVals=new Array(ny),xGapLow=1/0,xGapHigh=1/0,yGapLow=1/0,yGapHigh=1/0;for(i=0;i<serieslen;i++){var xi=x[i],yi=y[i];n=_$lib_539.findBin(xi,xbins),m=_$lib_539.findBin(yi,ybins),n>=0&&n<nx&&m>=0&&m<ny&&(total+=binfunc(n,i,z[m],rawCounterData,counts[m]),inputPoints[m][n].push(i),uniqueValsPerX&&(void 0===xVals[n]?xVals[n]=xi:xVals[n]!==xi&&(uniqueValsPerX=!1)),uniqueValsPerY&&(void 0===yVals[n]?yVals[n]=yi:yVals[n]!==yi&&(uniqueValsPerY=!1)),xGapLow=Math.min(xGapLow,xi-xEdges[n]),xGapHigh=Math.min(xGapHigh,xEdges[n+1]-xi),yGapLow=Math.min(yGapLow,yi-yEdges[m]),yGapHigh=Math.min(yGapHigh,yEdges[m+1]-yi))}if(doavg)for(m=0;m<ny;m++)total+=_$doAvg_794(z[m],counts[m]);if(normfunc)for(m=0;m<ny;m++)normfunc(z[m],total,xinc,yinc[m]);return{x:x,xRanges:getRanges(xEdges,uniqueValsPerX&&xVals,xGapLow,xGapHigh,xa,xcalendar),x0:x0,dx:dx,y:y,yRanges:getRanges(yEdges,uniqueValsPerY&&yVals,yGapLow,yGapHigh,ya,ycalendar),y0:y0,dy:dy,z:z,pts:inputPoints}}(gd,trace)).x,x0=binned.x0,dx=binned.dx,y=binned.y,y0=binned.y0,dy=binned.dy,z=binned.z):(_$has_columns_780(trace)?(_$convertColumnData_777(trace,xa,ya,"x","y",["z"]),x=trace.x,y=trace.y):(x=trace.x?xa.makeCalcdata(trace,"x"):[],y=trace.y?ya.makeCalcdata(trace,"y"):[]),x0=trace.x0||0,dx=trace.dx||1,y0=trace.y0||0,dy=trace.dy||1,z=_$clean2dArray_775(trace.z,trace.transpose),(isContour||trace.connectgaps)&&(trace._emptypoints=_$findEmpties_779(z),trace._interpz=_$interp2d_783(z,trace._emptypoints,trace._interpz))),"fast"===zsmooth)if("log"===xa.type||"log"===ya.type)noZsmooth("log axis found");else if(!isHist){if(x.length){var avgdx=(x[x.length-1]-x[0])/(x.length-1),maxErrX=Math.abs(avgdx/100);for(i=0;i<x.length-1;i++)if(Math.abs(x[i+1]-x[i]-avgdx)>maxErrX){noZsmooth("x scale is not linear");break}}if(y.length&&"fast"===zsmooth){var avgdy=(y[y.length-1]-y[0])/(y.length-1),maxErrY=Math.abs(avgdy/100);for(i=0;i<y.length-1;i++)if(Math.abs(y[i+1]-y[i]-avgdy)>maxErrY){noZsmooth("y scale is not linear");break}}}var xlen=_$maxRowLength_785(z),xIn="scaled"===trace.xtype?"":x,xArray=_$makeBoundArray_784(trace,xIn,x0,dx,xlen,xa),yIn="scaled"===trace.ytype?"":y,yArray=_$makeBoundArray_784(trace,yIn,y0,dy,z.length,ya);isGL2D||(_$axes_584.expand(xa,xArray),_$axes_584.expand(ya,yArray));var cd0={x:xArray,y:yArray,z:z,text:trace.text};if(xIn&&xIn.length===xArray.length-1&&(cd0.xCenter=xIn),yIn&&yIn.length===yArray.length-1&&(cd0.yCenter=yIn),isHist&&(cd0.xRanges=binned.xRanges,cd0.yRanges=binned.yRanges,cd0.pts=binned.pts),isContour&&"constraint"===trace.contours.type||_$calc_418(trace,z,"","z"),isContour&&trace.contours&&"heatmap"===trace.contours.coloring){var dummyTrace={type:"contour"===trace.type?"heatmap":"histogram2d",xcalendar:trace.xcalendar,ycalendar:trace.ycalendar};cd0.xfill=_$makeBoundArray_784(dummyTrace,xIn,x0,dx,xlen,xa),cd0.yfill=_$makeBoundArray_784(dummyTrace,yIn,y0,dy,z.length,ya)}return[cd0]},_$calc_745=function calc(gd,trace){var cd=_$calc_774(gd,trace);return _$setContours_763(trace),cd},_$endPlus_755=function endPlus(contours){return contours.end+contours.size/1e6},_$makeColorMap_760=function makeColorMap(trace){var contours=trace.contours,start=contours.start,end=_$endPlus_755(contours),cs=contours.size||1,nc=Math.floor((end-start)/cs)+1,extra="lines"===contours.coloring?0:1;isFinite(cs)||(cs=1,nc=1);var si,i,scl=trace.colorscale,len=scl.length,domain=new Array(len),range=new Array(len);if("heatmap"===contours.coloring){for(trace.zauto&&!1===trace.autocontour&&(trace.zmin=start-cs/2,trace.zmax=trace.zmin+nc*cs),i=0;i<len;i++)si=scl[i],domain[i]=si[0]*(trace.zmax-trace.zmin)+trace.zmin,range[i]=si[1];var zRange=_$d3_127.extent([trace.zmin,trace.zmax,contours.start,contours.start+cs*(nc-1)]),zmin=zRange[trace.zmin<trace.zmax?0:1],zmax=zRange[trace.zmin<trace.zmax?1:0];zmin!==trace.zmin&&(domain.splice(0,0,zmin),range.splice(0,0,Range[0])),zmax!==trace.zmax&&(domain.push(zmax),range.push(range[range.length-1]))}else for(i=0;i<len;i++)si=scl[i],domain[i]=(si[0]*(nc+extra-1)-extra/2)*cs+start,range[i]=si[1];return _$colorscale_426.makeColorScaleFunc({domain:domain,range:range},{noNumericCheck:!0})},_$colorbar_747=function colorbar(gd,cd){var trace=cd[0].trace,cbId="cb"+trace.uid;if(gd._fullLayout._infolayer.selectAll("."+cbId).remove(),trace.showscale){var cb=_$draw_415(gd,cbId);cd[0].t.cb=cb;var contours=trace.contours,line=trace.line,cs=contours.size||1,coloring=contours.coloring,colorMap=_$makeColorMap_760(trace);"heatmap"===coloring&&cb.filllevels({start:trace.zmin,end:trace.zmax,size:(trace.zmax-trace.zmin)/254}),cb.fillcolor("fill"===coloring||"heatmap"===coloring?colorMap:"").line({color:"lines"===coloring?colorMap:line.color,width:!1!==contours.showlines?line.width:0,dash:line.dash}).levels({start:contours.start,end:_$endPlus_755(contours),size:cs}).options(trace.colorbar)()}else _$plots_647.autoMargin(gd,cbId)},_$handleLabelDefaults_759=function handleLabelDefaults(coerce,layout,lineColor,opts){if(opts||(opts={}),coerce("contours.showlabels")){var globalFont=layout.font;_$lib_539.coerceFont(coerce,"contours.labelfont",{family:globalFont.family,size:globalFont.size,color:lineColor}),coerce("contours.labelformat")}!1!==opts.hasHover&&coerce("zhoverformat")},__addOpacity_749=_$color_411.addOpacity,opacity=_$color_411.opacity,CONSTRAINT_REDUCTION=_$filter_ops_512.CONSTRAINT_REDUCTION,__COMPARISON_OPS2_749=_$filter_ops_512.COMPARISON_OPS2,_$handleConstraintDefaults_749=function handleConstraintDefaults(traceIn,traceOut,coerce,layout,defaultColor,opts){var showLines,lineColor,fillColor,contours=traceOut.contours,operation=coerce("contours.operation");(contours._operation=CONSTRAINT_REDUCTION[operation],function handleConstraintValueDefaults(coerce,contours){var zvalue;-1===__COMPARISON_OPS2_749.indexOf(contours.operation)?(coerce("contours.value",[0,1]),Array.isArray(contours.value)?contours.value.length>2?contours.value=contours.value.slice(2):0===contours.length?contours.value=[0,1]:contours.length<2?(zvalue=parseFloat(contours.value[0]),contours.value=[zvalue,zvalue+1]):contours.value=[parseFloat(contours.value[0]),parseFloat(contours.value[1])]:_$fastIsnumeric_139(contours.value)&&(zvalue=parseFloat(contours.value),contours.value=[zvalue,zvalue+1])):(coerce("contours.value",0),_$fastIsnumeric_139(contours.value)||(Array.isArray(contours.value)?contours.value=parseFloat(contours.value[0]):contours.value=0))}(coerce,contours),"="===operation?showLines=contours.showlines=!0:(showLines=coerce("contours.showlines"),fillColor=coerce("fillcolor",__addOpacity_749((traceIn.line||{}).color||defaultColor,.5))),showLines)&&(lineColor=coerce("line.color",fillColor&&opacity(fillColor)?__addOpacity_749(traceOut.fillcolor,1):defaultColor),coerce("line.width",2),coerce("line.dash"));coerce("line.smoothing"),_$handleLabelDefaults_759(coerce,layout,lineColor,opts)};var _$handleContourDefaults_751=function handleContourDefaults(traceIn,traceOut,coerce,coerce2){var contourStart=coerce2("contours.start"),contourEnd=coerce2("contours.end"),missingEnd=!1===contourStart||!1===contourEnd,contourSize=coerce("contours.size");!(missingEnd?traceOut.autocontour=!0:coerce("autocontour",!1))&&contourSize||coerce("ncontours")},_$handleStyleDefaults_765=function handleStyleDefaults(traceIn,traceOut,coerce,layout,opts){var showLines,coloring=coerce("contours.coloring"),lineColor="";"fill"===coloring&&(showLines=coerce("contours.showlines")),!1!==showLines&&("lines"!==coloring&&(lineColor=coerce("line.color","#000")),coerce("line.width",.5),coerce("line.dash")),"none"!==coloring&&_$colorScaleDefaults_421(traceIn,traceOut,layout,coerce,{prefix:"",cLetter:"z"}),coerce("line.smoothing"),_$handleLabelDefaults_759(coerce,layout,lineColor,opts)},__isArrayOrTypedArray_789=_$lib_539.isArrayOrTypedArray,_$handleXYZDefaults_789=function handleXYZDefaults(traceIn,traceOut,coerce,layout,xName,yName){var x,y,z=coerce("z");if(xName=xName||"x",yName=yName||"y",void 0===z||!z.length)return 0;if(_$has_columns_780(traceIn)){if(x=coerce(xName),y=coerce(yName),!x||!y)return 0}else{if(x=coordDefaults(xName,coerce),y=coordDefaults(yName,coerce),!function isValidZ(z){for(var zi,allRowsAreArrays=!0,oneRowIsFilled=!1,hasOneNumber=!1,i=0;i<z.length;i++){if(zi=z[i],!__isArrayOrTypedArray_789(zi)){allRowsAreArrays=!1;break}zi.length>0&&(oneRowIsFilled=!0);for(var j=0;j<zi.length;j++)if(_$fastIsnumeric_139(zi[j])){hasOneNumber=!0;break}}return allRowsAreArrays&&oneRowIsFilled&&hasOneNumber}(z))return 0;coerce("transpose")}return _$registry_668.getComponentMethod("calendars","handleTraceDefaults")(traceIn,traceOut,[xName,yName],layout),traceOut.z.length};function coordDefaults(coordStr,coerce){var coord=coerce(coordStr);return"scaled"===(coord?coerce(coordStr+"type","array"):"scaled")&&(coerce(coordStr+"0"),coerce("d"+coordStr)),coord}var _$hoverPoints_781=function hoverPoints(pointData,xval,yval,hovermode,hoverLayer,contour){var xl,yl,nx,ny,cd0=pointData.cd[0],trace=cd0.trace,xa=pointData.xa,ya=pointData.ya,x=cd0.x,y=cd0.y,z=cd0.z,xc=cd0.xCenter,yc=cd0.yCenter,zmask=cd0.zmask,range=[trace.zmin,trace.zmax],zhoverformat=trace.zhoverformat,x2=x,y2=y;if(!1!==pointData.index){try{nx=Math.round(pointData.index[1]),ny=Math.round(pointData.index[0])}catch(e){return void _$lib_539.error("Error hovering on heatmap, pointNumber must be [row,col], found:",pointData.index)}if(nx<0||nx>=z[0].length||ny<0||ny>z.length)return}else{if(_$fx_453.inbox(xval-x[0],xval-x[x.length-1],0)>0||_$fx_453.inbox(yval-y[0],yval-y[y.length-1],0)>0)return;if(contour){var i2;for(x2=[2*x[0]-x[1]],i2=1;i2<x.length;i2++)x2.push((x[i2]+x[i2-1])/2);for(x2.push([2*x[x.length-1]-x[x.length-2]]),y2=[2*y[0]-y[1]],i2=1;i2<y.length;i2++)y2.push((y[i2]+y[i2-1])/2);y2.push([2*y[y.length-1]-y[y.length-2]])}nx=Math.max(0,Math.min(x2.length-2,_$lib_539.findBin(xval,x2))),ny=Math.max(0,Math.min(y2.length-2,_$lib_539.findBin(yval,y2)))}var x0=xa.c2p(x[nx]),x1=xa.c2p(x[nx+1]),y0=ya.c2p(y[ny]),y1=ya.c2p(y[ny+1]);contour?(x1=x0,xl=x[nx],y1=y0,yl=y[ny]):(xl=xc?xc[nx]:(x[nx]+x[nx+1])/2,yl=yc?yc[ny]:(y[ny]+y[ny+1])/2,trace.zsmooth&&(x0=x1=xa.c2p(xl),y0=y1=ya.c2p(yl)));var text,zLabel,zVal=z[ny][nx];zmask&&!zmask[ny][nx]&&(zVal=void 0),Array.isArray(cd0.text)&&Array.isArray(cd0.text[ny])&&(text=cd0.text[ny][nx]);var dummyAx={type:"linear",range:range,hoverformat:zhoverformat,_separators:xa._separators,_numFormat:xa._numFormat};return zLabel=_$axes_584.tickText(dummyAx,zVal,"hover").text,[_$lib_539.extendFlat(pointData,{index:[ny,nx],distance:pointData.maxHoverDistance,spikeDistance:pointData.maxSpikeDistance,x0:x0,x1:x1,y0:y0,y1:y1,xLabelVal:xl,yLabelVal:yl,zLabelVal:zVal,zLabel:zLabel,text:text})]},_$hoverPoints_757=function hoverPoints(pointData,xval,yval,hovermode,hoverLayer){var hoverData=_$hoverPoints_781(pointData,xval,yval,0,0,!0);return hoverData&&hoverData.forEach(function(hoverPt){var trace=hoverPt.trace;"constraint"===trace.contours.type&&(trace.fillcolor&&_$color_411.opacity(trace.fillcolor)?hoverPt.color=_$color_411.addOpacity(trace.fillcolor,1):trace.contours.showlines&&_$color_411.opacity(trace.line.color)&&(hoverPt.color=_$color_411.addOpacity(trace.line.color,1)))}),hoverData},_$close_boundaries_746=function(pathinfo,operation,perimeter,trace){var i,v1,v2,pi0=pathinfo[0],na=pi0.x.length,nb=pi0.y.length,z=pi0.z,contours=trace.contours,boundaryMax=-1/0,boundaryMin=1/0;for(i=0;i<nb;i++)boundaryMin=Math.min(boundaryMin,z[i][0]),boundaryMin=Math.min(boundaryMin,z[i][na-1]),boundaryMax=Math.max(boundaryMax,z[i][0]),boundaryMax=Math.max(boundaryMax,z[i][na-1]);for(i=1;i<na-1;i++)boundaryMin=Math.min(boundaryMin,z[0][i]),boundaryMin=Math.min(boundaryMin,z[nb-1][i]),boundaryMax=Math.max(boundaryMax,z[0][i]),boundaryMax=Math.max(boundaryMax,z[nb-1][i]);switch(pi0.prefixBoundary=!1,operation){case">":contours.value>boundaryMax&&(pi0.prefixBoundary=!0);break;case"<":contours.value<boundaryMin&&(pi0.prefixBoundary=!0);break;case"[]":v1=Math.min.apply(null,contours.value),((v2=Math.max.apply(null,contours.value))<boundaryMin||v1>boundaryMax)&&(pi0.prefixBoundary=!0);break;case"][":v1=Math.min.apply(null,contours.value),v2=Math.max.apply(null,contours.value),v1<boundaryMin&&v2>boundaryMax&&(pi0.prefixBoundary=!0)}},_$constants_748={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}},_$convert_to_constraints_752=function(pathinfo,operation){var i,pi0,pi1,op0=function(arr){return arr.reverse()},op1=function(arr){return arr};switch(operation){case"=":case"<":return pathinfo;case">":for(1!==pathinfo.length&&_$lib_539.warn("Contour data invalid for the specified inequality operation."),pi0=pathinfo[0],i=0;i<pi0.edgepaths.length;i++)pi0.edgepaths[i]=op0(pi0.edgepaths[i]);for(i=0;i<pi0.paths.length;i++)pi0.paths[i]=op0(pi0.paths[i]);return pathinfo;case"][":var tmp=op0;op0=op1,op1=tmp;case"[]":for(2!==pathinfo.length&&_$lib_539.warn("Contour data invalid for the specified inequality range operation."),pi0=copyPathinfo(pathinfo[0]),pi1=copyPathinfo(pathinfo[1]),i=0;i<pi0.edgepaths.length;i++)pi0.edgepaths[i]=op0(pi0.edgepaths[i]);for(i=0;i<pi0.paths.length;i++)pi0.paths[i]=op0(pi0.paths[i]);for(;pi1.edgepaths.length;)pi0.edgepaths.push(op1(pi1.edgepaths.shift()));for(;pi1.paths.length;)pi0.paths.push(op1(pi1.paths.shift()));return[pi0]}};function copyPathinfo(pi){return _$lib_539.extendFlat({},pi,{edgepaths:_$lib_539.extendDeep([],pi.edgepaths),paths:_$lib_539.extendDeep([],pi.paths)})}var _$constraint_mapping_750={"[]":makeRangeSettings("[]"),"][":makeRangeSettings("]["),">":makeInequalitySettings(">"),"<":makeInequalitySettings("<"),"=":makeInequalitySettings("=")};function coerceValue(operation,value){var coercedValue,hasArrayValue=Array.isArray(value);function coerce(value){return _$fastIsnumeric_139(value)?+value:null}return-1!==_$filter_ops_512.COMPARISON_OPS2.indexOf(operation)?coercedValue=coerce(hasArrayValue?value[0]:value):-1!==_$filter_ops_512.INTERVAL_OPS.indexOf(operation)?coercedValue=hasArrayValue?[coerce(value[0]),coerce(value[1])]:[coerce(value),coerce(value)]:-1!==_$filter_ops_512.SET_OPS.indexOf(operation)&&(coercedValue=hasArrayValue?value.map(coerce):[coerce(value)]),coercedValue}function makeRangeSettings(operation){return function(value){value=coerceValue(operation,value);var min=Math.min(value[0],value[1]),max=Math.max(value[0],value[1]);return{start:min,end:max,size:max-min}}}function makeInequalitySettings(operation){return function(value){return{start:value=coerceValue(operation,value),end:1/0,size:1/0}}}var _$emptyPathinfo_754=function emptyPathinfo(contours,plotinfo,cd0){for(var contoursFinal="constraint"===contours.type?_$constraint_mapping_750[contours._operation](contours.value):contours,cs=contoursFinal.size,pathinfo=[],end=_$endPlus_755(contoursFinal),carpet=cd0.trace.carpetTrace,basePathinfo=carpet?{xaxis:carpet.aaxis,yaxis:carpet.baxis,x:cd0.a,y:cd0.b}:{xaxis:plotinfo.xaxis,yaxis:plotinfo.yaxis,x:cd0.x,y:cd0.y},ci=contoursFinal.start;ci<end;ci+=cs)if(pathinfo.push(_$lib_539.extendFlat({level:ci,crossings:{},starts:[],edgepaths:[],paths:[],z:cd0.z,smoothing:cd0.trace.line.smoothing},basePathinfo)),pathinfo.length>1e3){_$lib_539.warn("Too many contours, clipping at 1000",contours);break}return pathinfo},_$findAllPaths_756=function findAllPaths(pathinfo,xtol,ytol){var cnt,i,pi,j;for(xtol=xtol||.01,ytol=ytol||.01,i=0;i<pathinfo.length;i++){for(pi=pathinfo[i],j=0;j<pi.starts.length;j++)makePath(pi,pi.starts[j],"edge",xtol,ytol);for(cnt=0;Object.keys(pi.crossings).length&&cnt<1e4;)cnt++,makePath(pi,Object.keys(pi.crossings)[0].split(",").map(Number),void 0,xtol,ytol);1e4===cnt&&_$lib_539.log("Infinite loop in contour?")}};function equalPts(pt1,pt2,xtol,ytol){return Math.abs(pt1[0]-pt2[0])<xtol&&Math.abs(pt1[1]-pt2[1])<ytol}function makePath(pi,loc,edgeflag,xtol,ytol){var cnt,startLocStr=loc.join(","),locStr=startLocStr,mi=pi.crossings[locStr],marchStep=function startStep(mi,edgeflag,loc){var dx=0,dy=0;mi>20&&edgeflag?208===mi||1114===mi?dx=0===loc[0]?1:-1:dy=0===loc[1]?1:-1:-1!==_$constants_748.BOTTOMSTART.indexOf(mi)?dy=1:-1!==_$constants_748.LEFTSTART.indexOf(mi)?dx=1:-1!==_$constants_748.TOPSTART.indexOf(mi)?dy=-1:dx=-1;return[dx,dy]}(mi,edgeflag,loc),pts=[getInterpPx(pi,loc,[-marchStep[0],-marchStep[1]])],startStepStr=marchStep.join(","),m=pi.z.length,n=pi.z[0].length;for(cnt=0;cnt<1e4;cnt++){if(mi>20?(mi=_$constants_748.CHOOSESADDLE[mi][(marchStep[0]||marchStep[1])<0?0:1],pi.crossings[locStr]=_$constants_748.SADDLEREMAINDER[mi]):delete pi.crossings[locStr],!(marchStep=_$constants_748.NEWDELTA[mi])){_$lib_539.log("Found bad marching index:",mi,loc,pi.level);break}pts.push(getInterpPx(pi,loc,marchStep)),loc[0]+=marchStep[0],loc[1]+=marchStep[1],equalPts(pts[pts.length-1],pts[pts.length-2],xtol,ytol)&&pts.pop(),locStr=loc.join(",");var atEdge=marchStep[0]&&(loc[0]<0||loc[0]>n-2)||marchStep[1]&&(loc[1]<0||loc[1]>m-2);if(locStr===startLocStr&&marchStep.join(",")===startStepStr||edgeflag&&atEdge)break;mi=pi.crossings[locStr]}1e4===cnt&&_$lib_539.log("Infinite loop in contour?");var distgroup,cnt2,cnt3,newpt,ptcnt,ptavg,thisdist,i,j,edgepathi,edgepathj,pt1,pt2,dx,dy,closedpath=equalPts(pts[0],pts[pts.length-1],xtol,ytol),totaldist=0,distThresholdFactor=.2*pi.smoothing,alldists=[],cropstart=0;for(cnt=1;cnt<pts.length;cnt++)pt1=pts[cnt],pt2=pts[cnt-1],void 0,void 0,dx=pt1[2]-pt2[2],dy=pt1[3]-pt2[3],totaldist+=thisdist=Math.sqrt(dx*dx+dy*dy),alldists.push(thisdist);var distThreshold=totaldist/alldists.length*distThresholdFactor;function getpt(i){return pts[i%pts.length]}for(cnt=pts.length-2;cnt>=cropstart;cnt--)if((distgroup=alldists[cnt])<distThreshold){for(cnt3=0,cnt2=cnt-1;cnt2>=cropstart&&distgroup+alldists[cnt2]<distThreshold;cnt2--)distgroup+=alldists[cnt2];if(closedpath&&cnt===pts.length-2)for(cnt3=0;cnt3<cnt2&&distgroup+alldists[cnt3]<distThreshold;cnt3++)distgroup+=alldists[cnt3];ptcnt=cnt-cnt2+cnt3+1,ptavg=Math.floor((cnt+cnt2+cnt3+2)/2),newpt=closedpath||cnt!==pts.length-2?closedpath||-1!==cnt2?ptcnt%2?getpt(ptavg):[(getpt(ptavg)[0]+getpt(ptavg+1)[0])/2,(getpt(ptavg)[1]+getpt(ptavg+1)[1])/2]:pts[0]:pts[pts.length-1],pts.splice(cnt2+1,cnt-cnt2+1,newpt),cnt=cnt2+1,cnt3&&(cropstart=cnt3),closedpath&&(cnt===pts.length-2?pts[cnt3]=pts[pts.length-1]:0===cnt&&(pts[pts.length-1]=pts[0]))}for(pts.splice(0,cropstart),cnt=0;cnt<pts.length;cnt++)pts[cnt].length=2;if(!(pts.length<2))if(closedpath)pts.pop(),pi.paths.push(pts);else{edgeflag||_$lib_539.log("Unclosed interior contour?",pi.level,startLocStr,pts.join("L"));var merged=!1;for(i=0;i<pi.edgepaths.length;i++)if(edgepathi=pi.edgepaths[i],!merged&&equalPts(edgepathi[0],pts[pts.length-1],xtol,ytol)){pts.pop(),merged=!0;var doublemerged=!1;for(j=0;j<pi.edgepaths.length;j++)if(equalPts((edgepathj=pi.edgepaths[j])[edgepathj.length-1],pts[0],xtol,ytol)){doublemerged=!0,pts.shift(),pi.edgepaths.splice(i,1),j===i?pi.paths.push(pts.concat(edgepathj)):(j>i&&j--,pi.edgepaths[j]=edgepathj.concat(pts,edgepathi));break}doublemerged||(pi.edgepaths[i]=pts.concat(edgepathi))}for(i=0;i<pi.edgepaths.length&&!merged;i++)equalPts((edgepathi=pi.edgepaths[i])[edgepathi.length-1],pts[0],xtol,ytol)&&(pts.shift(),pi.edgepaths[i]=edgepathi.concat(pts),merged=!0);merged||pi.edgepaths.push(pts)}}function getInterpPx(pi,loc,step){var locx=loc[0]+Math.max(step[0],0),locy=loc[1]+Math.max(step[1],0),zxy=pi.z[locy][locx],xa=pi.xaxis,ya=pi.yaxis;if(step[1]){var dx=(pi.level-zxy)/(pi.z[locy][locx+1]-zxy);return[xa.c2p((1-dx)*pi.x[locx]+dx*pi.x[locx+1],!0),ya.c2p(pi.y[locy],!0),locx+dx,locy]}var dy=(pi.level-zxy)/(pi.z[locy+1][locx]-zxy);return[xa.c2p(pi.x[locx],!0),ya.c2p((1-dy)*pi.y[locy]+dy*pi.y[locy+1],!0),locx,locy+dy]}var _$makeCrossings_761=function makeCrossings(pathinfo){var xi,yi,startIndices,ystartIndices,label,corners,mi,pi,i,z=pathinfo[0].z,m=z.length,n=z[0].length,twoWide=2===m||2===n;for(yi=0;yi<m-1;yi++)for(ystartIndices=[],0===yi&&(ystartIndices=ystartIndices.concat(_$constants_748.BOTTOMSTART)),yi===m-2&&(ystartIndices=ystartIndices.concat(_$constants_748.TOPSTART)),xi=0;xi<n-1;xi++)for(startIndices=ystartIndices.slice(),0===xi&&(startIndices=startIndices.concat(_$constants_748.LEFTSTART)),xi===n-2&&(startIndices=startIndices.concat(_$constants_748.RIGHTSTART)),label=xi+","+yi,corners=[[z[yi][xi],z[yi][xi+1]],[z[yi+1][xi],z[yi+1][xi+1]]],i=0;i<pathinfo.length;i++)(mi=getMarchingIndex((pi=pathinfo[i]).level,corners))&&(pi.crossings[label]=mi,-1!==startIndices.indexOf(mi)&&(pi.starts.push([xi,yi]),twoWide&&-1!==startIndices.indexOf(mi,startIndices.indexOf(mi)+1)&&pi.starts.push([xi,yi])))};function getMarchingIndex(val,corners){var mi=(corners[0][0]>val?0:1)+(corners[0][1]>val?0:2)+(corners[1][1]>val?0:4)+(corners[1][0]>val?0:8);return 5===mi||10===mi?val>(corners[0][0]+corners[0][1]+corners[1][0]+corners[1][1])/4?5===mi?713:1114:5===mi?104:208:15===mi?0:mi}var _$plot_786=function(gd,plotinfo,cdheatmaps){for(var i=0;i<cdheatmaps.length;i++)__plotOne_786(gd,plotinfo,cdheatmaps[i])};function __plotOne_786(gd,plotinfo,cd){var cd0=cd[0],trace=cd0.trace,uid=trace.uid,xa=plotinfo.xaxis,ya=plotinfo.yaxis,fullLayout=gd._fullLayout,id="hm"+uid;if(fullLayout._paper.selectAll(".contour"+uid).remove(),fullLayout._infolayer.selectAll("g.rangeslider-container").selectAll(".contour"+uid).remove(),!0!==trace.visible)return fullLayout._paper.selectAll("."+id).remove(),void fullLayout._infolayer.selectAll(".cb"+uid).remove();var left,right,temp,top,bottom,i,z=cd0.z,x=cd0.x,y=cd0.y,xc=cd0.xCenter,yc=cd0.yCenter,isContour=_$registry_668.traceIs(trace,"contour"),zsmooth=isContour?"best":trace.zsmooth,m=z.length,n=_$maxRowLength_785(z),xrev=!1,yrev=!1;for(i=0;void 0===left&&i<x.length-1;)left=xa.c2p(x[i]),i++;for(i=x.length-1;void 0===right&&i>0;)right=xa.c2p(x[i]),i--;for(right<left&&(temp=right,right=left,left=temp,xrev=!0),i=0;void 0===top&&i<y.length-1;)top=ya.c2p(y[i]),i++;for(i=y.length-1;void 0===bottom&&i>0;)bottom=ya.c2p(y[i]),i--;if(bottom<top&&(temp=top,top=bottom,bottom=temp,yrev=!0),isContour&&(xc=x,yc=y,x=cd0.xfill,y=cd0.yfill),"fast"!==zsmooth){var extra="best"===zsmooth?0:.5;left=Math.max(-extra*xa._length,left),right=Math.min((1+extra)*xa._length,right),top=Math.max(-extra*ya._length,top),bottom=Math.min((1+extra)*ya._length,bottom)}var imageWidth=Math.round(right-left),imageHeight=Math.round(bottom-top),isOffScreen=imageWidth<=0||imageHeight<=0,plotgroup=plotinfo.plot.select(".imagelayer").selectAll("g.hm."+id).data(isOffScreen?[]:[0]);if(plotgroup.enter().append("g").classed("hm",!0).classed(id,!0),plotgroup.exit().remove(),!isOffScreen){var canvasW,canvasH;"fast"===zsmooth?(canvasW=n,canvasH=m):(canvasW=imageWidth,canvasH=imageHeight);var canvas=document.createElement("canvas");canvas.width=canvasW,canvas.height=canvasH;var xpx,ypx,context=canvas.getContext("2d"),sclFunc=_$colorscale_426.makeColorScaleFunc(_$colorscale_426.extractScale(trace.colorscale,trace.zmin,trace.zmax),{noNumericCheck:!0,returnArray:!0});"fast"===zsmooth?(xpx=xrev?function(index){return n-1-index}:_$lib_539.identity,ypx=yrev?function(index){return m-1-index}:_$lib_539.identity):(xpx=function(index){return _$lib_539.constrain(Math.round(xa.c2p(x[index])-left),0,imageWidth)},ypx=function(index){return _$lib_539.constrain(Math.round(ya.c2p(y[index])-top),0,imageHeight)});var xb,j,xi,row,c,yi=ypx(0),yb=[yi,yi],xbi=xrev?0:1,ybi=yrev?0:1,pixcount=0,rcount=0,gcount=0,bcount=0;if(zsmooth){var pixels,pxIndex=0;try{pixels=new Uint8Array(imageWidth*imageHeight*4)}catch(e){pixels=new Array(imageWidth*imageHeight*4)}if("best"===zsmooth){var yinterp,r0,r1,xForPx=xc||x,yForPx=yc||y,xPixArray=new Array(xForPx.length),yPixArray=new Array(yForPx.length),xinterpArray=new Array(imageWidth),findInterpX=xc?findInterpFromCenters:findInterp,findInterpY=yc?findInterpFromCenters:findInterp;for(i=0;i<xForPx.length;i++)xPixArray[i]=Math.round(xa.c2p(xForPx[i])-left);for(i=0;i<yForPx.length;i++)yPixArray[i]=Math.round(ya.c2p(yForPx[i])-top);for(i=0;i<imageWidth;i++)xinterpArray[i]=findInterpX(i,xPixArray);for(j=0;j<imageHeight;j++)for(r0=z[(yinterp=findInterpY(j,yPixArray)).bin0],r1=z[yinterp.bin1],i=0;i<imageWidth;i++,pxIndex+=4)putColor(pixels,pxIndex,c=interpColor(r0,r1,xinterpArray[i],yinterp))}else for(j=0;j<m;j++)for(row=z[j],yb=ypx(j),i=0;i<imageWidth;i++)c=setColor(row[i],1),putColor(pixels,pxIndex=4*(yb*imageWidth+xpx(i)),c);var imageData=context.createImageData(imageWidth,imageHeight);try{imageData.data.set(pixels)}catch(e){var pxArray=imageData.data,dlen=pxArray.length;for(j=0;j<dlen;j++)pxArray[j]=pixels[j]}context.putImageData(imageData,0,0)}else{var xGap=trace.xgap,yGap=trace.ygap,xGapLeft=Math.floor(xGap/2),yGapTop=Math.floor(yGap/2);for(j=0;j<m;j++)if(row=z[j],yb.reverse(),yb[ybi]=ypx(j+1),yb[0]!==yb[1]&&void 0!==yb[0]&&void 0!==yb[1])for(xb=[xi=xpx(0),xi],i=0;i<n;i++)xb.reverse(),xb[xbi]=xpx(i+1),xb[0]!==xb[1]&&void 0!==xb[0]&&void 0!==xb[1]&&(c=setColor(row[i],(xb[1]-xb[0])*(yb[1]-yb[0])),context.fillStyle="rgba("+c.join(",")+")",context.fillRect(xb[0]+xGapLeft,yb[0]+yGapTop,xb[1]-xb[0]-xGap,yb[1]-yb[0]-yGap))}rcount=Math.round(rcount/pixcount),gcount=Math.round(gcount/pixcount),bcount=Math.round(bcount/pixcount);var avgColor=_$tinycolor_352("rgb("+rcount+","+gcount+","+bcount+")");gd._hmpixcount=(gd._hmpixcount||0)+pixcount,gd._hmlumcount=(gd._hmlumcount||0)+pixcount*avgColor.getLuminance();var image3=plotgroup.selectAll("image").data(cd);image3.enter().append("svg:image").attr({xmlns:_$xmlns_namespaces_519.svg,preserveAspectRatio:"none"}),image3.attr({height:imageHeight,width:imageWidth,x:left,y:top,"xlink:href":canvas.toDataURL("image/png")}),image3.exit().remove()}function setColor(v,pixsize){if(void 0!==v){var c=sclFunc(v);return c[0]=Math.round(c[0]),c[1]=Math.round(c[1]),c[2]=Math.round(c[2]),pixcount+=pixsize,rcount+=c[0]*pixsize,gcount+=c[1]*pixsize,bcount+=c[2]*pixsize,c}return[0,0,0,0]}function interpColor(r0,r1,xinterp,yinterp){var z00=r0[xinterp.bin0];if(void 0===z00)return setColor(void 0,1);var dxy,z01=r0[xinterp.bin1],z10=r1[xinterp.bin0],z11=r1[xinterp.bin1],dx=z01-z00||0,dy=z10-z00||0;return dxy=void 0===z01?void 0===z11?0:void 0===z10?2*(z11-z00):2*(2*z11-z10-z00)/3:void 0===z11?void 0===z10?0:2*(2*z00-z01-z10)/3:void 0===z10?2*(2*z11-z01-z00)/3:z11+z00-z01-z10,setColor(z00+xinterp.frac*dx+yinterp.frac*(dy+xinterp.frac*dxy))}}function findInterp(pixel,pixArray){var maxBin=pixArray.length-2,bin=_$lib_539.constrain(_$lib_539.findBin(pixel,pixArray),0,maxBin),pix0=pixArray[bin],pix1=pixArray[bin+1],interp=_$lib_539.constrain(bin+(pixel-pix0)/(pix1-pix0)-.5,0,maxBin),bin0=Math.round(interp),frac=Math.abs(interp-bin0);return interp&&interp!==maxBin&&frac?{bin0:bin0,frac:frac,bin1:Math.round(bin0+frac/(interp-bin0))}:{bin0:bin0,bin1:bin0,frac:0}}function findInterpFromCenters(pixel,centerPixArray){var maxBin=centerPixArray.length-1,bin=_$lib_539.constrain(_$lib_539.findBin(pixel,centerPixArray),0,maxBin),pix0=centerPixArray[bin],frac=(pixel-pix0)/(centerPixArray[bin+1]-pix0)||0;return frac<=0?{bin0:bin,bin1:bin,frac:0}:frac<.5?{bin0:bin,bin1:bin+1,frac:frac}:{bin0:bin+1,bin1:bin,frac:1-frac}}function putColor(pixels,pxIndex,c){pixels[pxIndex]=c[0],pixels[pxIndex+1]=c[1],pixels[pxIndex+2]=c[2],pixels[pxIndex+3]=Math.round(255*c[3])}var _$plot_762={},costConstants=_$constants_748.LABELOPTIMIZER;function __plotOne_762(gd,plotinfo,cd){var trace=cd[0].trace,x=cd[0].x,y=cd[0].y,contours=trace.contours,uid=trace.uid,xa=plotinfo.xaxis,ya=plotinfo.yaxis,fullLayout=gd._fullLayout,id="contour"+uid,pathinfo=_$emptyPathinfo_754(contours,plotinfo,cd[0]);if(!0!==trace.visible)return fullLayout._paper.selectAll("."+id+",.hm"+uid).remove(),void fullLayout._infolayer.selectAll(".cb"+uid).remove();"heatmap"===contours.coloring?(trace.zauto&&!1===trace.autocontour&&(trace._input.zmin=trace.zmin=contours.start-contours.size/2,trace._input.zmax=trace.zmax=trace.zmin+pathinfo.length*contours.size),_$plot_786(gd,plotinfo,[cd])):(fullLayout._paper.selectAll(".hm"+uid).remove(),fullLayout._infolayer.selectAll("g.rangeslider-container").selectAll(".hm"+uid).remove()),_$makeCrossings_761(pathinfo),_$findAllPaths_756(pathinfo);var leftedge=xa.c2p(x[0],!0),rightedge=xa.c2p(x[x.length-1],!0),bottomedge=ya.c2p(y[0],!0),topedge=ya.c2p(y[y.length-1],!0),perimeter=[[leftedge,topedge],[rightedge,topedge],[rightedge,bottomedge],[leftedge,bottomedge]],fillPathinfo=pathinfo;"constraint"===contours.type&&(fillPathinfo=_$convert_to_constraints_752(pathinfo,contours._operation),_$close_boundaries_746(fillPathinfo,contours._operation,perimeter,trace));var plotGroup=_$plot_762.makeContourGroup(plotinfo,cd,id);!function makeBackground(plotgroup,perimeter,contours){var bggroup=plotgroup.selectAll("g.contourbg").data([0]);bggroup.enter().append("g").classed("contourbg",!0);var bgfill=bggroup.selectAll("path").data("fill"===contours.coloring?[0]:[]);bgfill.enter().append("path"),bgfill.exit().remove(),bgfill.attr("d","M"+perimeter.join("L")+"Z").style("stroke","none")}(plotGroup,perimeter,contours),function makeFills(plotgroup,pathinfo,perimeter,contours){var fillgroup=plotgroup.selectAll("g.contourfill").data([0]);fillgroup.enter().append("g").classed("contourfill",!0);var fillitems=fillgroup.selectAll("path").data("fill"===contours.coloring||"constraint"===contours.type&&"="!==contours._operation?pathinfo:[]);fillitems.enter().append("path"),fillitems.exit().remove(),fillitems.each(function(pi){var fullpath=joinAllPaths(pi,perimeter);fullpath?_$d3_127.select(this).attr("d",fullpath).style("stroke","none"):_$d3_127.select(this).remove()})}(plotGroup,fillPathinfo,perimeter,contours),function makeLinesAndLabels(plotgroup,pathinfo,gd,cd0,contours,perimeter){var lineContainer=plotgroup.selectAll("g.contourlines").data([0]);lineContainer.enter().append("g").classed("contourlines",!0);var showLines=!1!==contours.showlines,showLabels=contours.showlabels,clipLinesForLabels=showLines&&showLabels,linegroup=_$plot_762.createLines(lineContainer,showLines||showLabels,pathinfo),lineClip=_$plot_762.createLineClip(lineContainer,clipLinesForLabels,gd._fullLayout._clips,cd0.trace.uid),labelGroup=plotgroup.selectAll("g.contourlabels").data(showLabels?[0]:[]);if(labelGroup.exit().remove(),labelGroup.enter().append("g").classed("contourlabels",!0),showLabels){var labelClipPathData=[perimeter],labelData=[];_$lib_539.clearLocationCache();var contourFormat=_$plot_762.labelFormatter(contours,cd0.t.cb,gd._fullLayout),dummyText=_$drawing_436.tester.append("text").attr("data-notex",1).call(_$drawing_436.font,contours.labelfont),xLen=pathinfo[0].xaxis._length,yLen=pathinfo[0].yaxis._length,bounds={left:Math.max(perimeter[0][0],0),right:Math.min(perimeter[2][0],xLen),top:Math.max(perimeter[0][1],0),bottom:Math.min(perimeter[2][1],yLen)};bounds.middle=(bounds.top+bounds.bottom)/2,bounds.center=(bounds.left+bounds.right)/2;var plotDiagonal=Math.sqrt(xLen*xLen+yLen*yLen),normLength=_$constants_748.LABELDISTANCE*plotDiagonal/Math.max(1,pathinfo.length/_$constants_748.LABELINCREASE);linegroup.each(function(d){var textOpts=_$plot_762.calcTextOpts(d.level,contourFormat,dummyText,gd);_$d3_127.select(this).selectAll("path").each(function(){var pathBounds=_$lib_539.getVisibleSegment(this,bounds,textOpts.height/2);if(pathBounds&&!(pathBounds.len<(textOpts.width+textOpts.height)*_$constants_748.LABELMIN))for(var maxLabels=Math.min(Math.ceil(pathBounds.len/normLength),_$constants_748.LABELMAX),i=0;i<maxLabels;i++){var loc=_$plot_762.findBestTextLocation(this,pathBounds,textOpts,labelData,bounds);if(!loc)break;_$plot_762.addLabelData(loc,textOpts,labelData,labelClipPathData)}})}),dummyText.remove(),_$plot_762.drawLabels(labelGroup,labelData,gd,lineClip,clipLinesForLabels?labelClipPathData:null)}showLabels&&!showLines&&linegroup.remove()}(plotGroup,pathinfo,gd,cd[0],contours,perimeter),function clipGaps(plotGroup,plotinfo,clips,cd0,perimeter){var clipId="clip"+cd0.trace.uid,clipPath=clips.selectAll("#"+clipId).data(cd0.trace.connectgaps?[]:[0]);if(clipPath.enter().append("clipPath").classed("contourclip",!0).attr("id",clipId),clipPath.exit().remove(),!1===cd0.trace.connectgaps){var clipPathInfo={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:plotinfo.xaxis,yaxis:plotinfo.yaxis,x:cd0.x,y:cd0.y,z:function makeClipMask(cd0){var i,emptyPoint,empties=cd0.trace._emptypoints,z=[],m=cd0.z.length,n=cd0.z[0].length,row=[];for(i=0;i<n;i++)row.push(1);for(i=0;i<m;i++)z.push(row.slice());for(i=0;i<empties.length;i++)emptyPoint=empties[i],z[emptyPoint[0]][emptyPoint[1]]=0;return cd0.zmask=z,z}(cd0),smoothing:0};_$makeCrossings_761([clipPathInfo]),_$findAllPaths_756([clipPathInfo]);var fullpath=joinAllPaths(clipPathInfo,perimeter),path=clipPath.selectAll("path").data([0]);path.enter().append("path"),path.attr("d",fullpath)}else clipId=null;plotGroup.call(_$drawing_436.setClipUrl,clipId),plotinfo.plot.selectAll(".hm"+cd0.trace.uid).call(_$drawing_436.setClipUrl,clipId)}(plotGroup,plotinfo,fullLayout._clips,cd[0],perimeter)}function joinAllPaths(pi,perimeter){var endpt,newendpt,cnt,nexti,possiblei,addpath,pt,fullpath=function initFullPath(pi,perimeter){var prefixBoundary=pi.prefixBoundary;if(void 0===prefixBoundary){var edgeVal2=Math.min(pi.z[0][0],pi.z[0][1]);prefixBoundary=!pi.edgepaths.length&&edgeVal2>pi.level}return prefixBoundary?"M"+perimeter.join("L")+"Z":""}(pi,perimeter),i=0,startsleft=pi.edgepaths.map(function(v,i){return i}),newloop=!0;function isbottom(pt){return Math.abs(pt[1]-perimeter[2][1])<.01}function isleft(pt){return Math.abs(pt[0]-perimeter[0][0])<.01}function isright(pt){return Math.abs(pt[0]-perimeter[2][0])<.01}for(;startsleft.length;){for(addpath=_$drawing_436.smoothopen(pi.edgepaths[i],pi.smoothing),fullpath+=newloop?addpath:addpath.replace(/^M/,"L"),startsleft.splice(startsleft.indexOf(i),1),endpt=pi.edgepaths[i][pi.edgepaths[i].length-1],nexti=-1,cnt=0;cnt<4;cnt++){if(!endpt){_$lib_539.log("Missing end?",i,pi);break}for(pt=endpt,Math.abs(pt[1]-perimeter[0][1])<.01&&!isright(endpt)?newendpt=perimeter[1]:isleft(endpt)?newendpt=perimeter[0]:isbottom(endpt)?newendpt=perimeter[3]:isright(endpt)&&(newendpt=perimeter[2]),possiblei=0;possiblei<pi.edgepaths.length;possiblei++){var ptNew=pi.edgepaths[possiblei][0];Math.abs(endpt[0]-newendpt[0])<.01?Math.abs(endpt[0]-ptNew[0])<.01&&(ptNew[1]-endpt[1])*(newendpt[1]-ptNew[1])>=0&&(newendpt=ptNew,nexti=possiblei):Math.abs(endpt[1]-newendpt[1])<.01?Math.abs(endpt[1]-ptNew[1])<.01&&(ptNew[0]-endpt[0])*(newendpt[0]-ptNew[0])>=0&&(newendpt=ptNew,nexti=possiblei):_$lib_539.log("endpt to newendpt is not vert. or horz.",endpt,newendpt,ptNew)}if(endpt=newendpt,nexti>=0)break;fullpath+="L"+newendpt}if(nexti===pi.edgepaths.length){_$lib_539.log("unclosed perimeter path");break}i=nexti,(newloop=-1===startsleft.indexOf(i))&&(i=startsleft[0],fullpath+="Z")}for(i=0;i<pi.paths.length;i++)fullpath+=_$drawing_436.smoothclosed(pi.paths[i],pi.smoothing);return fullpath}function locationCost(loc,textOpts,labelData,bounds){var halfWidth=textOpts.width/2,halfHeight=textOpts.height/2,x=loc.x,y=loc.y,theta=loc.theta,dx=Math.cos(theta)*halfWidth,dy=Math.sin(theta)*halfWidth,normX=(x>bounds.center?bounds.right-x:x-bounds.left)/(dx+Math.abs(Math.sin(theta)*halfHeight)),normY=(y>bounds.middle?bounds.bottom-y:y-bounds.top)/(Math.abs(dy)+Math.cos(theta)*halfHeight);if(normX<1||normY<1)return 1/0;var cost=costConstants.EDGECOST*(1/(normX-1)+1/(normY-1));cost+=costConstants.ANGLECOST*theta*theta;for(var x1=x-dx,y1=y-dy,x2=x+dx,y2=y+dy,i=0;i<labelData.length;i++){var labeli=labelData[i],dxd=Math.cos(labeli.theta)*labeli.width/2,dyd=Math.sin(labeli.theta)*labeli.width/2,dist=2*_$lib_539.segmentDistance(x1,y1,x2,y2,labeli.x-dxd,labeli.y-dyd,labeli.x+dxd,labeli.y+dyd)/(textOpts.height+labeli.height),sameLevel=labeli.level===textOpts.level,distOffset=sameLevel?costConstants.SAMELEVELDISTANCE:1;if(dist<=distOffset)return 1/0;cost+=costConstants.NEIGHBORCOST*(sameLevel?costConstants.SAMELEVELFACTOR:1)/(dist-distOffset)}return cost}_$plot_762.plot=function plot(gd,plotinfo,cdcontours){for(var i=0;i<cdcontours.length;i++)__plotOne_762(gd,plotinfo,cdcontours[i])},_$plot_762.makeContourGroup=function(plotinfo,cd,id){var plotgroup=plotinfo.plot.select(".maplayer").selectAll("g.contour."+id).data(cd);return plotgroup.enter().append("g").classed("contour",!0).classed(id,!0),plotgroup.exit().remove(),plotgroup},_$plot_762.createLines=function(lineContainer,makeLines,pathinfo){var smoothing=pathinfo[0].smoothing,linegroup=lineContainer.selectAll("g.contourlevel").data(makeLines?pathinfo:[]);if(linegroup.exit().remove(),linegroup.enter().append("g").classed("contourlevel",!0),makeLines){var opencontourlines=linegroup.selectAll("path.openline").data(function(d){return d.pedgepaths||d.edgepaths});opencontourlines.exit().remove(),opencontourlines.enter().append("path").classed("openline",!0),opencontourlines.attr("d",function(d){return _$drawing_436.smoothopen(d,smoothing)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var closedcontourlines=linegroup.selectAll("path.closedline").data(function(d){return d.ppaths||d.paths});closedcontourlines.exit().remove(),closedcontourlines.enter().append("path").classed("closedline",!0),closedcontourlines.attr("d",function(d){return _$drawing_436.smoothclosed(d,smoothing)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return linegroup},_$plot_762.createLineClip=function(lineContainer,clipLinesForLabels,clips,uid){var clipId=clipLinesForLabels?"clipline"+uid:null,lineClip=clips.selectAll("#"+clipId).data(clipLinesForLabels?[0]:[]);return lineClip.exit().remove(),lineClip.enter().append("clipPath").classed("contourlineclip",!0).attr("id",clipId),_$drawing_436.setClipUrl(lineContainer,clipId),lineClip},_$plot_762.labelFormatter=function(contours,colorbar,fullLayout){if(contours.labelformat)return fullLayout._d3locale.numberFormat(contours.labelformat);var formatAxis;if(colorbar)formatAxis=colorbar.axis;else{if(formatAxis={type:"linear",_id:"ycontour",showexponent:"all"},"constraint"===contours.type){var value=contours.value;Array.isArray(value)?formatAxis.range=[value[0],value[value.length-1]]:formatAxis.range=[value,value]}else formatAxis.range=[contours.start,contours.end],formatAxis.nticks=(contours.end-contours.start)/contours.size;formatAxis.range[0]===formatAxis.range[1]&&(formatAxis.range[1]+=formatAxis.range[0]||1),formatAxis.nticks||(formatAxis.nticks=1e3),_$setConvert_603(formatAxis,fullLayout),_$axes_584.prepTicks(formatAxis),formatAxis._tmin=null,formatAxis._tmax=null}return function(v){return _$axes_584.tickText(formatAxis,v).text}},_$plot_762.calcTextOpts=function(level,contourFormat,dummyText,gd){var text=contourFormat(level);dummyText.text(text).call(_$svg_text_utils_562.convertToTspans,gd);var bBox=_$drawing_436.bBox(dummyText.node(),!0);return{text:text,width:bBox.width,height:bBox.height,level:level,dy:(bBox.top+bBox.bottom)/2}},_$plot_762.findBestTextLocation=function(path,pathBounds,textOpts,labelData,plotBounds){var p0,dp,pMax,pMin,loc,textWidth=textOpts.width;pathBounds.isClosed?(dp=pathBounds.len/costConstants.INITIALSEARCHPOINTS,p0=pathBounds.min+dp/2,pMax=pathBounds.max):(dp=(pathBounds.len-textWidth)/(costConstants.INITIALSEARCHPOINTS+1),p0=pathBounds.min+dp+textWidth/2,pMax=pathBounds.max-(dp+textWidth)/2);for(var cost=1/0,j=0;j<costConstants.ITERATIONS;j++){for(var p=p0;p<pMax;p+=dp){var newLocation=_$lib_539.getTextLocation(path,pathBounds.total,p,textWidth),newCost=locationCost(newLocation,textOpts,labelData,plotBounds);newCost<cost&&(cost=newCost,loc=newLocation,pMin=p)}if(cost>2*costConstants.MAXCOST)break;j&&(dp/=2),pMax=(p0=pMin-dp/2)+1.5*dp}if(cost<=costConstants.MAXCOST)return loc},_$plot_762.addLabelData=function(loc,textOpts,labelData,labelClipPathData){var halfWidth=textOpts.width/2,halfHeight=textOpts.height/2,x=loc.x,y=loc.y,theta=loc.theta,sin=Math.sin(theta),cos=Math.cos(theta),dxw=halfWidth*cos,dxh=halfHeight*sin,dyw=halfWidth*sin,dyh=-halfHeight*cos,bBoxPts=[[x-dxw-dxh,y-dyw-dyh],[x+dxw-dxh,y+dyw-dyh],[x+dxw+dxh,y+dyw+dyh],[x-dxw+dxh,y-dyw+dyh]];labelData.push({text:textOpts.text,x:x,y:y,dy:textOpts.dy,theta:theta,level:textOpts.level,width:textOpts.width,height:textOpts.height}),labelClipPathData.push(bBoxPts)},_$plot_762.drawLabels=function(labelGroup,labelData,gd,lineClip,labelClipPathData){var labels=labelGroup.selectAll("text").data(labelData,function(d){return d.text+","+d.x+","+d.y+","+d.theta});if(labels.exit().remove(),labels.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(d){var x=d.x+Math.sin(d.theta)*d.dy,y=d.y-Math.cos(d.theta)*d.dy;_$d3_127.select(this).text(d.text).attr({x:x,y:y,transform:"rotate("+180*d.theta/Math.PI+" "+x+" "+y+")"}).call(_$svg_text_utils_562.convertToTspans,gd)}),labelClipPathData){for(var clipPath="",i=0;i<labelClipPathData.length;i++)clipPath+="M"+labelClipPathData[i].join("L")+"Z";var lineClipPath=lineClip.selectAll("path").data([0]);lineClipPath.enter().append("path"),lineClipPath.attr("d",clipPath)}};var _$style_787=function style(gd){_$d3_127.select(gd).selectAll(".hm image").style("opacity",function(d){return d.trace.opacity})},_$style_764=function style(gd){var contours=_$d3_127.select(gd).selectAll("g.contour");contours.style("opacity",function(d){return d.trace.opacity}),contours.each(function(d){var c=_$d3_127.select(this),trace=d.trace,contours=trace.contours,line=trace.line,cs=contours.size||1,start=contours.start,isConstraintType="constraint"===contours.type,colorLines=!isConstraintType&&"lines"===contours.coloring,colorFills=!isConstraintType&&"fill"===contours.coloring,colorMap=colorLines||colorFills?_$makeColorMap_760(trace):null;c.selectAll("g.contourlevel").each(function(d){_$d3_127.select(this).selectAll("path").call(_$drawing_436.lineGroupStyle,line.width,colorLines?colorMap(d.level):line.color,line.dash)});var labelFont=contours.labelfont;if(c.selectAll("g.contourlabels text").each(function(d){_$drawing_436.font(_$d3_127.select(this),{family:labelFont.family,size:labelFont.size,color:labelFont.color||(colorLines?colorMap(d.level):line.color)})}),isConstraintType)c.selectAll("g.contourfill path").style("fill",trace.fillcolor);else if(colorFills){var firstFill;c.selectAll("g.contourfill path").style("fill",function(d){return void 0===firstFill&&(firstFill=d.level),colorMap(d.level+.5*cs)}),void 0===firstFill&&(firstFill=start),c.selectAll("g.contourbg path").style("fill",colorMap(firstFill-.5*cs))}}),_$style_787(gd)},Contour={};Contour.attributes=_$attributes_744,Contour.supplyDefaults=function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_744,attr,dflt)}if(_$handleXYZDefaults_789(traceIn,traceOut,coerce,layout)){coerce("text");var isConstraint="constraint"===coerce("contours.type");coerce("connectgaps",_$has_columns_780(traceOut)),isConstraint||delete traceOut.showlegend,isConstraint?_$handleConstraintDefaults_749(traceIn,traceOut,coerce,layout,defaultColor):(_$handleContourDefaults_751(0,traceOut,coerce,function coerce2(attr){return _$lib_539.coerce2(traceIn,traceOut,_$attributes_744,attr)}),_$handleStyleDefaults_765(traceIn,traceOut,coerce,layout))}else traceOut.visible=!1},Contour.calc=_$calc_745,Contour.plot=_$plot_762.plot,Contour.style=_$style_764,Contour.colorbar=_$colorbar_747,Contour.hoverPoints=_$hoverPoints_757,Contour.moduleType="trace",Contour.name="contour",Contour.basePlotModule=_$cartesian_595,Contour.categories=["cartesian","2dMap","contour","showLegend"],Contour.meta={};var _$contour_10=Contour,contourContourAttrs=_$attributes_744.contours,__extendFlat_766=_$extend_528.extendFlat,__scatterLineAttrs_766=_$attributes_862.line,_$attributes_766=__extendFlat_766({},{carpet:{valType:"string",editType:"calc"},z:_$attributes_773.z,a:_$attributes_773.x,a0:_$attributes_773.x0,da:_$attributes_773.dx,b:_$attributes_773.y,b0:_$attributes_773.y0,db:_$attributes_773.dy,text:_$attributes_773.text,transpose:_$attributes_773.transpose,atype:_$attributes_773.xtype,btype:_$attributes_773.ytype,fillcolor:_$attributes_744.fillcolor,autocontour:_$attributes_744.autocontour,ncontours:_$attributes_744.ncontours,contours:{type:contourContourAttrs.type,start:contourContourAttrs.start,end:contourContourAttrs.end,size:contourContourAttrs.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:contourContourAttrs.showlines,showlabels:contourContourAttrs.showlabels,labelfont:contourContourAttrs.labelfont,labelformat:contourContourAttrs.labelformat,operation:contourContourAttrs.operation,value:contourContourAttrs.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:__extendFlat_766({},__scatterLineAttrs_766.color,{}),width:__scatterLineAttrs_766.width,dash:__scatterLineAttrs_766.dash,smoothing:__extendFlat_766({},__scatterLineAttrs_766.smoothing,{}),editType:"plot"}},_$attributes_417,{autocolorscale:__extendFlat_766({},_$attributes_417.autocolorscale,{dflt:!1})},{colorbar:_$attributes_412}),_$lookup_carpetid_726=function(gd,trace){for(var firstAxis,n=gd._fullData.length,i=0;i<n;i++){var maybeCarpet=gd._fullData[i];if(maybeCarpet.index!==trace.index&&("carpet"===maybeCarpet.type&&(firstAxis||(firstAxis=maybeCarpet),maybeCarpet.carpet===trace.carpet)))return maybeCarpet}return firstAxis},_$supplyDefaults_768=function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_766,attr,dflt)}if(coerce("carpet"),traceIn.a&&traceIn.b){if(!_$handleXYZDefaults_789(traceIn,traceOut,coerce,layout,"a","b"))return void(traceOut.visible=!1);coerce("text");var isConstraint="constraint"===coerce("contours.type");isConstraint||delete traceOut.showlegend,isConstraint?_$handleConstraintDefaults_749(traceIn,traceOut,coerce,layout,defaultColor,{hasHover:!1}):(_$handleContourDefaults_751(0,traceOut,coerce,function coerce2(attr){return _$lib_539.coerce2(traceIn,traceOut,_$attributes_766,attr)}),_$handleStyleDefaults_765(traceIn,traceOut,coerce,layout,{hasHover:!1}))}else traceOut._defaultColor=defaultColor};var __isArrayOrTypedArray_709=_$lib_539.isArrayOrTypedArray,_$axis_aligned_line_709=function(carpet,carpetcd,a,b){var idx,tangent,tanIsoIdx,tanIsoPar,segment,refidx,p0,p1,v0,v1,start,end,range,axis=__isArrayOrTypedArray_709(a)?"a":"b",smoothing=("a"===axis?carpet.aaxis:carpet.baxis).smoothing,toIdx="a"===axis?carpet.a2i:carpet.b2j,pt="a"===axis?a:b,iso="a"===axis?b:a,n="a"===axis?carpetcd.a.length:carpetcd.b.length,m="a"===axis?carpetcd.b.length:carpetcd.a.length,isoIdx=Math.floor("a"===axis?carpet.b2j(iso):carpet.a2i(iso)),xy="a"===axis?function(value){return carpet.evalxy([],value,isoIdx)}:function(value){return carpet.evalxy([],isoIdx,value)};smoothing&&(tanIsoIdx=Math.max(0,Math.min(m-2,isoIdx)),tanIsoPar=isoIdx-tanIsoIdx,tangent="a"===axis?function(i,ti){return carpet.dxydi([],i,tanIsoIdx,ti,tanIsoPar)}:function(j,tj){return carpet.dxydj([],tanIsoIdx,j,tanIsoPar,tj)});var vstart=toIdx(pt[0]),vend=toIdx(pt[1]),dir=vstart<vend?1:-1,tol=1e-8*(vend-vstart),dirfloor=dir>0?Math.floor:Math.ceil,dirceil=dir>0?Math.ceil:Math.floor,dirmin=dir>0?Math.min:Math.max,dirmax=dir>0?Math.max:Math.min,idx0=dirfloor(vstart+tol),idx1=dirceil(vend-tol),segments=[[p0=xy(vstart)]];for(idx=idx0;idx*dir<idx1*dir;idx+=dir)segment=[],start=dirmax(vstart,idx),range=(end=dirmin(vend,idx+dir))-start,refidx=Math.max(0,Math.min(n-2,Math.floor(.5*(start+end)))),p1=xy(end),smoothing&&(v0=tangent(refidx,start-refidx),v1=tangent(refidx,end-refidx),segment.push([p0[0]+v0[0]/3*range,p0[1]+v0[1]/3*range]),segment.push([p1[0]-v1[0]/3*range,p1[1]-v1[1]/3*range])),segment.push(p1),segments.push(segment),p0=p1;return segments},_$joinAllPaths_770=function joinAllPaths(trace,pi,perimeter,ab2p,carpet,carpetcd,xa,ya){var i,endpt,newendpt,cnt,nexti,possiblei,addpath,fullpath="",startsleft=pi.edgepaths.map(function(v,i){return i}),newloop=!0,atol=1e-4*Math.abs(perimeter[0][0]-perimeter[2][0]),btol=1e-4*Math.abs(perimeter[0][1]-perimeter[2][1]);function istop(pt){return Math.abs(pt[1]-perimeter[0][1])<btol}function isbottom(pt){return Math.abs(pt[1]-perimeter[2][1])<btol}function isleft(pt){return Math.abs(pt[0]-perimeter[0][0])<atol}function isright(pt){return Math.abs(pt[0]-perimeter[2][0])<atol}function pathto(pt0,pt1){var i,j,segments,axis,path="";for(istop(pt0)&&!isright(pt0)||isbottom(pt0)&&!isleft(pt0)?(axis=carpet.aaxis,segments=_$axis_aligned_line_709(carpet,carpetcd,[pt0[0],pt1[0]],.5*(pt0[1]+pt1[1]))):(axis=carpet.baxis,segments=_$axis_aligned_line_709(carpet,carpetcd,.5*(pt0[0]+pt1[0]),[pt0[1],pt1[1]])),i=1;i<segments.length;i++)for(path+=axis.smoothing?"C":"L",j=0;j<segments[i].length;j++){var pt=segments[i][j];path+=[xa.c2p(pt[0]),ya.c2p(pt[1])]+" "}return path}for(i=0,endpt=null;startsleft.length;){var startpt=pi.edgepaths[i][0];for(endpt&&(fullpath+=pathto(endpt,startpt)),addpath=_$drawing_436.smoothopen(pi.edgepaths[i].map(ab2p),pi.smoothing),fullpath+=newloop?addpath:addpath.replace(/^M/,"L"),startsleft.splice(startsleft.indexOf(i),1),endpt=pi.edgepaths[i][pi.edgepaths[i].length-1],nexti=-1,cnt=0;cnt<4;cnt++){if(!endpt){_$lib_539.log("Missing end?",i,pi);break}for(istop(endpt)&&!isright(endpt)?newendpt=perimeter[1]:isleft(endpt)?newendpt=perimeter[0]:isbottom(endpt)?newendpt=perimeter[3]:isright(endpt)&&(newendpt=perimeter[2]),possiblei=0;possiblei<pi.edgepaths.length;possiblei++){var ptNew=pi.edgepaths[possiblei][0];Math.abs(endpt[0]-newendpt[0])<atol?Math.abs(endpt[0]-ptNew[0])<atol&&(ptNew[1]-endpt[1])*(newendpt[1]-ptNew[1])>=0&&(newendpt=ptNew,nexti=possiblei):Math.abs(endpt[1]-newendpt[1])<btol?Math.abs(endpt[1]-ptNew[1])<btol&&(ptNew[0]-endpt[0])*(newendpt[0]-ptNew[0])>=0&&(newendpt=ptNew,nexti=possiblei):_$lib_539.log("endpt to newendpt is not vert. or horz.",endpt,newendpt,ptNew)}if(nexti>=0)break;fullpath+=pathto(endpt,newendpt),endpt=newendpt}if(nexti===pi.edgepaths.length){_$lib_539.log("unclosed perimeter path");break}i=nexti,(newloop=-1===startsleft.indexOf(i))&&(i=startsleft[0],fullpath+=pathto(endpt,newendpt)+"Z",endpt=null)}for(i=0;i<pi.paths.length;i++)fullpath+=_$drawing_436.smoothclosed(pi.paths[i].map(ab2p),pi.smoothing);return fullpath},_$mapPathinfo_771=function mapPathinfo(pathinfo,map){var i,j,k,pi,pedgepaths,ppaths,pedgepath,ppath,path;for(i=0;i<pathinfo.length;i++){for(pedgepaths=(pi=pathinfo[i]).pedgepaths=[],ppaths=pi.ppaths=[],j=0;j<pi.edgepaths.length;j++){for(path=pi.edgepaths[j],pedgepath=[],k=0;k<path.length;k++)pedgepath[k]=map(path[k]);pedgepaths.push(pedgepath)}for(j=0;j<pi.paths.length;j++){for(path=pi.paths[j],ppath=[],k=0;k<path.length;k++)ppath[k]=map(path[k]);ppaths.push(ppath)}}};function __plotOne_772(gd,plotinfo,cd){var trace=cd[0].trace,carpet=trace.carpetTrace=_$lookup_carpetid_726(gd,trace),carpetcd=gd.calcdata[carpet.index][0];if(carpet.visible&&"legendonly"!==carpet.visible){var a=cd[0].a,b=cd[0].b,contours=trace.contours,uid=trace.uid,xa=plotinfo.xaxis,ya=plotinfo.yaxis,fullLayout=gd._fullLayout,id="contour"+uid,pathinfo=_$emptyPathinfo_754(contours,plotinfo,cd[0]),isConstraint="constraint"===contours.type,operation=contours._operation,coloring=isConstraint?"="===operation?"lines":"fill":contours.coloring;if(!0===trace.visible){var perimeter=[[a[0],b[b.length-1]],[a[a.length-1],b[b.length-1]],[a[a.length-1],b[0]],[a[0],b[0]]];_$makeCrossings_761(pathinfo);var atol=1e-8*(a[a.length-1]-a[0]),btol=1e-8*(b[b.length-1]-b[0]);_$findAllPaths_756(pathinfo,atol,btol);var fillPathinfo=pathinfo;"constraint"===contours.type&&(fillPathinfo=_$convert_to_constraints_752(pathinfo,operation),_$close_boundaries_746(fillPathinfo,operation,perimeter,trace)),_$mapPathinfo_771(pathinfo,ab2p);var seg,xp,yp,i,plotGroup=_$plot_762.makeContourGroup(plotinfo,cd,id),segs=[];for(i=carpetcd.clipsegments.length-1;i>=0;i--)seg=carpetcd.clipsegments[i],xp=_$mapArray_728([],seg.x,xa.c2p),yp=_$mapArray_728([],seg.y,ya.c2p),xp.reverse(),yp.reverse(),segs.push(_$makePath_727(xp,yp,seg.bicubic));var boundaryPath="M"+segs.join("L")+"Z";!function __makeBackground_772(plotgroup,clipsegments,xaxis,yaxis,isConstraint,coloring){var seg,xp,yp,i,bggroup=plotgroup.selectAll("g.contourbg").data([0]);bggroup.enter().append("g").classed("contourbg",!0);var bgfill=bggroup.selectAll("path").data("fill"!==coloring||isConstraint?[]:[0]);bgfill.enter().append("path"),bgfill.exit().remove();var segs=[];for(i=0;i<clipsegments.length;i++)seg=clipsegments[i],xp=_$mapArray_728([],seg.x,xaxis.c2p),yp=_$mapArray_728([],seg.y,yaxis.c2p),segs.push(_$makePath_727(xp,yp,seg.bicubic));bgfill.attr("d","M"+segs.join("L")+"Z").style("stroke","none")}(plotGroup,carpetcd.clipsegments,xa,ya,isConstraint,coloring),function __makeFills_772(trace,plotgroup,xa,ya,pathinfo,perimeter,ab2p,carpet,carpetcd,coloring,boundaryPath){var fillgroup=plotgroup.selectAll("g.contourfill").data([0]);fillgroup.enter().append("g").classed("contourfill",!0);var fillitems=fillgroup.selectAll("path").data("fill"===coloring?pathinfo:[]);fillitems.enter().append("path"),fillitems.exit().remove(),fillitems.each(function(pi){var fullpath=_$joinAllPaths_770(trace,pi,perimeter,ab2p,carpet,carpetcd,xa,ya);pi.prefixBoundary&&(fullpath=boundaryPath+fullpath),fullpath?_$d3_127.select(this).attr("d",fullpath).style("stroke","none"):_$d3_127.select(this).remove()})}(trace,plotGroup,xa,ya,fillPathinfo,perimeter,ab2p,carpet,carpetcd,coloring,boundaryPath),function __makeLinesAndLabels_772(plotgroup,pathinfo,gd,cd0,contours,plotinfo,carpet){var lineContainer=plotgroup.selectAll("g.contourlines").data([0]);lineContainer.enter().append("g").classed("contourlines",!0);var showLines=!1!==contours.showlines,showLabels=contours.showlabels,clipLinesForLabels=showLines&&showLabels,linegroup=_$plot_762.createLines(lineContainer,showLines||showLabels,pathinfo),lineClip=_$plot_762.createLineClip(lineContainer,clipLinesForLabels,gd._fullLayout._defs,cd0.trace.uid),labelGroup=plotgroup.selectAll("g.contourlabels").data(showLabels?[0]:[]);if(labelGroup.exit().remove(),labelGroup.enter().append("g").classed("contourlabels",!0),showLabels){var xa=plotinfo.xaxis,ya=plotinfo.yaxis,xLen=xa._length,yLen=ya._length,labelClipPathData=[[[0,0],[xLen,0],[xLen,yLen],[0,yLen]]],labelData=[];_$lib_539.clearLocationCache();var contourFormat=_$plot_762.labelFormatter(contours,cd0.t.cb,gd._fullLayout),dummyText=_$drawing_436.tester.append("text").attr("data-notex",1).call(_$drawing_436.font,contours.labelfont),bounds={left:0,right:xLen,center:xLen/2,top:0,bottom:yLen,middle:yLen/2},plotDiagonal=Math.sqrt(xLen*xLen+yLen*yLen),normLength=_$constants_748.LABELDISTANCE*plotDiagonal/Math.max(1,pathinfo.length/_$constants_748.LABELINCREASE);linegroup.each(function(d){var textOpts=_$plot_762.calcTextOpts(d.level,contourFormat,dummyText,gd);_$d3_127.select(this).selectAll("path").each(function(pathData){var pathBounds=_$lib_539.getVisibleSegment(this,bounds,textOpts.height/2);if(pathBounds&&(function constrainToCarpet(path,pathData,levelData,pathBounds,carpet,textHeight){for(var pathABData,i=0;i<levelData.pedgepaths.length;i++)pathData===levelData.pedgepaths[i]&&(pathABData=levelData.edgepaths[i]);if(!pathABData)return;var aMin=carpet.a[0],aMax=carpet.a[carpet.a.length-1],bMin=carpet.b[0],bMax=carpet.b[carpet.b.length-1];function getOffset(abPt,pathVector){var edgeVector,offset=0;return(Math.abs(abPt[0]-aMin)<.1||Math.abs(abPt[0]-aMax)<.1)&&(edgeVector=normalizeVector(carpet.dxydb_rough(abPt[0],abPt[1],.1)),offset=Math.max(offset,textHeight*vectorTan(pathVector,edgeVector)/2)),(Math.abs(abPt[1]-bMin)<.1||Math.abs(abPt[1]-bMax)<.1)&&(edgeVector=normalizeVector(carpet.dxyda_rough(abPt[0],abPt[1],.1)),offset=Math.max(offset,textHeight*vectorTan(pathVector,edgeVector)/2)),offset}var startVector=getUnitVector(path,0,1),endVector=getUnitVector(path,pathBounds.total,pathBounds.total-1),minStart=getOffset(pathABData[0],startVector),maxEnd=pathBounds.total-getOffset(pathABData[pathABData.length-1],endVector);pathBounds.min<minStart&&(pathBounds.min=minStart);pathBounds.max>maxEnd&&(pathBounds.max=maxEnd);pathBounds.len=pathBounds.max-pathBounds.min}(this,pathData,d,pathBounds,carpet,textOpts.height),!(pathBounds.len<(textOpts.width+textOpts.height)*_$constants_748.LABELMIN)))for(var maxLabels=Math.min(Math.ceil(pathBounds.len/normLength),_$constants_748.LABELMAX),i=0;i<maxLabels;i++){var loc=_$plot_762.findBestTextLocation(this,pathBounds,textOpts,labelData,bounds);if(!loc)break;_$plot_762.addLabelData(loc,textOpts,labelData,labelClipPathData)}})}),dummyText.remove(),_$plot_762.drawLabels(labelGroup,labelData,gd,lineClip,clipLinesForLabels?labelClipPathData:null)}showLabels&&!showLines&&linegroup.remove()}(plotGroup,pathinfo,gd,cd[0],contours,plotinfo,carpet),_$drawing_436.setClipUrl(plotGroup,carpet._clipPathId)}else fullLayout._infolayer.selectAll(".cb"+uid).remove()}function ab2p(ab){var pt=carpet.ab2xy(ab[0],ab[1],!0);return[xa.c2p(pt[0]),ya.c2p(pt[1])]}}function getUnitVector(path,p0,p1){var pt0=path.getPointAtLength(p0),pt1=path.getPointAtLength(p1),dx=pt1.x-pt0.x,dy=pt1.y-pt0.y,len=Math.sqrt(dx*dx+dy*dy);return[dx/len,dy/len]}function normalizeVector(v){var len=Math.sqrt(v[0]*v[0]+v[1]*v[1]);return[v[0]/len,v[1]/len]}function vectorTan(v0,v1){var cos=Math.abs(v0[0]*v1[0]+v0[1]*v1[1]);return Math.sqrt(1-cos*cos)/cos}var ContourCarpet={};ContourCarpet.attributes=_$attributes_766,ContourCarpet.supplyDefaults=_$supplyDefaults_768,ContourCarpet.colorbar=_$colorbar_747,ContourCarpet.calc=function calc(gd,trace){var carpet=trace.carpetTrace=_$lookup_carpetid_726(gd,trace);if(carpet&&carpet.visible&&"legendonly"!==carpet.visible){if(!trace.a||!trace.b){var carpetdata=gd.data[carpet.index],tracedata=gd.data[trace.index];tracedata.a||(tracedata.a=carpetdata.a),tracedata.b||(tracedata.b=carpetdata.b),_$supplyDefaults_768(tracedata,trace,trace._defaultColor,gd._fullLayout)}var cd=function heatmappishCalc(gd,trace){var a,a0,da,b,b0,db,z,carpet=trace.carpetTrace,aax=carpet.aaxis,bax=carpet.baxis;aax._minDtick=0,bax._minDtick=0,_$has_columns_780(trace)&&_$convertColumnData_777(trace,aax,bax,"a","b",["z"]),a=trace.a?aax.makeCalcdata(trace,"a"):[],b=trace.b?bax.makeCalcdata(trace,"b"):[],a0=trace.a0||0,da=trace.da||1,b0=trace.b0||0,db=trace.db||1,z=_$clean2dArray_775(trace.z,trace.transpose),trace._emptypoints=_$findEmpties_779(z),trace._interpz=_$interp2d_783(z,trace._emptypoints,trace._interpz);var xlen=_$maxRowLength_785(z),xIn="scaled"===trace.xtype?"":a,xArray=_$makeBoundArray_784(trace,xIn,a0,da,xlen,aax),yIn="scaled"===trace.ytype?"":b,yArray=_$makeBoundArray_784(trace,yIn,b0,db,z.length,bax),cd0={a:xArray,b:yArray,z:z};return"levels"===trace.contours.type&&_$calc_418(trace,z,"","z"),[cd0]}(0,trace);return _$setContours_763(trace),cd}},ContourCarpet.plot=function plot(gd,plotinfo,cdcontours){for(var i=0;i<cdcontours.length;i++)__plotOne_772(gd,plotinfo,cdcontours[i])},ContourCarpet.style=_$style_764,ContourCarpet.moduleType="trace",ContourCarpet.name="contourcarpet",ContourCarpet.basePlotModule=_$cartesian_595,ContourCarpet.categories=["cartesian","carpet","contour","symbols","showLegend","hasLines","carpetDependent"],ContourCarpet.meta={};var _$contourcarpet_11=ContourCarpet,rules={"X,X div":"font-family:'Open Sans', verdana, arial, sans-serif;margin:0;padding:0;","X input,X button":"font-family:'Open Sans', verdana, arial, sans-serif;","X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .modebar":"position:absolute;top:2px;right:2px;z-index:1001;background:rgba(255,255,255,0.7);","X .modebar--hover":"opacity:0;-webkit-transition:opacity 0.3s ease 0s;-moz-transition:opacity 0.3s ease 0s;-ms-transition:opacity 0.3s ease 0s;-o-transition:opacity 0.3s ease 0s;transition:opacity 0.3s ease 0s;","X:hover .modebar--hover":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;margin-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-group:first-child":"margin-left:0px;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar-btn path":"fill:rgba(0,31,95,0.3);","X .modebar-btn.active path,X .modebar-btn:hover path":"fill:rgba(0,22,72,0.5);","X .modebar-btn.modebar-btn--logo":"padding:3px 1px;","X .modebar-btn.modebar-btn--logo path":"fill:#447adb !important;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":"content:'';position:absolute;background:transparent;border:6px solid transparent;z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;","X [data-title]:after":"content:attr(data-title);background:#69738a;color:white;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .select-outline":"fill:none;stroke-width:1;shape-rendering:crispEdges;","X .select-outline-1":"stroke:white;","X .select-outline-2":"stroke:black;stroke-dasharray:2px 2px;",Y:"font-family:'Open Sans';position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;","Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,0.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:0.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var selector in rules){var fullSelector=selector.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");_$lib_539.addStyleRule(fullSelector,rules[selector])}var _$browser_304,cachedSetTimeout,cachedClearTimeout,_$ploticon_2={undo:{width:857.1,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",ascent:850,descent:-150},home:{width:928.6,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",ascent:850,descent:-150},"camera-retro":{width:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",ascent:850,descent:-150},zoombox:{width:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",ascent:850,descent:-150},pan:{width:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",ascent:850,descent:-150},zoom_plus:{width:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",ascent:850,descent:-150},zoom_minus:{width:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",ascent:850,descent:-150},autoscale:{width:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",ascent:850,descent:-150},tooltip_basic:{width:1500,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",ascent:850,descent:-150},tooltip_compare:{width:1125,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",ascent:850,descent:-150},plotlylogo:{width:1542,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",ascent:850,descent:-150},"z-axis":{width:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",ascent:850,descent:-150},"3d_rotate":{width:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",ascent:850,descent:-150},camera:{width:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",ascent:850,descent:-150},movie:{width:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",ascent:850,descent:-150},question:{width:857.1,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",ascent:850,descent:-150},disk:{width:857.1,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",ascent:850,descent:-150},lasso:{width:1031,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",ascent:850,descent:-150},selectbox:{width:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",ascent:850,descent:-150},spikeline:{width:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",ascent:850,descent:-150}},process=_$browser_304={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function __noop_304(){}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=__noop_304,process.addListener=__noop_304,process.once=__noop_304,process.off=__noop_304,process.removeListener=__noop_304,process.removeAllListeners=__noop_304,process.emit=__noop_304,process.prependListener=__noop_304,process.prependOnceListener=__noop_304,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};var _$es6Promise_136={exports:{}};(function(process,global){!function(global,factory){"object"==typeof _$es6Promise_136.exports?_$es6Promise_136.exports=factory():global.ES6Promise=factory()}(this,function(){"use strict";function isFunction(x){return"function"==typeof x}var isArray=Array.isArray?Array.isArray:function(x){return"[object Array]"===Object.prototype.toString.call(x)},len=0,vertxNext=void 0,customSchedulerFn=void 0,asap=function asap(callback,arg){queue[len]=callback,queue[len+1]=arg,2===(len+=2)&&(customSchedulerFn?customSchedulerFn(flush):scheduleFlush())};var browserWindow="undefined"!=typeof window?window:void 0,browserGlobal=browserWindow||{},BrowserMutationObserver=browserGlobal.MutationObserver||browserGlobal.WebKitMutationObserver,isNode="undefined"==typeof self&&void 0!==process&&"[object process]"==={}.toString.call(process),isWorker="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function useSetTimeout(){var globalSetTimeout=setTimeout;return function(){return globalSetTimeout(flush,1)}}var queue=new Array(1e3);function flush(){for(var i=0;i<len;i+=2){(0,queue[i])(queue[i+1]),queue[i]=void 0,queue[i+1]=void 0}len=0}var scheduleFlush=void 0;function then(onFulfillment,onRejection){var _arguments=arguments,parent=this,child=new this.constructor(noop);void 0===child[PROMISE_ID]&&makePromise(child);var callback,_state=parent._state;return _state?(callback=_arguments[_state-1],asap(function(){return invokeCallback(_state,child,callback,parent._result)})):subscribe(parent,child,onFulfillment,onRejection),child}function resolve(object){if(object&&"object"==typeof object&&object.constructor===this)return object;var promise=new this(noop);return _resolve(promise,object),promise}scheduleFlush=isNode?function useNextTick(){return function(){return process.nextTick(flush)}}():BrowserMutationObserver?function useMutationObserver(){var iterations=0,observer=new BrowserMutationObserver(flush),node=document.createTextNode("");return observer.observe(node,{characterData:!0}),function(){node.data=iterations=++iterations%2}}():isWorker?function useMessageChannel(){var channel=new MessageChannel;return channel.port1.onmessage=flush,function(){return channel.port2.postMessage(0)}}():void 0===browserWindow?function attemptVertx(){try{var vertx=__webpack_require__(!function webpackMissingModule(){var e=new Error('Cannot find module "vertx"');throw e.code="MODULE_NOT_FOUND",e}());return vertxNext=vertx.runOnLoop||vertx.runOnContext,function useVertxTimer(){return function(){vertxNext(flush)}}()}catch(e){return useSetTimeout()}}():useSetTimeout();var PROMISE_ID=Math.random().toString(36).substring(16);function noop(){}var PENDING=void 0,FULFILLED=1,REJECTED=2,GET_THEN_ERROR=new ErrorObject;function getThen(promise){try{return promise.then}catch(error){return GET_THEN_ERROR.error=error,GET_THEN_ERROR}}function handleMaybeThenable(promise,maybeThenable,then$$){maybeThenable.constructor===promise.constructor&&then$$===then&&maybeThenable.constructor.resolve===resolve?function handleOwnThenable(promise,thenable){thenable._state===FULFILLED?fulfill(promise,thenable._result):thenable._state===REJECTED?_reject(promise,thenable._result):subscribe(thenable,void 0,function(value){return _resolve(promise,value)},function(reason){return _reject(promise,reason)})}(promise,maybeThenable):then$$===GET_THEN_ERROR?_reject(promise,GET_THEN_ERROR.error):void 0===then$$?fulfill(promise,maybeThenable):isFunction(then$$)?function handleForeignThenable(promise,thenable,then){asap(function(promise){var sealed=!1,error=function tryThen(then,value,fulfillmentHandler,rejectionHandler){try{then.call(value,fulfillmentHandler,rejectionHandler)}catch(e){return e}}(then,thenable,function(value){sealed||(sealed=!0,thenable!==value?_resolve(promise,value):fulfill(promise,value))},function(reason){sealed||(sealed=!0,_reject(promise,reason))},promise._label);!sealed&&error&&(sealed=!0,_reject(promise,error))},promise)}(promise,maybeThenable,then$$):fulfill(promise,maybeThenable)}function _resolve(promise,value){promise===value?_reject(promise,function selfFulfillment(){return new TypeError("You cannot resolve a promise with itself")}()):!function objectOrFunction(x){return"function"==typeof x||"object"==typeof x&&null!==x}(value)?fulfill(promise,value):handleMaybeThenable(promise,value,getThen(value))}function publishRejection(promise){promise._onerror&&promise._onerror(promise._result),publish(promise)}function fulfill(promise,value){promise._state===PENDING&&(promise._result=value,promise._state=FULFILLED,0!==promise._subscribers.length&&asap(publish,promise))}function _reject(promise,reason){promise._state===PENDING&&(promise._state=REJECTED,promise._result=reason,asap(publishRejection,promise))}function subscribe(parent,child,onFulfillment,onRejection){var _subscribers=parent._subscribers,length=_subscribers.length;parent._onerror=null,_subscribers[length]=child,_subscribers[length+FULFILLED]=onFulfillment,_subscribers[length+REJECTED]=onRejection,0===length&&parent._state&&asap(publish,parent)}function publish(promise){var subscribers=promise._subscribers,settled=promise._state;if(0!==subscribers.length){for(var child=void 0,callback=void 0,detail=promise._result,i=0;i<subscribers.length;i+=3)child=subscribers[i],callback=subscribers[i+settled],child?invokeCallback(settled,child,callback,detail):callback(detail);promise._subscribers.length=0}}function ErrorObject(){this.error=null}var TRY_CATCH_ERROR=new ErrorObject;function invokeCallback(settled,promise,callback,detail){var hasCallback=isFunction(callback),value=void 0,error=void 0,succeeded=void 0,failed=void 0;if(hasCallback){if((value=function tryCatch(callback,detail){try{return callback(detail)}catch(e){return TRY_CATCH_ERROR.error=e,TRY_CATCH_ERROR}}(callback,detail))===TRY_CATCH_ERROR?(failed=!0,error=value.error,value=null):succeeded=!0,promise===value)return void _reject(promise,function cannotReturnOwn(){return new TypeError("A promises callback cannot return that same promise.")}())}else value=detail,succeeded=!0;promise._state!==PENDING||(hasCallback&&succeeded?_resolve(promise,value):failed?_reject(promise,error):settled===FULFILLED?fulfill(promise,value):settled===REJECTED&&_reject(promise,value))}var id=0;function makePromise(promise){promise[PROMISE_ID]=id++,promise._state=void 0,promise._result=void 0,promise._subscribers=[]}function Enumerator(Constructor,input){this._instanceConstructor=Constructor,this.promise=new Constructor(noop),this.promise[PROMISE_ID]||makePromise(this.promise),isArray(input)?(this._input=input,this.length=input.length,this._remaining=input.length,this._result=new Array(this.length),0===this.length?fulfill(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&fulfill(this.promise,this._result))):_reject(this.promise,function validationError(){return new Error("Array Methods must be provided an Array")}())}function Promise(resolver){this[PROMISE_ID]=function nextId(){return id++}(),this._result=this._state=void 0,this._subscribers=[],noop!==resolver&&("function"!=typeof resolver&&function needsResolver(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof Promise?function initializePromise(promise,resolver){try{resolver(function resolvePromise(value){_resolve(promise,value)},function rejectPromise(reason){_reject(promise,reason)})}catch(e){_reject(promise,e)}}(this,resolver):function needsNew(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}function polyfill(){var local=void 0;if(void 0!==global)local=global;else if("undefined"!=typeof self)local=self;else try{local=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var P=local.Promise;if(P){var promiseToString=null;try{promiseToString=Object.prototype.toString.call(P.resolve())}catch(e){}if("[object Promise]"===promiseToString&&!P.cast)return}local.Promise=Promise}return Enumerator.prototype._enumerate=function(){for(var length=this.length,_input=this._input,i=0;this._state===PENDING&&i<length;i++)this._eachEntry(_input[i],i)},Enumerator.prototype._eachEntry=function(entry,i){var c=this._instanceConstructor,resolve$$=c.resolve;if(resolve$$===resolve){var _then=getThen(entry);if(_then===then&&entry._state!==PENDING)this._settledAt(entry._state,i,entry._result);else if("function"!=typeof _then)this._remaining--,this._result[i]=entry;else if(c===Promise){var promise=new c(noop);handleMaybeThenable(promise,entry,_then),this._willSettleAt(promise,i)}else this._willSettleAt(new c(function(resolve$$){return resolve$$(entry)}),i)}else this._willSettleAt(resolve$$(entry),i)},Enumerator.prototype._settledAt=function(state,i,value){var promise=this.promise;promise._state===PENDING&&(this._remaining--,state===REJECTED?_reject(promise,value):this._result[i]=value),0===this._remaining&&fulfill(promise,this._result)},Enumerator.prototype._willSettleAt=function(promise,i){var enumerator=this;subscribe(promise,void 0,function(value){return enumerator._settledAt(FULFILLED,i,value)},function(reason){return enumerator._settledAt(REJECTED,i,reason)})},Promise.all=function all(entries){return new Enumerator(this,entries).promise},Promise.race=function race(entries){var Constructor=this;return isArray(entries)?new Constructor(function(resolve,reject){for(var length=entries.length,i=0;i<length;i++)Constructor.resolve(entries[i]).then(resolve,reject)}):new Constructor(function(_,reject){return reject(new TypeError("You must pass an array to race."))})},Promise.resolve=resolve,Promise.reject=function reject(reason){var promise=new this(noop);return _reject(promise,reason),promise},Promise._setScheduler=function setScheduler(scheduleFn){customSchedulerFn=scheduleFn},Promise._setAsap=function setAsap(asapFn){asap=asapFn},Promise._asap=asap,Promise.prototype={constructor:Promise,then:then,catch:function _catch(onRejection){return this.then(null,onRejection)}},polyfill(),Promise.polyfill=polyfill,Promise.Promise=Promise,Promise})}).call(this,_$browser_304,void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),_$es6Promise_136=_$es6Promise_136.exports;var _$arrow_paths_393=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}],_$attributes_394={_isLinkedToArray:"annotation",visible:{valType:"boolean",dflt:!0,editType:"calcIfAutorange+arraydraw"},text:{valType:"string",editType:"calcIfAutorange+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calcIfAutorange+arraydraw"},font:_$font_attributes_611({editType:"calcIfAutorange+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calcIfAutorange+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calcIfAutorange+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calcIfAutorange+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calcIfAutorange+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calcIfAutorange+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:_$arrow_paths_393.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:_$arrow_paths_393.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calcIfAutorange+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calcIfAutorange+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calcIfAutorange+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calcIfAutorange+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calcIfAutorange+arraydraw"},ax:{valType:"any",editType:"calcIfAutorange+arraydraw"},ay:{valType:"any",editType:"calcIfAutorange+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",_$constants_589.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",_$constants_589.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",_$constants_589.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calcIfAutorange+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calcIfAutorange+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calcIfAutorange+arraydraw"},yref:{valType:"enumerated",values:["paper",_$constants_589.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calcIfAutorange+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calcIfAutorange+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calcIfAutorange+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:_$font_attributes_611({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}},_$drawArrowHead_401=function drawArrowHead(el3,ends,options){var start,end,startRot,endRot,el=el3.node(),headStyle=_$arrow_paths_393[options.arrowhead||0],startHeadStyle=_$arrow_paths_393[options.startarrowhead||0],scale=(options.arrowwidth||1)*(options.arrowsize||1),startScale=(options.arrowwidth||1)*(options.startarrowsize||1),doStart=ends.indexOf("start")>=0,doEnd=ends.indexOf("end")>=0,backOff=headStyle.backoff*scale+options.standoff,startBackOff=startHeadStyle.backoff*startScale+options.startstandoff;if("line"===el.nodeName){start={x:+el3.attr("x1"),y:+el3.attr("y1")},end={x:+el3.attr("x2"),y:+el3.attr("y2")};var dx=start.x-end.x,dy=start.y-end.y;if(endRot=(startRot=Math.atan2(dy,dx))+Math.PI,backOff&&startBackOff&&backOff+startBackOff>Math.sqrt(dx*dx+dy*dy))return void hideLine();if(backOff){if(backOff*backOff>dx*dx+dy*dy)return void hideLine();var backOffX=backOff*Math.cos(startRot),backOffY=backOff*Math.sin(startRot);end.x+=backOffX,end.y+=backOffY,el3.attr({x2:end.x,y2:end.y})}if(startBackOff){if(startBackOff*startBackOff>dx*dx+dy*dy)return void hideLine();var startBackOffX=startBackOff*Math.cos(startRot),startbackOffY=startBackOff*Math.sin(startRot);start.x-=startBackOffX,start.y-=startbackOffY,el3.attr({x1:start.x,y1:start.y})}}else if("path"===el.nodeName){var pathlen=el.getTotalLength(),dashArray="";if(pathlen<backOff+startBackOff)return void hideLine();var start0=el.getPointAtLength(0),dstart=el.getPointAtLength(.1);startRot=Math.atan2(start0.y-dstart.y,start0.x-dstart.x),start=el.getPointAtLength(Math.min(startBackOff,pathlen)),dashArray="0px,"+startBackOff+"px,";var end0=el.getPointAtLength(pathlen),dend=el.getPointAtLength(pathlen-.1);endRot=Math.atan2(end0.y-dend.y,end0.x-dend.x),end=el.getPointAtLength(Math.max(0,pathlen-backOff)),dashArray+=pathlen-(dashArray?startBackOff+backOff:backOff)+"px,"+pathlen+"px",el3.style("stroke-dasharray",dashArray)}function hideLine(){el3.style("stroke-dasharray","0px,100px")}function drawhead(arrowHeadStyle,p,rot,arrowScale){arrowHeadStyle.path&&(arrowHeadStyle.noRotate&&(rot=0),_$d3_127.select(el.parentNode).append("path").attr({class:el3.attr("class"),d:arrowHeadStyle.path,transform:"translate("+p.x+","+p.y+")"+(rot?"rotate("+180*rot/Math.PI+")":"")+"scale("+arrowScale+")"}).style({fill:_$color_411.rgb(options.arrowcolor),"stroke-width":0}))}doStart&&drawhead(startHeadStyle,start,startRot,startScale),doEnd&&drawhead(headStyle,end,endRot,scale)},_$draw_400={draw:function __draw_400(gd){var fullLayout=gd._fullLayout;fullLayout._infolayer.selectAll(".annotation").remove();for(var i=0;i<fullLayout.annotations.length;i++)fullLayout.annotations[i].visible&&drawOne(gd,i);return _$plots_647.previousPromises(gd)},drawOne:drawOne,drawRaw:drawRaw};function drawOne(gd,index){var options=gd._fullLayout.annotations[index]||{};drawRaw(gd,options,index,!1,_$axes_584.getFromId(gd,options.xref),_$axes_584.getFromId(gd,options.yref))}function drawRaw(gd,options,index,subplotId,xa,ya){var className,annbase,fullLayout=gd._fullLayout,gs=gd._fullLayout._size,edits=gd._context.edits;subplotId?(className="annotation-"+subplotId,annbase=subplotId+".annotations["+index+"]"):(className="annotation",annbase="annotations["+index+"]"),fullLayout._infolayer.selectAll("."+className+'[data-index="'+index+'"]').remove();var annClipID="clip"+fullLayout._uid+"_ann"+index;if(options._input&&!1!==options.visible){var annPosPx={x:{},y:{}},textangle=+options.textangle||0,annGroup=fullLayout._infolayer.append("g").classed(className,!0).attr("data-index",String(index)).style("opacity",options.opacity),annTextGroup=annGroup.append("g").classed("annotation-text-g",!0),editTextPosition=edits[options.showarrow?"annotationTail":"annotationPosition"],textEvents=options.captureevents||edits.annotationText||editTextPosition,annTextGroupInner=annTextGroup.append("g").style("pointer-events",textEvents?"all":null).call(_$setCursor_558,"default").on("click",function(){gd._dragging=!1;var eventData={index:index,annotation:options._input,fullAnnotation:options,event:_$d3_127.event};subplotId&&(eventData.subplotId=subplotId),gd.emit("plotly_clickannotation",eventData)});options.hovertext&&annTextGroupInner.on("mouseover",function(){var hoverOptions=options.hoverlabel,hoverFont=hoverOptions.font,bBox=this.getBoundingClientRect(),bBoxRef=gd.getBoundingClientRect();_$fx_453.loneHover({x0:bBox.left-bBoxRef.left,x1:bBox.right-bBoxRef.left,y:(bBox.top+bBox.bottom)/2-bBoxRef.top,text:options.hovertext,color:hoverOptions.bgcolor,borderColor:hoverOptions.bordercolor,fontFamily:hoverFont.family,fontSize:hoverFont.size,fontColor:hoverFont.color},{container:fullLayout._hoverlayer.node(),outerContainer:fullLayout._paper.node(),gd:gd})}).on("mouseout",function(){_$fx_453.loneUnhover(fullLayout._hoverlayer.node())});var borderwidth=options.borderwidth,borderpad=options.borderpad,borderfull=borderwidth+borderpad,annTextBG=annTextGroupInner.append("rect").attr("class","bg").style("stroke-width",borderwidth+"px").call(_$color_411.stroke,options.bordercolor).call(_$color_411.fill,options.bgcolor),isSizeConstrained=options.width||options.height,annTextClip=fullLayout._topclips.selectAll("#"+annClipID).data(isSizeConstrained?[0]:[]);annTextClip.enter().append("clipPath").classed("annclip",!0).attr("id",annClipID).append("rect"),annTextClip.exit().remove();var font=options.font,annText=annTextGroupInner.append("text").classed("annotation-text",!0).text(options.text);edits.annotationText?annText.call(_$svg_text_utils_562.makeEditable,{delegate:annTextGroupInner,gd:gd}).call(textLayout).on("edit",function(_text){options.text=_text,this.call(textLayout);var update={};update[annbase+".text"]=options.text,xa&&xa.autorange&&(update[xa._name+".autorange"]=!0),ya&&ya.autorange&&(update[ya._name+".autorange"]=!0),_$registry_668.call("relayout",gd,update)}):annText.call(textLayout)}else _$d3_127.selectAll("#"+annClipID).remove();function textLayout(s){return s.call(_$drawing_436.font,font).attr({"text-anchor":{left:"start",right:"end"}[options.align]||"middle"}),_$svg_text_utils_562.convertToTspans(s,gd,drawGraphicalElements),s}function drawGraphicalElements(){var anchor3=annText.selectAll("a");1===anchor3.size()&&anchor3.text()===annText.text()&&annTextGroupInner.insert("a",":first-child").attr({"xlink:xlink:href":anchor3.attr("xlink:href"),"xlink:xlink:show":anchor3.attr("xlink:show")}).style({cursor:"pointer"}).node().appendChild(annTextBG.node());var mathjaxGroup=annTextGroupInner.select(".annotation-text-math-group"),hasMathjax=!mathjaxGroup.empty(),anntextBB=_$drawing_436.bBox((hasMathjax?mathjaxGroup:annText).node()),textWidth=anntextBB.width,textHeight=anntextBB.height,annWidth=options.width||textWidth,annHeight=options.height||textHeight,outerWidth=Math.round(annWidth+2*borderfull),outerHeight=Math.round(annHeight+2*borderfull);function shiftFraction(v,anchor){return"auto"===anchor&&(anchor=v<1/3?"left":v>2/3?"right":"center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[anchor]}options._w=annWidth,options._h=annHeight;for(var annotationIsOffscreen=!1,letters=["x","y"],i=0;i<letters.length;i++){var basePx,textPadShift,alignPosition,autoAlignFraction,textShift,axLetter=letters[i],axRef=options[axLetter+"ref"]||axLetter,tailRef=options["a"+axLetter+"ref"],ax={x:xa,y:ya}[axLetter],dimAngle=(textangle+("x"===axLetter?0:-90))*Math.PI/180,annSizeFromWidth=outerWidth*Math.cos(dimAngle),annSizeFromHeight=outerHeight*Math.sin(dimAngle),annSize=Math.abs(annSizeFromWidth)+Math.abs(annSizeFromHeight),anchor=options[axLetter+"anchor"],overallShift=options[axLetter+"shift"]*("x"===axLetter?1:-1),posPx=annPosPx[axLetter];if(ax){var posFraction=ax.r2fraction(options[axLetter]);if((gd._dragging||!ax.autorange)&&(posFraction<0||posFraction>1)&&(tailRef===axRef?((posFraction=ax.r2fraction(options["a"+axLetter]))<0||posFraction>1)&&(annotationIsOffscreen=!0):annotationIsOffscreen=!0,annotationIsOffscreen))continue;basePx=ax._offset+ax.r2p(options[axLetter]),autoAlignFraction=.5}else"x"===axLetter?(alignPosition=options[axLetter],basePx=gs.l+gs.w*alignPosition):(alignPosition=1-options[axLetter],basePx=gs.t+gs.h*alignPosition),autoAlignFraction=options.showarrow?.5:alignPosition;if(options.showarrow){posPx.head=basePx;var arrowLength=options["a"+axLetter];textShift=annSizeFromWidth*shiftFraction(.5,options.xanchor)-annSizeFromHeight*shiftFraction(.5,options.yanchor),tailRef===axRef?(posPx.tail=ax._offset+ax.r2p(arrowLength),textPadShift=textShift):(posPx.tail=basePx+arrowLength,textPadShift=textShift+arrowLength),posPx.text=posPx.tail+textShift;var maxPx=fullLayout["x"===axLetter?"width":"height"];if("paper"===axRef&&(posPx.head=_$lib_539.constrain(posPx.head,1,maxPx-1)),"pixel"===tailRef){var shiftPlus=-Math.max(posPx.tail-3,posPx.text),shiftMinus=Math.min(posPx.tail+3,posPx.text)-maxPx;shiftPlus>0?(posPx.tail+=shiftPlus,posPx.text+=shiftPlus):shiftMinus>0&&(posPx.tail-=shiftMinus,posPx.text-=shiftMinus)}posPx.tail+=overallShift,posPx.head+=overallShift}else textPadShift=textShift=annSize*shiftFraction(autoAlignFraction,anchor),posPx.text=basePx+textShift;posPx.text+=overallShift,textShift+=overallShift,textPadShift+=overallShift,options["_"+axLetter+"padplus"]=annSize/2+textPadShift,options["_"+axLetter+"padminus"]=annSize/2-textPadShift,options["_"+axLetter+"size"]=annSize,options["_"+axLetter+"shift"]=textShift}if(annotationIsOffscreen)annTextGroupInner.remove();else{var xShift=0,yShift=0;if("left"!==options.align&&(xShift=(annWidth-textWidth)*("center"===options.align?.5:1)),"top"!==options.valign&&(yShift=(annHeight-textHeight)*("middle"===options.valign?.5:1)),hasMathjax)mathjaxGroup.select("svg").attr({x:borderfull+xShift-1,y:borderfull+yShift}).call(_$drawing_436.setClipUrl,isSizeConstrained?annClipID:null);else{var texty=borderfull+yShift-anntextBB.top,textx=borderfull+xShift-anntextBB.left;annText.call(_$svg_text_utils_562.positionText,textx,texty).call(_$drawing_436.setClipUrl,isSizeConstrained?annClipID:null)}annTextClip.select("rect").call(_$drawing_436.setRect,borderfull,borderfull,annWidth,annHeight),annTextBG.call(_$drawing_436.setRect,borderwidth/2,borderwidth/2,outerWidth-borderwidth,outerHeight-borderwidth),annTextGroupInner.call(_$drawing_436.setTranslate,Math.round(annPosPx.x.text-outerWidth/2),Math.round(annPosPx.y.text-outerHeight/2)),annTextGroup.attr({transform:"rotate("+textangle+","+annPosPx.x.text+","+annPosPx.y.text+")"});var update,baseTextTransform,drawArrow=function(dx,dy){annGroup.selectAll(".annotation-arrow-g").remove();var headX=annPosPx.x.head,headY=annPosPx.y.head,tailX=annPosPx.x.tail+dx,tailY=annPosPx.y.tail+dy,textX=annPosPx.x.text+dx,textY=annPosPx.y.text+dy,transform=_$lib_539.rotationXYMatrix(textangle,textX,textY),applyTransform=_$lib_539.apply2DTransform(transform),applyTransform2=_$lib_539.apply2DTransform2(transform),width=+annTextBG.attr("width"),height=+annTextBG.attr("height"),xLeft=textX-.5*width,xRight=xLeft+width,yTop=textY-.5*height,yBottom=yTop+height,edges=[[xLeft,yTop,xLeft,yBottom],[xLeft,yBottom,xRight,yBottom],[xRight,yBottom,xRight,yTop],[xRight,yTop,xLeft,yTop]].map(applyTransform2);if(!edges.reduce(function(a,x){return a^!!_$lib_539.segmentsIntersect(headX,headY,headX+1e6,headY+1e6,x[0],x[1],x[2],x[3])},!1)){edges.forEach(function(x){var p=_$lib_539.segmentsIntersect(tailX,tailY,headX,headY,x[0],x[1],x[2],x[3]);p&&(tailX=p.x,tailY=p.y)});var strokewidth=options.arrowwidth,arrowColor=options.arrowcolor,arrowSide=options.arrowside,arrowGroup=annGroup.append("g").style({opacity:_$color_411.opacity(arrowColor)}).classed("annotation-arrow-g",!0),arrow=arrowGroup.append("path").attr("d","M"+tailX+","+tailY+"L"+headX+","+headY).style("stroke-width",strokewidth+"px").call(_$color_411.stroke,_$color_411.rgb(arrowColor));if(_$drawArrowHead_401(arrow,arrowSide,options),edits.annotationPosition&&arrow.node().parentNode&&!subplotId){var arrowDragHeadX=headX,arrowDragHeadY=headY;if(options.standoff){var arrowLength=Math.sqrt(Math.pow(headX-tailX,2)+Math.pow(headY-tailY,2));arrowDragHeadX+=options.standoff*(tailX-headX)/arrowLength,arrowDragHeadY+=options.standoff*(tailY-headY)/arrowLength}var update,annx0,anny0,arrowDrag=arrowGroup.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(tailX-arrowDragHeadX)+","+(tailY-arrowDragHeadY),transform:"translate("+arrowDragHeadX+","+arrowDragHeadY+")"}).style("stroke-width",strokewidth+6+"px").call(_$color_411.stroke,"rgba(0,0,0,0)").call(_$color_411.fill,"rgba(0,0,0,0)");_$dragelement_433.init({element:arrowDrag.node(),gd:gd,prepFn:function(){var pos=_$drawing_436.getTranslate(annTextGroupInner);annx0=pos.x,anny0=pos.y,update={},xa&&xa.autorange&&(update[xa._name+".autorange"]=!0),ya&&ya.autorange&&(update[ya._name+".autorange"]=!0)},moveFn:function(dx,dy){var annxy0=applyTransform(annx0,anny0),xcenter=annxy0[0]+dx,ycenter=annxy0[1]+dy;annTextGroupInner.call(_$drawing_436.setTranslate,xcenter,ycenter),update[annbase+".x"]=xa?xa.p2r(xa.r2p(options.x)+dx):options.x+dx/gs.w,update[annbase+".y"]=ya?ya.p2r(ya.r2p(options.y)+dy):options.y-dy/gs.h,options.axref===options.xref&&(update[annbase+".ax"]=xa.p2r(xa.r2p(options.ax)+dx)),options.ayref===options.yref&&(update[annbase+".ay"]=ya.p2r(ya.r2p(options.ay)+dy)),arrowGroup.attr("transform","translate("+dx+","+dy+")"),annTextGroup.attr({transform:"rotate("+textangle+","+xcenter+","+ycenter+")"})},doneFn:function(){_$registry_668.call("relayout",gd,update);var notesBox=document.querySelector(".js-notes-box-panel");notesBox&&notesBox.redraw(notesBox.selectedObj)}})}}};if(options.showarrow&&drawArrow(0,0),editTextPosition)_$dragelement_433.init({element:annTextGroupInner.node(),gd:gd,prepFn:function(){baseTextTransform=annTextGroup.attr("transform"),update={}},moveFn:function(dx,dy){var csr="pointer";if(options.showarrow)options.axref===options.xref?update[annbase+".ax"]=xa.p2r(xa.r2p(options.ax)+dx):update[annbase+".ax"]=options.ax+dx,options.ayref===options.yref?update[annbase+".ay"]=ya.p2r(ya.r2p(options.ay)+dy):update[annbase+".ay"]=options.ay+dy,drawArrow(dx,dy);else{if(subplotId)return;if(xa)update[annbase+".x"]=xa.p2r(xa.r2p(options.x)+dx);else{var widthFraction=options._xsize/gs.w,xLeft=options.x+(options._xshift-options.xshift)/gs.w-widthFraction/2;update[annbase+".x"]=_$dragelement_433.align(xLeft+dx/gs.w,widthFraction,0,1,options.xanchor)}if(ya)update[annbase+".y"]=ya.p2r(ya.r2p(options.y)+dy);else{var heightFraction=options._ysize/gs.h,yBottom=options.y-(options._yshift+options.yshift)/gs.h-heightFraction/2;update[annbase+".y"]=_$dragelement_433.align(yBottom-dy/gs.h,heightFraction,0,1,options.yanchor)}xa&&ya||(csr=_$dragelement_433.getCursor(xa?.5:update[annbase+".x"],ya?.5:update[annbase+".y"],options.xanchor,options.yanchor))}annTextGroup.attr({transform:"translate("+dx+","+dy+")"+baseTextTransform}),_$setCursor_558(annTextGroupInner,csr)},doneFn:function(){_$setCursor_558(annTextGroupInner),_$registry_668.call("relayout",gd,update);var notesBox=document.querySelector(".js-notes-box-panel");notesBox&&notesBox.redraw(notesBox.selectedObj)}})}}}var __draw_395=_$draw_400.draw;function annAutorange(gd){var fullLayout=gd._fullLayout;_$lib_539.filterVisible(fullLayout.annotations).forEach(function(ann){var headPlus,headMinus,startHeadPlus,startHeadMinus,xa=_$axes_584.getFromId(gd,ann.xref),ya=_$axes_584.getFromId(gd,ann.yref),headSize=3*ann.arrowsize*ann.arrowwidth||0,startHeadSize=3*ann.startarrowsize*ann.arrowwidth||0;xa&&xa.autorange&&(headPlus=headSize+ann.xshift,headMinus=headSize-ann.xshift,startHeadPlus=startHeadSize+ann.xshift,startHeadMinus=startHeadSize-ann.xshift,ann.axref===ann.xref?(_$axes_584.expand(xa,[xa.r2c(ann.x)],{ppadplus:headPlus,ppadminus:headMinus}),_$axes_584.expand(xa,[xa.r2c(ann.ax)],{ppadplus:Math.max(ann._xpadplus,startHeadPlus),ppadminus:Math.max(ann._xpadminus,startHeadMinus)})):(startHeadPlus=ann.ax?startHeadPlus+ann.ax:startHeadPlus,startHeadMinus=ann.ax?startHeadMinus-ann.ax:startHeadMinus,_$axes_584.expand(xa,[xa.r2c(ann.x)],{ppadplus:Math.max(ann._xpadplus,headPlus,startHeadPlus),ppadminus:Math.max(ann._xpadminus,headMinus,startHeadMinus)}))),ya&&ya.autorange&&(headPlus=headSize-ann.yshift,headMinus=headSize+ann.yshift,startHeadPlus=startHeadSize-ann.yshift,startHeadMinus=startHeadSize+ann.yshift,ann.ayref===ann.yref?(_$axes_584.expand(ya,[ya.r2c(ann.y)],{ppadplus:headPlus,ppadminus:headMinus}),_$axes_584.expand(ya,[ya.r2c(ann.ay)],{ppadplus:Math.max(ann._ypadplus,startHeadPlus),ppadminus:Math.max(ann._ypadminus,startHeadMinus)})):(startHeadPlus=ann.ay?startHeadPlus+ann.ay:startHeadPlus,startHeadMinus=ann.ay?startHeadMinus-ann.ay:startHeadMinus,_$axes_584.expand(ya,[ya.r2c(ann.y)],{ppadplus:Math.max(ann._ypadplus,headPlus,startHeadPlus),ppadminus:Math.max(ann._ypadminus,headMinus,startHeadMinus)})))})}var _$click_396={hasClickToShow:function hasClickToShow(gd,hoverData){var sets=getToggleSets(gd,hoverData);return sets.on.length>0||sets.explicitOff.length>0},onClick:function onClick(gd,hoverData){var i,toggleSets=getToggleSets(gd,hoverData),onSet=toggleSets.on,offSet=toggleSets.off.concat(toggleSets.explicitOff),update={};if(!onSet.length&&!offSet.length)return;for(i=0;i<onSet.length;i++)update["annotations["+onSet[i]+"].visible"]=!0;for(i=0;i<offSet.length;i++)update["annotations["+offSet[i]+"].visible"]=!1;return _$registry_668.call("update",gd,{},update)}};function getToggleSets(gd,hoverData){var i,j,anni,showMode,pointj,xa,ya,annotations=gd._fullLayout.annotations,onSet=[],offSet=[],explicitOffSet=[],hoverLen=(hoverData||[]).length;for(i=0;i<annotations.length;i++)if(showMode=(anni=annotations[i]).clicktoshow){for(j=0;j<hoverLen;j++)if(xa=(pointj=hoverData[j]).xaxis,ya=pointj.yaxis,xa._id===anni.xref&&ya._id===anni.yref&&xa.d2r(pointj.x)===clickData2r(anni._xclick,xa)&&ya.d2r(pointj.y)===clickData2r(anni._yclick,ya)){(anni.visible?"onout"===showMode?offSet:explicitOffSet:onSet).push(i);break}j===hoverLen&&anni.visible&&"onout"===showMode&&offSet.push(i)}return{on:onSet,off:offSet,explicitOff:explicitOffSet}}function clickData2r(d,ax){return"log"===ax.type?ax.l2r(d):ax.d2r(d)}var _$handleAnnotationCommonDefaults_397=function handleAnnotationCommonDefaults(annIn,annOut,fullLayout,coerce){coerce("opacity");var bgColor=coerce("bgcolor"),borderColor=coerce("bordercolor"),borderOpacity=_$color_411.opacity(borderColor);coerce("borderpad");var borderWidth=coerce("borderwidth"),showArrow=coerce("showarrow");if(coerce("text",showArrow?" ":fullLayout._dfltTitle.annotation),coerce("textangle"),_$lib_539.coerceFont(coerce,"font",fullLayout.font),coerce("width"),coerce("align"),coerce("height")&&coerce("valign"),showArrow){var arrowhead,arrowsize,arrowside=coerce("arrowside");-1!==arrowside.indexOf("end")&&(arrowhead=coerce("arrowhead"),arrowsize=coerce("arrowsize")),-1!==arrowside.indexOf("start")&&(coerce("startarrowhead",arrowhead),coerce("startarrowsize",arrowsize)),coerce("arrowcolor",borderOpacity?annOut.bordercolor:_$color_411.defaultLine),coerce("arrowwidth",2*(borderOpacity&&borderWidth||1)),coerce("standoff"),coerce("startstandoff")}var hoverText=coerce("hovertext"),globalHoverLabel=fullLayout.hoverlabel||{};if(hoverText){var hoverBG=coerce("hoverlabel.bgcolor",globalHoverLabel.bgcolor||(_$color_411.opacity(bgColor)?_$color_411.rgb(bgColor):_$color_411.defaultLine)),hoverBorder=coerce("hoverlabel.bordercolor",globalHoverLabel.bordercolor||_$color_411.contrast(hoverBG));_$lib_539.coerceFont(coerce,"hoverlabel.font",{family:globalHoverLabel.font.family,size:globalHoverLabel.font.size,color:globalHoverLabel.font.color||hoverBorder})}coerce("captureevents",!!hoverText)},_$handleAnnotationDefaults_392=function handleAnnotationDefaults(annIn,annOut,fullLayout,opts,itemOpts){function coerce(attr,dflt){return _$lib_539.coerce(annIn,annOut,_$attributes_394,attr,dflt)}opts=opts||{};var visible=coerce("visible",!(itemOpts=itemOpts||{}).itemIsNotPlainObject),clickToShow=coerce("clicktoshow");if(!visible&&!clickToShow)return annOut;_$handleAnnotationCommonDefaults_397(annIn,annOut,fullLayout,coerce);for(var showArrow=annOut.showarrow,axLetters=["x","y"],arrowPosDflt=[-10,-30],gdMock={_fullLayout:fullLayout},i=0;i<2;i++){var axLetter=axLetters[i],axRef=_$axes_584.coerceRef(annIn,annOut,gdMock,axLetter,"","paper");if(_$axes_584.coercePosition(annOut,gdMock,coerce,axRef,axLetter,.5),showArrow){var arrowPosAttr="a"+axLetter,aaxRef=_$axes_584.coerceRef(annIn,annOut,gdMock,arrowPosAttr,"pixel");"pixel"!==aaxRef&&aaxRef!==axRef&&(aaxRef=annOut[arrowPosAttr]="pixel");var aDflt="pixel"===aaxRef?arrowPosDflt[i]:.4;_$axes_584.coercePosition(annOut,gdMock,coerce,aaxRef,arrowPosAttr,aDflt)}coerce(axLetter+"anchor"),coerce(axLetter+"shift")}if(_$lib_539.noneOrAll(annIn,annOut,["x","y"]),showArrow&&_$lib_539.noneOrAll(annIn,annOut,["ax","ay"]),clickToShow){var xClick=coerce("xclick"),yClick=coerce("yclick");annOut._xclick=void 0===xClick?annOut.x:_$axes_584.cleanPosition(xClick,gdMock,annOut.xref),annOut._yclick=void 0===yClick?annOut.y:_$axes_584.cleanPosition(yClick,gdMock,annOut.yref)}return annOut},_$handleArrayContainerDefaults_580=function handleArrayContainerDefaults(parentObjIn,parentObjOut,opts){var i,name=opts.name,previousContOut=parentObjOut[name],contIn=_$lib_539.isArrayOrTypedArray(parentObjIn[name])?parentObjIn[name]:[],contOut=parentObjOut[name]=[];for(i=0;i<contIn.length;i++){var itemIn=contIn[i],itemOut={},itemOpts={};_$lib_539.isPlainObject(itemIn)||(itemOpts.itemIsNotPlainObject=!0,itemIn={}),opts.handleItemDefaults(itemIn,itemOut,parentObjOut,opts,itemOpts),itemOut._input=itemIn,itemOut._index=i,contOut.push(itemOut)}if(_$lib_539.isArrayOrTypedArray(previousContOut)){var len=Math.min(previousContOut.length,contOut.length);for(i=0;i<len;i++)_$lib_539.relinkPrivateKeys(contOut[i],previousContOut[i])}},_$makeIncludeComponents_594=function makeIncludeComponents(containerArrayName){return function includeComponents(layoutIn,layoutOut){var array=layoutIn[containerArrayName];if(Array.isArray(array))for(var Cartesian=_$registry_668.subplotsRegistry.cartesian,idRegex=Cartesian.idRegex,subplots=layoutOut._subplots,xaList=subplots.xaxis,yaList=subplots.yaxis,cartesianList=subplots.cartesian,hasCartesianOrGL2D=layoutOut._has("cartesian")||layoutOut._has("gl2d"),i=0;i<array.length;i++){var itemi=array[i];if(_$lib_539.isPlainObject(itemi)){var xref=itemi.xref,yref=itemi.yref,hasXref=idRegex.x.test(xref),hasYref=idRegex.y.test(yref);if(hasXref||hasYref){hasCartesianOrGL2D||_$lib_539.pushUnique(layoutOut._basePlotModules,Cartesian);var newAxis=!1;hasXref&&-1===xaList.indexOf(xref)&&(xaList.push(xref),newAxis=!0),hasYref&&-1===yaList.indexOf(yref)&&(yaList.push(yref),newAxis=!0),newAxis&&hasXref&&hasYref&&cartesianList.push(xref+yref)}}}}},_$annotations_402={moduleType:"component",name:"annotations",layoutAttributes:_$attributes_394,supplyLayoutDefaults:function supplyLayoutDefaults(layoutIn,layoutOut){_$handleArrayContainerDefaults_580(layoutIn,layoutOut,{name:"annotations",handleItemDefaults:_$handleAnnotationDefaults_392})},includeBasePlot:_$makeIncludeComponents_594("annotations"),calcAutorange:function calcAutorange(gd){var fullLayout=gd._fullLayout,annotationList=_$lib_539.filterVisible(fullLayout.annotations);if(annotationList.length&&gd._fullData.length){var annotationAxes={};for(var axId in annotationList.forEach(function(ann){annotationAxes[ann.xref]=1,annotationAxes[ann.yref]=1}),annotationAxes){var ax=_$axes_584.getFromId(gd,axId);if(ax&&ax.autorange)return _$lib_539.syncOrAsync([__draw_395,annAutorange],gd)}}},draw:_$draw_400.draw,drawOne:_$draw_400.drawOne,drawRaw:_$draw_400.drawRaw,hasClickToShow:_$click_396.hasClickToShow,onClick:_$click_396.onClick,convertCoords:function convertCoords(gd,ax,newType,doExtra){ax=ax||{};var toLog="log"===newType&&"linear"===ax.type,fromLog="linear"===newType&&"log"===ax.type;if(toLog||fromLog)for(var ann,attrPrefix,annotations=gd._fullLayout.annotations,axLetter=ax._id.charAt(0),i=0;i<annotations.length;i++)ann=annotations[i],attrPrefix="annotations["+i+"].",ann[axLetter+"ref"]===ax._id&&convert(axLetter),ann["a"+axLetter+"ref"]===ax._id&&convert("a"+axLetter);function convert(attr){var currentVal=ann[attr],newVal=null;newVal=toLog?_$toLogRange_564(currentVal,ax.range):Math.pow(10,currentVal),_$fastIsnumeric_139(newVal)||(newVal=null),doExtra(attrPrefix+attr,newVal)}}},_$attributes_403=(0,_$edit_types_569.overrideAll)({_isLinkedToArray:"annotation",visible:_$attributes_394.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:_$attributes_394.xanchor,xshift:_$attributes_394.xshift,yanchor:_$attributes_394.yanchor,yshift:_$attributes_394.yshift,text:_$attributes_394.text,textangle:_$attributes_394.textangle,font:_$attributes_394.font,width:_$attributes_394.width,height:_$attributes_394.height,opacity:_$attributes_394.opacity,align:_$attributes_394.align,valign:_$attributes_394.valign,bgcolor:_$attributes_394.bgcolor,bordercolor:_$attributes_394.bordercolor,borderpad:_$attributes_394.borderpad,borderwidth:_$attributes_394.borderwidth,showarrow:_$attributes_394.showarrow,arrowcolor:_$attributes_394.arrowcolor,arrowhead:_$attributes_394.arrowhead,startarrowhead:_$attributes_394.startarrowhead,arrowside:_$attributes_394.arrowside,arrowsize:_$attributes_394.arrowsize,startarrowsize:_$attributes_394.startarrowsize,arrowwidth:_$attributes_394.arrowwidth,standoff:_$attributes_394.standoff,startstandoff:_$attributes_394.startstandoff,hovertext:_$attributes_394.hovertext,hoverlabel:_$attributes_394.hoverlabel,captureevents:_$attributes_394.captureevents},"calc","from-root");function mockAnnAxes(ann,scene){var domain=scene.fullSceneLayout.domain,size=scene.fullLayout._size,base={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};ann._xa={},_$lib_539.extendFlat(ann._xa,base),_$axes_584.setConvert(ann._xa),ann._xa._offset=size.l+domain.x[0]*size.w,ann._xa.l2p=function(){return.5*(1+ann._pdata[0]/ann._pdata[3])*size.w*(domain.x[1]-domain.x[0])},ann._ya={},_$lib_539.extendFlat(ann._ya,base),_$axes_584.setConvert(ann._ya),ann._ya._offset=size.t+(1-domain.y[1])*size.h,ann._ya.l2p=function(){return.5*(1-ann._pdata[1]/ann._pdata[3])*size.h*(domain.y[1]-domain.y[0])}}function __handleAnnotationDefaults_405(annIn,annOut,sceneLayout,opts,itemOpts){function coerce(attr,dflt){return _$lib_539.coerce(annIn,annOut,_$attributes_403,attr,dflt)}function coercePosition(axLetter){var axName=axLetter+"axis",gdMock={_fullLayout:{}};return gdMock._fullLayout[axName]=sceneLayout[axName],_$axes_584.coercePosition(annOut,gdMock,coerce,axLetter,axLetter,.5)}return coerce("visible",!itemOpts.itemIsNotPlainObject)?(_$handleAnnotationCommonDefaults_397(annIn,annOut,opts.fullLayout,coerce),coercePosition("x"),coercePosition("y"),coercePosition("z"),_$lib_539.noneOrAll(annIn,annOut,["x","y","z"]),annOut.xref="x",annOut.yref="y",annOut.zref="z",coerce("xanchor"),coerce("yanchor"),coerce("xshift"),coerce("yshift"),annOut.showarrow&&(annOut.axref="pixel",annOut.ayref="pixel",coerce("ax",-10),coerce("ay",-30),_$lib_539.noneOrAll(annIn,annOut,["ax","ay"])),annOut):annOut}function xformMatrix(m,v){var i,j,out=[0,0,0,0];for(i=0;i<4;++i)for(j=0;j<4;++j)out[j]+=m[4*i+j]*v[i];return out}var _$project_636=function project(camera,v){return xformMatrix(camera.projection,xformMatrix(camera.view,xformMatrix(camera.model,[v[0],v[1],v[2],1])))},__drawRaw_406=_$draw_400.drawRaw,axLetters=["x","y","z"],_$annotations3d_407={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:_$attributes_403}}},layoutAttributes:_$attributes_403,handleDefaults:function handleDefaults(sceneLayoutIn,sceneLayoutOut,opts){_$handleArrayContainerDefaults_580(sceneLayoutIn,sceneLayoutOut,{name:"annotations",handleItemDefaults:__handleAnnotationDefaults_405,fullLayout:opts.fullLayout})},includeBasePlot:function includeGL3D(layoutIn,layoutOut){var GL3D=_$registry_668.subplotsRegistry.gl3d;if(!GL3D)return;for(var attrRegex=GL3D.attrRegex,keys=Object.keys(layoutIn),i=0;i<keys.length;i++){var k=keys[i];attrRegex.test(k)&&(layoutIn[k].annotations||[]).length&&(_$lib_539.pushUnique(layoutOut._basePlotModules,GL3D),_$lib_539.pushUnique(layoutOut._subplots.gl3d,k))}},convert:function convert(scene){for(var anns=scene.fullSceneLayout.annotations,i=0;i<anns.length;i++)mockAnnAxes(anns[i],scene);scene.fullLayout._infolayer.selectAll(".annotation-"+scene.id).remove()},draw:function draw(scene){for(var fullSceneLayout=scene.fullSceneLayout,dataScale=scene.dataScale,anns=fullSceneLayout.annotations,i=0;i<anns.length;i++){for(var ann=anns[i],annotationIsOffscreen=!1,j=0;j<3;j++){var axLetter=axLetters[j],pos=ann[axLetter],posFraction=fullSceneLayout[axLetter+"axis"].r2fraction(pos);if(posFraction<0||posFraction>1){annotationIsOffscreen=!0;break}}annotationIsOffscreen?scene.fullLayout._infolayer.select(".annotation-"+scene.id+'[data-index="'+i+'"]').remove():(ann._pdata=_$project_636(scene.glplot.cameraParams,[fullSceneLayout.xaxis.r2l(ann.x)*dataScale[0],fullSceneLayout.yaxis.r2l(ann.y)*dataScale[1],fullSceneLayout.zaxis.r2l(ann.z)*dataScale[2]]),__drawRaw_406(scene.graphDiv,ann,i,scene.id,ann._xa,ann._ya))}}};var _$attributes_438={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}},_$makeComputeError_440=function makeComputeError(opts){var type=opts.type,symmetric=opts.symmetric;if("data"===type){var array=opts.array||[];if(symmetric)return function computeError(dataPt,index){var val=+array[index];return[val,val]};var arrayminus=opts.arrayminus||[];return function computeError(dataPt,index){var val=+array[index],valMinus=+arrayminus[index];return isNaN(val)&&isNaN(valMinus)?[NaN,NaN]:[valMinus||0,val||0]}}var computeErrorValue=makeComputeErrorValue(type,opts.value),computeErrorValueMinus=makeComputeErrorValue(type,opts.valueminus);return symmetric||void 0===opts.valueminus?function computeError(dataPt){var val=computeErrorValue(dataPt);return[val,val]}:function computeError(dataPt){return[computeErrorValueMinus(dataPt),computeErrorValue(dataPt)]}};function makeComputeErrorValue(type,value){return"percent"===type?function(dataPt){return Math.abs(dataPt*value/100)}:"constant"===type?function(){return Math.abs(value)}:"sqrt"===type?function(dataPt){return Math.sqrt(Math.abs(dataPt))}:void 0}var _$calc_439=function calc(gd){for(var calcdata=gd.calcdata,i=0;i<calcdata.length;i++){var calcTrace=calcdata[i],trace=calcTrace[0].trace;if(_$registry_668.traceIs(trace,"errorBarsOK")){var xa=_$axes_584.getFromId(gd,trace.xaxis),ya=_$axes_584.getFromId(gd,trace.yaxis);calcOneAxis(calcTrace,trace,xa,"x"),calcOneAxis(calcTrace,trace,ya,"y")}}};function calcOneAxis(calcTrace,trace,axis,coord){var opts=trace["error_"+coord]||{},vals=[];if(opts.visible&&-1!==["linear","log"].indexOf(axis.type)){for(var computeError=_$makeComputeError_440(opts),i=0;i<calcTrace.length;i++){var calcPt=calcTrace[i],calcCoord=calcPt[coord];if(_$fastIsnumeric_139(axis.c2l(calcCoord))){var errors=computeError(calcCoord,i);if(_$fastIsnumeric_139(errors[0])&&_$fastIsnumeric_139(errors[1])){var shoe=calcPt[coord+"s"]=calcCoord-errors[0],hat=calcPt[coord+"h"]=calcCoord+errors[1];vals.push(shoe,hat)}}}_$axes_584.expand(axis,vals,{padded:!0})}}var __overrideAll_442=_$edit_types_569.overrideAll,__xyAttrs_442={error_x:_$lib_539.extendFlat({},_$attributes_438),error_y:_$lib_539.extendFlat({},_$attributes_438)};delete __xyAttrs_442.error_x.copy_zstyle,delete __xyAttrs_442.error_y.copy_zstyle,delete __xyAttrs_442.error_y.copy_ystyle;var __xyzAttrs_442={error_x:_$lib_539.extendFlat({},_$attributes_438),error_y:_$lib_539.extendFlat({},_$attributes_438),error_z:_$lib_539.extendFlat({},_$attributes_438)};delete __xyzAttrs_442.error_x.copy_ystyle,delete __xyzAttrs_442.error_y.copy_ystyle,delete __xyzAttrs_442.error_z.copy_ystyle,delete __xyzAttrs_442.error_z.copy_zstyle;var _$errorbars_442={moduleType:"component",name:"errorbars",schema:{traces:{scatter:__xyAttrs_442,bar:__xyAttrs_442,histogram:__xyAttrs_442,scatter3d:__overrideAll_442(__xyzAttrs_442,"calc","nested"),scattergl:__overrideAll_442(__xyAttrs_442,"calc","nested")}},supplyDefaults:function(traceIn,traceOut,defaultColor,opts){var objName="error_"+opts.axis,containerOut=traceOut[objName]={},containerIn=traceIn[objName]||{};function coerce(attr,dflt){return _$lib_539.coerce(containerIn,containerOut,_$attributes_438,attr,dflt)}if(!1!==coerce("visible",void 0!==containerIn.array||void 0!==containerIn.value||"sqrt"===containerIn.type)){var type=coerce("type","array"in containerIn?"data":"percent"),symmetric=!0;"sqrt"!==type&&(symmetric=coerce("symmetric",!(("data"===type?"arrayminus":"valueminus")in containerIn))),"data"===type?(coerce("array"),coerce("traceref"),symmetric||(coerce("arrayminus"),coerce("tracerefminus"))):"percent"!==type&&"constant"!==type||(coerce("value"),symmetric||coerce("valueminus"));var copyAttr="copy_"+opts.inherit+"style";opts.inherit&&(traceOut["error_"+opts.inherit]||{}).visible&&coerce(copyAttr,!(containerIn.color||_$fastIsnumeric_139(containerIn.thickness)||_$fastIsnumeric_139(containerIn.width))),opts.inherit&&containerOut[copyAttr]||(coerce("color",defaultColor),coerce("thickness"),coerce("width",_$registry_668.traceIs(traceOut,"gl3d")?0:4))}},calc:_$calc_439,calcFromTrace:function calcFromTrace(trace,layout){for(var x=trace.x||[],y=trace.y||[],len=x.length||y.length,calcdataMock=new Array(len),i=0;i<len;i++)calcdataMock[i]={x:x[i],y:y[i]};return calcdataMock[0].trace=trace,_$calc_439({calcdata:[calcdataMock],_fullLayout:layout}),calcdataMock},plot:function plot(traces,plotinfo,transitionOpts){var xa=plotinfo.xaxis,ya=plotinfo.yaxis,hasAnimation=transitionOpts&&transitionOpts.duration>0;traces.each(function(d){var keyFunc,trace=d[0].trace,xObj=trace.error_x||{},yObj=trace.error_y||{};trace.ids&&(keyFunc=function(d){return d.id});var sparse=_$subtypes_884.hasMarkers(trace)&&trace.marker.maxdisplayed>0;yObj.visible||xObj.visible||(d=[]);var errorbars=_$d3_127.select(this).selectAll("g.errorbar").data(d,keyFunc);if(errorbars.exit().remove(),d.length){xObj.visible||errorbars.selectAll("path.xerror").remove(),yObj.visible||errorbars.selectAll("path.yerror").remove(),errorbars.style("opacity",1);var enter=errorbars.enter().append("g").classed("errorbar",!0);hasAnimation&&enter.style("opacity",0).transition().duration(transitionOpts.duration).style("opacity",1),_$drawing_436.setClipUrl(errorbars,plotinfo.layerClipId),errorbars.each(function(d){var errorbar=_$d3_127.select(this),coords=function errorCoords(d,xa,ya){var out={x:xa.c2p(d.x),y:ya.c2p(d.y)};return void 0!==d.yh&&(out.yh=ya.c2p(d.yh),out.ys=ya.c2p(d.ys),_$fastIsnumeric_139(out.ys)||(out.noYS=!0,out.ys=ya.c2p(d.ys,!0))),void 0!==d.xh&&(out.xh=xa.c2p(d.xh),out.xs=xa.c2p(d.xs),_$fastIsnumeric_139(out.xs)||(out.noXS=!0,out.xs=xa.c2p(d.xs,!0))),out}(d,xa,ya);if(!sparse||d.vis){var path,yerror=errorbar.select("path.yerror");if(yObj.visible&&_$fastIsnumeric_139(coords.x)&&_$fastIsnumeric_139(coords.yh)&&_$fastIsnumeric_139(coords.ys)){var yw=yObj.width;path="M"+(coords.x-yw)+","+coords.yh+"h"+2*yw+"m-"+yw+",0V"+coords.ys,coords.noYS||(path+="m-"+yw+",0h"+2*yw),yerror.size()?hasAnimation&&(yerror=yerror.transition().duration(transitionOpts.duration).ease(transitionOpts.easing)):yerror=errorbar.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0),yerror.attr("d",path)}else yerror.remove();var xerror=errorbar.select("path.xerror");if(xObj.visible&&_$fastIsnumeric_139(coords.y)&&_$fastIsnumeric_139(coords.xh)&&_$fastIsnumeric_139(coords.xs)){var xw=(xObj.copy_ystyle?yObj:xObj).width;path="M"+coords.xh+","+(coords.y-xw)+"v"+2*xw+"m0,-"+xw+"H"+coords.xs,coords.noXS||(path+="m0,-"+xw+"v"+2*xw),xerror.size()?hasAnimation&&(xerror=xerror.transition().duration(transitionOpts.duration).ease(transitionOpts.easing)):xerror=errorbar.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0),xerror.attr("d",path)}else xerror.remove()}})}})},style:function style(traces){traces.each(function(d){var trace=d[0].trace,yObj=trace.error_y||{},xObj=trace.error_x||{},s=_$d3_127.select(this);s.selectAll("path.yerror").style("stroke-width",yObj.thickness+"px").call(_$color_411.stroke,yObj.color),xObj.copy_ystyle&&(xObj=yObj),s.selectAll("path.xerror").style("stroke-width",xObj.thickness+"px").call(_$color_411.stroke,xObj.color)})},hoverInfo:function hoverInfo(calcPoint,trace,hoverPoint){(trace.error_y||{}).visible&&(hoverPoint.yerr=calcPoint.yh-calcPoint.y,trace.error_y.symmetric||(hoverPoint.yerrneg=calcPoint.y-calcPoint.ys));(trace.error_x||{}).visible&&(hoverPoint.xerr=calcPoint.xh-calcPoint.x,trace.error_x.symmetric||(hoverPoint.xerrneg=calcPoint.x-calcPoint.xs))}};var __counterRegex_457=_$regex_554.counter,__domainAttrs_457=_$domain_610.attributes,cartesianIdRegex=_$constants_589.idRegex,gridAttrs={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[__counterRegex_457("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[cartesianIdRegex.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[cartesianIdRegex.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:__domainAttrs_457({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"ticks"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"ticks"},editType:"plot"};function fillGridPositions(axLetter,coerce,dfltGap,len,reversed){var dirGap=coerce(axLetter+"gap",dfltGap),domain=coerce("domain."+axLetter);coerce(axLetter+"side");for(var out=new Array(len),start=domain[0],step=(domain[1]-start)/(len-dirGap),cellDomain=step*(1-dirGap),i=0;i<len;i++){var cellStart=start+step*i;out[reversed?len-1-i:i]=[cellStart,cellStart+cellDomain]}return out}function fillGridAxes(axesIn,axesAllowed,len,axisMap,axLetter){var i,out=new Array(len);function fillOneAxis(i,axisId){-1!==axesAllowed.indexOf(axisId)&&void 0===axisMap[axisId]?(out[i]=axisId,axisMap[axisId]=i):out[i]=""}if(Array.isArray(axesIn))for(i=0;i<len;i++)fillOneAxis(i,axesIn[i]);else for(fillOneAxis(0,axLetter),i=1;i<len;i++)fillOneAxis(i,axLetter+(i+1));return out}var _$grid_457={moduleType:"component",name:"grid",schema:{layout:{grid:gridAttrs}},layoutAttributes:gridAttrs,sizeDefaults:function sizeDefaults(layoutIn,layoutOut){var gridIn=layoutIn.grid;if(gridIn){var dfltRows,dfltColumns,hasSubplotGrid=Array.isArray(gridIn.subplots)&&Array.isArray(gridIn.subplots[0]),hasXaxes=Array.isArray(gridIn.xaxes),hasYaxes=Array.isArray(gridIn.yaxes);hasSubplotGrid?(dfltRows=gridIn.subplots.length,dfltColumns=gridIn.subplots[0].length):(hasYaxes&&(dfltRows=gridIn.yaxes.length),hasXaxes&&(dfltColumns=gridIn.xaxes.length));var gridOut=layoutOut.grid={},rows=coerce("rows",dfltRows),columns=coerce("columns",dfltColumns);if(rows*columns>1){hasSubplotGrid||hasXaxes||hasYaxes||"independent"===coerce("pattern")&&(hasSubplotGrid=!0),gridOut._hasSubplotGrid=hasSubplotGrid;var reversed="top to bottom"===coerce("roworder");gridOut._domains={x:fillGridPositions("x",coerce,hasSubplotGrid?.2:.1,columns),y:fillGridPositions("y",coerce,hasSubplotGrid?.3:.1,rows,reversed)}}}function coerce(attr,dflt){return _$lib_539.coerce(gridIn,gridOut,gridAttrs,attr,dflt)}},contentDefaults:function contentDefaults(layoutIn,layoutOut){var gridOut=layoutOut.grid;if(gridOut&&gridOut._domains){var i,j,xId,yId,subplotId,subplotsOut,yPos,gridIn=layoutIn.grid,subplots=layoutOut._subplots,hasSubplotGrid=gridOut._hasSubplotGrid,rows=gridOut.rows,columns=gridOut.columns,useDefaultSubplots="independent"===gridOut.pattern,axisMap=gridOut._axisMap={};if(hasSubplotGrid){var subplotsIn=gridIn.subplots||[];subplotsOut=gridOut.subplots=new Array(rows);var index=1;for(i=0;i<rows;i++){var rowOut=subplotsOut[i]=new Array(columns),rowIn=subplotsIn[i]||[];for(j=0;j<columns;j++)if(useDefaultSubplots?(subplotId=1===index?"xy":"x"+index+"y"+index,index++):subplotId=rowIn[j],rowOut[j]="",-1!==subplots.cartesian.indexOf(subplotId)){if(yPos=subplotId.indexOf("y"),xId=subplotId.slice(0,yPos),yId=subplotId.slice(yPos),void 0!==axisMap[xId]&&axisMap[xId]!==j||void 0!==axisMap[yId]&&axisMap[yId]!==i)continue;rowOut[j]=subplotId,axisMap[xId]=j,axisMap[yId]=i}}}else gridOut.xaxes=fillGridAxes(gridIn.xaxes,subplots.xaxis,columns,axisMap,"x"),gridOut.yaxes=fillGridAxes(gridIn.yaxes,subplots.yaxis,rows,axisMap,"y");var anchors=gridOut._anchors={},reversed="top to bottom"===gridOut.roworder;for(var axisId in axisMap){var i0,inc,iFinal,axLetter=axisId.charAt(0),side=gridOut[axLetter+"side"];if(side.length<8)anchors[axisId]="free";else if("x"===axLetter){if("t"===side.charAt(0)===reversed?(i0=0,inc=1,iFinal=rows):(i0=rows-1,inc=-1,iFinal=-1),hasSubplotGrid){var column=axisMap[axisId];for(i=i0;i!==iFinal;i+=inc)if((subplotId=subplotsOut[i][column])&&(yPos=subplotId.indexOf("y"),subplotId.slice(0,yPos)===axisId)){anchors[axisId]=subplotId.slice(yPos);break}}else for(i=i0;i!==iFinal;i+=inc)if(yId=gridOut.yaxes[i],-1!==subplots.cartesian.indexOf(axisId+yId)){anchors[axisId]=yId;break}}else if("l"===side.charAt(0)?(i0=0,inc=1,iFinal=columns):(i0=columns-1,inc=-1,iFinal=-1),hasSubplotGrid){var row=axisMap[axisId];for(i=i0;i!==iFinal;i+=inc)if((subplotId=subplotsOut[row][i])&&(yPos=subplotId.indexOf("y"),subplotId.slice(yPos)===axisId)){anchors[axisId]=subplotId.slice(0,yPos);break}}else for(i=i0;i!==iFinal;i+=inc)if(xId=gridOut.xaxes[i],-1!==subplots.cartesian.indexOf(xId+axisId)){anchors[axisId]=xId;break}}}}},_$attributes_458={_isLinkedToArray:"image",visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",_$constants_589.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",_$constants_589.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"},name="images";function imageDefaults(imageIn,imageOut,fullLayout){function coerce(attr,dflt){return _$lib_539.coerce(imageIn,imageOut,_$attributes_458,attr,dflt)}if(!coerce("visible",!!coerce("source")))return imageOut;coerce("layer"),coerce("xanchor"),coerce("yanchor"),coerce("sizex"),coerce("sizey"),coerce("sizing"),coerce("opacity");for(var gdMock={_fullLayout:fullLayout},axLetters=["x","y"],i=0;i<2;i++){var axLetter=axLetters[i],axRef=_$axes_584.coerceRef(imageIn,imageOut,gdMock,axLetter,"paper");_$axes_584.coercePosition(imageOut,gdMock,coerce,axRef,axLetter,0)}return imageOut}var _$images_462={moduleType:"component",name:"images",layoutAttributes:_$attributes_458,supplyLayoutDefaults:function supplyLayoutDefaults(layoutIn,layoutOut){_$handleArrayContainerDefaults_580(layoutIn,layoutOut,{name:name,handleItemDefaults:imageDefaults})},includeBasePlot:_$makeIncludeComponents_594("images"),draw:function draw(gd){var subplot,i,fullLayout=gd._fullLayout,imageDataAbove=[],imageDataSubplot={},imageDataBelow=[];for(i=0;i<fullLayout.images.length;i++){var img=fullLayout.images[i];if(img.visible)if("below"===img.layer&&"paper"!==img.xref&&"paper"!==img.yref){subplot=img.xref+img.yref;var plotinfo=fullLayout._plots[subplot];if(!plotinfo){imageDataBelow.push(img);continue}plotinfo.mainplot&&(subplot=plotinfo.mainplot.id),imageDataSubplot[subplot]||(imageDataSubplot[subplot]=[]),imageDataSubplot[subplot].push(img)}else"above"===img.layer?imageDataAbove.push(img):imageDataBelow.push(img)}var anchors={x:{left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-.5},right:{sizing:"xMax",offset:-1}},y:{top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-.5},bottom:{sizing:"YMax",offset:-1}}};function setImage(d){var thisImage=_$d3_127.select(this);if(!this.img||this.img.src!==d.source){thisImage.attr("xmlns",_$xmlns_namespaces_519.svg);var imagePromise=new Promise(function(resolve){var img=new Image;function errorHandler(){thisImage.remove(),resolve()}this.img=img,img.setAttribute("crossOrigin","anonymous"),img.onerror=errorHandler,img.onload=function(){var canvas=document.createElement("canvas");canvas.width=this.width,canvas.height=this.height,canvas.getContext("2d").drawImage(this,0,0);var dataURL=canvas.toDataURL("image/png");thisImage.attr("xlink:href",dataURL),resolve()},thisImage.on("error",errorHandler),img.src=d.source}.bind(this));gd._promises.push(imagePromise)}}function applyAttributes(d){var thisImage=_$d3_127.select(this),xa=_$axes_584.getFromId(gd,d.xref),ya=_$axes_584.getFromId(gd,d.yref),size=fullLayout._size,width=xa?Math.abs(xa.l2p(d.sizex)-xa.l2p(0)):d.sizex*size.w,height=ya?Math.abs(ya.l2p(d.sizey)-ya.l2p(0)):d.sizey*size.h,xOffset=width*anchors.x[d.xanchor].offset,yOffset=height*anchors.y[d.yanchor].offset,sizing=anchors.x[d.xanchor].sizing+anchors.y[d.yanchor].sizing,xPos=(xa?xa.r2p(d.x)+xa._offset:d.x*size.w+size.l)+xOffset,yPos=(ya?ya.r2p(d.y)+ya._offset:size.h-d.y*size.h+size.t)+yOffset;switch(d.sizing){case"fill":sizing+=" slice";break;case"stretch":sizing="none"}thisImage.attr({x:xPos,y:yPos,width:width,height:height,preserveAspectRatio:sizing,opacity:d.opacity});var clipAxes=(xa?xa._id:"")+(ya?ya._id:"");thisImage.call(_$drawing_436.setClipUrl,clipAxes?"clip"+fullLayout._uid+clipAxes:null)}var imagesBelow=fullLayout._imageLowerLayer.selectAll("image").data(imageDataBelow),imagesAbove=fullLayout._imageUpperLayer.selectAll("image").data(imageDataAbove);imagesBelow.enter().append("image"),imagesAbove.enter().append("image"),imagesBelow.exit().remove(),imagesAbove.exit().remove(),imagesBelow.each(function(d){setImage.bind(this)(d),applyAttributes.bind(this)(d)}),imagesAbove.each(function(d){setImage.bind(this)(d),applyAttributes.bind(this)(d)});var allSubplots=Object.keys(fullLayout._plots);for(i=0;i<allSubplots.length;i++){subplot=allSubplots[i];var subplotObj=fullLayout._plots[subplot];if(subplotObj.imagelayer){var imagesOnSubplot=subplotObj.imagelayer.selectAll("image").data(imageDataSubplot[subplot]||[]);imagesOnSubplot.enter().append("image"),imagesOnSubplot.exit().remove(),imagesOnSubplot.each(function(d){setImage.bind(this)(d),applyAttributes.bind(this)(d)})}}},convertCoords:function convertCoords(gd,ax,newType,doExtra){ax=ax||{};var toLog="log"===newType&&"linear"===ax.type,fromLog="linear"===newType&&"log"===ax.type;if(toLog||fromLog)for(var image,attrPrefix,images=gd._fullLayout.images,axLetter=ax._id.charAt(0),i=0;i<images.length;i++)if(attrPrefix="images["+i+"].",(image=images[i])[axLetter+"ref"]===ax._id){var currentPos=image[axLetter],currentSize=image["size"+axLetter],newPos=null,newSize=null;if(toLog){newPos=_$toLogRange_564(currentPos,ax.range);var dx=currentSize/Math.pow(10,newPos)/2;newSize=2*Math.log(dx+Math.sqrt(1+dx*dx))/Math.LN10}else newSize=(newPos=Math.pow(10,currentPos))*(Math.pow(10,currentSize/2)-Math.pow(10,-currentSize/2));_$fastIsnumeric_139(newPos)?_$fastIsnumeric_139(newSize)||(newSize=null):(newPos=null,newSize=null),doExtra(attrPrefix+axLetter,newPos),doExtra(attrPrefix+"size"+axLetter,newSize)}}},_$attributes_464={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:_$attributes_410.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:_$font_attributes_611({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},x:{valType:"number",min:-2,max:3,dflt:1.02,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,dflt:1,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"legend"},editType:"legend"},_$helpers_470={legendGetsTrace:function legendGetsTrace(trace){return trace.visible&&void 0!==trace.showlegend},isGrouped:function isGrouped(legendLayout){return-1!==(legendLayout.traceorder||"").indexOf("grouped")},isVertical:function isVertical(legendLayout){return"h"!==legendLayout.orientation},isReversed:function isReversed(legendLayout){return-1!==(legendLayout.traceorder||"").indexOf("reversed")}},_$anchor_utils_463={isRightAnchor:function isRightAnchor(opts){return"right"===opts.xanchor||"auto"===opts.xanchor&&opts.x>=2/3},isCenterAnchor:function isCenterAnchor(opts){return"center"===opts.xanchor||"auto"===opts.xanchor&&opts.x>1/3&&opts.x<2/3},isBottomAnchor:function isBottomAnchor(opts){return"bottom"===opts.yanchor||"auto"===opts.yanchor&&opts.y<=1/3},isMiddleAnchor:function isMiddleAnchor(opts){return"middle"===opts.yanchor||"auto"===opts.yanchor&&opts.y>1/3&&opts.y<2/3}},_$constants_465={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4},SHOWISOLATETIP=!0,_$handleClick_469=function handleClick(g,gd,numClicks){if(!gd._dragged&&!gd._editing){var i,j,kcont,key,keys,hiddenSlices=gd._fullLayout.hiddenlabels?gd._fullLayout.hiddenlabels.slice():[],legendItem=g.data()[0][0],fullData=gd._fullData,fullTrace=legendItem.trace,legendgroup=fullTrace.legendgroup,attrUpdate={},attrIndices=[],carrs=[],carrIdx=[];if(1===numClicks&&SHOWISOLATETIP&&gd.data&&gd._context.showTips?(_$lib_539.notifier(_$lib_539._(gd,"Double-click on legend to isolate one trace"),"long"),SHOWISOLATETIP=!1):SHOWISOLATETIP=!1,_$registry_668.traceIs(fullTrace,"pie")){var thisLabel=legendItem.label,thisLabelIndex=hiddenSlices.indexOf(thisLabel);1===numClicks?-1===thisLabelIndex?hiddenSlices.push(thisLabel):hiddenSlices.splice(thisLabelIndex,1):2===numClicks&&(hiddenSlices=[],gd.calcdata[0].forEach(function(d){thisLabel!==d.label&&hiddenSlices.push(d.label)}),gd._fullLayout.hiddenlabels&&gd._fullLayout.hiddenlabels.length===hiddenSlices.length&&-1===thisLabelIndex&&(hiddenSlices=[])),_$registry_668.call("relayout",gd,"hiddenlabels",hiddenSlices)}else{var tracei,hasLegendgroup=legendgroup&&legendgroup.length,traceIndicesInGroup=[];if(hasLegendgroup)for(i=0;i<fullData.length;i++)(tracei=fullData[i]).visible&&tracei.legendgroup===legendgroup&&traceIndicesInGroup.push(i);if(1===numClicks){var nextVisibility;switch(fullTrace.visible){case!0:nextVisibility="legendonly";break;case!1:nextVisibility=!1;break;case"legendonly":nextVisibility=!0}if(hasLegendgroup)for(i=0;i<fullData.length;i++)!1!==fullData[i].visible&&fullData[i].legendgroup===legendgroup&&setVisibility(fullData[i],nextVisibility);else setVisibility(fullTrace,nextVisibility)}else if(2===numClicks){var isInGroup,otherState,isIsolated=!0;for(i=0;i<fullData.length;i++)if(!(fullData[i]===fullTrace)&&!(isInGroup=hasLegendgroup&&fullData[i].legendgroup===legendgroup)&&!0===fullData[i].visible&&!_$registry_668.traceIs(fullData[i],"notLegendIsolatable")){isIsolated=!1;break}for(i=0;i<fullData.length;i++)if(!1!==fullData[i].visible&&!_$registry_668.traceIs(fullData[i],"notLegendIsolatable"))switch(fullTrace.visible){case"legendonly":setVisibility(fullData[i],!0);break;case!0:otherState=!!isIsolated||"legendonly",isInGroup=fullData[i]===fullTrace||hasLegendgroup&&fullData[i].legendgroup===legendgroup,setVisibility(fullData[i],!!isInGroup||otherState)}}for(i=0;i<carrs.length;i++)if(kcont=carrs[i]){var update=kcont.constructUpdate(),updateKeys=Object.keys(update);for(j=0;j<updateKeys.length;j++)key=updateKeys[j],(attrUpdate[key]=attrUpdate[key]||[])[carrIdx[i]]=update[key]}for(keys=Object.keys(attrUpdate),i=0;i<keys.length;i++)for(key=keys[i],j=0;j<attrIndices.length;j++)attrUpdate[key].hasOwnProperty(j)||(attrUpdate[key][j]=void 0);_$registry_668.call("restyle",gd,attrUpdate,attrIndices)}}function insertUpdate(traceIndex,key,value){var attrIndex=attrIndices.indexOf(traceIndex),valueArray=attrUpdate[key];return valueArray||(valueArray=attrUpdate[key]=[]),-1===attrIndices.indexOf(traceIndex)&&(attrIndices.push(traceIndex),attrIndex=attrIndices.length-1),valueArray[attrIndex]=value,attrIndex}function setVisibility(fullTrace,visibility){var fullInput=fullTrace._fullInput;if(_$registry_668.hasTransform(fullInput,"groupby")){var kcont=carrs[fullInput.index];if(!kcont){var groupbyIndices=_$registry_668.getTransformIndices(fullInput,"groupby"),lastGroupbyIndex=groupbyIndices[groupbyIndices.length-1];kcont=_$lib_539.keyedContainer(fullInput,"transforms["+lastGroupbyIndex+"].styles","target","value.visible"),carrs[fullInput.index]=kcont}var curState=kcont.get(fullTrace._group);void 0===curState&&(curState=!0),!1!==curState&&kcont.set(fullTrace._group,visibility),carrIdx[fullInput.index]=insertUpdate(fullInput.index,"visible",!1!==fullInput.visible)}else{var nextVisibility=!1!==fullInput.visible&&visibility;insertUpdate(fullInput.index,"visible",nextVisibility)}}},_$helpers_842={formatPiePercent:function formatPiePercent(v,separators){var vRounded=(100*v).toPrecision(3);return-1!==vRounded.lastIndexOf(".")&&(vRounded=vRounded.replace(/[.]?0+$/,"")),_$lib_539.numSeparate(vRounded,separators)+"%"},formatPieValue:function formatPieValue(v,separators){var vRounded=v.toPrecision(10);return-1!==vRounded.lastIndexOf(".")&&(vRounded=vRounded.replace(/[.]?0+$/,"")),_$lib_539.numSeparate(vRounded,separators)},getFirstFilled:function getFirstFilled(array,indices){if(Array.isArray(array))for(var i=0;i<indices.length;i++){var v=array[indices[i]];if(v||0===v)return v}},castOption:function castOption(item,indices){return Array.isArray(item)?_$helpers_842.getFirstFilled(item,indices):item||void 0}},castOption=_$helpers_842.castOption,_$styleOne_848=function styleOne(s,pt,trace){var line=trace.marker.line,lineColor=castOption(line.color,pt.pts)||_$color_411.defaultLine,lineWidth=castOption(line.width,pt.pts)||0;s.style({"stroke-width":lineWidth}).call(_$color_411.fill,pt.color).call(_$color_411.stroke,lineColor)},_$style_472=function style(s,gd){s.each(function(d){var layers=_$d3_127.select(this).selectAll("g.layers").data([0]);layers.enter().append("g").classed("layers",!0),layers.style("opacity",d[0].trace.opacity),layers.selectAll("g.legendfill").data([d]).enter().append("g").classed("legendfill",!0),layers.selectAll("g.legendlines").data([d]).enter().append("g").classed("legendlines",!0);var symbol=layers.selectAll("g.legendsymbols").data([d]);symbol.enter().append("g").classed("legendsymbols",!0),symbol.selectAll("g.legendpoints").data([d]).enter().append("g").classed("legendpoints",!0)}).each(function styleBars(d){var trace=d[0].trace,marker=trace.marker||{},markerLine=marker.line||{},barpath=_$d3_127.select(this).select("g.legendpoints").selectAll("path.legendbar").data(_$registry_668.traceIs(trace,"bar")?[d]:[]);barpath.enter().append("path").classed("legendbar",!0).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)"),barpath.exit().remove(),barpath.each(function(d){var p=_$d3_127.select(this),d0=d[0],w=(d0.mlw+1||markerLine.width+1)-1;p.style("stroke-width",w+"px").call(_$color_411.fill,d0.mc||marker.color),w&&p.call(_$color_411.stroke,d0.mlc||markerLine.color)})}).each(function styleBoxes(d){var trace=d[0].trace,pts=_$d3_127.select(this).select("g.legendpoints").selectAll("path.legendbox").data(_$registry_668.traceIs(trace,"box-violin")&&trace.visible?[d]:[]);pts.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)"),pts.exit().remove(),pts.each(function(){var w=trace.line.width,p=_$d3_127.select(this);p.style("stroke-width",w+"px").call(_$color_411.fill,trace.fillcolor),w&&p.call(_$color_411.stroke,trace.line.color)})}).each(function stylePies(d){var trace=d[0].trace,pts=_$d3_127.select(this).select("g.legendpoints").selectAll("path.legendpie").data(_$registry_668.traceIs(trace,"pie")&&trace.visible?[d]:[]);pts.enter().append("path").classed("legendpie",!0).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)"),pts.exit().remove(),pts.size()&&pts.call(_$styleOne_848,d[0],trace)}).each(function styleLines(d){var trace=d[0].trace,showFill=trace.visible&&trace.fill&&"none"!==trace.fill,showLine=_$subtypes_884.hasLines(trace),contours=trace.contours;contours&&"constraint"===contours.type&&(showLine=contours.showlines,showFill="="!==contours._operation);var fill=_$d3_127.select(this).select(".legendfill").selectAll("path").data(showFill?[d]:[]);fill.enter().append("path").classed("js-fill",!0),fill.exit().remove(),fill.attr("d","M5,0h30v6h-30z").call(_$drawing_436.fillGroupStyle);var line=_$d3_127.select(this).select(".legendlines").selectAll("path").data(showLine?[d]:[]);line.enter().append("path").classed("js-line",!0).attr("d","M5,0h30"),line.exit().remove(),line.call(_$drawing_436.lineGroupStyle)}).each(function stylePoints(d){var dMod,tMod,d0=d[0],trace=d0.trace,showMarkers=_$subtypes_884.hasMarkers(trace),showText=_$subtypes_884.hasText(trace),showLines=_$subtypes_884.hasLines(trace);function boundVal(attrIn,arrayToValFn,bounds){var valIn=_$lib_539.nestedProperty(trace,attrIn).get(),valToBound=Array.isArray(valIn)&&arrayToValFn?arrayToValFn(valIn):valIn;if(bounds){if(valToBound<bounds[0])return bounds[0];if(valToBound>bounds[1])return bounds[1]}return valToBound}function pickFirst(array){return array[0]}if(showMarkers||showText||showLines){var dEdit={},tEdit={};showMarkers&&(dEdit.mc=boundVal("marker.color",pickFirst),dEdit.mo=boundVal("marker.opacity",_$lib_539.mean,[.2,1]),dEdit.ms=boundVal("marker.size",_$lib_539.mean,[2,16]),dEdit.mlc=boundVal("marker.line.color",pickFirst),dEdit.mlw=boundVal("marker.line.width",_$lib_539.mean,[0,5]),tEdit.marker={sizeref:1,sizemin:1,sizemode:"diameter"}),showLines&&(tEdit.line={width:boundVal("line.width",pickFirst,[0,10])}),showText&&(dEdit.tx="Aa",dEdit.tp=boundVal("textposition",pickFirst),dEdit.ts=10,dEdit.tc=boundVal("textfont.color",pickFirst),dEdit.tf=boundVal("textfont.family",pickFirst)),dMod=[_$lib_539.minExtend(d0,dEdit)],tMod=_$lib_539.minExtend(trace,tEdit)}var ptgroup=_$d3_127.select(this).select("g.legendpoints"),pts=ptgroup.selectAll("path.scatterpts").data(showMarkers?dMod:[]);pts.enter().append("path").classed("scatterpts",!0).attr("transform","translate(20,0)"),pts.exit().remove(),pts.call(_$drawing_436.pointStyle,tMod,gd),showMarkers&&(dMod[0].mrc=3);var txt=ptgroup.selectAll("g.pointtext").data(showText?dMod:[]);txt.enter().append("g").classed("pointtext",!0).append("text").attr("transform","translate(20,0)"),txt.exit().remove(),txt.selectAll("text").call(_$drawing_436.textPointStyle,tMod,gd)})},__LINE_SPACING_467=_$alignment_511.LINE_SPACING,FROM_TL=_$alignment_511.FROM_TL,FROM_BR=_$alignment_511.FROM_BR,DBLCLICKDELAY=_$interactions_516.DBLCLICKDELAY;function drawTexts(g,gd){var legendItem=g.data()[0][0],fullLayout=gd._fullLayout,trace=legendItem.trace,isPie=_$registry_668.traceIs(trace,"pie"),traceIndex=trace.index,name=isPie?legendItem.label:trace.name,text=g.selectAll("text.legendtext").data([0]);function textLayout(s){_$svg_text_utils_562.convertToTspans(s,gd,function(){!function computeTextDimensions(g,gd){var legendItem=g.data()[0][0];if(!legendItem.trace.showlegend)return void g.remove();var height,width,mathjaxGroup=g.select("g[class*=math-group]"),mathjaxNode=mathjaxGroup.node(),lineHeight=gd._fullLayout.legend.font.size*__LINE_SPACING_467;if(mathjaxNode){var mathjaxBB=_$drawing_436.bBox(mathjaxNode);height=mathjaxBB.height,width=mathjaxBB.width,_$drawing_436.setTranslate(mathjaxGroup,0,height/4)}else{var text=g.select(".legendtext"),textLines=_$svg_text_utils_562.lineCount(text),textNode=text.node();height=lineHeight*textLines,width=textNode?_$drawing_436.bBox(textNode).width:0;var textY=lineHeight*(.3+(1-textLines)/2);_$svg_text_utils_562.positionText(text,40,textY)}height=Math.max(height,16)+3,legendItem.height=height,legendItem.width=width}(g,gd)})}text.enter().append("text").classed("legendtext",!0),text.attr("text-anchor","start").classed("user-select-none",!0).call(_$drawing_436.font,fullLayout.legend.font).text(name),gd._context.edits.legendText&&!isPie?text.call(_$svg_text_utils_562.makeEditable,{gd:gd}).call(textLayout).on("edit",function(text){this.text(text).call(textLayout);var transforms,origText=text;this.text()||(text="    ");var fullInput=legendItem.trace._fullInput||{},update={};if(-1!==["ohlc","candlestick"].indexOf(fullInput.type))update[(transforms=legendItem.trace.transforms)[transforms.length-1].direction+".name"]=text;else if(_$registry_668.hasTransform(fullInput,"groupby")){var groupbyIndices=_$registry_668.getTransformIndices(fullInput,"groupby"),index=groupbyIndices[groupbyIndices.length-1],kcont=_$lib_539.keyedContainer(fullInput,"transforms["+index+"].styles","target","value.name");""===origText?kcont.remove(legendItem.trace._group):kcont.set(legendItem.trace._group,text),update=kcont.constructUpdate()}else update.name=text;return _$registry_668.call("restyle",gd,update,traceIndex)}):textLayout(text)}function setupTraceToggle(g,gd){var newMouseDownTime,numClicks=1,traceToggle=g.selectAll("rect").data([0]);traceToggle.enter().append("rect").classed("legendtoggle",!0).style("cursor","pointer").attr("pointer-events","all").call(_$color_411.fill,"rgba(0,0,0,0)"),traceToggle.on("mousedown",function(){(newMouseDownTime=(new Date).getTime())-gd._legendMouseDownTime<DBLCLICKDELAY?numClicks+=1:(numClicks=1,gd._legendMouseDownTime=newMouseDownTime)}),traceToggle.on("mouseup",function(){if(!gd._dragged&&!gd._editing){var legend=gd._fullLayout.legend;(new Date).getTime()-gd._legendMouseDownTime>DBLCLICKDELAY&&(numClicks=Math.max(numClicks-1,1)),1===numClicks?legend._clickTimeout=setTimeout(function(){_$handleClick_469(g,gd,numClicks)},DBLCLICKDELAY):2===numClicks&&(legend._clickTimeout&&clearTimeout(legend._clickTimeout),gd._legendMouseDownTime=0,_$handleClick_469(g,gd,numClicks))}})}function computeLegendDimensions(gd,groups,traces){var fullLayout=gd._fullLayout,opts=fullLayout.legend,borderwidth=opts.borderwidth,isGrouped=_$helpers_470.isGrouped(opts),extraWidth=0;if(opts._width=0,opts._height=0,_$helpers_470.isVertical(opts))isGrouped&&groups.each(function(d,i){_$drawing_436.setTranslate(this,0,i*opts.tracegroupgap)}),traces.each(function(d){var legendItem=d[0],textHeight=legendItem.height,textWidth=legendItem.width;_$drawing_436.setTranslate(this,borderwidth,5+borderwidth+opts._height+textHeight/2),opts._height+=textHeight,opts._width=Math.max(opts._width,textWidth)}),opts._width+=45+2*borderwidth,opts._height+=10+2*borderwidth,isGrouped&&(opts._height+=(opts._lgroupsLength-1)*opts.tracegroupgap),extraWidth=40;else if(isGrouped){for(var groupXOffsets=[opts._width],groupData=groups.data(),i=0,n=groupData.length;i<n;i++){var textWidths=groupData[i].map(function(legendItemArray){return legendItemArray[0].width}),groupWidth=40+Math.max.apply(null,textWidths);opts._width+=opts.tracegroupgap+groupWidth,groupXOffsets.push(opts._width)}groups.each(function(d,i){_$drawing_436.setTranslate(this,groupXOffsets[i],0)}),groups.each(function(){var groupHeight=0;_$d3_127.select(this).selectAll("g.traces").each(function(d){var textHeight=d[0].height;_$drawing_436.setTranslate(this,0,5+borderwidth+groupHeight+textHeight/2),groupHeight+=textHeight}),opts._height=Math.max(opts._height,groupHeight)}),opts._height+=10+2*borderwidth,opts._width+=2*borderwidth}else{var oneRowLegend,rowHeight=0,maxTraceHeight=0,maxTraceWidth=0,offsetX=0,fullTracesWidth=0,traceGap=opts.tracegroupgap||5;traces.each(function(d){maxTraceWidth=Math.max(40+d[0].width,maxTraceWidth),fullTracesWidth+=40+d[0].width+traceGap}),oneRowLegend=fullLayout.width-(fullLayout.margin.r+fullLayout.margin.l)>borderwidth+fullTracesWidth-traceGap,traces.each(function(d){var legendItem=d[0],traceWidth=oneRowLegend?40+d[0].width:maxTraceWidth;borderwidth+offsetX+traceGap+traceWidth>fullLayout.width-(fullLayout.margin.r+fullLayout.margin.l)&&(offsetX=0,rowHeight+=maxTraceHeight,opts._height=opts._height+maxTraceHeight,maxTraceHeight=0),_$drawing_436.setTranslate(this,borderwidth+offsetX,5+borderwidth+legendItem.height/2+rowHeight),opts._width+=traceGap+traceWidth,opts._height=Math.max(opts._height,legendItem.height),offsetX+=traceGap+traceWidth,maxTraceHeight=Math.max(legendItem.height,maxTraceHeight)}),opts._width+=2*borderwidth,opts._height+=10+2*borderwidth}opts._width=Math.ceil(opts._width),opts._height=Math.ceil(opts._height),traces.each(function(d){var legendItem=d[0],bg=_$d3_127.select(this).select(".legendtoggle");_$drawing_436.setRect(bg,0,-legendItem.height/2,(gd._context.edits.legendText?0:opts._width)+extraWidth,legendItem.height)})}function expandMargin(gd){var opts=gd._fullLayout.legend,xanchor="left";_$anchor_utils_463.isRightAnchor(opts)?xanchor="right":_$anchor_utils_463.isCenterAnchor(opts)&&(xanchor="center");var yanchor="top";_$anchor_utils_463.isBottomAnchor(opts)?yanchor="bottom":_$anchor_utils_463.isMiddleAnchor(opts)&&(yanchor="middle"),_$plots_647.autoMargin(gd,"legend",{x:opts.x,y:opts.y,l:opts._width*FROM_TL[xanchor],r:opts._width*FROM_BR[xanchor],b:opts._height*FROM_BR[yanchor],t:opts._height*FROM_TL[yanchor]})}var _$legend_471={moduleType:"component",name:"legend",layoutAttributes:_$attributes_464,supplyLayoutDefaults:function legendDefaults(layoutIn,layoutOut,fullData){for(var defaultX,defaultY,defaultXAnchor,defaultYAnchor,containerIn=layoutIn.legend||{},containerOut={},visibleTraces=0,defaultOrder="normal",i=0;i<fullData.length;i++){var trace=fullData[i];_$helpers_470.legendGetsTrace(trace)&&(visibleTraces++,_$registry_668.traceIs(trace,"pie")&&visibleTraces++),(_$registry_668.traceIs(trace,"bar")&&"stack"===layoutOut.barmode||-1!==["tonextx","tonexty"].indexOf(trace.fill))&&(defaultOrder=_$helpers_470.isGrouped({traceorder:defaultOrder})?"grouped+reversed":"reversed"),void 0!==trace.legendgroup&&""!==trace.legendgroup&&(defaultOrder=_$helpers_470.isReversed({traceorder:defaultOrder})?"reversed+grouped":"grouped")}function coerce(attr,dflt){return _$lib_539.coerce(containerIn,containerOut,_$attributes_464,attr,dflt)}if(!1!==_$lib_539.coerce(layoutIn,layoutOut,_$layout_attributes_638,"showlegend",visibleTraces>1)){if(layoutOut.legend=containerOut,coerce("bgcolor",layoutOut.paper_bgcolor),coerce("bordercolor"),coerce("borderwidth"),_$lib_539.coerceFont(coerce,"font",layoutOut.font),coerce("orientation"),"h"===containerOut.orientation){var xaxis=layoutIn.xaxis;xaxis&&xaxis.rangeslider&&xaxis.rangeslider.visible?(defaultX=0,defaultXAnchor="left",defaultY=1.1,defaultYAnchor="bottom"):(defaultX=0,defaultXAnchor="left",defaultY=-.1,defaultYAnchor="top")}coerce("traceorder",defaultOrder),_$helpers_470.isGrouped(layoutOut.legend)&&coerce("tracegroupgap"),coerce("x",defaultX),coerce("xanchor",defaultXAnchor),coerce("y",defaultY),coerce("yanchor",defaultYAnchor),_$lib_539.noneOrAll(containerIn,containerOut,["x","y"])}},draw:function draw(gd){var fullLayout=gd._fullLayout,clipId="legend"+fullLayout._uid;if(fullLayout._infolayer&&gd.calcdata){gd._legendMouseDownTime||(gd._legendMouseDownTime=0);var opts=fullLayout.legend,legendData=fullLayout.showlegend&&function getLegendData(calcdata,opts){var i,j,lgroupToTraces={},lgroups=[],hasOneNonBlankGroup=!1,slicesShown={},lgroupi=0;function addOneItem(legendGroup,legendItem){if(""!==legendGroup&&_$helpers_470.isGrouped(opts))-1===lgroups.indexOf(legendGroup)?(lgroups.push(legendGroup),hasOneNonBlankGroup=!0,lgroupToTraces[legendGroup]=[[legendItem]]):lgroupToTraces[legendGroup].push([legendItem]);else{var uniqueGroup="~~i"+lgroupi;lgroups.push(uniqueGroup),lgroupToTraces[uniqueGroup]=[[legendItem]],lgroupi++}}for(i=0;i<calcdata.length;i++){var cd=calcdata[i],cd0=cd[0],trace=cd0.trace,lgroup=trace.legendgroup;if(_$helpers_470.legendGetsTrace(trace)&&trace.showlegend)if(_$registry_668.traceIs(trace,"pie"))for(slicesShown[lgroup]||(slicesShown[lgroup]={}),j=0;j<cd.length;j++){var labelj=cd[j].label;slicesShown[lgroup][labelj]||(addOneItem(lgroup,{label:labelj,color:cd[j].color,i:cd[j].i,trace:trace}),slicesShown[lgroup][labelj]=!0)}else addOneItem(lgroup,cd0)}if(!lgroups.length)return[];var ltraces,legendData,lgroupsLength=lgroups.length;if(hasOneNonBlankGroup&&_$helpers_470.isGrouped(opts))for(legendData=new Array(lgroupsLength),i=0;i<lgroupsLength;i++)ltraces=lgroupToTraces[lgroups[i]],legendData[i]=_$helpers_470.isReversed(opts)?ltraces.reverse():ltraces;else{for(legendData=[new Array(lgroupsLength)],i=0;i<lgroupsLength;i++)ltraces=lgroupToTraces[lgroups[i]][0],legendData[0][_$helpers_470.isReversed(opts)?lgroupsLength-i-1:i]=ltraces;lgroupsLength=1}return opts._lgroupsLength=lgroupsLength,legendData}(gd.calcdata,opts),hiddenSlices=fullLayout.hiddenlabels||[];if(!fullLayout.showlegend||!legendData.length)return fullLayout._infolayer.selectAll(".legend").remove(),fullLayout._topdefs.select("#"+clipId).remove(),void _$plots_647.autoMargin(gd,"legend");var legend=fullLayout._infolayer.selectAll("g.legend").data([0]);legend.enter().append("g").attr({class:"legend","pointer-events":"all"});var clipPath=fullLayout._topdefs.selectAll("#"+clipId).data([0]);clipPath.enter().append("clipPath").attr("id",clipId).append("rect");var bg=legend.selectAll("rect.bg").data([0]);bg.enter().append("rect").attr({class:"bg","shape-rendering":"crispEdges"}),bg.call(_$color_411.stroke,opts.bordercolor).call(_$color_411.fill,opts.bgcolor).style("stroke-width",opts.borderwidth+"px");var scrollBox=legend.selectAll("g.scrollbox").data([0]);scrollBox.enter().append("g").attr("class","scrollbox");var scrollBar=legend.selectAll("rect.scrollbar").data([0]);scrollBar.enter().append("rect").attr({class:"scrollbar",rx:20,ry:3,width:0,height:0}).call(_$color_411.fill,"#808BA4");var groups=scrollBox.selectAll("g.groups").data(legendData);groups.enter().append("g").attr("class","groups"),groups.exit().remove();var traces=groups.selectAll("g.traces").data(_$lib_539.identity);traces.enter().append("g").attr("class","traces"),traces.exit().remove(),traces.call(_$style_472,gd).style("opacity",function(d){var trace=d[0].trace;return _$registry_668.traceIs(trace,"pie")?-1!==hiddenSlices.indexOf(d[0].label)?.5:1:"legendonly"===trace.visible?.5:1}).each(function(){_$d3_127.select(this).call(drawTexts,gd).call(setupTraceToggle,gd)}),0!==legend.enter().size()&&(computeLegendDimensions(gd,groups,traces),expandMargin(gd));var lxMax=fullLayout.width,lyMax=fullLayout.height;computeLegendDimensions(gd,groups,traces),opts._height>lyMax?function expandHorizontalMargin(gd){var opts=gd._fullLayout.legend,xanchor="left";_$anchor_utils_463.isRightAnchor(opts)?xanchor="right":_$anchor_utils_463.isCenterAnchor(opts)&&(xanchor="center"),_$plots_647.autoMargin(gd,"legend",{x:opts.x,y:.5,l:opts._width*FROM_TL[xanchor],r:opts._width*FROM_BR[xanchor],b:0,t:0})}(gd):expandMargin(gd);var gs=fullLayout._size,lx=gs.l+gs.w*opts.x,ly=gs.t+gs.h*(1-opts.y);_$anchor_utils_463.isRightAnchor(opts)?lx-=opts._width:_$anchor_utils_463.isCenterAnchor(opts)&&(lx-=opts._width/2),_$anchor_utils_463.isBottomAnchor(opts)?ly-=opts._height:_$anchor_utils_463.isMiddleAnchor(opts)&&(ly-=opts._height/2);var legendWidth=opts._width,legendWidthMax=gs.w;legendWidth>legendWidthMax?(lx=gs.l,legendWidth=legendWidthMax):(lx+legendWidth>lxMax&&(lx=lxMax-legendWidth),lx<0&&(lx=0),legendWidth=Math.min(lxMax-lx,opts._width));var xf,yf,x0,y0,legendHeight=opts._height,legendHeightMax=gs.h;if(legendHeight>legendHeightMax?(ly=gs.t,legendHeight=legendHeightMax):(ly+legendHeight>lyMax&&(ly=lyMax-legendHeight),ly<0&&(ly=0),legendHeight=Math.min(lyMax-ly,opts._height)),_$drawing_436.setTranslate(legend,lx,ly),scrollBar.on(".drag",null),legend.on("wheel",null),opts._height<=legendHeight||gd._context.staticPlot)bg.attr({width:legendWidth-opts.borderwidth,height:legendHeight-opts.borderwidth,x:opts.borderwidth/2,y:opts.borderwidth/2}),_$drawing_436.setTranslate(scrollBox,0,0),clipPath.select("rect").attr({width:legendWidth-2*opts.borderwidth,height:legendHeight-2*opts.borderwidth,x:opts.borderwidth,y:opts.borderwidth}),_$drawing_436.setClipUrl(scrollBox,clipId),_$drawing_436.setRect(scrollBar,0,0,0,0),delete opts._scrollY;else{var eventY0,scrollBoxY0,scrollBarHeight=Math.max(_$constants_465.scrollBarMinHeight,legendHeight*legendHeight/opts._height),scrollBarYMax=legendHeight-scrollBarHeight-2*_$constants_465.scrollBarMargin,scrollBoxYMax=opts._height-legendHeight,scrollRatio=scrollBarYMax/scrollBoxYMax,scrollBoxY=Math.min(opts._scrollY||0,scrollBoxYMax);bg.attr({width:legendWidth-2*opts.borderwidth+_$constants_465.scrollBarWidth+_$constants_465.scrollBarMargin,height:legendHeight-opts.borderwidth,x:opts.borderwidth/2,y:opts.borderwidth/2}),clipPath.select("rect").attr({width:legendWidth-2*opts.borderwidth+_$constants_465.scrollBarWidth+_$constants_465.scrollBarMargin,height:legendHeight-2*opts.borderwidth,x:opts.borderwidth,y:opts.borderwidth+scrollBoxY}),_$drawing_436.setClipUrl(scrollBox,clipId),scrollHandler(scrollBoxY,scrollBarHeight,scrollRatio),legend.on("wheel",function(){scrollHandler(scrollBoxY=_$lib_539.constrain(opts._scrollY+_$d3_127.event.deltaY/scrollBarYMax*scrollBoxYMax,0,scrollBoxYMax),scrollBarHeight,scrollRatio),0!==scrollBoxY&&scrollBoxY!==scrollBoxYMax&&_$d3_127.event.preventDefault()});var drag=_$d3_127.behavior.drag().on("dragstart",function(){eventY0=_$d3_127.event.sourceEvent.clientY,scrollBoxY0=scrollBoxY}).on("drag",function(){var e=_$d3_127.event.sourceEvent;2===e.buttons||e.ctrlKey||scrollHandler(scrollBoxY=_$lib_539.constrain((e.clientY-eventY0)/scrollRatio+scrollBoxY0,0,scrollBoxYMax),scrollBarHeight,scrollRatio)});scrollBar.call(drag)}gd._context.edits.legendPosition&&(legend.classed("cursor-move",!0),_$dragelement_433.init({element:legend.node(),gd:gd,prepFn:function(){var transform=_$drawing_436.getTranslate(legend);x0=transform.x,y0=transform.y},moveFn:function(dx,dy){var newX=x0+dx,newY=y0+dy;_$drawing_436.setTranslate(legend,newX,newY),xf=_$dragelement_433.align(newX,0,gs.l,gs.l+gs.w,opts.xanchor),yf=_$dragelement_433.align(newY,0,gs.t+gs.h,gs.t,opts.yanchor)},doneFn:function(){void 0!==xf&&void 0!==yf&&_$registry_668.call("relayout",gd,{"legend.x":xf,"legend.y":yf})},clickFn:function(numClicks,e){var clickedTrace=fullLayout._infolayer.selectAll("g.traces").filter(function(){var bbox=this.getBoundingClientRect();return e.clientX>=bbox.left&&e.clientX<=bbox.right&&e.clientY>=bbox.top&&e.clientY<=bbox.bottom});clickedTrace.size()>0&&(1===numClicks?legend._clickTimeout=setTimeout(function(){_$handleClick_469(clickedTrace,gd,numClicks)},DBLCLICKDELAY):2===numClicks&&(legend._clickTimeout&&clearTimeout(legend._clickTimeout),_$handleClick_469(clickedTrace,gd,numClicks)))}}))}function scrollHandler(scrollBoxY,scrollBarHeight,scrollRatio){opts._scrollY=gd._fullLayout.legend._scrollY=scrollBoxY,_$drawing_436.setTranslate(scrollBox,0,-scrollBoxY),_$drawing_436.setRect(scrollBar,legendWidth,_$constants_465.scrollBarMargin+scrollBoxY*scrollRatio,_$constants_465.scrollBarWidth,scrollBarHeight),clipPath.select("rect").attr({y:opts.borderwidth+scrollBoxY})}},style:_$style_472},_$button_attributes_478={step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"},__extendFlat_477=_$extend_528.extendFlat,_$attributes_477={visible:{valType:"boolean",editType:"plot"},buttons:_$button_attributes_478=__extendFlat_477(_$button_attributes_478,{_isLinkedToArray:"button"}),x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:_$font_attributes_611({editType:"plot"}),bgcolor:{valType:"color",dflt:_$attributes_410.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:_$attributes_410.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},_$constants_479={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10};var _$getUpdateObject_482=function getUpdateObject(axisLayout,buttonLayout){var axName=axisLayout._name,update={};if("all"===buttonLayout.step)update[axName+".autorange"]=!0;else{var xrange=function getXRange(axisLayout,buttonLayout){var range0,currentRange=axisLayout.range,base=new Date(axisLayout.r2l(currentRange[1])),step=buttonLayout.step,count=buttonLayout.count;switch(buttonLayout.stepmode){case"backward":range0=axisLayout.l2r(+_$d3_127.time[step].utc.offset(base,-count));break;case"todate":var base2=_$d3_127.time[step].utc.offset(base,-count);range0=axisLayout.l2r(+_$d3_127.time[step].utc.ceil(base2))}var range1=currentRange[1];return[range0,range1]}(axisLayout,buttonLayout);update[axName+".range[0]"]=xrange[0],update[axName+".range[1]"]=xrange[1]}return update};var __LINE_SPACING_481=_$alignment_511.LINE_SPACING,__FROM_TL_481=_$alignment_511.FROM_TL,__FROM_BR_481=_$alignment_511.FROM_BR;function selectorKeyFunc(d){return d._id}function drawButtonRect(button,selectorLayout,d){var rect=button.selectAll("rect").data([0]);rect.enter().append("rect").classed("selector-rect",!0),rect.attr("shape-rendering","crispEdges"),rect.attr({rx:_$constants_479.rx,ry:_$constants_479.ry}),rect.call(_$color_411.stroke,selectorLayout.bordercolor).call(_$color_411.fill,function getFillColor(selectorLayout,d){return d._isActive||d._isHovered?selectorLayout.activecolor:selectorLayout.bgcolor}(selectorLayout,d)).style("stroke-width",selectorLayout.borderwidth+"px")}function drawButtonText(button,selectorLayout,d,gd){var text=button.selectAll("text").data([0]);text.enter().append("text").classed("selector-text",!0).classed("user-select-none",!0),text.attr("text-anchor","middle"),text.call(_$drawing_436.font,selectorLayout.font).text(function getLabel(opts){return opts.label?opts.label:"all"===opts.step?"all":opts.count+opts.step.charAt(0)}(d)).call(function textLayout(s){_$svg_text_utils_562.convertToTspans(s,gd)})}var _$rangeselector_483={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:_$attributes_477}}},layoutAttributes:_$attributes_477,handleDefaults:function handleDefaults(containerIn,containerOut,layout,counterAxes,calendar){var selectorIn=containerIn.rangeselector||{},selectorOut=containerOut.rangeselector={};function coerce(attr,dflt){return _$lib_539.coerce(selectorIn,selectorOut,_$attributes_477,attr,dflt)}if(coerce("visible",function buttonsDefaults(containerIn,containerOut,calendar){var buttonIn,buttonOut,buttonsIn=containerIn.buttons||[],buttonsOut=containerOut.buttons=[];function coerce(attr,dflt){return _$lib_539.coerce(buttonIn,buttonOut,_$button_attributes_478,attr,dflt)}for(var i=0;i<buttonsIn.length;i++)if(buttonIn=buttonsIn[i],buttonOut={},_$lib_539.isPlainObject(buttonIn)){var step=coerce("step");"all"!==step&&(!calendar||"gregorian"===calendar||"month"!==step&&"year"!==step?coerce("stepmode"):buttonOut.stepmode="backward",coerce("count")),coerce("label"),buttonOut._index=i,buttonsOut.push(buttonOut)}return buttonsOut}(selectorIn,selectorOut,calendar).length>0)){var posDflt=function getPosDflt(containerOut,layout,counterAxes){for(var anchoredList=counterAxes.filter(function(ax){return layout[ax].anchor===containerOut._id}),posY=0,i=0;i<anchoredList.length;i++){var domain=layout[anchoredList[i]].domain;domain&&(posY=Math.max(domain[1],posY))}return[containerOut.domain[0],posY+_$constants_479.yPad]}(containerOut,layout,counterAxes);coerce("x",posDflt[0]),coerce("y",posDflt[1]),_$lib_539.noneOrAll(containerIn,containerOut,["x","y"]),coerce("xanchor"),coerce("yanchor"),_$lib_539.coerceFont(coerce,"font",layout.font);var bgColor=coerce("bgcolor");coerce("activecolor",_$color_411.contrast(bgColor,_$constants_479.lightAmount,_$constants_479.darkAmount)),coerce("bordercolor"),coerce("borderwidth")}},draw:function draw(gd){var selectors=gd._fullLayout._infolayer.selectAll(".rangeselector").data(function makeSelectorData(gd){for(var axes=_$axis_ids_587.list(gd,"x",!0),data=[],i=0;i<axes.length;i++){var axis=axes[i];axis.rangeselector&&axis.rangeselector.visible&&data.push(axis)}return data}(gd),selectorKeyFunc);selectors.enter().append("g").classed("rangeselector",!0),selectors.exit().remove(),selectors.style({cursor:"pointer","pointer-events":"all"}),selectors.each(function(d){var selector=_$d3_127.select(this),axisLayout=d,selectorLayout=axisLayout.rangeselector,buttons=selector.selectAll("g.button").data(selectorLayout.buttons);buttons.enter().append("g").classed("button",!0),buttons.exit().remove(),buttons.each(function(d){var button=_$d3_127.select(this),update=_$getUpdateObject_482(axisLayout,d);d._isActive=function isActive(axisLayout,opts,update){if("all"===opts.step)return!0===axisLayout.autorange;var keys=Object.keys(update);return axisLayout.range[0]===update[keys[0]]&&axisLayout.range[1]===update[keys[1]]}(axisLayout,d,update),button.call(drawButtonRect,selectorLayout,d),button.call(drawButtonText,selectorLayout,d,gd),button.on("click",function(){gd._dragged||_$registry_668.call("relayout",gd,update)}),button.on("mouseover",function(){d._isHovered=!0,button.call(drawButtonRect,selectorLayout,d)}),button.on("mouseout",function(){d._isHovered=!1,button.call(drawButtonRect,selectorLayout,d)})}),function reposition(gd,buttons,opts,axName,selector){var width=0,height=0,borderWidth=opts.borderwidth;buttons.each(function(){var button=_$d3_127.select(this),text=button.select(".selector-text"),tHeight=opts.font.size*__LINE_SPACING_481,hEff=Math.max(tHeight*_$svg_text_utils_562.lineCount(text),16)+3;height=Math.max(height,hEff)}),buttons.each(function(){var button=_$d3_127.select(this),rect=button.select(".selector-rect"),text=button.select(".selector-text"),tWidth=text.node()&&_$drawing_436.bBox(text.node()).width,tHeight=opts.font.size*__LINE_SPACING_481,tLines=_$svg_text_utils_562.lineCount(text),wEff=Math.max(tWidth+10,_$constants_479.minButtonWidth);button.attr("transform","translate("+(borderWidth+width)+","+borderWidth+")"),rect.attr({x:0,y:0,width:wEff,height:height}),_$svg_text_utils_562.positionText(text,wEff/2,height/2-(tLines-1)*tHeight/2+3),width+=wEff+5});var graphSize=gd._fullLayout._size,lx=graphSize.l+graphSize.w*opts.x,ly=graphSize.t+graphSize.h*(1-opts.y),xanchor="left";_$anchor_utils_463.isRightAnchor(opts)&&(lx-=width,xanchor="right"),_$anchor_utils_463.isCenterAnchor(opts)&&(lx-=width/2,xanchor="center");var yanchor="top";_$anchor_utils_463.isBottomAnchor(opts)&&(ly-=height,yanchor="bottom"),_$anchor_utils_463.isMiddleAnchor(opts)&&(ly-=height/2,yanchor="middle"),width=Math.ceil(width),height=Math.ceil(height),lx=Math.round(lx),ly=Math.round(ly),_$plots_647.autoMargin(gd,axName+"-range-selector",{x:opts.x,y:opts.y,l:width*__FROM_TL_481[xanchor],r:width*__FROM_BR_481[xanchor],b:height*__FROM_BR_481[yanchor],t:height*__FROM_TL_481[yanchor]}),selector.attr("transform","translate("+lx+","+ly+")")}(gd,buttons,selectorLayout,axisLayout._name,selector)})}},_$attributes_484={bgcolor:{valType:"color",dflt:_$attributes_410.background,editType:"plot"},bordercolor:{valType:"color",dflt:_$attributes_410.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},_$constants_486={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15},listAxes=_$axis_ids_587.list,__getAutoRange_485=_$autorange___getAutoRange,_$oppaxis_attributes_490={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"};function drawBg(rangeSlider,gd,axisOpts,opts){var bg=rangeSlider.selectAll("rect."+_$constants_486.bgClassName).data([0]);bg.enter().append("rect").classed(_$constants_486.bgClassName,!0).attr({x:0,y:0,"shape-rendering":"crispEdges"});var borderCorrect=opts.borderwidth%2==0?opts.borderwidth:opts.borderwidth-1,offsetShift=-opts._offsetShift,lw=_$drawing_436.crispRound(gd,opts.borderwidth);bg.attr({width:opts._width+borderCorrect,height:opts._height+borderCorrect,transform:"translate("+offsetShift+","+offsetShift+")",fill:opts.bgcolor,stroke:opts.bordercolor,"stroke-width":lw})}function addClipPath(rangeSlider,gd,axisOpts,opts){var clipPath=gd._fullLayout._topdefs.selectAll("#"+opts._clipId).data([0]);clipPath.enter().append("clipPath").attr("id",opts._clipId).append("rect").attr({x:0,y:0}),clipPath.select("rect").attr({width:opts._width,height:opts._height})}function drawRangePlot(rangeSlider,gd,axisOpts,opts){var mainplotinfo,subplotData=_$axes_584.getSubplots(gd,axisOpts),calcData=gd.calcdata,rangePlots=rangeSlider.selectAll("g."+_$constants_486.rangePlotClassName).data(subplotData,_$lib_539.identity);rangePlots.enter().append("g").attr("class",function(id){return _$constants_486.rangePlotClassName+" "+id}).call(_$drawing_436.setClipUrl,opts._clipId),rangePlots.order(),rangePlots.exit().remove(),rangePlots.each(function(id,i){var plotgroup=_$d3_127.select(this),isMainPlot=0===i,oppAxisOpts=_$axes_584.getFromId(gd,id,"y"),oppAxisName=oppAxisOpts._name,oppAxisRangeOpts=opts[oppAxisName],mockFigure={data:[],layout:{xaxis:{type:axisOpts.type,domain:[0,1],range:opts.range.slice(),calendar:axisOpts.calendar},width:opts._width,height:opts._height,margin:{t:0,b:0,l:0,r:0}},_context:gd._context};mockFigure.layout[oppAxisName]={type:oppAxisOpts.type,domain:[0,1],range:"match"!==oppAxisRangeOpts.rangemode?oppAxisRangeOpts.range.slice():oppAxisOpts.range.slice(),calendar:oppAxisOpts.calendar},_$plots_647.supplyDefaults(mockFigure);var plotinfo={id:id,plotgroup:plotgroup,xaxis:mockFigure._fullLayout.xaxis,yaxis:mockFigure._fullLayout[oppAxisName]};isMainPlot?mainplotinfo=plotinfo:(plotinfo.mainplot="xy",plotinfo.mainplotinfo=mainplotinfo),_$cartesian_595.rangePlot(gd,plotinfo,function filterRangePlotCalcData(calcData,subplotId){for(var out=[],i=0;i<calcData.length;i++){var calcTrace=calcData[i],trace=calcTrace[0].trace;trace.xaxis+trace.yaxis===subplotId&&out.push(calcTrace)}return out}(calcData,id))})}function drawMasks(rangeSlider,gd,axisOpts,opts,oppAxisRangeOpts){var maskMin=rangeSlider.selectAll("rect."+_$constants_486.maskMinClassName).data([0]);maskMin.enter().append("rect").classed(_$constants_486.maskMinClassName,!0).attr({x:0,y:0}).attr("shape-rendering","crispEdges"),maskMin.attr("height",opts._height).call(_$color_411.fill,_$constants_486.maskColor);var maskMax=rangeSlider.selectAll("rect."+_$constants_486.maskMaxClassName).data([0]);if(maskMax.enter().append("rect").classed(_$constants_486.maskMaxClassName,!0).attr("y",0).attr("shape-rendering","crispEdges"),maskMax.attr("height",opts._height).call(_$color_411.fill,_$constants_486.maskColor),"match"!==oppAxisRangeOpts.rangemode){var maskMinOppAxis=rangeSlider.selectAll("rect."+_$constants_486.maskMinOppAxisClassName).data([0]);maskMinOppAxis.enter().append("rect").classed(_$constants_486.maskMinOppAxisClassName,!0).attr("y",0).attr("shape-rendering","crispEdges"),maskMinOppAxis.attr("width",opts._width).call(_$color_411.fill,_$constants_486.maskOppAxisColor);var maskMaxOppAxis=rangeSlider.selectAll("rect."+_$constants_486.maskMaxOppAxisClassName).data([0]);maskMaxOppAxis.enter().append("rect").classed(_$constants_486.maskMaxOppAxisClassName,!0).attr("y",0).attr("shape-rendering","crispEdges"),maskMaxOppAxis.attr("width",opts._width).style("border-top",_$constants_486.maskOppBorder).call(_$color_411.fill,_$constants_486.maskOppAxisColor)}}function drawSlideBox(rangeSlider,gd,axisOpts,opts){if(!gd._context.staticPlot){var slideBox=rangeSlider.selectAll("rect."+_$constants_486.slideBoxClassName).data([0]);slideBox.enter().append("rect").classed(_$constants_486.slideBoxClassName,!0).attr("y",0).attr("cursor",_$constants_486.slideBoxCursor).attr("shape-rendering","crispEdges"),slideBox.attr({height:opts._height,fill:_$constants_486.slideBoxFill})}}function drawGrabbers(rangeSlider,gd,axisOpts,opts){var grabberMin=rangeSlider.selectAll("g."+_$constants_486.grabberMinClassName).data([0]);grabberMin.enter().append("g").classed(_$constants_486.grabberMinClassName,!0);var grabberMax=rangeSlider.selectAll("g."+_$constants_486.grabberMaxClassName).data([0]);grabberMax.enter().append("g").classed(_$constants_486.grabberMaxClassName,!0);var handleFixAttrs={x:0,width:_$constants_486.handleWidth,rx:_$constants_486.handleRadius,fill:_$color_411.background,stroke:_$color_411.defaultLine,"stroke-width":_$constants_486.handleStrokeWidth,"shape-rendering":"crispEdges"},handleDynamicAttrs={y:Math.round(opts._height/4),height:Math.round(opts._height/2)},handleMin=grabberMin.selectAll("rect."+_$constants_486.handleMinClassName).data([0]);handleMin.enter().append("rect").classed(_$constants_486.handleMinClassName,!0).attr(handleFixAttrs),handleMin.attr(handleDynamicAttrs);var handleMax=grabberMax.selectAll("rect."+_$constants_486.handleMaxClassName).data([0]);if(handleMax.enter().append("rect").classed(_$constants_486.handleMaxClassName,!0).attr(handleFixAttrs),handleMax.attr(handleDynamicAttrs),!gd._context.staticPlot){var grabAreaFixAttrs={width:_$constants_486.grabAreaWidth,x:0,y:0,fill:_$constants_486.grabAreaFill,cursor:_$constants_486.grabAreaCursor},grabAreaMin=grabberMin.selectAll("rect."+_$constants_486.grabAreaMinClassName).data([0]);grabAreaMin.enter().append("rect").classed(_$constants_486.grabAreaMinClassName,!0).attr(grabAreaFixAttrs),grabAreaMin.attr("height",opts._height);var grabAreaMax=grabberMax.selectAll("rect."+_$constants_486.grabAreaMaxClassName).data([0]);grabAreaMax.enter().append("rect").classed(_$constants_486.grabAreaMaxClassName,!0).attr(grabAreaFixAttrs),grabAreaMax.attr("height",opts._height)}}var _$rangeslider_489={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:_$lib_539.extendFlat({},_$attributes_484,{yaxis:_$oppaxis_attributes_490})}}},layoutAttributes:_$attributes_484,handleDefaults:function handleDefaults(layoutIn,layoutOut,axName){if(layoutIn[axName].rangeslider){_$lib_539.isPlainObject(layoutIn[axName].rangeslider)||(layoutIn[axName].rangeslider={});var containerIn=layoutIn[axName].rangeslider,axOut=layoutOut[axName],containerOut=axOut.rangeslider={};if(coerce("visible")){coerce("bgcolor",layoutOut.plot_bgcolor),coerce("bordercolor"),coerce("borderwidth"),coerce("thickness"),axOut._rangesliderAutorange=coerce("autorange",!axOut.isValidRange(containerIn.range)),coerce("range");var subplots=layoutOut._subplots;if(subplots)for(var yIds=subplots.cartesian.filter(function(subplotId){return subplotId.substr(0,subplotId.indexOf("y"))===_$axis_ids_587.name2id(axName)}).map(function(subplotId){return subplotId.substr(subplotId.indexOf("y"),subplotId.length)}),yNames=_$lib_539.simpleMap(yIds,_$axis_ids_587.id2name),i=0;i<yNames.length;i++){var rangemodeDflt,yName=yNames[i],rangeContainerIn=containerIn[yName]||{},rangeContainerOut=containerOut[yName]={},yAxOut=layoutOut[yName];rangeContainerIn.range&&yAxOut.isValidRange(rangeContainerIn.range)&&(rangemodeDflt="fixed");var rangeMode=coerceRange(rangeContainerIn,rangeContainerOut,"rangemode",rangemodeDflt);"match"!==rangeMode&&coerceRange(rangeContainerIn,rangeContainerOut,"range",yAxOut.range.slice()),yAxOut._rangesliderAutorange="auto"===rangeMode}containerOut._input=containerIn}}function coerce(attr,dflt){return _$lib_539.coerce(containerIn,containerOut,_$attributes_484,attr,dflt)}function coerceRange(rangeContainerIn,rangeContainerOut,attr,dflt){return _$lib_539.coerce(rangeContainerIn,rangeContainerOut,_$oppaxis_attributes_490,attr,dflt)}},calcAutorange:function calcAutorange(gd){for(var axes=listAxes(gd,"x",!0),i=0;i<axes.length;i++){var ax=axes[i],opts=ax[_$constants_486.name];opts&&opts.visible&&opts.autorange&&ax._min.length&&ax._max.length&&(opts._input.autorange=!0,opts._input.range=opts.range=__getAutoRange_485(ax))}},draw:function(gd){var fullLayout=gd._fullLayout,rangeSliderData=function makeRangeSliderData(fullLayout){var axes=_$axes_584.list({_fullLayout:fullLayout},"x",!0),name=_$constants_486.name,out=[];if(fullLayout._has("gl2d"))return out;for(var i=0;i<axes.length;i++){var ax=axes[i];ax[name]&&ax[name].visible&&out.push(ax)}return out}(fullLayout);var rangeSliders=fullLayout._infolayer.selectAll("g."+_$constants_486.containerClassName).data(rangeSliderData,function keyFunction(axisOpts){return axisOpts._name});rangeSliders.enter().append("g").classed(_$constants_486.containerClassName,!0).attr("pointer-events","all"),rangeSliders.exit().each(function(axisOpts){var rangeSlider=_$d3_127.select(this),opts=axisOpts[_$constants_486.name];rangeSlider.remove(),fullLayout._topdefs.select("#"+opts._clipId).remove()}),rangeSliders.exit().size()&&function clearPushMargins(gd){for(var pushMargins=gd._fullLayout._pushmargin||{},keys=Object.keys(pushMargins),i=0;i<keys.length;i++){var k=keys[i];-1!==k.indexOf(_$constants_486.name)&&_$plots_647.autoMargin(gd,k)}}(gd),0!==rangeSliderData.length&&rangeSliders.each(function(axisOpts){var rangeSlider=_$d3_127.select(this),opts=axisOpts[_$constants_486.name],oppAxisOpts=fullLayout[_$axes_584.id2name(axisOpts.anchor)],oppAxisRangeOpts=opts[_$axes_584.id2name(axisOpts.anchor)];if(opts.range){var outRange=opts.range,axRange=axisOpts.range;outRange[0]=axisOpts.l2r(Math.min(axisOpts.r2l(outRange[0]),axisOpts.r2l(axRange[0]))),outRange[1]=axisOpts.l2r(Math.max(axisOpts.r2l(outRange[1]),axisOpts.r2l(axRange[1]))),opts._input.range=outRange.slice()}axisOpts.cleanRange("rangeslider.range");for(var margin=fullLayout.margin,graphSize=fullLayout._size,domain=axisOpts.domain,tickHeight=(axisOpts._boundingBox||{}).height||0,oppBottom=1/0,subplotData=_$axes_584.getSubplots(gd,axisOpts),i=0;i<subplotData.length;i++){var oppAxis=_$axes_584.getFromId(gd,subplotData[i].substr(subplotData[i].indexOf("y")));oppBottom=Math.min(oppBottom,oppAxis.domain[0])}opts._id=_$constants_486.name+axisOpts._id,opts._clipId=opts._id+"-"+fullLayout._uid,opts._width=graphSize.w*(domain[1]-domain[0]),opts._height=(fullLayout.height-margin.b-margin.t)*opts.thickness,opts._offsetShift=Math.floor(opts.borderwidth/2);var x=Math.round(margin.l+graphSize.w*domain[0]),y=Math.round(graphSize.t+graphSize.h*(1-oppBottom)+tickHeight+opts._offsetShift+_$constants_486.extraPad);rangeSlider.attr("transform","translate("+x+","+y+")");var range0=axisOpts.r2l(opts.range[0]),range1=axisOpts.r2l(opts.range[1]),dist=range1-range0;if(opts.p2d=function(v){return v/opts._width*dist+range0},opts.d2p=function(v){return(v-range0)/dist*opts._width},opts._rl=[range0,range1],"match"!==oppAxisRangeOpts.rangemode){var range0OppAxis=oppAxisOpts.r2l(oppAxisRangeOpts.range[0]),distOppAxis=oppAxisOpts.r2l(oppAxisRangeOpts.range[1])-range0OppAxis;opts.d2pOppAxis=function(v){return(v-range0OppAxis)/distOppAxis*opts._height}}rangeSlider.call(drawBg,gd,axisOpts,opts).call(addClipPath,gd,axisOpts,opts).call(drawRangePlot,gd,axisOpts,opts).call(drawMasks,gd,axisOpts,opts,oppAxisRangeOpts).call(drawSlideBox,gd,axisOpts,opts).call(drawGrabbers,gd,axisOpts,opts),function setupDragElement(rangeSlider,gd,axisOpts,opts){var slideBox=rangeSlider.select("rect."+_$constants_486.slideBoxClassName).node(),grabAreaMin=rangeSlider.select("rect."+_$constants_486.grabAreaMinClassName).node(),grabAreaMax=rangeSlider.select("rect."+_$constants_486.grabAreaMaxClassName).node();rangeSlider.on("mousedown",function(){var event=_$d3_127.event,target=event.target,startX=event.clientX,offsetX=startX-rangeSlider.node().getBoundingClientRect().left,minVal=opts.d2p(axisOpts._rl[0]),maxVal=opts.d2p(axisOpts._rl[1]),dragCover=_$dragelement_433.coverSlip();function mouseMove(e){var pixelMin,pixelMax,cursor,delta=+e.clientX-startX;switch(target){case slideBox:cursor="ew-resize",pixelMin=minVal+delta,pixelMax=maxVal+delta;break;case grabAreaMin:cursor="col-resize",pixelMin=minVal+delta,pixelMax=maxVal;break;case grabAreaMax:cursor="col-resize",pixelMin=minVal,pixelMax=maxVal+delta;break;default:cursor="ew-resize",pixelMin=offsetX,pixelMax=offsetX+delta}if(pixelMax<pixelMin){var tmp=pixelMax;pixelMax=pixelMin,pixelMin=tmp}opts._pixelMin=pixelMin,opts._pixelMax=pixelMax,_$setCursor_558(_$d3_127.select(dragCover),cursor),function setDataRange(rangeSlider,gd,axisOpts,opts){function clamp(v){return axisOpts.l2r(_$lib_539.constrain(v,opts._rl[0],opts._rl[1]))}var dataMin=clamp(opts.p2d(opts._pixelMin)),dataMax=clamp(opts.p2d(opts._pixelMax));window.requestAnimationFrame(function(){_$registry_668.call("relayout",gd,axisOpts._name+".range",[dataMin,dataMax])})}(0,gd,axisOpts,opts)}dragCover.addEventListener("mousemove",mouseMove),dragCover.addEventListener("mouseup",function mouseUp(){dragCover.removeEventListener("mousemove",mouseMove),dragCover.removeEventListener("mouseup",mouseUp),_$lib_539.removeElement(dragCover)})})}(rangeSlider,gd,axisOpts,opts),function setPixelRange(rangeSlider,gd,axisOpts,opts,oppAxisOpts,oppAxisRangeOpts){var hw2=_$constants_486.handleWidth/2;function clamp(v){return _$lib_539.constrain(v,0,opts._width)}function clampOppAxis(v){return _$lib_539.constrain(v,0,opts._height)}function clampHandle(v){return _$lib_539.constrain(v,-hw2,opts._width+hw2)}var pixelMin=clamp(opts.d2p(axisOpts._rl[0])),pixelMax=clamp(opts.d2p(axisOpts._rl[1]));if(rangeSlider.select("rect."+_$constants_486.slideBoxClassName).attr("x",pixelMin).attr("width",pixelMax-pixelMin),rangeSlider.select("rect."+_$constants_486.maskMinClassName).attr("width",pixelMin),rangeSlider.select("rect."+_$constants_486.maskMaxClassName).attr("x",pixelMax).attr("width",opts._width-pixelMax),"match"!==oppAxisRangeOpts.rangemode){var pixelMinOppAxis=opts._height-clampOppAxis(opts.d2pOppAxis(oppAxisOpts._rl[1])),pixelMaxOppAxis=opts._height-clampOppAxis(opts.d2pOppAxis(oppAxisOpts._rl[0]));rangeSlider.select("rect."+_$constants_486.maskMinOppAxisClassName).attr("x",pixelMin).attr("height",pixelMinOppAxis).attr("width",pixelMax-pixelMin),rangeSlider.select("rect."+_$constants_486.maskMaxOppAxisClassName).attr("x",pixelMin).attr("y",pixelMaxOppAxis).attr("height",opts._height-pixelMaxOppAxis).attr("width",pixelMax-pixelMin),rangeSlider.select("rect."+_$constants_486.slideBoxClassName).attr("y",pixelMinOppAxis).attr("height",pixelMaxOppAxis-pixelMinOppAxis)}var xMin=Math.round(clampHandle(pixelMin-hw2))-.5,xMax=Math.round(clampHandle(pixelMax-hw2))+.5;rangeSlider.select("g."+_$constants_486.grabberMinClassName).attr("transform","translate("+xMin+",0.5)"),rangeSlider.select("g."+_$constants_486.grabberMaxClassName).attr("transform","translate("+xMax+",0.5)")}(rangeSlider,0,axisOpts,opts,oppAxisOpts,oppAxisRangeOpts),"bottom"===axisOpts.side&&_$titles_504.draw(gd,axisOpts._id+"title",{propContainer:axisOpts,propName:axisOpts._name+".title",placeholder:fullLayout._dfltTitle.x,attributes:{x:axisOpts._offset+axisOpts._length/2,y:y+opts._height+opts._offsetShift+10+1.5*axisOpts.titlefont.size,"text-anchor":"middle"}}),_$plots_647.autoMargin(gd,opts._id,{x:domain[0],y:oppBottom,l:0,r:0,t:0,b:opts._height+margin.b+tickHeight,pad:_$constants_486.extraPad+2*opts._offsetShift})})}},__scatterLineAttrs_491=_$attributes_862.line,__dash_491=_$attributes_435.dash,__extendFlat_491=_$extend_528.extendFlat,_$attributes_491={_isLinkedToArray:"shape",visible:{valType:"boolean",dflt:!0,editType:"calcIfAutorange+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calcIfAutorange+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:__extendFlat_491({},_$attributes_394.xref,{}),x0:{valType:"any",editType:"calcIfAutorange+arraydraw"},x1:{valType:"any",editType:"calcIfAutorange+arraydraw"},yref:__extendFlat_491({},_$attributes_394.yref,{}),y0:{valType:"any",editType:"calcIfAutorange+arraydraw"},y1:{valType:"any",editType:"calcIfAutorange+arraydraw"},path:{valType:"string",editType:"calcIfAutorange+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:__extendFlat_491({},__scatterLineAttrs_491.color,{editType:"arraydraw"}),width:__extendFlat_491({},__scatterLineAttrs_491.width,{editType:"calcIfAutorange+arraydraw"}),dash:__extendFlat_491({},__dash_491,{editType:"arraydraw"}),editType:"calcIfAutorange+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},editType:"arraydraw"},_$constants_493={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}},_$helpers_496={rangeToShapePosition:function(ax){return"log"===ax.type?ax.r2d:function(v){return v}},shapePositionToRange:function(ax){return"log"===ax.type?ax.d2r:function(v){return v}},decodeDate:function(convertToPx){return function(v){return v.replace&&(v=v.replace("_"," ")),convertToPx(v)}},encodeDate:function(convertToDate){return function(v){return convertToDate(v).replace(" ","_")}},getDataToPixel:function(gd,axis,isVertical){var dataToPixel,gs=gd._fullLayout._size;if(axis){var d2r=_$helpers_496.shapePositionToRange(axis);dataToPixel=function(v){return axis._offset+axis.r2p(d2r(v,!0))},"date"===axis.type&&(dataToPixel=_$helpers_496.decodeDate(dataToPixel))}else dataToPixel=isVertical?function(v){return gs.t+gs.h*(1-v)}:function(v){return gs.l+gs.w*v};return dataToPixel},getPixelToData:function(gd,axis,isVertical){var pixelToData,gs=gd._fullLayout._size;if(axis){var r2d=_$helpers_496.rangeToShapePosition(axis);pixelToData=function(p){return r2d(axis.p2r(p-axis._offset))}}else pixelToData=isVertical?function(p){return 1-(p-gs.t)/gs.h}:function(p){return(p-gs.l)/gs.w};return pixelToData}};function shapeBounds(ax,v0,v1,path,paramsToUse){var convertVal="category"===ax.type?ax.r2c:ax.d2c;if(void 0!==v0)return[convertVal(v0),convertVal(v1)];if(path){var i,drawnParam,params,val,min=1/0,max=-1/0,segments=path.match(_$constants_493.segmentRE);for("date"===ax.type&&(convertVal=_$helpers_496.decodeDate(convertVal)),i=0;i<segments.length;i++)void 0!==(drawnParam=paramsToUse[segments[i].charAt(0)].drawn)&&(!(params=segments[i].substr(1).match(_$constants_493.paramRE))||params.length<drawnParam||((val=convertVal(params[drawnParam]))<min&&(min=val),val>max&&(max=val)));return max>=min?[min,max]:void 0}}var _$handleShapeDefaults_498=function handleShapeDefaults(shapeIn,shapeOut,fullLayout,opts,itemOpts){function coerce(attr,dflt){return _$lib_539.coerce(shapeIn,shapeOut,_$attributes_491,attr,dflt)}if(opts=opts||{},!coerce("visible",!(itemOpts=itemOpts||{}).itemIsNotPlainObject))return shapeOut;coerce("layer"),coerce("opacity"),coerce("fillcolor"),coerce("line.color"),coerce("line.width"),coerce("line.dash");for(var shapeType=coerce("type",shapeIn.path?"path":"rect"),axLetters=["x","y"],i=0;i<2;i++){var axLetter=axLetters[i],gdMock={_fullLayout:fullLayout},axRef=_$axes_584.coerceRef(shapeIn,shapeOut,gdMock,axLetter,"","paper");if("path"!==shapeType){var ax,pos2r,r2pos;"paper"!==axRef?(ax=_$axes_584.getFromId(gdMock,axRef),r2pos=_$helpers_496.rangeToShapePosition(ax),pos2r=_$helpers_496.shapePositionToRange(ax)):pos2r=r2pos=_$lib_539.identity;var attr0=axLetter+"0",attr1=axLetter+"1",in0=shapeIn[attr0],in1=shapeIn[attr1];shapeIn[attr0]=pos2r(shapeIn[attr0],!0),shapeIn[attr1]=pos2r(shapeIn[attr1],!0),_$axes_584.coercePosition(shapeOut,gdMock,coerce,axRef,attr0,.25),_$axes_584.coercePosition(shapeOut,gdMock,coerce,axRef,attr1,.75),shapeOut[attr0]=r2pos(shapeOut[attr0]),shapeOut[attr1]=r2pos(shapeOut[attr1]),shapeIn[attr0]=in0,shapeIn[attr1]=in1}}return"path"===shapeType?coerce("path"):_$lib_539.noneOrAll(shapeIn,shapeOut,["x0","x1","y0","y1"]),shapeOut},_$draw_495={draw:function __draw_495(gd){var fullLayout=gd._fullLayout;fullLayout._shapeUpperLayer.selectAll("path").remove(),fullLayout._shapeLowerLayer.selectAll("path").remove(),fullLayout._shapeSubplotLayers.selectAll("path").remove();for(var i=0;i<fullLayout.shapes.length;i++)fullLayout.shapes[i].visible&&__drawOne_495(gd,i)},drawOne:__drawOne_495};function __drawOne_495(gd,index){gd._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+index+'"]').remove();var optionsIn=(gd.layout.shapes||[])[index],options=gd._fullLayout.shapes[index];if(optionsIn&&!1!==options.visible)if("below"!==options.layer)drawShape(gd._fullLayout._shapeUpperLayer);else if("paper"===options.xref||"paper"===options.yref)drawShape(gd._fullLayout._shapeLowerLayer);else{var plotinfo=gd._fullLayout._plots[options.xref+options.yref];if(plotinfo)drawShape((plotinfo.mainplotinfo||plotinfo).shapelayer);else drawShape(gd._fullLayout._shapeLowerLayer)}function drawShape(shapeLayer){var attrs={"data-index":index,"fill-rule":"evenodd",d:getPathString(gd,options)},lineColor=options.line.width?options.line.color:"rgba(0,0,0,0)",path=shapeLayer.append("path").attr(attrs).style("opacity",options.opacity).call(_$color_411.stroke,lineColor).call(_$color_411.fill,options.fillcolor).call(_$drawing_436.dashLine,options.line.dash,options.line.width),clipAxes=(options.xref+options.yref).replace(/paper/g,"");path.call(_$drawing_436.setClipUrl,clipAxes?"clip"+gd._fullLayout._uid+clipAxes:null),gd._context.edits.shapePosition&&function __setupDragElement_495(gd,shapePath,shapeOptions,index){var update,x0,y0,x1,y1,astrX0,astrY0,astrX1,astrY1,n0,s0,w0,e0,astrN,astrS,astrW,astrE,optN,optS,optW,optE,pathIn,astrPath,xa,ya,x2p,y2p,p2x,p2y,dragMode,MINWIDTH=10,MINHEIGHT=10,dragOptions={element:shapePath.node(),gd:gd,prepFn:function startDrag(evt){xa=_$axes_584.getFromId(gd,shapeOptions.xref),ya=_$axes_584.getFromId(gd,shapeOptions.yref),x2p=_$helpers_496.getDataToPixel(gd,xa),y2p=_$helpers_496.getDataToPixel(gd,ya,!0),p2x=_$helpers_496.getPixelToData(gd,xa),p2y=_$helpers_496.getPixelToData(gd,ya,!0);var astr="shapes["+index+"]";"path"===shapeOptions.type?(pathIn=shapeOptions.path,astrPath=astr+".path"):(x0=x2p(shapeOptions.x0),y0=y2p(shapeOptions.y0),x1=x2p(shapeOptions.x1),y1=y2p(shapeOptions.y1),astrX0=astr+".x0",astrY0=astr+".y0",astrX1=astr+".x1",astrY1=astr+".y1");x0<x1?(w0=x0,astrW=astr+".x0",optW="x0",e0=x1,astrE=astr+".x1",optE="x1"):(w0=x1,astrW=astr+".x1",optW="x1",e0=x0,astrE=astr+".x0",optE="x0");y0<y1?(n0=y0,astrN=astr+".y0",optN="y0",s0=y1,astrS=astr+".y1",optS="y1"):(n0=y1,astrN=astr+".y1",optN="y1",s0=y0,astrS=astr+".y0",optS="y0");update={},updateDragMode(evt),dragOptions.moveFn="move"===dragMode?moveShape:resizeShape},doneFn:function endDrag(){_$setCursor_558(shapePath),_$registry_668.call("relayout",gd,update)}},dragBBox=dragOptions.element.getBoundingClientRect();function updateDragMode(evt){var w=dragBBox.right-dragBBox.left,h=dragBBox.bottom-dragBBox.top,x=evt.clientX-dragBBox.left,y=evt.clientY-dragBBox.top,cursor=w>MINWIDTH&&h>MINHEIGHT&&!evt.shiftKey?_$dragelement_433.getCursor(x/w,1-y/h):"move";_$setCursor_558(shapePath,cursor),dragMode=cursor.split("-")[0]}function moveShape(dx,dy){if("path"===shapeOptions.type){var moveX=function moveX(x){return p2x(x2p(x)+dx)};xa&&"date"===xa.type&&(moveX=_$helpers_496.encodeDate(moveX));var moveY=function moveY(y){return p2y(y2p(y)+dy)};ya&&"date"===ya.type&&(moveY=_$helpers_496.encodeDate(moveY)),shapeOptions.path=movePath(pathIn,moveX,moveY),update[astrPath]=shapeOptions.path}else update[astrX0]=shapeOptions.x0=p2x(x0+dx),update[astrY0]=shapeOptions.y0=p2y(y0+dy),update[astrX1]=shapeOptions.x1=p2x(x1+dx),update[astrY1]=shapeOptions.y1=p2y(y1+dy);shapePath.attr("d",getPathString(gd,shapeOptions))}function resizeShape(dx,dy){if("path"===shapeOptions.type){var moveX=function moveX(x){return p2x(x2p(x)+dx)};xa&&"date"===xa.type&&(moveX=_$helpers_496.encodeDate(moveX));var moveY=function moveY(y){return p2y(y2p(y)+dy)};ya&&"date"===ya.type&&(moveY=_$helpers_496.encodeDate(moveY)),shapeOptions.path=movePath(pathIn,moveX,moveY),update[astrPath]=shapeOptions.path}else{var newN=~dragMode.indexOf("n")?n0+dy:n0,newS=~dragMode.indexOf("s")?s0+dy:s0,newW=~dragMode.indexOf("w")?w0+dx:w0,newE=~dragMode.indexOf("e")?e0+dx:e0;newS-newN>MINHEIGHT&&(update[astrN]=shapeOptions[optN]=p2y(newN),update[astrS]=shapeOptions[optS]=p2y(newS)),newE-newW>MINWIDTH&&(update[astrW]=shapeOptions[optW]=p2x(newW),update[astrE]=shapeOptions[optE]=p2x(newE))}shapePath.attr("d",getPathString(gd,shapeOptions))}_$dragelement_433.init(dragOptions),shapePath.node().onmousemove=updateDragMode}(gd,path,options,index)}}function getPathString(gd,options){var x2r,x2p,y2r,y2p,type=options.type,xa=_$axes_584.getFromId(gd,options.xref),ya=_$axes_584.getFromId(gd,options.yref),gs=gd._fullLayout._size;if(xa?(x2r=_$helpers_496.shapePositionToRange(xa),x2p=function(v){return xa._offset+xa.r2p(x2r(v,!0))}):x2p=function(v){return gs.l+gs.w*v},ya?(y2r=_$helpers_496.shapePositionToRange(ya),y2p=function(v){return ya._offset+ya.r2p(y2r(v,!0))}):y2p=function(v){return gs.t+gs.h*(1-v)},"path"===type)return xa&&"date"===xa.type&&(x2p=_$helpers_496.decodeDate(x2p)),ya&&"date"===ya.type&&(y2p=_$helpers_496.decodeDate(y2p)),function convertPath(pathIn,x2p,y2p){return pathIn.replace(_$constants_493.segmentRE,function(segment){var paramNumber=0,segmentType=segment.charAt(0),xParams=_$constants_493.paramIsX[segmentType],yParams=_$constants_493.paramIsY[segmentType],nParams=_$constants_493.numParams[segmentType],paramString=segment.substr(1).replace(_$constants_493.paramRE,function(param){return xParams[paramNumber]?param=x2p(param):yParams[paramNumber]&&(param=y2p(param)),++paramNumber>nParams&&(param="X"),param});return paramNumber>nParams&&(paramString=paramString.replace(/[\s,]*X.*/,""),_$lib_539.log("Ignoring extra params in segment "+segment)),segmentType+paramString})}(options.path,x2p,y2p);var x0=x2p(options.x0),x1=x2p(options.x1),y0=y2p(options.y0),y1=y2p(options.y1);if("line"===type)return"M"+x0+","+y0+"L"+x1+","+y1;if("rect"===type)return"M"+x0+","+y0+"H"+x1+"V"+y1+"H"+x0+"Z";var cx=(x0+x1)/2,cy=(y0+y1)/2,rx=Math.abs(cx-x0),ry=Math.abs(cy-y0),rArc="A"+rx+","+ry,rightPt=cx+rx+","+cy;return"M"+rightPt+rArc+" 0 1,1 "+(cx+","+(cy-ry))+rArc+" 0 0,1 "+rightPt+"Z"}function movePath(pathIn,moveX,moveY){return pathIn.replace(_$constants_493.segmentRE,function(segment){var paramNumber=0,segmentType=segment.charAt(0),xParams=_$constants_493.paramIsX[segmentType],yParams=_$constants_493.paramIsY[segmentType],nParams=_$constants_493.numParams[segmentType];return segmentType+segment.substr(1).replace(_$constants_493.paramRE,function(param){return paramNumber>=nParams?param:(xParams[paramNumber]?param=moveX(param):yParams[paramNumber]&&(param=moveY(param)),paramNumber++,param)})})}var _$shapes_497={moduleType:"component",name:"shapes",layoutAttributes:_$attributes_491,supplyLayoutDefaults:function supplyLayoutDefaults(layoutIn,layoutOut){_$handleArrayContainerDefaults_580(layoutIn,layoutOut,{name:"shapes",handleItemDefaults:_$handleShapeDefaults_498})},includeBasePlot:_$makeIncludeComponents_594("shapes"),calcAutorange:function calcAutorange(gd){var fullLayout=gd._fullLayout,shapeList=_$lib_539.filterVisible(fullLayout.shapes);if(shapeList.length&&gd._fullData.length)for(var i=0;i<shapeList.length;i++){var ax,bounds,shape=shapeList[i],ppad=shape.line.width/2;"paper"!==shape.xref&&(bounds=shapeBounds(ax=_$axes_584.getFromId(gd,shape.xref),shape.x0,shape.x1,shape.path,_$constants_493.paramIsX))&&_$axes_584.expand(ax,bounds,{ppad:ppad}),"paper"!==shape.yref&&(bounds=shapeBounds(ax=_$axes_584.getFromId(gd,shape.yref),shape.y0,shape.y1,shape.path,_$constants_493.paramIsY))&&_$axes_584.expand(ax,bounds,{ppad:ppad})}},draw:_$draw_495.draw,drawOne:_$draw_495.drawOne},_$constants_500={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0},_$pad_attributes_646={t:{valType:"number",dflt:0,editType:"arraydraw"},r:{valType:"number",dflt:0,editType:"arraydraw"},b:{valType:"number",dflt:0,editType:"arraydraw"},l:{valType:"number",dflt:0,editType:"arraydraw"},editType:"arraydraw"},__extendDeepAll_499=_$extend_528.extendDeepAll,_$attributes_499=(0,_$edit_types_569.overrideAll)({_isLinkedToArray:"slider",visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:{_isLinkedToArray:"step",method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:__extendDeepAll_499({},_$pad_attributes_646,{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:_$animation_attributes_579.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:_$font_attributes_611({})},font:_$font_attributes_611({}),activebgcolor:{valType:"color",dflt:_$constants_500.gripBgActiveColor},bgcolor:{valType:"color",dflt:_$constants_500.railBgColor},bordercolor:{valType:"color",dflt:_$constants_500.railBorderColor},borderwidth:{valType:"number",min:0,dflt:_$constants_500.railBorderWidth},ticklen:{valType:"number",min:0,dflt:_$constants_500.tickLength},tickcolor:{valType:"color",dflt:_$constants_500.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:_$constants_500.minorTickLength}},"arraydraw","from-root"),__name_501=_$constants_500.name,stepAttrs=_$attributes_499.steps;function sliderDefaults(sliderIn,sliderOut,layoutOut){function coerce(attr,dflt){return _$lib_539.coerce(sliderIn,sliderOut,_$attributes_499,attr,dflt)}coerce("visible",function stepsDefaults(sliderIn,sliderOut){var valueIn,valueOut,valuesIn=sliderIn.steps||[],valuesOut=sliderOut.steps=[];function coerce(attr,dflt){return _$lib_539.coerce(valueIn,valueOut,stepAttrs,attr,dflt)}for(var i=0;i<valuesIn.length;i++)valueIn=valuesIn[i],valueOut={},coerce("method"),_$lib_539.isPlainObject(valueIn)&&("skip"===valueOut.method||Array.isArray(valueIn.args))&&(coerce("args"),coerce("label","step-"+i),coerce("value",valueOut.label),coerce("execute"),valuesOut.push(valueOut));return valuesOut}(sliderIn,sliderOut).length>0)&&(coerce("active"),coerce("x"),coerce("y"),_$lib_539.noneOrAll(sliderIn,sliderOut,["x","y"]),coerce("xanchor"),coerce("yanchor"),coerce("len"),coerce("lenmode"),coerce("pad.t"),coerce("pad.r"),coerce("pad.b"),coerce("pad.l"),_$lib_539.coerceFont(coerce,"font",layoutOut.font),coerce("currentvalue.visible")&&(coerce("currentvalue.xanchor"),coerce("currentvalue.prefix"),coerce("currentvalue.suffix"),coerce("currentvalue.offset"),_$lib_539.coerceFont(coerce,"currentvalue.font",sliderOut.font)),coerce("transition.duration"),coerce("transition.easing"),coerce("bgcolor"),coerce("activebgcolor"),coerce("bordercolor"),coerce("borderwidth"),coerce("ticklen"),coerce("tickwidth"),coerce("tickcolor"),coerce("minorticklen"))}var __LINE_SPACING_502=_$alignment_511.LINE_SPACING,__FROM_TL_502=_$alignment_511.FROM_TL,__FROM_BR_502=_$alignment_511.FROM_BR;function keyFunction(opts){return opts._index}function findDimensions(gd,sliderOpts){var sliderLabels=_$drawing_436.tester.selectAll("g."+_$constants_500.labelGroupClass).data(sliderOpts.steps);sliderLabels.enter().append("g").classed(_$constants_500.labelGroupClass,!0);var maxLabelWidth=0,labelHeight=0;sliderLabels.each(function(stepOpts){var textNode=drawLabel(_$d3_127.select(this),{step:stepOpts},sliderOpts).node();if(textNode){var bBox=_$drawing_436.bBox(textNode);labelHeight=Math.max(labelHeight,bBox.height),maxLabelWidth=Math.max(maxLabelWidth,bBox.width)}}),sliderLabels.remove();var dims=sliderOpts._dims={};dims.inputAreaWidth=Math.max(_$constants_500.railWidth,_$constants_500.gripHeight);var graphSize=gd._fullLayout._size;dims.lx=graphSize.l+graphSize.w*sliderOpts.x,dims.ly=graphSize.t+graphSize.h*(1-sliderOpts.y),"fraction"===sliderOpts.lenmode?dims.outerLength=Math.round(graphSize.w*sliderOpts.len):dims.outerLength=sliderOpts.len,dims.inputAreaStart=0,dims.inputAreaLength=Math.round(dims.outerLength-sliderOpts.pad.l-sliderOpts.pad.r);var availableSpacePerLabel=(dims.inputAreaLength-2*_$constants_500.stepInset)/(sliderOpts.steps.length-1),computedSpacePerLabel=maxLabelWidth+_$constants_500.labelPadding;if(dims.labelStride=Math.max(1,Math.ceil(computedSpacePerLabel/availableSpacePerLabel)),dims.labelHeight=labelHeight,dims.currentValueMaxWidth=0,dims.currentValueHeight=0,dims.currentValueTotalHeight=0,dims.currentValueMaxLines=1,sliderOpts.currentvalue.visible){var dummyGroup=_$drawing_436.tester.append("g");sliderLabels.each(function(stepOpts){var curValPrefix=drawCurrentValue(dummyGroup,sliderOpts,stepOpts.label),curValSize=curValPrefix.node()&&_$drawing_436.bBox(curValPrefix.node())||{width:0,height:0},lines=_$svg_text_utils_562.lineCount(curValPrefix);dims.currentValueMaxWidth=Math.max(dims.currentValueMaxWidth,Math.ceil(curValSize.width)),dims.currentValueHeight=Math.max(dims.currentValueHeight,Math.ceil(curValSize.height)),dims.currentValueMaxLines=Math.max(dims.currentValueMaxLines,lines)}),dims.currentValueTotalHeight=dims.currentValueHeight+sliderOpts.currentvalue.offset,dummyGroup.remove()}dims.height=dims.currentValueTotalHeight+_$constants_500.tickOffset+sliderOpts.ticklen+_$constants_500.labelOffset+dims.labelHeight+sliderOpts.pad.t+sliderOpts.pad.b;var xanchor="left";_$anchor_utils_463.isRightAnchor(sliderOpts)&&(dims.lx-=dims.outerLength,xanchor="right"),_$anchor_utils_463.isCenterAnchor(sliderOpts)&&(dims.lx-=dims.outerLength/2,xanchor="center");var yanchor="top";_$anchor_utils_463.isBottomAnchor(sliderOpts)&&(dims.ly-=dims.height,yanchor="bottom"),_$anchor_utils_463.isMiddleAnchor(sliderOpts)&&(dims.ly-=dims.height/2,yanchor="middle"),dims.outerLength=Math.ceil(dims.outerLength),dims.height=Math.ceil(dims.height),dims.lx=Math.round(dims.lx),dims.ly=Math.round(dims.ly),_$plots_647.autoMargin(gd,_$constants_500.autoMarginIdRoot+sliderOpts._index,{x:sliderOpts.x,y:sliderOpts.y,l:dims.outerLength*__FROM_TL_502[xanchor],r:dims.outerLength*__FROM_BR_502[xanchor],b:dims.height*__FROM_BR_502[yanchor],t:dims.height*__FROM_TL_502[yanchor]})}function drawCurrentValue(sliderGroup,sliderOpts,valueOverride){if(sliderOpts.currentvalue.visible){var x0,textAnchor,text=sliderGroup.selectAll("text").data([0]),dims=sliderOpts._dims;switch(sliderOpts.currentvalue.xanchor){case"right":x0=dims.inputAreaLength-_$constants_500.currentValueInset-dims.currentValueMaxWidth,textAnchor="left";break;case"center":x0=.5*dims.inputAreaLength,textAnchor="middle";break;default:x0=_$constants_500.currentValueInset,textAnchor="left"}text.enter().append("text").classed(_$constants_500.labelClass,!0).classed("user-select-none",!0).attr({"text-anchor":textAnchor,"data-notex":1});var str=sliderOpts.currentvalue.prefix?sliderOpts.currentvalue.prefix:"";if("string"==typeof valueOverride)str+=valueOverride;else str+=sliderOpts.steps[sliderOpts.active].label;sliderOpts.currentvalue.suffix&&(str+=sliderOpts.currentvalue.suffix),text.call(_$drawing_436.font,sliderOpts.currentvalue.font).text(str).call(_$svg_text_utils_562.convertToTspans,sliderOpts._gd);var lines=_$svg_text_utils_562.lineCount(text),y0=(dims.currentValueMaxLines+1-lines)*sliderOpts.currentvalue.font.size*__LINE_SPACING_502;return _$svg_text_utils_562.positionText(text,x0,y0),text}}function drawGrip(sliderGroup,gd,sliderOpts){var grip=sliderGroup.selectAll("rect."+_$constants_500.gripRectClass).data([0]);grip.enter().append("rect").classed(_$constants_500.gripRectClass,!0).call(attachGripEvents,gd,sliderGroup,sliderOpts).style("pointer-events","all"),grip.attr({width:_$constants_500.gripWidth,height:_$constants_500.gripHeight,rx:_$constants_500.gripRadius,ry:_$constants_500.gripRadius}).call(_$color_411.stroke,sliderOpts.bordercolor).call(_$color_411.fill,sliderOpts.bgcolor).style("stroke-width",sliderOpts.borderwidth+"px")}function drawLabel(item,data,sliderOpts){var text=item.selectAll("text").data([0]);return text.enter().append("text").classed(_$constants_500.labelClass,!0).classed("user-select-none",!0).attr({"text-anchor":"middle","data-notex":1}),text.call(_$drawing_436.font,sliderOpts.font).text(data.step.label).call(_$svg_text_utils_562.convertToTspans,sliderOpts._gd),text}function drawLabelGroup(sliderGroup,sliderOpts){var labels=sliderGroup.selectAll("g."+_$constants_500.labelsClass).data([0]),dims=sliderOpts._dims;labels.enter().append("g").classed(_$constants_500.labelsClass,!0);var labelItems=labels.selectAll("g."+_$constants_500.labelGroupClass).data(dims.labelSteps);labelItems.enter().append("g").classed(_$constants_500.labelGroupClass,!0),labelItems.exit().remove(),labelItems.each(function(d){var item=_$d3_127.select(this);item.call(drawLabel,d,sliderOpts),_$drawing_436.setTranslate(item,normalizedValueToPosition(sliderOpts,d.fraction),_$constants_500.tickOffset+sliderOpts.ticklen+sliderOpts.font.size*__LINE_SPACING_502+_$constants_500.labelOffset+dims.currentValueTotalHeight)})}function handleInput(gd,sliderGroup,sliderOpts,normalizedPosition,doTransition){var quantizedPosition=Math.round(normalizedPosition*(sliderOpts.steps.length-1));quantizedPosition!==sliderOpts.active&&setActive(gd,sliderGroup,sliderOpts,quantizedPosition,!0,doTransition)}function setActive(gd,sliderGroup,sliderOpts,index,doCallback,doTransition){var previousActive=sliderOpts.active;sliderOpts._input.active=sliderOpts.active=index;var step=sliderOpts.steps[sliderOpts.active];sliderGroup.call(setGripPosition,sliderOpts,sliderOpts.active/(sliderOpts.steps.length-1),doTransition),sliderGroup.call(drawCurrentValue,sliderOpts),gd.emit("plotly_sliderchange",{slider:sliderOpts,step:sliderOpts.steps[sliderOpts.active],interaction:doCallback,previousActive:previousActive}),step&&step.method&&doCallback&&(sliderGroup._nextMethod?(sliderGroup._nextMethod.step=step,sliderGroup._nextMethod.doCallback=doCallback,sliderGroup._nextMethod.doTransition=doTransition):(sliderGroup._nextMethod={step:step,doCallback:doCallback,doTransition:doTransition},sliderGroup._nextMethodRaf=window.requestAnimationFrame(function(){var _step=sliderGroup._nextMethod.step;_step.method&&(_step.execute&&_$plots_647.executeAPICommand(gd,_step.method,_step.args),sliderGroup._nextMethod=null,sliderGroup._nextMethodRaf=null)})))}function attachGripEvents(item,gd,sliderGroup){var node=sliderGroup.node(),$gd=_$d3_127.select(gd);function getSliderOpts(){return sliderGroup.data()[0]}item.on("mousedown",function(){var sliderOpts=getSliderOpts();gd.emit("plotly_sliderstart",{slider:sliderOpts});var grip=sliderGroup.select("."+_$constants_500.gripRectClass);_$d3_127.event.stopPropagation(),_$d3_127.event.preventDefault(),grip.call(_$color_411.fill,sliderOpts.activebgcolor);var normalizedPosition=positionToNormalizedValue(sliderOpts,_$d3_127.mouse(node)[0]);handleInput(gd,sliderGroup,sliderOpts,normalizedPosition,!0),sliderOpts._dragging=!0,$gd.on("mousemove",function(){var sliderOpts=getSliderOpts(),normalizedPosition=positionToNormalizedValue(sliderOpts,_$d3_127.mouse(node)[0]);handleInput(gd,sliderGroup,sliderOpts,normalizedPosition,!1)}),$gd.on("mouseup",function(){var sliderOpts=getSliderOpts();sliderOpts._dragging=!1,grip.call(_$color_411.fill,sliderOpts.bgcolor),$gd.on("mouseup",null),$gd.on("mousemove",null),gd.emit("plotly_sliderend",{slider:sliderOpts,step:sliderOpts.steps[sliderOpts.active]})})})}function drawTicks(sliderGroup,sliderOpts){var tick=sliderGroup.selectAll("rect."+_$constants_500.tickRectClass).data(sliderOpts.steps),dims=sliderOpts._dims;tick.enter().append("rect").classed(_$constants_500.tickRectClass,!0),tick.exit().remove(),tick.attr({width:sliderOpts.tickwidth+"px","shape-rendering":"crispEdges"}),tick.each(function(d,i){var isMajor=i%dims.labelStride==0,item=_$d3_127.select(this);item.attr({height:isMajor?sliderOpts.ticklen:sliderOpts.minorticklen}).call(_$color_411.fill,sliderOpts.tickcolor),_$drawing_436.setTranslate(item,normalizedValueToPosition(sliderOpts,i/(sliderOpts.steps.length-1))-.5*sliderOpts.tickwidth,(isMajor?_$constants_500.tickOffset:_$constants_500.minorTickOffset)+dims.currentValueTotalHeight)})}function setGripPosition(sliderGroup,sliderOpts,position,doTransition){var grip=sliderGroup.select("rect."+_$constants_500.gripRectClass),x=normalizedValueToPosition(sliderOpts,position);if(!sliderOpts._invokingCommand){var el=grip;doTransition&&sliderOpts.transition.duration>0&&(el=el.transition().duration(sliderOpts.transition.duration).ease(sliderOpts.transition.easing)),el.attr("transform","translate("+(x-.5*_$constants_500.gripWidth)+","+sliderOpts._dims.currentValueTotalHeight+")")}}function normalizedValueToPosition(sliderOpts,normalizedPosition){var dims=sliderOpts._dims;return dims.inputAreaStart+_$constants_500.stepInset+(dims.inputAreaLength-2*_$constants_500.stepInset)*Math.min(1,Math.max(0,normalizedPosition))}function positionToNormalizedValue(sliderOpts,position){var dims=sliderOpts._dims;return Math.min(1,Math.max(0,(position-_$constants_500.stepInset-dims.inputAreaStart)/(dims.inputAreaLength-2*_$constants_500.stepInset-2*dims.inputAreaStart)))}function drawTouchRect(sliderGroup,gd,sliderOpts){var rect=sliderGroup.selectAll("rect."+_$constants_500.railTouchRectClass).data([0]),dims=sliderOpts._dims;rect.enter().append("rect").classed(_$constants_500.railTouchRectClass,!0).call(attachGripEvents,gd,sliderGroup,sliderOpts).style("pointer-events","all"),rect.attr({width:dims.inputAreaLength,height:Math.max(dims.inputAreaWidth,_$constants_500.tickOffset+sliderOpts.ticklen+dims.labelHeight)}).call(_$color_411.fill,sliderOpts.bgcolor).attr("opacity",0),_$drawing_436.setTranslate(rect,0,dims.currentValueTotalHeight)}function drawRail(sliderGroup,sliderOpts){var rect=sliderGroup.selectAll("rect."+_$constants_500.railRectClass).data([0]),dims=sliderOpts._dims;rect.enter().append("rect").classed(_$constants_500.railRectClass,!0);var computedLength=dims.inputAreaLength-2*_$constants_500.railInset;rect.attr({width:computedLength,height:_$constants_500.railWidth,rx:_$constants_500.railRadius,ry:_$constants_500.railRadius,"shape-rendering":"crispEdges"}).call(_$color_411.stroke,sliderOpts.bordercolor).call(_$color_411.fill,sliderOpts.bgcolor).style("stroke-width",sliderOpts.borderwidth+"px"),_$drawing_436.setTranslate(rect,_$constants_500.railInset,.5*(dims.inputAreaWidth-_$constants_500.railWidth)+dims.currentValueTotalHeight)}var _$sliders_503={moduleType:"component",name:_$constants_500.name,layoutAttributes:_$attributes_499,supplyLayoutDefaults:function slidersDefaults(layoutIn,layoutOut){_$handleArrayContainerDefaults_580(layoutIn,layoutOut,{name:__name_501,handleItemDefaults:sliderDefaults})},draw:function draw(gd){var fullLayout=gd._fullLayout,sliderData=function makeSliderData(fullLayout,gd){for(var contOpts=fullLayout[_$constants_500.name],sliderData=[],i=0;i<contOpts.length;i++){var item=contOpts[i];item.visible&&item.steps.length&&(item._gd=gd,sliderData.push(item))}return sliderData}(fullLayout,gd),sliders=fullLayout._infolayer.selectAll("g."+_$constants_500.containerClassName).data(sliderData.length>0?[0]:[]);if(sliders.enter().append("g").classed(_$constants_500.containerClassName,!0).style("cursor","ew-resize"),sliders.exit().remove(),sliders.exit().size()&&function __clearPushMargins_502(gd){for(var pushMargins=gd._fullLayout._pushmargin||{},keys=Object.keys(pushMargins),i=0;i<keys.length;i++){var k=keys[i];-1!==k.indexOf(_$constants_500.autoMarginIdRoot)&&_$plots_647.autoMargin(gd,k)}}(gd),0!==sliderData.length){var sliderGroups=sliders.selectAll("g."+_$constants_500.groupClassName).data(sliderData,keyFunction);sliderGroups.enter().append("g").classed(_$constants_500.groupClassName,!0),sliderGroups.exit().each(function(sliderOpts){_$d3_127.select(this).remove(),sliderOpts._commandObserver.remove(),delete sliderOpts._commandObserver,_$plots_647.autoMargin(gd,_$constants_500.autoMarginIdRoot+sliderOpts._index)});for(var i=0;i<sliderData.length;i++){var sliderOpts=sliderData[i];findDimensions(gd,sliderOpts)}sliderGroups.each(function(sliderOpts){if(!(sliderOpts.steps.length<2)){var gSlider=_$d3_127.select(this);!function computeLabelSteps(sliderOpts){var dims=sliderOpts._dims;dims.labelSteps=[];for(var nsteps=sliderOpts.steps.length,i=0;i<nsteps;i+=dims.labelStride)dims.labelSteps.push({fraction:i/(nsteps-1),step:sliderOpts.steps[i]})}(sliderOpts),_$plots_647.manageCommandObserver(gd,sliderOpts,sliderOpts.steps,function(data){var opts=gSlider.data()[0];opts.active!==data.index&&(opts._dragging||setActive(gd,gSlider,opts,data.index,!1,!0))}),function drawSlider(gd,sliderGroup,sliderOpts){sliderOpts.active>=sliderOpts.steps.length&&(sliderOpts.active=0),sliderGroup.call(drawCurrentValue,sliderOpts).call(drawRail,sliderOpts).call(drawLabelGroup,sliderOpts).call(drawTicks,sliderOpts).call(drawTouchRect,gd,sliderOpts).call(drawGrip,gd,sliderOpts);var dims=sliderOpts._dims;_$drawing_436.setTranslate(sliderGroup,dims.lx+sliderOpts.pad.l,dims.ly+sliderOpts.pad.t),sliderGroup.call(setGripPosition,sliderOpts,sliderOpts.active/(sliderOpts.steps.length-1),!1),sliderGroup.call(drawCurrentValue,sliderOpts)}(gd,_$d3_127.select(this),sliderOpts)}})}}},__extendFlat_505=_$extend_528.extendFlat,_$attributes_505=(0,_$edit_types_569.overrideAll)({_isLinkedToArray:"updatemenu",_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:{_isLinkedToArray:"button",method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}},x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:__extendFlat_505({},_$pad_attributes_646,{}),font:_$font_attributes_611({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:_$attributes_410.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}},"arraydraw","from-root"),_$constants_506={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"◄",right:"►",up:"▲",down:"▼"}},__name_507=_$constants_506.name,__buttonAttrs_507=_$attributes_505.buttons;function menuDefaults(menuIn,menuOut,layoutOut){function coerce(attr,dflt){return _$lib_539.coerce(menuIn,menuOut,_$attributes_505,attr,dflt)}coerce("visible",function __buttonsDefaults_507(menuIn,menuOut){var buttonIn,buttonOut,buttonsIn=menuIn.buttons||[],buttonsOut=menuOut.buttons=[];function coerce(attr,dflt){return _$lib_539.coerce(buttonIn,buttonOut,__buttonAttrs_507,attr,dflt)}for(var i=0;i<buttonsIn.length;i++)buttonIn=buttonsIn[i],buttonOut={},coerce("method"),_$lib_539.isPlainObject(buttonIn)&&("skip"===buttonOut.method||Array.isArray(buttonIn.args))&&(coerce("args"),coerce("label"),coerce("execute"),buttonOut._index=i,buttonsOut.push(buttonOut));return buttonsOut}(menuIn,menuOut).length>0)&&(coerce("active"),coerce("direction"),coerce("type"),coerce("showactive"),coerce("x"),coerce("y"),_$lib_539.noneOrAll(menuIn,menuOut,["x","y"]),coerce("xanchor"),coerce("yanchor"),coerce("pad.t"),coerce("pad.r"),coerce("pad.b"),coerce("pad.l"),_$lib_539.coerceFont(coerce,"font",layoutOut.font),coerce("bgcolor",layoutOut.paper_bgcolor),coerce("bordercolor"),coerce("borderwidth"))}var _$ScrollBox_510=ScrollBox;function ScrollBox(gd,container,id){this.gd=gd,this.container=container,this.id=id,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}ScrollBox.barWidth=2,ScrollBox.barLength=20,ScrollBox.barRadius=2,ScrollBox.barPad=1,ScrollBox.barColor="#808BA4",ScrollBox.prototype.enable=function enable(position,translateX,translateY){var fullLayout=this.gd._fullLayout,fullWidth=fullLayout.width,fullHeight=fullLayout.height;this.position=position;var boxL,boxR,boxT,boxB,l=this.position.l,w=this.position.w,t=this.position.t,h=this.position.h,direction=this.position.direction,isDown="down"===direction,isLeft="left"===direction,isUp="up"===direction,boxW=w,boxH=h;isDown||isLeft||"right"===direction||isUp||(this.position.direction="down",isDown=!0),isDown||isUp?(boxR=(boxL=l)+boxW,isDown?(boxT=t,boxH=(boxB=Math.min(boxT+boxH,fullHeight))-boxT):boxH=(boxB=t+boxH)-(boxT=Math.max(boxB-boxH,0))):(boxB=(boxT=t)+boxH,isLeft?boxW=(boxR=l+boxW)-(boxL=Math.max(boxR-boxW,0)):(boxL=l,boxW=(boxR=Math.min(boxL+boxW,fullWidth))-boxL)),this._box={l:boxL,t:boxT,w:boxW,h:boxH};var needsHorizontalScrollBar=w>boxW,hbarW=ScrollBox.barLength+2*ScrollBox.barPad,hbarH=ScrollBox.barWidth+2*ScrollBox.barPad,hbarL=l,hbarT=t+h;hbarT+hbarH>fullHeight&&(hbarT=fullHeight-hbarH);var hbar=this.container.selectAll("rect.scrollbar-horizontal").data(needsHorizontalScrollBar?[0]:[]);hbar.exit().on(".drag",null).remove(),hbar.enter().append("rect").classed("scrollbar-horizontal",!0).call(_$color_411.fill,ScrollBox.barColor),needsHorizontalScrollBar?(this.hbar=hbar.attr({rx:ScrollBox.barRadius,ry:ScrollBox.barRadius,x:hbarL,y:hbarT,width:hbarW,height:hbarH}),this._hbarXMin=hbarL+hbarW/2,this._hbarTranslateMax=boxW-hbarW):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var needsVerticalScrollBar=h>boxH,vbarW=ScrollBox.barWidth+2*ScrollBox.barPad,vbarH=ScrollBox.barLength+2*ScrollBox.barPad,vbarL=l+w,vbarT=t;vbarL+vbarW>fullWidth&&(vbarL=fullWidth-vbarW);var vbar=this.container.selectAll("rect.scrollbar-vertical").data(needsVerticalScrollBar?[0]:[]);vbar.exit().on(".drag",null).remove(),vbar.enter().append("rect").classed("scrollbar-vertical",!0).call(_$color_411.fill,ScrollBox.barColor),needsVerticalScrollBar?(this.vbar=vbar.attr({rx:ScrollBox.barRadius,ry:ScrollBox.barRadius,x:vbarL,y:vbarT,width:vbarW,height:vbarH}),this._vbarYMin=vbarT+vbarH/2,this._vbarTranslateMax=boxH-vbarH):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var clipId=this.id,clipL=boxL-.5,clipR=needsVerticalScrollBar?boxR+vbarW+.5:boxR+.5,clipT=boxT-.5,clipB=needsHorizontalScrollBar?boxB+hbarH+.5:boxB+.5,clipPath=fullLayout._topdefs.selectAll("#"+clipId).data(needsHorizontalScrollBar||needsVerticalScrollBar?[0]:[]);if(clipPath.exit().remove(),clipPath.enter().append("clipPath").attr("id",clipId).append("rect"),needsHorizontalScrollBar||needsVerticalScrollBar?(this._clipRect=clipPath.select("rect").attr({x:Math.floor(clipL),y:Math.floor(clipT),width:Math.ceil(clipR)-Math.floor(clipL),height:Math.ceil(clipB)-Math.floor(clipT)}),this.container.call(_$drawing_436.setClipUrl,clipId),this.bg.attr({x:l,y:t,width:w,height:h})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(_$drawing_436.setClipUrl,null),delete this._clipRect),needsHorizontalScrollBar||needsVerticalScrollBar){var onBoxDrag=_$d3_127.behavior.drag().on("dragstart",function(){_$d3_127.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(onBoxDrag);var onBarDrag=_$d3_127.behavior.drag().on("dragstart",function(){_$d3_127.event.sourceEvent.preventDefault(),_$d3_127.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));needsHorizontalScrollBar&&this.hbar.on(".drag",null).call(onBarDrag),needsVerticalScrollBar&&this.vbar.on(".drag",null).call(onBarDrag)}this.setTranslate(translateX,translateY)},ScrollBox.prototype.disable=function disable(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(_$drawing_436.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},ScrollBox.prototype._onBoxDrag=function onBarDrag(){var translateX=this.translateX,translateY=this.translateY;this.hbar&&(translateX-=_$d3_127.event.dx),this.vbar&&(translateY-=_$d3_127.event.dy),this.setTranslate(translateX,translateY)},ScrollBox.prototype._onBoxWheel=function onBarWheel(){var translateX=this.translateX,translateY=this.translateY;this.hbar&&(translateX+=_$d3_127.event.deltaY),this.vbar&&(translateY+=_$d3_127.event.deltaY),this.setTranslate(translateX,translateY)},ScrollBox.prototype._onBarDrag=function onBarDrag(){var translateX=this.translateX,translateY=this.translateY;if(this.hbar){var xMin=translateX+this._hbarXMin,xMax=xMin+this._hbarTranslateMax;translateX=(_$lib_539.constrain(_$d3_127.event.x,xMin,xMax)-xMin)/(xMax-xMin)*(this.position.w-this._box.w)}if(this.vbar){var yMin=translateY+this._vbarYMin,yMax=yMin+this._vbarTranslateMax;translateY=(_$lib_539.constrain(_$d3_127.event.y,yMin,yMax)-yMin)/(yMax-yMin)*(this.position.h-this._box.h)}this.setTranslate(translateX,translateY)},ScrollBox.prototype.setTranslate=function setTranslate(translateX,translateY){var translateXMax=this.position.w-this._box.w,translateYMax=this.position.h-this._box.h;if(translateX=_$lib_539.constrain(translateX||0,0,translateXMax),translateY=_$lib_539.constrain(translateY||0,0,translateYMax),this.translateX=translateX,this.translateY=translateY,this.container.call(_$drawing_436.setTranslate,this._box.l-this.position.l-translateX,this._box.t-this.position.t-translateY),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+translateX-.5),y:Math.floor(this.position.t+translateY-.5)}),this.hbar){var xf=translateX/translateXMax;this.hbar.call(_$drawing_436.setTranslate,translateX+xf*this._hbarTranslateMax,translateY)}if(this.vbar){var yf=translateY/translateYMax;this.vbar.call(_$drawing_436.setTranslate,translateX,translateY+yf*this._vbarTranslateMax)}};var __LINE_SPACING_508=_$alignment_511.LINE_SPACING;function __keyFunction_508(menuOpts){return menuOpts._index}function __isActive_508(gButton,menuOpts){return+gButton.attr(_$constants_506.menuIndexAttrName)===menuOpts._index}function __setActive_508(gd,menuOpts,buttonOpts,gHeader,gButton,scrollBox,buttonIndex,isSilentUpdate){menuOpts._input.active=menuOpts.active=buttonIndex,"buttons"===menuOpts.type?drawButtons(gd,gHeader,null,null,menuOpts):"dropdown"===menuOpts.type&&(gButton.attr(_$constants_506.menuIndexAttrName,"-1"),drawHeader(gd,gHeader,gButton,scrollBox,menuOpts),isSilentUpdate||drawButtons(gd,gHeader,gButton,scrollBox,menuOpts))}function drawHeader(gd,gHeader,gButton,scrollBox,menuOpts){var header=gHeader.selectAll("g."+_$constants_506.headerClassName).data([0]),dims=menuOpts._dims;header.enter().append("g").classed(_$constants_506.headerClassName,!0).style("pointer-events","all");var active=menuOpts.active,headerOpts=menuOpts.buttons[active]||_$constants_506.blankHeaderOpts,posOpts={y:menuOpts.pad.t,yPad:0,x:menuOpts.pad.l,xPad:0,index:0},positionOverrides={width:dims.headerWidth,height:dims.headerHeight};header.call(drawItem,menuOpts,headerOpts,gd).call(setItemPosition,menuOpts,posOpts,positionOverrides);var arrow=gHeader.selectAll("text."+_$constants_506.headerArrowClassName).data([0]);arrow.enter().append("text").classed(_$constants_506.headerArrowClassName,!0).classed("user-select-none",!0).attr("text-anchor","end").call(_$drawing_436.font,menuOpts.font).text(_$constants_506.arrowSymbol[menuOpts.direction]),arrow.attr({x:dims.headerWidth-_$constants_506.arrowOffsetX+menuOpts.pad.l,y:dims.headerHeight/2+_$constants_506.textOffsetY+menuOpts.pad.t}),header.on("click",function(){gButton.call(removeAllButtons),gButton.attr(_$constants_506.menuIndexAttrName,__isActive_508(gButton,menuOpts)?-1:String(menuOpts._index)),drawButtons(gd,gHeader,gButton,scrollBox,menuOpts)}),header.on("mouseover",function(){header.call(styleOnMouseOver)}),header.on("mouseout",function(){header.call(styleOnMouseOut,menuOpts)}),_$drawing_436.setTranslate(gHeader,dims.lx,dims.ly)}function drawButtons(gd,gHeader,gButton,scrollBox,menuOpts){gButton||(gButton=gHeader).attr("pointer-events","all");var buttonData=function isFolded(gButton){return-1==+gButton.attr(_$constants_506.menuIndexAttrName)}(gButton)&&"buttons"!==menuOpts.type?[]:menuOpts.buttons,klass="dropdown"===menuOpts.type?_$constants_506.dropdownButtonClassName:_$constants_506.buttonClassName,buttons=gButton.selectAll("g."+klass).data(buttonData),enter=buttons.enter().append("g").classed(klass,!0),exit=buttons.exit();"dropdown"===menuOpts.type?(enter.attr("opacity","0").transition().attr("opacity","1"),exit.transition().attr("opacity","0").remove()):exit.remove();var x0=0,y0=0,dims=menuOpts._dims,isVertical=-1!==["up","down"].indexOf(menuOpts.direction);"dropdown"===menuOpts.type&&(isVertical?y0=dims.headerHeight+_$constants_506.gapButtonHeader:x0=dims.headerWidth+_$constants_506.gapButtonHeader),"dropdown"===menuOpts.type&&"up"===menuOpts.direction&&(y0=-_$constants_506.gapButtonHeader+_$constants_506.gapButton-dims.openHeight),"dropdown"===menuOpts.type&&"left"===menuOpts.direction&&(x0=-_$constants_506.gapButtonHeader+_$constants_506.gapButton-dims.openWidth);var posOpts={x:dims.lx+x0+menuOpts.pad.l,y:dims.ly+y0+menuOpts.pad.t,yPad:_$constants_506.gapButton,xPad:_$constants_506.gapButton,index:0},scrollBoxPosition={l:posOpts.x+menuOpts.borderwidth,t:posOpts.y+menuOpts.borderwidth};buttons.each(function(buttonOpts,buttonIndex){var button=_$d3_127.select(this);button.call(drawItem,menuOpts,buttonOpts,gd).call(setItemPosition,menuOpts,posOpts),button.on("click",function(){_$d3_127.event.defaultPrevented||(__setActive_508(gd,menuOpts,0,gHeader,gButton,scrollBox,buttonIndex),buttonOpts.execute&&_$plots_647.executeAPICommand(gd,buttonOpts.method,buttonOpts.args),gd.emit("plotly_buttonclicked",{menu:menuOpts,button:buttonOpts,active:menuOpts.active}))}),button.on("mouseover",function(){button.call(styleOnMouseOver)}),button.on("mouseout",function(){button.call(styleOnMouseOut,menuOpts),buttons.call(styleButtons,menuOpts)})}),buttons.call(styleButtons,menuOpts),isVertical?(scrollBoxPosition.w=Math.max(dims.openWidth,dims.headerWidth),scrollBoxPosition.h=posOpts.y-scrollBoxPosition.t):(scrollBoxPosition.w=posOpts.x-scrollBoxPosition.l,scrollBoxPosition.h=Math.max(dims.openHeight,dims.headerHeight)),scrollBoxPosition.direction=menuOpts.direction,scrollBox&&(buttons.size()?function drawScrollBox(gd,gHeader,gButton,scrollBox,menuOpts,position){var translateX,translateY,i,direction=menuOpts.direction,isVertical="up"===direction||"down"===direction,dims=menuOpts._dims,active=menuOpts.active;if(isVertical)for(translateY=0,i=0;i<active;i++)translateY+=dims.heights[i]+_$constants_506.gapButton;else for(translateX=0,i=0;i<active;i++)translateX+=dims.widths[i]+_$constants_506.gapButton;scrollBox.enable(position,translateX,translateY),scrollBox.hbar&&scrollBox.hbar.attr("opacity","0").transition().attr("opacity","1");scrollBox.vbar&&scrollBox.vbar.attr("opacity","0").transition().attr("opacity","1")}(0,0,0,scrollBox,menuOpts,scrollBoxPosition):function hideScrollBox(scrollBox){var hasHBar=!!scrollBox.hbar,hasVBar=!!scrollBox.vbar;hasHBar&&scrollBox.hbar.transition().attr("opacity","0").each("end",function(){hasHBar=!1,hasVBar||scrollBox.disable()});hasVBar&&scrollBox.vbar.transition().attr("opacity","0").each("end",function(){hasVBar=!1,hasHBar||scrollBox.disable()})}(scrollBox))}function drawItem(item,menuOpts,itemOpts,gd){item.call(drawItemRect,menuOpts).call(drawItemText,menuOpts,itemOpts,gd)}function drawItemRect(item,menuOpts){var rect=item.selectAll("rect").data([0]);rect.enter().append("rect").classed(_$constants_506.itemRectClassName,!0).attr({rx:_$constants_506.rx,ry:_$constants_506.ry,"shape-rendering":"crispEdges"}),rect.call(_$color_411.stroke,menuOpts.bordercolor).call(_$color_411.fill,menuOpts.bgcolor).style("stroke-width",menuOpts.borderwidth+"px")}function drawItemText(item,menuOpts,itemOpts,gd){var text=item.selectAll("text").data([0]);text.enter().append("text").classed(_$constants_506.itemTextClassName,!0).classed("user-select-none",!0).attr({"text-anchor":"start","data-notex":1}),text.call(_$drawing_436.font,menuOpts.font).text(itemOpts.label).call(_$svg_text_utils_562.convertToTspans,gd)}function styleButtons(buttons,menuOpts){var active=menuOpts.active;buttons.each(function(buttonOpts,i){var button=_$d3_127.select(this);i===active&&menuOpts.showactive&&button.select("rect."+_$constants_506.itemRectClassName).call(_$color_411.fill,_$constants_506.activeColor)})}function styleOnMouseOver(item){item.select("rect."+_$constants_506.itemRectClassName).call(_$color_411.fill,_$constants_506.hoverColor)}function styleOnMouseOut(item,menuOpts){item.select("rect."+_$constants_506.itemRectClassName).call(_$color_411.fill,menuOpts.bgcolor)}function __findDimensions_508(gd,menuOpts){var dims=menuOpts._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},fakeButtons=_$drawing_436.tester.selectAll("g."+_$constants_506.dropdownButtonClassName).data(menuOpts.buttons);fakeButtons.enter().append("g").classed(_$constants_506.dropdownButtonClassName,!0);var isVertical=-1!==["up","down"].indexOf(menuOpts.direction);fakeButtons.each(function(buttonOpts,i){var button=_$d3_127.select(this);button.call(drawItem,menuOpts,buttonOpts,gd);var text=button.select("."+_$constants_506.itemTextClassName),tWidth=text.node()&&_$drawing_436.bBox(text.node()).width,wEff=Math.max(tWidth+_$constants_506.textPadX,_$constants_506.minWidth),tHeight=menuOpts.font.size*__LINE_SPACING_508,tLines=_$svg_text_utils_562.lineCount(text),hEff=Math.max(tHeight*tLines,_$constants_506.minHeight)+_$constants_506.textOffsetY;hEff=Math.ceil(hEff),wEff=Math.ceil(wEff),dims.widths[i]=wEff,dims.heights[i]=hEff,dims.height1=Math.max(dims.height1,hEff),dims.width1=Math.max(dims.width1,wEff),isVertical?(dims.totalWidth=Math.max(dims.totalWidth,wEff),dims.openWidth=dims.totalWidth,dims.totalHeight+=hEff+_$constants_506.gapButton,dims.openHeight+=hEff+_$constants_506.gapButton):(dims.totalWidth+=wEff+_$constants_506.gapButton,dims.openWidth+=wEff+_$constants_506.gapButton,dims.totalHeight=Math.max(dims.totalHeight,hEff),dims.openHeight=dims.totalHeight)}),isVertical?dims.totalHeight-=_$constants_506.gapButton:dims.totalWidth-=_$constants_506.gapButton,dims.headerWidth=dims.width1+_$constants_506.arrowPadX,dims.headerHeight=dims.height1,"dropdown"===menuOpts.type&&(isVertical?(dims.width1+=_$constants_506.arrowPadX,dims.totalHeight=dims.height1):dims.totalWidth=dims.width1,dims.totalWidth+=_$constants_506.arrowPadX),fakeButtons.remove();var paddedWidth=dims.totalWidth+menuOpts.pad.l+menuOpts.pad.r,paddedHeight=dims.totalHeight+menuOpts.pad.t+menuOpts.pad.b,graphSize=gd._fullLayout._size;dims.lx=graphSize.l+graphSize.w*menuOpts.x,dims.ly=graphSize.t+graphSize.h*(1-menuOpts.y);var xanchor="left";_$anchor_utils_463.isRightAnchor(menuOpts)&&(dims.lx-=paddedWidth,xanchor="right"),_$anchor_utils_463.isCenterAnchor(menuOpts)&&(dims.lx-=paddedWidth/2,xanchor="center");var yanchor="top";_$anchor_utils_463.isBottomAnchor(menuOpts)&&(dims.ly-=paddedHeight,yanchor="bottom"),_$anchor_utils_463.isMiddleAnchor(menuOpts)&&(dims.ly-=paddedHeight/2,yanchor="middle"),dims.totalWidth=Math.ceil(dims.totalWidth),dims.totalHeight=Math.ceil(dims.totalHeight),dims.lx=Math.round(dims.lx),dims.ly=Math.round(dims.ly),_$plots_647.autoMargin(gd,_$constants_506.autoMarginIdRoot+menuOpts._index,{x:menuOpts.x,y:menuOpts.y,l:paddedWidth*({right:1,center:.5}[xanchor]||0),r:paddedWidth*({left:1,center:.5}[xanchor]||0),b:paddedHeight*({top:1,middle:.5}[yanchor]||0),t:paddedHeight*({bottom:1,middle:.5}[yanchor]||0)})}function setItemPosition(item,menuOpts,posOpts,overrideOpts){overrideOpts=overrideOpts||{};var rect=item.select("."+_$constants_506.itemRectClassName),text=item.select("."+_$constants_506.itemTextClassName),borderWidth=menuOpts.borderwidth,index=posOpts.index,dims=menuOpts._dims;_$drawing_436.setTranslate(item,borderWidth+posOpts.x,borderWidth+posOpts.y);var isVertical=-1!==["up","down"].indexOf(menuOpts.direction),finalHeight=overrideOpts.height||(isVertical?dims.heights[index]:dims.height1);rect.attr({x:0,y:0,width:overrideOpts.width||(isVertical?dims.width1:dims.widths[index]),height:finalHeight});var tHeight=menuOpts.font.size*__LINE_SPACING_508,spanOffset=(_$svg_text_utils_562.lineCount(text)-1)*tHeight/2;_$svg_text_utils_562.positionText(text,_$constants_506.textOffsetX,finalHeight/2-spanOffset+_$constants_506.textOffsetY),isVertical?posOpts.y+=dims.heights[index]+posOpts.yPad:posOpts.x+=dims.widths[index]+posOpts.xPad,posOpts.index++}function removeAllButtons(gButton){gButton.selectAll("g."+_$constants_506.dropdownButtonClassName).remove()}var _$updatemenus_509={moduleType:"component",name:_$constants_506.name,layoutAttributes:_$attributes_505,supplyLayoutDefaults:function updateMenusDefaults(layoutIn,layoutOut){_$handleArrayContainerDefaults_580(layoutIn,layoutOut,{name:__name_507,handleItemDefaults:menuDefaults})},draw:function draw(gd){var fullLayout=gd._fullLayout,menuData=function makeMenuData(fullLayout){for(var contOpts=fullLayout[_$constants_506.name],menuData=[],i=0;i<contOpts.length;i++){var item=contOpts[i];item.visible&&menuData.push(item)}return menuData}(fullLayout),menus=fullLayout._menulayer.selectAll("g."+_$constants_506.containerClassName).data(menuData.length>0?[0]:[]);if(menus.enter().append("g").classed(_$constants_506.containerClassName,!0).style("cursor","pointer"),menus.exit().remove(),menus.exit().size()&&function __clearPushMargins_508(gd){for(var pushMargins=gd._fullLayout._pushmargin||{},keys=Object.keys(pushMargins),i=0;i<keys.length;i++){var k=keys[i];-1!==k.indexOf(_$constants_506.autoMarginIdRoot)&&_$plots_647.autoMargin(gd,k)}}(gd),0!==menuData.length){var headerGroups=menus.selectAll("g."+_$constants_506.headerGroupClassName).data(menuData,__keyFunction_508);headerGroups.enter().append("g").classed(_$constants_506.headerGroupClassName,!0);var gButton=menus.selectAll("g."+_$constants_506.dropdownButtonGroupClassName).data([0]);gButton.enter().append("g").classed(_$constants_506.dropdownButtonGroupClassName,!0).style("pointer-events","all");for(var i=0;i<menuData.length;i++){var menuOpts=menuData[i];__findDimensions_508(gd,menuOpts)}var scrollBoxId="updatemenus"+fullLayout._uid,scrollBox=new _$ScrollBox_510(gd,gButton,scrollBoxId);headerGroups.enter().size()&&(gButton.node().parentNode.appendChild(gButton.node()),gButton.call(removeAllButtons).attr(_$constants_506.menuIndexAttrName,"-1")),headerGroups.exit().each(function(menuOpts){_$d3_127.select(this).remove(),gButton.call(removeAllButtons).attr(_$constants_506.menuIndexAttrName,"-1"),_$plots_647.autoMargin(gd,_$constants_506.autoMarginIdRoot+menuOpts._index)}),headerGroups.each(function(menuOpts){var gHeader=_$d3_127.select(this),_gButton="dropdown"===menuOpts.type?gButton:null;_$plots_647.manageCommandObserver(gd,menuOpts,menuOpts.buttons,function(data){__setActive_508(gd,menuOpts,menuOpts.buttons[data.index],gHeader,_gButton,scrollBox,data.index,!0)}),"dropdown"===menuOpts.type?(drawHeader(gd,gHeader,gButton,scrollBox,menuOpts),__isActive_508(gButton,menuOpts)&&drawButtons(gd,gHeader,gButton,scrollBox,menuOpts)):drawButtons(gd,gHeader,null,null,menuOpts)})}}},_$mathjax_config_521={};"undefined"!=typeof MathJax?(_$mathjax_config_521.MathJax=!0,MathJax.Hub.Config({messageStyle:"none",skipStartupTypeset:!0,displayAlign:"left",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]}}),MathJax.Hub.Configured()):_$mathjax_config_521.MathJax=!1;var __queue_553={add:function(gd,undoFunc,undoArgs,redoFunc,redoArgs){var queueObj,queueIndex;gd.undoQueue=gd.undoQueue||{index:0,queue:[],sequence:!1},queueIndex=gd.undoQueue.index,gd.autoplay?gd.undoQueue.inSequence||(gd.autoplay=!1):(!gd.undoQueue.sequence||gd.undoQueue.beginSequence?(queueObj={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},gd.undoQueue.queue.splice(queueIndex,gd.undoQueue.queue.length-queueIndex,queueObj),gd.undoQueue.index+=1):queueObj=gd.undoQueue.queue[queueIndex-1],gd.undoQueue.beginSequence=!1,queueObj&&(queueObj.undo.calls.unshift(undoFunc),queueObj.undo.args.unshift(undoArgs),queueObj.redo.calls.push(redoFunc),queueObj.redo.args.push(redoArgs)),gd.undoQueue.queue.length>_$plot_config_574.queueLength&&(gd.undoQueue.queue.shift(),gd.undoQueue.index--))},startSequence:function(gd){gd.undoQueue=gd.undoQueue||{index:0,queue:[],sequence:!1},gd.undoQueue.sequence=!0,gd.undoQueue.beginSequence=!0},stopSequence:function(gd){gd.undoQueue=gd.undoQueue||{index:0,queue:[],sequence:!1},gd.undoQueue.sequence=!1,gd.undoQueue.beginSequence=!1},undo:function undo(gd){var queueObj,i;if(gd.framework&&gd.framework.isPolar)gd.framework.undo();else if(!(void 0===gd.undoQueue||isNaN(gd.undoQueue.index)||gd.undoQueue.index<=0)){for(gd.undoQueue.index--,queueObj=gd.undoQueue.queue[gd.undoQueue.index],gd.undoQueue.inSequence=!0,i=0;i<queueObj.undo.calls.length;i++)__queue_553.plotDo(gd,queueObj.undo.calls[i],queueObj.undo.args[i]);gd.undoQueue.inSequence=!1,gd.autoplay=!1}},redo:function redo(gd){var queueObj,i;if(gd.framework&&gd.framework.isPolar)gd.framework.redo();else if(!(void 0===gd.undoQueue||isNaN(gd.undoQueue.index)||gd.undoQueue.index>=gd.undoQueue.queue.length)){for(queueObj=gd.undoQueue.queue[gd.undoQueue.index],gd.undoQueue.inSequence=!0,i=0;i<queueObj.redo.calls.length;i++)__queue_553.plotDo(gd,queueObj.redo.calls[i],queueObj.redo.args[i]);gd.undoQueue.inSequence=!1,gd.autoplay=!1,gd.undoQueue.index++}}};__queue_553.plotDo=function(gd,func,args){gd.autoplay=!0,args=function copyArgArray(gd,args){for(var arg,copy=[],i=0;i<args.length;i++)arg=args[i],copy[i]=arg===gd?arg:"object"==typeof arg?Array.isArray(arg)?_$lib_539.extendDeep([],arg):_$lib_539.extendDeepAll({},arg):arg;return copy}(gd,args),func.apply(null,args)};var _$queue_553=__queue_553,_$fromQuat_170=function fromQuat(out,q){var x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,yx=y*x2,yy=y*y2,zx=z*x2,zy=z*y2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2;return out[0]=1-yy-zz,out[1]=yx+wz,out[2]=zx-wy,out[3]=0,out[4]=yx-wz,out[5]=1-xx-zz,out[6]=zy+wx,out[7]=0,out[8]=zx+wy,out[9]=zy-wx,out[10]=1-xx-yy,out[11]=0,out[12]=0,out[13]=0,out[14]=0,out[15]=1,out};var _$helpers_570={},cleanId=_$axis_ids_587.cleanId,getFromTrace=_$axis_ids_587.getFromTrace;function cleanAxRef(container,attr){var valIn=container[attr],axLetter=attr.charAt(0);valIn&&"paper"!==valIn&&(container[attr]=cleanId(valIn,axLetter))}function cleanTextPosition(textposition){var posY="middle",posX="center";return-1!==textposition.indexOf("top")?posY="top":-1!==textposition.indexOf("bottom")&&(posY="bottom"),-1!==textposition.indexOf("left")?posX="left":-1!==textposition.indexOf("right")&&(posX="right"),posY+" "+posX}function emptyContainer(outer,innerStr){return innerStr in outer&&"object"==typeof outer[innerStr]&&0===Object.keys(outer[innerStr]).length}_$helpers_570.clearPromiseQueue=function(gd){Array.isArray(gd._promises)&&gd._promises.length>0&&_$lib_539.log("Clearing previous rejected promises from queue."),gd._promises=[]},_$helpers_570.cleanLayout=function(layout){var i,j;layout||(layout={}),layout.xaxis1&&(layout.xaxis||(layout.xaxis=layout.xaxis1),delete layout.xaxis1),layout.yaxis1&&(layout.yaxis||(layout.yaxis=layout.yaxis1),delete layout.yaxis1),layout.scene1&&(layout.scene||(layout.scene=layout.scene1),delete layout.scene1);var axisAttrRegex=(_$plots_647.subplotsRegistry.cartesian||{}).attrRegex,sceneAttrRegex=(_$plots_647.subplotsRegistry.gl3d||{}).attrRegex,keys=Object.keys(layout);for(i=0;i<keys.length;i++){var key=keys[i];if(axisAttrRegex&&axisAttrRegex.test(key)){var ax=layout[key];ax.anchor&&"free"!==ax.anchor&&(ax.anchor=cleanId(ax.anchor)),ax.overlaying&&(ax.overlaying=cleanId(ax.overlaying)),ax.type||(ax.isdate?ax.type="date":ax.islog?ax.type="log":!1===ax.isdate&&!1===ax.islog&&(ax.type="linear")),"withzero"!==ax.autorange&&"tozero"!==ax.autorange||(ax.autorange=!0,ax.rangemode="tozero"),delete ax.islog,delete ax.isdate,delete ax.categories,emptyContainer(ax,"domain")&&delete ax.domain,void 0!==ax.autotick&&(void 0===ax.tickmode&&(ax.tickmode=ax.autotick?"auto":"linear"),delete ax.autotick)}else if(sceneAttrRegex&&sceneAttrRegex.test(key)){var scene=layout[key],cameraposition=scene.cameraposition;if(Array.isArray(cameraposition)&&4===cameraposition[0].length){var rotation=cameraposition[0],center=cameraposition[1],radius=cameraposition[2],mat=_$fromQuat_170([],rotation),eye=[];for(j=0;j<3;++j)eye[j]=center[j]+radius*mat[2+4*j];scene.camera={eye:{x:eye[0],y:eye[1],z:eye[2]},center:{x:center[0],y:center[1],z:center[2]},up:{x:mat[1],y:mat[5],z:mat[9]}},delete scene.cameraposition}}}var annotationsLen=Array.isArray(layout.annotations)?layout.annotations.length:0;for(i=0;i<annotationsLen;i++){var ann=layout.annotations[i];_$lib_539.isPlainObject(ann)&&(ann.ref&&("paper"===ann.ref?(ann.xref="paper",ann.yref="paper"):"data"===ann.ref&&(ann.xref="x",ann.yref="y"),delete ann.ref),cleanAxRef(ann,"xref"),cleanAxRef(ann,"yref"))}var shapesLen=Array.isArray(layout.shapes)?layout.shapes.length:0;for(i=0;i<shapesLen;i++){var shape=layout.shapes[i];_$lib_539.isPlainObject(shape)&&(cleanAxRef(shape,"xref"),cleanAxRef(shape,"yref"))}var legend=layout.legend;return legend&&(legend.x>3?(legend.x=1.02,legend.xanchor="left"):legend.x<-2&&(legend.x=-.02,legend.xanchor="right"),legend.y>3?(legend.y=1.02,legend.yanchor="bottom"):legend.y<-2&&(legend.y=-.02,legend.yanchor="top")),"rotate"===layout.dragmode&&(layout.dragmode="orbit"),_$color_411.clean(layout),layout},_$helpers_570.cleanData=function(data,existingData){for(var suids=[],uids=data.concat(Array.isArray(existingData)?existingData:[]).filter(function(trace){return"uid"in trace}).map(function(trace){return trace.uid}),tracei=0;tracei<data.length;tracei++){var i,trace=data[tracei];if(!("uid"in trace)||-1!==suids.indexOf(trace.uid)){var newUid;for(i=0;i<100&&(newUid=_$lib_539.randstr(uids),-1!==suids.indexOf(newUid));i++);trace.uid=_$lib_539.randstr(uids),uids.push(trace.uid)}if(suids.push(trace.uid),"histogramy"===trace.type&&"xbins"in trace&&!("ybins"in trace)&&(trace.ybins=trace.xbins,delete trace.xbins),trace.error_y&&"opacity"in trace.error_y){var dc=_$color_411.defaults,yeColor=trace.error_y.color||(_$registry_668.traceIs(trace,"bar")?_$color_411.defaultLine:dc[tracei%dc.length]);trace.error_y.color=_$color_411.addOpacity(_$color_411.rgb(yeColor),_$color_411.opacity(yeColor)*trace.error_y.opacity),delete trace.error_y.opacity}if("bardir"in trace&&("h"!==trace.bardir||!_$registry_668.traceIs(trace,"bar")&&"histogram"!==trace.type.substr(0,9)||(trace.orientation="h",_$helpers_570.swapXYData(trace)),delete trace.bardir),"histogramy"===trace.type&&_$helpers_570.swapXYData(trace),"histogramx"!==trace.type&&"histogramy"!==trace.type||(trace.type="histogram"),"scl"in trace&&(trace.colorscale=trace.scl,delete trace.scl),"reversescl"in trace&&(trace.reversescale=trace.reversescl,delete trace.reversescl),trace.xaxis&&(trace.xaxis=cleanId(trace.xaxis,"x")),trace.yaxis&&(trace.yaxis=cleanId(trace.yaxis,"y")),_$registry_668.traceIs(trace,"gl3d")&&trace.scene&&(trace.scene=_$plots_647.subplotsRegistry.gl3d.cleanId(trace.scene)),!_$registry_668.traceIs(trace,"pie")&&!_$registry_668.traceIs(trace,"bar"))if(Array.isArray(trace.textposition))for(i=0;i<trace.textposition.length;i++)trace.textposition[i]=cleanTextPosition(trace.textposition[i]);else trace.textposition&&(trace.textposition=cleanTextPosition(trace.textposition));if(_$registry_668.traceIs(trace,"2dMap")&&("YIGnBu"===trace.colorscale&&(trace.colorscale="YlGnBu"),"YIOrRd"===trace.colorscale&&(trace.colorscale="YlOrRd")),_$registry_668.traceIs(trace,"markerColorscale")&&trace.marker){var cont=trace.marker;"YIGnBu"===cont.colorscale&&(cont.colorscale="YlGnBu"),"YIOrRd"===cont.colorscale&&(cont.colorscale="YlOrRd")}if("surface"===trace.type&&_$lib_539.isPlainObject(trace.contours)){var dims=["x","y","z"];for(i=0;i<dims.length;i++){var opts=trace.contours[dims[i]];_$lib_539.isPlainObject(opts)&&(opts.highlightColor&&(opts.highlightcolor=opts.highlightColor,delete opts.highlightColor),opts.highlightWidth&&(opts.highlightwidth=opts.highlightWidth,delete opts.highlightWidth))}}if(Array.isArray(trace.transforms)){var transforms=trace.transforms;for(i=0;i<transforms.length;i++){var transform=transforms[i];if(_$lib_539.isPlainObject(transform))switch(transform.type){case"filter":transform.filtersrc&&(transform.target=transform.filtersrc,delete transform.filtersrc),transform.calendar&&(transform.valuecalendar||(transform.valuecalendar=transform.calendar),delete transform.calendar);break;case"groupby":if(transform.styles=transform.styles||transform.style,transform.styles&&!Array.isArray(transform.styles)){var prevStyles=transform.styles,styleKeys=Object.keys(prevStyles);transform.styles=[];for(var j=0;j<styleKeys.length;j++)transform.styles.push({target:styleKeys[j],value:prevStyles[styleKeys[j]]})}}}}emptyContainer(trace,"line")&&delete trace.line,"marker"in trace&&(emptyContainer(trace.marker,"line")&&delete trace.marker.line,emptyContainer(trace,"marker")&&delete trace.marker),_$color_411.clean(trace)}},_$helpers_570.swapXYData=function(trace){var i;if(_$lib_539.swapAttrs(trace,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(trace.z)&&Array.isArray(trace.z[0])&&(trace.transpose?delete trace.transpose:trace.transpose=!0),trace.error_x&&trace.error_y){var errorY=trace.error_y,copyYstyle="copy_ystyle"in errorY?errorY.copy_ystyle:!(errorY.color||errorY.thickness||errorY.width);_$lib_539.swapAttrs(trace,["error_?.copy_ystyle"]),copyYstyle&&_$lib_539.swapAttrs(trace,["error_?.color","error_?.thickness","error_?.width"])}if("string"==typeof trace.hoverinfo){var hoverInfoParts=trace.hoverinfo.split("+");for(i=0;i<hoverInfoParts.length;i++)"x"===hoverInfoParts[i]?hoverInfoParts[i]="y":"y"===hoverInfoParts[i]&&(hoverInfoParts[i]="x");trace.hoverinfo=hoverInfoParts.join("+")}},_$helpers_570.coerceTraceIndices=function(gd,traceIndices){return _$fastIsnumeric_139(traceIndices)?[traceIndices]:Array.isArray(traceIndices)&&traceIndices.length?traceIndices:gd.data.map(function(_,i){return i})},_$helpers_570.manageArrayContainers=function(np,newVal,undoit){var obj=np.obj,parts=np.parts,pLength=parts.length,pLast=parts[pLength-1],pLastIsNumber=_$fastIsnumeric_139(pLast);if(pLastIsNumber&&null===newVal){var contPath=parts.slice(0,pLength-1).join(".");_$lib_539.nestedProperty(obj,contPath).get().splice(pLast,1)}else pLastIsNumber&&void 0===np.get()?(void 0===np.get()&&(undoit[np.astr]=null),np.set(newVal)):np.set(newVal)};var ATTR_TAIL_RE=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function getParent(attr){var tail=attr.search(ATTR_TAIL_RE);if(tail>0)return attr.substr(0,tail)}_$helpers_570.hasParent=function(aobj,attr){for(var attrParent=getParent(attr);attrParent;){if(attrParent in aobj)return!0;attrParent=getParent(attrParent)}return!1};var __axLetters_570=["x","y","z"];_$helpers_570.clearAxisTypes=function(gd,traces,layoutUpdate){for(var i=0;i<traces.length;i++)for(var trace=gd._fullData[i],j=0;j<3;j++){var ax=getFromTrace(gd,trace,__axLetters_570[j]);if(ax&&"log"!==ax.type){var axAttr=ax._name,sceneName=ax._id.substr(1);if("scene"===sceneName.substr(0,5)){if(void 0!==layoutUpdate[sceneName])continue;axAttr=sceneName+"."+axAttr}var typeAttr=axAttr+".type";void 0===layoutUpdate[axAttr]&&void 0===layoutUpdate[typeAttr]&&_$lib_539.nestedProperty(gd.layout,typeAttr).set(null)}}},_$helpers_570.clearAxisAutomargins=function(gd){for(var keys=Object.keys(gd._fullLayout._pushmargin),i=0;i<keys.length;i++)-1!==keys[i].indexOf("automargin")&&delete gd._fullLayout._pushmargin[keys[i]]};var _$manage_arrays_572={},sorterAsc=_$search_557.sorterAsc;_$manage_arrays_572.containerArrayMatch=_$containerArrayMatch_568;var isAddVal=_$manage_arrays_572.isAddVal=function isAddVal(val){return"add"===val||_$isPlainObject_541(val)},isRemoveVal=_$manage_arrays_572.isRemoveVal=function isRemoveVal(val){return null===val||"remove"===val};_$manage_arrays_572.applyContainerArrayChanges=function applyContainerArrayChanges(gd,np,edits,flags){var componentType=np.astr,supplyComponentDefaults=_$registry_668.getComponentMethod(componentType,"supplyLayoutDefaults"),draw=_$registry_668.getComponentMethod(componentType,"draw"),drawOne=_$registry_668.getComponentMethod(componentType,"drawOne"),replotLater=flags.replot||flags.recalc||supplyComponentDefaults===_$noop_548||draw===_$noop_548,layout=gd.layout,fullLayout=gd._fullLayout;if(edits[""]){Object.keys(edits).length>1&&_$loggers_544.warn("Full array edits are incompatible with other edits",componentType);var fullVal=edits[""][""];if(isRemoveVal(fullVal))np.set(null);else{if(!Array.isArray(fullVal))return _$loggers_544.warn("Unrecognized full array edit value",componentType,fullVal),!0;np.set(fullVal)}return!replotLater&&(supplyComponentDefaults(layout,fullLayout),draw(gd),!0)}var i,j,componentNum,objEdits,objKeys,objVal,adding,componentNums=Object.keys(edits).map(Number).sort(sorterAsc),componentArrayIn=np.get(),componentArray=componentArrayIn||[],componentArrayFull=_$nestedProperty_547(fullLayout,componentType).get(),deletes=[],firstIndexChange=-1,maxIndex=componentArray.length;for(i=0;i<componentNums.length;i++)if(objEdits=edits[componentNum=componentNums[i]],objKeys=Object.keys(objEdits),objVal=objEdits[""],adding=isAddVal(objVal),componentNum<0||componentNum>componentArray.length-(adding?0:1))_$loggers_544.warn("index out of range",componentType,componentNum);else if(void 0!==objVal)objKeys.length>1&&_$loggers_544.warn("Insertion & removal are incompatible with edits to the same index.",componentType,componentNum),isRemoveVal(objVal)?deletes.push(componentNum):adding?("add"===objVal&&(objVal={}),componentArray.splice(componentNum,0,objVal),componentArrayFull&&componentArrayFull.splice(componentNum,0,{})):_$loggers_544.warn("Unrecognized full object edit value",componentType,componentNum,objVal),-1===firstIndexChange&&(firstIndexChange=componentNum);else for(j=0;j<objKeys.length;j++)_$nestedProperty_547(componentArray[componentNum],objKeys[j]).set(objEdits[objKeys[j]]);for(i=deletes.length-1;i>=0;i--)componentArray.splice(deletes[i],1),componentArrayFull&&componentArrayFull.splice(deletes[i],1);if(componentArray.length?componentArrayIn||np.set(componentArray):np.set(null),replotLater)return!1;if(supplyComponentDefaults(layout,fullLayout),drawOne!==_$noop_548){var indicesToDraw;if(-1===firstIndexChange)indicesToDraw=componentNums;else{for(maxIndex=Math.max(componentArray.length,maxIndex),indicesToDraw=[],i=0;i<componentNums.length&&!((componentNum=componentNums[i])>=firstIndexChange);i++)indicesToDraw.push(componentNum);for(i=firstIndexChange;i<maxIndex;i++)indicesToDraw.push(i)}for(i=0;i<indicesToDraw.length;i++)drawOne(gd,indicesToDraw[i])}else draw(gd);return!0};var _$buttons_473={},____473=_$lib_539._,modeBarButtons=_$buttons_473={};function handleCartesian(gd,ev){var ax,i,button=ev.currentTarget,astr=button.getAttribute("data-attr"),val=button.getAttribute("data-val")||!0,fullLayout=gd._fullLayout,aobj={},axList=_$axis_ids_587.list(gd,null,!0),allSpikesEnabled="on";if("zoom"===astr){var axName,mag="in"===val?.5:2,r0=(1+mag)/2,r1=(1-mag)/2;for(i=0;i<axList.length;i++)if(!(ax=axList[i]).fixedrange)if(axName=ax._name,"auto"===val)aobj[axName+".autorange"]=!0;else if("reset"===val){if(void 0===ax._rangeInitial)aobj[axName+".autorange"]=!0;else{var rangeInitial=ax._rangeInitial.slice();aobj[axName+".range[0]"]=rangeInitial[0],aobj[axName+".range[1]"]=rangeInitial[1]}void 0!==ax._showSpikeInitial&&(aobj[axName+".showspikes"]=ax._showSpikeInitial,"on"!==allSpikesEnabled||ax._showSpikeInitial||(allSpikesEnabled="off"))}else{var rangeNow=[ax.r2l(ax.range[0]),ax.r2l(ax.range[1])],rangeNew=[r0*rangeNow[0]+r1*rangeNow[1],r0*rangeNow[1]+r1*rangeNow[0]];aobj[axName+".range[0]"]=ax.l2r(rangeNew[0]),aobj[axName+".range[1]"]=ax.l2r(rangeNew[1])}fullLayout._cartesianSpikesEnabled=allSpikesEnabled}else{if("hovermode"!==astr||"x"!==val&&"y"!==val){if("hovermode"===astr&&"closest"===val){for(i=0;i<axList.length;i++)ax=axList[i],"on"!==allSpikesEnabled||ax.showspikes||(allSpikesEnabled="off");fullLayout._cartesianSpikesEnabled=allSpikesEnabled}}else val=fullLayout._isHoriz?"y":"x",button.setAttribute("data-val",val);aobj[astr]=val}_$registry_668.call("relayout",gd,aobj)}function handleDrag3d(gd,ev){for(var button=ev.currentTarget,attr=button.getAttribute("data-attr"),val=button.getAttribute("data-val")||!0,sceneIds=gd._fullLayout._subplots.gl3d,layoutUpdate={},parts=attr.split("."),i=0;i<sceneIds.length;i++)layoutUpdate[sceneIds[i]+"."+parts[1]]=val;var val2d="pan"===val?val:"zoom";layoutUpdate.dragmode=val2d,_$registry_668.call("relayout",gd,layoutUpdate)}function handleCamera3d(gd,ev){for(var attr=ev.currentTarget.getAttribute("data-attr"),fullLayout=gd._fullLayout,sceneIds=fullLayout._subplots.gl3d,aobj={},i=0;i<sceneIds.length;i++){var sceneId=sceneIds[i],key=sceneId+".camera",scene=fullLayout[sceneId]._scene;"resetDefault"===attr?aobj[key]=null:"resetLastSave"===attr&&(aobj[key]=_$lib_539.extendDeep({},scene.cameraInitial))}_$registry_668.call("relayout",gd,aobj)}function handleHover3d(gd,ev){var button=ev.currentTarget,val=button._previousVal||!1,layout=gd.layout,fullLayout=gd._fullLayout,sceneIds=fullLayout._subplots.gl3d,axes=["xaxis","yaxis","zaxis"],spikeAttrs=["showspikes","spikesides","spikethickness","spikecolor"],currentSpikes={},axisSpikes={},layoutUpdate={};if(val)layoutUpdate=_$lib_539.extendDeep(layout,val),button._previousVal=null;else{layoutUpdate={"allaxes.showspikes":!1};for(var i=0;i<sceneIds.length;i++){var sceneId=sceneIds[i],sceneLayout=fullLayout[sceneId],sceneSpikes=currentSpikes[sceneId]={};sceneSpikes.hovermode=sceneLayout.hovermode,layoutUpdate[sceneId+".hovermode"]=!1;for(var j=0;j<3;j++){var axis=axes[j];axisSpikes=sceneSpikes[axis]={};for(var k=0;k<spikeAttrs.length;k++){var spikeAttr=spikeAttrs[k];axisSpikes[spikeAttr]=sceneLayout[axis][spikeAttr]}}}button._previousVal=_$lib_539.extendDeep({},currentSpikes)}_$registry_668.call("relayout",gd,layoutUpdate)}function handleGeo(gd,ev){for(var button=ev.currentTarget,attr=button.getAttribute("data-attr"),val=button.getAttribute("data-val")||!0,fullLayout=gd._fullLayout,geoIds=fullLayout._subplots.geo,i=0;i<geoIds.length;i++){var id=geoIds[i],geoLayout=fullLayout[id];if("zoom"===attr){var scale=geoLayout.projection.scale,newScale="in"===val?2*scale:.5*scale;_$registry_668.call("relayout",gd,id+".projection.scale",newScale)}else"reset"===attr&&resetView(gd,"geo")}}function toggleHover(gd){var onHoverVal,fullLayout=gd._fullLayout;onHoverVal=fullLayout._has("cartesian")?fullLayout._isHoriz?"y":"x":"closest";var newHover=!gd._fullLayout.hovermode&&onHoverVal;_$registry_668.call("relayout",gd,"hovermode",newHover)}function resetView(gd,subplotType){for(var fullLayout=gd._fullLayout,subplotIds=fullLayout._subplots[subplotType],aObj={},i=0;i<subplotIds.length;i++)for(var id=subplotIds[i],viewInitial=fullLayout[id]._subplot.viewInitial,viewKeys=Object.keys(viewInitial),j=0;j<viewKeys.length;j++){var key=viewKeys[j];aObj[id+"."+key]=viewInitial[key]}_$registry_668.call("relayout",gd,aObj)}function ModeBar(opts){this.container=opts.container,this.element=document.createElement("div"),this.update(opts.graphInfo,opts.buttons),this.container.appendChild(this.element)}modeBarButtons.toImage={name:"toImage",title:function(gd){return ____473(gd,"Download plot as a png")},icon:_$ploticon_2.camera,click:function(gd){var format="png";_$lib_539.notifier(____473(gd,"Taking snapshot - this may take a few seconds"),"long"),_$lib_539.isIE()&&(_$lib_539.notifier(____473(gd,"IE only supports svg.  Changing format to svg."),"long"),format="svg"),_$registry_668.call("downloadImage",gd,{format:format}).then(function(filename){_$lib_539.notifier(____473(gd,"Snapshot succeeded")+" - "+filename,"long")}).catch(function(){_$lib_539.notifier(____473(gd,"Sorry, there was a problem downloading your snapshot!"),"long")})}},modeBarButtons.sendDataToCloud={name:"sendDataToCloud",title:function(gd){return ____473(gd,"Edit in Chart Studio")},icon:_$ploticon_2.disk,click:function(gd){_$plots_647.sendDataToCloud(gd)}},modeBarButtons.zoom2d={name:"zoom2d",title:function(gd){return ____473(gd,"Zoom")},attr:"dragmode",val:"zoom",icon:_$ploticon_2.zoombox,click:handleCartesian},modeBarButtons.pan2d={name:"pan2d",title:function(gd){return ____473(gd,"Pan")},attr:"dragmode",val:"pan",icon:_$ploticon_2.pan,click:handleCartesian},modeBarButtons.select2d={name:"select2d",title:function(gd){return ____473(gd,"Box Select")},attr:"dragmode",val:"select",icon:_$ploticon_2.selectbox,click:handleCartesian},modeBarButtons.lasso2d={name:"lasso2d",title:function(gd){return ____473(gd,"Lasso Select")},attr:"dragmode",val:"lasso",icon:_$ploticon_2.lasso,click:handleCartesian},modeBarButtons.zoomIn2d={name:"zoomIn2d",title:function(gd){return ____473(gd,"Zoom in")},attr:"zoom",val:"in",icon:_$ploticon_2.zoom_plus,click:handleCartesian},modeBarButtons.zoomOut2d={name:"zoomOut2d",title:function(gd){return ____473(gd,"Zoom out")},attr:"zoom",val:"out",icon:_$ploticon_2.zoom_minus,click:handleCartesian},modeBarButtons.autoScale2d={name:"autoScale2d",title:function(gd){return ____473(gd,"Autoscale")},attr:"zoom",val:"auto",icon:_$ploticon_2.autoscale,click:handleCartesian},modeBarButtons.resetScale2d={name:"resetScale2d",title:function(gd){return ____473(gd,"Reset axes")},attr:"zoom",val:"reset",icon:_$ploticon_2.home,click:handleCartesian},modeBarButtons.hoverClosestCartesian={name:"hoverClosestCartesian",title:function(gd){return ____473(gd,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:_$ploticon_2.tooltip_basic,gravity:"ne",click:handleCartesian},modeBarButtons.hoverCompareCartesian={name:"hoverCompareCartesian",title:function(gd){return ____473(gd,"Compare data on hover")},attr:"hovermode",val:function(gd){return gd._fullLayout._isHoriz?"y":"x"},icon:_$ploticon_2.tooltip_compare,gravity:"ne",click:handleCartesian},modeBarButtons.zoom3d={name:"zoom3d",title:function(gd){return ____473(gd,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:_$ploticon_2.zoombox,click:handleDrag3d},modeBarButtons.pan3d={name:"pan3d",title:function(gd){return ____473(gd,"Pan")},attr:"scene.dragmode",val:"pan",icon:_$ploticon_2.pan,click:handleDrag3d},modeBarButtons.orbitRotation={name:"orbitRotation",title:function(gd){return ____473(gd,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:_$ploticon_2["3d_rotate"],click:handleDrag3d},modeBarButtons.tableRotation={name:"tableRotation",title:function(gd){return ____473(gd,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:_$ploticon_2["z-axis"],click:handleDrag3d},modeBarButtons.resetCameraDefault3d={name:"resetCameraDefault3d",title:function(gd){return ____473(gd,"Reset camera to default")},attr:"resetDefault",icon:_$ploticon_2.home,click:handleCamera3d},modeBarButtons.resetCameraLastSave3d={name:"resetCameraLastSave3d",title:function(gd){return ____473(gd,"Reset camera to last save")},attr:"resetLastSave",icon:_$ploticon_2.movie,click:handleCamera3d},modeBarButtons.hoverClosest3d={name:"hoverClosest3d",title:function(gd){return ____473(gd,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:_$ploticon_2.tooltip_basic,gravity:"ne",click:handleHover3d},modeBarButtons.zoomInGeo={name:"zoomInGeo",title:function(gd){return ____473(gd,"Zoom in")},attr:"zoom",val:"in",icon:_$ploticon_2.zoom_plus,click:handleGeo},modeBarButtons.zoomOutGeo={name:"zoomOutGeo",title:function(gd){return ____473(gd,"Zoom out")},attr:"zoom",val:"out",icon:_$ploticon_2.zoom_minus,click:handleGeo},modeBarButtons.resetGeo={name:"resetGeo",title:function(gd){return ____473(gd,"Reset")},attr:"reset",val:null,icon:_$ploticon_2.autoscale,click:handleGeo},modeBarButtons.hoverClosestGeo={name:"hoverClosestGeo",title:function(gd){return ____473(gd,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:_$ploticon_2.tooltip_basic,gravity:"ne",click:toggleHover},modeBarButtons.hoverClosestGl2d={name:"hoverClosestGl2d",title:function(gd){return ____473(gd,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:_$ploticon_2.tooltip_basic,gravity:"ne",click:toggleHover},modeBarButtons.hoverClosestPie={name:"hoverClosestPie",title:function(gd){return ____473(gd,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:_$ploticon_2.tooltip_basic,gravity:"ne",click:toggleHover},modeBarButtons.toggleHover={name:"toggleHover",title:function(gd){return ____473(gd,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:_$ploticon_2.tooltip_basic,gravity:"ne",click:function(gd,ev){toggleHover(gd),handleHover3d(gd,ev)}},modeBarButtons.resetViews={name:"resetViews",title:function(gd){return ____473(gd,"Reset views")},icon:_$ploticon_2.home,click:function(gd,ev){var button=ev.currentTarget;button.setAttribute("data-attr","zoom"),button.setAttribute("data-val","reset"),handleCartesian(gd,ev),button.setAttribute("data-attr","resetLastSave"),handleCamera3d(gd,ev),resetView(gd,"geo"),resetView(gd,"mapbox")}},modeBarButtons.toggleSpikelines={name:"toggleSpikelines",title:function(gd){return ____473(gd,"Toggle Spike Lines")},icon:_$ploticon_2.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(gd){var fullLayout=gd._fullLayout;fullLayout._cartesianSpikesEnabled="on"===fullLayout._cartesianSpikesEnabled?"off":"on";var aobj=function setSpikelineVisibility(gd){for(var ax,axName,fullLayout=gd._fullLayout,axList=_$axis_ids_587.list(gd,null,!0),aobj={},i=0;i<axList.length;i++)ax=axList[i],axName=ax._name,aobj[axName+".showspikes"]="on"===fullLayout._cartesianSpikesEnabled||ax._showSpikeInitial;return aobj}(gd);_$registry_668.call("relayout",gd,aobj)}},modeBarButtons.resetViewMapbox={name:"resetViewMapbox",title:function(gd){return ____473(gd,"Reset view")},attr:"reset",icon:_$ploticon_2.home,click:function(gd){resetView(gd,"mapbox")}};var __proto_476=ModeBar.prototype;__proto_476.update=function(graphInfo,buttons){this.graphInfo=graphInfo;var context=this.graphInfo._context;"hover"===context.displayModeBar?this.element.className="modebar modebar--hover":this.element.className="modebar";var needsNewButtons=!this.hasButtons(buttons),needsNewLogo=this.hasLogo!==context.displaylogo;(needsNewButtons||needsNewLogo)&&(this.removeAllButtons(),this.updateButtons(buttons),context.displaylogo&&(this.element.appendChild(this.getLogo()),this.hasLogo=!0)),this.updateActiveButton()},__proto_476.updateButtons=function(buttons){var _this=this;this.buttons=buttons,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(buttonGroup){var group=_this.createGroup();buttonGroup.forEach(function(buttonConfig){var buttonName=buttonConfig.name;if(!buttonName)throw new Error("must provide button 'name' in button config");if(-1!==_this.buttonsNames.indexOf(buttonName))throw new Error("button name '"+buttonName+"' is taken");_this.buttonsNames.push(buttonName);var button=_this.createButton(buttonConfig);_this.buttonElements.push(button),group.appendChild(button)}),_this.element.appendChild(group)})},__proto_476.createGroup=function(){var group=document.createElement("div");return group.className="modebar-group",group},__proto_476.createButton=function(config){var _this=this,button=document.createElement("a");button.setAttribute("rel","tooltip"),button.className="modebar-btn";var title=config.title;void 0===title?title=config.name:"function"==typeof title&&(title=title(this.graphInfo)),(title||0===title)&&button.setAttribute("data-title",title),void 0!==config.attr&&button.setAttribute("data-attr",config.attr);var val=config.val;if(void 0!==val&&("function"==typeof val&&(val=val(this.graphInfo)),button.setAttribute("data-val",val)),"function"!=typeof config.click)throw new Error("must provide button 'click' function in button config");return button.addEventListener("click",function(ev){config.click(_this.graphInfo,ev),_this.updateActiveButton(ev.currentTarget)}),button.setAttribute("data-toggle",config.toggle||!1),config.toggle&&_$d3_127.select(button).classed("active",!0),button.appendChild(this.createIcon(config.icon||_$ploticon_2.question,config.name)),button.setAttribute("data-gravity",config.gravity||"n"),button},__proto_476.createIcon=function(thisIcon,name){var iconHeight=thisIcon.ascent-thisIcon.descent,svgNS="http://www.w3.org/2000/svg",icon=document.createElementNS(svgNS,"svg"),path=document.createElementNS(svgNS,"path");icon.setAttribute("height","1em"),icon.setAttribute("width",thisIcon.width/iconHeight+"em"),icon.setAttribute("viewBox",[0,0,thisIcon.width,iconHeight].join(" "));var transform="toggleSpikelines"===name?"matrix(1.5 0 0 -1.5 0 "+thisIcon.ascent+")":"matrix(1 0 0 -1 0 "+thisIcon.ascent+")";return path.setAttribute("d",thisIcon.path),path.setAttribute("transform",transform),icon.appendChild(path),icon},__proto_476.updateActiveButton=function(buttonClicked){var fullLayout=this.graphInfo._fullLayout,dataAttrClicked=void 0!==buttonClicked?buttonClicked.getAttribute("data-attr"):null;this.buttonElements.forEach(function(button){var thisval=button.getAttribute("data-val")||!0,dataAttr=button.getAttribute("data-attr"),isToggleButton="true"===button.getAttribute("data-toggle"),button3=_$d3_127.select(button);if(isToggleButton)dataAttr===dataAttrClicked&&button3.classed("active",!button3.classed("active"));else{var val=null===dataAttr?dataAttr:_$lib_539.nestedProperty(fullLayout,dataAttr).get();button3.classed("active",val===thisval)}})},__proto_476.hasButtons=function(buttons){var currentButtons=this.buttons;if(!currentButtons)return!1;if(buttons.length!==currentButtons.length)return!1;for(var i=0;i<buttons.length;++i){if(buttons[i].length!==currentButtons[i].length)return!1;for(var j=0;j<buttons[i].length;j++)if(buttons[i][j].name!==currentButtons[i][j].name)return!1}return!0},__proto_476.getLogo=function(){var group=this.createGroup(),a=document.createElement("a");return a.href="https://plot.ly/",a.target="_blank",a.setAttribute("data-title",_$lib_539._(this.graphInfo,"Produced with Plotly")),a.className="modebar-btn plotlyjsicon modebar-btn--logo",a.appendChild(this.createIcon(_$ploticon_2.plotlylogo)),group.appendChild(a),group},__proto_476.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},__proto_476.destroy=function(){_$lib_539.removeElement(this.container.querySelector(".modebar"))};var _$createModeBar_476=function createModeBar(gd,buttons){var fullLayout=gd._fullLayout,modeBar=new ModeBar({graphInfo:gd,container:fullLayout._paperdiv.node(),buttons:buttons});return fullLayout._privateplot&&_$d3_127.select(modeBar.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),modeBar};var _$modebar_474={};_$modebar_474.manage=function manageModeBar(gd){var fullLayout=gd._fullLayout,context=gd._context,modeBar=fullLayout._modeBar;if(context.displayModeBar){if(!Array.isArray(context.modeBarButtonsToRemove))throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "));if(!Array.isArray(context.modeBarButtonsToAdd))throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "));var buttonGroups,customButtons=context.modeBarButtons;buttonGroups=Array.isArray(customButtons)&&customButtons.length?function fillCustomButton(customButtons){for(var i=0;i<customButtons.length;i++)for(var buttonGroup=customButtons[i],j=0;j<buttonGroup.length;j++){var button=buttonGroup[j];if("string"==typeof button){if(void 0===_$buttons_473[button])throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "));customButtons[i][j]=_$buttons_473[button]}}return customButtons}(customButtons):function getButtonGroups(gd,buttonsToRemove,buttonsToAdd){var fullLayout=gd._fullLayout,fullData=gd._fullData,hasCartesian=fullLayout._has("cartesian"),hasGL3D=fullLayout._has("gl3d"),hasGeo=fullLayout._has("geo"),hasPie=fullLayout._has("pie"),hasGL2D=fullLayout._has("gl2d"),hasTernary=fullLayout._has("ternary"),hasMapbox=fullLayout._has("mapbox"),hasPolar=fullLayout._has("polar"),allAxesFixed=function areAllAxesFixed(fullLayout){for(var axList=_$axis_ids_587.list({_fullLayout:fullLayout},null,!0),i=0;i<axList.length;i++)if(!axList[i].fixedrange)return!1;return!0}(fullLayout),groups=[];function addGroup(newGroup){if(newGroup.length){for(var out=[],i=0;i<newGroup.length;i++){var button=newGroup[i];-1===buttonsToRemove.indexOf(button)&&out.push(_$buttons_473[button])}groups.push(out)}}addGroup(["toImage","sendDataToCloud"]);var zoomGroup=[],hoverGroup=[],resetGroup=[],dragModeGroup=[];return(hasCartesian||hasGL2D||hasPie||hasTernary)+hasGeo+hasGL3D+hasMapbox+hasPolar>1?(hoverGroup=["toggleHover"],resetGroup=["resetViews"]):hasGeo?(zoomGroup=["zoomInGeo","zoomOutGeo"],hoverGroup=["hoverClosestGeo"],resetGroup=["resetGeo"]):hasGL3D?(hoverGroup=["hoverClosest3d"],resetGroup=["resetCameraDefault3d","resetCameraLastSave3d"]):hasMapbox?(hoverGroup=["toggleHover"],resetGroup=["resetViewMapbox"]):hoverGroup=hasGL2D?["hoverClosestGl2d"]:hasPie?["hoverClosestPie"]:["toggleHover"],hasCartesian&&(hoverGroup=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),!hasCartesian&&!hasGL2D||allAxesFixed||(zoomGroup=["zoomIn2d","zoomOut2d","autoScale2d"],"resetViews"!==resetGroup[0]&&(resetGroup=["resetScale2d"])),hasGL3D?dragModeGroup=["zoom3d","pan3d","orbitRotation","tableRotation"]:(hasCartesian||hasGL2D)&&!allAxesFixed||hasTernary?dragModeGroup=["zoom2d","pan2d"]:hasMapbox||hasGeo?dragModeGroup=["pan2d"]:hasPolar&&(dragModeGroup=["zoom2d"]),function isSelectable(fullData){for(var selectable=!1,i=0;i<fullData.length&&!selectable;i++){var trace=fullData[i];trace._module&&trace._module.selectPoints&&(_$registry_668.traceIs(trace,"scatter-like")?(_$subtypes_884.hasMarkers(trace)||_$subtypes_884.hasText(trace))&&(selectable=!0):_$registry_668.traceIs(trace,"box-violin")&&"all"!==trace.boxpoints&&"all"!==trace.points||(selectable=!0))}return selectable}(fullData)&&dragModeGroup.push("select2d","lasso2d"),addGroup(dragModeGroup),addGroup(zoomGroup.concat(resetGroup)),addGroup(hoverGroup),function appendButtonsToGroups(groups,buttons){if(buttons.length)if(Array.isArray(buttons[0]))for(var i=0;i<buttons.length;i++)groups.push(buttons[i]);else groups.push(buttons);return groups}(groups,buttonsToAdd)}(gd,context.modeBarButtonsToRemove,context.modeBarButtonsToAdd),modeBar?modeBar.update(gd,buttonGroups):fullLayout._modeBar=_$createModeBar_476(gd,buttonGroups)}else modeBar&&(modeBar.destroy(),delete fullLayout._modeBar)};var FROM_BL=_$alignment_511.FROM_BL,_$scaleZoom_601=function scaleZoom(ax,factor,centerFraction){void 0===centerFraction&&(centerFraction=FROM_BL[ax.constraintoward||"center"]);var rangeLinear=[ax.r2l(ax.range[0]),ax.r2l(ax.range[1])],center=rangeLinear[0]+(rangeLinear[1]-rangeLinear[0])*centerFraction;ax.range=ax._input.range=[ax.l2r(center+(rangeLinear[0]-center)*factor),ax.l2r(center+(rangeLinear[1]-center)*factor)]},__FROM_TL_592=_$alignment_511.FROM_TL,doTicks=_$axes_584.doTicks,getFromId=_$axis_ids_587.getFromId,MINDRAG=_$constants_589.MINDRAG,MINZOOM=_$constants_589.MINZOOM,SHOWZOOMOUTTIP=!0;function makeDragger(plotinfo,nodeName,dragClass,cursor){var dragger3=plotinfo.draglayer.selectAll("."+dragClass).data([0]);return dragger3.enter().append(nodeName).classed("drag",!0).classed(dragClass,!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",plotinfo.id),dragger3.call(_$setCursor_558,cursor),dragger3.node()}function makeRectDragger(plotinfo,dragClass,cursor,x,y,w,h){var dragger=makeDragger(plotinfo,"rect",dragClass,cursor);return _$d3_127.select(dragger).call(_$drawing_436.setRect,x,y,w,h),dragger}function isDirectionActive(axList,activeVal){for(var i=0;i<axList.length;i++)if(!axList[i].fixedrange)return activeVal;return""}function zoomAxRanges(axList,r0Fraction,r1Fraction,updates,linkedAxes){var i,axi,axRangeLinear0,axRangeLinearSpan;for(i=0;i<axList.length;i++)(axi=axList[i]).fixedrange||(axRangeLinear0=axi._rl[0],axRangeLinearSpan=axi._rl[1]-axRangeLinear0,axi.range=[axi.l2r(axRangeLinear0+axRangeLinearSpan*r0Fraction),axi.l2r(axRangeLinear0+axRangeLinearSpan*r1Fraction)],updates[axi._name+".range[0]"]=axi.range[0],updates[axi._name+".range[1]"]=axi.range[1]);if(linkedAxes&&linkedAxes.length){var linkedR0Fraction=(r0Fraction+(1-r1Fraction))/2;zoomAxRanges(linkedAxes,linkedR0Fraction,1-linkedR0Fraction,updates)}}function dragAxList(axList,pix){for(var i=0;i<axList.length;i++){var axi=axList[i];axi.fixedrange||(axi.range=[axi.l2r(axi._rl[0]-pix/axi._m),axi.l2r(axi._rl[1]-pix/axi._m)])}}function dZoom(d){return 1-(d>=0?Math.min(d,.9):1/(1/Math.max(d,-.3)+3.222))}function makeZoombox(zoomlayer,lum,xs,ys,path0){return zoomlayer.append("path").attr("class","zoombox").style({fill:lum>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform","translate("+xs+", "+ys+")").attr("d",path0+"Z")}function makeCorners(zoomlayer,xs,ys){return zoomlayer.append("path").attr("class","zoombox-corners").style({fill:_$color_411.background,stroke:_$color_411.defaultLine,"stroke-width":1,opacity:0}).attr("transform","translate("+xs+", "+ys+")").attr("d","M0,0Z")}function clearSelect(zoomlayer){zoomlayer.selectAll(".select-outline").remove()}function updateZoombox(zb,corners,box,path0,dimmed,lum){zb.attr("d",path0+"M"+box.l+","+box.t+"v"+box.h+"h"+box.w+"v-"+box.h+"h-"+box.w+"Z"),transitionZoombox(zb,corners,dimmed,lum)}function transitionZoombox(zb,corners,dimmed,lum){dimmed||(zb.transition().style("fill",lum>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),corners.transition().style("opacity",1).duration(200))}function removeZoombox(gd){_$d3_127.select(gd).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function showDoubleClickNotifier(gd){SHOWZOOMOUTTIP&&gd.data&&gd._context.showTips&&(_$lib_539.notifier(_$lib_539._(gd,"Double-click to zoom back out"),"long"),SHOWZOOMOUTTIP=!1)}function isSelectOrLasso(dragmode){return"lasso"===dragmode||"select"===dragmode}function xyCorners(box){var clen=Math.floor(Math.min(box.b-box.t,box.r-box.l,MINZOOM)/2);return"M"+(box.l-3.5)+","+(box.t-.5+clen)+"h3v"+-clen+"h"+clen+"v-3h-"+(clen+3)+"ZM"+(box.r+3.5)+","+(box.t-.5+clen)+"h-3v"+-clen+"h"+-clen+"v-3h"+(clen+3)+"ZM"+(box.r+3.5)+","+(box.b+.5-clen)+"h-3v"+clen+"h"+-clen+"v3h"+(clen+3)+"ZM"+(box.l-3.5)+","+(box.b+.5-clen)+"h3v"+clen+"h"+clen+"v3h-"+(clen+3)+"Z"}function attachWheelEventHandler(element,handler){if(_$hasPassiveEvents_240){var wheelEventName=void 0!==element.onwheel?"wheel":"mousewheel";element._onwheel&&element.removeEventListener(wheelEventName,element._onwheel),element._onwheel=handler,element.addEventListener(wheelEventName,handler,{passive:!1})}else void 0!==element.onwheel?element.onwheel=handler:void 0!==element.onmousewheel&&(element.onmousewheel=handler)}var _$dragbox_592={makeDragBox:function makeDragBox(gd,plotinfo,x,y,w,h,ns,ew){var subplots,xa,ya,xs,ys,pw,ph,xActive,yActive,cursor,isSubplotConstrained,xaLinked,yaLinked,fullLayout=gd._fullLayout,zoomlayer=gd._fullLayout._zoomlayer,isMainDrag=ns+ew==="nsew",singleEnd=1===(ns+ew).length;function recomputeAxisLists(){xa=[plotinfo.xaxis],ya=[plotinfo.yaxis];var xa0=xa[0],ya0=ya[0];pw=xa0._length,ph=ya0._length;var constraintGroups=fullLayout._axisConstraintGroups,xIDs=[xa0._id],yIDs=[ya0._id];subplots=[plotinfo].concat(ns&&ew?plotinfo.overlays:[]);for(var i=1;i<subplots.length;i++){var subplotXa=subplots[i].xaxis,subplotYa=subplots[i].yaxis;-1===xa.indexOf(subplotXa)&&(xa.push(subplotXa),xIDs.push(subplotXa._id)),-1===ya.indexOf(subplotYa)&&(ya.push(subplotYa),yIDs.push(subplotYa._id))}xActive=isDirectionActive(xa,ew),yActive=isDirectionActive(ya,ns),cursor=function getDragCursor(nsew,dragmode){return nsew?"nsew"===nsew?"pan"===dragmode?"move":"crosshair":nsew.toLowerCase()+"-resize":"pointer"}(yActive+xActive,fullLayout.dragmode),xs=xa0._offset,ys=ya0._offset;var links=function calcLinks(constraintGroups,xIDs,yIDs){var i,j,k,group,xLinkID,yLinkID,isSubplotConstrained=!1,xLinks={},yLinks={};for(i=0;i<constraintGroups.length;i++){for(group=constraintGroups[i],j=0;j<xIDs.length;j++)if(group[xIDs[j]]){for(xLinkID in group)-1===("x"===xLinkID.charAt(0)?xIDs:yIDs).indexOf(xLinkID)&&(xLinks[xLinkID]=1);for(k=0;k<yIDs.length;k++)group[yIDs[k]]&&(isSubplotConstrained=!0)}for(j=0;j<yIDs.length;j++)if(group[yIDs[j]])for(yLinkID in group)-1===("x"===yLinkID.charAt(0)?xIDs:yIDs).indexOf(yLinkID)&&(yLinks[yLinkID]=1)}return isSubplotConstrained&&(_$lib_539.extendFlat(xLinks,yLinks),yLinks={}),{x:xLinks,y:yLinks,xy:isSubplotConstrained}}(constraintGroups,xIDs,yIDs);for(var xLinkID in isSubplotConstrained=links.xy,xaLinked=[],links.x)xaLinked.push(getFromId(gd,xLinkID));for(var yLinkID in yaLinked=[],links.y)yaLinked.push(getFromId(gd,yLinkID))}recomputeAxisLists();var dragger=makeRectDragger(plotinfo,ns+ew+"drag",cursor,x,y,w,h),allFixedRanges=!yActive&&!xActive;if(allFixedRanges&&!isMainDrag)return dragger.onmousedown=null,dragger.style.pointerEvents="none",dragger;var x0,y0,box,lum,path0,dimmed,zoomMode,zb,corners,dragOptions={element:dragger,gd:gd,plotinfo:plotinfo,prepFn:function(e,startX,startY){var dragModeNow=gd._fullLayout.dragmode;allFixedRanges||(isMainDrag?e.shiftKey?"pan"===dragModeNow?dragModeNow="zoom":isSelectOrLasso(dragModeNow)||(dragModeNow="pan"):e.ctrlKey&&(dragModeNow="pan"):dragModeNow="pan"),dragOptions.minDrag="lasso"===dragModeNow?1:void 0,isSelectOrLasso(dragModeNow)?(dragOptions.xaxes=xa,dragOptions.yaxes=ya,_$prepSelect_602(e,startX,startY,dragOptions,dragModeNow)):allFixedRanges?clearSelect(zoomlayer):"zoom"===dragModeNow?(dragOptions.moveFn=zoomMove,dragOptions.doneFn=zoomDone,dragOptions.minDrag=1,function zoomPrep(e,startX,startY){var dragBBox=dragger.getBoundingClientRect();x0=startX-dragBBox.left,y0=startY-dragBBox.top,box={l:x0,r:x0,w:0,t:y0,b:y0,h:0},lum=gd._hmpixcount?gd._hmlumcount/gd._hmpixcount:_$tinycolor_352(gd._fullLayout.plot_bgcolor).getLuminance(),dimmed=!1,zoomMode="xy",zb=makeZoombox(zoomlayer,lum,xs,ys,path0="M0,0H"+pw+"V"+ph+"H0V0"),corners=makeCorners(zoomlayer,xs,ys),clearSelect(zoomlayer)}(0,startX,startY)):"pan"===dragModeNow&&(dragOptions.moveFn=plotDrag,dragOptions.doneFn=dragTail,clearSelect(zoomlayer))},clickFn:function(numClicks,evt){if(removeZoombox(gd),2!==numClicks||singleEnd||function doubleClick(){if(!gd._transitioningWithDuration){var ax,i,rangeInitial,doubleClickConfig=gd._context.doubleClick,axList=(xActive?xa:[]).concat(yActive?ya:[]),attrs={};if("reset+autosize"===doubleClickConfig)for(doubleClickConfig="autosize",i=0;i<axList.length;i++)if((ax=axList[i])._rangeInitial&&(ax.range[0]!==ax._rangeInitial[0]||ax.range[1]!==ax._rangeInitial[1])||!ax._rangeInitial&&!ax.autorange){doubleClickConfig="reset";break}if("autosize"===doubleClickConfig)for(i=0;i<axList.length;i++)(ax=axList[i]).fixedrange||(attrs[ax._name+".autorange"]=!0);else if("reset"===doubleClickConfig)for((xActive||isSubplotConstrained)&&(axList=axList.concat(xaLinked)),yActive&&!isSubplotConstrained&&(axList=axList.concat(yaLinked)),isSubplotConstrained&&(xActive?yActive||(axList=axList.concat(ya)):axList=axList.concat(xa)),i=0;i<axList.length;i++)(ax=axList[i])._rangeInitial?(rangeInitial=ax._rangeInitial,attrs[ax._name+".range[0]"]=rangeInitial[0],attrs[ax._name+".range[1]"]=rangeInitial[1]):attrs[ax._name+".autorange"]=!0;gd.emit("plotly_doubleclick",null),_$registry_668.call("relayout",gd,attrs)}}(),isMainDrag)_$fx_453.click(gd,evt,plotinfo.id);else if(1===numClicks&&singleEnd){var ax=ns?ya[0]:xa[0],end="s"===ns||"w"===ew?0:1,attrStr=ax._name+".range["+end+"]",initialText=function getEndText(ax,end){var dig,initialVal=ax.range[end],diff=Math.abs(initialVal-ax.range[1-end]);return"date"===ax.type?initialVal:"log"===ax.type?(dig=Math.ceil(Math.max(0,-Math.log(diff)/Math.LN10))+3,_$d3_127.format("."+dig+"g")(Math.pow(10,initialVal))):(dig=Math.floor(Math.log(Math.abs(initialVal))/Math.LN10)-Math.floor(Math.log(diff)/Math.LN10)+4,_$d3_127.format("."+String(dig)+"g")(initialVal))}(ax,end),hAlign="left",vAlign="middle";if(ax.fixedrange)return;ns?(vAlign="n"===ns?"top":"bottom","right"===ax.side&&(hAlign="right")):"e"===ew&&(hAlign="right"),gd._context.showAxisRangeEntryBoxes&&_$d3_127.select(dragger).call(_$svg_text_utils_562.makeEditable,{gd:gd,immediate:!0,background:fullLayout.paper_bgcolor,text:String(initialText),fill:ax.tickfont?ax.tickfont.color:"#444",horizontalAlign:hAlign,verticalAlign:vAlign}).on("edit",function(text){var v=ax.d2r(text);void 0!==v&&_$registry_668.call("relayout",gd,attrStr,v)})}}};_$dragelement_433.init(dragOptions);var updates={};function zoomMove(dx0,dy0){if(gd._transitioningWithDuration)return!1;var x1=Math.max(0,Math.min(pw,dx0+x0)),y1=Math.max(0,Math.min(ph,dy0+y0)),dx=Math.abs(x1-x0),dy=Math.abs(y1-y0);function noZoom(){zoomMode="",box.r=box.l,box.t=box.b,corners.attr("d","M0,0Z")}box.l=Math.min(x0,x1),box.r=Math.max(x0,x1),box.t=Math.min(y0,y1),box.b=Math.max(y0,y1),isSubplotConstrained?dx>MINZOOM||dy>MINZOOM?(zoomMode="xy",dx/pw>dy/ph?(dy=dx*ph/pw,y0>y1?box.t=y0-dy:box.b=y0+dy):(dx=dy*pw/ph,x0>x1?box.l=x0-dx:box.r=x0+dx),corners.attr("d",xyCorners(box))):noZoom():!yActive||dy<Math.min(Math.max(.6*dx,MINDRAG),MINZOOM)?dx<MINDRAG?noZoom():(box.t=0,box.b=ph,zoomMode="x",corners.attr("d",function xCorners(box,y0){return"M"+(box.l-.5)+","+(y0-MINZOOM-.5)+"h-3v"+(2*MINZOOM+1)+"h3ZM"+(box.r+.5)+","+(y0-MINZOOM-.5)+"h3v"+(2*MINZOOM+1)+"h-3Z"}(box,y0))):!xActive||dx<Math.min(.6*dy,MINZOOM)?(box.l=0,box.r=pw,zoomMode="y",corners.attr("d",function yCorners(box,x0){return"M"+(x0-MINZOOM-.5)+","+(box.t-.5)+"v-3h"+(2*MINZOOM+1)+"v3ZM"+(x0-MINZOOM-.5)+","+(box.b+.5)+"v3h"+(2*MINZOOM+1)+"v-3Z"}(box,x0))):(zoomMode="xy",corners.attr("d",xyCorners(box))),box.w=box.r-box.l,box.h=box.b-box.t,updateZoombox(zb,corners,box,path0,dimmed,lum),dimmed=!0}function zoomDone(){if(Math.min(box.h,box.w)<2*MINDRAG)return removeZoombox(gd);"xy"!==zoomMode&&"x"!==zoomMode||zoomAxRanges(xa,box.l/pw,box.r/pw,updates,xaLinked),"xy"!==zoomMode&&"y"!==zoomMode||zoomAxRanges(ya,(ph-box.b)/ph,(ph-box.t)/ph,updates,yaLinked),removeZoombox(gd),dragTail(),showDoubleClickNotifier(gd)}var scrollViewBox=[0,0,pw,ph],redrawTimer=null,REDRAWDELAY=_$constants_589.REDRAWDELAY,mainplot=plotinfo.mainplot?fullLayout._plots[plotinfo.mainplot]:plotinfo;function plotDrag(dx,dy){if(!gd._transitioningWithDuration){if(recomputeAxisLists(),"ew"===xActive||"ns"===yActive)return xActive&&dragAxList(xa,dx),yActive&&dragAxList(ya,dy),updateSubplots([xActive?-dx:0,yActive?-dy:0,pw,ph]),void ticksAndAnnotations(yActive,xActive);if(isSubplotConstrained&&xActive&&yActive){var dxySign="w"===xActive==("n"===yActive)?1:-1,dxyFraction=(dx/pw+dxySign*dy/ph)/2;dx=dxyFraction*pw,dy=dxySign*dxyFraction*ph}"w"===xActive?dx=dz(xa,0,dx):"e"===xActive?dx=dz(xa,1,-dx):xActive||(dx=0),"n"===yActive?dy=dz(ya,1,dy):"s"===yActive?dy=dz(ya,0,-dy):yActive||(dy=0);var x0="w"===xActive?dx:0,y0="n"===yActive?dy:0;if(isSubplotConstrained){var i;if(!xActive&&1===yActive.length){for(i=0;i<xa.length;i++)xa[i].range=xa[i]._r.slice(),_$scaleZoom_601(xa[i],1-dy/ph);x0=(dx=dy*pw/ph)/2}if(!yActive&&1===xActive.length){for(i=0;i<ya.length;i++)ya[i].range=ya[i]._r.slice(),_$scaleZoom_601(ya[i],1-dx/pw);y0=(dy=dx*ph/pw)/2}}updateSubplots([x0,y0,pw-dx,ph-dy]),ticksAndAnnotations(yActive,xActive)}function dz(axArray,end,d){for(var movedAx,newLinearizedEnd,otherEnd=1-end,i=0;i<axArray.length;i++){var axi=axArray[i];if(!axi.fixedrange){movedAx=axi,newLinearizedEnd=axi._rl[otherEnd]+(axi._rl[end]-axi._rl[otherEnd])/dZoom(d/axi._length);var newEnd=axi.l2r(newLinearizedEnd);!1!==newEnd&&void 0!==newEnd&&(axi.range[end]=newEnd)}}return movedAx._length*(movedAx._rl[end]-newLinearizedEnd)/(movedAx._rl[end]-movedAx._rl[otherEnd])}}function ticksAndAnnotations(ns,ew){var i,activeAxIds=[];function pushActiveAxIds(axList){for(i=0;i<axList.length;i++)axList[i].fixedrange||activeAxIds.push(axList[i]._id)}for((ew||isSubplotConstrained)&&(pushActiveAxIds(xa),pushActiveAxIds(xaLinked)),(ns||isSubplotConstrained)&&(pushActiveAxIds(ya),pushActiveAxIds(yaLinked)),updates={},i=0;i<activeAxIds.length;i++){var axId=activeAxIds[i];doTicks(gd,axId,!0);var ax=getFromId(gd,axId);updates[ax._name+".range[0]"]=ax.range[0],updates[ax._name+".range[1]"]=ax.range[1]}function redrawObjs(objArray,method,shortCircuit){for(i=0;i<objArray.length;i++){var obji=objArray[i];if((ew&&-1!==activeAxIds.indexOf(obji.xref)||ns&&-1!==activeAxIds.indexOf(obji.yref))&&(method(gd,i),shortCircuit))return}}redrawObjs(fullLayout.annotations||[],_$registry_668.getComponentMethod("annotations","drawOne")),redrawObjs(fullLayout.shapes||[],_$registry_668.getComponentMethod("shapes","drawOne")),redrawObjs(fullLayout.images||[],_$registry_668.getComponentMethod("images","draw"),!0)}function dragTail(){updateSubplots([0,0,pw,ph]),_$lib_539.syncOrAsync([_$plots_647.previousPromises,function(){_$registry_668.call("relayout",gd,updates)}],gd)}function updateSubplots(viewBox){var i,xScaleFactor2,yScaleFactor2,clipDx,clipDy,plotinfos=fullLayout._plots,subplots=Object.keys(plotinfos),xScaleFactor=viewBox[2]/xa[0]._length,yScaleFactor=viewBox[3]/ya[0]._length,editX=ew||isSubplotConstrained,editY=ns||isSubplotConstrained;function getLinkedScaleFactor(ax){return ax.fixedrange?0:editX&&-1!==xaLinked.indexOf(ax)?xScaleFactor:editY&&-1!==(isSubplotConstrained?xaLinked:yaLinked).indexOf(ax)?yScaleFactor:0}function scaleAndGetShift(ax,scaleFactor){return scaleFactor?(ax.range=ax._r.slice(),_$scaleZoom_601(ax,scaleFactor),getShift(ax,scaleFactor)):0}function getShift(ax,scaleFactor){return ax._length*(1-scaleFactor)*__FROM_TL_592[ax.constraintoward||"middle"]}for(fullLayout._glcanvas&&fullLayout._glcanvas.size()&&fullLayout._glcanvas.each(function(d){d.regl&&d.regl.clear({color:!0})}),i=0;i<subplots.length;i++){var subplot=plotinfos[subplots[i]],xa2=subplot.xaxis,ya2=subplot.yaxis,editX2=editX&&!xa2.fixedrange&&-1!==xa.indexOf(xa2),editY2=editY&&!ya2.fixedrange&&-1!==ya.indexOf(ya2);if(subplot._scene&&subplot._scene.update){var xaRange=_$lib_539.simpleMap(xa2.range,xa2.r2l),yaRange=_$lib_539.simpleMap(ya2.range,ya2.r2l);subplot._scene.update({range:[xaRange[0],yaRange[0],xaRange[1],yaRange[1]]})}if(editX2?(xScaleFactor2=xScaleFactor,clipDx=ew?viewBox[0]:getShift(xa2,xScaleFactor2)):clipDx=scaleAndGetShift(xa2,xScaleFactor2=getLinkedScaleFactor(xa2)),editY2?(yScaleFactor2=yScaleFactor,clipDy=ns?viewBox[1]:getShift(ya2,yScaleFactor2)):clipDy=scaleAndGetShift(ya2,yScaleFactor2=getLinkedScaleFactor(ya2)),xScaleFactor2||yScaleFactor2){xScaleFactor2||(xScaleFactor2=1),yScaleFactor2||(yScaleFactor2=1);var plotDx=xa2._offset-clipDx/xScaleFactor2,plotDy=ya2._offset-clipDy/yScaleFactor2;fullLayout._defs.select("#"+subplot.clipId+"> rect").call(_$drawing_436.setTranslate,clipDx,clipDy).call(_$drawing_436.setScale,xScaleFactor2,yScaleFactor2);var traceGroups=subplot.plot.selectAll(".scatterlayer .trace, .boxlayer .trace, .violinlayer .trace");subplot.plot.call(_$drawing_436.setTranslate,plotDx,plotDy).call(_$drawing_436.setScale,1/xScaleFactor2,1/yScaleFactor2),traceGroups.selectAll(".point").call(_$drawing_436.setPointGroupScale,xScaleFactor2,yScaleFactor2),traceGroups.selectAll(".textpoint").call(_$drawing_436.setTextPointsScale,xScaleFactor2,yScaleFactor2),traceGroups.call(_$drawing_436.hideOutsideRangePoints,subplot),subplot.plot.selectAll(".barlayer .trace").call(_$drawing_436.hideOutsideRangePoints,subplot,".bartext")}}}return ns.length*ew.length!=1&&attachWheelEventHandler(dragger,function zoomWheel(e){if(gd._context.scrollZoom||fullLayout._enablescrollzoom){if(null===redrawTimer&&clearSelect(zoomlayer),gd._transitioningWithDuration)return e.preventDefault(),void e.stopPropagation();var pc=gd.querySelector(".plotly");if(recomputeAxisLists(),!(pc.scrollHeight-pc.clientHeight>10||pc.scrollWidth-pc.clientWidth>10)){clearTimeout(redrawTimer);var wheelDelta=-e.deltaY;if(isFinite(wheelDelta)||(wheelDelta=e.wheelDelta/10),isFinite(wheelDelta)){var i,zoom=Math.exp(-Math.min(Math.max(wheelDelta,-20),20)/200),gbb=mainplot.draglayer.select(".nsewdrag").node().getBoundingClientRect(),xfrac=(e.clientX-gbb.left)/gbb.width,yfrac=(gbb.bottom-e.clientY)/gbb.height;if(ew||isSubplotConstrained){for(ew||(xfrac=.5),i=0;i<xa.length;i++)zoomWheelOneAxis(xa[i],xfrac,zoom);scrollViewBox[2]*=zoom,scrollViewBox[0]+=scrollViewBox[2]*xfrac*(1/zoom-1)}if(ns||isSubplotConstrained){for(ns||(yfrac=.5),i=0;i<ya.length;i++)zoomWheelOneAxis(ya[i],yfrac,zoom);scrollViewBox[3]*=zoom,scrollViewBox[1]+=scrollViewBox[3]*(1-yfrac)*(1/zoom-1)}updateSubplots(scrollViewBox),ticksAndAnnotations(ns,ew),redrawTimer=setTimeout(function(){scrollViewBox=[0,0,pw,ph],dragTail()},REDRAWDELAY),e.preventDefault()}else _$lib_539.log("Did not find wheel motion attributes: ",e)}}function zoomWheelOneAxis(ax,centerFraction,zoom){if(!ax.fixedrange){var axRange=_$lib_539.simpleMap(ax.range,ax.r2l),v0=axRange[0]+(axRange[1]-axRange[0])*centerFraction;ax.range=axRange.map(function doZoom(v){return ax.l2r(v0+(v-v0)*zoom)})}}}),dragger},makeDragger:makeDragger,makeRectDragger:makeRectDragger,makeZoombox:makeZoombox,makeCorners:makeCorners,updateZoombox:updateZoombox,xyCorners:xyCorners,transitionZoombox:transitionZoombox,removeZoombox:removeZoombox,clearSelect:clearSelect,showDoubleClickNotifier:showDoubleClickNotifier,attachWheelEventHandler:attachWheelEventHandler},__makeDragBox_593=_$dragbox_592.makeDragBox,_$initInteractions_593=function initInteractions(gd){var fullLayout=gd._fullLayout;if(gd._context.staticPlot)_$d3_127.select(gd).selectAll(".drag").remove();else if(fullLayout._has("cartesian")||fullLayout._has("gl2d")){Object.keys(fullLayout._plots||{}).sort(function(a,b){if((fullLayout._plots[a].mainplot&&!0)===(fullLayout._plots[b].mainplot&&!0)){var aParts=a.split("y"),bParts=b.split("y");return aParts[0]===bParts[0]?Number(aParts[1]||1)-Number(bParts[1]||1):Number(aParts[0]||1)-Number(bParts[0]||1)}return fullLayout._plots[a].mainplot?1:-1}).forEach(function(subplot){var plotinfo=fullLayout._plots[subplot],xa=plotinfo.xaxis,ya=plotinfo.yaxis,DRAGGERSIZE=_$constants_589.DRAGGERSIZE;if(!plotinfo.mainplot){var maindrag=__makeDragBox_593(gd,plotinfo,xa._offset,ya._offset,xa._length,ya._length,"ns","ew");maindrag.onmousemove=function(evt){gd._fullLayout._rehover=function(){gd._fullLayout._hoversubplot===subplot&&_$fx_453.hover(gd,evt,subplot)},_$fx_453.hover(gd,evt,subplot),gd._fullLayout._lasthover=maindrag,gd._fullLayout._hoversubplot=subplot},maindrag.onmouseout=function(evt){gd._dragging||(gd._fullLayout._hoversubplot=null,_$dragelement_433.unhover(gd,evt))},gd._context.showAxisDragHandles&&(__makeDragBox_593(gd,plotinfo,xa._offset-DRAGGERSIZE,ya._offset-DRAGGERSIZE,DRAGGERSIZE,DRAGGERSIZE,"n","w"),__makeDragBox_593(gd,plotinfo,xa._offset+xa._length,ya._offset-DRAGGERSIZE,DRAGGERSIZE,DRAGGERSIZE,"n","e"),__makeDragBox_593(gd,plotinfo,xa._offset-DRAGGERSIZE,ya._offset+ya._length,DRAGGERSIZE,DRAGGERSIZE,"s","w"),__makeDragBox_593(gd,plotinfo,xa._offset+xa._length,ya._offset+ya._length,DRAGGERSIZE,DRAGGERSIZE,"s","e"))}if(gd._context.showAxisDragHandles){if(subplot===xa._mainSubplot){var y0=xa._mainLinePosition;"top"===xa.side&&(y0-=DRAGGERSIZE),__makeDragBox_593(gd,plotinfo,xa._offset+.1*xa._length,y0,.8*xa._length,DRAGGERSIZE,"","ew"),__makeDragBox_593(gd,plotinfo,xa._offset,y0,.1*xa._length,DRAGGERSIZE,"","w"),__makeDragBox_593(gd,plotinfo,xa._offset+.9*xa._length,y0,.1*xa._length,DRAGGERSIZE,"","e")}if(subplot===ya._mainSubplot){var x0=ya._mainLinePosition;"right"!==ya.side&&(x0-=DRAGGERSIZE),__makeDragBox_593(gd,plotinfo,x0,ya._offset+.1*ya._length,DRAGGERSIZE,.8*ya._length,"ns",""),__makeDragBox_593(gd,plotinfo,x0,ya._offset+.9*ya._length,DRAGGERSIZE,.1*ya._length,"s",""),__makeDragBox_593(gd,plotinfo,x0,ya._offset,DRAGGERSIZE,.1*ya._length,"n","")}}});var hoverLayer=fullLayout._hoverlayer.node();hoverLayer.onmousemove=function(evt){evt.target=fullLayout._lasthover,_$fx_453.hover(gd,evt,fullLayout._hoversubplot)},hoverLayer.onclick=function(evt){evt.target=fullLayout._lasthover,_$fx_453.click(gd,evt)},hoverLayer.onmousedown=function(evt){fullLayout._lasthover.onmousedown(evt)}}},_$subroutines_576={};function shouldShowLinesOrTicks(ax,subplot){return(ax.ticks||ax.showline)&&(subplot===ax._mainSubplot||"all"===ax.mirror||"allticks"===ax.mirror)}function shouldShowLineThisSide(ax,side,counterAx){if(!counterAx.showline||!counterAx._lw)return!1;if("all"===counterAx.mirror||"allticks"===counterAx.mirror)return!0;var anchorAx=counterAx._anchorAxis;if(!anchorAx)return!1;var sideIndex=_$alignment_511.FROM_BL[side];return counterAx.side===side?anchorAx.domain[sideIndex]===ax.domain[sideIndex]:counterAx.mirror&&anchorAx.domain[1-sideIndex]===ax.domain[1-sideIndex]}function findCounterAxisLineWidth(ax,side,counterAx,axList){if(shouldShowLineThisSide(ax,side,counterAx))return counterAx._lw;for(var i=0;i<axList.length;i++){var axi=axList[i];if(axi._mainAxis===counterAx._mainAxis&&shouldShowLineThisSide(ax,side,axi))return axi._lw}return 0}_$subroutines_576.layoutStyles=function(gd){return _$lib_539.syncOrAsync([_$plots_647.doAutoMargin,_$subroutines_576.lsInner],gd)},_$subroutines_576.lsInner=function(gd){var i,fullLayout=gd._fullLayout,gs=fullLayout._size,pad=gs.p,axList=_$axes_584.list(gd),hasSVGCartesian=fullLayout._has("cartesian");function getLinePosition(ax,counterAx,side){var lwHalf=ax._lw/2;return"x"===ax._id.charAt(0)?counterAx?"top"===side?counterAx._offset-pad-lwHalf:counterAx._offset+counterAx._length+pad+lwHalf:gs.t+gs.h*(1-(ax.position||0))+lwHalf%1:counterAx?"right"===side?counterAx._offset+counterAx._length+pad+lwHalf:counterAx._offset-pad-lwHalf:gs.l+gs.w*(ax.position||0)+lwHalf%1}for(i=0;i<axList.length;i++){var ax=axList[i];ax.setScale();var counterAx=ax._anchorAxis;ax._linepositions={},ax._lw=_$drawing_436.crispRound(gd,ax.linewidth,1),ax._mainLinePosition=getLinePosition(ax,counterAx,ax.side),ax._mainMirrorPosition=ax.mirror&&counterAx?getLinePosition(ax,counterAx,_$alignment_511.OPPOSITE_SIDE[ax.side]):null}fullLayout._paperdiv.style({width:fullLayout.width+"px",height:fullLayout.height+"px"}).selectAll(".main-svg").call(_$drawing_436.setSize,fullLayout.width,fullLayout.height),gd._context.setBackground(gd,fullLayout.paper_bgcolor);var subplotSelection=fullLayout._paper.selectAll("g.subplot"),lowerBackgroundIDs=[],lowerDomains=[];subplotSelection.each(function(subplot){var plotinfo=fullLayout._plots[subplot];if(plotinfo.mainplot)return plotinfo.bg&&plotinfo.bg.remove(),void(plotinfo.bg=void 0);var xDomain=plotinfo.xaxis.domain,yDomain=plotinfo.yaxis.domain,plotgroupBgData=[];!function overlappingDomain(xDomain,yDomain,domains){for(var i=0;i<domains.length;i++){var existingX=domains[i][0],existingY=domains[i][1];if(!(existingX[0]>=xDomain[1]||existingX[1]<=xDomain[0])&&existingY[0]<yDomain[1]&&existingY[1]>yDomain[0])return!0}return!1}(xDomain,yDomain,lowerDomains)?(lowerBackgroundIDs.push(subplot),lowerDomains.push([xDomain,yDomain])):plotgroupBgData=[0];var plotgroupBg=plotinfo.plotgroup.selectAll(".bg").data(plotgroupBgData);plotgroupBg.enter().append("rect").classed("bg",!0),plotgroupBg.exit().remove(),plotgroupBg.each(function(){plotinfo.bg=plotgroupBg;var pgNode=plotinfo.plotgroup.node();pgNode.insertBefore(this,pgNode.childNodes[0])})});var lowerBackgrounds=fullLayout._bgLayer.selectAll(".bg").data(lowerBackgroundIDs);return lowerBackgrounds.enter().append("rect").classed("bg",!0),lowerBackgrounds.exit().remove(),lowerBackgrounds.each(function(subplot){fullLayout._plots[subplot].bg=_$d3_127.select(this)}),subplotSelection.each(function(subplot){var plotinfo=fullLayout._plots[subplot],xa=plotinfo.xaxis,ya=plotinfo.yaxis;plotinfo.bg&&hasSVGCartesian&&plotinfo.bg.call(_$drawing_436.setRect,xa._offset-pad,ya._offset-pad,xa._length+2*pad,ya._length+2*pad).call(_$color_411.fill,fullLayout.plot_bgcolor).style("stroke-width",0),plotinfo.clipId="clip"+fullLayout._uid+subplot+"plot";var plotClipId,layerClipId,plotClip=fullLayout._clips.selectAll("#"+plotinfo.clipId).data([0]);for(plotClip.enter().append("clipPath").attr({class:"plotclip",id:plotinfo.clipId}).append("rect"),plotClip.selectAll("rect").attr({width:xa._length,height:ya._length}),_$drawing_436.setTranslate(plotinfo.plot,xa._offset,ya._offset),plotinfo._hasClipOnAxisFalse?(plotClipId=null,layerClipId=plotinfo.clipId):(plotClipId=plotinfo.clipId,layerClipId=null),_$drawing_436.setClipUrl(plotinfo.plot,plotClipId),i=0;i<_$constants_589.traceLayerClasses.length;i++){var layer=_$constants_589.traceLayerClasses[i];"scatterlayer"!==layer&&"barlayer"!==layer&&plotinfo.plot.selectAll("g."+layer).call(_$drawing_436.setClipUrl,layerClipId)}if(plotinfo.layerClipId=layerClipId,hasSVGCartesian){var xLinesXLeft,xLinesXRight,xLinesYBottom,xLinesYTop,leftYLineWidth,rightYLineWidth,yLinesYBottom,yLinesYTop,yLinesXLeft,yLinesXRight,connectYBottom,connectYTop,extraSubplot,xPath="M0,0";shouldShowLinesOrTicks(xa,subplot)&&(leftYLineWidth=findCounterAxisLineWidth(xa,"left",ya,axList),xLinesXLeft=xa._offset-(leftYLineWidth?pad+leftYLineWidth:0),rightYLineWidth=findCounterAxisLineWidth(xa,"right",ya,axList),xLinesXRight=xa._offset+xa._length+(rightYLineWidth?pad+rightYLineWidth:0),xLinesYBottom=getLinePosition(xa,ya,"bottom"),xLinesYTop=getLinePosition(xa,ya,"top"),(extraSubplot=!xa._anchorAxis||subplot!==xa._mainSubplot)&&xa.ticks&&"allticks"===xa.mirror&&(xa._linepositions[subplot]=[xLinesYBottom,xLinesYTop]),xPath=mainPath(xa,xLinePath,function xLinePathFree(y){return"M"+xa._offset+","+y+"h"+xa._length}),extraSubplot&&xa.showline&&("all"===xa.mirror||"allticks"===xa.mirror)&&(xPath+=xLinePath(xLinesYBottom)+xLinePath(xLinesYTop)),plotinfo.xlines.style("stroke-width",xa._lw+"px").call(_$color_411.stroke,xa.showline?xa.linecolor:"rgba(0,0,0,0)")),plotinfo.xlines.attr("d",xPath);var yPath="M0,0";shouldShowLinesOrTicks(ya,subplot)&&(connectYBottom=findCounterAxisLineWidth(ya,"bottom",xa,axList),yLinesYBottom=ya._offset+ya._length+(connectYBottom?pad:0),connectYTop=findCounterAxisLineWidth(ya,"top",xa,axList),yLinesYTop=ya._offset-(connectYTop?pad:0),yLinesXLeft=getLinePosition(ya,xa,"left"),yLinesXRight=getLinePosition(ya,xa,"right"),(extraSubplot=!ya._anchorAxis||subplot!==xa._mainSubplot)&&ya.ticks&&"allticks"===ya.mirror&&(ya._linepositions[subplot]=[yLinesXLeft,yLinesXRight]),yPath=mainPath(ya,yLinePath,function yLinePathFree(x){return"M"+x+","+ya._offset+"v"+ya._length}),extraSubplot&&ya.showline&&("all"===ya.mirror||"allticks"===ya.mirror)&&(yPath+=yLinePath(yLinesXLeft)+yLinePath(yLinesXRight)),plotinfo.ylines.style("stroke-width",ya._lw+"px").call(_$color_411.stroke,ya.showline?ya.linecolor:"rgba(0,0,0,0)")),plotinfo.ylines.attr("d",yPath)}function xLinePath(y){return"M"+xLinesXLeft+","+y+"H"+xLinesXRight}function yLinePath(x){return"M"+x+","+yLinesYTop+"V"+yLinesYBottom}function mainPath(ax,pathFn,pathFnFree){if(!ax.showline||subplot!==ax._mainSubplot)return"";if(!ax._anchorAxis)return pathFnFree(ax._mainLinePosition);var out=pathFn(ax._mainLinePosition);return ax.mirror&&(out+=pathFn(ax._mainMirrorPosition)),out}}),_$axes_584.makeClipPaths(gd),_$subroutines_576.drawMainTitle(gd),_$modebar_474.manage(gd),gd._promises.length&&Promise.all(gd._promises)},_$subroutines_576.drawMainTitle=function(gd){var fullLayout=gd._fullLayout;_$titles_504.draw(gd,"gtitle",{propContainer:fullLayout,propName:"title",placeholder:fullLayout._dfltTitle.plot,attributes:{x:fullLayout.width/2,y:fullLayout._size.t/2,"text-anchor":"middle"}})},_$subroutines_576.doTraceStyle=function(gd){for(var i=0;i<gd.calcdata.length;i++){var cdi=gd.calcdata[i],arraysToCalcdata=(((cdi[0]||{}).trace||{})._module||{}).arraysToCalcdata;arraysToCalcdata&&arraysToCalcdata(cdi,cdi[0].trace)}return _$plots_647.style(gd),_$registry_668.getComponentMethod("legend","draw")(gd),_$plots_647.previousPromises(gd)},_$subroutines_576.doColorBars=function(gd){for(var i=0;i<gd.calcdata.length;i++){var cdi0=gd.calcdata[i][0];if((cdi0.t||{}).cb){var trace=cdi0.trace,cb=cdi0.t.cb;_$registry_668.traceIs(trace,"contour")&&cb.line({width:!1!==trace.contours.showlines?trace.line.width:0,dash:trace.line.dash,color:"line"===trace.contours.coloring?cb._opts.line.color:trace.line.color}),_$registry_668.traceIs(trace,"markerColorscale")?cb.options(trace.marker.colorbar)():cb.options(trace.colorbar)()}}return _$plots_647.previousPromises(gd)},_$subroutines_576.layoutReplot=function(gd){var layout=gd.layout;return gd.layout=void 0,_$registry_668.call("plot",gd,"",layout)},_$subroutines_576.doLegend=function(gd){return _$registry_668.getComponentMethod("legend","draw")(gd),_$plots_647.previousPromises(gd)},_$subroutines_576.doTicksRelayout=function(gd){return _$axes_584.doTicks(gd,"redraw"),_$subroutines_576.drawMainTitle(gd),_$plots_647.previousPromises(gd)},_$subroutines_576.doModeBar=function(gd){var fullLayout=gd._fullLayout;_$modebar_474.manage(gd),_$initInteractions_593(gd);for(var i=0;i<fullLayout._basePlotModules.length;i++){var updateFx=fullLayout._basePlotModules[i].updateFx;updateFx&&updateFx(fullLayout)}return _$plots_647.previousPromises(gd)},_$subroutines_576.doCamera=function(gd){for(var fullLayout=gd._fullLayout,sceneIds=fullLayout._subplots.gl3d,i=0;i<sceneIds.length;i++){var sceneLayout=fullLayout[sceneIds[i]];sceneLayout._scene.setCamera(sceneLayout.camera)}};var _$constraints_591={},__id2name_591=_$axis_ids_587.id2name,__makePadFn_591=_$autorange___makePadFn,ALMOST_EQUAL=_$numerical_517.ALMOST_EQUAL,__FROM_BL_591=_$alignment_511.FROM_BL;function updateDomain(ax,factor){var inputDomain=ax._inputDomain,centerFraction=__FROM_BL_591[ax.constraintoward],center=inputDomain[0]+(inputDomain[1]-inputDomain[0])*centerFraction;ax.domain=ax._input.domain=[center+(inputDomain[0]-center)/factor,center+(inputDomain[1]-center)/factor]}_$constraints_591.enforce=function enforceAxisConstraints(gd){var i,j,axisID,ax,normScale,mode,factor,fullLayout=gd._fullLayout,constraintGroups=fullLayout._axisConstraintGroups||[];for(i=0;i<constraintGroups.length;i++){var group=constraintGroups[i],axisIDs=Object.keys(group),minScale=1/0,maxScale=0,matchScale=1/0,normScales={},axes={},hasAnyDomainConstraint=!1;for(j=0;j<axisIDs.length;j++)axes[axisID=axisIDs[j]]=ax=fullLayout[__id2name_591(axisID)],ax._inputDomain?ax.domain=ax._inputDomain.slice():ax._inputDomain=ax.domain.slice(),ax._inputRange||(ax._inputRange=ax.range.slice()),ax.setScale(),normScales[axisID]=normScale=Math.abs(ax._m)/group[axisID],minScale=Math.min(minScale,normScale),"domain"!==ax.constrain&&ax._constraintShrinkable||(matchScale=Math.min(matchScale,normScale)),delete ax._constraintShrinkable,maxScale=Math.max(maxScale,normScale),"domain"===ax.constrain&&(hasAnyDomainConstraint=!0);if(!(minScale>ALMOST_EQUAL*maxScale)||hasAnyDomainConstraint)for(j=0;j<axisIDs.length;j++)if(normScale=normScales[axisID=axisIDs[j]],mode=(ax=axes[axisID]).constrain,normScale!==matchScale||"domain"===mode)if(factor=normScale/matchScale,"range"===mode)_$scaleZoom_601(ax,factor);else{var inputDomain=ax._inputDomain,domainShrunk=(ax.domain[1]-ax.domain[0])/(inputDomain[1]-inputDomain[0]),rangeShrunk=(ax.r2l(ax.range[1])-ax.r2l(ax.range[0]))/(ax.r2l(ax._inputRange[1])-ax.r2l(ax._inputRange[0]));if((factor/=domainShrunk)*rangeShrunk<1){ax.domain=ax._input.domain=inputDomain.slice(),_$scaleZoom_601(ax,factor);continue}if(rangeShrunk<1&&(ax.range=ax._input.range=ax._inputRange.slice(),factor*=rangeShrunk),ax.autorange&&ax._min.length&&ax._max.length){var rl0=ax.r2l(ax.range[0]),rl1=ax.r2l(ax.range[1]),rangeCenter=(rl0+rl1)/2,rangeMin=rangeCenter,rangeMax=rangeCenter,halfRange=Math.abs(rl1-rangeCenter),outerMin=rangeCenter-halfRange*factor*1.0001,outerMax=rangeCenter+halfRange*factor*1.0001,getPad=__makePadFn_591(ax);updateDomain(ax,factor),ax.setScale();var newVal,k,m=Math.abs(ax._m);for(k=0;k<ax._min.length;k++)(newVal=ax._min[k].val-getPad(ax._min[k])/m)>outerMin&&newVal<rangeMin&&(rangeMin=newVal);for(k=0;k<ax._max.length;k++)(newVal=ax._max[k].val+getPad(ax._max[k])/m)<outerMax&&newVal>rangeMax&&(rangeMax=newVal);factor/=(rangeMax-rangeMin)/(2*halfRange),rangeMin=ax.l2r(rangeMin),rangeMax=ax.l2r(rangeMax),ax.range=ax._input.range=rl0<rl1?[rangeMin,rangeMax]:[rangeMax,rangeMin]}updateDomain(ax,factor)}}},_$constraints_591.clean=function cleanConstraints(gd,ax){if(ax._inputDomain){for(var isConstrained=!1,axId=ax._id,constraintGroups=gd._fullLayout._axisConstraintGroups,j=0;j<constraintGroups.length;j++)if(constraintGroups[j][axId]){isConstrained=!0;break}isConstrained&&"domain"===ax.constrain||(ax._input.domain=ax.domain=ax._inputDomain,delete ax._inputDomain)}};var _$micropolar_656={},__extendDeepAll_656=_$lib_539.extendDeepAll,__MID_SHIFT_656=_$alignment_511.MID_SHIFT,µ=_$micropolar_656={version:"0.2.2"};µ.Axis=function module(){var svg,container,radialScale,angularScale,config={data:[],layout:{}},inputConfig={},liveConfig={},dispatch=_$d3_127.dispatch("hover"),exports={};return exports.render=function(_container){return function render(_container){container=_container||container;var data=config.data,axisConfig=config.layout;return("string"==typeof container||container.nodeName)&&(container=_$d3_127.select(container)),container.datum(data).each(function(_data,_index){var dataOriginal=_data.slice();liveConfig={data:µ.util.cloneJson(dataOriginal),layout:µ.util.cloneJson(axisConfig)};var colorIndex=0;dataOriginal.forEach(function(d,i){d.color||(d.color=axisConfig.defaultColorRange[colorIndex],colorIndex=(colorIndex+1)%axisConfig.defaultColorRange.length),d.strokeColor||(d.strokeColor="LinePlot"===d.geometry?d.color:_$d3_127.rgb(d.color).darker().toString()),liveConfig.data[i].color=d.color,liveConfig.data[i].strokeColor=d.strokeColor,liveConfig.data[i].strokeDash=d.strokeDash,liveConfig.data[i].strokeSize=d.strokeSize});var data=dataOriginal.filter(function(d,i){var visible=d.visible;return void 0===visible||!0===visible}),isStacked=!1,dataWithGroupId=data.map(function(d,i){return isStacked=isStacked||void 0!==d.groupId,d});if(isStacked){var dataYStack=[],stacked=_$d3_127.nest().key(function(d,i){return void 0!==d.groupId?d.groupId:"unstacked"}).entries(dataWithGroupId).map(function(d,i){if("unstacked"===d.key)return d.values;var prevArray=d.values[0].r.map(function(d,i){return 0});return d.values.forEach(function(d,i,a){d.yStack=[prevArray],dataYStack.push(prevArray),prevArray=µ.util.sumArrays(d.r,prevArray)}),d.values});data=_$d3_127.merge(stacked)}data.forEach(function(d,i){d.t=Array.isArray(d.t[0])?d.t:[d.t],d.r=Array.isArray(d.r[0])?d.r:[d.r]});var radius=Math.min(axisConfig.width-axisConfig.margin.left-axisConfig.margin.right,axisConfig.height-axisConfig.margin.top-axisConfig.margin.bottom)/2;radius=Math.max(10,radius);var extent,chartCenter=[axisConfig.margin.left+radius,axisConfig.margin.top+radius];extent=isStacked?[0,_$d3_127.max(µ.util.sumArrays(µ.util.arrayLast(data).r[0],µ.util.arrayLast(dataYStack)))]:_$d3_127.extent(µ.util.flattenArray(data.map(function(d,i){return d.r}))),axisConfig.radialAxis.domain!=µ.DATAEXTENT&&(extent[0]=0),radialScale=_$d3_127.scale.linear().domain(axisConfig.radialAxis.domain!=µ.DATAEXTENT&&axisConfig.radialAxis.domain?axisConfig.radialAxis.domain:extent).range([0,radius]),liveConfig.layout.radialAxis.domain=radialScale.domain();var ticks,angularDataMerged=µ.util.flattenArray(data.map(function(d,i){return d.t})),isOrdinal="string"==typeof angularDataMerged[0];isOrdinal&&(angularDataMerged=µ.util.deduplicate(angularDataMerged),ticks=angularDataMerged.slice(),angularDataMerged=_$d3_127.range(angularDataMerged.length),data=data.map(function(d,i){var result=d;return d.t=[angularDataMerged],isStacked&&(result.yStack=d.yStack),result}));var hasOnlyLineOrDotPlot=data.filter(function(d,i){return"LinePlot"===d.geometry||"DotPlot"===d.geometry}).length===data.length,needsEndSpacing=null===axisConfig.needsEndSpacing?isOrdinal||!hasOnlyLineOrDotPlot:axisConfig.needsEndSpacing,angularDomain=axisConfig.angularAxis.domain&&axisConfig.angularAxis.domain!=µ.DATAEXTENT&&!isOrdinal&&axisConfig.angularAxis.domain[0]>=0?axisConfig.angularAxis.domain:_$d3_127.extent(angularDataMerged),angularDomainStep=Math.abs(angularDataMerged[1]-angularDataMerged[0]);hasOnlyLineOrDotPlot&&!isOrdinal&&(angularDomainStep=0);var angularDomainWithPadding=angularDomain.slice();needsEndSpacing&&isOrdinal&&(angularDomainWithPadding[1]+=angularDomainStep);var tickCount=axisConfig.angularAxis.ticksCount||4;tickCount>8&&(tickCount=tickCount/(tickCount/8)+tickCount%8),axisConfig.angularAxis.ticksStep&&(tickCount=(angularDomainWithPadding[1]-angularDomainWithPadding[0])/tickCount);var angularTicksStep=axisConfig.angularAxis.ticksStep||(angularDomainWithPadding[1]-angularDomainWithPadding[0])/(tickCount*(axisConfig.minorTicks+1));ticks&&(angularTicksStep=Math.max(Math.round(angularTicksStep),1)),angularDomainWithPadding[2]||(angularDomainWithPadding[2]=angularTicksStep);var angularAxisRange=_$d3_127.range.apply(this,angularDomainWithPadding);if(angularAxisRange=angularAxisRange.map(function(d,i){return parseFloat(d.toPrecision(12))}),angularScale=_$d3_127.scale.linear().domain(angularDomainWithPadding.slice(0,2)).range("clockwise"===axisConfig.direction?[0,360]:[360,0]),liveConfig.layout.angularAxis.domain=angularScale.domain(),liveConfig.layout.angularAxis.endPadding=needsEndSpacing?angularDomainStep:0,void 0===(svg=_$d3_127.select(this).select("svg.chart-root"))||svg.empty()){var doc=(new DOMParser).parseFromString("<svg xmlns='http://www.w3.org/2000/svg' class='chart-root'>' + '<g class='outer-group'>' + '<g class='chart-group'>' + '<circle class='background-circle'></circle>' + '<g class='geometry-group'></g>' + '<g class='radial axis-group'>' + '<circle class='outside-circle'></circle>' + '</g>' + '<g class='angular axis-group'></g>' + '<g class='guides-group'><line></line><circle r='0'></circle></g>' + '</g>' + '<g class='legend-group'></g>' + '<g class='tooltips-group'></g>' + '<g class='title-group'><text></text></g>' + '</g>' + '</svg>","application/xml"),newSvg=this.appendChild(this.ownerDocument.importNode(doc.documentElement,!0));svg=_$d3_127.select(newSvg)}svg.select(".guides-group").style({"pointer-events":"none"}),svg.select(".angular.axis-group").style({"pointer-events":"none"}),svg.select(".radial.axis-group").style({"pointer-events":"none"});var legendContainer,chartGroup=svg.select(".chart-group"),lineStyle={fill:"none",stroke:axisConfig.tickColor},fontStyle={"font-size":axisConfig.font.size,"font-family":axisConfig.font.family,fill:axisConfig.font.color,"text-shadow":["-1px 0px","1px -1px","-1px 1px","1px 1px"].map(function(d,i){return" "+d+" 0 "+axisConfig.font.outlineColor}).join(",")};if(axisConfig.showLegend){legendContainer=svg.select(".legend-group").attr({transform:"translate("+[radius,axisConfig.margin.top]+")"}).style({display:"block"});var elements=data.map(function(d,i){var datumClone=µ.util.cloneJson(d);return datumClone.symbol="DotPlot"===d.geometry?d.dotType||"circle":"LinePlot"!=d.geometry?"square":"line",datumClone.visibleInLegend=void 0===d.visibleInLegend||d.visibleInLegend,datumClone.color="LinePlot"===d.geometry?d.strokeColor:d.color,datumClone});µ.Legend().config({data:data.map(function(d,i){return d.name||"Element"+i}),legendConfig:__extendDeepAll_656({},µ.Legend.defaultConfig().legendConfig,{container:legendContainer,elements:elements,reverseOrder:axisConfig.legend.reverseOrder})})();var legendBBox=legendContainer.node().getBBox();radius=Math.min(axisConfig.width-legendBBox.width-axisConfig.margin.left-axisConfig.margin.right,axisConfig.height-axisConfig.margin.top-axisConfig.margin.bottom)/2,radius=Math.max(10,radius),chartCenter=[axisConfig.margin.left+radius,axisConfig.margin.top+radius],radialScale.range([0,radius]),liveConfig.layout.radialAxis.domain=radialScale.domain(),legendContainer.attr("transform","translate("+[chartCenter[0]+radius,chartCenter[1]-radius]+")")}else legendContainer=svg.select(".legend-group").style({display:"none"});svg.attr({width:axisConfig.width,height:axisConfig.height}).style({opacity:axisConfig.opacity}),chartGroup.attr("transform","translate("+chartCenter+")").style({cursor:"crosshair"});var centeringOffset=[(axisConfig.width-(axisConfig.margin.left+axisConfig.margin.right+2*radius+(legendBBox?legendBBox.width:0)))/2,(axisConfig.height-(axisConfig.margin.top+axisConfig.margin.bottom+2*radius))/2];if(centeringOffset[0]=Math.max(0,centeringOffset[0]),centeringOffset[1]=Math.max(0,centeringOffset[1]),svg.select(".outer-group").attr("transform","translate("+centeringOffset+")"),axisConfig.title){var title=svg.select("g.title-group text").style(fontStyle).text(axisConfig.title),titleBBox=title.node().getBBox();title.attr({x:chartCenter[0]-titleBBox.width/2,y:chartCenter[1]-radius-20})}var radialAxis=svg.select(".radial.axis-group");if(axisConfig.radialAxis.gridLinesVisible){var gridCircles=radialAxis.selectAll("circle.grid-circle").data(radialScale.ticks(5));gridCircles.enter().append("circle").attr({class:"grid-circle"}).style(lineStyle),gridCircles.attr("r",radialScale),gridCircles.exit().remove()}radialAxis.select("circle.outside-circle").attr({r:radius}).style(lineStyle);var backgroundCircle=svg.select("circle.background-circle").attr({r:radius}).style({fill:axisConfig.backgroundColor,stroke:axisConfig.stroke});function currentAngle(d,i){return angularScale(d)%360+axisConfig.orientation}if(axisConfig.radialAxis.visible){var axis=_$d3_127.svg.axis().scale(radialScale).ticks(5).tickSize(5);radialAxis.call(axis).attr({transform:"rotate("+axisConfig.radialAxis.orientation+")"}),radialAxis.selectAll(".domain").style(lineStyle),radialAxis.selectAll("g>text").text(function(d,i){return this.textContent+axisConfig.radialAxis.ticksSuffix}).style(fontStyle).style({"text-anchor":"start"}).attr({x:0,y:0,dx:0,dy:0,transform:function(d,i){return"horizontal"===axisConfig.radialAxis.tickOrientation?"rotate("+-axisConfig.radialAxis.orientation+") translate("+[0,fontStyle["font-size"]]+")":"translate("+[0,fontStyle["font-size"]]+")"}}),radialAxis.selectAll("g>line").style({stroke:"black"})}var angularAxis=svg.select(".angular.axis-group").selectAll("g.angular-tick").data(angularAxisRange),angularAxisEnter=angularAxis.enter().append("g").classed("angular-tick",!0);angularAxis.attr({transform:function(d,i){return"rotate("+currentAngle(d)+")"}}).style({display:axisConfig.angularAxis.visible?"block":"none"}),angularAxis.exit().remove(),angularAxisEnter.append("line").classed("grid-line",!0).classed("major",function(d,i){return i%(axisConfig.minorTicks+1)==0}).classed("minor",function(d,i){return!(i%(axisConfig.minorTicks+1)==0)}).style(lineStyle),angularAxisEnter.selectAll(".minor").style({stroke:axisConfig.minorTickColor}),angularAxis.select("line.grid-line").attr({x1:axisConfig.tickLength?radius-axisConfig.tickLength:0,x2:radius}).style({display:axisConfig.angularAxis.gridLinesVisible?"block":"none"}),angularAxisEnter.append("text").classed("axis-text",!0).style(fontStyle);var ticksText=angularAxis.select("text.axis-text").attr({x:radius+axisConfig.labelOffset,dy:__MID_SHIFT_656+"em",transform:function(d,i){var angle=currentAngle(d),rad=radius+axisConfig.labelOffset,orient=axisConfig.angularAxis.tickOrientation;return"horizontal"==orient?"rotate("+-angle+" "+rad+" 0)":"radial"==orient?angle<270&&angle>90?"rotate(180 "+rad+" 0)":null:"rotate("+(angle<=180&&angle>0?-90:90)+" "+rad+" 0)"}}).style({"text-anchor":"middle",display:axisConfig.angularAxis.labelsVisible?"block":"none"}).text(function(d,i){return i%(axisConfig.minorTicks+1)!=0?"":ticks?ticks[d]+axisConfig.angularAxis.ticksSuffix:d+axisConfig.angularAxis.ticksSuffix}).style(fontStyle);axisConfig.angularAxis.rewriteTicks&&ticksText.text(function(d,i){return i%(axisConfig.minorTicks+1)!=0?"":axisConfig.angularAxis.rewriteTicks(this.textContent,i)});var rightmostTickEndX=_$d3_127.max(chartGroup.selectAll(".angular-tick text")[0].map(function(d,i){return d.getCTM().e+d.getBBox().width}));legendContainer.attr({transform:"translate("+[radius+rightmostTickEndX,axisConfig.margin.top]+")"});var hasGeometry=svg.select("g.geometry-group").selectAll("g").size()>0,geometryContainer=svg.select("g.geometry-group").selectAll("g.geometry").data(data);if(geometryContainer.enter().append("g").attr({class:function(d,i){return"geometry geometry"+i}}),geometryContainer.exit().remove(),data[0]||hasGeometry){var geometryConfigs=[];data.forEach(function(d,i){var geometryConfig={};geometryConfig.radialScale=radialScale,geometryConfig.angularScale=angularScale,geometryConfig.container=geometryContainer.filter(function(dB,iB){return iB==i}),geometryConfig.geometry=d.geometry,geometryConfig.orientation=axisConfig.orientation,geometryConfig.direction=axisConfig.direction,geometryConfig.index=i,geometryConfigs.push({data:d,geometryConfig:geometryConfig})});var geometryConfigsGrouped2=[];_$d3_127.nest().key(function(d,i){return void 0!==d.data.groupId||"unstacked"}).entries(geometryConfigs).forEach(function(d,i){"unstacked"===d.key?geometryConfigsGrouped2=geometryConfigsGrouped2.concat(d.values.map(function(d,i){return[d]})):geometryConfigsGrouped2.push(d.values)}),geometryConfigsGrouped2.forEach(function(d,i){var geometry;geometry=Array.isArray(d)?d[0].geometryConfig.geometry:d.geometryConfig.geometry;var finalGeometryConfig=d.map(function(dB,iB){return __extendDeepAll_656(µ[geometry].defaultConfig(),dB)});µ[geometry]().config(finalGeometryConfig)()})}var angularValue,radialValue,guides=svg.select(".guides-group"),tooltipContainer=svg.select(".tooltips-group"),angularTooltip=µ.tooltipPanel().config({container:tooltipContainer,fontSize:8})(),radialTooltip=µ.tooltipPanel().config({container:tooltipContainer,fontSize:8})(),geometryTooltip=µ.tooltipPanel().config({container:tooltipContainer,hasTick:!0})();if(!isOrdinal){var angularGuideLine=guides.select("line").attr({x1:0,y1:0,y2:0}).style({stroke:"grey","pointer-events":"none"});chartGroup.on("mousemove.angular-guide",function(d,i){var mouseAngle=µ.util.getMousePos(backgroundCircle).angle;angularGuideLine.attr({x2:-radius,transform:"rotate("+mouseAngle+")"}).style({opacity:.5});var angleWithOriginOffset=(mouseAngle+180+360-axisConfig.orientation)%360;angularValue=angularScale.invert(angleWithOriginOffset);var pos=µ.util.convertToCartesian(radius+12,mouseAngle+180);angularTooltip.text(µ.util.round(angularValue)).move([pos[0]+chartCenter[0],pos[1]+chartCenter[1]])}).on("mouseout.angular-guide",function(d,i){guides.select("line").style({opacity:0})})}var angularGuideCircle=guides.select("circle").style({stroke:"grey",fill:"none"});chartGroup.on("mousemove.radial-guide",function(d,i){var r=µ.util.getMousePos(backgroundCircle).radius;angularGuideCircle.attr({r:r}).style({opacity:.5}),radialValue=radialScale.invert(µ.util.getMousePos(backgroundCircle).radius);var pos=µ.util.convertToCartesian(r,axisConfig.radialAxis.orientation);radialTooltip.text(µ.util.round(radialValue)).move([pos[0]+chartCenter[0],pos[1]+chartCenter[1]])}).on("mouseout.radial-guide",function(d,i){angularGuideCircle.style({opacity:0}),geometryTooltip.hide(),angularTooltip.hide(),radialTooltip.hide()}),svg.selectAll(".geometry-group .mark").on("mouseover.tooltip",function(d,i){var el=_$d3_127.select(this),color=this.style.fill,newColor="black",opacity=this.style.opacity||1;if(el.attr({"data-opacity":opacity}),color&&"none"!==color){el.attr({"data-fill":color}),newColor=_$d3_127.hsl(color).darker().toString(),el.style({fill:newColor,opacity:1});var textData={t:µ.util.round(d[0]),r:µ.util.round(d[1])};isOrdinal&&(textData.t=ticks[d[0]]);var text="t: "+textData.t+", r: "+textData.r,bbox=this.getBoundingClientRect(),svgBBox=svg.node().getBoundingClientRect(),pos=[bbox.left+bbox.width/2-centeringOffset[0]-svgBBox.left,bbox.top+bbox.height/2-centeringOffset[1]-svgBBox.top];geometryTooltip.config({color:newColor}).text(text),geometryTooltip.move(pos)}else color=this.style.stroke||"black",el.attr({"data-stroke":color}),newColor=_$d3_127.hsl(color).darker().toString(),el.style({stroke:newColor,opacity:1})}).on("mousemove.tooltip",function(d,i){if(0!=_$d3_127.event.which)return!1;_$d3_127.select(this).attr("data-fill")&&geometryTooltip.show()}).on("mouseout.tooltip",function(d,i){geometryTooltip.hide();var el=_$d3_127.select(this),fillColor=el.attr("data-fill");fillColor?el.style({fill:fillColor,opacity:el.attr("data-opacity")}):el.style({stroke:el.attr("data-stroke"),opacity:el.attr("data-opacity")})})}),exports}(_container),this},exports.config=function(_x){if(!arguments.length)return config;var xClone=µ.util.cloneJson(_x);return xClone.data.forEach(function(d,i){config.data[i]||(config.data[i]={}),__extendDeepAll_656(config.data[i],µ.Axis.defaultConfig().data[0]),__extendDeepAll_656(config.data[i],d)}),__extendDeepAll_656(config.layout,µ.Axis.defaultConfig().layout),__extendDeepAll_656(config.layout,xClone.layout),this},exports.getLiveConfig=function(){return liveConfig},exports.getinputConfig=function(){return inputConfig},exports.radialScale=function(_x){return radialScale},exports.angularScale=function(_x){return angularScale},exports.svg=function(){return svg},_$d3_127.rebind(exports,dispatch,"on"),exports},µ.Axis.defaultConfig=function(d,i){return{data:[{t:[1,2,3,4],r:[10,11,12,13],name:"Line1",geometry:"LinePlot",color:null,strokeDash:"solid",strokeColor:null,strokeSize:"1",visibleInLegend:!0,opacity:1}],layout:{defaultColorRange:_$d3_127.scale.category10().range(),title:null,height:450,width:500,margin:{top:40,right:40,bottom:40,left:40},font:{size:12,color:"gray",outlineColor:"white",family:"Tahoma, sans-serif"},direction:"clockwise",orientation:0,labelOffset:10,radialAxis:{domain:null,orientation:-45,ticksSuffix:"",visible:!0,gridLinesVisible:!0,tickOrientation:"horizontal",rewriteTicks:null},angularAxis:{domain:[0,360],ticksSuffix:"",visible:!0,gridLinesVisible:!0,labelsVisible:!0,tickOrientation:"horizontal",rewriteTicks:null,ticksCount:null,ticksStep:null},minorTicks:0,tickLength:null,tickColor:"silver",minorTickColor:"#eee",backgroundColor:"none",needsEndSpacing:null,showLegend:!0,legend:{reverseOrder:!1},opacity:1}}},µ.util={},µ.DATAEXTENT="dataExtent",µ.AREA="AreaChart",µ.LINE="LinePlot",µ.DOT="DotPlot",µ.BAR="BarChart",µ.util._override=function(_objA,_objB){for(var x in _objA)x in _objB&&(_objB[x]=_objA[x])},µ.util._extend=function(_objA,_objB){for(var x in _objA)_objB[x]=_objA[x]},µ.util._rndSnd=function(){return 2*Math.random()-1+(2*Math.random()-1)+(2*Math.random()-1)},µ.util.dataFromEquation2=function(_equation,_step){var step=_step||6;return _$d3_127.range(0,360+step,step).map(function(deg,index){var theta=deg*Math.PI/180;return[deg,_equation(theta)]})},µ.util.dataFromEquation=function(_equation,_step,_name){var step=_step||6,t=[],r=[];_$d3_127.range(0,360+step,step).forEach(function(deg,index){var theta=deg*Math.PI/180,radius=_equation(theta);t.push(deg),r.push(radius)});var result={t:t,r:r};return _name&&(result.name=_name),result},µ.util.ensureArray=function(_val,_count){if(void 0===_val)return null;var arr=[].concat(_val);return _$d3_127.range(_count).map(function(d,i){return arr[i]||arr[0]})},µ.util.fillArrays=function(_obj,_valueNames,_count){return _valueNames.forEach(function(d,i){_obj[d]=µ.util.ensureArray(_obj[d],_count)}),_obj},µ.util.cloneJson=function(json){return JSON.parse(JSON.stringify(json))},µ.util.validateKeys=function(obj,keys){"string"==typeof keys&&(keys=keys.split("."));var next=keys.shift();return obj[next]&&(!keys.length||objHasKeys(obj[next],keys))},µ.util.sumArrays=function(a,b){return _$d3_127.zip(a,b).map(function(d,i){return _$d3_127.sum(d)})},µ.util.arrayLast=function(a){return a[a.length-1]},µ.util.arrayEqual=function(a,b){for(var i=Math.max(a.length,b.length,1);i-- >=0&&a[i]===b[i];);return-2===i},µ.util.flattenArray=function(arr){for(var r=[];!µ.util.arrayEqual(r,arr);)r=arr,arr=[].concat.apply([],arr);return arr},µ.util.deduplicate=function(arr){return arr.filter(function(v,i,a){return a.indexOf(v)==i})},µ.util.convertToCartesian=function(radius,theta){var thetaRadians=theta*Math.PI/180;return[radius*Math.cos(thetaRadians),radius*Math.sin(thetaRadians)]},µ.util.round=function(_value,_digits){var digits=_digits||2,mult=Math.pow(10,digits);return Math.round(_value*mult)/mult},µ.util.getMousePos=function(_referenceElement){var mousePos=_$d3_127.mouse(_referenceElement.node()),mouseX=mousePos[0],mouseY=mousePos[1],mouse={};return mouse.x=mouseX,mouse.y=mouseY,mouse.pos=mousePos,mouse.angle=180*(Math.atan2(mouseY,mouseX)+Math.PI)/Math.PI,mouse.radius=Math.sqrt(mouseX*mouseX+mouseY*mouseY),mouse},µ.util.duplicatesCount=function(arr){for(var val,uniques={},dups={},i=0,len=arr.length;i<len;i++)(val=arr[i])in uniques?(uniques[val]++,dups[val]=uniques[val]):uniques[val]=1;return dups},µ.util.duplicates=function(arr){return Object.keys(µ.util.duplicatesCount(arr))},µ.util.translator=function(obj,sourceBranch,targetBranch,reverse){if(reverse){var targetBranchCopy=targetBranch.slice();targetBranch=sourceBranch,sourceBranch=targetBranchCopy}var value=sourceBranch.reduce(function(previousValue,currentValue){if(void 0!==previousValue)return previousValue[currentValue]},obj);void 0!==value&&(sourceBranch.reduce(function(previousValue,currentValue,index){if(void 0!==previousValue)return index===sourceBranch.length-1&&delete previousValue[currentValue],previousValue[currentValue]},obj),targetBranch.reduce(function(previousValue,currentValue,index){return void 0===previousValue[currentValue]&&(previousValue[currentValue]={}),index===targetBranch.length-1&&(previousValue[currentValue]=value),previousValue[currentValue]},obj))},µ.PolyChart=function module(){var config=[µ.PolyChart.defaultConfig()],dispatch=_$d3_127.dispatch("hover"),dashArray={solid:"none",dash:[5,2],dot:[2,5]};function exports(){var geometryConfig=config[0].geometryConfig,container=geometryConfig.container;"string"==typeof container&&(container=_$d3_127.select(container)),container.datum(config).each(function(_config,_index){var isStack=!!_config[0].data.yStack,data=_config.map(function(d,i){return isStack?_$d3_127.zip(d.data.t[0],d.data.r[0],d.data.yStack[0]):_$d3_127.zip(d.data.t[0],d.data.r[0])}),angularScale=geometryConfig.angularScale,domainMin=geometryConfig.radialScale.domain()[0],generator={bar:function(d,i,pI){var dataConfig=_config[pI].data,h=geometryConfig.radialScale(d[1])-geometryConfig.radialScale(0),stackTop=geometryConfig.radialScale(d[2]||0),w=dataConfig.barWidth;_$d3_127.select(this).attr({class:"mark bar",d:"M"+[[h+stackTop,-w/2],[h+stackTop,w/2],[stackTop,w/2],[stackTop,-w/2]].join("L")+"Z",transform:function(d,i){return"rotate("+(geometryConfig.orientation+angularScale(d[0]))+")"}})}};generator.dot=function(d,i,pI){var stackedData=d[2]?[d[0],d[1]+d[2]]:d,symbol=_$d3_127.svg.symbol().size(_config[pI].data.dotSize).type(_config[pI].data.dotType)(d,i);_$d3_127.select(this).attr({class:"mark dot",d:symbol,transform:function(d,i){var coord=function convertToCartesian(polarCoordinates){var x=polarCoordinates.r*Math.cos(polarCoordinates.t),y=polarCoordinates.r*Math.sin(polarCoordinates.t);return{x:x,y:y}}(function getPolarCoordinates(d,i){var r=geometryConfig.radialScale(d[1]),t=(geometryConfig.angularScale(d[0])+geometryConfig.orientation)*Math.PI/180;return{r:r,t:t}}(stackedData));return"translate("+[coord.x,coord.y]+")"}})};var line=_$d3_127.svg.line.radial().interpolate(_config[0].data.lineInterpolation).radius(function(d){return geometryConfig.radialScale(d[1])}).angle(function(d){return geometryConfig.angularScale(d[0])*Math.PI/180});generator.line=function(d,i,pI){var lineData=d[2]?data[pI].map(function(d,i){return[d[0],d[1]+d[2]]}):data[pI];if(_$d3_127.select(this).each(generator.dot).style({opacity:function(dB,iB){return+_config[pI].data.dotVisible},fill:markStyle.stroke(d,i,pI)}).attr({class:"mark dot"}),!(i>0)){var lineSelection=_$d3_127.select(this.parentNode).selectAll("path.line").data([0]);lineSelection.enter().insert("path"),lineSelection.attr({class:"line",d:line(lineData),transform:function(dB,iB){return"rotate("+(geometryConfig.orientation+90)+")"},"pointer-events":"none"}).style({fill:function(dB,iB){return markStyle.fill(d,i,pI)},"fill-opacity":0,stroke:function(dB,iB){return markStyle.stroke(d,i,pI)},"stroke-width":function(dB,iB){return markStyle["stroke-width"](d,i,pI)},"stroke-dasharray":function(dB,iB){return markStyle["stroke-dasharray"](d,i,pI)},opacity:function(dB,iB){return markStyle.opacity(d,i,pI)},display:function(dB,iB){return markStyle.display(d,i,pI)}})}};var angularRange=geometryConfig.angularScale.range(),triangleAngle=Math.abs(angularRange[1]-angularRange[0])/data[0].length*Math.PI/180,arc=_$d3_127.svg.arc().startAngle(function(d){return-triangleAngle/2}).endAngle(function(d){return triangleAngle/2}).innerRadius(function(d){return geometryConfig.radialScale(domainMin+(d[2]||0))}).outerRadius(function(d){return geometryConfig.radialScale(domainMin+(d[2]||0))+geometryConfig.radialScale(d[1])});generator.arc=function(d,i,pI){_$d3_127.select(this).attr({class:"mark arc",d:arc,transform:function(d,i){return"rotate("+(geometryConfig.orientation+angularScale(d[0])+90)+")"}})};var markStyle={fill:function(d,i,pI){return _config[pI].data.color},stroke:function(d,i,pI){return _config[pI].data.strokeColor},"stroke-width":function(d,i,pI){return _config[pI].data.strokeSize+"px"},"stroke-dasharray":function(d,i,pI){return dashArray[_config[pI].data.strokeDash]},opacity:function(d,i,pI){return _config[pI].data.opacity},display:function(d,i,pI){return void 0===_config[pI].data.visible||_config[pI].data.visible?"block":"none"}},geometryLayer=_$d3_127.select(this).selectAll("g.layer").data(data);geometryLayer.enter().append("g").attr({class:"layer"});var geometry=geometryLayer.selectAll("path.mark").data(function(d,i){return d});geometry.enter().append("path").attr({class:"mark"}),geometry.style(markStyle).each(generator[geometryConfig.geometryType]),geometry.exit().remove(),geometryLayer.exit().remove()})}return exports.config=function(_x){return arguments.length?(_x.forEach(function(d,i){config[i]||(config[i]={}),__extendDeepAll_656(config[i],µ.PolyChart.defaultConfig()),__extendDeepAll_656(config[i],d)}),this):config},exports.getColorScale=function(){},_$d3_127.rebind(exports,dispatch,"on"),exports},µ.PolyChart.defaultConfig=function(){return{data:{name:"geom1",t:[[1,2,3,4]],r:[[1,2,3,4]],dotType:"circle",dotSize:64,dotVisible:!1,barWidth:20,color:"#ffa500",strokeSize:1,strokeColor:"silver",strokeDash:"solid",opacity:1,index:0,visible:!0,visibleInLegend:!0},geometryConfig:{geometry:"LinePlot",geometryType:"arc",direction:"clockwise",orientation:0,container:"body",radialScale:null,angularScale:null,colorScale:_$d3_127.scale.category20()}}},µ.BarChart=function module(){return µ.PolyChart()},µ.BarChart.defaultConfig=function(){return{geometryConfig:{geometryType:"bar"}}},µ.AreaChart=function module(){return µ.PolyChart()},µ.AreaChart.defaultConfig=function(){return{geometryConfig:{geometryType:"arc"}}},µ.DotPlot=function module(){return µ.PolyChart()},µ.DotPlot.defaultConfig=function(){return{geometryConfig:{geometryType:"dot",dotType:"circle"}}},µ.LinePlot=function module(){return µ.PolyChart()},µ.LinePlot.defaultConfig=function(){return{geometryConfig:{geometryType:"line"}}},µ.Legend=function module(){var config=µ.Legend.defaultConfig(),dispatch=_$d3_127.dispatch("hover");function exports(){var legendConfig=config.legendConfig,flattenData=config.data.map(function(d,i){return[].concat(d).map(function(dB,iB){var element=__extendDeepAll_656({},legendConfig.elements[i]);return element.name=dB,element.color=[].concat(legendConfig.elements[i].color)[iB],element})}),data=_$d3_127.merge(flattenData);data=data.filter(function(d,i){return legendConfig.elements[i]&&(legendConfig.elements[i].visibleInLegend||void 0===legendConfig.elements[i].visibleInLegend)}),legendConfig.reverseOrder&&(data=data.reverse());var container=legendConfig.container;("string"==typeof container||container.nodeName)&&(container=_$d3_127.select(container));var colors=data.map(function(d,i){return d.color}),lineHeight=legendConfig.fontSize,isContinuous=null==legendConfig.isContinuous?"number"==typeof data[0]:legendConfig.isContinuous,height=isContinuous?legendConfig.height:lineHeight*data.length,svg=container.classed("legend-group",!0).selectAll("svg").data([0]),svgEnter=svg.enter().append("svg").attr({width:300,height:height+lineHeight,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"});svgEnter.append("g").classed("legend-axis",!0),svgEnter.append("g").classed("legend-marks",!0);var dataNumbered=_$d3_127.range(data.length),colorScale=_$d3_127.scale[isContinuous?"linear":"ordinal"]().domain(dataNumbered).range(colors),dataScale=_$d3_127.scale[isContinuous?"linear":"ordinal"]().domain(dataNumbered)[isContinuous?"range":"rangePoints"]([0,height]);if(isContinuous){var gradient=svg.select(".legend-marks").append("defs").append("linearGradient").attr({id:"grad1",x1:"0%",y1:"0%",x2:"0%",y2:"100%"}).selectAll("stop").data(colors);gradient.enter().append("stop"),gradient.attr({offset:function(d,i){return i/(colors.length-1)*100+"%"}}).style({"stop-color":function(d,i){return d}}),svg.append("rect").classed("legend-mark",!0).attr({height:legendConfig.height,width:legendConfig.colorBandWidth,fill:"url(#grad1)"})}else{var legendElement=svg.select(".legend-marks").selectAll("path.legend-mark").data(data);legendElement.enter().append("path").classed("legend-mark",!0),legendElement.attr({transform:function(d,i){return"translate("+[lineHeight/2,dataScale(i)+lineHeight/2]+")"},d:function(d,i){var _type,_size,squareSize,symbolType=d.symbol;return squareSize=3*(_size=lineHeight),"line"===(_type=symbolType)?"M"+[[-_size/2,-_size/12],[_size/2,-_size/12],[_size/2,_size/12],[-_size/2,_size/12]]+"Z":-1!=_$d3_127.svg.symbolTypes.indexOf(_type)?_$d3_127.svg.symbol().type(_type).size(squareSize)():_$d3_127.svg.symbol().type("square").size(squareSize)()},fill:function(d,i){return colorScale(i)}}),legendElement.exit().remove()}var legendAxis=_$d3_127.svg.axis().scale(dataScale).orient("right"),axis=svg.select("g.legend-axis").attr({transform:"translate("+[isContinuous?legendConfig.colorBandWidth:lineHeight,lineHeight/2]+")"}).call(legendAxis);return axis.selectAll(".domain").style({fill:"none",stroke:"none"}),axis.selectAll("line").style({fill:"none",stroke:isContinuous?legendConfig.textColor:"none"}),axis.selectAll("text").style({fill:legendConfig.textColor,"font-size":legendConfig.fontSize}).text(function(d,i){return data[i].name}),exports}return exports.config=function(_x){return arguments.length?(__extendDeepAll_656(config,_x),this):config},_$d3_127.rebind(exports,dispatch,"on"),exports},µ.Legend.defaultConfig=function(d,i){return{data:["a","b","c"],legendConfig:{elements:[{symbol:"line",color:"red"},{symbol:"square",color:"yellow"},{symbol:"diamond",color:"limegreen"}],height:150,colorBandWidth:30,fontSize:12,container:"body",isContinuous:null,textColor:"grey",reverseOrder:!1}}},µ.tooltipPanel=function(){var tooltipEl,tooltipTextEl,backgroundEl,config={container:null,hasTick:!1,fontSize:12,color:"white",padding:5},id="tooltip-"+µ.tooltipPanel.uid++,tickSize=10,exports=function(){var tooltipEnter=(tooltipEl=config.container.selectAll("g."+id).data([0])).enter().append("g").classed(id,!0).style({"pointer-events":"none",display:"none"});return backgroundEl=tooltipEnter.append("path").style({fill:"white","fill-opacity":.9}).attr({d:"M0 0"}),tooltipTextEl=tooltipEnter.append("text").attr({dx:config.padding+tickSize,dy:.3*+config.fontSize}),exports};return exports.text=function(_text){var l=_$d3_127.hsl(config.color).l,strokeColor=l>=.5?"#aaa":"white",fillColor=l>=.5?"black":"white",text=_text||"";tooltipTextEl.style({fill:fillColor,"font-size":config.fontSize+"px"}).text(text);var padding=config.padding,bbox=tooltipTextEl.node().getBBox(),boxStyle={fill:config.color,stroke:strokeColor,"stroke-width":"2px"},backGroundW=bbox.width+2*padding+tickSize,backGroundH=bbox.height+2*padding;return backgroundEl.attr({d:"M"+[[tickSize,-backGroundH/2],[tickSize,-backGroundH/4],[config.hasTick?0:tickSize,0],[tickSize,backGroundH/4],[tickSize,backGroundH/2],[backGroundW,backGroundH/2],[backGroundW,-backGroundH/2]].join("L")+"Z"}).style(boxStyle),tooltipEl.attr({transform:"translate("+[tickSize,-backGroundH/2+2*padding]+")"}),tooltipEl.style({display:"block"}),exports},exports.move=function(_pos){if(tooltipEl)return tooltipEl.attr({transform:"translate("+[_pos[0],_pos[1]]+")"}).style({display:"block"}),exports},exports.hide=function(){if(tooltipEl)return tooltipEl.style({display:"none"}),exports},exports.show=function(){if(tooltipEl)return tooltipEl.style({display:"block"}),exports},exports.config=function(_x){return __extendDeepAll_656(config,_x),exports},exports},µ.tooltipPanel.uid=1,µ.adapter={},µ.adapter.plotly=function module(){var exports={convert:function(_inputConfig,reverse){var outputConfig={};if(_inputConfig.data&&(outputConfig.data=_inputConfig.data.map(function(d,i){var r=__extendDeepAll_656({},d);return[[r,["marker","color"],["color"]],[r,["marker","opacity"],["opacity"]],[r,["marker","line","color"],["strokeColor"]],[r,["marker","line","dash"],["strokeDash"]],[r,["marker","line","width"],["strokeSize"]],[r,["marker","symbol"],["dotType"]],[r,["marker","size"],["dotSize"]],[r,["marker","barWidth"],["barWidth"]],[r,["line","interpolation"],["lineInterpolation"]],[r,["showlegend"],["visibleInLegend"]]].forEach(function(d,i){µ.util.translator.apply(null,d.concat(reverse))}),reverse||delete r.marker,reverse&&delete r.groupId,reverse?("LinePlot"===r.geometry?(r.type="scatter",!0===r.dotVisible?(delete r.dotVisible,r.mode="lines+markers"):r.mode="lines"):"DotPlot"===r.geometry?(r.type="scatter",r.mode="markers"):"AreaChart"===r.geometry?r.type="area":"BarChart"===r.geometry&&(r.type="bar"),delete r.geometry):("scatter"===r.type?"lines"===r.mode?r.geometry="LinePlot":"markers"===r.mode?r.geometry="DotPlot":"lines+markers"===r.mode&&(r.geometry="LinePlot",r.dotVisible=!0):"area"===r.type?r.geometry="AreaChart":"bar"===r.type&&(r.geometry="BarChart"),delete r.mode,delete r.type),r}),!reverse&&_inputConfig.layout&&"stack"===_inputConfig.layout.barmode)){var duplicates=µ.util.duplicates(outputConfig.data.map(function(d,i){return d.geometry}));outputConfig.data.forEach(function(d,i){var idx=duplicates.indexOf(d.geometry);-1!=idx&&(outputConfig.data[i].groupId=idx)})}if(_inputConfig.layout){var r=__extendDeepAll_656({},_inputConfig.layout);if([[r,["plot_bgcolor"],["backgroundColor"]],[r,["showlegend"],["showLegend"]],[r,["radialaxis"],["radialAxis"]],[r,["angularaxis"],["angularAxis"]],[r.angularaxis,["showline"],["gridLinesVisible"]],[r.angularaxis,["showticklabels"],["labelsVisible"]],[r.angularaxis,["nticks"],["ticksCount"]],[r.angularaxis,["tickorientation"],["tickOrientation"]],[r.angularaxis,["ticksuffix"],["ticksSuffix"]],[r.angularaxis,["range"],["domain"]],[r.angularaxis,["endpadding"],["endPadding"]],[r.radialaxis,["showline"],["gridLinesVisible"]],[r.radialaxis,["tickorientation"],["tickOrientation"]],[r.radialaxis,["ticksuffix"],["ticksSuffix"]],[r.radialaxis,["range"],["domain"]],[r.angularAxis,["showline"],["gridLinesVisible"]],[r.angularAxis,["showticklabels"],["labelsVisible"]],[r.angularAxis,["nticks"],["ticksCount"]],[r.angularAxis,["tickorientation"],["tickOrientation"]],[r.angularAxis,["ticksuffix"],["ticksSuffix"]],[r.angularAxis,["range"],["domain"]],[r.angularAxis,["endpadding"],["endPadding"]],[r.radialAxis,["showline"],["gridLinesVisible"]],[r.radialAxis,["tickorientation"],["tickOrientation"]],[r.radialAxis,["ticksuffix"],["ticksSuffix"]],[r.radialAxis,["range"],["domain"]],[r.font,["outlinecolor"],["outlineColor"]],[r.legend,["traceorder"],["reverseOrder"]],[r,["labeloffset"],["labelOffset"]],[r,["defaultcolorrange"],["defaultColorRange"]]].forEach(function(d,i){µ.util.translator.apply(null,d.concat(reverse))}),reverse?(void 0!==r.tickLength&&(r.angularaxis.ticklen=r.tickLength,delete r.tickLength),r.tickColor&&(r.angularaxis.tickcolor=r.tickColor,delete r.tickColor)):(r.angularAxis&&void 0!==r.angularAxis.ticklen&&(r.tickLength=r.angularAxis.ticklen),r.angularAxis&&void 0!==r.angularAxis.tickcolor&&(r.tickColor=r.angularAxis.tickcolor)),r.legend&&"boolean"!=typeof r.legend.reverseOrder&&(r.legend.reverseOrder="normal"!=r.legend.reverseOrder),r.legend&&"boolean"==typeof r.legend.traceorder&&(r.legend.traceorder=r.legend.traceorder?"reversed":"normal",delete r.legend.reverseOrder),r.margin&&void 0!==r.margin.t){var source=["t","r","b","l","pad"],target=["top","right","bottom","left","pad"],margin={};_$d3_127.entries(r.margin).forEach(function(dB,iB){margin[target[source.indexOf(dB.key)]]=dB.value}),r.margin=margin}reverse&&(delete r.needsEndSpacing,delete r.minorTickColor,delete r.minorTicks,delete r.angularaxis.ticksCount,delete r.angularaxis.ticksCount,delete r.angularaxis.ticksStep,delete r.angularaxis.rewriteTicks,delete r.angularaxis.nticks,delete r.radialaxis.ticksCount,delete r.radialaxis.ticksCount,delete r.radialaxis.ticksStep,delete r.radialaxis.rewriteTicks,delete r.radialaxis.nticks),outputConfig.layout=r}return outputConfig}};return exports};var _$micropolar_manager_657,__extendDeepAll_657=_$lib_539.extendDeepAll,manager=_$micropolar_manager_657={};manager.framework=function(_gd){var config,previousConfigClone,plot,convertedInput,container,undoManager=new function UndoManager(){var callback,undoCommands=[],index=-1,isExecuting=!1;function execute(command,action){return command?(isExecuting=!0,command[action](),isExecuting=!1,this):this}return{add:function(command){return isExecuting?this:(undoCommands.splice(index+1,undoCommands.length-index),undoCommands.push(command),index=undoCommands.length-1,this)},setCallback:function(callbackFunc){callback=callbackFunc},undo:function(){var command=undoCommands[index];return command?(execute(command,"undo"),index-=1,callback&&callback(command.undo),this):this},redo:function(){var command=undoCommands[index+1];return command?(execute(command,"redo"),index+=1,callback&&callback(command.redo),this):this},clear:function(){undoCommands=[],index=-1},hasUndo:function(){return-1!==index},hasRedo:function(){return index<undoCommands.length-1},getCommands:function(){return undoCommands},getPreviousCommand:function(){return undoCommands[index-1]},getIndex:function(){return index}}};function exports(_inputConfig,_container){return _container&&(container=_container),_$d3_127.select(_$d3_127.select(container).node().parentNode).selectAll(".svg-container>*:not(.chart-root)").remove(),config=config?__extendDeepAll_657(config,_inputConfig):_inputConfig,plot||(plot=_$micropolar_656.Axis()),convertedInput=_$micropolar_656.adapter.plotly().convert(config),plot.config(convertedInput).render(container),_gd.data=config.data,_gd.layout=config.layout,manager.fillLayout(_gd),config}return exports.isPolar=!0,exports.svg=function(){return plot.svg()},exports.getConfig=function(){return config},exports.getLiveConfig=function(){return _$micropolar_656.adapter.plotly().convert(plot.getLiveConfig(),!0)},exports.getLiveScales=function(){return{t:plot.angularScale(),r:plot.radialScale()}},exports.setUndoPoint=function(){var _configClone,_previousConfigClone,that=this,configClone=_$micropolar_656.util.cloneJson(config);_configClone=configClone,_previousConfigClone=previousConfigClone,undoManager.add({undo:function(){_previousConfigClone&&that(_previousConfigClone)},redo:function(){that(_configClone)}}),previousConfigClone=_$micropolar_656.util.cloneJson(configClone)},exports.undo=function(){undoManager.undo()},exports.redo=function(){undoManager.redo()},exports},manager.fillLayout=function(_gd){var container=_$d3_127.select(_gd).selectAll(".plot-container"),paperDiv=container.selectAll(".svg-container"),paper=_gd.framework&&_gd.framework.svg&&_gd.framework.svg(),dflts={width:800,height:600,paper_bgcolor:_$color_411.background,_container:container,_paperdiv:paperDiv,_paper:paper};_gd._fullLayout=__extendDeepAll_657(dflts,_gd.layout)};var _$legacy_655={};(_$legacy_655=_$micropolar_656).manager=_$micropolar_manager_657;var _$plot_api_573={},enforceAxisConstraints=_$constraints_591.enforce,cleanAxisConstraints=_$constraints_591.clean,__doAutoRange_573=_$autorange___doAutoRange,numericNameWarningCount=0;function setBackground(gd,bgColor){try{gd._fullLayout._paper.style("background",bgColor)}catch(e){_$lib_539.error(e)}}function opaqueSetBackground(gd,bgColor){setBackground(gd,_$color_411.combine(bgColor,"white"))}function setPlotContext(gd,config){gd._context||(gd._context=_$lib_539.extendDeep({},_$plot_config_574));var i,keys,key,context=gd._context;if(config){for(keys=Object.keys(config),i=0;i<keys.length;i++)"editable"!==(key=keys[i])&&"edits"!==key&&key in context&&("setBackground"===key&&"opaque"===config[key]?context[key]=opaqueSetBackground:context[key]=config[key]);config.plot3dPixelRatio&&!context.plotGlPixelRatio&&(context.plotGlPixelRatio=context.plot3dPixelRatio);var editable=config.editable;if(void 0!==editable)for(context.editable=editable,keys=Object.keys(context.edits),i=0;i<keys.length;i++)context.edits[keys[i]]=editable;if(config.edits)for(keys=Object.keys(config.edits),i=0;i<keys.length;i++)(key=keys[i])in context.edits&&(context.edits[key]=config.edits[key])}context.staticPlot&&(context.editable=!1,context.edits={},context.autosizable=!1,context.scrollZoom=!1,context.doubleClick=!1,context.showTips=!1,context.showLink=!1,context.displayModeBar=!1),"hover"!==context.displayModeBar||_$hasHover_239||(context.displayModeBar=!0),"transparent"!==context.setBackground&&"function"==typeof context.setBackground||(context.setBackground=setBackground)}function positivifyIndices(indices,maxIndex){var i,index,parentLength=maxIndex+1,positiveIndices=[];for(i=0;i<indices.length;i++)(index=indices[i])<0?positiveIndices.push(parentLength+index):positiveIndices.push(index);return positiveIndices}function assertIndexArray(gd,indices,arrayName){var i,index;for(i=0;i<indices.length;i++){if((index=indices[i])!==parseInt(index,10))throw new Error("all values in "+arrayName+" must be integers");if(index>=gd.data.length||index<-gd.data.length)throw new Error(arrayName+" must be valid indices for gd.data.");if(indices.indexOf(index,i+1)>-1||index>=0&&indices.indexOf(-gd.data.length+index)>-1||index<0&&indices.indexOf(gd.data.length+index)>-1)throw new Error("each index in "+arrayName+" must be unique.")}}function checkMoveTracesArgs(gd,currentIndices,newIndices){if(!Array.isArray(gd.data))throw new Error("gd.data must be an array.");if(void 0===currentIndices)throw new Error("currentIndices is a required argument.");if(Array.isArray(currentIndices)||(currentIndices=[currentIndices]),assertIndexArray(gd,currentIndices,"currentIndices"),void 0===newIndices||Array.isArray(newIndices)||(newIndices=[newIndices]),void 0!==newIndices&&assertIndexArray(gd,newIndices,"newIndices"),void 0!==newIndices&&currentIndices.length!==newIndices.length)throw new Error("current and new indices must be of equal length.")}function spliceTraces(gd,update,indices,maxPoints,updateArray){!function assertExtendTracesArgs(gd,update,indices,maxPoints){var maxPointsIsObject=_$lib_539.isPlainObject(maxPoints);if(!Array.isArray(gd.data))throw new Error("gd.data must be an array");if(!_$lib_539.isPlainObject(update))throw new Error("update must be a key:value object");if(void 0===indices)throw new Error("indices must be an integer or array of integers");for(var key in assertIndexArray(gd,indices,"indices"),update){if(!Array.isArray(update[key])||update[key].length!==indices.length)throw new Error("attribute "+key+" must be an array of length equal to indices array length");if(maxPointsIsObject&&(!(key in maxPoints)||!Array.isArray(maxPoints[key])||maxPoints[key].length!==update[key].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}}(gd,update,indices,maxPoints);for(var updateProps=function getExtendProperties(gd,update,indices,maxPoints){var trace,target,prop,insert,maxp,maxPointsIsObject=_$lib_539.isPlainObject(maxPoints),updateProps=[];for(var key in Array.isArray(indices)||(indices=[indices]),indices=positivifyIndices(indices,gd.data.length-1),update)for(var j=0;j<indices.length;j++){if(trace=gd.data[indices[j]],target=(prop=_$lib_539.nestedProperty(trace,key)).get(),insert=update[key][j],!_$lib_539.isArrayOrTypedArray(insert))throw new Error("attribute: "+key+" index: "+j+" must be an array");if(!_$lib_539.isArrayOrTypedArray(target))throw new Error("cannot extend missing or non-array attribute: "+key);if(target.constructor!==insert.constructor)throw new Error("cannot extend array with an array of a different type: "+key);maxp=maxPointsIsObject?maxPoints[key][j]:maxPoints,_$fastIsnumeric_139(maxp)||(maxp=-1),updateProps.push({prop:prop,target:target,insert:insert,maxp:Math.floor(maxp)})}return updateProps}(gd,update,indices,maxPoints),undoUpdate={},undoPoints={},i=0;i<updateProps.length;i++){var prop=updateProps[i].prop,maxp=updateProps[i].maxp,out=updateArray(updateProps[i].target,updateProps[i].insert,maxp);prop.set(out[0]),Array.isArray(undoUpdate[prop.astr])||(undoUpdate[prop.astr]=[]),undoUpdate[prop.astr].push(out[1]),Array.isArray(undoPoints[prop.astr])||(undoPoints[prop.astr]=[]),undoPoints[prop.astr].push(updateProps[i].target.length)}return{update:undoUpdate,maxPoints:undoPoints}}function concatTypedArray(arr0,arr1){var arr2=new arr0.constructor(arr0.length+arr1.length);return arr2.set(arr0),arr2.set(arr1,arr0.length),arr2}function undefinedToNull(val){return void 0===val?null:val}function _restyle(gd,aobj,traces){var i,axlist,fullLayout=gd._fullLayout,fullData=gd._fullData,data=gd.data,flags=_$edit_types_569.traceFlags(),redoit={},undoit={};function a0(){return traces.map(function(){})}function addToAxlist(axid){var axName=_$axes_584.id2name(axid);-1===axlist.indexOf(axName)&&axlist.push(axName)}function autorangeAttr(axName){return"LAYOUT"+axName+".autorange"}function rangeAttr(axName){return"LAYOUT"+axName+".range"}function doextra(attr,val,i){var extraparam;Array.isArray(attr)?attr.forEach(function(a){doextra(a,val,i)}):attr in aobj||_$helpers_570.hasParent(aobj,attr)||(extraparam="LAYOUT"===attr.substr(0,6)?_$lib_539.nestedProperty(gd.layout,attr.replace("LAYOUT","")):_$lib_539.nestedProperty(data[traces[i]],attr),attr in undoit||(undoit[attr]=a0()),void 0===undoit[attr][i]&&(undoit[attr][i]=undefinedToNull(extraparam.get())),void 0!==val&&extraparam.set(val))}for(var ai in aobj){if(_$helpers_570.hasParent(aobj,ai))throw new Error("cannot set "+ai+"and a parent attribute simultaneously");var cont,contFull,param,oldVal,newVal,valObject,vi=aobj[ai];if(redoit[ai]=vi,"LAYOUT"!==ai.substr(0,6)){for(undoit[ai]=a0(),i=0;i<traces.length;i++)if(cont=data[traces[i]],contFull=fullData[traces[i]],oldVal=(param=_$lib_539.nestedProperty(cont,ai)).get(),void 0!==(newVal=Array.isArray(vi)?vi[i%vi.length]:vi)){if((valObject=_$plot_schema_575.getTraceValObject(contFull,param.parts))&&valObject.impliedEdits&&null!==newVal)for(var impliedKey in valObject.impliedEdits)doextra(_$lib_539.relativeAttr(ai,impliedKey),valObject.impliedEdits[impliedKey],i);else if("colorbar.thicknessmode"===ai&&param.get()!==newVal&&-1!==["fraction","pixels"].indexOf(newVal)&&contFull.colorbar){var thicknorm=-1!==["top","bottom"].indexOf(contFull.colorbar.orient)?fullLayout.height-fullLayout.margin.t-fullLayout.margin.b:fullLayout.width-fullLayout.margin.l-fullLayout.margin.r;doextra("colorbar.thickness",contFull.colorbar.thickness*("fraction"===newVal?1/thicknorm:thicknorm),i)}else if("colorbar.lenmode"===ai&&param.get()!==newVal&&-1!==["fraction","pixels"].indexOf(newVal)&&contFull.colorbar){var lennorm=-1!==["top","bottom"].indexOf(contFull.colorbar.orient)?fullLayout.width-fullLayout.margin.l-fullLayout.margin.r:fullLayout.height-fullLayout.margin.t-fullLayout.margin.b;doextra("colorbar.len",contFull.colorbar.len*("fraction"===newVal?1/lennorm:lennorm),i)}else"colorbar.tick0"!==ai&&"colorbar.dtick"!==ai||doextra("colorbar.tickmode","linear",i);if("type"===ai&&"pie"===newVal!=("pie"===oldVal)){var labelsTo="x",valuesTo="y";"bar"!==newVal&&"bar"!==oldVal||"h"!==cont.orientation||(labelsTo="y",valuesTo="x"),_$lib_539.swapAttrs(cont,["?","?src"],"labels",labelsTo),_$lib_539.swapAttrs(cont,["d?","?0"],"label",labelsTo),_$lib_539.swapAttrs(cont,["?","?src"],"values",valuesTo),"pie"===oldVal?(_$lib_539.nestedProperty(cont,"marker.color").set(_$lib_539.nestedProperty(cont,"marker.colors").get()),fullLayout._pielayer.selectAll("g.trace").remove()):_$registry_668.traceIs(cont,"cartesian")&&_$lib_539.nestedProperty(cont,"marker.colors").set(_$lib_539.nestedProperty(cont,"marker.color").get())}undoit[ai][i]=undefinedToNull(oldVal);if(-1!==["swapxy","swapxyaxes","orientation","orientationaxes"].indexOf(ai)){if("orientation"===ai){param.set(newVal);var defaultOrientation=cont.x&&!cont.y?"h":"v";if((param.get()||defaultOrientation)===contFull.orientation)continue}else"orientationaxes"===ai&&(cont.orientation={v:"h",h:"v"}[contFull.orientation]);_$helpers_570.swapXYData(cont),flags.calc=flags.clearAxisTypes=!0}else-1!==_$plots_647.dataArrayContainers.indexOf(param.parts[0])?(_$helpers_570.manageArrayContainers(param,newVal,undoit),flags.calc=!0):(valObject?valObject.arrayOk&&(_$lib_539.isArrayOrTypedArray(newVal)||_$lib_539.isArrayOrTypedArray(oldVal))?flags.calc=!0:_$edit_types_569.update(flags,valObject):flags.calc=!0,param.set(newVal))}if(-1!==["swapxyaxes","orientationaxes"].indexOf(ai)&&_$axes_584.swap(gd,traces),"orientationaxes"===ai){var hovermode=_$lib_539.nestedProperty(gd.layout,"hovermode");"x"===hovermode.get()?hovermode.set("y"):"y"===hovermode.get()&&hovermode.set("x")}if(-1!==["orientation","type"].indexOf(ai)){for(axlist=[],i=0;i<traces.length;i++){var trace=data[traces[i]];_$registry_668.traceIs(trace,"cartesian")&&(addToAxlist(trace.xaxis||"x"),addToAxlist(trace.yaxis||"y"),"type"===ai&&doextra(["autobinx","autobiny"],!0,i))}doextra(axlist.map(autorangeAttr),!0,0),doextra(axlist.map(rangeAttr),[0,1],0)}}else param=_$lib_539.nestedProperty(gd.layout,ai.replace("LAYOUT","")),undoit[ai]=[undefinedToNull(param.get())],param.set(Array.isArray(vi)?vi[0]:vi),flags.calc=!0}var autorangeOn=!1,axList=_$axes_584.list(gd);for(i=0;i<axList.length;i++)if(axList[i].autorange){autorangeOn=!0;break}return(flags.calc||flags.calcIfAutorange&&autorangeOn)&&(flags.clearCalc=!0),(flags.calc||flags.plot||flags.calcIfAutorange)&&(flags.fullReplot=!0),{flags:flags,undoit:undoit,redoit:redoit,traces:traces,eventData:_$lib_539.extendDeepNoArrays([],[redoit,traces])}}function _relayout(gd,aobj){var arrayStr,i,j,layout=gd.layout,fullLayout=gd._fullLayout,keys=Object.keys(aobj),axes=_$axes_584.list(gd),arrayEdits={};for(i=0;i<keys.length;i++)if(0===keys[i].indexOf("allaxes")){for(j=0;j<axes.length;j++){var scene=axes[j]._id.substr(1),axisAttr=-1!==scene.indexOf("scene")?scene+".":"",newkey=keys[i].replace("allaxes",axisAttr+axes[j]._name);aobj[newkey]||(aobj[newkey]=aobj[keys[i]])}delete aobj[keys[i]]}var flags=_$edit_types_569.layoutFlags(),redoit={},undoit={};function doextra(attr,val){if(Array.isArray(attr))attr.forEach(function(a){doextra(a,val)});else if(!(attr in aobj||_$helpers_570.hasParent(aobj,attr))){var p=_$lib_539.nestedProperty(layout,attr);attr in undoit||(undoit[attr]=undefinedToNull(p.get())),void 0!==val&&p.set(val)}}var axId,rangesAltered={};function recordAlteredAxis(pleafPlus){var axId=_$axes_584.name2id(pleafPlus.split(".")[0]);return rangesAltered[axId]=1,axId}for(var ai in aobj){if(_$helpers_570.hasParent(aobj,ai))throw new Error("cannot set "+ai+"and a parent attribute simultaneously");for(var p=_$lib_539.nestedProperty(layout,ai),vi=aobj[ai],plen=p.parts.length,pend=plen-1;pend>0&&"string"!=typeof p.parts[plen-1];)pend--;var pleaf=p.parts[pend],pleafPlus=p.parts[pend-1]+"."+pleaf,ptrunk=p.parts.slice(0,pend).join("."),parentIn=_$lib_539.nestedProperty(gd.layout,ptrunk).get(),parentFull=_$lib_539.nestedProperty(fullLayout,ptrunk).get(),vOld=p.get();if(void 0!==vi){redoit[ai]=vi,undoit[ai]="reverse"===pleaf?vi:undefinedToNull(vOld);var valObject=_$plot_schema_575.getLayoutValObject(fullLayout,p.parts);if(valObject&&valObject.impliedEdits&&null!==vi)for(var impliedKey in valObject.impliedEdits)doextra(_$lib_539.relativeAttr(ai,impliedKey),valObject.impliedEdits[impliedKey]);if(-1!==["width","height"].indexOf(ai)&&null===vi)fullLayout[ai]=gd._initialAutoSize[ai];else if(pleafPlus.match(/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/))recordAlteredAxis(pleafPlus),_$lib_539.nestedProperty(fullLayout,ptrunk+"._inputRange").set(null);else if(pleafPlus.match(/^[xyz]axis[0-9]*\.autorange$/)){recordAlteredAxis(pleafPlus),_$lib_539.nestedProperty(fullLayout,ptrunk+"._inputRange").set(null);var axFull=_$lib_539.nestedProperty(fullLayout,ptrunk).get();axFull._inputDomain&&(axFull._input.domain=axFull._inputDomain.slice())}else pleafPlus.match(/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/)&&_$lib_539.nestedProperty(fullLayout,ptrunk+"._inputDomain").set(null);if("type"===pleaf){var ax=parentIn,toLog="linear"===parentFull.type&&"log"===vi,fromLog="log"===parentFull.type&&"linear"===vi;if(toLog||fromLog){if(ax&&ax.range)if(parentFull.autorange)toLog&&(ax.range=ax.range[1]>ax.range[0]?[1,2]:[2,1]);else{var r0=ax.range[0],r1=ax.range[1];toLog?(r0<=0&&r1<=0&&doextra(ptrunk+".autorange",!0),r0<=0?r0=r1/1e6:r1<=0&&(r1=r0/1e6),doextra(ptrunk+".range[0]",Math.log(r0)/Math.LN10),doextra(ptrunk+".range[1]",Math.log(r1)/Math.LN10)):(doextra(ptrunk+".range[0]",Math.pow(10,r0)),doextra(ptrunk+".range[1]",Math.pow(10,r1)))}else doextra(ptrunk+".autorange",!0);Array.isArray(fullLayout._subplots.polar)&&fullLayout._subplots.polar.length&&fullLayout[p.parts[0]]&&"radialaxis"===p.parts[1]&&delete fullLayout[p.parts[0]]._subplot.viewInitial["radialaxis.range"],_$registry_668.getComponentMethod("annotations","convertCoords")(gd,parentFull,vi,doextra),_$registry_668.getComponentMethod("images","convertCoords")(gd,parentFull,vi,doextra)}else doextra(ptrunk+".autorange",!0),doextra(ptrunk+".range",null);_$lib_539.nestedProperty(fullLayout,ptrunk+"._inputRange").set(null)}else if(pleaf.match(_$constants_589.AX_NAME_PATTERN)){var fullProp=_$lib_539.nestedProperty(fullLayout,ai).get(),newType=(vi||{}).type;newType&&"-"!==newType||(newType="linear"),_$registry_668.getComponentMethod("annotations","convertCoords")(gd,fullProp,newType,doextra),_$registry_668.getComponentMethod("images","convertCoords")(gd,fullProp,newType,doextra)}var containerArrayMatch=_$manage_arrays_572.containerArrayMatch(ai);if(containerArrayMatch){arrayStr=containerArrayMatch.array,i=containerArrayMatch.index;var propStr=containerArrayMatch.property,obji=(_$lib_539.nestedProperty(layout,arrayStr)||[])[i]||{},objToAutorange=obji,updateValObject=valObject||{editType:"calc"},checkForAutorange=-1!==updateValObject.editType.indexOf("calcIfAutorange");""===i?(checkForAutorange?flags.calc=!0:_$edit_types_569.update(flags,updateValObject),checkForAutorange=!1):""===propStr&&(objToAutorange=vi,_$manage_arrays_572.isAddVal(vi)?undoit[ai]=null:_$manage_arrays_572.isRemoveVal(vi)?(undoit[ai]=obji,objToAutorange=obji):_$lib_539.warn("unrecognized full object value",aobj)),checkForAutorange&&(refAutorange(gd,objToAutorange,"x")||refAutorange(gd,objToAutorange,"y"))?flags.calc=!0:_$edit_types_569.update(flags,updateValObject),arrayEdits[arrayStr]||(arrayEdits[arrayStr]={});var objEdits=arrayEdits[arrayStr][i];objEdits||(objEdits=arrayEdits[arrayStr][i]={}),objEdits[propStr]=vi,delete aobj[ai]}else"reverse"===pleaf?(parentIn.range?parentIn.range.reverse():(doextra(ptrunk+".autorange",!0),parentIn.range=[1,0]),parentFull.autorange?flags.calc=!0:flags.plot=!0):(fullLayout._has("scatter-like")&&fullLayout._has("regl")&&"dragmode"===ai&&("lasso"===vi||"select"===vi)&&"lasso"!==vOld&&"select"!==vOld?flags.plot=!0:valObject?_$edit_types_569.update(flags,valObject):flags.calc=!0,p.set(vi))}}for(arrayStr in arrayEdits){_$manage_arrays_572.applyContainerArrayChanges(gd,_$lib_539.nestedProperty(layout,arrayStr),arrayEdits[arrayStr],flags)||(flags.plot=!0)}var constraints=fullLayout._axisConstraintGroups||[];for(axId in rangesAltered)for(i=0;i<constraints.length;i++){var group=constraints[i];if(group[axId])for(var groupAxId in flags.calc=!0,group)rangesAltered[groupAxId]||(_$axes_584.getFromId(gd,groupAxId)._constraintShrinkable=!0)}return(updateAutosize(gd)||aobj.height||aobj.width)&&(flags.plot=!0),(flags.plot||flags.calc)&&(flags.layoutReplot=!0),{flags:flags,undoit:undoit,redoit:redoit,eventData:_$lib_539.extendDeep({},redoit)}}function updateAutosize(gd){var fullLayout=gd._fullLayout,oldWidth=fullLayout.width,oldHeight=fullLayout.height;return gd.layout.autosize&&_$plots_647.plotAutoSize(gd,gd.layout,fullLayout),fullLayout.width!==oldWidth||fullLayout.height!==oldHeight}function refAutorange(gd,obj,axLetter){if(!_$lib_539.isPlainObject(obj))return!1;var axRef=obj[axLetter+"ref"]||axLetter,ax=_$axes_584.getFromId(gd,axRef);return ax||axRef.charAt(0)!==axLetter||(ax=_$axes_584.getFromId(gd,axLetter)),(ax||{}).autorange}function getDiffFlags(oldContainer,newContainer,outerparts,opts){var valObject,key,getValObject=opts.getValObject,flags=opts.flags,immutable=opts.immutable,inArray=opts.inArray,arrayIndex=opts.arrayIndex,gd=opts.gd,autoranged=opts.autoranged;function changed(){var editType=valObject.editType;-1!==editType.indexOf("calcIfAutorange")&&(autoranged||void 0===autoranged&&(refAutorange(gd,newContainer,"x")||refAutorange(gd,newContainer,"y")))?flags.calc=!0:inArray&&-1!==editType.indexOf("arraydraw")?_$lib_539.pushUnique(flags.arrays[inArray],arrayIndex):_$edit_types_569.update(flags,valObject)}function valObjectCanBeDataArray(valObject){return"data_array"===valObject.valType||valObject.arrayOk}var newFullInput=newContainer._fullInput,oldFullInput=oldContainer._fullInput;for(key in newFullInput&&newFullInput!==newContainer&&(newContainer=newFullInput),oldFullInput&&oldFullInput!==oldContainer&&(oldContainer=oldFullInput),oldContainer){if(flags.calc)return;var oldVal=oldContainer[key],newVal=newContainer[key];if("_"!==key.charAt(0)&&"function"!=typeof oldVal&&oldVal!==newVal){if("tick0"===key||"dtick"===key){var tickMode=newContainer.tickmode;if("auto"===tickMode||"array"===tickMode||!tickMode)continue}if(("range"!==key||!newContainer.autorange)&&("zmin"!==key&&"zmax"!==key||"contourcarpet"!==newContainer.type)){var parts=outerparts.concat(key);if(valObject=getValObject(parts)){var i,valType=valObject.valType,canBeDataArray=valObjectCanBeDataArray(valObject),wasArray=Array.isArray(oldVal),nowArray=Array.isArray(newVal);if(wasArray&&nowArray){var inputKey="_input_"+key,oldValIn=oldContainer[inputKey],newValIn=newContainer[inputKey];if(Array.isArray(oldValIn)&&oldValIn===newValIn)continue}if(void 0===newVal)canBeDataArray&&wasArray?flags.calc=!0:changed();else if(valObject._isLinkedToArray){var arrayEditIndices=[],extraIndices=!1;inArray||(flags.arrays[key]=arrayEditIndices);var minLen=Math.min(oldVal.length,newVal.length),maxLen=Math.max(oldVal.length,newVal.length);if(minLen!==maxLen){if("arraydraw"!==valObject.editType){changed();continue}extraIndices=!0}for(i=0;i<minLen;i++)getDiffFlags(oldVal[i],newVal[i],parts.concat(i),_$lib_539.extendFlat({inArray:key,arrayIndex:i},opts));if(extraIndices)for(i=minLen;i<maxLen;i++)arrayEditIndices.push(i)}else!valType&&_$lib_539.isPlainObject(oldVal)?getDiffFlags(oldVal,newVal,parts,opts):canBeDataArray?wasArray&&nowArray?immutable&&(flags.calc=!0):wasArray!==nowArray?flags.calc=!0:changed():wasArray&&nowArray&&oldVal.length===newVal.length&&String(oldVal)===String(newVal)||changed()}}}}for(key in newContainer)if(!(key in oldContainer||"_"===key.charAt(0)||"function"==typeof newContainer[key])){if(valObjectCanBeDataArray(valObject=getValObject(outerparts.concat(key)))&&Array.isArray(newContainer[key]))return void(flags.calc=!0);changed()}}function makePlotFramework(gd){var gd3=_$d3_127.select(gd),fullLayout=gd._fullLayout;if(fullLayout._container=gd3.selectAll(".plot-container").data([0]),fullLayout._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),fullLayout._paperdiv=fullLayout._container.selectAll(".svg-container").data([0]),fullLayout._paperdiv.enter().append("div").classed("svg-container",!0).style("position","relative"),fullLayout._glcontainer=fullLayout._paperdiv.selectAll(".gl-container").data([{}]),fullLayout._glcontainer.enter().append("div").classed("gl-container",!0),fullLayout._glcanvas=null,fullLayout._paperdiv.selectAll(".main-svg").remove(),fullLayout._paper=fullLayout._paperdiv.insert("svg",":first-child").classed("main-svg",!0),fullLayout._toppaper=fullLayout._paperdiv.append("svg").classed("main-svg",!0),!fullLayout._uid){var otherUids=[];_$d3_127.selectAll("defs").each(function(){this.id&&otherUids.push(this.id.split("-")[1])}),fullLayout._uid=_$lib_539.randstr(otherUids)}fullLayout._paperdiv.selectAll(".main-svg").attr(_$xmlns_namespaces_519.svgAttrs),fullLayout._defs=fullLayout._paper.append("defs").attr("id","defs-"+fullLayout._uid),fullLayout._clips=fullLayout._defs.append("g").classed("clips",!0),fullLayout._topdefs=fullLayout._toppaper.append("defs").attr("id","topdefs-"+fullLayout._uid),fullLayout._topclips=fullLayout._topdefs.append("g").classed("clips",!0),fullLayout._bgLayer=fullLayout._paper.append("g").classed("bglayer",!0),fullLayout._draggers=fullLayout._paper.append("g").classed("draglayer",!0);var layerBelow=fullLayout._paper.append("g").classed("layer-below",!0);fullLayout._imageLowerLayer=layerBelow.append("g").classed("imagelayer",!0),fullLayout._shapeLowerLayer=layerBelow.append("g").classed("shapelayer",!0),fullLayout._cartesianlayer=fullLayout._paper.append("g").classed("cartesianlayer",!0),fullLayout._polarlayer=fullLayout._paper.append("g").classed("polarlayer",!0),fullLayout._ternarylayer=fullLayout._paper.append("g").classed("ternarylayer",!0),fullLayout._geolayer=fullLayout._paper.append("g").classed("geolayer",!0),fullLayout._pielayer=fullLayout._paper.append("g").classed("pielayer",!0),fullLayout._glimages=fullLayout._paper.append("g").classed("glimages",!0);var layerAbove=fullLayout._toppaper.append("g").classed("layer-above",!0);fullLayout._imageUpperLayer=layerAbove.append("g").classed("imagelayer",!0),fullLayout._shapeUpperLayer=layerAbove.append("g").classed("shapelayer",!0),fullLayout._infolayer=fullLayout._toppaper.append("g").classed("infolayer",!0),fullLayout._menulayer=fullLayout._toppaper.append("g").classed("menulayer",!0),fullLayout._zoomlayer=fullLayout._toppaper.append("g").classed("zoomlayer",!0),fullLayout._hoverlayer=fullLayout._toppaper.append("g").classed("hoverlayer",!0),gd.emit("plotly_framework")}_$plot_api_573.plot=function(gd,data,layout,config){var frames;if(gd=_$lib_539.getGraphDiv(gd),_$Events_527.init(gd),_$lib_539.isPlainObject(data)){var obj=data;data=obj.data,layout=obj.layout,config=obj.config,frames=obj.frames}if(!1===_$Events_527.triggerHandler(gd,"plotly_beforeplot",[data,layout,config]))return Promise.reject();data||layout||_$lib_539.isPlotDiv(gd)||_$lib_539.warn("Calling Plotly.plot as if redrawing but this container doesn't yet have a plot.",gd),setPlotContext(gd,config),layout||(layout={}),_$d3_127.select(gd).classed("js-plotly-plot",!0),_$drawing_436.makeTester(),Array.isArray(gd._promises)||(gd._promises=[]);var graphWasEmpty=0===(gd.data||[]).length&&Array.isArray(data);if(Array.isArray(data)&&(_$helpers_570.cleanData(data,gd.data),graphWasEmpty?gd.data=data:gd.data.push.apply(gd.data,data),gd.empty=!1),gd.layout&&!graphWasEmpty||(gd.layout=_$helpers_570.cleanLayout(layout)),gd._dragging&&!gd._transitioning)return gd._replotPending=!0,Promise.reject();gd._replotPending=!1,_$plots_647.supplyDefaults(gd);var fullLayout=gd._fullLayout,hasCartesian=fullLayout._has("cartesian");if(!fullLayout._has("polar")&&data&&data[0]&&data[0].r)return _$lib_539.log("Legacy polar charts are deprecated!"),function plotPolar(gd,data,layout){var plotContainer=_$d3_127.select(gd).selectAll(".plot-container").data([0]);plotContainer.enter().insert("div",":first-child").classed("plot-container plotly",!0);var paperDiv=plotContainer.selectAll(".svg-container").data([0]);paperDiv.enter().append("div").classed("svg-container",!0).style("position","relative"),paperDiv.html(""),data&&(gd.data=data);layout&&(gd.layout=layout);_$legacy_655.manager.fillLayout(gd),paperDiv.style({width:gd._fullLayout.width+"px",height:gd._fullLayout.height+"px"}),gd.framework=_$legacy_655.manager.framework(gd),gd.framework({data:gd.data,layout:gd.layout},paperDiv.node()),gd.framework.setUndoPoint();var polarPlotSVG=gd.framework.svg(),opacity=1,txt=gd._fullLayout.title;""!==txt&&txt||(opacity=0);var titleLayout=function(){this.call(_$svg_text_utils_562.convertToTspans,gd)},title=polarPlotSVG.select(".title-group text").call(titleLayout);if(gd._context.edits.titleText){var placeholderText=_$lib_539._(gd,"Click to enter Plot title");txt&&txt!==placeholderText||(opacity=.2,title.attr({"data-unformatted":placeholderText}).text(placeholderText).style({opacity:opacity}).on("mouseover.opacity",function(){_$d3_127.select(this).transition().duration(100).style("opacity",1)}).on("mouseout.opacity",function(){_$d3_127.select(this).transition().duration(1e3).style("opacity",0)}));var setContenteditable=function(){this.call(_$svg_text_utils_562.makeEditable,{gd:gd}).on("edit",function(text){gd.framework({layout:{title:text}}),this.text(text).call(titleLayout),this.call(setContenteditable)}).on("cancel",function(){var txt=this.attr("data-unformatted");this.text(txt).call(titleLayout)})};title.call(setContenteditable)}return gd._context.setBackground(gd,gd._fullLayout.paper_bgcolor),_$plots_647.addLinks(gd),Promise.resolve()}(gd,data,layout);fullLayout._replotting=!0,graphWasEmpty&&makePlotFramework(gd),gd.framework!==makePlotFramework&&(gd.framework=makePlotFramework,makePlotFramework(gd)),_$drawing_436.initGradients(gd),graphWasEmpty&&_$axes_584.saveShowSpikeInitial(gd);var recalc=!gd.calcdata||gd.calcdata.length!==(gd._fullData||[]).length;recalc&&_$plots_647.doCalcdata(gd);for(var i=0;i<gd.calcdata.length;i++)gd.calcdata[i][0].trace=gd._fullData[i];var oldmargins=JSON.stringify(fullLayout._size);function marginPushers(){var i,cd,trace,calcdata=gd.calcdata;for(_$registry_668.getComponentMethod("legend","draw")(gd),_$registry_668.getComponentMethod("rangeselector","draw")(gd),_$registry_668.getComponentMethod("sliders","draw")(gd),_$registry_668.getComponentMethod("updatemenus","draw")(gd),i=0;i<calcdata.length;i++)!0===(trace=(cd=calcdata[i])[0].trace).visible&&trace._module.colorbar?trace._module.colorbar(gd,cd):_$plots_647.autoMargin(gd,"cb"+trace.uid);return _$plots_647.doAutoMargin(gd),_$plots_647.previousPromises(gd)}function doAutoRangeAndConstraints(){if(!gd._transitioning){for(var axList=_$axes_584.list(gd,"",!0),i=0;i<axList.length;i++){var ax=axList[i];cleanAxisConstraints(gd,ax),__doAutoRange_573(ax)}enforceAxisConstraints(gd),graphWasEmpty&&_$axes_584.saveRangeInitial(gd)}}var seq=[_$plots_647.previousPromises,function addFrames(){if(frames)return _$plot_api_573.addFrames(gd,frames)},function drawFramework(){for(var basePlotModules=fullLayout._basePlotModules,i=0;i<basePlotModules.length;i++)basePlotModules[i].drawFramework&&basePlotModules[i].drawFramework(gd);return!fullLayout._glcanvas&&fullLayout._has("gl")&&(fullLayout._glcanvas=fullLayout._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(d){return d.key}),fullLayout._glcanvas.enter().append("canvas").attr("class",function(d){return"gl-canvas gl-canvas-"+d.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"visible","pointer-events":"none"})),fullLayout._glcanvas&&fullLayout._glcanvas.attr("width",fullLayout.width).attr("height",fullLayout.height),_$lib_539.syncOrAsync([_$subroutines_576.layoutStyles],gd)},marginPushers,function marginPushersAgain(){if(JSON.stringify(fullLayout._size)!==oldmargins)return _$lib_539.syncOrAsync([marginPushers,_$subroutines_576.layoutStyles],gd)}];hasCartesian&&seq.push(function positionAndAutorange(){if(recalc){var subplotInfo,i,j,subplots=fullLayout._subplots.cartesian,modules=fullLayout._modules,setPositionsArray=[];for(j=0;j<modules.length;j++)_$lib_539.pushUnique(setPositionsArray,modules[j].setPositions);if(setPositionsArray.length)for(i=0;i<subplots.length;i++)for(subplotInfo=fullLayout._plots[subplots[i]],j=0;j<setPositionsArray.length;j++)setPositionsArray[j](gd,subplotInfo);return _$registry_668.getComponentMethod("errorbars","calc")(gd),_$lib_539.syncOrAsync([_$registry_668.getComponentMethod("shapes","calcAutorange"),_$registry_668.getComponentMethod("annotations","calcAutorange"),doAutoRangeAndConstraints,_$registry_668.getComponentMethod("rangeslider","calcAutorange")],gd)}doAutoRangeAndConstraints()}),seq.push(_$subroutines_576.layoutStyles),hasCartesian&&seq.push(function drawAxes(){return _$axes_584.doTicks(gd,"redraw")}),seq.push(function drawData(){var i,calcdata=gd.calcdata,rangesliderContainers=fullLayout._infolayer.selectAll("g.rangeslider-container");for(i=0;i<calcdata.length;i++){var trace=calcdata[i][0].trace,isVisible=!0===trace.visible,uid=trace.uid;if(!isVisible||!_$registry_668.traceIs(trace,"2dMap")){var query=".hm"+uid+",.contour"+uid+",#clip"+uid;fullLayout._paper.selectAll(query).remove(),rangesliderContainers.selectAll(query).remove()}isVisible&&trace._module.colorbar||fullLayout._infolayer.selectAll(".cb"+uid).remove()}var basePlotModules=fullLayout._basePlotModules;for(i=0;i<basePlotModules.length;i++)basePlotModules[i].plot(gd);var layerSubplot=fullLayout._paper.selectAll(".layer-subplot");return fullLayout._shapeSubplotLayers=layerSubplot.selectAll(".shapelayer"),_$plots_647.style(gd),_$registry_668.getComponentMethod("shapes","draw")(gd),_$registry_668.getComponentMethod("annotations","draw")(gd),_$plots_647.addLinks(gd),fullLayout._replotting=!1,_$plots_647.previousPromises(gd)},function finalDraw(){_$registry_668.getComponentMethod("shapes","draw")(gd),_$registry_668.getComponentMethod("images","draw")(gd),_$registry_668.getComponentMethod("annotations","draw")(gd),_$registry_668.getComponentMethod("legend","draw")(gd),_$registry_668.getComponentMethod("rangeslider","draw")(gd),_$registry_668.getComponentMethod("rangeselector","draw")(gd),_$registry_668.getComponentMethod("sliders","draw")(gd),_$registry_668.getComponentMethod("updatemenus","draw")(gd)},_$initInteractions_593,_$plots_647.rehover,_$plots_647.previousPromises);var plotDone=_$lib_539.syncOrAsync(seq,gd);return plotDone&&plotDone.then||(plotDone=Promise.resolve()),plotDone.then(function(){return gd.emit("plotly_afterplot"),gd})},_$plot_api_573.setPlotConfig=function setPlotConfig(obj){return _$lib_539.extendFlat(_$plot_config_574,obj)},_$plot_api_573.redraw=function(gd){if(gd=_$lib_539.getGraphDiv(gd),!_$lib_539.isPlotDiv(gd))throw new Error("This element is not a Plotly plot: "+gd);return _$helpers_570.cleanData(gd.data,gd.data),_$helpers_570.cleanLayout(gd.layout),gd.calcdata=void 0,_$plot_api_573.plot(gd).then(function(){return gd.emit("plotly_redraw"),gd})},_$plot_api_573.newPlot=function(gd,data,layout,config){return gd=_$lib_539.getGraphDiv(gd),_$plots_647.cleanPlot([],{},gd._fullData||{},gd._fullLayout||{}),_$plots_647.purge(gd),_$plot_api_573.plot(gd,data,layout,config)},_$plot_api_573.extendTraces=function extendTraces(gd,update,indices,maxPoints){var undo=spliceTraces(gd=_$lib_539.getGraphDiv(gd),update,indices,maxPoints,function updateArray(target,insert,maxp){var newArray,remainder;if(_$lib_539.isTypedArray(target))if(maxp<0){var none=new target.constructor(0),both=concatTypedArray(target,insert);maxp<0?(newArray=both,remainder=none):(newArray=none,remainder=both)}else if(newArray=new target.constructor(maxp),remainder=new target.constructor(target.length+insert.length-maxp),maxp===insert.length)newArray.set(insert),remainder.set(target);else if(maxp<insert.length){var numberOfItemsFromInsert=insert.length-maxp;newArray.set(insert.subarray(numberOfItemsFromInsert)),remainder.set(target),remainder.set(insert.subarray(0,numberOfItemsFromInsert),target.length)}else{var numberOfItemsFromTarget=maxp-insert.length,targetBegin=target.length-numberOfItemsFromTarget;newArray.set(target.subarray(targetBegin)),newArray.set(insert,numberOfItemsFromTarget),remainder.set(target.subarray(0,targetBegin))}else newArray=target.concat(insert),remainder=maxp>=0&&maxp<newArray.length?newArray.splice(0,newArray.length-maxp):[];return[newArray,remainder]}),promise=_$plot_api_573.redraw(gd),undoArgs=[gd,undo.update,indices,undo.maxPoints];return _$queue_553.add(gd,_$plot_api_573.prependTraces,undoArgs,extendTraces,arguments),promise},_$plot_api_573.prependTraces=function prependTraces(gd,update,indices,maxPoints){var undo=spliceTraces(gd=_$lib_539.getGraphDiv(gd),update,indices,maxPoints,function updateArray(target,insert,maxp){var newArray,remainder;if(_$lib_539.isTypedArray(target))if(maxp<=0){var none=new target.constructor(0),both=concatTypedArray(insert,target);maxp<0?(newArray=both,remainder=none):(newArray=none,remainder=both)}else if(newArray=new target.constructor(maxp),remainder=new target.constructor(target.length+insert.length-maxp),maxp===insert.length)newArray.set(insert),remainder.set(target);else if(maxp<insert.length){var numberOfItemsFromInsert=insert.length-maxp;newArray.set(insert.subarray(0,numberOfItemsFromInsert)),remainder.set(insert.subarray(numberOfItemsFromInsert)),remainder.set(target,numberOfItemsFromInsert)}else{var numberOfItemsFromTarget=maxp-insert.length;newArray.set(insert),newArray.set(target.subarray(0,numberOfItemsFromTarget),insert.length),remainder.set(target.subarray(numberOfItemsFromTarget))}else newArray=insert.concat(target),remainder=maxp>=0&&maxp<newArray.length?newArray.splice(maxp,newArray.length):[];return[newArray,remainder]}),promise=_$plot_api_573.redraw(gd),undoArgs=[gd,undo.update,indices,undo.maxPoints];return _$queue_553.add(gd,_$plot_api_573.extendTraces,undoArgs,prependTraces,arguments),promise},_$plot_api_573.addTraces=function addTraces(gd,traces,newIndices){gd=_$lib_539.getGraphDiv(gd);var i,promise,currentIndices=[],undoFunc=_$plot_api_573.deleteTraces,redoFunc=addTraces,undoArgs=[gd,currentIndices],redoArgs=[gd,traces];for(function checkAddTracesArgs(gd,traces,newIndices){var i,value;if(!Array.isArray(gd.data))throw new Error("gd.data must be an array.");if(void 0===traces)throw new Error("traces must be defined.");for(Array.isArray(traces)||(traces=[traces]),i=0;i<traces.length;i++)if("object"!=typeof(value=traces[i])||Array.isArray(value)||null===value)throw new Error("all values in traces array must be non-array objects");if(void 0===newIndices||Array.isArray(newIndices)||(newIndices=[newIndices]),void 0!==newIndices&&newIndices.length!==traces.length)throw new Error("if indices is specified, traces.length must equal indices.length")}(gd,traces,newIndices),Array.isArray(traces)||(traces=[traces]),traces=traces.map(function(trace){return _$lib_539.extendFlat({},trace)}),_$helpers_570.cleanData(traces,gd.data),i=0;i<traces.length;i++)gd.data.push(traces[i]);for(i=0;i<traces.length;i++)currentIndices.push(-traces.length+i);if(void 0===newIndices)return promise=_$plot_api_573.redraw(gd),_$queue_553.add(gd,undoFunc,undoArgs,redoFunc,redoArgs),promise;Array.isArray(newIndices)||(newIndices=[newIndices]);try{checkMoveTracesArgs(gd,currentIndices,newIndices)}catch(error){throw gd.data.splice(gd.data.length-traces.length,traces.length),error}return _$queue_553.startSequence(gd),_$queue_553.add(gd,undoFunc,undoArgs,redoFunc,redoArgs),promise=_$plot_api_573.moveTraces(gd,currentIndices,newIndices),_$queue_553.stopSequence(gd),promise},_$plot_api_573.deleteTraces=function deleteTraces(gd,indices){gd=_$lib_539.getGraphDiv(gd);var i,deletedTrace,traces=[],undoFunc=_$plot_api_573.addTraces,redoFunc=deleteTraces,undoArgs=[gd,traces,indices],redoArgs=[gd,indices];if(void 0===indices)throw new Error("indices must be an integer or array of integers.");for(Array.isArray(indices)||(indices=[indices]),assertIndexArray(gd,indices,"indices"),(indices=positivifyIndices(indices,gd.data.length-1)).sort(_$lib_539.sorterDes),i=0;i<indices.length;i+=1)deletedTrace=gd.data.splice(indices[i],1)[0],traces.push(deletedTrace);var promise=_$plot_api_573.redraw(gd);return _$queue_553.add(gd,undoFunc,undoArgs,redoFunc,redoArgs),promise},_$plot_api_573.moveTraces=function moveTraces(gd,currentIndices,newIndices){var i,newData=[],movingTraceMap=[],undoFunc=moveTraces,redoFunc=moveTraces,undoArgs=[gd=_$lib_539.getGraphDiv(gd),newIndices,currentIndices],redoArgs=[gd,currentIndices,newIndices];if(checkMoveTracesArgs(gd,currentIndices,newIndices),currentIndices=Array.isArray(currentIndices)?currentIndices:[currentIndices],void 0===newIndices)for(newIndices=[],i=0;i<currentIndices.length;i++)newIndices.push(-currentIndices.length+i);for(newIndices=Array.isArray(newIndices)?newIndices:[newIndices],currentIndices=positivifyIndices(currentIndices,gd.data.length-1),newIndices=positivifyIndices(newIndices,gd.data.length-1),i=0;i<gd.data.length;i++)-1===currentIndices.indexOf(i)&&newData.push(gd.data[i]);for(i=0;i<currentIndices.length;i++)movingTraceMap.push({newIndex:newIndices[i],trace:gd.data[currentIndices[i]]});for(movingTraceMap.sort(function(a,b){return a.newIndex-b.newIndex}),i=0;i<movingTraceMap.length;i+=1)newData.splice(movingTraceMap[i].newIndex,0,movingTraceMap[i].trace);gd.data=newData;var promise=_$plot_api_573.redraw(gd);return _$queue_553.add(gd,undoFunc,undoArgs,redoFunc,redoArgs),promise},_$plot_api_573.restyle=function restyle(gd,astr,val,_traces){gd=_$lib_539.getGraphDiv(gd),_$helpers_570.clearPromiseQueue(gd);var aobj={};if("string"==typeof astr)aobj[astr]=val;else{if(!_$lib_539.isPlainObject(astr))return _$lib_539.warn("Restyle fail.",astr,val,_traces),Promise.reject();aobj=_$lib_539.extendFlat({},astr),void 0===_traces&&(_traces=val)}Object.keys(aobj).length&&(gd.changed=!0);var traces=_$helpers_570.coerceTraceIndices(gd,_traces),specs=_restyle(gd,aobj,traces),flags=specs.flags;flags.clearCalc&&(gd.calcdata=void 0),flags.clearAxisTypes&&_$helpers_570.clearAxisTypes(gd,traces,{});var seq=[];flags.fullReplot?seq.push(_$plot_api_573.plot):(seq.push(_$plots_647.previousPromises),_$plots_647.supplyDefaults(gd),flags.style&&seq.push(_$subroutines_576.doTraceStyle),flags.colorbars&&seq.push(_$subroutines_576.doColorBars)),seq.push(_$plots_647.rehover),_$queue_553.add(gd,restyle,[gd,specs.undoit,specs.traces],restyle,[gd,specs.redoit,specs.traces]);var plotDone=_$lib_539.syncOrAsync(seq,gd);return plotDone&&plotDone.then||(plotDone=Promise.resolve()),plotDone.then(function(){return gd.emit("plotly_restyle",specs.eventData),gd})},_$plot_api_573.relayout=function relayout(gd,astr,val){if(gd=_$lib_539.getGraphDiv(gd),_$helpers_570.clearPromiseQueue(gd),gd.framework&&gd.framework.isPolar)return Promise.resolve(gd);var aobj={};if("string"==typeof astr)aobj[astr]=val;else{if(!_$lib_539.isPlainObject(astr))return _$lib_539.warn("Relayout fail.",astr,val),Promise.reject();aobj=_$lib_539.extendFlat({},astr)}Object.keys(aobj).length&&(gd.changed=!0);var specs=_relayout(gd,aobj),flags=specs.flags;flags.calc&&(gd.calcdata=void 0),flags.margins&&_$helpers_570.clearAxisAutomargins(gd);var seq=[_$plots_647.previousPromises];flags.layoutReplot?seq.push(_$subroutines_576.layoutReplot):Object.keys(aobj).length&&(_$plots_647.supplyDefaults(gd),flags.legend&&seq.push(_$subroutines_576.doLegend),flags.layoutstyle&&seq.push(_$subroutines_576.layoutStyles),flags.ticks&&seq.push(_$subroutines_576.doTicksRelayout),flags.modebar&&seq.push(_$subroutines_576.doModeBar),flags.camera&&seq.push(_$subroutines_576.doCamera)),seq.push(_$plots_647.rehover),_$queue_553.add(gd,relayout,[gd,specs.undoit],relayout,[gd,specs.redoit]);var plotDone=_$lib_539.syncOrAsync(seq,gd);return plotDone&&plotDone.then||(plotDone=Promise.resolve(gd)),plotDone.then(function(){return gd.emit("plotly_relayout",specs.eventData),gd})},_$plot_api_573.update=function update(gd,traceUpdate,layoutUpdate,_traces){if(gd=_$lib_539.getGraphDiv(gd),_$helpers_570.clearPromiseQueue(gd),gd.framework&&gd.framework.isPolar)return Promise.resolve(gd);_$lib_539.isPlainObject(traceUpdate)||(traceUpdate={}),_$lib_539.isPlainObject(layoutUpdate)||(layoutUpdate={}),Object.keys(traceUpdate).length&&(gd.changed=!0),Object.keys(layoutUpdate).length&&(gd.changed=!0);var traces=_$helpers_570.coerceTraceIndices(gd,_traces),restyleSpecs=_restyle(gd,_$lib_539.extendFlat({},traceUpdate),traces),restyleFlags=restyleSpecs.flags,relayoutSpecs=_relayout(gd,_$lib_539.extendFlat({},layoutUpdate)),relayoutFlags=relayoutSpecs.flags;(restyleFlags.clearCalc||relayoutFlags.calc)&&(gd.calcdata=void 0),restyleFlags.clearAxisTypes&&_$helpers_570.clearAxisTypes(gd,traces,layoutUpdate),relayoutFlags.margins&&_$helpers_570.clearAxisAutomargins(gd);var seq=[];if(restyleFlags.fullReplot&&relayoutFlags.layoutReplot){var data=gd.data,layout=gd.layout;gd.data=void 0,gd.layout=void 0,seq.push(function(){return _$plot_api_573.plot(gd,data,layout)})}else restyleFlags.fullReplot?seq.push(_$plot_api_573.plot):relayoutFlags.layoutReplot?seq.push(_$subroutines_576.layoutReplot):(seq.push(_$plots_647.previousPromises),_$plots_647.supplyDefaults(gd),restyleFlags.style&&seq.push(_$subroutines_576.doTraceStyle),restyleFlags.colorbars&&seq.push(_$subroutines_576.doColorBars),relayoutFlags.legend&&seq.push(_$subroutines_576.doLegend),relayoutFlags.layoutstyle&&seq.push(_$subroutines_576.layoutStyles),relayoutFlags.ticks&&seq.push(_$subroutines_576.doTicksRelayout),relayoutFlags.modebar&&seq.push(_$subroutines_576.doModeBar),relayoutFlags.camera&&seq.push(_$subroutines_576.doCamera));seq.push(_$plots_647.rehover),_$queue_553.add(gd,update,[gd,restyleSpecs.undoit,relayoutSpecs.undoit,restyleSpecs.traces],update,[gd,restyleSpecs.redoit,relayoutSpecs.redoit,restyleSpecs.traces]);var plotDone=_$lib_539.syncOrAsync(seq,gd);return plotDone&&plotDone.then||(plotDone=Promise.resolve(gd)),plotDone.then(function(){return gd.emit("plotly_update",{data:restyleSpecs.eventData,layout:relayoutSpecs.eventData}),gd})},_$plot_api_573.react=function(gd,data,layout,config){var frames,plotDone;var oldFullData=(gd=_$lib_539.getGraphDiv(gd))._fullData,oldFullLayout=gd._fullLayout;if(_$lib_539.isPlotDiv(gd)&&oldFullData&&oldFullLayout){if(_$lib_539.isPlainObject(data)){var obj=data;data=obj.data,layout=obj.layout,config=obj.config,frames=obj.frames}var configChanged=!1;if(config){var oldConfig=_$lib_539.extendDeep({},gd._context);gd._context=void 0,setPlotContext(gd,config),configChanged=function diffConfig(oldConfig,newConfig){var key;for(key in oldConfig){var oldVal=oldConfig[key],newVal=newConfig[key];if(oldVal!==newVal)if(_$lib_539.isPlainObject(oldVal)&&_$lib_539.isPlainObject(newVal)){if(diffConfig(oldVal,newVal))return!0}else{if(!Array.isArray(oldVal)||!Array.isArray(newVal))return!0;if(oldVal.length!==newVal.length)return!0;for(var i=0;i<oldVal.length;i++)if(oldVal[i]!==newVal[i]){if(!_$lib_539.isPlainObject(oldVal[i])||!_$lib_539.isPlainObject(newVal[i]))return!0;if(diffConfig(oldVal[i],newVal[i]))return!0}}}}(oldConfig,gd._context)}gd.data=data||[],_$helpers_570.cleanData(gd.data,[]),gd.layout=layout||{},_$helpers_570.cleanLayout(gd.layout),_$plots_647.supplyDefaults(gd);var newFullData=gd._fullData,newFullLayout=gd._fullLayout,immutable=void 0===newFullLayout.datarevision,restyleFlags=function diffData(gd,oldFullData,newFullData,immutable){if(oldFullData.length!==newFullData.length)return{fullReplot:!0,clearCalc:!0};var i,trace,flags=_$edit_types_569.traceFlags();flags.arrays={};var diffOpts={getValObject:function getTraceValObject(parts){return _$plot_schema_575.getTraceValObject(trace,parts)},flags:flags,immutable:immutable,gd:gd};for(i=0;i<oldFullData.length;i++)trace=newFullData[i],diffOpts.autoranged=!!trace.xaxis&&(_$axes_584.getFromId(gd,trace.xaxis).autorange||_$axes_584.getFromId(gd,trace.yaxis).autorange),getDiffFlags(oldFullData[i],trace,[],diffOpts);(flags.calc||flags.plot||flags.calcIfAutorange)&&(flags.fullReplot=!0);return flags}(gd,oldFullData,newFullData,immutable),relayoutFlags=function diffLayout(gd,oldFullLayout,newFullLayout,immutable){var flags=_$edit_types_569.layoutFlags();flags.arrays={},getDiffFlags(oldFullLayout,newFullLayout,[],{getValObject:function getLayoutValObject(parts){return _$plot_schema_575.getLayoutValObject(newFullLayout,parts)},flags:flags,immutable:immutable,gd:gd}),(flags.plot||flags.calc)&&(flags.layoutReplot=!0);return flags}(gd,oldFullLayout,newFullLayout,immutable);updateAutosize(gd)&&(relayoutFlags.layoutReplot=!0),(restyleFlags.calc||relayoutFlags.calc)&&(gd.calcdata=void 0),relayoutFlags.margins&&_$helpers_570.clearAxisAutomargins(gd);var seq=[];if(frames&&(gd._transitionData={},_$plots_647.createTransitionData(gd),seq.push(function addFrames(){return _$plot_api_573.addFrames(gd,frames)})),restyleFlags.fullReplot||relayoutFlags.layoutReplot||configChanged)gd._fullLayout._skipDefaults=!0,seq.push(_$plot_api_573.plot);else{for(var componentType in relayoutFlags.arrays){var indices=relayoutFlags.arrays[componentType];if(indices.length){var drawOne=_$registry_668.getComponentMethod(componentType,"drawOne");if(drawOne!==_$lib_539.noop)for(var i=0;i<indices.length;i++)drawOne(gd,indices[i]);else{var draw=_$registry_668.getComponentMethod(componentType,"draw");if(draw===_$lib_539.noop)throw new Error("cannot draw components: "+componentType);draw(gd)}}}seq.push(_$plots_647.previousPromises),restyleFlags.style&&seq.push(_$subroutines_576.doTraceStyle),restyleFlags.colorbars&&seq.push(_$subroutines_576.doColorBars),relayoutFlags.legend&&seq.push(_$subroutines_576.doLegend),relayoutFlags.layoutstyle&&seq.push(_$subroutines_576.layoutStyles),relayoutFlags.ticks&&seq.push(_$subroutines_576.doTicksRelayout),relayoutFlags.modebar&&seq.push(_$subroutines_576.doModeBar),relayoutFlags.camera&&seq.push(_$subroutines_576.doCamera)}seq.push(_$plots_647.rehover),(plotDone=_$lib_539.syncOrAsync(seq,gd))&&plotDone.then||(plotDone=Promise.resolve(gd))}else plotDone=_$plot_api_573.newPlot(gd,data,layout,config);return plotDone.then(function(){return gd.emit("plotly_react",{data:data,layout:layout}),gd})},_$plot_api_573.animate=function(gd,frameOrGroupNameOrFrameList,animationOpts){if(gd=_$lib_539.getGraphDiv(gd),!_$lib_539.isPlotDiv(gd))throw new Error("This element is not a Plotly plot: "+gd+". It's likely that you've failed to create a plot before animating it. For more details, see https://plot.ly/javascript/animations/");var trans=gd._transitionData;trans._frameQueue||(trans._frameQueue=[]);var transitionOpts=(animationOpts=_$plots_647.supplyAnimationDefaults(animationOpts)).transition,frameOpts=animationOpts.frame;function getTransitionOpts(i){return Array.isArray(transitionOpts)?i>=transitionOpts.length?transitionOpts[0]:transitionOpts[i]:transitionOpts}function getFrameOpts(i){return Array.isArray(frameOpts)?i>=frameOpts.length?frameOpts[0]:frameOpts[i]:frameOpts}function callbackOnNthTime(cb,n){var cnt=0;return function(){if(cb&&++cnt===n)return cb()}}return void 0===trans._frameWaitingCnt&&(trans._frameWaitingCnt=0),new Promise(function(resolve,reject){function nextFrame(){trans._currentFrame&&trans._currentFrame.onComplete&&trans._currentFrame.onComplete();var newFrame=trans._currentFrame=trans._frameQueue.shift();if(newFrame){var stringName=newFrame.name?newFrame.name.toString():null;gd._fullLayout._currentFrame=stringName,trans._lastFrameAt=Date.now(),trans._timeToNext=newFrame.frameOpts.duration,_$plots_647.transition(gd,newFrame.frame.data,newFrame.frame.layout,_$helpers_570.coerceTraceIndices(gd,newFrame.frame.traces),newFrame.frameOpts,newFrame.transitionOpts).then(function(){newFrame.onComplete&&newFrame.onComplete()}),gd.emit("plotly_animatingframe",{name:stringName,frame:newFrame.frame,animation:{frame:newFrame.frameOpts,transition:newFrame.transitionOpts}})}else!function stopAnimationLoop(){gd.emit("plotly_animated"),window.cancelAnimationFrame(trans._animationRaf),trans._animationRaf=null}()}function beginAnimationLoop(){gd.emit("plotly_animating"),trans._lastFrameAt=-1/0,trans._timeToNext=0,trans._runningTransitions=0,trans._currentFrame=null;var doFrame=function(){trans._animationRaf=window.requestAnimationFrame(doFrame),Date.now()-trans._lastFrameAt>trans._timeToNext&&nextFrame()};doFrame()}var i,frame,configCounter=0;function setTransitionConfig(frame){return Array.isArray(transitionOpts)?configCounter>=transitionOpts.length?frame.transitionOpts=transitionOpts[configCounter]:frame.transitionOpts=transitionOpts[0]:frame.transitionOpts=transitionOpts,configCounter++,frame}var frameList=[],allFrames=void 0===frameOrGroupNameOrFrameList||null===frameOrGroupNameOrFrameList,isFrameArray=Array.isArray(frameOrGroupNameOrFrameList);if(!allFrames&&!isFrameArray&&_$lib_539.isPlainObject(frameOrGroupNameOrFrameList))frameList.push({type:"object",data:setTransitionConfig(_$lib_539.extendFlat({},frameOrGroupNameOrFrameList))});else if(allFrames||-1!==["string","number"].indexOf(typeof frameOrGroupNameOrFrameList))for(i=0;i<trans._frames.length;i++)(frame=trans._frames[i])&&(allFrames||String(frame.group)===String(frameOrGroupNameOrFrameList))&&frameList.push({type:"byname",name:String(frame.name),data:setTransitionConfig({name:frame.name})});else if(isFrameArray)for(i=0;i<frameOrGroupNameOrFrameList.length;i++){var frameOrName=frameOrGroupNameOrFrameList[i];-1!==["number","string"].indexOf(typeof frameOrName)?(frameOrName=String(frameOrName),frameList.push({type:"byname",name:frameOrName,data:setTransitionConfig({name:frameOrName})})):_$lib_539.isPlainObject(frameOrName)&&frameList.push({type:"object",data:setTransitionConfig(_$lib_539.extendFlat({},frameOrName))})}for(i=0;i<frameList.length;i++)if("byname"===(frame=frameList[i]).type&&!trans._frameHash[frame.data.name])return _$lib_539.warn('animate failure: frame not found: "'+frame.data.name+'"'),void reject();-1!==["next","immediate"].indexOf(animationOpts.mode)&&function discardExistingFrames(){if(0!==trans._frameQueue.length){for(;trans._frameQueue.length;){var next=trans._frameQueue.pop();next.onInterrupt&&next.onInterrupt()}gd.emit("plotly_animationinterrupted",[])}}(),"reverse"===animationOpts.direction&&frameList.reverse();var currentFrame=gd._fullLayout._currentFrame;if(currentFrame&&animationOpts.fromcurrent){var idx=-1;for(i=0;i<frameList.length;i++)if("byname"===(frame=frameList[i]).type&&frame.name===currentFrame){idx=i;break}if(idx>0&&idx<frameList.length-1){var filteredFrameList=[];for(i=0;i<frameList.length;i++)frame=frameList[i],("byname"!==frameList[i].type||i>idx)&&filteredFrameList.push(frame);frameList=filteredFrameList}}frameList.length>0?function queueFrames(frameList){if(0!==frameList.length){for(var i=0;i<frameList.length;i++){var computedFrame;computedFrame="byname"===frameList[i].type?_$plots_647.computeFrame(gd,frameList[i].name):frameList[i].data;var frameOpts=getFrameOpts(i),transitionOpts=getTransitionOpts(i);transitionOpts.duration=Math.min(transitionOpts.duration,frameOpts.duration);var nextFrame={frame:computedFrame,name:frameList[i].name,frameOpts:frameOpts,transitionOpts:transitionOpts};i===frameList.length-1&&(nextFrame.onComplete=callbackOnNthTime(resolve,2),nextFrame.onInterrupt=reject),trans._frameQueue.push(nextFrame)}"immediate"===animationOpts.mode&&(trans._lastFrameAt=-1/0),trans._animationRaf||beginAnimationLoop()}}(frameList):(gd.emit("plotly_animated"),resolve())})},_$plot_api_573.addFrames=function(gd,frameList,indices){if(gd=_$lib_539.getGraphDiv(gd),null===frameList||void 0===frameList)return Promise.resolve();if(!_$lib_539.isPlotDiv(gd))throw new Error("This element is not a Plotly plot: "+gd+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plot.ly/javascript/animations/");var i,frame,j,idx,_frames=gd._transitionData._frames,_frameHash=gd._transitionData._frameHash;if(!Array.isArray(frameList))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+frameList);var bigIndex=_frames.length+2*frameList.length,insertions=[],_frameHashLocal={};for(i=frameList.length-1;i>=0;i--)if(_$lib_539.isPlainObject(frameList[i])){var lookupName=frameList[i].name,name=(_frameHash[lookupName]||_frameHashLocal[lookupName]||{}).name,newName=frameList[i].name,collisionPresent=_frameHash[name]||_frameHashLocal[name];name&&newName&&"number"==typeof newName&&collisionPresent&&numericNameWarningCount<5&&(numericNameWarningCount++,_$lib_539.warn('addFrames: overwriting frame "'+(_frameHash[name]||_frameHashLocal[name]).name+'" with a frame whose name of type "number" also equates to "'+name+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),5===numericNameWarningCount&&_$lib_539.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),_frameHashLocal[lookupName]={name:lookupName},insertions.push({frame:_$plots_647.supplyFrameDefaults(frameList[i]),index:indices&&void 0!==indices[i]&&null!==indices[i]?indices[i]:bigIndex+i})}insertions.sort(function(a,b){return a.index>b.index?-1:a.index<b.index?1:0});var ops=[],revops=[],frameCount=_frames.length;for(i=insertions.length-1;i>=0;i--){if("number"==typeof(frame=insertions[i].frame).name&&_$lib_539.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!frame.name)for(;_frameHash[frame.name="frame "+gd._transitionData._counter++];);if(_frameHash[frame.name]){for(j=0;j<_frames.length&&(_frames[j]||{}).name!==frame.name;j++);ops.push({type:"replace",index:j,value:frame}),revops.unshift({type:"replace",index:j,value:_frames[j]})}else idx=Math.max(0,Math.min(insertions[i].index,frameCount)),ops.push({type:"insert",index:idx,value:frame}),revops.unshift({type:"delete",index:idx}),frameCount++}var undoFunc=_$plots_647.modifyFrames,redoFunc=_$plots_647.modifyFrames,undoArgs=[gd,revops],redoArgs=[gd,ops];return _$queue_553&&_$queue_553.add(gd,undoFunc,undoArgs,redoFunc,redoArgs),_$plots_647.modifyFrames(gd,ops)},_$plot_api_573.deleteFrames=function(gd,frameList){if(gd=_$lib_539.getGraphDiv(gd),!_$lib_539.isPlotDiv(gd))throw new Error("This element is not a Plotly plot: "+gd);var i,idx,_frames=gd._transitionData._frames,ops=[],revops=[];if(!frameList)for(frameList=[],i=0;i<_frames.length;i++)frameList.push(i);for((frameList=frameList.slice(0)).sort(),i=frameList.length-1;i>=0;i--)idx=frameList[i],ops.push({type:"delete",index:idx}),revops.unshift({type:"insert",index:idx,value:_frames[idx]});var undoFunc=_$plots_647.modifyFrames,redoFunc=_$plots_647.modifyFrames,undoArgs=[gd,revops],redoArgs=[gd,ops];return _$queue_553&&_$queue_553.add(gd,undoFunc,undoArgs,redoFunc,redoArgs),_$plots_647.modifyFrames(gd,ops)},_$plot_api_573.purge=function purge(gd){var fullLayout=(gd=_$lib_539.getGraphDiv(gd))._fullLayout||{},fullData=gd._fullData||[];return _$plots_647.cleanPlot([],{},fullData,fullLayout),_$plots_647.purge(gd),_$Events_527.purge(gd),fullLayout._container&&fullLayout._container.remove(),delete gd._context,gd};var _$helpers_672={getDelay:function(fullLayout){return fullLayout._has&&(fullLayout._has("gl3d")||fullLayout._has("gl2d")||fullLayout._has("mapbox"))?500:0},getRedrawFunc:function(gd){var fullLayout=gd._fullLayout||{};if(!(!(fullLayout._has&&fullLayout._has("polar"))&&gd.data&&gd.data[0]&&gd.data[0].r))return function(){(gd.calcdata||[]).forEach(function(d){d[0]&&d[0].t&&d[0].t.cb&&d[0].t.cb()})}}},__EventEmitter_674=_$EventEmitter_137.EventEmitter;var _$svgToImg_674=function svgToImg(opts){var ev=opts.emitter||new __EventEmitter_674,promise=new Promise(function(resolve,reject){var Image=window.Image,svg=opts.svg,format=opts.format||"png";if(_$lib_539.isIE()&&"svg"!==format){var ieSvgError=new Error("Sorry IE does not support downloading from canvas. Try {format:'svg'} instead.");return reject(ieSvgError),opts.promise?promise:ev.emit("error",ieSvgError)}var canvas=opts.canvas,scale=opts.scale||1,w1=scale*(opts.width||300),h1=scale*(opts.height||150),ctx=canvas.getContext("2d"),img=new Image,url="data:image/svg+xml,"+encodeURIComponent(svg);canvas.width=w1,canvas.height=h1,img.onload=function(){var imgData;switch("svg"!==format&&ctx.drawImage(img,0,0,w1,h1),format){case"jpeg":imgData=canvas.toDataURL("image/jpeg");break;case"png":imgData=canvas.toDataURL("image/png");break;case"webp":imgData=canvas.toDataURL("image/webp");break;case"svg":imgData=url;break;default:var errorMsg="Image format is not jpeg, png, svg or webp.";if(reject(new Error(errorMsg)),!opts.promise)return ev.emit("error",errorMsg)}resolve(imgData),opts.promise||ev.emit("success",imgData)},img.onerror=function(err){if(reject(err),!opts.promise)return ev.emit("error",err)},img.src=url});return opts.promise?promise:ev},DOUBLEQUOTE_REGEX=/"/g,DUMMY_REGEX=new RegExp('("TOBESTRIPPED)|(TOBESTRIPPED")',"g");var _$toSVG_676=function toSVG(gd,format,scale){var i,fullLayout=gd._fullLayout,svg=fullLayout._paper,toppaper=fullLayout._toppaper,width=fullLayout.width,height=fullLayout.height;svg.insert("rect",":first-child").call(_$drawing_436.setRect,0,0,width,height).call(_$color_411.fill,fullLayout.paper_bgcolor);var basePlotModules=fullLayout._basePlotModules||[];for(i=0;i<basePlotModules.length;i++){var _module=basePlotModules[i];_module.toSVG&&_module.toSVG(gd)}if(toppaper){var nodes=toppaper.node().childNodes,topGroups=Array.prototype.slice.call(nodes);for(i=0;i<topGroups.length;i++){var topGroup=topGroups[i];topGroup.childNodes.length&&svg.node().appendChild(topGroup)}}fullLayout._draggers&&fullLayout._draggers.remove(),svg.node().style.background="",svg.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var txt=_$d3_127.select(this);if("hidden"!==this.style.visibility&&"none"!==this.style.display){txt.style({visibility:null,display:null});var ff=this.style.fontFamily;ff&&-1!==ff.indexOf('"')&&txt.style("font-family",ff.replace(DOUBLEQUOTE_REGEX,"TOBESTRIPPED"))}else txt.remove()}),svg.selectAll(".point,.scatterpts").each(function(){var pt=_$d3_127.select(this),fill=this.style.fill;fill&&-1!==fill.indexOf("url(")&&pt.style("fill",fill.replace(DOUBLEQUOTE_REGEX,"TOBESTRIPPED"))}),"pdf"!==format&&"eps"!==format||svg.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),svg.node().setAttributeNS(_$xmlns_namespaces_519.xmlns,"xmlns",_$xmlns_namespaces_519.svg),svg.node().setAttributeNS(_$xmlns_namespaces_519.xmlns,"xmlns:xlink",_$xmlns_namespaces_519.xlink),"svg"===format&&scale&&(svg.attr("width",scale*width),svg.attr("height",scale*height),svg.attr("viewBox","0 0 "+width+" "+height));var s=(new window.XMLSerializer).serializeToString(svg.node());return s=(s=function xmlEntityEncode(str){return str.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")}(s=function htmlEntityDecode(s){var hiddenDiv=_$d3_127.select("body").append("div").style({display:"none"}).html(""),replaced=s.replace(/(&[^;]*;)/gi,function(d){return"&lt;"===d?"&#60;":"&rt;"===d?"&#62;":-1!==d.indexOf("<")||-1!==d.indexOf(">")?"":hiddenDiv.html(d).text()});return hiddenDiv.remove(),replaced}(s))).replace(DUMMY_REGEX,"'"),_$lib_539.isIE()&&(s=(s=(s=s.replace(/"/gi,"'")).replace(/(\('#)([^']*)('\))/gi,'("#$2")')).replace(/(\\')/gi,'"')),s},__attrs_577={format:{valType:"enumerated",values:["png","jpeg","webp","svg"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}},IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/;var _$toImage_577=function toImage(gd,opts){var data,layout,config;function isImpliedOrValid(attr){return!(attr in opts)||_$lib_539.validate(opts[attr],__attrs_577[attr])}if(opts=opts||{},_$lib_539.isPlainObject(gd)?(data=gd.data||[],layout=gd.layout||{},config=gd.config||{}):(gd=_$lib_539.getGraphDiv(gd),data=_$lib_539.extendDeep([],gd.data),layout=_$lib_539.extendDeep({},gd.layout),config=gd._context),!isImpliedOrValid("width")||!isImpliedOrValid("height"))throw new Error("Height and width should be pixel values.");if(!isImpliedOrValid("format"))throw new Error("Image format is not jpeg, png, svg or webp.");var fullOpts={};function coerce(attr,dflt){return _$lib_539.coerce(opts,fullOpts,__attrs_577,attr,dflt)}var format=coerce("format"),width=coerce("width"),height=coerce("height"),scale=coerce("scale"),setBackground=coerce("setBackground"),imageDataOnly=coerce("imageDataOnly"),clonedGd=document.createElement("div");clonedGd.style.position="absolute",clonedGd.style.left="-5000px",document.body.appendChild(clonedGd);var layoutImage=_$lib_539.extendFlat({},layout);width&&(layoutImage.width=width),height&&(layoutImage.height=height);var configImage=_$lib_539.extendFlat({},config,{staticPlot:!0,setBackground:setBackground}),redrawFunc=_$helpers_672.getRedrawFunc(clonedGd);function wait(){return new Promise(function(resolve){setTimeout(resolve,_$helpers_672.getDelay(clonedGd._fullLayout))})}function convert(){return new Promise(function(resolve,reject){var svg=_$toSVG_676(clonedGd,format,scale),width=clonedGd._fullLayout.width,height=clonedGd._fullLayout.height;if(_$plot_api_573.purge(clonedGd),document.body.removeChild(clonedGd),"svg"===format)return resolve(imageDataOnly?svg:"data:image/svg+xml,"+encodeURIComponent(svg));var canvas=document.createElement("canvas");canvas.id=_$lib_539.randstr(),_$svgToImg_674({format:format,width:width,height:height,scale:scale,canvas:canvas,svg:svg,promise:!0}).then(resolve).catch(reject)})}return new Promise(function(resolve,reject){_$plot_api_573.plot(clonedGd,data,layoutImage,configImage).then(redrawFunc).then(wait).then(convert).then(function(url){resolve(function urlToImageData(url){return imageDataOnly?url.replace(IMAGE_URL_PREFIX,""):url}(url))}).catch(function(err){reject(err)})})},__isPlainObject_578=_$lib_539.isPlainObject,__isArray_578=Array.isArray,__isArrayOrTypedArray_578=_$lib_539.isArrayOrTypedArray;function __crawl_578(objIn,objOut,schema,list,base,path){path=path||[];for(var keys=Object.keys(objIn),i=0;i<keys.length;i++){var k=keys[i];if("transforms"!==k){var p=path.slice();p.push(k);var valIn=objIn[k],valOut=objOut[k],nestedSchema=getNestedSchema(schema,k),isInfoArray="info_array"===(nestedSchema||{}).valType,isColorscale="colorscale"===(nestedSchema||{}).valType,items=(nestedSchema||{}).items;if(isInSchema(schema,k))if(__isPlainObject_578(valIn)&&__isPlainObject_578(valOut))__crawl_578(valIn,valOut,nestedSchema,list,base,p);else if(isInfoArray&&__isArray_578(valIn)){valIn.length>valOut.length&&list.push(format("unused",base,p.concat(valOut.length)));var m,n,item,valInPart,valOutPart,len=valOut.length,arrayItems=Array.isArray(items);if(arrayItems&&(len=Math.min(len,items.length)),2===nestedSchema.dimensions)for(n=0;n<len;n++)if(__isArray_578(valIn[n])){valIn[n].length>valOut[n].length&&list.push(format("unused",base,p.concat(n,valOut[n].length)));var len2=valOut[n].length;for(m=0;m<(arrayItems?Math.min(len2,items[n].length):len2);m++)item=arrayItems?items[n][m]:items,valInPart=valIn[n][m],valOutPart=valOut[n][m],_$lib_539.validate(valInPart,item)?valOutPart!==valInPart&&valOutPart!==+valInPart&&list.push(format("dynamic",base,p.concat(n,m),valInPart,valOutPart)):list.push(format("value",base,p.concat(n,m),valInPart))}else list.push(format("array",base,p.concat(n),valIn[n]));else for(n=0;n<len;n++)item=arrayItems?items[n]:items,valInPart=valIn[n],valOutPart=valOut[n],_$lib_539.validate(valInPart,item)?valOutPart!==valInPart&&valOutPart!==+valInPart&&list.push(format("dynamic",base,p.concat(n),valInPart,valOutPart)):list.push(format("value",base,p.concat(n),valInPart))}else if(nestedSchema.items&&!isInfoArray&&__isArray_578(valIn)){var j,_p,_nestedSchema=items[Object.keys(items)[0]],indexList=[];for(j=0;j<valOut.length;j++){var _index=valOut[j]._index||j;(_p=p.slice()).push(_index),__isPlainObject_578(valIn[_index])&&__isPlainObject_578(valOut[j])&&(indexList.push(_index),__crawl_578(valIn[_index],valOut[j],_nestedSchema,list,base,_p))}for(j=0;j<valIn.length;j++)(_p=p.slice()).push(j),__isPlainObject_578(valIn[j])?-1===indexList.indexOf(j)&&list.push(format("unused",base,_p)):list.push(format("object",base,_p,valIn[j]))}else!__isPlainObject_578(valIn)&&__isPlainObject_578(valOut)?list.push(format("object",base,p,valIn)):__isArrayOrTypedArray_578(valIn)||!__isArrayOrTypedArray_578(valOut)||isInfoArray||isColorscale?k in objOut?_$lib_539.validate(valIn,nestedSchema)?"enumerated"===nestedSchema.valType&&(nestedSchema.coerceNumber&&valIn!==+valOut||valIn!==valOut)&&list.push(format("dynamic",base,p,valIn,valOut)):list.push(format("value",base,p,valIn)):list.push(format("unused",base,p,valIn)):list.push(format("array",base,p,valIn));else list.push(format("schema",base,p))}}return list}var code2msgFunc={object:function(base,astr){return("layout"===base&&""===astr?"The layout argument":"data"===base[0]&&""===astr?"Trace "+base[1]+" in the data argument":inBase(base)+"key "+astr)+" must be linked to an object container"},array:function(base,astr){return("data"===base?"The data argument":inBase(base)+"key "+astr)+" must be linked to an array container"},schema:function(base,astr){return inBase(base)+"key "+astr+" is not part of the schema"},unused:function(base,astr,valIn){var target=__isPlainObject_578(valIn)?"container":"key";return inBase(base)+target+" "+astr+" did not get coerced"},dynamic:function(base,astr,valIn,valOut){return[inBase(base)+"key",astr,"(set to '"+valIn+"')","got reset to","'"+valOut+"'","during defaults."].join(" ")},invisible:function(base){return"Trace "+base[1]+" got defaulted to be not visible"},value:function(base,astr,valIn){return[inBase(base)+"key "+astr,"is set to an invalid value ("+valIn+")"].join(" ")}};function inBase(base){return __isArray_578(base)?"In data trace "+base[1]+", ":"In "+base+", "}function format(code,base,path,valIn,valOut){var container,trace;path=path||"",__isArray_578(base)?(container=base[0],trace=base[1]):(container=base,trace=null);var astr=function convertPathToAttributeString(path){if(!__isArray_578(path))return String(path);for(var astr="",i=0;i<path.length;i++){var p=path[i];"number"==typeof p?astr=astr.substr(0,astr.length-1)+"["+p+"]":astr+=p,i<path.length-1&&(astr+=".")}return astr}(path),msg=code2msgFunc[code](base,astr,valIn,valOut);return _$lib_539.log(msg),{code:code,container:container,trace:trace,path:path,astr:astr,msg:msg}}function isInSchema(schema,key){var parts=splitKey(key),keyMinusId=parts.keyMinusId,id=parts.id;return!!(keyMinusId in schema&&schema[keyMinusId]._isSubplotObj&&id)||key in schema}function getNestedSchema(schema,key){return schema[splitKey(key).keyMinusId]}var idRegex=_$lib_539.counterRegex("([a-z]+)");function splitKey(key){var idMatch=key.match(idRegex);return{keyMinusId:idMatch&&idMatch[1],id:idMatch&&idMatch[2]}}var _$fileSaver_671=function(url,name){var saveLink=document.createElement("a"),canUseSaveLink="download"in saveLink,isSafari=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent);return new Promise(function(resolve,reject){if("undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent)&&reject(new Error("IE < 10 unsupported")),isSafari&&(document.location.href="data:application/octet-stream"+url.slice(url.search(/[,;]/)),resolve(name)),name||(name="download"),canUseSaveLink&&(saveLink.href=url,saveLink.download=name,document.body.appendChild(saveLink),saveLink.click(),document.body.removeChild(saveLink),resolve(name)),"undefined"!=typeof navigator&&navigator.msSaveBlob){var encoded=url.split(/^data:image\/svg\+xml,/)[1],svg=decodeURIComponent(encoded);navigator.msSaveBlob(new Blob([svg]),name),resolve(name)}reject(new Error("download error"))})};var _$downloadImage_670=function downloadImage(gd,opts){return(opts=opts||{}).format=opts.format||"png",new Promise(function(resolve,reject){gd._snapshotInProgress&&reject(new Error("Snapshotting already in progress.")),_$lib_539.isIE()&&"svg"!==opts.format&&reject(new Error("Sorry IE does not support downloading from canvas. Try {format:'svg'} instead.")),gd._snapshotInProgress=!0;var promise=_$toImage_577(gd,opts),filename=opts.filename||gd.fn||"newplot";filename+="."+opts.format,promise.then(function(result){return gd._snapshotInProgress=!1,_$fileSaver_671(result,filename)}).then(function(name){resolve(name)}).catch(function(err){gd._snapshotInProgress=!1,reject(err)})})},_$plot_api_571={};_$plot_api_571.plot=_$plot_api_573.plot,_$plot_api_571.newPlot=_$plot_api_573.newPlot,_$plot_api_571.restyle=_$plot_api_573.restyle,_$plot_api_571.relayout=_$plot_api_573.relayout,_$plot_api_571.redraw=_$plot_api_573.redraw,_$plot_api_571.update=_$plot_api_573.update,_$plot_api_571.react=_$plot_api_573.react,_$plot_api_571.extendTraces=_$plot_api_573.extendTraces,_$plot_api_571.prependTraces=_$plot_api_573.prependTraces,_$plot_api_571.addTraces=_$plot_api_573.addTraces,_$plot_api_571.deleteTraces=_$plot_api_573.deleteTraces,_$plot_api_571.moveTraces=_$plot_api_573.moveTraces,_$plot_api_571.purge=_$plot_api_573.purge,_$plot_api_571.addFrames=_$plot_api_573.addFrames,_$plot_api_571.deleteFrames=_$plot_api_573.deleteFrames,_$plot_api_571.animate=_$plot_api_573.animate,_$plot_api_571.setPlotConfig=_$plot_api_573.setPlotConfig,_$plot_api_571.toImage=_$toImage_577,_$plot_api_571.validate=function valiate(data,layout){var dataIn,layoutIn,schema=_$plot_schema_575.get(),errorList=[],gd={_context:_$lib_539.extendFlat({},_$plot_config_574)};__isArray_578(data)?(gd.data=_$lib_539.extendDeep([],data),dataIn=data):(gd.data=[],dataIn=[],errorList.push(format("array","data"))),__isPlainObject_578(layout)?(gd.layout=_$lib_539.extendDeep({},layout),layoutIn=layout):(gd.layout={},layoutIn={},arguments.length>1&&errorList.push(format("object","layout"))),_$plots_647.supplyDefaults(gd);for(var dataOut=gd._fullData,len=dataIn.length,i=0;i<len;i++){var traceIn=dataIn[i],base=["data",i];if(__isPlainObject_578(traceIn)){var traceOut=dataOut[i],traceType=traceOut.type,traceSchema=schema.traces[traceType].attributes;traceSchema.type={valType:"enumerated",values:[traceType]},!1===traceOut.visible&&!1!==traceIn.visible&&errorList.push(format("invisible",base)),__crawl_578(traceIn,traceOut,traceSchema,errorList,base);var transformsIn=traceIn.transforms,transformsOut=traceOut.transforms;if(transformsIn){__isArray_578(transformsIn)||errorList.push(format("array",base,["transforms"])),base.push("transforms");for(var j=0;j<transformsIn.length;j++){var path=["transforms",j],transformType=transformsIn[j].type;if(__isPlainObject_578(transformsIn[j])){var transformSchema=schema.transforms[transformType]?schema.transforms[transformType].attributes:{};transformSchema.type={valType:"enumerated",values:Object.keys(schema.transforms)},__crawl_578(transformsIn[j],transformsOut[j],transformSchema,errorList,base,path)}else errorList.push(format("object",base,path))}}}else errorList.push(format("object",base))}return __crawl_578(layoutIn,gd._fullLayout,function fillLayoutSchema(schema,dataOut){for(var i=0;i<dataOut.length;i++){var traceType=dataOut[i].type,traceLayoutAttr=schema.traces[traceType].layoutAttributes;traceLayoutAttr&&_$lib_539.extendFlat(schema.layout.layoutAttributes,traceLayoutAttr)}return schema.layout.layoutAttributes}(schema,dataOut),errorList,"layout"),0===errorList.length?void 0:errorList},_$plot_api_571.downloadImage=_$downloadImage_670;var __extendFlat_669=_$lib_539.extendFlat,extendDeep=_$lib_539.extendDeep;function cloneLayoutOverride(tileClass){var override;switch(tileClass){case"themes__thumb":override={autosize:!0,width:150,height:150,title:"",showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":override={title:"",hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:override={}}return override}var _$clonePlot_669=function clonePlot(graphObj,options){var i;graphObj.framework&&graphObj.framework.isPolar&&(graphObj=graphObj.framework.getConfig());var keyName,oldData=graphObj.data,oldLayout=graphObj.layout,newData=extendDeep([],oldData),newLayout=extendDeep({},oldLayout,cloneLayoutOverride(options.tileClass)),context=graphObj._context||{};if(options.width&&(newLayout.width=options.width),options.height&&(newLayout.height=options.height),"thumbnail"===options.tileClass||"themes__thumb"===options.tileClass){newLayout.annotations=[];var keys=Object.keys(newLayout);for(i=0;i<keys.length;i++)keyName=keys[i],["xaxis","yaxis","zaxis"].indexOf(keyName.slice(0,5))>-1&&(newLayout[keys[i]].title="");for(i=0;i<newData.length;i++){var trace=newData[i];trace.showscale=!1,trace.marker&&(trace.marker.showscale=!1),"pie"===trace.type&&(trace.textposition="none")}}if(Array.isArray(options.annotations))for(i=0;i<options.annotations.length;i++)newLayout.annotations.push(options.annotations[i]);var sceneIds=Object.keys(newLayout).filter(function(key){return key.match(/^scene\d*$/)});if(sceneIds.length){var axesImageOverride={};for("thumbnail"===options.tileClass&&(axesImageOverride={title:"",showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),i=0;i<sceneIds.length;i++){var scene=newLayout[sceneIds[i]];scene.xaxis||(scene.xaxis={}),scene.yaxis||(scene.yaxis={}),scene.zaxis||(scene.zaxis={}),__extendFlat_669(scene.xaxis,axesImageOverride),__extendFlat_669(scene.yaxis,axesImageOverride),__extendFlat_669(scene.zaxis,axesImageOverride),scene._scene=null}}var gd=document.createElement("div");options.tileClass&&(gd.className=options.tileClass);var plotTile={gd:gd,td:gd,layout:newLayout,data:newData,config:{staticPlot:void 0===options.staticPlot||options.staticPlot,plotGlPixelRatio:void 0===options.plotGlPixelRatio?2:options.plotGlPixelRatio,displaylogo:options.displaylogo||!1,showLink:options.showLink||!1,showTips:options.showTips||!1,mapboxAccessToken:context.mapboxAccessToken}};return"transparent"!==options.setBackground&&(plotTile.config.setBackground=options.setBackground||"opaque"),plotTile.gd.defaultLayout=cloneLayoutOverride(options.tileClass),plotTile},__EventEmitter_675=_$EventEmitter_137.EventEmitter;var _$toImage_675=function __toImage_675(gd,opts){var ev=new __EventEmitter_675,clone=_$clonePlot_669(gd,{format:"png"}),clonedGd=clone.gd;clonedGd.style.position="absolute",clonedGd.style.left="-5000px",document.body.appendChild(clonedGd);var redrawFunc=_$helpers_672.getRedrawFunc(clonedGd);return _$registry_668.call("plot",clonedGd,clone.data,clone.layout,clone.config).then(redrawFunc).then(function wait(){var delay=_$helpers_672.getDelay(clonedGd._fullLayout);setTimeout(function(){var svg=_$toSVG_676(clonedGd),canvas=document.createElement("canvas");canvas.id=_$lib_539.randstr(),(ev=_$svgToImg_674({format:opts.format,width:clonedGd._fullLayout.width,height:clonedGd._fullLayout.height,canvas:canvas,emitter:ev,svg:svg})).clean=function(){clonedGd&&document.body.removeChild(clonedGd)}},delay)}).catch(function(err){ev.emit("error",err)}),ev},_$Snapshot_673={getDelay:_$helpers_672.getDelay,getRedrawFunc:_$helpers_672.getRedrawFunc,clone:_$clonePlot_669,toSVG:_$toSVG_676,svgToImg:_$svgToImg_674,toImage:_$toImage_675,downloadImage:_$downloadImage_670},_$calcMarkerColorscale_867=function calcMarkerColorscale(trace){_$subtypes_884.hasLines(trace)&&_$hasColorscale_425(trace,"line")&&_$calc_418(trace,trace.line.color,"line","c"),_$subtypes_884.hasMarkers(trace)&&(_$hasColorscale_425(trace,"marker")&&_$calc_418(trace,trace.marker.color,"marker","c"),_$hasColorscale_425(trace,"marker.line")&&_$calc_418(trace,trace.marker.line.color,"marker.line","c"))},__isArrayOrTypedArray_863=_$lib_539.isArrayOrTypedArray,__BADNUM_863=_$numerical_517.BADNUM;function calcAxisExpansion(gd,trace,xa,ya,x,y,ppad){var serieslen=trace._length;xa._minDtick=0,ya._minDtick=0;var xOptions={padded:!0},yOptions={padded:!0};ppad&&(xOptions.ppad=yOptions.ppad=ppad),!("tozerox"===trace.fill||"tonextx"===trace.fill&&gd.firstscatter)||x[0]===x[serieslen-1]&&y[0]===y[serieslen-1]?trace.error_y.visible||-1===["tonexty","tozeroy"].indexOf(trace.fill)&&(_$subtypes_884.hasMarkers(trace)||_$subtypes_884.hasText(trace))||(xOptions.padded=!1,xOptions.ppad=0):xOptions.tozero=!0,!("tozeroy"===trace.fill||"tonexty"===trace.fill&&gd.firstscatter)||x[0]===x[serieslen-1]&&y[0]===y[serieslen-1]?-1!==["tonextx","tozerox"].indexOf(trace.fill)&&(yOptions.padded=!1):yOptions.tozero=!0,_$axes_584.expand(xa,x,xOptions),_$axes_584.expand(ya,y,yOptions)}function calcMarkerSize(trace,serieslen){if(_$subtypes_884.hasMarkers(trace)){var markerTrans,marker=trace.marker,sizeref=1.6*(trace.marker.sizeref||1);if(markerTrans="area"===trace.marker.sizemode?function(v){return Math.max(Math.sqrt((v||0)/sizeref),3)}:function(v){return Math.max((v||0)/sizeref,3)},__isArrayOrTypedArray_863(marker.size)){var ax={type:"linear"};_$axes_584.setConvert(ax);for(var s=ax.makeCalcdata(trace.marker,"size"),sizeOut=new Array(serieslen),i=0;i<serieslen;i++)sizeOut[i]=markerTrans(s[i]);return sizeOut}return markerTrans(marker.size)}}var _$calc___calc=function __calc_863(gd,trace){var xa=_$axes_584.getFromId(gd,trace.xaxis||"x"),ya=_$axes_584.getFromId(gd,trace.yaxis||"y"),x=xa.makeCalcdata(trace,"x"),y=ya.makeCalcdata(trace,"y"),serieslen=trace._length,cd=new Array(serieslen);calcAxisExpansion(gd,trace,xa,ya,x,y,calcMarkerSize(trace,serieslen));for(var i=0;i<serieslen;i++)cd[i]=_$fastIsnumeric_139(x[i])&&_$fastIsnumeric_139(y[i])?{x:x[i],y:y[i]}:{x:__BADNUM_863,y:__BADNUM_863},trace.ids&&(cd[i].id=String(trace.ids[i]));return _$arraysToCalcdata_861(cd,trace),_$calcMarkerColorscale_867(trace),_$calcSelection_864(cd,trace),gd.firstscatter=!1,cd},_$calc___calcMarkerSize=calcMarkerSize,_$calc___calcAxisExpansion=calcAxisExpansion,_$cleanData_865=function cleanData(fullData){for(var i=0;i<fullData.length;i++){var tracei=fullData[i];if("scatter"===tracei.type){var filli=tracei.fill;if("none"!==filli&&"toself"!==filli&&(tracei.opacity=void 0,"tonexty"===filli||"tonextx"===filli))for(var j=i-1;j>=0;j--){var tracej=fullData[j];if("scatter"===tracej.type&&tracej.xaxis===tracei.xaxis&&tracej.yaxis===tracei.yaxis){tracej.opacity=void 0;break}}}}},__isArrayOrTypedArray_871=_$lib_539.isArrayOrTypedArray,_$fillColorDefaults_871=function fillColorDefaults(traceIn,traceOut,defaultColor,coerce){var inheritColorFromMarker=!1;if(traceOut.marker){var markerColor=traceOut.marker.color,markerLineColor=(traceOut.marker.line||{}).color;markerColor&&!__isArrayOrTypedArray_871(markerColor)?inheritColorFromMarker=markerColor:markerLineColor&&!__isArrayOrTypedArray_871(markerLineColor)&&(inheritColorFromMarker=markerLineColor)}coerce("fillcolor",_$color_411.addOpacity((traceOut.line||{}).color||inheritColorFromMarker||defaultColor,.5))},__isArrayOrTypedArray_875=_$lib_539.isArrayOrTypedArray,_$lineDefaults_875=function lineDefaults(traceIn,traceOut,defaultColor,layout,coerce,opts){var markerColor=(traceIn.marker||{}).color;(coerce("line.color",defaultColor),_$hasColorscale_425(traceIn,"line"))?_$colorScaleDefaults_421(traceIn,traceOut,layout,coerce,{prefix:"line.",cLetter:"c"}):coerce("line.color",!__isArrayOrTypedArray_875(markerColor)&&markerColor||defaultColor);coerce("line.width"),(opts||{}).noDash||coerce("line.dash")},_$handleLineShapeDefaults_877=function handleLineShapeDefaults(traceIn,traceOut,coerce){"spline"===coerce("line.shape")&&coerce("line.smoothing")},_$markerDefaults_880=function markerDefaults(traceIn,traceOut,defaultColor,layout,coerce,opts){var isBubble=_$subtypes_884.isBubble(traceIn),lineColor=(traceIn.line||{}).color;(opts=opts||{},lineColor&&(defaultColor=lineColor),coerce("marker.symbol"),coerce("marker.opacity",isBubble?.7:1),coerce("marker.size"),coerce("marker.color",defaultColor),_$hasColorscale_425(traceIn,"marker")&&_$colorScaleDefaults_421(traceIn,traceOut,layout,coerce,{prefix:"marker.",cLetter:"c"}),opts.noSelect||(coerce("selected.marker.color"),coerce("unselected.marker.color"),coerce("selected.marker.size"),coerce("unselected.marker.size")),opts.noLine||(coerce("marker.line.color",lineColor&&!Array.isArray(lineColor)&&traceOut.marker.color!==lineColor?lineColor:isBubble?_$color_411.background:_$color_411.defaultLine),_$hasColorscale_425(traceIn,"marker.line")&&_$colorScaleDefaults_421(traceIn,traceOut,layout,coerce,{prefix:"marker.line.",cLetter:"c"}),coerce("marker.line.width",isBubble?1:0)),isBubble&&(coerce("marker.sizeref"),coerce("marker.sizemin"),coerce("marker.sizemode")),opts.gradient)&&("none"!==coerce("marker.gradient.type")&&coerce("marker.gradient.color"))},_$text_defaults_885=function(traceIn,traceOut,layout,coerce,opts){opts=opts||{},coerce("textposition"),_$lib_539.coerceFont(coerce,"textfont",layout.font),opts.noSelect||(coerce("selected.textfont.color"),coerce("unselected.textfont.color"))},_$getTraceColor_872=function getTraceColor(trace,di){var lc,tc;if("lines"===trace.mode)return(lc=trace.line.color)&&_$color_411.opacity(lc)?lc:trace.fillcolor;if("none"===trace.mode)return trace.fill?trace.fillcolor:"";var mc=di.mcc||(trace.marker||{}).color,mlc=di.mlcc||((trace.marker||{}).line||{}).color;return(tc=mc&&_$color_411.opacity(mc)?mc:mlc&&_$color_411.opacity(mlc)&&(di.mlw||((trace.marker||{}).line||{}).width)?mlc:"")?_$color_411.opacity(tc)<.3?_$color_411.addOpacity(tc,.3):tc:(lc=(trace.line||{}).color)&&_$color_411.opacity(lc)&&_$subtypes_884.hasLines(trace)&&trace.line.width?lc:trace.fillcolor},_$hoverPoints_873=function hoverPoints(pointData,xval,yval,hovermode){var cd=pointData.cd,trace=cd[0].trace,xa=pointData.xa,ya=pointData.ya,xpx=xa.c2p(xval),ypx=ya.c2p(yval),pt=[xpx,ypx],hoveron=trace.hoveron||"",minRad=-1!==trace.mode.indexOf("markers")?3:.5;if(-1!==hoveron.indexOf("points")){var dxy=function(di){var rad=Math.max(minRad,di.mrc||0),dx=xa.c2p(di.x)-xpx,dy=ya.c2p(di.y)-ypx;return Math.max(Math.sqrt(dx*dx+dy*dy)-rad,1-minRad/rad)},distfn=_$fx_453.getDistanceFunction(hovermode,function(di){var rad=Math.max(3,di.mrc||0),kink=1-1/rad,dxRaw=Math.abs(xa.c2p(di.x)-xpx);return dxRaw<rad?kink*dxRaw/rad:dxRaw-rad+kink},function(di){var rad=Math.max(3,di.mrc||0),kink=1-1/rad,dyRaw=Math.abs(ya.c2p(di.y)-ypx);return dyRaw<rad?kink*dyRaw/rad:dyRaw-rad+kink},dxy);if(_$fx_453.getClosest(cd,distfn,pointData),!1!==pointData.index){var di=cd[pointData.index],xc=xa.c2p(di.x,!0),yc=ya.c2p(di.y,!0),rad=di.mrc||1;return _$lib_539.extendFlat(pointData,{color:_$getTraceColor_872(trace,di),x0:xc-rad,x1:xc+rad,xLabelVal:di.x,y0:yc-rad,y1:yc+rad,yLabelVal:di.y,spikeDistance:dxy(di)}),_$fillHoverText_870(di,trace,pointData),_$registry_668.getComponentMethod("errorbars","hoverInfo")(di,trace,pointData),[pointData]}}if(-1!==hoveron.indexOf("fills")&&trace._polygons){var i,j,polygon,pts,xCross,x0,x1,y0,y1,polygons=trace._polygons,polygonsIn=[],inside=!1,xmin=1/0,xmax=-1/0,ymin=1/0,ymax=-1/0;for(i=0;i<polygons.length;i++)(polygon=polygons[i]).contains(pt)&&(inside=!inside,polygonsIn.push(polygon),ymin=Math.min(ymin,polygon.ymin),ymax=Math.max(ymax,polygon.ymax));if(inside){var yAvg=((ymin=Math.max(ymin,0))+(ymax=Math.min(ymax,ya._length)))/2;for(i=0;i<polygonsIn.length;i++)for(pts=polygonsIn[i].pts,j=1;j<pts.length;j++)(y0=pts[j-1][1])>yAvg!=(y1=pts[j][1])>=yAvg&&(x0=pts[j-1][0],x1=pts[j][0],y1-y0&&(xCross=x0+(x1-x0)*(yAvg-y0)/(y1-y0),xmin=Math.min(xmin,xCross),xmax=Math.max(xmax,xCross)));xmin=Math.max(xmin,0),xmax=Math.min(xmax,xa._length);var color=_$color_411.defaultLine;return _$color_411.opacity(trace.fillcolor)?color=trace.fillcolor:_$color_411.opacity((trace.line||{}).color)&&(color=trace.line.color),_$lib_539.extendFlat(pointData,{distance:pointData.maxHoverDistance,x0:xmin,x1:xmax,y0:yAvg,y1:yAvg,color:color}),delete pointData.index,trace.text&&!Array.isArray(trace.text)?pointData.text=String(trace.text):pointData.text=trace.name,[pointData]}}},__BADNUM_876=_$numerical_517.BADNUM,__segmentsIntersect_876=_$lib_539.segmentsIntersect,constrain=_$lib_539.constrain,_$linePoints_876=function linePoints(d,opts){var i,clusterStartPt,clusterEndPt,clusterHighPt,clusterLowPt,thisPt,clusterHighFirst,clusterUnitVector,thisVector,clusterRefDist,clusterHighVal,clusterLowVal,thisVal,clusterMinDeviation,clusterMaxDeviation,thisDeviation,xa=opts.xaxis,ya=opts.yaxis,simplify=opts.simplify,connectGaps=opts.connectGaps,baseTolerance=opts.baseTolerance,shape=opts.shape,linear="linear"===shape,segments=[],minTolerance=_$constants_868.minTolerance,pts=new Array(d.length),pti=0;function getPt(index){var di=d[index],x=xa.c2p(di.x),y=ya.c2p(di.y);return x===__BADNUM_876||y===__BADNUM_876?di.intoCenter||!1:[x,y]}function getTolerance(pt){var xFrac=pt[0]/xa._length,yFrac=pt[1]/ya._length;return(1+_$constants_868.toleranceGrowth*Math.max(0,-xFrac,xFrac-1,-yFrac,yFrac-1))*baseTolerance}function ptDist(pt1,pt2){var dx=pt1[0]-pt2[0],dy=pt1[1]-pt2[1];return Math.sqrt(dx*dx+dy*dy)}simplify||(baseTolerance=minTolerance=-1);var xEdge,yEdge,lastXEdge,lastYEdge,lastFarPt,edgePt,getEdgeIntersections,maxScreensAway=_$constants_868.maxScreensAway,xEdge0=-xa._length*maxScreensAway,xEdge1=xa._length*(1+maxScreensAway),yEdge0=-ya._length*maxScreensAway,yEdge1=ya._length*(1+maxScreensAway),edges=[[xEdge0,yEdge0,xEdge1,yEdge0],[xEdge1,yEdge0,xEdge1,yEdge1],[xEdge1,yEdge1,xEdge0,yEdge1],[xEdge0,yEdge1,xEdge0,yEdge0]];function onlyConstrainedPoint(pt){if(pt[0]<xEdge0||pt[0]>xEdge1||pt[1]<yEdge0||pt[1]>yEdge1)return[constrain(pt[0],xEdge0,xEdge1),constrain(pt[1],yEdge0,yEdge1)]}function sameEdge(pt1,pt2){return pt1[0]===pt2[0]&&(pt1[0]===xEdge0||pt1[0]===xEdge1)||(pt1[1]===pt2[1]&&(pt1[1]===yEdge0||pt1[1]===yEdge1)||void 0)}function getABAEdgeIntersections(dim,limit0,limit1){return function(pt1,pt2){var ptInt1=onlyConstrainedPoint(pt1),ptInt2=onlyConstrainedPoint(pt2),out=[];if(ptInt1&&ptInt2&&sameEdge(ptInt1,ptInt2))return out;ptInt1&&out.push(ptInt1),ptInt2&&out.push(ptInt2);var midShift=2*_$lib_539.constrain((pt1[dim]+pt2[dim])/2,limit0,limit1)-((ptInt1||pt1)[dim]+(ptInt2||pt2)[dim]);midShift&&((ptInt1&&ptInt2?midShift>0==ptInt1[dim]>ptInt2[dim]?ptInt1:ptInt2:ptInt1||ptInt2)[dim]+=midShift);return out}}function updateEdge(pt){var x=pt[0],y=pt[1],xSame=x===pts[pti-1][0],ySame=y===pts[pti-1][1];if(!xSame||!ySame)if(pti>1){var xSame2=x===pts[pti-2][0],ySame2=y===pts[pti-2][1];xSame&&(x===xEdge0||x===xEdge1)&&xSame2?ySame2?pti--:pts[pti-1]=pt:ySame&&(y===yEdge0||y===yEdge1)&&ySame2?xSame2?pti--:pts[pti-1]=pt:pts[pti++]=pt}else pts[pti++]=pt}function updateEdgesForReentry(pt){pts[pti-1][0]!==pt[0]&&pts[pti-1][1]!==pt[1]&&updateEdge([lastXEdge,lastYEdge]),updateEdge(pt),lastFarPt=null,lastXEdge=lastYEdge=0}function addPt(pt){if(xEdge=pt[0]<xEdge0?xEdge0:pt[0]>xEdge1?xEdge1:0,yEdge=pt[1]<yEdge0?yEdge0:pt[1]>yEdge1?yEdge1:0,xEdge||yEdge){if(pti)if(lastFarPt){var intersections=getEdgeIntersections(lastFarPt,pt);intersections.length>1&&(updateEdgesForReentry(intersections[0]),pts[pti++]=intersections[1])}else edgePt=getEdgeIntersections(pts[pti-1],pt)[0],pts[pti++]=edgePt;else pts[pti++]=[xEdge||pt[0],yEdge||pt[1]];var lastPt=pts[pti-1];xEdge&&yEdge&&(lastPt[0]!==xEdge||lastPt[1]!==yEdge)?(lastFarPt&&(lastXEdge!==xEdge&&lastYEdge!==yEdge?updateEdge(lastXEdge&&lastYEdge?function getClosestCorner(pt1,pt2){var dx=pt2[0]-pt1[0],m=(pt2[1]-pt1[1])/dx;return(pt1[1]*pt2[0]-pt2[1]*pt1[0])/dx>0?[m>0?xEdge0:xEdge1,yEdge1]:[m>0?xEdge1:xEdge0,yEdge0]}(lastFarPt,pt):[lastXEdge||xEdge,lastYEdge||yEdge]):lastXEdge&&lastYEdge&&updateEdge([lastXEdge,lastYEdge])),updateEdge([xEdge,yEdge])):lastXEdge-xEdge&&lastYEdge-yEdge&&updateEdge([xEdge||lastXEdge,yEdge||lastYEdge]),lastFarPt=pt,lastXEdge=xEdge,lastYEdge=yEdge}else lastFarPt&&updateEdgesForReentry(getEdgeIntersections(lastFarPt,pt)[0]),pts[pti++]=pt}for("linear"===shape||"spline"===shape?getEdgeIntersections=function getLinearEdgeIntersections(pt1,pt2){for(var out=[],ptCount=0,i=0;i<4;i++){var edge=edges[i],ptInt=__segmentsIntersect_876(pt1[0],pt1[1],pt2[0],pt2[1],edge[0],edge[1],edge[2],edge[3]);ptInt&&(!ptCount||Math.abs(ptInt.x-out[0][0])>1||Math.abs(ptInt.y-out[0][1])>1)&&(ptInt=[ptInt.x,ptInt.y],ptCount&&ptDist(ptInt,pt1)<ptDist(out[0],pt1)?out.unshift(ptInt):out.push(ptInt),ptCount++)}return out}:"hv"===shape||"vh"===shape?getEdgeIntersections=function getHVEdgeIntersections(pt1,pt2){var out=[],ptInt1=onlyConstrainedPoint(pt1),ptInt2=onlyConstrainedPoint(pt2);return ptInt1&&ptInt2&&sameEdge(ptInt1,ptInt2)?out:(ptInt1&&out.push(ptInt1),ptInt2&&out.push(ptInt2),out)}:"hvh"===shape?getEdgeIntersections=getABAEdgeIntersections(0,xEdge0,xEdge1):"vhv"===shape&&(getEdgeIntersections=getABAEdgeIntersections(1,yEdge0,yEdge1)),i=0;i<d.length;i++)if(clusterStartPt=getPt(i)){for(pti=0,lastFarPt=null,addPt(clusterStartPt),i++;i<d.length;i++){if(!(clusterHighPt=getPt(i))){if(connectGaps)continue;break}if(linear){if(!((clusterRefDist=ptDist(clusterHighPt,clusterStartPt))<getTolerance(clusterHighPt)*minTolerance)){for(clusterUnitVector=[(clusterHighPt[0]-clusterStartPt[0])/clusterRefDist,(clusterHighPt[1]-clusterStartPt[1])/clusterRefDist],clusterLowPt=clusterStartPt,clusterHighVal=clusterRefDist,clusterLowVal=clusterMinDeviation=clusterMaxDeviation=0,clusterHighFirst=!1,clusterEndPt=clusterHighPt,i++;i<d.length;i++){if(!(thisPt=getPt(i))){if(connectGaps)continue;break}if(thisDeviation=(thisVector=[thisPt[0]-clusterStartPt[0],thisPt[1]-clusterStartPt[1]])[0]*clusterUnitVector[1]-thisVector[1]*clusterUnitVector[0],clusterMinDeviation=Math.min(clusterMinDeviation,thisDeviation),(clusterMaxDeviation=Math.max(clusterMaxDeviation,thisDeviation))-clusterMinDeviation>getTolerance(thisPt))break;clusterEndPt=thisPt,(thisVal=thisVector[0]*clusterUnitVector[0]+thisVector[1]*clusterUnitVector[1])>clusterHighVal?(clusterHighVal=thisVal,clusterHighPt=thisPt,clusterHighFirst=!1):thisVal<clusterLowVal&&(clusterLowVal=thisVal,clusterLowPt=thisPt,clusterHighFirst=!0)}if(clusterHighFirst?(addPt(clusterHighPt),clusterEndPt!==clusterLowPt&&addPt(clusterLowPt)):(clusterLowPt!==clusterStartPt&&addPt(clusterLowPt),clusterEndPt!==clusterHighPt&&addPt(clusterHighPt)),addPt(clusterEndPt),i>=d.length||!thisPt)break;addPt(thisPt),clusterStartPt=thisPt}}else addPt(clusterHighPt)}lastFarPt&&updateEdge([lastXEdge||lastFarPt[0],lastYEdge||lastFarPt[1]]),segments.push(pts.slice(0,pti))}return segments},_$linkTraces_878=function linkTraces(gd,plotinfo,cdscatter){var trace,i,prevtrace=null;for(i=0;i<cdscatter.length;++i)!0===(trace=cdscatter[i][0].trace).visible?(trace._nexttrace=null,-1!==["tonextx","tonexty","tonext"].indexOf(trace.fill)&&(trace._prevtrace=prevtrace,prevtrace&&(prevtrace._nexttrace=trace)),prevtrace=trace):trace._prevtrace=trace._nexttrace=null},__polygonTester_881=_$polygon_551.tester,_$plot_881=function plot(gd,plotinfo,cdscatter,transitionOpts,makeOnCompleteCallback){var i,uids,join,onComplete,scatterlayer=plotinfo.plot.select("g.scatterlayer"),isFullReplot=!transitionOpts,hasTransition=!!transitionOpts&&transitionOpts.duration>0;for((join=scatterlayer.selectAll("g.trace").data(cdscatter,function(d){return d[0].trace.uid})).enter().append("g").attr("class",function(d){return"trace scatter trace"+d[0].trace.uid}).style("stroke-miterlimit",2),_$linkTraces_878(gd,plotinfo,cdscatter),function createFills(gd,scatterlayer,plotinfo){var trace;scatterlayer.selectAll("g.trace").each(function(d){var tr=_$d3_127.select(this);if((trace=d[0].trace)._nexttrace){if(trace._nextFill=tr.select(".js-fill.js-tonext"),!trace._nextFill.size()){var loc=":first-child";tr.select(".js-fill.js-tozero").size()&&(loc+=" + *"),trace._nextFill=tr.insert("path",loc).attr("class","js-fill js-tonext")}}else tr.selectAll(".js-fill.js-tonext").remove(),trace._nextFill=null;trace.fill&&("tozero"===trace.fill.substr(0,6)||"toself"===trace.fill||"to"===trace.fill.substr(0,2)&&!trace._prevtrace)?(trace._ownFill=tr.select(".js-fill.js-tozero"),trace._ownFill.size()||(trace._ownFill=tr.insert("path",":first-child").attr("class","js-fill js-tozero"))):(tr.selectAll(".js-fill.js-tozero").remove(),trace._ownFill=null),tr.selectAll(".js-fill").call(_$drawing_436.setClipUrl,plotinfo.layerClipId)})}(0,scatterlayer,plotinfo),i=0,uids={};i<cdscatter.length;i++)uids[cdscatter[i][0].trace.uid]=i;(scatterlayer.selectAll("g.trace").sort(function(a,b){return uids[a[0].trace.uid]>uids[b[0].trace.uid]?1:-1}),hasTransition)?(makeOnCompleteCallback&&(onComplete=makeOnCompleteCallback()),_$d3_127.transition().duration(transitionOpts.duration).ease(transitionOpts.easing).each("end",function(){onComplete&&onComplete()}).each("interrupt",function(){onComplete&&onComplete()}).each(function(){scatterlayer.selectAll("g.trace").each(function(d,i){__plotOne_881(gd,i,plotinfo,d,cdscatter,this,transitionOpts)})})):scatterlayer.selectAll("g.trace").each(function(d,i){__plotOne_881(gd,i,plotinfo,d,cdscatter,this,transitionOpts)});isFullReplot&&join.exit().remove(),scatterlayer.selectAll("path:not([d])").remove()};function __plotOne_881(gd,idx,plotinfo,cdscatter,cdscatterAll,element,transitionOpts){var join,i;!function selectMarkers(gd,idx,plotinfo,cdscatter,cdscatterAll){var xa=plotinfo.xaxis,ya=plotinfo.yaxis,xr=_$d3_127.extent(_$lib_539.simpleMap(xa.range,xa.r2c)),yr=_$d3_127.extent(_$lib_539.simpleMap(ya.range,ya.r2c)),trace=cdscatter[0].trace;if(!_$subtypes_884.hasMarkers(trace))return;var mnum=trace.marker.maxdisplayed;if(0===mnum)return;var cd=cdscatter.filter(function(v){return v.x>=xr[0]&&v.x<=xr[1]&&v.y>=yr[0]&&v.y<=yr[1]}),inc=Math.ceil(cd.length/mnum),tnum=0;cdscatterAll.forEach(function(cdj,j){var tracei=cdj[0].trace;_$subtypes_884.hasMarkers(tracei)&&tracei.marker.maxdisplayed>0&&j<idx&&tnum++});var i0=Math.round(tnum*inc/3+Math.floor(tnum/3)*inc/7.1);cdscatter.forEach(function(v){delete v.vis}),cd.forEach(function(v,i){0===Math.round((i+i0)%inc)&&(v.vis=!0)})}(0,idx,plotinfo,cdscatter,cdscatterAll);var hasTransition=!!transitionOpts&&transitionOpts.duration>0;function transition(selection){return hasTransition?selection.transition():selection}var xa=plotinfo.xaxis,ya=plotinfo.yaxis,trace=cdscatter[0].trace,line=trace.line,tr=_$d3_127.select(element);if(_$registry_668.getComponentMethod("errorbars","plot")(tr,plotinfo,transitionOpts),!0===trace.visible){var ownFillEl3,tonext;transition(tr).style("opacity",trace.opacity);var ownFillDir=trace.fill.charAt(trace.fill.length-1);"x"!==ownFillDir&&"y"!==ownFillDir&&(ownFillDir=""),cdscatter[0].node3=tr;var prevRevpath="",prevPolygons=[],prevtrace=trace._prevtrace;prevtrace&&(prevRevpath=prevtrace._prevRevpath||"",tonext=prevtrace._nextFill,prevPolygons=prevtrace._polygons);var thispath,thisrevpath,pathfn,revpathbase,revpathfn,pt0,lastSegment,pt1,thisPolygons,fullpath="",revpath="",segments=[],makeUpdate=_$lib_539.noop;if(ownFillEl3=trace._ownFill,_$subtypes_884.hasLines(trace)||"none"!==trace.fill){for(tonext&&tonext.datum(cdscatter),-1!==["hv","vh","hvh","vhv"].indexOf(line.shape)?(pathfn=_$drawing_436.steps(line.shape),revpathbase=_$drawing_436.steps(line.shape.split("").reverse().join(""))):pathfn=revpathbase="spline"===line.shape?function(pts){var pLast=pts[pts.length-1];return pts.length>1&&pts[0][0]===pLast[0]&&pts[0][1]===pLast[1]?_$drawing_436.smoothclosed(pts.slice(1),line.smoothing):_$drawing_436.smoothopen(pts,line.smoothing)}:function(pts){return"M"+pts.join("L")},revpathfn=function(pts){return revpathbase(pts.reverse())},segments=_$linePoints_876(cdscatter,{xaxis:xa,yaxis:ya,connectGaps:trace.connectgaps,baseTolerance:Math.max(line.width||1,3)/4,shape:line.shape,simplify:line.simplify}),thisPolygons=trace._polygons=new Array(segments.length),i=0;i<segments.length;i++)trace._polygons[i]=__polygonTester_881(segments[i]);segments.length&&(pt0=segments[0][0],pt1=(lastSegment=segments[segments.length-1])[lastSegment.length-1]),makeUpdate=function(isEnter){return function(pts){if(thispath=pathfn(pts),thisrevpath=revpathfn(pts),fullpath?ownFillDir?(fullpath+="L"+thispath.substr(1),revpath=thisrevpath+"L"+revpath.substr(1)):(fullpath+="Z"+thispath,revpath=thisrevpath+"Z"+revpath):(fullpath=thispath,revpath=thisrevpath),_$subtypes_884.hasLines(trace)&&pts.length>1){var el=_$d3_127.select(this);if(el.datum(cdscatter),isEnter)transition(el.style("opacity",0).attr("d",thispath).call(_$drawing_436.lineGroupStyle)).style("opacity",1);else{var sel=transition(el);sel.attr("d",thispath),_$drawing_436.singleLineStyle(cdscatter,sel)}}}}}var lineJoin=tr.selectAll(".js-line").data(segments);transition(lineJoin.exit()).style("opacity",0).remove(),lineJoin.each(makeUpdate(!1)),lineJoin.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(_$drawing_436.lineGroupStyle).each(makeUpdate(!0)),_$drawing_436.setClipUrl(lineJoin,plotinfo.layerClipId),segments.length?(ownFillEl3?pt0&&pt1&&(ownFillDir?("y"===ownFillDir?pt0[1]=pt1[1]=ya.c2p(0,!0):"x"===ownFillDir&&(pt0[0]=pt1[0]=xa.c2p(0,!0)),transition(ownFillEl3).attr("d","M"+pt1+"L"+pt0+"L"+fullpath.substr(1)).call(_$drawing_436.singleFillStyle)):transition(ownFillEl3).attr("d",fullpath+"Z").call(_$drawing_436.singleFillStyle)):tonext&&("tonext"===trace.fill.substr(0,6)&&fullpath&&prevRevpath?("tonext"===trace.fill?transition(tonext).attr("d",fullpath+"Z"+prevRevpath+"Z").call(_$drawing_436.singleFillStyle):transition(tonext).attr("d",fullpath+"L"+prevRevpath.substr(1)+"Z").call(_$drawing_436.singleFillStyle),trace._polygons=trace._polygons.concat(prevPolygons)):(clearFill(tonext),trace._polygons=null)),trace._prevRevpath=revpath,trace._prevPolygons=thisPolygons):(ownFillEl3?clearFill(ownFillEl3):tonext&&clearFill(tonext),trace._polygons=trace._prevRevpath=trace._prevPolygons=null);var pointSelection=tr.selectAll(".points");join=pointSelection.data([cdscatter]),pointSelection.each(makePoints),join.enter().append("g").classed("points",!0).each(makePoints),join.exit().remove(),join.each(function(d){var hasClipOnAxisFalse=!1===d[0].trace.cliponaxis;_$drawing_436.setClipUrl(_$d3_127.select(this),hasClipOnAxisFalse?null:plotinfo.layerClipId)})}function clearFill(selection){transition(selection).attr("d","M0,0Z")}function visFilter(d){return d.filter(function(v){return v.vis})}function keyFunc(d){return d.id}function getKeyFunc(trace){if(trace.ids)return keyFunc}function hideFilter(){return!1}function makePoints(d){var join,trace=d[0].trace,s=_$d3_127.select(this),showMarkers=_$subtypes_884.hasMarkers(trace),showText=_$subtypes_884.hasText(trace),keyFunc=getKeyFunc(trace),markerFilter=hideFilter,textFilter=hideFilter;showMarkers&&(markerFilter=trace.marker.maxdisplayed||trace._needsCull?visFilter:_$lib_539.identity),showText&&(textFilter=trace.marker.maxdisplayed||trace._needsCull?visFilter:_$lib_539.identity);var enter=(join=s.selectAll("path.point").data(markerFilter,keyFunc)).enter().append("path").classed("point",!0);hasTransition&&enter.call(_$drawing_436.pointStyle,trace,gd).call(_$drawing_436.translatePoints,xa,ya).style("opacity",0).transition().style("opacity",1);var markerScale=showMarkers&&_$drawing_436.tryColorscale(trace.marker,""),lineScale=showMarkers&&_$drawing_436.tryColorscale(trace.marker,"line");join.order(),join.each(function(d){var el=_$d3_127.select(this),sel=transition(el);_$drawing_436.translatePoint(d,sel,xa,ya)?(_$drawing_436.singlePointStyle(d,sel,trace,markerScale,lineScale,gd),plotinfo.layerClipId&&_$drawing_436.hideOutsideRangePoint(d,sel,xa,ya,trace.xcalendar,trace.ycalendar),trace.customdata&&el.classed("plotly-customdata",null!==d.data&&void 0!==d.data)):sel.remove()}),hasTransition?join.exit().transition().style("opacity",0).remove():join.exit().remove(),(join=s.selectAll("g").data(textFilter,keyFunc)).enter().append("g").classed("textpoint",!0).append("text"),join.order(),join.each(function(d){var g=_$d3_127.select(this),sel=transition(g.select("text"));_$drawing_436.translatePoint(d,sel,xa,ya)?plotinfo.layerClipId&&_$drawing_436.hideOutsideRangePoint(d,g,xa,ya,trace.xcalendar,trace.ycalendar):g.remove()}),join.selectAll("text").call(_$drawing_436.textPointStyle,trace,gd).each(function(d){var x=xa.c2p(d.x),y=ya.c2p(d.y);_$d3_127.select(this).selectAll("tspan.line").each(function(){transition(_$d3_127.select(this)).attr({x:x,y:y})})}),join.exit().remove()}}var _$selectPoints_882=function selectPoints(searchInfo,polygon){var i,di,x,y,cd=searchInfo.cd,xa=searchInfo.xaxis,ya=searchInfo.yaxis,selection=[],trace=cd[0].trace;if(!_$subtypes_884.hasMarkers(trace)&&!_$subtypes_884.hasText(trace))return[];if(!1===polygon)for(i=0;i<cd.length;i++)cd[i].selected=0;else for(i=0;i<cd.length;i++)di=cd[i],x=xa.c2p(di.x),y=ya.c2p(di.y),polygon.contains([x,y])?(selection.push({pointNumber:i,x:xa.c2d(di.x),y:ya.c2d(di.y)}),di.selected=1):di.selected=0;return selection};function stylePoints(sel,trace,gd){var pts=sel.selectAll("path.point"),txs=sel.selectAll("text");_$drawing_436.pointStyle(pts,trace,gd),_$drawing_436.textPointStyle(txs,trace,gd),_$drawing_436.selectedPointStyle(pts,trace),_$drawing_436.selectedTextStyle(txs,trace)}var _$style_883={style:function __style_883(gd,cd){var s=cd?cd[0].node3:_$d3_127.select(gd).selectAll("g.trace.scatter");s.style("opacity",function(d){return d[0].trace.opacity}),s.selectAll("g.points").each(function(d){stylePoints(_$d3_127.select(this),d.trace||d[0].trace,gd)}),s.selectAll("g.trace path.js-line").call(_$drawing_436.lineGroupStyle),s.selectAll("g.trace path.js-fill").call(_$drawing_436.fillGroupStyle),_$registry_668.getComponentMethod("errorbars","style")(s)},stylePoints:stylePoints},Scatter={};Scatter.hasLines=_$subtypes_884.hasLines,Scatter.hasMarkers=_$subtypes_884.hasMarkers,Scatter.hasText=_$subtypes_884.hasText,Scatter.isBubble=_$subtypes_884.isBubble,Scatter.attributes=_$attributes_862,Scatter.supplyDefaults=function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_862,attr,dflt)}var len=_$handleXYDefaults_886(traceIn,traceOut,layout,coerce),defaultMode=len<_$constants_868.PTS_LINESONLY?"lines+markers":"lines";if(len){coerce("text"),coerce("hovertext"),coerce("mode",defaultMode),_$subtypes_884.hasLines(traceOut)&&(_$lineDefaults_875(traceIn,traceOut,defaultColor,layout,coerce),_$handleLineShapeDefaults_877(0,0,coerce),coerce("connectgaps"),coerce("line.simplify")),_$subtypes_884.hasMarkers(traceOut)&&_$markerDefaults_880(traceIn,traceOut,defaultColor,layout,coerce,{gradient:!0}),_$subtypes_884.hasText(traceOut)&&_$text_defaults_885(0,0,layout,coerce);var dfltHoverOn=[];(_$subtypes_884.hasMarkers(traceOut)||_$subtypes_884.hasText(traceOut))&&(coerce("cliponaxis"),coerce("marker.maxdisplayed"),dfltHoverOn.push("points")),coerce("fill"),"none"!==traceOut.fill&&(_$fillColorDefaults_871(0,traceOut,defaultColor,coerce),_$subtypes_884.hasLines(traceOut)||_$handleLineShapeDefaults_877(0,0,coerce)),"tonext"!==traceOut.fill&&"toself"!==traceOut.fill||dfltHoverOn.push("fills"),coerce("hoveron",dfltHoverOn.join("+")||"points");var errorBarsSupplyDefaults=_$registry_668.getComponentMethod("errorbars","supplyDefaults");errorBarsSupplyDefaults(traceIn,traceOut,defaultColor,{axis:"y"}),errorBarsSupplyDefaults(traceIn,traceOut,defaultColor,{axis:"x",inherit:"y"}),_$lib_539.coerceSelectionMarkerOpacity(traceOut,coerce)}else traceOut.visible=!1},Scatter.cleanData=_$cleanData_865,Scatter.calc=_$calc___calc,Scatter.arraysToCalcdata=_$arraysToCalcdata_861,Scatter.plot=_$plot_881,Scatter.colorbar=_$colorbar_866,Scatter.style=_$style_883.style,Scatter.hoverPoints=_$hoverPoints_873,Scatter.selectPoints=_$selectPoints_882,Scatter.animatable=!0,Scatter.moduleType="trace",Scatter.name="scatter",Scatter.basePlotModule=_$cartesian_595,Scatter.categories=["cartesian","symbols","markerColorscale","errorBarsOK","showLegend","scatter-like"],Scatter.meta={};var _$Scatter_874=Scatter,_$core_520={version:"1.35.2"};_$es6Promise_136.polyfill();for(var register=_$core_520.register=_$registry_668.register,methodNames=Object.keys(_$plot_api_571),i=0;i<methodNames.length;i++){var __name_520=methodNames[i];_$core_520[__name_520]=_$plot_api_571[__name_520],register({moduleType:"apiMethod",name:__name_520,fn:_$plot_api_571[__name_520]})}register(_$Scatter_874),register([_$fx_453,_$legend_471,_$annotations_402,_$annotations3d_407,_$shapes_497,_$images_462,_$updatemenus_509,_$sliders_503,_$rangeslider_489,_$rangeselector_483,_$grid_457,_$errorbars_442]),register([{moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}},{moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}]),_$core_520.Icons=_$ploticon_2,_$core_520.Plots=_$plots_647,_$core_520.Fx=_$fx_453,_$core_520.Snapshot=_$Snapshot_673,_$core_520.PlotSchema=_$plot_schema_575,_$core_520.Queue=_$queue_553,_$core_520.d3=_$d3_127;var _$core_12=_$core_520,_$filter_963={},__pointsAccessorFunction_963=_$helpers_965.pointsAccessorFunction,COMPARISON_OPS=_$filter_ops_512.COMPARISON_OPS,__INTERVAL_OPS_963=_$filter_ops_512.INTERVAL_OPS,SET_OPS=_$filter_ops_512.SET_OPS;_$filter_963.moduleType="transform",_$filter_963.name="filter",_$filter_963.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(COMPARISON_OPS).concat(__INTERVAL_OPS_963).concat(SET_OPS),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},_$filter_963.supplyDefaults=function(transformIn){var transformOut={};function coerce(attr,dflt){return _$lib_539.coerce(transformIn,transformOut,_$filter_963.attributes,attr,dflt)}if(coerce("enabled")){coerce("preservegaps"),coerce("operation"),coerce("value"),coerce("target");var handleCalendarDefaults=_$registry_668.getComponentMethod("calendars","handleDefaults");handleCalendarDefaults(transformIn,transformOut,"valuecalendar",null),handleCalendarDefaults(transformIn,transformOut,"targetcalendar",null)}return transformOut},_$filter_963.calcTransform=function(gd,trace,opts){if(opts.enabled){var targetArray=_$lib_539.getTargetArray(trace,opts);if(targetArray){var target=opts.target,len=targetArray.length,targetCalendar=opts.targetcalendar,arrayAttrs=trace._arrayAttrs;if("string"==typeof target){var attrTargetCalendar=_$lib_539.nestedProperty(trace,target+"calendar").get();attrTargetCalendar&&(targetCalendar=attrTargetCalendar)}var initFn,fillFn,filterFunc=function getFilterFunc(opts,d2c,targetCalendar){var operation=opts.operation,value=opts.value,hasArrayValue=Array.isArray(value);function isOperationIn(array){return-1!==array.indexOf(operation)}var coercedValue,d2cValue=function(v){return d2c(v,0,opts.valuecalendar)},d2cTarget=function(v){return d2c(v,0,targetCalendar)};isOperationIn(COMPARISON_OPS)?coercedValue=d2cValue(hasArrayValue?value[0]:value):isOperationIn(__INTERVAL_OPS_963)?coercedValue=hasArrayValue?[d2cValue(value[0]),d2cValue(value[1])]:[d2cValue(value),d2cValue(value)]:isOperationIn(SET_OPS)&&(coercedValue=hasArrayValue?value.map(d2cValue):[d2cValue(value)]);switch(operation){case"=":return function(v){return d2cTarget(v)===coercedValue};case"!=":return function(v){return d2cTarget(v)!==coercedValue};case"<":return function(v){return d2cTarget(v)<coercedValue};case"<=":return function(v){return d2cTarget(v)<=coercedValue};case">":return function(v){return d2cTarget(v)>coercedValue};case">=":return function(v){return d2cTarget(v)>=coercedValue};case"[]":return function(v){var cv=d2cTarget(v);return cv>=coercedValue[0]&&cv<=coercedValue[1]};case"()":return function(v){var cv=d2cTarget(v);return cv>coercedValue[0]&&cv<coercedValue[1]};case"[)":return function(v){var cv=d2cTarget(v);return cv>=coercedValue[0]&&cv<coercedValue[1]};case"(]":return function(v){var cv=d2cTarget(v);return cv>coercedValue[0]&&cv<=coercedValue[1]};case"][":return function(v){var cv=d2cTarget(v);return cv<=coercedValue[0]||cv>=coercedValue[1]};case")(":return function(v){var cv=d2cTarget(v);return cv<coercedValue[0]||cv>coercedValue[1]};case"](":return function(v){var cv=d2cTarget(v);return cv<=coercedValue[0]||cv>coercedValue[1]};case")[":return function(v){var cv=d2cTarget(v);return cv<coercedValue[0]||cv>=coercedValue[1]};case"{}":return function(v){return-1!==coercedValue.indexOf(d2cTarget(v))};case"}{":return function(v){return-1===coercedValue.indexOf(d2cTarget(v))}}}(opts,_$axes_584.getDataToCoordFunc(gd,trace,target,targetArray),targetCalendar),originalArrays={},indexToPoints={},index=0;opts.preservegaps?(initFn=function(np){originalArrays[np.astr]=_$lib_539.extendDeep([],np.get()),np.set(new Array(len))},fillFn=function(np,index){var val=originalArrays[np.astr][index];np.get()[index]=val}):(initFn=function(np){originalArrays[np.astr]=_$lib_539.extendDeep([],np.get()),np.set([])},fillFn=function(np,index){var val=originalArrays[np.astr][index];np.get().push(val)}),forAllAttrs(initFn);for(var originalPointsAccessor=__pointsAccessorFunction_963(trace.transforms,opts),i=0;i<len;i++){filterFunc(targetArray[i])&&(forAllAttrs(fillFn,i),indexToPoints[index++]=originalPointsAccessor(i))}opts._indexToPoints=indexToPoints,trace._length=index}}function forAllAttrs(fn,index){for(var j=0;j<arrayAttrs.length;j++){fn(_$lib_539.nestedProperty(trace,arrayAttrs[j]),index)}}};var _$filter_13=_$filter_963,_$groupby_964={},__pointsAccessorFunction_964=_$helpers_965.pointsAccessorFunction;function transformOne(trace,state){var i,j,k,attr,srcArray,groupName,newTrace,transforms,arrayLookup,groupNameObj,opts=state.transform,groups=trace.transforms[state.transformIndex].groups,originalPointsAccessor=__pointsAccessorFunction_964(trace.transforms,opts);if(!Array.isArray(groups)||0===groups.length)return[trace];var groupNames=_$lib_539.filterUnique(groups),newData=new Array(groupNames.length),len=groups.length,arrayAttrs=_$plot_schema_575.findArrayAttributes(trace),styles=opts.styles||[],styleLookup={};for(i=0;i<styles.length;i++)styleLookup[styles[i].target]=styles[i].value;opts.styles&&(groupNameObj=_$lib_539.keyedContainer(opts,"styles","target","value.name"));var indexLookup={},indexCnts={};for(i=0;i<groupNames.length;i++){indexLookup[groupName=groupNames[i]]=i,indexCnts[groupName]=0,(newTrace=newData[i]=_$lib_539.extendDeepNoArrays({},trace))._group=groupName,newTrace.transforms[state.transformIndex]._indexToPoints={};var suppliedName=null;for(groupNameObj&&(suppliedName=groupNameObj.get(groupName)),newTrace.name=suppliedName||_$lib_539.templateString(opts.nameformat,{trace:trace.name,group:groupName}),transforms=newTrace.transforms,newTrace.transforms=[],j=0;j<transforms.length;j++)newTrace.transforms[j]=_$lib_539.extendDeepNoArrays({},transforms[j]);for(j=0;j<arrayAttrs.length;j++)_$lib_539.nestedProperty(newTrace,arrayAttrs[j]).set([])}for(k=0;k<arrayAttrs.length;k++){for(attr=arrayAttrs[k],j=0,arrayLookup=[];j<groupNames.length;j++)arrayLookup[j]=_$lib_539.nestedProperty(newData[j],attr).get();for(srcArray=_$lib_539.nestedProperty(trace,attr).get(),j=0;j<len;j++)arrayLookup[indexLookup[groups[j]]].push(srcArray[j])}for(j=0;j<len;j++){(newTrace=newData[indexLookup[groups[j]]]).transforms[state.transformIndex]._indexToPoints[indexCnts[groups[j]]]=originalPointsAccessor(j),indexCnts[groups[j]]++}for(i=0;i<groupNames.length;i++)groupName=groupNames[i],newTrace=newData[i],_$plots_647.clearExpandedTraceDefaultColors(newTrace),newTrace=_$lib_539.extendDeepNoArrays(newTrace,styleLookup[groupName]||{});return newData}_$groupby_964.moduleType="transform",_$groupby_964.name="groupby",_$groupby_964.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc"},editType:"calc"},editType:"calc"},_$groupby_964.supplyDefaults=function(transformIn,traceOut,layout){var i,transformOut={};function coerce(attr,dflt){return _$lib_539.coerce(transformIn,transformOut,_$groupby_964.attributes,attr,dflt)}if(!coerce("enabled"))return transformOut;coerce("groups"),coerce("nameformat",layout._dataLength>1?"%{group} (%{trace})":"%{group}");var styleIn=transformIn.styles,styleOut=transformOut.styles=[];if(styleIn)for(i=0;i<styleIn.length;i++)styleOut[i]={},_$lib_539.coerce(styleIn[i],styleOut[i],_$groupby_964.attributes.styles,"target"),_$lib_539.coerce(styleIn[i],styleOut[i],_$groupby_964.attributes.styles,"value");return transformOut},_$groupby_964.transform=function(data,state){var newTraces,i,j,newData=[];for(i=0;i<data.length;i++)for(newTraces=transformOne(data[i],state),j=0;j<newTraces.length;j++)newData.push(newTraces[j]);return newData};var _$groupby_14=_$groupby_964,_$handleStyleDefaults_788=function handleStyleDefaults(traceIn,traceOut,coerce){!1===coerce("zsmooth")&&(coerce("xgap"),coerce("ygap")),coerce("zhoverformat")},_$supplyDefaults_778=function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_773,attr,dflt)}_$handleXYZDefaults_789(traceIn,traceOut,coerce,layout)?(coerce("text"),_$handleStyleDefaults_788(0,0,coerce),coerce("connectgaps",_$has_columns_780(traceOut)&&!1!==traceOut.zsmooth),_$colorScaleDefaults_421(traceIn,traceOut,layout,coerce,{prefix:"",cLetter:"z"})):traceOut.visible=!1},Heatmap={};Heatmap.attributes=_$attributes_773,Heatmap.supplyDefaults=_$supplyDefaults_778,Heatmap.calc=_$calc_774,Heatmap.plot=_$plot_786,Heatmap.colorbar=_$colorbar_776,Heatmap.style=_$style_787,Heatmap.hoverPoints=_$hoverPoints_781,Heatmap.moduleType="trace",Heatmap.name="heatmap",Heatmap.basePlotModule=_$cartesian_595,Heatmap.categories=["cartesian","2dMap"],Heatmap.meta={};var _$heatmap_15=Heatmap;var _$unique_362=function unique(list,compare,sorted){return 0===list.length?list:compare?(sorted||list.sort(compare),function unique_pred(list,compare){for(var ptr=1,len=list.length,a=list[0],b=list[0],i=1;i<len;++i)if(b=a,compare(a=list[i],b)){if(i===ptr){ptr++;continue}list[ptr++]=a}return list.length=ptr,list}(list,compare)):(sorted||list.sort(),function unique_eq(list){for(var ptr=1,len=list.length,a=list[0],b=list[0],i=1;i<len;++i,b=a)if(b=a,(a=list[i])!==b){if(i===ptr){ptr++;continue}list[ptr++]=a}return list.length=ptr,list}(list))};function innerFill(order,proc,body){var i,j,dimension=order.length,nargs=proc.arrayArgs.length,has_index=proc.indexArgs.length>0,code=[],vars=[],idx=0,pidx=0;for(i=0;i<dimension;++i)vars.push(["i",i,"=0"].join(""));for(j=0;j<nargs;++j)for(i=0;i<dimension;++i)pidx=idx,idx=order[i],0===i?vars.push(["d",j,"s",i,"=t",j,"p",idx].join("")):vars.push(["d",j,"s",i,"=(t",j,"p",idx,"-s",pidx,"*t",j,"p",pidx,")"].join(""));for(vars.length>0&&code.push("var "+vars.join(",")),i=dimension-1;i>=0;--i)idx=order[i],code.push(["for(i",i,"=0;i",i,"<s",idx,";++i",i,"){"].join(""));for(code.push(body),i=0;i<dimension;++i){for(pidx=idx,idx=order[i],j=0;j<nargs;++j)code.push(["p",j,"+=d",j,"s",i].join(""));has_index&&(i>0&&code.push(["index[",pidx,"]-=s",pidx].join("")),code.push(["++index[",idx,"]"].join(""))),code.push("}")}return code.join("\n")}function processBlock(block,proc,dtypes){for(var code=block.body,pre=[],post=[],i=0;i<block.args.length;++i){var carg=block.args[i];if(!(carg.count<=0)){var re=new RegExp(carg.name,"g"),ptrStr="",arrNum=proc.arrayArgs.indexOf(i);switch(proc.argTypes[i]){case"offset":var offArgIndex=proc.offsetArgIndex.indexOf(i);arrNum=proc.offsetArgs[offArgIndex].array,ptrStr="+q"+offArgIndex;case"array":ptrStr="p"+arrNum+ptrStr;var localStr="l"+i,arrStr="a"+arrNum;if(0===proc.arrayBlockIndices[arrNum])1===carg.count?"generic"===dtypes[arrNum]?carg.lvalue?(pre.push(["var ",localStr,"=",arrStr,".get(",ptrStr,")"].join("")),code=code.replace(re,localStr),post.push([arrStr,".set(",ptrStr,",",localStr,")"].join(""))):code=code.replace(re,[arrStr,".get(",ptrStr,")"].join("")):code=code.replace(re,[arrStr,"[",ptrStr,"]"].join("")):"generic"===dtypes[arrNum]?(pre.push(["var ",localStr,"=",arrStr,".get(",ptrStr,")"].join("")),code=code.replace(re,localStr),carg.lvalue&&post.push([arrStr,".set(",ptrStr,",",localStr,")"].join(""))):(pre.push(["var ",localStr,"=",arrStr,"[",ptrStr,"]"].join("")),code=code.replace(re,localStr),carg.lvalue&&post.push([arrStr,"[",ptrStr,"]=",localStr].join("")));else{for(var reStrArr=[carg.name],ptrStrArr=[ptrStr],j=0;j<Math.abs(proc.arrayBlockIndices[arrNum]);j++)reStrArr.push("\\s*\\[([^\\]]+)\\]"),ptrStrArr.push("$"+(j+1)+"*t"+arrNum+"b"+j);if(re=new RegExp(reStrArr.join(""),"g"),ptrStr=ptrStrArr.join("+"),"generic"===dtypes[arrNum])throw new Error("cwise: Generic arrays not supported in combination with blocks!");code=code.replace(re,[arrStr,"[",ptrStr,"]"].join(""))}break;case"scalar":code=code.replace(re,"Y"+proc.scalarArgs.indexOf(i));break;case"index":code=code.replace(re,"index");break;case"shape":code=code.replace(re,"shape")}}}return[pre.join("\n"),code,post.join("\n")].join("\n").trim()}var _$generateCWiseOp_116=function generateCWiseOp(proc,typesig){for(var dimension=typesig[1].length-Math.abs(proc.arrayBlockIndices[0])|0,orders=new Array(proc.arrayArgs.length),dtypes=new Array(proc.arrayArgs.length),i=0;i<proc.arrayArgs.length;++i)dtypes[i]=typesig[2*i],orders[i]=typesig[2*i+1];var blockBegin=[],blockEnd=[],loopBegin=[],loopEnd=[],loopOrders=[];for(i=0;i<proc.arrayArgs.length;++i){proc.arrayBlockIndices[i]<0?(loopBegin.push(0),loopEnd.push(dimension),blockBegin.push(dimension),blockEnd.push(dimension+proc.arrayBlockIndices[i])):(loopBegin.push(proc.arrayBlockIndices[i]),loopEnd.push(proc.arrayBlockIndices[i]+dimension),blockBegin.push(0),blockEnd.push(proc.arrayBlockIndices[i]));for(var newOrder=[],j=0;j<orders[i].length;j++)loopBegin[i]<=orders[i][j]&&orders[i][j]<loopEnd[i]&&newOrder.push(orders[i][j]-loopBegin[i]);loopOrders.push(newOrder)}var arglist=["SS"],code=["'use strict'"],vars=[];for(j=0;j<dimension;++j)vars.push(["s",j,"=SS[",j,"]"].join(""));for(i=0;i<proc.arrayArgs.length;++i){for(arglist.push("a"+i),arglist.push("t"+i),arglist.push("p"+i),j=0;j<dimension;++j)vars.push(["t",i,"p",j,"=t",i,"[",loopBegin[i]+j,"]"].join(""));for(j=0;j<Math.abs(proc.arrayBlockIndices[i]);++j)vars.push(["t",i,"b",j,"=t",i,"[",blockBegin[i]+j,"]"].join(""))}for(i=0;i<proc.scalarArgs.length;++i)arglist.push("Y"+i);if(proc.shapeArgs.length>0&&vars.push("shape=SS.slice(0)"),proc.indexArgs.length>0){var zeros=new Array(dimension);for(i=0;i<dimension;++i)zeros[i]="0";vars.push(["index=[",zeros.join(","),"]"].join(""))}for(i=0;i<proc.offsetArgs.length;++i){var off_arg=proc.offsetArgs[i],init_string=[];for(j=0;j<off_arg.offset.length;++j)0!==off_arg.offset[j]&&(1===off_arg.offset[j]?init_string.push(["t",off_arg.array,"p",j].join("")):init_string.push([off_arg.offset[j],"*t",off_arg.array,"p",j].join("")));0===init_string.length?vars.push("q"+i+"=0"):vars.push(["q",i,"=",init_string.join("+")].join(""))}var thisVars=_$unique_362([].concat(proc.pre.thisVars).concat(proc.body.thisVars).concat(proc.post.thisVars));for((vars=vars.concat(thisVars)).length>0&&code.push("var "+vars.join(",")),i=0;i<proc.arrayArgs.length;++i)code.push("p"+i+"|=0");proc.pre.body.length>3&&code.push(processBlock(proc.pre,proc,dtypes));var body=processBlock(proc.body,proc,dtypes),matched=function countMatches(orders){for(var matched=0,dimension=orders[0].length;matched<dimension;){for(var j=1;j<orders.length;++j)if(orders[j][matched]!==orders[0][matched])return matched;++matched}return matched}(loopOrders);matched<dimension?code.push(function outerFill(matched,order,proc,body){for(var dimension=order.length,nargs=proc.arrayArgs.length,blockSize=proc.blockSize,has_index=proc.indexArgs.length>0,code=[],i=0;i<nargs;++i)code.push(["var offset",i,"=p",i].join(""));for(i=matched;i<dimension;++i)code.push(["for(var j"+i+"=SS[",order[i],"]|0;j",i,">0;){"].join("")),code.push(["if(j",i,"<",blockSize,"){"].join("")),code.push(["s",order[i],"=j",i].join("")),code.push(["j",i,"=0"].join("")),code.push(["}else{s",order[i],"=",blockSize].join("")),code.push(["j",i,"-=",blockSize,"}"].join("")),has_index&&code.push(["index[",order[i],"]=j",i].join(""));for(i=0;i<nargs;++i){for(var indexStr=["offset"+i],j=matched;j<dimension;++j)indexStr.push(["j",j,"*t",i,"p",order[j]].join(""));code.push(["p",i,"=(",indexStr.join("+"),")"].join(""))}for(code.push(innerFill(order,proc,body)),i=matched;i<dimension;++i)code.push("}");return code.join("\n")}(matched,loopOrders[0],proc,body)):code.push(innerFill(loopOrders[0],proc,body)),proc.post.body.length>3&&code.push(processBlock(proc.post,proc,dtypes)),proc.debug&&console.log("-----Generated cwise routine for ",typesig,":\n"+code.join("\n")+"\n----------");var loopName=[proc.funcName||"unnamed","_cwise_loop_",orders[0].join("s"),"m",matched,function typeSummary(dtypes){for(var summary=new Array(dtypes.length),allEqual=!0,i=0;i<dtypes.length;++i){var t=dtypes[i],digits=t.match(/\d+/);digits=digits?digits[0]:"",0===t.charAt(0)?summary[i]="u"+t.charAt(1)+digits:summary[i]=t.charAt(0)+digits,i>0&&(allEqual=allEqual&&summary[i]===summary[i-1])}return allEqual?summary[0]:summary.join("")}(dtypes)].join("");return new Function(["function ",loopName,"(",arglist.join(","),"){",code.join("\n"),"} return ",loopName].join(""))()};var _$createThunk_117=function createThunk(proc){var code=["'use strict'","var CACHED={}"],vars=[],thunkName=proc.funcName+"_cwise_thunk";code.push(["return function ",thunkName,"(",proc.shimArgs.join(","),"){"].join(""));for(var typesig=[],string_typesig=[],proc_args=[["array",proc.arrayArgs[0],".shape.slice(",Math.max(0,proc.arrayBlockIndices[0]),proc.arrayBlockIndices[0]<0?","+proc.arrayBlockIndices[0]+")":")"].join("")],shapeLengthConditions=[],shapeConditions=[],i=0;i<proc.arrayArgs.length;++i){var j=proc.arrayArgs[i];vars.push(["t",j,"=array",j,".dtype,","r",j,"=array",j,".order"].join("")),typesig.push("t"+j),typesig.push("r"+j),string_typesig.push("t"+j),string_typesig.push("r"+j+".join()"),proc_args.push("array"+j+".data"),proc_args.push("array"+j+".stride"),proc_args.push("array"+j+".offset|0"),i>0&&(shapeLengthConditions.push("array"+proc.arrayArgs[0]+".shape.length===array"+j+".shape.length+"+(Math.abs(proc.arrayBlockIndices[0])-Math.abs(proc.arrayBlockIndices[i]))),shapeConditions.push("array"+proc.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,proc.arrayBlockIndices[0])+"]===array"+j+".shape[shapeIndex+"+Math.max(0,proc.arrayBlockIndices[i])+"]"))}for(proc.arrayArgs.length>1&&(code.push("if (!("+shapeLengthConditions.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),code.push("for(var shapeIndex=array"+proc.arrayArgs[0]+".shape.length-"+Math.abs(proc.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),code.push("if (!("+shapeConditions.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),code.push("}")),i=0;i<proc.scalarArgs.length;++i)proc_args.push("scalar"+proc.scalarArgs[i]);return vars.push(["type=[",string_typesig.join(","),"].join()"].join("")),vars.push("proc=CACHED[type]"),code.push("var "+vars.join(",")),code.push(["if(!proc){","CACHED[type]=proc=compile([",typesig.join(","),"])}","return proc(",proc_args.join(","),")}"].join("")),proc.debug&&console.log("-----Generated thunk:\n"+code.join("\n")+"\n----------"),new Function("compile",code.join("\n"))(_$generateCWiseOp_116.bind(void 0,proc))};var _$compileCwise_115=function compileCwise(user_args){var proc=new function Procedure(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1};proc.pre=user_args.pre,proc.body=user_args.body,proc.post=user_args.post;var proc_args=user_args.args.slice(0);proc.argTypes=proc_args;for(var i=0;i<proc_args.length;++i){var arg_type=proc_args[i];if("array"===arg_type||"object"==typeof arg_type&&arg_type.blockIndices){if(proc.argTypes[i]="array",proc.arrayArgs.push(i),proc.arrayBlockIndices.push(arg_type.blockIndices?arg_type.blockIndices:0),proc.shimArgs.push("array"+i),i<proc.pre.args.length&&proc.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array args");if(i<proc.post.args.length&&proc.post.args[i].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===arg_type)proc.scalarArgs.push(i),proc.shimArgs.push("scalar"+i);else if("index"===arg_type){if(proc.indexArgs.push(i),i<proc.pre.args.length&&proc.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array index");if(i<proc.body.args.length&&proc.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array index");if(i<proc.post.args.length&&proc.post.args[i].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===arg_type){if(proc.shapeArgs.push(i),i<proc.pre.args.length&&proc.pre.args[i].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(i<proc.body.args.length&&proc.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array shape");if(i<proc.post.args.length&&proc.post.args[i].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof arg_type||!arg_type.offset)throw new Error("cwise: Unknown argument type "+proc_args[i]);proc.argTypes[i]="offset",proc.offsetArgs.push({array:arg_type.array,offset:arg_type.offset}),proc.offsetArgIndex.push(i)}}if(proc.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(proc.pre.args.length>proc_args.length)throw new Error("cwise: Too many arguments in pre() block");if(proc.body.args.length>proc_args.length)throw new Error("cwise: Too many arguments in body() block");if(proc.post.args.length>proc_args.length)throw new Error("cwise: Too many arguments in post() block");return proc.debug=!!user_args.printCode||!!user_args.debug,proc.funcName=user_args.funcName||"cwise",proc.blockSize=user_args.blockSize||64,_$createThunk_117(proc)},_$ndarrayOps_271={},EmptyProc={body:"",args:[],thisVars:[],localVars:[]};function fixup(x){if(!x)return EmptyProc;for(var i=0;i<x.args.length;++i){var a=x.args[i];x.args[i]=0===i?{name:a,lvalue:!0,rvalue:!!x.rvalue,count:x.count||1}:{name:a,lvalue:!1,rvalue:!0,count:1}}return x.thisVars||(x.thisVars=[]),x.localVars||(x.localVars=[]),x}function makeOp(user_args){for(var args=[],i=0;i<user_args.args.length;++i)args.push("a"+i);return new Function("P",["return function ",user_args.funcName,"_ndarrayops(",args.join(","),") {P(",args.join(","),");return a0}"].join(""))(function pcompile(user_args){return _$compileCwise_115({args:user_args.args,pre:fixup(user_args.pre),body:fixup(user_args.body),post:fixup(user_args.proc),funcName:user_args.funcName})}(user_args))}var assign_ops={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var id in assign_ops){var op=assign_ops[id];_$ndarrayOps_271[id]=makeOp({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+op+"c"},funcName:id}),_$ndarrayOps_271[id+"eq"]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a"+op+"=b"},rvalue:!0,funcName:id+"eq"}),_$ndarrayOps_271[id+"s"]=makeOp({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+op+"s"},funcName:id+"s"}),_$ndarrayOps_271[id+"seq"]=makeOp({args:["array","scalar"],body:{args:["a","s"],body:"a"+op+"=s"},rvalue:!0,funcName:id+"seq"})}}();var unary_ops={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var id in unary_ops){var op=unary_ops[id];_$ndarrayOps_271[id]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a="+op+"b"},funcName:id}),_$ndarrayOps_271[id+"eq"]=makeOp({args:["array"],body:{args:["a"],body:"a="+op+"a"},rvalue:!0,count:2,funcName:id+"eq"})}}();var binary_ops={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var id in binary_ops){var op=binary_ops[id];_$ndarrayOps_271[id]=makeOp({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+op+"c"},funcName:id}),_$ndarrayOps_271[id+"s"]=makeOp({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+op+"s"},funcName:id+"s"}),_$ndarrayOps_271[id+"eq"]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a=a"+op+"b"},rvalue:!0,count:2,funcName:id+"eq"}),_$ndarrayOps_271[id+"seq"]=makeOp({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+op+"s"},rvalue:!0,count:2,funcName:id+"seq"})}}();var math_unary=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var i=0;i<math_unary.length;++i){var f=math_unary[i];_$ndarrayOps_271[f]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:f}),_$ndarrayOps_271[f+"eq"]=makeOp({args:["array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"eq"})}}();var math_comm=["max","min","atan2","pow"];!function(){for(var i=0;i<math_comm.length;++i){var f=math_comm[i];_$ndarrayOps_271[f]=makeOp({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:f}),_$ndarrayOps_271[f+"s"]=makeOp({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:f+"s"}),_$ndarrayOps_271[f+"eq"]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"eq"}),_$ndarrayOps_271[f+"seq"]=makeOp({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"seq"})}}();var math_noncomm=["atan2","pow"];!function(){for(var i=0;i<math_noncomm.length;++i){var f=math_noncomm[i];_$ndarrayOps_271[f+"op"]=makeOp({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:f+"op"}),_$ndarrayOps_271[f+"ops"]=makeOp({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:f+"ops"}),_$ndarrayOps_271[f+"opeq"]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"opeq"}),_$ndarrayOps_271[f+"opseq"]=makeOp({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:f+"opseq"})}}(),_$ndarrayOps_271.any=_$compileCwise_115({args:["array"],pre:EmptyProc,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),_$ndarrayOps_271.all=_$compileCwise_115({args:["array"],pre:EmptyProc,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),_$ndarrayOps_271.sum=_$compileCwise_115({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),_$ndarrayOps_271.prod=_$compileCwise_115({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),_$ndarrayOps_271.norm2squared=_$compileCwise_115({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),_$ndarrayOps_271.norm2=_$compileCwise_115({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),_$ndarrayOps_271.norminf=_$compileCwise_115({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),_$ndarrayOps_271.norm1=_$compileCwise_115({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),_$ndarrayOps_271.sup=_$compileCwise_115({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),_$ndarrayOps_271.inf=_$compileCwise_115({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),_$ndarrayOps_271.argmin=_$compileCwise_115({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),_$ndarrayOps_271.argmax=_$compileCwise_115({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),_$ndarrayOps_271.random=makeOp({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),_$ndarrayOps_271.assign=makeOp({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),_$ndarrayOps_271.assigns=makeOp({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),_$ndarrayOps_271.equals=_$compileCwise_115({args:["array","array"],pre:EmptyProc,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"});var _$iota_245=function iota(n){for(var result=new Array(n),i=0;i<n;++i)result[i]=i;return result},_$isBuffer_247=function(obj){return null!=obj&&(isBuffer(obj)||function isSlowBuffer(obj){return"function"==typeof obj.readFloatLE&&"function"==typeof obj.slice&&isBuffer(obj.slice(0,0))}(obj)||!!obj._isBuffer)};function isBuffer(obj){return!!obj.constructor&&"function"==typeof obj.constructor.isBuffer&&obj.constructor.isBuffer(obj)}var hasTypedArrays="undefined"!=typeof Float64Array;function compare1st(a,b){return a[0]-b[0]}function order(){var i,stride=this.stride,terms=new Array(stride.length);for(i=0;i<terms.length;++i)terms[i]=[Math.abs(stride[i]),i];terms.sort(compare1st);var result=new Array(terms.length);for(i=0;i<result.length;++i)result[i]=terms[i][1];return result}function compileConstructor(dtype,dimension){var className=["View",dimension,"d",dtype].join("");dimension<0&&(className="View_Nil"+dtype);var useGetters="generic"===dtype;if(-1===dimension){var code="function "+className+"(a){this.data=a;};var proto="+className+".prototype;proto.dtype='"+dtype+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+className+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+className+"(a){return new "+className+"(a);}";return new Function(code)()}if(0===dimension){code="function "+className+"(a,d) {this.data = a;this.offset = d};var proto="+className+".prototype;proto.dtype='"+dtype+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+className+"_copy() {return new "+className+"(this.data,this.offset)};proto.pick=function "+className+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+className+"_get(){return "+(useGetters?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+className+"_set(v){return "+(useGetters?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+className+"(a,b,c,d){return new "+className+"(a,d)}";return new Function("TrivialArray",code)(CACHED_CONSTRUCTORS[dtype][0])}code=["'use strict'"];var indices=_$iota_245(dimension),args=indices.map(function(i){return"i"+i}),index_str="this.offset+"+indices.map(function(i){return"this.stride["+i+"]*i"+i}).join("+"),shapeArg=indices.map(function(i){return"b"+i}).join(","),strideArg=indices.map(function(i){return"c"+i}).join(",");code.push("function "+className+"(a,"+shapeArg+","+strideArg+",d){this.data=a","this.shape=["+shapeArg+"]","this.stride=["+strideArg+"]","this.offset=d|0}","var proto="+className+".prototype","proto.dtype='"+dtype+"'","proto.dimension="+dimension),code.push("Object.defineProperty(proto,'size',{get:function "+className+"_size(){return "+indices.map(function(i){return"this.shape["+i+"]"}).join("*"),"}})"),1===dimension?code.push("proto.order=[0]"):(code.push("Object.defineProperty(proto,'order',{get:"),dimension<4?(code.push("function "+className+"_order(){"),2===dimension?code.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===dimension&&code.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):code.push("ORDER})")),code.push("proto.set=function "+className+"_set("+args.join(",")+",v){"),useGetters?code.push("return this.data.set("+index_str+",v)}"):code.push("return this.data["+index_str+"]=v}"),code.push("proto.get=function "+className+"_get("+args.join(",")+"){"),useGetters?code.push("return this.data.get("+index_str+")}"):code.push("return this.data["+index_str+"]}"),code.push("proto.index=function "+className+"_index(",args.join(),"){return "+index_str+"}"),code.push("proto.hi=function "+className+"_hi("+args.join(",")+"){return new "+className+"(this.data,"+indices.map(function(i){return["(typeof i",i,"!=='number'||i",i,"<0)?this.shape[",i,"]:i",i,"|0"].join("")}).join(",")+","+indices.map(function(i){return"this.stride["+i+"]"}).join(",")+",this.offset)}");var a_vars=indices.map(function(i){return"a"+i+"=this.shape["+i+"]"}),c_vars=indices.map(function(i){return"c"+i+"=this.stride["+i+"]"});code.push("proto.lo=function "+className+"_lo("+args.join(",")+"){var b=this.offset,d=0,"+a_vars.join(",")+","+c_vars.join(","));for(var i=0;i<dimension;++i)code.push("if(typeof i"+i+"==='number'&&i"+i+">=0){d=i"+i+"|0;b+=c"+i+"*d;a"+i+"-=d}");code.push("return new "+className+"(this.data,"+indices.map(function(i){return"a"+i}).join(",")+","+indices.map(function(i){return"c"+i}).join(",")+",b)}"),code.push("proto.step=function "+className+"_step("+args.join(",")+"){var "+indices.map(function(i){return"a"+i+"=this.shape["+i+"]"}).join(",")+","+indices.map(function(i){return"b"+i+"=this.stride["+i+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(i=0;i<dimension;++i)code.push("if(typeof i"+i+"==='number'){d=i"+i+"|0;if(d<0){c+=b"+i+"*(a"+i+"-1);a"+i+"=ceil(-a"+i+"/d)}else{a"+i+"=ceil(a"+i+"/d)}b"+i+"*=d}");code.push("return new "+className+"(this.data,"+indices.map(function(i){return"a"+i}).join(",")+","+indices.map(function(i){return"b"+i}).join(",")+",c)}");var tShape=new Array(dimension),tStride=new Array(dimension);for(i=0;i<dimension;++i)tShape[i]="a[i"+i+"]",tStride[i]="b[i"+i+"]";code.push("proto.transpose=function "+className+"_transpose("+args+"){"+args.map(function(n,idx){return n+"=("+n+"===undefined?"+idx+":"+n+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+className+"(this.data,"+tShape.join(",")+","+tStride.join(",")+",this.offset)}"),code.push("proto.pick=function "+className+"_pick("+args+"){var a=[],b=[],c=this.offset");for(i=0;i<dimension;++i)code.push("if(typeof i"+i+"==='number'&&i"+i+">=0){c=(c+this.stride["+i+"]*i"+i+")|0}else{a.push(this.shape["+i+"]);b.push(this.stride["+i+"])}");return code.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),code.push("return function construct_"+className+"(data,shape,stride,offset){return new "+className+"(data,"+indices.map(function(i){return"shape["+i+"]"}).join(",")+","+indices.map(function(i){return"stride["+i+"]"}).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",code.join("\n"))(CACHED_CONSTRUCTORS[dtype],order)}var CACHED_CONSTRUCTORS={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};var _$wrappedNDArrayCtor_277=function wrappedNDArrayCtor(data,shape,stride,offset){if(void 0===data)return(0,CACHED_CONSTRUCTORS.array[0])([]);"number"==typeof data&&(data=[data]),void 0===shape&&(shape=[data.length]);var d=shape.length;if(void 0===stride){stride=new Array(d);for(var i=d-1,sz=1;i>=0;--i)stride[i]=sz,sz*=shape[i]}if(void 0===offset)for(offset=0,i=0;i<d;++i)stride[i]<0&&(offset-=(shape[i]-1)*stride[i]);for(var dtype=function arrayDType(data){if(_$isBuffer_247(data))return"buffer";if(hasTypedArrays)switch(Object.prototype.toString.call(data)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(data)?"array":"generic"}(data),ctor_list=CACHED_CONSTRUCTORS[dtype];ctor_list.length<=d+1;)ctor_list.push(compileConstructor(dtype,ctor_list.length-1));return(0,ctor_list[d+1])(data,shape,stride,offset)},_$twiddle_72={};function countTrailingZeros(v){var c=32;return(v&=-v)&&c--,65535&v&&(c-=16),16711935&v&&(c-=8),252645135&v&&(c-=4),858993459&v&&(c-=2),1431655765&v&&(c-=1),c}_$twiddle_72.INT_BITS=32,_$twiddle_72.INT_MAX=2147483647,_$twiddle_72.INT_MIN=-1<<31,_$twiddle_72.sign=function(v){return(v>0)-(v<0)},_$twiddle_72.abs=function(v){var mask=v>>31;return(v^mask)-mask},_$twiddle_72.min=function(x,y){return y^(x^y)&-(x<y)},_$twiddle_72.max=function(x,y){return x^(x^y)&-(x<y)},_$twiddle_72.isPow2=function(v){return!(v&v-1||!v)},_$twiddle_72.log2=function(v){var r,shift;return r=(v>65535)<<4,r|=shift=((v>>>=r)>255)<<3,r|=shift=((v>>>=shift)>15)<<2,(r|=shift=((v>>>=shift)>3)<<1)|(v>>>=shift)>>1},_$twiddle_72.log10=function(v){return v>=1e9?9:v>=1e8?8:v>=1e7?7:v>=1e6?6:v>=1e5?5:v>=1e4?4:v>=1e3?3:v>=100?2:v>=10?1:0},_$twiddle_72.popCount=function(v){return 16843009*((v=(858993459&(v-=v>>>1&1431655765))+(v>>>2&858993459))+(v>>>4)&252645135)>>>24},_$twiddle_72.countTrailingZeros=countTrailingZeros,_$twiddle_72.nextPow2=function(v){return v+=0===v,--v,v|=v>>>1,v|=v>>>2,v|=v>>>4,v|=v>>>8,(v|=v>>>16)+1},_$twiddle_72.prevPow2=function(v){return v|=v>>>1,v|=v>>>2,v|=v>>>4,v|=v>>>8,(v|=v>>>16)-(v>>>1)},_$twiddle_72.parity=function(v){return v^=v>>>16,v^=v>>>8,v^=v>>>4,27030>>>(v&=15)&1};var REVERSE_TABLE=new Array(256);!function(tab){for(var i=0;i<256;++i){var v=i,r=i,s=7;for(v>>>=1;v;v>>>=1)r<<=1,r|=1&v,--s;tab[i]=r<<s&255}}(REVERSE_TABLE),_$twiddle_72.reverse=function(v){return REVERSE_TABLE[255&v]<<24|REVERSE_TABLE[v>>>8&255]<<16|REVERSE_TABLE[v>>>16&255]<<8|REVERSE_TABLE[v>>>24&255]},_$twiddle_72.interleave2=function(x,y){return(x=1431655765&((x=858993459&((x=252645135&((x=16711935&((x&=65535)|x<<8))|x<<4))|x<<2))|x<<1))|(y=1431655765&((y=858993459&((y=252645135&((y=16711935&((y&=65535)|y<<8))|y<<4))|y<<2))|y<<1))<<1},_$twiddle_72.deinterleave2=function(v,n){return(v=65535&((v=16711935&((v=252645135&((v=858993459&((v=v>>>n&1431655765)|v>>>1))|v>>>2))|v>>>4))|v>>>16))<<16>>16},_$twiddle_72.interleave3=function(x,y,z){return x=1227133513&((x=3272356035&((x=251719695&((x=4278190335&((x&=1023)|x<<16))|x<<8))|x<<4))|x<<2),(x|=(y=1227133513&((y=3272356035&((y=251719695&((y=4278190335&((y&=1023)|y<<16))|y<<8))|y<<4))|y<<2))<<1)|(z=1227133513&((z=3272356035&((z=251719695&((z=4278190335&((z&=1023)|z<<16))|z<<8))|z<<4))|z<<2))<<2},_$twiddle_72.deinterleave3=function(v,n){return(v=1023&((v=4278190335&((v=251719695&((v=3272356035&((v=v>>>n&1227133513)|v>>>2))|v>>>4))|v>>>8))|v>>>16))<<22>>22},_$twiddle_72.nextCombination=function(v){var t=v|v-1;return t+1|(~t&-~t)-1>>>countTrailingZeros(v)+1};for(var _$base64Js_54={byteLength:function byteLength(b64){return 3*b64.length/4-placeHoldersCount(b64)},toByteArray:function toByteArray(b64){var i,l,tmp,placeHolders,arr,len=b64.length;placeHolders=placeHoldersCount(b64),arr=new Arr(3*len/4-placeHolders),l=placeHolders>0?len-4:len;var L=0;for(i=0;i<l;i+=4)tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)],arr[L++]=tmp>>16&255,arr[L++]=tmp>>8&255,arr[L++]=255&tmp;2===placeHolders?(tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4,arr[L++]=255&tmp):1===placeHolders&&(tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2,arr[L++]=tmp>>8&255,arr[L++]=255&tmp);return arr},fromByteArray:function fromByteArray(uint8){for(var tmp,len=uint8.length,extraBytes=len%3,output="",parts=[],i=0,len2=len-extraBytes;i<len2;i+=16383)parts.push(encodeChunk(uint8,i,i+16383>len2?len2:i+16383));1===extraBytes?(tmp=uint8[len-1],output+=lookup[tmp>>2],output+=lookup[tmp<<4&63],output+="=="):2===extraBytes&&(tmp=(uint8[len-2]<<8)+uint8[len-1],output+=lookup[tmp>>10],output+=lookup[tmp>>4&63],output+=lookup[tmp<<2&63],output+="=");return parts.push(output),parts.join("")}},lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",__i_54=0,len=code.length;__i_54<len;++__i_54)lookup[__i_54]=code[__i_54],revLookup[code.charCodeAt(__i_54)]=__i_54;function placeHoldersCount(b64){var len=b64.length;if(len%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===b64[len-2]?2:"="===b64[len-1]?1:0}function encodeChunk(uint8,start,end){for(var tmp,num,output=[],i=start;i<end;i+=3)tmp=(uint8[i]<<16&16711680)+(uint8[i+1]<<8&65280)+(255&uint8[i+2]),output.push(lookup[(num=tmp)>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[63&num]);return output.join("")}revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63;var _$ieee754_241={read:function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;nBits>0;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;nBits>0;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:1/0*(s?-1:1);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)},write:function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=value<0||0===value&&1/value<0?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),(value+=e+eBias>=1?rt/c:rt*Math.pow(2,1-eBias))*c>=2&&(e++,c/=2),e+eBias>=eMax?(m=0,e=eMax):e+eBias>=1?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));mLen>=8;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;eLen>0;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}},_$buffer_84={};_$buffer_84.Buffer=Buffer,_$buffer_84.SlowBuffer=function SlowBuffer(length){+length!=length&&(length=0);return Buffer.alloc(+length)},_$buffer_84.INSPECT_MAX_BYTES=50;var K_MAX_LENGTH=2147483647;function createBuffer(length){if(length>K_MAX_LENGTH)throw new RangeError("Invalid typed array length");var buf=new Uint8Array(length);return buf.__proto__=Buffer.prototype,buf}function Buffer(arg,encodingOrOffset,length){if("number"==typeof arg){if("string"==typeof encodingOrOffset)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(arg)}return from(arg,encodingOrOffset,length)}function from(value,encodingOrOffset,length){if("number"==typeof value)throw new TypeError('"value" argument must not be a number');return isArrayBuffer(value)||value&&isArrayBuffer(value.buffer)?function fromArrayBuffer(array,byteOffset,length){if(byteOffset<0||array.byteLength<byteOffset)throw new RangeError('"offset" is outside of buffer bounds');if(array.byteLength<byteOffset+(length||0))throw new RangeError('"length" is outside of buffer bounds');var buf;buf=void 0===byteOffset&&void 0===length?new Uint8Array(array):void 0===length?new Uint8Array(array,byteOffset):new Uint8Array(array,byteOffset,length);return buf.__proto__=Buffer.prototype,buf}(value,encodingOrOffset,length):"string"==typeof value?function fromString(string,encoding){"string"==typeof encoding&&""!==encoding||(encoding="utf8");if(!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding);var length=0|__byteLength_84(string,encoding),buf=createBuffer(length),actual=buf.write(string,encoding);actual!==length&&(buf=buf.slice(0,actual));return buf}(value,encodingOrOffset):function fromObject(obj){if(Buffer.isBuffer(obj)){var len=0|checked(obj.length),buf=createBuffer(len);return 0===buf.length?buf:(obj.copy(buf,0,0,len),buf)}if(obj){if(ArrayBuffer.isView(obj)||"length"in obj)return"number"!=typeof obj.length||numberIsNaN(obj.length)?createBuffer(0):fromArrayLike(obj);if("Buffer"===obj.type&&Array.isArray(obj.data))return fromArrayLike(obj.data)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object.")}(value)}function assertSize(size){if("number"!=typeof size)throw new TypeError('"size" argument must be of type number');if(size<0)throw new RangeError('"size" argument must not be negative')}function allocUnsafe(size){return assertSize(size),createBuffer(size<0?0:0|checked(size))}function fromArrayLike(array){for(var length=array.length<0?0:0|checked(array.length),buf=createBuffer(length),i=0;i<length;i+=1)buf[i]=255&array[i];return buf}function checked(length){if(length>=K_MAX_LENGTH)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+K_MAX_LENGTH.toString(16)+" bytes");return 0|length}function __byteLength_84(string,encoding){if(Buffer.isBuffer(string))return string.length;if(ArrayBuffer.isView(string)||isArrayBuffer(string))return string.byteLength;"string"!=typeof string&&(string=""+string);var len=string.length;if(0===len)return 0;for(var loweredCase=!1;;)switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":case void 0:return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*len;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase(),loweredCase=!0}}function swap(b,n,m){var i=b[n];b[n]=b[m],b[m]=i}function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(0===buffer.length)return-1;if("string"==typeof byteOffset?(encoding=byteOffset,byteOffset=0):byteOffset>2147483647?byteOffset=2147483647:byteOffset<-2147483648&&(byteOffset=-2147483648),numberIsNaN(byteOffset=+byteOffset)&&(byteOffset=dir?0:buffer.length-1),byteOffset<0&&(byteOffset=buffer.length+byteOffset),byteOffset>=buffer.length){if(dir)return-1;byteOffset=buffer.length-1}else if(byteOffset<0){if(!dir)return-1;byteOffset=0}if("string"==typeof val&&(val=Buffer.from(val,encoding)),Buffer.isBuffer(val))return 0===val.length?-1:arrayIndexOf(buffer,val,byteOffset,encoding,dir);if("number"==typeof val)return val&=255,"function"==typeof Uint8Array.prototype.indexOf?dir?Uint8Array.prototype.indexOf.call(buffer,val,byteOffset):Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset):arrayIndexOf(buffer,[val],byteOffset,encoding,dir);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){var i,indexSize=1,arrLength=arr.length,valLength=val.length;if(void 0!==encoding&&("ucs2"===(encoding=String(encoding).toLowerCase())||"ucs-2"===encoding||"utf16le"===encoding||"utf-16le"===encoding)){if(arr.length<2||val.length<2)return-1;indexSize=2,arrLength/=2,valLength/=2,byteOffset/=2}function read(buf,i){return 1===indexSize?buf[i]:buf.readUInt16BE(i*indexSize)}if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++)if(read(arr,i)===read(val,-1===foundIndex?0:i-foundIndex)){if(-1===foundIndex&&(foundIndex=i),i-foundIndex+1===valLength)return foundIndex*indexSize}else-1!==foundIndex&&(i-=i-foundIndex),foundIndex=-1}else for(byteOffset+valLength>arrLength&&(byteOffset=arrLength-valLength),i=byteOffset;i>=0;i--){for(var found=!0,j=0;j<valLength;j++)if(read(arr,i+j)!==read(val,j)){found=!1;break}if(found)return i}return-1}function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?(length=Number(length))>remaining&&(length=remaining):length=remaining;var strLen=string.length;length>strLen/2&&(length=strLen/2);for(var i=0;i<length;++i){var parsed=parseInt(string.substr(2*i,2),16);if(numberIsNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(function asciiToBytes(str){for(var byteArray=[],i=0;i<str.length;++i)byteArray.push(255&str.charCodeAt(i));return byteArray}(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(function utf16leToBytes(str,units){for(var c,hi,lo,byteArray=[],i=0;i<str.length&&!((units-=2)<0);++i)c=str.charCodeAt(i),hi=c>>8,lo=c%256,byteArray.push(lo),byteArray.push(hi);return byteArray}(string,buf.length-offset),buf,offset,length)}function base64Slice(buf,start,end){return 0===start&&end===buf.length?_$base64Js_54.fromByteArray(buf):_$base64Js_54.fromByteArray(buf.slice(start,end))}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);for(var res=[],i=start;i<end;){var secondByte,thirdByte,fourthByte,tempCodePoint,firstByte=buf[i],codePoint=null,bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end)switch(bytesPerSequence){case 1:firstByte<128&&(codePoint=firstByte);break;case 2:128==(192&(secondByte=buf[i+1]))&&(tempCodePoint=(31&firstByte)<<6|63&secondByte)>127&&(codePoint=tempCodePoint);break;case 3:secondByte=buf[i+1],thirdByte=buf[i+2],128==(192&secondByte)&&128==(192&thirdByte)&&(tempCodePoint=(15&firstByte)<<12|(63&secondByte)<<6|63&thirdByte)>2047&&(tempCodePoint<55296||tempCodePoint>57343)&&(codePoint=tempCodePoint);break;case 4:secondByte=buf[i+1],thirdByte=buf[i+2],fourthByte=buf[i+3],128==(192&secondByte)&&128==(192&thirdByte)&&128==(192&fourthByte)&&(tempCodePoint=(15&firstByte)<<18|(63&secondByte)<<12|(63&thirdByte)<<6|63&fourthByte)>65535&&tempCodePoint<1114112&&(codePoint=tempCodePoint)}null===codePoint?(codePoint=65533,bytesPerSequence=1):codePoint>65535&&(codePoint-=65536,res.push(codePoint>>>10&1023|55296),codePoint=56320|1023&codePoint),res.push(codePoint),i+=bytesPerSequence}return function decodeCodePointsArray(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,codePoints);var res="",i=0;for(;i<len;)res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH));return res}(res)}_$buffer_84.kMaxLength=K_MAX_LENGTH,Buffer.TYPED_ARRAY_SUPPORT=function typedArraySupport(){try{var arr=new Uint8Array(1);return arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===arr.foo()}catch(e){return!1}}(),Buffer.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Buffer.prototype,"parent",{get:function(){if(this instanceof Buffer)return this.buffer}}),Object.defineProperty(Buffer.prototype,"offset",{get:function(){if(this instanceof Buffer)return this.byteOffset}}),"undefined"!=typeof Symbol&&Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),Buffer.poolSize=8192,Buffer.from=function(value,encodingOrOffset,length){return from(value,encodingOrOffset,length)},Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,Buffer.alloc=function(size,fill,encoding){return function alloc(size,fill,encoding){return assertSize(size),size<=0?createBuffer(size):void 0!==fill?"string"==typeof encoding?createBuffer(size).fill(fill,encoding):createBuffer(size).fill(fill):createBuffer(size)}(size,fill,encoding)},Buffer.allocUnsafe=function(size){return allocUnsafe(size)},Buffer.allocUnsafeSlow=function(size){return allocUnsafe(size)},Buffer.isBuffer=function isBuffer(b){return null!=b&&!0===b._isBuffer},Buffer.compare=function compare(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0},Buffer.isEncoding=function isEncoding(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function concat(list,length){if(!Array.isArray(list))throw new TypeError('"list" argument must be an Array of Buffers');if(0===list.length)return Buffer.alloc(0);var i;if(void 0===length)for(length=0,i=0;i<list.length;++i)length+=list[i].length;var buffer=Buffer.allocUnsafe(length),pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(ArrayBuffer.isView(buf)&&(buf=Buffer.from(buf)),!Buffer.isBuffer(buf))throw new TypeError('"list" argument must be an Array of Buffers');buf.copy(buffer,pos),pos+=buf.length}return buffer},Buffer.byteLength=__byteLength_84,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function swap16(){var len=this.length;if(len%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<len;i+=2)swap(this,i,i+1);return this},Buffer.prototype.swap32=function swap32(){var len=this.length;if(len%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<len;i+=4)swap(this,i,i+3),swap(this,i+1,i+2);return this},Buffer.prototype.swap64=function swap64(){var len=this.length;if(len%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<len;i+=8)swap(this,i,i+7),swap(this,i+1,i+6),swap(this,i+2,i+5),swap(this,i+3,i+4);return this},Buffer.prototype.toString=function toString(){var length=this.length;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):function slowToString(encoding,start,end){var loweredCase=!1;if((void 0===start||start<0)&&(start=0),start>this.length)return"";if((void 0===end||end>this.length)&&(end=this.length),end<=0)return"";if((end>>>=0)<=(start>>>=0))return"";for(encoding||(encoding="utf8");;)switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}}.apply(this,arguments)},Buffer.prototype.toLocaleString=Buffer.prototype.toString,Buffer.prototype.equals=function equals(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b||0===Buffer.compare(this,b)},Buffer.prototype.inspect=function inspect(){var str="",max=_$buffer_84.INSPECT_MAX_BYTES;return this.length>0&&(str=this.toString("hex",0,max).match(/.{2}/g).join(" "),this.length>max&&(str+=" ... ")),"<Buffer "+str+">"},Buffer.prototype.compare=function compare(target,start,end,thisStart,thisEnd){if(!Buffer.isBuffer(target))throw new TypeError("Argument must be a Buffer");if(void 0===start&&(start=0),void 0===end&&(end=target?target.length:0),void 0===thisStart&&(thisStart=0),void 0===thisEnd&&(thisEnd=this.length),start<0||end>target.length||thisStart<0||thisEnd>this.length)throw new RangeError("out of range index");if(thisStart>=thisEnd&&start>=end)return 0;if(thisStart>=thisEnd)return-1;if(start>=end)return 1;if(start>>>=0,end>>>=0,thisStart>>>=0,thisEnd>>>=0,this===target)return 0;for(var x=thisEnd-thisStart,y=end-start,len=Math.min(x,y),thisCopy=this.slice(thisStart,thisEnd),targetCopy=target.slice(start,end),i=0;i<len;++i)if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i],y=targetCopy[i];break}return x<y?-1:y<x?1:0},Buffer.prototype.includes=function includes(val,byteOffset,encoding){return-1!==this.indexOf(val,byteOffset,encoding)},Buffer.prototype.indexOf=function indexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!0)},Buffer.prototype.lastIndexOf=function lastIndexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!1)},Buffer.prototype.write=function write(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,offset=0;else if(void 0===length&&"string"==typeof offset)encoding=offset,length=this.length,offset=0;else{if(!isFinite(offset))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");offset>>>=0,isFinite(length)?(length>>>=0,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0)}var remaining=this.length-offset;if((void 0===length||length>remaining)&&(length=remaining),string.length>0&&(length<0||offset<0)||offset>this.length)throw new RangeError("Attempt to write outside buffer bounds");encoding||(encoding="utf8");for(var loweredCase=!1;;)switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase(),loweredCase=!0}},Buffer.prototype.toJSON=function toJSON(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(127&buf[i]);return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(buf[i]);return ret}function hexSlice(buf,start,end){var len=buf.length;(!start||start<0)&&(start=0),(!end||end<0||end>len)&&(end=len);for(var out="",i=start;i<end;++i)out+=toHex(buf[i]);return out}function utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function checkOffset(offset,ext,length){if(offset%1!=0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return value=+value,offset>>>=0,noAssert||checkIEEE754(buf,0,offset,4),_$ieee754_241.write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return value=+value,offset>>>=0,noAssert||checkIEEE754(buf,0,offset,8),_$ieee754_241.write(buf,value,offset,littleEndian,52,8),offset+8}Buffer.prototype.slice=function slice(start,end){var len=this.length;start=~~start,end=void 0===end?len:~~end,start<0?(start+=len)<0&&(start=0):start>len&&(start=len),end<0?(end+=len)<0&&(end=0):end>len&&(end=len),end<start&&(end=start);var newBuf=this.subarray(start,end);return newBuf.__proto__=Buffer.prototype,newBuf},Buffer.prototype.readUIntLE=function readUIntLE(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUIntBE=function readUIntBE(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset+--byteLength],mul=1;byteLength>0&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUInt8=function readUInt8(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUInt16LE=function readUInt16LE(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUInt16BE=function readUInt16BE(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUInt32LE=function readUInt32LE(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUInt32BE=function readUInt32BE(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readIntLE=function readIntLE(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val>=(mul*=128)&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function readIntBE(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var i=byteLength,mul=1,val=this[offset+--i];i>0&&(mul*=256);)val+=this[offset+--i]*mul;return val>=(mul*=128)&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function readInt8(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,1,this.length),128&this[offset]?-1*(255-this[offset]+1):this[offset]},Buffer.prototype.readInt16LE=function readInt16LE(offset,noAssert){offset>>>=0,noAssert||checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt16BE=function readInt16BE(offset,noAssert){offset>>>=0,noAssert||checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt32LE=function readInt32LE(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function readInt32BE(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readFloatLE=function readFloatLE(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),_$ieee754_241.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function readFloatBE(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),_$ieee754_241.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function readDoubleLE(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,8,this.length),_$ieee754_241.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function readDoubleBE(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,8,this.length),_$ieee754_241.read(this,offset,!1,52,8)},Buffer.prototype.writeUIntLE=function writeUIntLE(value,offset,byteLength,noAssert){(value=+value,offset>>>=0,byteLength>>>=0,noAssert)||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUIntBE=function writeUIntBE(value,offset,byteLength,noAssert){(value=+value,offset>>>=0,byteLength>>>=0,noAssert)||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var i=byteLength-1,mul=1;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUInt8=function writeUInt8(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,1,255,0),this[offset]=255&value,offset+1},Buffer.prototype.writeUInt16LE=function writeUInt16LE(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,65535,0),this[offset]=255&value,this[offset+1]=value>>>8,offset+2},Buffer.prototype.writeUInt16BE=function writeUInt16BE(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,65535,0),this[offset]=value>>>8,this[offset+1]=255&value,offset+2},Buffer.prototype.writeUInt32LE=function writeUInt32LE(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,4294967295,0),this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=255&value,offset+4},Buffer.prototype.writeUInt32BE=function writeUInt32BE(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,4294967295,0),this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value,offset+4},Buffer.prototype.writeIntLE=function writeIntLE(value,offset,byteLength,noAssert){if(value=+value,offset>>>=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0,mul=1,sub=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i-1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function writeIntBE(value,offset,byteLength,noAssert){if(value=+value,offset>>>=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1,mul=1,sub=0;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i+1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function writeInt8(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,1,127,-128),value<0&&(value=255+value+1),this[offset]=255&value,offset+1},Buffer.prototype.writeInt16LE=function writeInt16LE(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,32767,-32768),this[offset]=255&value,this[offset+1]=value>>>8,offset+2},Buffer.prototype.writeInt16BE=function writeInt16BE(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,32767,-32768),this[offset]=value>>>8,this[offset+1]=255&value,offset+2},Buffer.prototype.writeInt32LE=function writeInt32LE(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),this[offset]=255&value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24,offset+4},Buffer.prototype.writeInt32BE=function writeInt32BE(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),value<0&&(value=4294967295+value+1),this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value,offset+4},Buffer.prototype.writeFloatLE=function writeFloatLE(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function writeFloatBE(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function writeDoubleLE(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function writeDoubleBE(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function copy(target,targetStart,start,end){if(!Buffer.isBuffer(target))throw new TypeError("argument should be a Buffer");if(start||(start=0),end||0===end||(end=this.length),targetStart>=target.length&&(targetStart=target.length),targetStart||(targetStart=0),end>0&&end<start&&(end=start),end===start)return 0;if(0===target.length||0===this.length)return 0;if(targetStart<0)throw new RangeError("targetStart out of bounds");if(start<0||start>=this.length)throw new RangeError("Index out of range");if(end<0)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length),target.length-targetStart<end-start&&(end=target.length-targetStart+start);var len=end-start;if(this===target&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(targetStart,start,end);else if(this===target&&start<targetStart&&targetStart<end)for(var i=len-1;i>=0;--i)target[i+targetStart]=this[i+start];else Uint8Array.prototype.set.call(target,this.subarray(start,end),targetStart);return len},Buffer.prototype.fill=function fill(val,start,end,encoding){if("string"==typeof val){if("string"==typeof start?(encoding=start,start=0,end=this.length):"string"==typeof end&&(encoding=end,end=this.length),void 0!==encoding&&"string"!=typeof encoding)throw new TypeError("encoding must be a string");if("string"==typeof encoding&&!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding);if(1===val.length){var code=val.charCodeAt(0);("utf8"===encoding&&code<128||"latin1"===encoding)&&(val=code)}}else"number"==typeof val&&(val&=255);if(start<0||this.length<start||this.length<end)throw new RangeError("Out of range index");if(end<=start)return this;var i;if(start>>>=0,end=void 0===end?this.length:end>>>0,val||(val=0),"number"==typeof val)for(i=start;i<end;++i)this[i]=val;else{var bytes=Buffer.isBuffer(val)?val:new Buffer(val,encoding),len=bytes.length;if(0===len)throw new TypeError('The value "'+val+'" is invalid for argument "value"');for(i=0;i<end-start;++i)this[i+start]=bytes[i%len]}return this};var INVALID_BASE64_RE=/[^+/0-9A-Za-z-_]/g;function toHex(n){return n<16?"0"+n.toString(16):n.toString(16)}function utf8ToBytes(string,units){var codePoint;units=units||1/0;for(var length=string.length,leadSurrogate=null,bytes=[],i=0;i<length;++i){if((codePoint=string.charCodeAt(i))>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){(units-=3)>-1&&bytes.push(239,191,189);continue}if(i+1===length){(units-=3)>-1&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){(units-=3)>-1&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=65536+(leadSurrogate-55296<<10|codePoint-56320)}else leadSurrogate&&(units-=3)>-1&&bytes.push(239,191,189);if(leadSurrogate=null,codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(codePoint<1114112))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function base64ToBytes(str){return _$base64Js_54.toByteArray(function base64clean(str){if((str=(str=str.split("=")[0]).trim().replace(INVALID_BASE64_RE,"")).length<2)return"";for(;str.length%4!=0;)str+="=";return str}(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length&&!(i+offset>=dst.length||i>=src.length);++i)dst[i+offset]=src[i];return i}function isArrayBuffer(obj){return obj instanceof ArrayBuffer||null!=obj&&null!=obj.constructor&&"ArrayBuffer"===obj.constructor.name&&"number"==typeof obj.byteLength}function numberIsNaN(obj){return obj!=obj}var _$dupe_133=function dupe(count,value){switch(void 0===value&&(value=0),typeof count){case"number":if(count>0)return function dupe_number(count,value){var result,i;for(result=new Array(count),i=0;i<count;++i)result[i]=value;return result}(0|count,value);break;case"object":if("number"==typeof count.length)return function dupe_array(count,value,i){var c=0|count[i];if(c<=0)return[];var j,result=new Array(c);if(i===count.length-1)for(j=0;j<c;++j)result[j]=value;else for(j=0;j<c;++j)result[j]=dupe_array(count,value,i+1);return result}(count,value,0)}return[]},_$pool_360={};(function(global,Buffer){"use strict";global.__TYPEDARRAY_POOL||(global.__TYPEDARRAY_POOL={UINT8:_$dupe_133([32,0]),UINT16:_$dupe_133([32,0]),UINT32:_$dupe_133([32,0]),INT8:_$dupe_133([32,0]),INT16:_$dupe_133([32,0]),INT32:_$dupe_133([32,0]),FLOAT:_$dupe_133([32,0]),DOUBLE:_$dupe_133([32,0]),DATA:_$dupe_133([32,0]),UINT8C:_$dupe_133([32,0]),BUFFER:_$dupe_133([32,0])});var hasUint8C="undefined"!=typeof Uint8ClampedArray,POOL=global.__TYPEDARRAY_POOL;POOL.UINT8C||(POOL.UINT8C=_$dupe_133([32,0])),POOL.BUFFER||(POOL.BUFFER=_$dupe_133([32,0]));var DATA=POOL.DATA,BUFFER=POOL.BUFFER;function freeArrayBuffer(buffer){if(buffer){var n=buffer.length||buffer.byteLength,log_n=_$twiddle_72.log2(n);DATA[log_n].push(buffer)}}function mallocArrayBuffer(n){n=_$twiddle_72.nextPow2(n);var log_n=_$twiddle_72.log2(n),d=DATA[log_n];return d.length>0?d.pop():new ArrayBuffer(n)}function mallocUint8(n){return new Uint8Array(mallocArrayBuffer(n),0,n)}function mallocUint16(n){return new Uint16Array(mallocArrayBuffer(2*n),0,n)}function mallocUint32(n){return new Uint32Array(mallocArrayBuffer(4*n),0,n)}function mallocInt8(n){return new Int8Array(mallocArrayBuffer(n),0,n)}function mallocInt16(n){return new Int16Array(mallocArrayBuffer(2*n),0,n)}function mallocInt32(n){return new Int32Array(mallocArrayBuffer(4*n),0,n)}function mallocFloat(n){return new Float32Array(mallocArrayBuffer(4*n),0,n)}function mallocDouble(n){return new Float64Array(mallocArrayBuffer(8*n),0,n)}function mallocUint8Clamped(n){return hasUint8C?new Uint8ClampedArray(mallocArrayBuffer(n),0,n):mallocUint8(n)}function mallocDataView(n){return new DataView(mallocArrayBuffer(n),0,n)}function mallocBuffer(n){n=_$twiddle_72.nextPow2(n);var log_n=_$twiddle_72.log2(n),cache=BUFFER[log_n];return cache.length>0?cache.pop():new Buffer(n)}_$pool_360.free=function free(array){if(Buffer.isBuffer(array))BUFFER[_$twiddle_72.log2(array.length)].push(array);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(array)&&(array=array.buffer),!array)return;var n=array.length||array.byteLength,log_n=0|_$twiddle_72.log2(n);DATA[log_n].push(array)}},_$pool_360.freeUint8=_$pool_360.freeUint16=_$pool_360.freeUint32=_$pool_360.freeInt8=_$pool_360.freeInt16=_$pool_360.freeInt32=_$pool_360.freeFloat32=_$pool_360.freeFloat=_$pool_360.freeFloat64=_$pool_360.freeDouble=_$pool_360.freeUint8Clamped=_$pool_360.freeDataView=function freeTypedArray(array){freeArrayBuffer(array.buffer)},_$pool_360.freeArrayBuffer=freeArrayBuffer,_$pool_360.freeBuffer=function freeBuffer(array){BUFFER[_$twiddle_72.log2(array.length)].push(array)},_$pool_360.malloc=function malloc(n,dtype){if(void 0===dtype||"arraybuffer"===dtype)return mallocArrayBuffer(n);switch(dtype){case"uint8":return mallocUint8(n);case"uint16":return mallocUint16(n);case"uint32":return mallocUint32(n);case"int8":return mallocInt8(n);case"int16":return mallocInt16(n);case"int32":return mallocInt32(n);case"float":case"float32":return mallocFloat(n);case"double":case"float64":return mallocDouble(n);case"uint8_clamped":return mallocUint8Clamped(n);case"buffer":return mallocBuffer(n);case"data":case"dataview":return mallocDataView(n);default:return null}return null},_$pool_360.mallocArrayBuffer=mallocArrayBuffer,_$pool_360.mallocUint8=mallocUint8,_$pool_360.mallocUint16=mallocUint16,_$pool_360.mallocUint32=mallocUint32,_$pool_360.mallocInt8=mallocInt8,_$pool_360.mallocInt16=mallocInt16,_$pool_360.mallocInt32=mallocInt32,_$pool_360.mallocFloat32=_$pool_360.mallocFloat=mallocFloat,_$pool_360.mallocFloat64=_$pool_360.mallocDouble=mallocDouble,_$pool_360.mallocUint8Clamped=mallocUint8Clamped,_$pool_360.mallocDataView=mallocDataView,_$pool_360.mallocBuffer=mallocBuffer,_$pool_360.clearCache=function clearCache(){for(var i=0;i<32;++i)POOL.UINT8[i].length=0,POOL.UINT16[i].length=0,POOL.UINT32[i].length=0,POOL.INT8[i].length=0,POOL.INT16[i].length=0,POOL.INT32[i].length=0,POOL.FLOAT[i].length=0,POOL.DOUBLE[i].length=0,POOL.UINT8C[i].length=0,DATA[i].length=0,BUFFER[i].length=0}}).call(this,void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},_$buffer_84.Buffer);var SUPPORTED_TYPES=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function GLBuffer(gl,type,handle,length,usage){this.gl=gl,this.type=type,this.handle=handle,this.length=length,this.usage=usage}var __proto_153=GLBuffer.prototype;function updateTypeArray(gl,type,len,usage,data,offset){var dataLen=data.length*data.BYTES_PER_ELEMENT;if(offset<0)return gl.bufferData(type,data,usage),dataLen;if(dataLen+offset>len)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return gl.bufferSubData(type,offset,data),len}function makeScratchTypeArray(array,dtype){for(var res=_$pool_360.malloc(array.length,dtype),n=array.length,i=0;i<n;++i)res[i]=array[i];return res}__proto_153.bind=function(){this.gl.bindBuffer(this.type,this.handle)},__proto_153.unbind=function(){this.gl.bindBuffer(this.type,null)},__proto_153.dispose=function(){this.gl.deleteBuffer(this.handle)},__proto_153.update=function(array,offset){if("number"!=typeof offset&&(offset=-1),this.bind(),"object"==typeof array&&void 0!==array.shape){var dtype=array.dtype;if(SUPPORTED_TYPES.indexOf(dtype)<0&&(dtype="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER)dtype=gl.getExtension("OES_element_index_uint")&&"uint16"!==dtype?"uint32":"uint16";if(dtype===array.dtype&&function isPacked(shape,stride){for(var n=1,i=stride.length-1;i>=0;--i){if(stride[i]!==n)return!1;n*=shape[i]}return!0}(array.shape,array.stride))0===array.offset&&array.data.length===array.shape[0]?this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,array.data,offset):this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,array.data.subarray(array.offset,array.shape[0]),offset);else{var tmp=_$pool_360.malloc(array.size,dtype),ndt=_$wrappedNDArrayCtor_277(tmp,array.shape);_$ndarrayOps_271.assign(ndt,array),this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,offset<0?tmp:tmp.subarray(0,array.size),offset),_$pool_360.free(tmp)}}else if(Array.isArray(array)){var t;t=this.type===this.gl.ELEMENT_ARRAY_BUFFER?makeScratchTypeArray(array,"uint16"):makeScratchTypeArray(array,"float32"),this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,offset<0?t:t.subarray(0,array.length),offset),_$pool_360.free(t)}else if("object"==typeof array&&"number"==typeof array.length)this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,array,offset);else{if("number"!=typeof array&&void 0!==array)throw new Error("gl-buffer: Invalid data type");if(offset>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");(array|=0)<=0&&(array=1),this.gl.bufferData(this.type,0|array,this.usage),this.length=array}};var _$createBuffer_153=function __createBuffer_153(gl,data,type,usage){if(type=type||gl.ARRAY_BUFFER,usage=usage||gl.DYNAMIC_DRAW,type!==gl.ARRAY_BUFFER&&type!==gl.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(usage!==gl.DYNAMIC_DRAW&&usage!==gl.STATIC_DRAW&&usage!==gl.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var result=new GLBuffer(gl,type,gl.createBuffer(),0,usage);return result.update(data),result},_$browser_238=function(strings){"string"==typeof strings&&(strings=[strings]);for(var exprs=[].slice.call(arguments,1),parts=[],i=0;i<strings.length-1;i++)parts.push(strings[i],exprs[i]||"");return parts.push(strings[i]),parts.join("")},FRAGMENT=_$browser_238(["precision lowp float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = vec4(color.xyz * color.w, color.w);\n}\n"]),_$shaders_191={lineVert:_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 start, end;\nuniform float width;\n\nvec2 perp(vec2 v) {\n  return vec2(v.y, -v.x);\n}\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  vec2 delta = normalize(perp(start - end));\n  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));\n  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);\n}\n"]),lineFrag:FRAGMENT,textVert:_$browser_238(["#define GLSLIFY 1\nattribute vec3 textCoordinate;\n\nuniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;\nuniform float angle;\n\nvoid main() {\n  float dataOffset  = textCoordinate.z;\n  vec2 glyphOffset  = textCoordinate.xy;\n  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +\n    glyphMatrix * glyphOffset * textScale + screenOffset;\n  gl_Position = vec4(screenCoordinate, 0, 1);\n}\n"]),textFrag:FRAGMENT,gridVert:_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale;\nuniform float lineWidth;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;\n  gl_Position = vec4(pos, 0, 1);\n}\n"]),gridFrag:FRAGMENT,boxVert:_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 lo, hi;\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);\n}\n"]),tickVert:_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);\n}\n"])};function GLError(rawError,shortMessage,longMessage){this.shortMessage=shortMessage||"",this.longMessage=longMessage||"",this.rawError=rawError||"",this.message="gl-shader: "+(shortMessage||rawError||"")+(longMessage?"\n"+longMessage:""),this.stack=(new Error).stack}GLError.prototype=new Error,GLError.prototype.name="GLError",GLError.prototype.constructor=GLError;var _$GLError_207=GLError,_$createAttributeWrapper_208=function createAttributeWrapper(gl,wrapper,attributes,locations){for(var obj={},i=0,n=attributes.length;i<n;++i){var a=attributes[i],name=a.name,type=a.type,locs=a.locations;switch(type){case"bool":case"int":case"float":addVectorAttribute(gl,wrapper,locs[0],locations,1,obj,name);break;default:if(type.indexOf("vec")>=0){var d=type.charCodeAt(type.length-1)-48;if(d<2||d>4)throw new _$GLError_207("","Invalid data type for attribute "+name+": "+type);addVectorAttribute(gl,wrapper,locs[0],locations,d,obj,name)}else{if(!(type.indexOf("mat")>=0))throw new _$GLError_207("","Unknown data type for attribute "+name+": "+type);var d=type.charCodeAt(type.length-1)-48;if(d<2||d>4)throw new _$GLError_207("","Invalid data type for attribute "+name+": "+type);addMatrixAttribute(gl,wrapper,locs,locations,d,obj,name)}}}return obj};function ShaderAttribute(gl,wrapper,index,locations,dimension,constFunc){this._gl=gl,this._wrapper=wrapper,this._index=index,this._locations=locations,this._dimension=dimension,this._constFunc=constFunc}var __proto_208=ShaderAttribute.prototype;function addVectorAttribute(gl,wrapper,index,locations,dimension,obj,name){for(var constFuncArgs=["gl","v"],varNames=[],i=0;i<dimension;++i)constFuncArgs.push("x"+i),varNames.push("x"+i);constFuncArgs.push("if(x0.length===void 0){return gl.vertexAttrib"+dimension+"f(v,"+varNames.join()+")}else{return gl.vertexAttrib"+dimension+"fv(v,x0)}");var constFunc=Function.apply(null,constFuncArgs),attr=new ShaderAttribute(gl,wrapper,index,locations,dimension,constFunc);Object.defineProperty(obj,name,{set:function(x){return gl.disableVertexAttribArray(locations[index]),constFunc(gl,locations[index],x),x},get:function(){return attr},enumerable:!0})}function addMatrixAttribute(gl,wrapper,index,locations,dimension,obj,name){for(var parts=new Array(dimension),attrs=new Array(dimension),i=0;i<dimension;++i)addVectorAttribute(gl,wrapper,index[i],locations,dimension,parts,i),attrs[i]=parts[i];Object.defineProperty(parts,"location",{set:function(v){if(Array.isArray(v))for(var i=0;i<dimension;++i)attrs[i].location=v[i];else for(i=0;i<dimension;++i)attrs[i].location=v+i;return v},get:function(){for(var result=new Array(dimension),i=0;i<dimension;++i)result[i]=locations[index[i]];return result},enumerable:!0}),parts.pointer=function(type,normalized,stride,offset){type=type||gl.FLOAT,normalized=!!normalized,stride=stride||dimension*dimension,offset=offset||0;for(var i=0;i<dimension;++i){var location=locations[index[i]];gl.vertexAttribPointer(location,dimension,type,normalized,stride,offset+i*dimension),gl.enableVertexAttribArray(location)}};var scratch=new Array(dimension),vertexAttrib=gl["vertexAttrib"+dimension+"fv"];Object.defineProperty(obj,name,{set:function(x){for(var i=0;i<dimension;++i){var loc=locations[index[i]];if(gl.disableVertexAttribArray(loc),Array.isArray(x[0]))vertexAttrib.call(gl,loc,x[i]);else{for(var j=0;j<dimension;++j)scratch[j]=x[dimension*i+j];vertexAttrib.call(gl,loc,scratch)}}return x},get:function(){return parts},enumerable:!0})}__proto_208.pointer=function setAttribPointer(type,normalized,stride,offset){var gl=this._gl,location=this._locations[this._index];gl.vertexAttribPointer(location,this._dimension,type||gl.FLOAT,!!normalized,stride||0,offset||0),gl.enableVertexAttribArray(location)},__proto_208.set=function(x0,x1,x2,x3){return this._constFunc(this._locations[this._index],x0,x1,x2,x3)},Object.defineProperty(__proto_208,"location",{get:function(){return this._locations[this._index]},set:function(v){return v!==this._locations[this._index]&&(this._locations[this._index]=0|v,this._wrapper.program=null),0|v}});var _$makeReflectTypes_210=function makeReflectTypes(uniforms,useIndex){for(var obj={},i=0;i<uniforms.length;++i)for(var n=uniforms[i].name,parts=n.split("."),o=obj,j=0;j<parts.length;++j){var x=parts[j].split("[");if(x.length>1){x[0]in o||(o[x[0]]=[]),o=o[x[0]];for(var k=1;k<x.length;++k){var y=parseInt(x[k]);k<x.length-1||j<parts.length-1?(y in o||(k<x.length-1?o[y]=[]:o[y]={}),o=o[y]):o[y]=useIndex?i:uniforms[i].type}}else j<parts.length-1?(x[0]in o||(o[x[0]]={}),o=o[x[0]]):o[x[0]]=useIndex?i:uniforms[i].type}return obj};var _$createUniformWrapper_209=function createUniformWrapper(gl,wrapper,uniforms,locations){function makePropSetter(path,index,type){switch(type){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+index+"],obj"+path+")";case"float":return"gl.uniform1f(locations["+index+"],obj"+path+")";default:var vidx=type.indexOf("vec");if(!(0<=vidx&&vidx<=1&&type.length===4+vidx)){if(0===type.indexOf("mat")&&4===type.length){var d=type.charCodeAt(type.length-1)-48;if(d<2||d>4)throw new _$GLError_207("","Invalid uniform dimension type for matrix "+name+": "+type);return"gl.uniformMatrix"+d+"fv(locations["+index+"],false,obj"+path+")"}throw new _$GLError_207("","Unknown uniform data type for "+name+": "+type)}var d=type.charCodeAt(type.length-1)-48;if(d<2||d>4)throw new _$GLError_207("","Invalid data type");switch(type.charAt(0)){case"b":case"i":return"gl.uniform"+d+"iv(locations["+index+"],obj"+path+")";case"v":return"gl.uniform"+d+"fv(locations["+index+"],obj"+path+")";default:throw new _$GLError_207("","Unrecognized data type for vector "+name+": "+type)}}}function makeSetter(type){for(var code=["return function updateProperty(obj){"],indices=function enumerateIndices(prefix,type){if("object"!=typeof type)return[[prefix,type]];var indices=[];for(var id in type){var prop=type[id],tprefix=prefix;parseInt(id)+""===id?tprefix+="["+id+"]":tprefix+="."+id,"object"==typeof prop?indices.push.apply(indices,enumerateIndices(tprefix,prop)):indices.push([tprefix,prop])}return indices}("",type),i=0;i<indices.length;++i){var item=indices[i],path=item[0],idx=item[1];locations[idx]&&code.push(makePropSetter(path,idx,uniforms[idx].type))}code.push("return obj}");var proc=new Function("gl","locations",code.join("\n"));return proc(gl,locations)}function storeProperty(obj,prop,type){if("object"==typeof type){var child=processObject(type);Object.defineProperty(obj,prop,{get:identity(child),set:makeSetter(type),enumerable:!0,configurable:!1})}else locations[type]?Object.defineProperty(obj,prop,{get:function makeGetter(index){return new Function("gl","wrapper","locations","return function(){return gl.getUniform(wrapper.program,locations["+index+"])}")(gl,wrapper,locations)}(type),set:makeSetter(type),enumerable:!0,configurable:!1}):obj[prop]=function defaultValue(type){switch(type){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":case"float":return 0;default:var vidx=type.indexOf("vec");if(0<=vidx&&vidx<=1&&type.length===4+vidx){var d=type.charCodeAt(type.length-1)-48;if(d<2||d>4)throw new _$GLError_207("","Invalid data type");return"b"===type.charAt(0)?makeVector(d,!1):makeVector(d,0)}if(0===type.indexOf("mat")&&4===type.length){var d=type.charCodeAt(type.length-1)-48;if(d<2||d>4)throw new _$GLError_207("","Invalid uniform dimension type for matrix "+name+": "+type);return makeVector(d*d,0)}throw new _$GLError_207("","Unknown uniform data type for "+name+": "+type)}}(uniforms[type].type)}function processObject(obj){var result;if(Array.isArray(obj)){result=new Array(obj.length);for(var i=0;i<obj.length;++i)storeProperty(result,i,obj[i])}else for(var id in result={},obj)storeProperty(result,id,obj[id]);return result}var coallesced=_$makeReflectTypes_210(uniforms,!0);return{get:identity(processObject(coallesced)),set:makeSetter(coallesced),enumerable:!0,configurable:!0}};function identity(x){return new Function("y","return function(){return y}")(x)}function makeVector(length,fill){for(var result=new Array(length),i=0;i<length;++i)result[i]=fill;return result}var _$runtimeReflect_211={uniforms:function runtimeUniforms(gl,program){for(var numUniforms=gl.getProgramParameter(program,gl.ACTIVE_UNIFORMS),result=[],i=0;i<numUniforms;++i){var info=gl.getActiveUniform(program,i);if(info){var type=getType(gl,info.type);if(info.size>1)for(var j=0;j<info.size;++j)result.push({name:info.name.replace("[0]","["+j+"]"),type:type});else result.push({name:info.name,type:type})}}return result},attributes:function runtimeAttributes(gl,program){for(var numAttributes=gl.getProgramParameter(program,gl.ACTIVE_ATTRIBUTES),result=[],i=0;i<numAttributes;++i){var info=gl.getActiveAttrib(program,i);info&&result.push({name:info.name,type:getType(gl,info.type)})}return result}},GL_TO_GLSL_TYPES={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},GL_TABLE=null;function getType(gl,type){if(!GL_TABLE){var typeNames=Object.keys(GL_TO_GLSL_TYPES);GL_TABLE={};for(var i=0;i<typeNames.length;++i){var tn=typeNames[i];GL_TABLE[gl[tn]]=GL_TO_GLSL_TYPES[tn]}}return GL_TABLE[type]}var cache,res="",_$repeat_316=function repeat(str,num){if("string"!=typeof str)throw new TypeError("expected a string");if(1===num)return str;if(2===num)return str+str;var max=str.length*num;if(cache!==str||void 0===cache)cache=str,res="";else if(res.length>=max)return res.substr(0,max);for(;max>res.length&&num>1;)1&num&&(res+=str),num>>=1,str+=str;return res=(res+=str).substr(0,max)};var _$padLeft_284=function padLeft(str,num,ch){return _$repeat_316(ch=void 0!==ch?ch+"":" ",num)+str},_$addLineNumbers_44=function addLineNumbers(string,start,delim){start="number"==typeof start?start:1,delim=delim||": ";var lines=string.split(/\r?\n/),totalDigits=String(lines.length+start-1).length;return lines.map(function(line,i){var c=i+start,digits=String(c).length,prefix=_$padLeft_284(c,totalDigits-digits);return prefix+delim+line}).join("\n")};var _$numbers_154={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34000:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"},_$lookupConstant_155=function lookupConstant(number){return _$numbers_154[number]},_$_atob_52=function _atob(str){return atob(str)},_$builtins_233=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"],_$builtins300es_232=(_$builtins_233=_$builtins_233.slice().filter(function(b){return!/^(gl\_|texture)/.test(b)})).concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"]),_$literals_235=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"],_$literals300es_234=_$literals_235.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uint","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"]),_$operators_236=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"],_$tokenize_231=function tokenize(opt){var c,last,len,i=0,total=0,mode=NORMAL,content=[],tokens=[],line=1,col=0,start=0,isnum=!1,isoperator=!1,input="",allBuiltins=_$builtins_233,allLiterals=_$literals_235;"300 es"===(opt=opt||{}).version&&(allBuiltins=_$builtins300es_232,allLiterals=_$literals300es_234);return function(data){return tokens=[],null!==data?function write(chunk){var last;i=0,len=(input+=chunk).length;for(;c=input[i],i<len;){switch(last=i,mode){case BLOCK_COMMENT:i=block_comment();break;case LINE_COMMENT:case PREPROCESSOR:i=preprocessor();break;case OPERATOR:i=operator();break;case INTEGER:i=integer();break;case HEX:i=hex();break;case FLOAT:i=decimal();break;case TOKEN:i=readtoken();break;case WHITESPACE:i=whitespace();break;case NORMAL:i=normal()}if(last!==i)switch(input[last]){case"\n":col=0,++line;break;default:++col}}return total+=i,input=input.slice(i),tokens}(data.replace?data.replace(/\r\n/g,"\n"):data):function end(chunk){content.length&&token(content.join(""));return mode=EOF,token("(eof)"),tokens}()};function token(data){data.length&&tokens.push({type:map[mode],data:data,position:start,line:line,column:col})}function normal(){return content=content.length?[]:content,"/"===last&&"*"===c?(start=total+i-1,mode=BLOCK_COMMENT,last=c,i+1):"/"===last&&"/"===c?(start=total+i-1,mode=LINE_COMMENT,last=c,i+1):"#"===c?(mode=PREPROCESSOR,start=total+i,i):/\s/.test(c)?(mode=WHITESPACE,start=total+i,i):(isnum=/\d/.test(c),isoperator=/[^\w_]/.test(c),start=total+i,mode=isnum?INTEGER:isoperator?OPERATOR:TOKEN,i)}function whitespace(){return/[^\s]/g.test(c)?(token(content.join("")),mode=NORMAL,i):(content.push(c),last=c,i+1)}function preprocessor(){return"\r"!==c&&"\n"!==c||"\\"===last?(content.push(c),last=c,i+1):(token(content.join("")),mode=NORMAL,i)}function block_comment(){return"/"===c&&"*"===last?(content.push(c),token(content.join("")),mode=NORMAL,i+1):(content.push(c),last=c,i+1)}function operator(){if("."===last&&/\d/.test(c))return mode=FLOAT,i;if("/"===last&&"*"===c)return mode=BLOCK_COMMENT,i;if("/"===last&&"/"===c)return mode=LINE_COMMENT,i;if("."===c&&content.length){for(;determine_operator(content););return mode=FLOAT,i}if(";"===c||")"===c||"("===c){if(content.length)for(;determine_operator(content););return token(c),mode=NORMAL,i+1}var is_composite_operator=2===content.length&&"="!==c;if(/[\w_\d\s]/.test(c)||is_composite_operator){for(;determine_operator(content););return mode=NORMAL,i}return content.push(c),last=c,i+1}function determine_operator(buf){for(var idx,res,j=0;;){if(idx=_$operators_236.indexOf(buf.slice(0,buf.length+j).join("")),res=_$operators_236[idx],-1===idx){if(j--+buf.length>0)continue;res=buf.slice(0,1).join("")}return token(res),start+=res.length,(content=content.slice(res.length)).length}}function hex(){return/[^a-fA-F0-9]/.test(c)?(token(content.join("")),mode=NORMAL,i):(content.push(c),last=c,i+1)}function integer(){return"."===c?(content.push(c),mode=FLOAT,last=c,i+1):/[eE]/.test(c)?(content.push(c),mode=FLOAT,last=c,i+1):"x"===c&&1===content.length&&"0"===content[0]?(mode=HEX,content.push(c),last=c,i+1):/[^\d]/.test(c)?(token(content.join("")),mode=NORMAL,i):(content.push(c),last=c,i+1)}function decimal(){return"f"===c&&(content.push(c),last=c,i+=1),/[eE]/.test(c)?(content.push(c),last=c,i+1):"-"===c&&/[eE]/.test(last)?(content.push(c),last=c,i+1):/[^\d]/.test(c)?(token(content.join("")),mode=NORMAL,i):(content.push(c),last=c,i+1)}function readtoken(){if(/[^\d\w_]/.test(c)){var contentstr=content.join("");return mode=allLiterals.indexOf(contentstr)>-1?KEYWORD:allBuiltins.indexOf(contentstr)>-1?BUILTIN:IDENT,token(content.join("")),mode=NORMAL,i}return content.push(c),last=c,i+1}},NORMAL=999,TOKEN=9999,BLOCK_COMMENT=0,LINE_COMMENT=1,PREPROCESSOR=2,OPERATOR=3,INTEGER=4,FLOAT=5,IDENT=6,BUILTIN=7,KEYWORD=8,WHITESPACE=9,EOF=10,HEX=11,map=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];var _$tokenizeString_237=function tokenizeString(str,opt){var generator=_$tokenize_231(opt),tokens=[];return tokens=(tokens=tokens.concat(generator(str))).concat(generator(null))};var _$getName_230=function getName(src){for(var tokens=Array.isArray(src)?src:_$tokenizeString_237(src),i=0;i<tokens.length;i++){var token=tokens[i];if("preprocessor"===token.type){var match=token.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(match&&match[2]){var b64=match[1],name=match[2];return(b64?_$_atob_52(name):name).trim()}}}};var _$sprintf_343={};!function(){"use strict";var re={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};function sprintf(key){return function sprintf_format(parse_tree,argv){var arg,i,k,match,pad,pad_character,pad_length,is_positive,sign,cursor=1,tree_length=parse_tree.length,output="";for(i=0;i<tree_length;i++)if("string"==typeof parse_tree[i])output+=parse_tree[i];else if(Array.isArray(parse_tree[i])){if((match=parse_tree[i])[2])for(arg=argv[cursor],k=0;k<match[2].length;k++){if(!arg.hasOwnProperty(match[2][k]))throw new Error(sprintf('[sprintf] property "%s" does not exist',match[2][k]));arg=arg[match[2][k]]}else arg=match[1]?argv[match[1]]:argv[cursor++];if(re.not_type.test(match[8])&&re.not_primitive.test(match[8])&&arg instanceof Function&&(arg=arg()),re.numeric_arg.test(match[8])&&"number"!=typeof arg&&isNaN(arg))throw new TypeError(sprintf("[sprintf] expecting number but found %T",arg));switch(re.number.test(match[8])&&(is_positive=arg>=0),match[8]){case"b":arg=parseInt(arg,10).toString(2);break;case"c":arg=String.fromCharCode(parseInt(arg,10));break;case"d":case"i":arg=parseInt(arg,10);break;case"j":arg=JSON.stringify(arg,null,match[6]?parseInt(match[6]):0);break;case"e":arg=match[7]?parseFloat(arg).toExponential(match[7]):parseFloat(arg).toExponential();break;case"f":arg=match[7]?parseFloat(arg).toFixed(match[7]):parseFloat(arg);break;case"g":arg=match[7]?String(Number(arg.toPrecision(match[7]))):parseFloat(arg);break;case"o":arg=(parseInt(arg,10)>>>0).toString(8);break;case"s":arg=String(arg),arg=match[7]?arg.substring(0,match[7]):arg;break;case"t":arg=String(!!arg),arg=match[7]?arg.substring(0,match[7]):arg;break;case"T":arg=Object.prototype.toString.call(arg).slice(8,-1).toLowerCase(),arg=match[7]?arg.substring(0,match[7]):arg;break;case"u":arg=parseInt(arg,10)>>>0;break;case"v":arg=arg.valueOf(),arg=match[7]?arg.substring(0,match[7]):arg;break;case"x":arg=(parseInt(arg,10)>>>0).toString(16);break;case"X":arg=(parseInt(arg,10)>>>0).toString(16).toUpperCase()}re.json.test(match[8])?output+=arg:(!re.number.test(match[8])||is_positive&&!match[3]?sign="":(sign=is_positive?"+":"-",arg=arg.toString().replace(re.sign,"")),pad_character=match[4]?"0"===match[4]?"0":match[4].charAt(1):" ",pad_length=match[6]-(sign+arg).length,pad=match[6]&&pad_length>0?pad_character.repeat(pad_length):"",output+=match[5]?sign+arg+pad:"0"===pad_character?sign+pad+arg:pad+sign+arg)}return output}(function sprintf_parse(fmt){if(sprintf_cache[fmt])return sprintf_cache[fmt];var match,_fmt=fmt,parse_tree=[],arg_names=0;for(;_fmt;){if(null!==(match=re.text.exec(_fmt)))parse_tree.push(match[0]);else if(null!==(match=re.modulo.exec(_fmt)))parse_tree.push("%");else{if(null===(match=re.placeholder.exec(_fmt)))throw new SyntaxError("[sprintf] unexpected placeholder");if(match[2]){arg_names|=1;var field_list=[],replacement_field=match[2],field_match=[];if(null===(field_match=re.key.exec(replacement_field)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(field_list.push(field_match[1]);""!==(replacement_field=replacement_field.substring(field_match[0].length));)if(null!==(field_match=re.key_access.exec(replacement_field)))field_list.push(field_match[1]);else{if(null===(field_match=re.index_access.exec(replacement_field)))throw new SyntaxError("[sprintf] failed to parse named argument key");field_list.push(field_match[1])}match[2]=field_list}else arg_names|=2;if(3===arg_names)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");parse_tree.push(match)}_fmt=_fmt.substring(match[0].length)}return sprintf_cache[fmt]=parse_tree}(key),arguments)}function vsprintf(fmt,argv){return sprintf.apply(null,[fmt].concat(argv||[]))}var sprintf_cache=Object.create(null);void 0!==_$sprintf_343&&(_$sprintf_343.sprintf=sprintf,_$sprintf_343.vsprintf=vsprintf),"undefined"!=typeof window&&(window.sprintf=sprintf,window.vsprintf=vsprintf)}();var sprintf=_$sprintf_343.sprintf,_$formatCompilerError_159=function formatCompilerError(errLog,src,type){"use strict";var name=_$getName_230(src)||"of unknown name (see npm glsl-shader-name)",typeName="unknown type";void 0!==type&&(typeName=type===_$lookupConstant_155.FRAGMENT_SHADER?"fragment":"vertex");for(var longForm=sprintf("Error compiling %s shader %s:\n",typeName,name),shortForm=sprintf("%s%s",longForm,errLog),errorStrings=errLog.split("\n"),errors={},i=0;i<errorStrings.length;i++){var errorString=errorStrings[i];if(""!==errorString&&"\0"!==errorString){var lineNo=parseInt(errorString.split(":")[2]);if(isNaN(lineNo))throw new Error(sprintf("Could not parse error: %s",errorString));errors[lineNo]=errorString}}for(var lines=_$addLineNumbers_44(src).split("\n"),i=0;i<lines.length;i++)if(errors[i+3]||errors[i+2]||errors[i+1]){var line=lines[i];if(longForm+=line+"\n",errors[i+1]){var e=errors[i+1];e=e.substr(e.split(":",3).join(":").length+1).trim(),longForm+=sprintf("^^^ %s\n\n",e)}}return{long:longForm.trim(),short:shortForm.trim()}};var _$hiddenStore_371=function hiddenStore(obj,key){var store={identity:key},valueOf=obj.valueOf;return Object.defineProperty(obj,"valueOf",{value:function(value){return value!==key?valueOf.apply(this,arguments):store},writable:!0}),store};var _$createStore_370=function createStore(){var key={};return function(obj){if(("object"!=typeof obj||null===obj)&&"function"!=typeof obj)throw new Error("Weakmap-shim: Key must be object");var store=obj.valueOf(key);return store&&store.identity===key?store:_$hiddenStore_371(obj,key)}};var _$shaderCache_212={shader:function getShaderReference(gl,type,src){return getCache(gl).getShaderReference(type,src)},program:function createProgram(gl,vref,fref,attribs,locations){return getCache(gl).getProgram(vref,fref,attribs,locations)}},CACHE=new("undefined"==typeof WeakMap?function weakMap(){var privates=_$createStore_370();return{get:function(key,fallback){var store=privates(key);return store.hasOwnProperty("value")?store.value:fallback},set:function(key,value){return privates(key).value=value,this},has:function(key){return"value"in privates(key)},delete:function(key){return delete privates(key).value}}}:WeakMap),SHADER_COUNTER=0;function ShaderReference(id,src,type,shader,programs,count,cache){this.id=id,this.src=src,this.type=type,this.shader=shader,this.count=count,this.programs=[],this.cache=cache}function ContextCache(gl){this.gl=gl,this.shaders=[{},{}],this.programs={}}ShaderReference.prototype.dispose=function(){if(0==--this.count){for(var cache=this.cache,gl=cache.gl,programs=this.programs,i=0,n=programs.length;i<n;++i){var p=cache.programs[programs[i]];p&&(delete cache.programs[i],gl.deleteProgram(p))}gl.deleteShader(this.shader),delete cache.shaders[this.type===gl.FRAGMENT_SHADER|0][this.src]}};var __proto_212=ContextCache.prototype;function getCache(gl){var ctxCache=CACHE.get(gl);return ctxCache||(ctxCache=new ContextCache(gl),CACHE.set(gl,ctxCache)),ctxCache}function Shader(gl){this.gl=gl,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}__proto_212.getShaderReference=function(type,src){var gl=this.gl,shaders=this.shaders[type===gl.FRAGMENT_SHADER|0],shader=shaders[src];if(shader&&gl.isShader(shader.shader))shader.count+=1;else{var shaderObj=function compileShader(gl,type,src){var shader=gl.createShader(type);if(gl.shaderSource(shader,src),gl.compileShader(shader),!gl.getShaderParameter(shader,gl.COMPILE_STATUS)){var errLog=gl.getShaderInfoLog(shader);try{var fmt=_$formatCompilerError_159(errLog,src,type)}catch(e){throw console.warn("Failed to format compiler error: "+e),new _$GLError_207(errLog,"Error compiling shader:\n"+errLog)}throw new _$GLError_207(errLog,fmt.short,fmt.long)}return shader}(gl,type,src);shader=shaders[src]=new ShaderReference(SHADER_COUNTER++,src,type,shaderObj,[],1,this)}return shader},__proto_212.getProgram=function(vref,fref,attribs,locations){var token=[vref.id,fref.id,attribs.join(":"),locations.join(":")].join("@"),prog=this.programs[token];return prog&&this.gl.isProgram(prog)||(this.programs[token]=prog=function linkProgram(gl,vshader,fshader,attribs,locations){var program=gl.createProgram();gl.attachShader(program,vshader),gl.attachShader(program,fshader);for(var i=0;i<attribs.length;++i)gl.bindAttribLocation(program,locations[i],attribs[i]);if(gl.linkProgram(program),!gl.getProgramParameter(program,gl.LINK_STATUS)){var errLog=gl.getProgramInfoLog(program);throw new _$GLError_207(errLog,"Error linking program: "+errLog)}return program}(this.gl,vref.shader,fref.shader,attribs,locations),vref.programs.push(token),fref.programs.push(token)),prog};var __proto_206=Shader.prototype;function compareAttributes(a,b){return a.name<b.name?-1:1}__proto_206.bind=function(){var i;this.program||this._relink();var newAttribCount=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),oldAttribCount=this.gl.lastAttribCount;if(newAttribCount>oldAttribCount)for(i=oldAttribCount;i<newAttribCount;i++)this.gl.enableVertexAttribArray(i);else if(oldAttribCount>newAttribCount)for(i=newAttribCount;i<oldAttribCount;i++)this.gl.disableVertexAttribArray(i);this.gl.lastAttribCount=newAttribCount,this.gl.useProgram(this.program)},__proto_206.dispose=function(){for(var oldAttribCount=this.gl.lastAttribCount,i=0;i<oldAttribCount;i++)this.gl.disableVertexAttribArray(i);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},__proto_206.update=function(vertSource,fragSource,uniforms,attributes){if(!fragSource||1===arguments.length){var obj=vertSource;vertSource=obj.vertex,fragSource=obj.fragment,uniforms=obj.uniforms,attributes=obj.attributes}var wrapper=this,gl=wrapper.gl,pvref=wrapper._vref;wrapper._vref=_$shaderCache_212.shader(gl,gl.VERTEX_SHADER,vertSource),pvref&&pvref.dispose(),wrapper.vertShader=wrapper._vref.shader;var pfref=this._fref;if(wrapper._fref=_$shaderCache_212.shader(gl,gl.FRAGMENT_SHADER,fragSource),pfref&&pfref.dispose(),wrapper.fragShader=wrapper._fref.shader,!uniforms||!attributes){var testProgram=gl.createProgram();if(gl.attachShader(testProgram,wrapper.fragShader),gl.attachShader(testProgram,wrapper.vertShader),gl.linkProgram(testProgram),!gl.getProgramParameter(testProgram,gl.LINK_STATUS)){var errLog=gl.getProgramInfoLog(testProgram);throw new _$GLError_207(errLog,"Error linking program:"+errLog)}uniforms=uniforms||_$runtimeReflect_211.uniforms(gl,testProgram),attributes=attributes||_$runtimeReflect_211.attributes(gl,testProgram),gl.deleteProgram(testProgram)}(attributes=attributes.slice()).sort(compareAttributes);var i,attributeUnpacked=[],attributeNames=[],attributeLocations=[];for(i=0;i<attributes.length;++i){var attr=attributes[i];if(attr.type.indexOf("mat")>=0){for(var size=0|attr.type.charAt(attr.type.length-1),locVector=new Array(size),j=0;j<size;++j)locVector[j]=attributeLocations.length,attributeNames.push(attr.name+"["+j+"]"),"number"==typeof attr.location?attributeLocations.push(attr.location+j):Array.isArray(attr.location)&&attr.location.length===size&&"number"==typeof attr.location[j]?attributeLocations.push(0|attr.location[j]):attributeLocations.push(-1);attributeUnpacked.push({name:attr.name,type:attr.type,locations:locVector})}else attributeUnpacked.push({name:attr.name,type:attr.type,locations:[attributeLocations.length]}),attributeNames.push(attr.name),"number"==typeof attr.location?attributeLocations.push(0|attr.location):attributeLocations.push(-1)}var curLocation=0;for(i=0;i<attributeLocations.length;++i)if(attributeLocations[i]<0){for(;attributeLocations.indexOf(curLocation)>=0;)curLocation+=1;attributeLocations[i]=curLocation}var uniformLocations=new Array(uniforms.length);function relink(){wrapper.program=_$shaderCache_212.program(gl,wrapper._vref,wrapper._fref,attributeNames,attributeLocations);for(var i=0;i<uniforms.length;++i)uniformLocations[i]=gl.getUniformLocation(wrapper.program,uniforms[i].name)}relink(),wrapper._relink=relink,wrapper.types={uniforms:_$makeReflectTypes_210(uniforms),attributes:_$makeReflectTypes_210(attributes)},wrapper.attributes=_$createAttributeWrapper_208(gl,wrapper,attributeUnpacked,attributeLocations),Object.defineProperty(wrapper,"uniforms",_$createUniformWrapper_209(gl,wrapper,uniforms,uniformLocations))};var _$createShader_206=function createShader(gl,vertSource,fragSource,uniforms,attributes){var shader=new Shader(gl);return shader.update(vertSource,fragSource,uniforms,attributes),shader},_$createBoxes_188=function createBoxes(plot){var gl=plot.gl,vbo=_$createBuffer_153(gl,[0,0,0,1,1,0,1,1]),shader=_$createShader_206(gl,_$shaders_191.boxVert,_$shaders_191.lineFrag);return new Boxes(plot,vbo,shader)};function Boxes(plot,vbo,shader){this.plot=plot,this.vbo=vbo,this.shader=shader}var lo,hi,__proto_188=Boxes.prototype;function compileSearch(funcName,predicate,reversed,extraArgs,earlyOut){var code=["function ",funcName,"(a,l,h,",extraArgs.join(","),"){",earlyOut?"":"var i=",reversed?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a[m]"];return earlyOut?predicate.indexOf("c")<0?code.push(";if(x===y){return m}else if(x<=y){"):code.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):code.push(";if(",predicate,"){i=m;"),reversed?code.push("l=m+1}else{h=m-1}"):code.push("h=m-1}else{l=m+1}"),code.push("}"),earlyOut?code.push("return -1};"):code.push("return i};"),code.join("")}function compileBoundsSearch(predicate,reversed,suffix,earlyOut){return new Function([compileSearch("A","x"+predicate+"y",reversed,["y"],earlyOut),compileSearch("P","c(x,y)"+predicate+"0",reversed,["y","c"],earlyOut),"function dispatchBsearch",suffix,"(a,y,c,l,h){if(typeof(c)==='function'){return P(a,(l===void 0)?0:l|0,(h===void 0)?a.length-1:h|0,y,c)}else{return A(a,(c===void 0)?0:c|0,(l===void 0)?a.length-1:l|0,y)}}return dispatchBsearch",suffix].join(""))()}__proto_188.bind=function(){var shader=this.shader;this.vbo.bind(),this.shader.bind(),shader.attributes.coord.pointer(),shader.uniforms.screenBox=this.plot.screenBox},__proto_188.drawBox=(lo=[0,0],hi=[0,0],function(loX,loY,hiX,hiY,color){var plot=this.plot,shader=this.shader,gl=plot.gl;lo[0]=loX,lo[1]=loY,hi[0]=hiX,hi[1]=hiY,shader.uniforms.lo=lo,shader.uniforms.hi=hi,shader.uniforms.color=color,gl.drawArrays(gl.TRIANGLE_STRIP,0,4)}),__proto_188.dispose=function(){this.vbo.dispose(),this.shader.dispose()};var _$searchBounds_90={ge:compileBoundsSearch(">=",!1,"GE"),gt:compileBoundsSearch(">",!1,"GT"),lt:compileBoundsSearch("<",!0,"LT"),le:compileBoundsSearch("<=",!0,"LE"),eq:compileBoundsSearch("-",!0,"EQ",!0)};function __compileSearch_193(funcName,predicate,reversed,extraArgs,earlyOut){var code=["function ",funcName,"(a,l,h,",extraArgs.join(","),"){",earlyOut?"":"var i=",reversed?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a[m]"];return earlyOut?predicate.indexOf("c")<0?code.push(";if(x===y){return m}else if(x<=y){"):code.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):code.push(";if(",predicate,"){i=m;"),reversed?code.push("l=m+1}else{h=m-1}"):code.push("h=m-1}else{l=m+1}"),code.push("}"),earlyOut?code.push("return -1};"):code.push("return i};"),code.join("")}function __compileBoundsSearch_193(predicate,reversed,suffix,earlyOut){return new Function([__compileSearch_193("A","x"+predicate+"y",reversed,["y"],earlyOut),__compileSearch_193("P","c(x,y)"+predicate+"0",reversed,["y","c"],earlyOut),"function dispatchBsearch",suffix,"(a,y,c,l,h){if(typeof(c)==='function'){return P(a,(l===void 0)?0:l|0,(h===void 0)?a.length-1:h|0,y,c)}else{return A(a,(c===void 0)?0:c|0,(l===void 0)?a.length-1:l|0,y)}}return dispatchBsearch",suffix].join(""))()}var _$searchBounds_193={ge:__compileBoundsSearch_193(">=",!1,"GE"),gt:__compileBoundsSearch_193(">",!1,"GT"),lt:__compileBoundsSearch_193("<",!0,"LT"),le:__compileBoundsSearch_193("<=",!0,"LE"),eq:__compileBoundsSearch_193("-",!0,"EQ",!0)},_$createGrid_189=function createGrid(plot){var gl=plot.gl,vbo=_$createBuffer_153(gl),shader=_$createShader_206(gl,_$shaders_191.gridVert,_$shaders_191.gridFrag),tickShader=_$createShader_206(gl,_$shaders_191.tickVert,_$shaders_191.gridFrag);return new Grid(plot,vbo,shader,tickShader)};function Grid(plot,vbo,shader,tickShader){this.plot=plot,this.vbo=vbo,this.shader=shader,this.tickShader=tickShader,this.ticks=[[],[]]}function compareTickNum(a,b){return a-b}var DATA_SHIFT,DATA_SCALE,DATA_AXIS,OFFSET_X,OFFSET_Y,__proto_189=Grid.prototype;__proto_189.draw=(DATA_SHIFT=[0,0],DATA_SCALE=[0,0],DATA_AXIS=[0,0],function(){for(var plot=this.plot,vbo=this.vbo,shader=this.shader,ticks=this.ticks,gl=plot.gl,bounds=plot._tickBounds,dataBox=plot.dataBox,viewPixels=plot.viewBox,lineWidth=plot.gridLineWidth,gridColor=plot.gridLineColor,gridEnable=plot.gridLineEnable,pixelRatio=plot.pixelRatio,i=0;i<2;++i){var lo=bounds[i],boundScale=bounds[i+2]-lo,dataCenter=.5*(dataBox[i+2]+dataBox[i]),dataWidth=dataBox[i+2]-dataBox[i];DATA_SCALE[i]=2*boundScale/dataWidth,DATA_SHIFT[i]=2*(lo-dataCenter)/dataWidth}shader.bind(),vbo.bind(),shader.attributes.dataCoord.pointer(),shader.uniforms.dataShift=DATA_SHIFT,shader.uniforms.dataScale=DATA_SCALE;var offset=0;for(i=0;i<2;++i){DATA_AXIS[0]=DATA_AXIS[1]=0,DATA_AXIS[i]=1,shader.uniforms.dataAxis=DATA_AXIS,shader.uniforms.lineWidth=lineWidth[i]/(viewPixels[i+2]-viewPixels[i])*pixelRatio,shader.uniforms.color=gridColor[i];var size=6*ticks[i].length;gridEnable[i]&&size&&gl.drawArrays(gl.TRIANGLES,offset,size),offset+=size}}),__proto_189.drawTickMarks=function(){var DATA_SHIFT=[0,0],DATA_SCALE=[0,0],X_AXIS=[1,0],Y_AXIS=[0,1],SCR_OFFSET=[0,0],TICK_SCALE=[0,0];return function(){for(var plot=this.plot,vbo=this.vbo,shader=this.tickShader,ticks=this.ticks,gl=plot.gl,bounds=plot._tickBounds,dataBox=plot.dataBox,viewBox=plot.viewBox,pixelRatio=plot.pixelRatio,screenBox=plot.screenBox,screenWidth=screenBox[2]-screenBox[0],screenHeight=screenBox[3]-screenBox[1],viewWidth=viewBox[2]-viewBox[0],viewHeight=viewBox[3]-viewBox[1],i=0;i<2;++i){var lo=bounds[i],boundScale=bounds[i+2]-lo,dataCenter=.5*(dataBox[i+2]+dataBox[i]),dataWidth=dataBox[i+2]-dataBox[i];DATA_SCALE[i]=2*boundScale/dataWidth,DATA_SHIFT[i]=2*(lo-dataCenter)/dataWidth}DATA_SCALE[0]*=viewWidth/screenWidth,DATA_SHIFT[0]*=viewWidth/screenWidth,DATA_SCALE[1]*=viewHeight/screenHeight,DATA_SHIFT[1]*=viewHeight/screenHeight,shader.bind(),vbo.bind(),shader.attributes.dataCoord.pointer();var uniforms=shader.uniforms;uniforms.dataShift=DATA_SHIFT,uniforms.dataScale=DATA_SCALE;var tickMarkLength=plot.tickMarkLength,tickMarkWidth=plot.tickMarkWidth,tickMarkColor=plot.tickMarkColor,yTicksOffset=6*ticks[0].length,xStart=Math.min(_$searchBounds_193.ge(ticks[0],(dataBox[0]-bounds[0])/(bounds[2]-bounds[0]),compareTickNum),ticks[0].length),xEnd=Math.min(_$searchBounds_193.gt(ticks[0],(dataBox[2]-bounds[0])/(bounds[2]-bounds[0]),compareTickNum),ticks[0].length),xOffset=0+6*xStart,xCount=6*Math.max(0,xEnd-xStart),yStart=Math.min(_$searchBounds_193.ge(ticks[1],(dataBox[1]-bounds[1])/(bounds[3]-bounds[1]),compareTickNum),ticks[1].length),yEnd=Math.min(_$searchBounds_193.gt(ticks[1],(dataBox[3]-bounds[1])/(bounds[3]-bounds[1]),compareTickNum),ticks[1].length),yOffset=yTicksOffset+6*yStart,yCount=6*Math.max(0,yEnd-yStart);SCR_OFFSET[0]=2*(viewBox[0]-tickMarkLength[1])/screenWidth-1,SCR_OFFSET[1]=(viewBox[3]+viewBox[1])/screenHeight-1,TICK_SCALE[0]=tickMarkLength[1]*pixelRatio/screenWidth,TICK_SCALE[1]=tickMarkWidth[1]*pixelRatio/screenHeight,yCount&&(uniforms.color=tickMarkColor[1],uniforms.tickScale=TICK_SCALE,uniforms.dataAxis=Y_AXIS,uniforms.screenOffset=SCR_OFFSET,gl.drawArrays(gl.TRIANGLES,yOffset,yCount)),SCR_OFFSET[0]=(viewBox[2]+viewBox[0])/screenWidth-1,SCR_OFFSET[1]=2*(viewBox[1]-tickMarkLength[0])/screenHeight-1,TICK_SCALE[0]=tickMarkWidth[0]*pixelRatio/screenWidth,TICK_SCALE[1]=tickMarkLength[0]*pixelRatio/screenHeight,xCount&&(uniforms.color=tickMarkColor[0],uniforms.tickScale=TICK_SCALE,uniforms.dataAxis=X_AXIS,uniforms.screenOffset=SCR_OFFSET,gl.drawArrays(gl.TRIANGLES,xOffset,xCount)),SCR_OFFSET[0]=2*(viewBox[2]+tickMarkLength[3])/screenWidth-1,SCR_OFFSET[1]=(viewBox[3]+viewBox[1])/screenHeight-1,TICK_SCALE[0]=tickMarkLength[3]*pixelRatio/screenWidth,TICK_SCALE[1]=tickMarkWidth[3]*pixelRatio/screenHeight,yCount&&(uniforms.color=tickMarkColor[3],uniforms.tickScale=TICK_SCALE,uniforms.dataAxis=Y_AXIS,uniforms.screenOffset=SCR_OFFSET,gl.drawArrays(gl.TRIANGLES,yOffset,yCount)),SCR_OFFSET[0]=(viewBox[2]+viewBox[0])/screenWidth-1,SCR_OFFSET[1]=2*(viewBox[3]+tickMarkLength[2])/screenHeight-1,TICK_SCALE[0]=tickMarkWidth[2]*pixelRatio/screenWidth,TICK_SCALE[1]=tickMarkLength[2]*pixelRatio/screenHeight,xCount&&(uniforms.color=tickMarkColor[2],uniforms.tickScale=TICK_SCALE,uniforms.dataAxis=X_AXIS,uniforms.screenOffset=SCR_OFFSET,gl.drawArrays(gl.TRIANGLES,xOffset,xCount))}}(),__proto_189.update=(OFFSET_X=[1,1,-1,-1,1,-1],OFFSET_Y=[1,-1,1,1,-1,-1],function(options){for(var ticks=options.ticks,bounds=options.bounds,data=new Float32Array(18*(ticks[0].length+ticks[1].length)),ptr=(this.plot.zeroLineEnable,0),gridTicks=[[],[]],dim=0;dim<2;++dim)for(var localTicks=gridTicks[dim],axisTicks=ticks[dim],lo=bounds[dim],hi=bounds[dim+2],i=0;i<axisTicks.length;++i){var x=(axisTicks[i].x-lo)/(hi-lo);localTicks.push(x);for(var j=0;j<6;++j)data[ptr++]=x,data[ptr++]=OFFSET_X[j],data[ptr++]=OFFSET_Y[j]}this.ticks=gridTicks,this.vbo.update(data)}),__proto_189.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()};var _$createLines_190=function createLines(plot){var gl=plot.gl,vbo=_$createBuffer_153(gl,[-1,-1,-1,1,1,-1,1,1]),shader=_$createShader_206(gl,_$shaders_191.lineVert,_$shaders_191.lineFrag);return new Lines(plot,vbo,shader)};function Lines(plot,vbo,shader){this.plot=plot,this.vbo=vbo,this.shader=shader}var start,end,__proto_190=Lines.prototype;__proto_190.bind=function(){var shader=this.shader;this.vbo.bind(),this.shader.bind(),shader.attributes.coord.pointer(),shader.uniforms.screenBox=this.plot.screenBox},__proto_190.drawLine=(start=[0,0],end=[0,0],function(startX,startY,endX,endY,width,color){var plot=this.plot,shader=this.shader,gl=plot.gl;start[0]=startX,start[1]=startY,end[0]=endX,end[1]=endY,shader.uniforms.start=start,shader.uniforms.end=end,shader.uniforms.width=width*plot.pixelRatio,shader.uniforms.color=color,gl.drawArrays(gl.TRIANGLE_STRIP,0,4)}),__proto_190.dispose=function(){this.vbo.dispose(),this.shader.dispose()};var _$twoProduct_358=function twoProduct(a,b,result){var x=a*b,c=SPLITTER*a,ahi=c-(c-a),alo=a-ahi,d=SPLITTER*b,bhi=d-(d-b),blo=b-bhi,y=alo*blo-(x-ahi*bhi-alo*bhi-ahi*blo);if(result)return result[0]=y,result[1]=x,result;return[y,x]},SPLITTER=+(Math.pow(2,27)+1);var _$fastTwoSum_359=function fastTwoSum(a,b,result){var x=a+b,bv=x-a,br=b-bv,ar=a-(x-bv);if(result)return result[0]=ar+br,result[1]=x,result;return[ar+br,x]};var _$scaleLinearExpansion_325=function scaleLinearExpansion(e,scale){var n=e.length;if(1===n){var ts=_$twoProduct_358(e[0],scale);return ts[0]?ts:[ts[1]]}var g=new Array(2*n),q=[.1,.1],t=[.1,.1],count=0;_$twoProduct_358(e[0],scale,q),q[0]&&(g[count++]=q[0]);for(var i=1;i<n;++i){_$twoProduct_358(e[i],scale,t);var pq=q[1];_$fastTwoSum_359(pq,t[0],q),q[0]&&(g[count++]=q[0]);var a=t[1],b=q[1],x=a+b,bv=x-a,y=b-bv;q[1]=x,y&&(g[count++]=y)}q[1]&&(g[count++]=q[1]);0===count&&(g[count++]=0);return g.length=count,g};var _$robustSubtract_327=function robustSubtract(e,f){var ne=0|e.length,nf=0|f.length;if(1===ne&&1===nf)return function scalarScalar(a,b){var x=a+b,bv=x-a,y=a-(x-bv)+(b-bv);if(y)return[y,x];return[x]}(e[0],-f[0]);var a,b,g=new Array(ne+nf),count=0,eptr=0,fptr=0,abs=Math.abs,ei=e[eptr],ea=abs(ei),fi=-f[fptr],fa=abs(fi);ea<fa?(b=ei,(eptr+=1)<ne&&(ei=e[eptr],ea=abs(ei))):(b=fi,(fptr+=1)<nf&&(fi=-f[fptr],fa=abs(fi)));eptr<ne&&ea<fa||fptr>=nf?(a=ei,(eptr+=1)<ne&&(ei=e[eptr],ea=abs(ei))):(a=fi,(fptr+=1)<nf&&(fi=-f[fptr],fa=abs(fi)));var _x,_bv,x=a+b,bv=x-a,y=b-bv,q0=y,q1=x;for(;eptr<ne&&fptr<nf;)ea<fa?(a=ei,(eptr+=1)<ne&&(ei=e[eptr],ea=abs(ei))):(a=fi,(fptr+=1)<nf&&(fi=-f[fptr],fa=abs(fi))),(y=(b=q0)-(bv=(x=a+b)-a))&&(g[count++]=y),q0=q1-((_x=q1+x)-(_bv=_x-q1))+(x-_bv),q1=_x;for(;eptr<ne;)(y=(b=q0)-(bv=(x=(a=ei)+b)-a))&&(g[count++]=y),q0=q1-((_x=q1+x)-(_bv=_x-q1))+(x-_bv),q1=_x,(eptr+=1)<ne&&(ei=e[eptr]);for(;fptr<nf;)(y=(b=q0)-(bv=(x=(a=fi)+b)-a))&&(g[count++]=y),q0=q1-((_x=q1+x)-(_bv=_x-q1))+(x-_bv),q1=_x,(fptr+=1)<nf&&(fi=-f[fptr]);q0&&(g[count++]=q0);q1&&(g[count++]=q1);count||(g[count++]=0);return g.length=count,g};var _$linearExpansionSum_328=function linearExpansionSum(e,f){var ne=0|e.length,nf=0|f.length;if(1===ne&&1===nf)return function __scalarScalar_328(a,b){var x=a+b,bv=x-a,y=a-(x-bv)+(b-bv);if(y)return[y,x];return[x]}(e[0],f[0]);var a,b,g=new Array(ne+nf),count=0,eptr=0,fptr=0,abs=Math.abs,ei=e[eptr],ea=abs(ei),fi=f[fptr],fa=abs(fi);ea<fa?(b=ei,(eptr+=1)<ne&&(ei=e[eptr],ea=abs(ei))):(b=fi,(fptr+=1)<nf&&(fi=f[fptr],fa=abs(fi)));eptr<ne&&ea<fa||fptr>=nf?(a=ei,(eptr+=1)<ne&&(ei=e[eptr],ea=abs(ei))):(a=fi,(fptr+=1)<nf&&(fi=f[fptr],fa=abs(fi)));var _x,_bv,x=a+b,bv=x-a,y=b-bv,q0=y,q1=x;for(;eptr<ne&&fptr<nf;)ea<fa?(a=ei,(eptr+=1)<ne&&(ei=e[eptr],ea=abs(ei))):(a=fi,(fptr+=1)<nf&&(fi=f[fptr],fa=abs(fi))),(y=(b=q0)-(bv=(x=a+b)-a))&&(g[count++]=y),q0=q1-((_x=q1+x)-(_bv=_x-q1))+(x-_bv),q1=_x;for(;eptr<ne;)(y=(b=q0)-(bv=(x=(a=ei)+b)-a))&&(g[count++]=y),q0=q1-((_x=q1+x)-(_bv=_x-q1))+(x-_bv),q1=_x,(eptr+=1)<ne&&(ei=e[eptr]);for(;fptr<nf;)(y=(b=q0)-(bv=(x=(a=fi)+b)-a))&&(g[count++]=y),q0=q1-((_x=q1+x)-(_bv=_x-q1))+(x-_bv),q1=_x,(fptr+=1)<nf&&(fi=f[fptr]);q0&&(g[count++]=q0);q1&&(g[count++]=q1);count||(g[count++]=0);return g.length=count,g};var _$inSphere_321={},NUM_EXPAND=6;function cofactor(m,c){for(var result=new Array(m.length-1),i=1;i<m.length;++i)for(var r=result[i-1]=new Array(m.length-1),j=0,k=0;j<m.length;++j)j!==c&&(r[k++]=m[i][j]);return result}function generateSum(expr){if(1===expr.length)return expr[0];if(2===expr.length)return["sum(",expr[0],",",expr[1],")"].join("");var m=expr.length>>1;return["sum(",generateSum(expr.slice(0,m)),",",generateSum(expr.slice(m)),")"].join("")}function makeProduct(a,b){if("m"===a.charAt(0)){if("w"===b.charAt(0)){var toks=a.split("[");return["w",b.substr(1),"m",toks[0].substr(1)].join("")}return["prod(",a,",",b,")"].join("")}return makeProduct(b,a)}function determinant(m){if(2===m.length)return[["diff(",makeProduct(m[0][0],m[1][1]),",",makeProduct(m[1][0],m[0][1]),")"].join("")];for(var expr=[],i=0;i<m.length;++i)expr.push(["scale(",generateSum(determinant(cofactor(m,i))),",",(s=i,!0&s?"-":""),m[0][i],")"].join(""));return expr;var s}function makeSquare(d,n){for(var terms=[],i=0;i<n-2;++i)terms.push(["prod(m",d,"[",i,"],m",d,"[",i,"])"].join(""));return generateSum(terms)}function orientation(n){for(var pos=[],neg=[],m=function matrix(n){for(var result=new Array(n),i=0;i<n;++i){result[i]=new Array(n);for(var j=0;j<n;++j)result[i][j]=["m",j,"[",n-i-2,"]"].join("")}return result}(n),i=0;i<n;++i)m[0][i]="1",m[n-1][i]="w"+i;for(i=0;i<n;++i)0==(1&i)?pos.push.apply(pos,determinant(cofactor(m,i))):neg.push.apply(neg,determinant(cofactor(m,i)));var posExpr=generateSum(pos),negExpr=generateSum(neg),funcName="exactInSphere"+n,funcArgs=[];for(i=0;i<n;++i)funcArgs.push("m"+i);var code=["function ",funcName,"(",funcArgs.join(),"){"];for(i=0;i<n;++i){code.push("var w",i,"=",makeSquare(i,n),";");for(var j=0;j<n;++j)j!==i&&code.push("var w",i,"m",j,"=scale(w",i,",m",j,"[0]);")}return code.push("var p=",posExpr,",n=",negExpr,",d=diff(p,n);return d[d.length-1];}return ",funcName),new Function("sum","diff","prod","scale",code.join(""))(_$linearExpansionSum_328,_$robustSubtract_327,_$twoProduct_358,_$scaleLinearExpansion_325)}var CACHED=[function inSphere0(){return 0},function inSphere1(){return 0},function inSphere2(){return 0}];!function generateInSphereTest(){for(;CACHED.length<=NUM_EXPAND;)CACHED.push(orientation(CACHED.length));for(var args=[],procArgs=["slow"],i=0;i<=NUM_EXPAND;++i)args.push("a"+i),procArgs.push("o"+i);var code=["function testInSphere(",args.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(i=2;i<=NUM_EXPAND;++i)code.push("case ",i,":return o",i,"(",args.slice(0,i).join(),");");code.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return testInSphere"),procArgs.push(code.join(""));var proc=Function.apply(void 0,procArgs);for(_$inSphere_321=proc.apply(void 0,[function slowInSphere(args){var proc=CACHED[args.length];return proc||(proc=CACHED[args.length]=orientation(args.length)),proc.apply(void 0,args)}].concat(CACHED)),i=0;i<=NUM_EXPAND;++i)_$inSphere_321[i]=CACHED[i]}();var inCircle=_$inSphere_321[4],_$delaunayRefine_86=function delaunayRefine(points,triangulation){for(var stack=[],numPoints=points.length,stars=triangulation.stars,a=0;a<numPoints;++a)for(var star=stars[a],j=1;j<star.length;j+=2){var b=star[j];if(!(b<a)&&!triangulation.isConstraint(a,b)){for(var x=star[j-1],y=-1,k=1;k<star.length;k+=2)if(star[k-1]===b){y=star[k];break}y<0||inCircle(points[a],points[b],points[x],points[y])<0&&stack.push(a,b)}}for(;stack.length>0;){for(var b=stack.pop(),a=stack.pop(),x=-1,y=-1,star=stars[a],i=1;i<star.length;i+=2){var s=star[i-1],t=star[i];s===b?y=t:t===b&&(x=s)}x<0||y<0||(inCircle(points[a],points[b],points[x],points[y])>=0||(triangulation.flip(a,b),testFlip(points,triangulation,stack,x,a,y),testFlip(points,triangulation,stack,a,y,x),testFlip(points,triangulation,stack,y,b,x),testFlip(points,triangulation,stack,b,x,y)))}};function testFlip(points,triangulation,stack,a,b,x){var y=triangulation.opposite(a,b);if(!(y<0)){if(b<a){var tmp=a;a=b,b=tmp,tmp=x,x=y,y=tmp}triangulation.isConstraint(a,b)||inCircle(points[a],points[b],points[x],points[y])<0&&stack.push(a,b)}}var key,_$classifyFaces_87=function classifyFaces(triangulation,target,infinity){var index=function indexCells(triangulation,infinity){for(var cells=triangulation.cells(),nc=cells.length,i=0;i<nc;++i){var c=cells[i],x=c[0],y=c[1],z=c[2];y<z?y<x&&(c[0]=y,c[1]=z,c[2]=x):z<x&&(c[0]=z,c[1]=x,c[2]=y)}cells.sort(compareCell);for(var flags=new Array(nc),i=0;i<flags.length;++i)flags[i]=0;var active=[],next=[],neighbor=new Array(3*nc),constraint=new Array(3*nc),boundary=null;infinity&&(boundary=[]);for(var index=new FaceIndex(cells,neighbor,constraint,flags,active,next,boundary),i=0;i<nc;++i)for(var c=cells[i],j=0;j<3;++j){var x=c[j],y=c[(j+1)%3],a=neighbor[3*i+j]=index.locate(y,x,triangulation.opposite(y,x)),b=constraint[3*i+j]=triangulation.isConstraint(x,y);a<0&&(b?next.push(i):(active.push(i),flags[i]=1),infinity&&boundary.push([y,x,-1]))}return index}(triangulation,infinity);if(0===target)return infinity?index.cells.concat(index.boundary):index.cells;var side=1,active=index.active,next=index.next,flags=index.flags,cells=index.cells,constraint=index.constraint,neighbor=index.neighbor;for(;active.length>0||next.length>0;){for(;active.length>0;){var t=active.pop();if(flags[t]!==-side){flags[t]=side;cells[t];for(var j=0;j<3;++j){var f=neighbor[3*t+j];f>=0&&0===flags[f]&&(constraint[3*t+j]?next.push(f):(active.push(f),flags[f]=side))}}}var tmp=next;next=active,active=tmp,next.length=0,side=-side}var result=function filterCells(cells,flags,target){for(var ptr=0,i=0;i<cells.length;++i)flags[i]===target&&(cells[ptr++]=cells[i]);return cells.length=ptr,cells}(cells,flags,target);if(infinity)return result.concat(index.boundary);return result};function FaceIndex(cells,neighbor,constraint,flags,active,next,boundary){this.cells=cells,this.neighbor=neighbor,this.flags=flags,this.constraint=constraint,this.active=active,this.next=next,this.boundary=boundary}function compareCell(a,b){return a[0]-b[0]||a[1]-b[1]||a[2]-b[2]}FaceIndex.prototype.locate=(key=[0,0,0],function(a,b,c){var x=a,y=b,z=c;return b<c?b<a&&(x=b,y=c,z=a):c<a&&(x=c,y=a,z=b),x<0?-1:(key[0]=x,key[1]=y,key[2]=z,_$searchBounds_90.eq(this.cells,key,compareCell))});var _$orientation_323={},__NUM_EXPAND_323=5;function __cofactor_323(m,c){for(var result=new Array(m.length-1),i=1;i<m.length;++i)for(var r=result[i-1]=new Array(m.length-1),j=0,k=0;j<m.length;++j)j!==c&&(r[k++]=m[i][j]);return result}function __generateSum_323(expr){if(1===expr.length)return expr[0];if(2===expr.length)return["sum(",expr[0],",",expr[1],")"].join("");var m=expr.length>>1;return["sum(",__generateSum_323(expr.slice(0,m)),",",__generateSum_323(expr.slice(m)),")"].join("")}function __determinant_323(m){if(2===m.length)return[["sum(prod(",m[0][0],",",m[1][1],"),prod(-",m[0][1],",",m[1][0],"))"].join("")];for(var expr=[],i=0;i<m.length;++i)expr.push(["scale(",__generateSum_323(__determinant_323(__cofactor_323(m,i))),",",(n=i,1&n?"-":""),m[0][i],")"].join(""));return expr;var n}function __orientation_323(n){for(var pos=[],neg=[],m=function __matrix_323(n){for(var result=new Array(n),i=0;i<n;++i){result[i]=new Array(n);for(var j=0;j<n;++j)result[i][j]=["m",j,"[",n-i-1,"]"].join("")}return result}(n),args=[],i=0;i<n;++i)0==(1&i)?pos.push.apply(pos,__determinant_323(__cofactor_323(m,i))):neg.push.apply(neg,__determinant_323(__cofactor_323(m,i))),args.push("m"+i);var posExpr=__generateSum_323(pos),negExpr=__generateSum_323(neg),funcName="orientation"+n+"Exact",code=["function ",funcName,"(",args.join(),"){var p=",posExpr,",n=",negExpr,",d=sub(p,n);return d[d.length-1];};return ",funcName].join("");return new Function("sum","prod","scale","sub",code)(_$linearExpansionSum_328,_$twoProduct_358,_$scaleLinearExpansion_325,_$robustSubtract_327)}var orientation3Exact=__orientation_323(3),orientation4Exact=__orientation_323(4),__CACHED_323=[function orientation0(){return 0},function orientation1(){return 0},function orientation2(a,b){return b[0]-a[0]},function orientation3(a,b,c){var s,l=(a[1]-c[1])*(b[0]-c[0]),r=(a[0]-c[0])*(b[1]-c[1]),det=l-r;if(l>0){if(r<=0)return det;s=l+r}else{if(!(l<0))return det;if(r>=0)return det;s=-(l+r)}var tol=3.3306690738754716e-16*s;return det>=tol||det<=-tol?det:orientation3Exact(a,b,c)},function orientation4(a,b,c,d){var adx=a[0]-d[0],bdx=b[0]-d[0],cdx=c[0]-d[0],ady=a[1]-d[1],bdy=b[1]-d[1],cdy=c[1]-d[1],adz=a[2]-d[2],bdz=b[2]-d[2],cdz=c[2]-d[2],bdxcdy=bdx*cdy,cdxbdy=cdx*bdy,cdxady=cdx*ady,adxcdy=adx*cdy,adxbdy=adx*bdy,bdxady=bdx*ady,det=adz*(bdxcdy-cdxbdy)+bdz*(cdxady-adxcdy)+cdz*(adxbdy-bdxady),tol=7.771561172376103e-16*((Math.abs(bdxcdy)+Math.abs(cdxbdy))*Math.abs(adz)+(Math.abs(cdxady)+Math.abs(adxcdy))*Math.abs(bdz)+(Math.abs(adxbdy)+Math.abs(bdxady))*Math.abs(cdz));return det>tol||-det>tol?det:orientation4Exact(a,b,c,d)}];!function generateOrientationProc(){for(;__CACHED_323.length<=__NUM_EXPAND_323;)__CACHED_323.push(__orientation_323(__CACHED_323.length));for(var args=[],procArgs=["slow"],i=0;i<=__NUM_EXPAND_323;++i)args.push("a"+i),procArgs.push("o"+i);var code=["function getOrientation(",args.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(i=2;i<=__NUM_EXPAND_323;++i)code.push("case ",i,":return o",i,"(",args.slice(0,i).join(),");");code.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),procArgs.push(code.join(""));var proc=Function.apply(void 0,procArgs);for(_$orientation_323=proc.apply(void 0,[function slowOrient(args){var proc=__CACHED_323[args.length];return proc||(proc=__CACHED_323[args.length]=__orientation_323(args.length)),proc.apply(void 0,args)}].concat(__CACHED_323)),i=0;i<=__NUM_EXPAND_323;++i)_$orientation_323[i]=__CACHED_323[i]}();var orient=_$orientation_323[3],EVENT_POINT=0,EVENT_END=1,EVENT_START=2,_$monotoneTriangulate_88=function monotoneTriangulate(points,edges){for(var numPoints=points.length,numEdges=edges.length,events=[],i=0;i<numPoints;++i)events.push(new Event(points[i],null,EVENT_POINT,i));for(var i=0;i<numEdges;++i){var e=edges[i],a=points[e[0]],b=points[e[1]];a[0]<b[0]?events.push(new Event(a,b,EVENT_START,i),new Event(b,a,EVENT_END,i)):a[0]>b[0]&&events.push(new Event(b,a,EVENT_START,i),new Event(a,b,EVENT_END,i))}events.sort(compareEvent);for(var minX=events[0].a[0]-(1+Math.abs(events[0].a[0]))*Math.pow(2,-52),hull=[new PartialHull([minX,1],[minX,0],-1,[],[],[],[])],cells=[],i=0,numEvents=events.length;i<numEvents;++i){var event=events[i],type=event.type;type===EVENT_POINT?addPoint(cells,hull,points,event.a,event.idx):type===EVENT_START?splitHulls(hull,points,event):mergeHulls(hull,points,event)}return cells};function PartialHull(a,b,idx,lowerIds,upperIds){this.a=a,this.b=b,this.idx=idx,this.lowerIds=lowerIds,this.upperIds=upperIds}function Event(a,b,type,idx){this.a=a,this.b=b,this.type=type,this.idx=idx}function compareEvent(a,b){var d=a.a[0]-b.a[0]||a.a[1]-b.a[1]||a.type-b.type;return d||(a.type!==EVENT_POINT&&(d=orient(a.a,a.b,b.b))?d:a.idx-b.idx)}function testPoint(hull,p){return orient(hull.a,hull.b,p)}function addPoint(cells,hulls,points,p,idx){for(var lo=_$searchBounds_90.lt(hulls,p,testPoint),hi=_$searchBounds_90.gt(hulls,p,testPoint),i=lo;i<hi;++i){for(var hull=hulls[i],lowerIds=hull.lowerIds,m=lowerIds.length;m>1&&orient(points[lowerIds[m-2]],points[lowerIds[m-1]],p)>0;)cells.push([lowerIds[m-1],lowerIds[m-2],idx]),m-=1;lowerIds.length=m,lowerIds.push(idx);var upperIds=hull.upperIds;for(m=upperIds.length;m>1&&orient(points[upperIds[m-2]],points[upperIds[m-1]],p)<0;)cells.push([upperIds[m-2],upperIds[m-1],idx]),m-=1;upperIds.length=m,upperIds.push(idx)}}function findSplit(hull,edge){var d;return(d=hull.a[0]<edge.a[0]?orient(hull.a,hull.b,edge.a):orient(edge.b,edge.a,hull.a))?d:(d=edge.b[0]<hull.b[0]?orient(hull.a,hull.b,edge.b):orient(edge.b,edge.a,hull.b))||hull.idx-edge.idx}function splitHulls(hulls,points,event){var splitIdx=_$searchBounds_90.le(hulls,event,findSplit),hull=hulls[splitIdx],upperIds=hull.upperIds,x=upperIds[upperIds.length-1];hull.upperIds=[x],hulls.splice(splitIdx+1,0,new PartialHull(event.a,event.b,event.idx,[x],upperIds))}function mergeHulls(hulls,points,event){var tmp=event.a;event.a=event.b,event.b=tmp;var mergeIdx=_$searchBounds_90.eq(hulls,event,findSplit),upper=hulls[mergeIdx];hulls[mergeIdx-1].upperIds=upper.upperIds,hulls.splice(mergeIdx,1)}var _$createTriangulation_89=function createTriangulation(numVerts,edges){for(var stars=new Array(numVerts),i=0;i<numVerts;++i)stars[i]=[];return new Triangulation(stars,edges)};function Triangulation(stars,edges){this.stars=stars,this.edges=edges}var __proto_89=Triangulation.prototype;function removePair(list,j,k){for(var i=1,n=list.length;i<n;i+=2)if(list[i-1]===j&&list[i]===k)return list[i-1]=list[n-2],list[i]=list[n-1],void(list.length=n-2)}__proto_89.isConstraint=function(){var e=[0,0];function compareLex(a,b){return a[0]-b[0]||a[1]-b[1]}return function(i,j){return e[0]=Math.min(i,j),e[1]=Math.max(i,j),_$searchBounds_90.eq(this.edges,e,compareLex)>=0}}(),__proto_89.removeTriangle=function(i,j,k){var stars=this.stars;removePair(stars[i],j,k),removePair(stars[j],k,i),removePair(stars[k],i,j)},__proto_89.addTriangle=function(i,j,k){var stars=this.stars;stars[i].push(j,k),stars[j].push(k,i),stars[k].push(i,j)},__proto_89.opposite=function(j,i){for(var list=this.stars[i],k=1,n=list.length;k<n;k+=2)if(list[k]===j)return list[k-1];return-1},__proto_89.flip=function(i,j){var a=this.opposite(i,j),b=this.opposite(j,i);this.removeTriangle(i,j,a),this.removeTriangle(j,i,b),this.addTriangle(i,b,a),this.addTriangle(j,a,b)},__proto_89.edges=function(){for(var stars=this.stars,result=[],i=0,n=stars.length;i<n;++i)for(var list=stars[i],j=0,m=list.length;j<m;j+=2)result.push([list[j],list[j+1]]);return result},__proto_89.cells=function(){for(var stars=this.stars,result=[],i=0,n=stars.length;i<n;++i)for(var list=stars[i],j=0,m=list.length;j<m;j+=2){var s=list[j],t=list[j+1];i<Math.min(s,t)&&result.push([i,s,t])}return result};var _$cdt2d_85=function cdt2d(points,edges,options){Array.isArray(edges)?(options=options||{},edges=edges||[]):(options=edges||{},edges=[]);var delaunay=!!getDefault(options,"delaunay",!0),interior=!!getDefault(options,"interior",!0),exterior=!!getDefault(options,"exterior",!0),infinity=!!getDefault(options,"infinity",!1);if(!interior&&!exterior||0===points.length)return[];var cells=_$monotoneTriangulate_88(points,edges);if(delaunay||interior!==exterior||infinity){for(var triangulation=_$createTriangulation_89(points.length,function canonicalizeEdges(edges){return edges.map(canonicalizeEdge).sort(compareEdge)}(edges)),i=0;i<cells.length;++i){var f=cells[i];triangulation.addTriangle(f[0],f[1],f[2])}return delaunay&&_$delaunayRefine_86(points,triangulation),exterior?interior?infinity?_$classifyFaces_87(triangulation,0,infinity):triangulation.cells():_$classifyFaces_87(triangulation,1,infinity):_$classifyFaces_87(triangulation,-1)}return cells};function canonicalizeEdge(e){return[Math.min(e[0],e[1]),Math.max(e[0],e[1])]}function compareEdge(a,b){return a[0]-b[0]||a[1]-b[1]}function getDefault(options,property,dflt){return property in options?options[property]:dflt}var _$cmp_56=function cmp(a,b){return a[0].mul(b[1]).cmp(b[0].mul(a[1]))};var _$empty_83={},_$bn_74={exports:{}};!function(module,exports){"use strict";function assert(val,msg){if(!val)throw new Error(msg||"Assertion failed")}function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}function BN(number,base,endian){if(BN.isBN(number))return number;this.negative=0,this.words=null,this.length=0,this.red=null,null!==number&&("le"!==base&&"be"!==base||(endian=base,base=10),this._init(number||0,base||10,endian||"be"))}var Buffer;"object"==typeof module?module.exports=BN:exports.BN=BN,BN.BN=BN,BN.wordSize=26;try{Buffer=_$empty_83.Buffer}catch(e){}function parseHex(str,start,end){for(var r=0,len=Math.min(str.length,end),i=start;i<len;i++){var c=str.charCodeAt(i)-48;r<<=4,r|=c>=49&&c<=54?c-49+10:c>=17&&c<=22?c-17+10:15&c}return r}function parseBase(str,start,end,mul){for(var r=0,len=Math.min(str.length,end),i=start;i<len;i++){var c=str.charCodeAt(i)-48;r*=mul,r+=c>=49?c-49+10:c>=17?c-17+10:c}return r}BN.isBN=function isBN(num){return num instanceof BN||null!==num&&"object"==typeof num&&num.constructor.wordSize===BN.wordSize&&Array.isArray(num.words)},BN.max=function max(left,right){return left.cmp(right)>0?left:right},BN.min=function min(left,right){return left.cmp(right)<0?left:right},BN.prototype._init=function init(number,base,endian){if("number"==typeof number)return this._initNumber(number,base,endian);if("object"==typeof number)return this._initArray(number,base,endian);"hex"===base&&(base=16),assert(base===(0|base)&&base>=2&&base<=36);var start=0;"-"===(number=number.toString().replace(/\s+/g,""))[0]&&start++,16===base?this._parseHex(number,start):this._parseBase(number,base,start),"-"===number[0]&&(this.negative=1),this.strip(),"le"===endian&&this._initArray(this.toArray(),base,endian)},BN.prototype._initNumber=function _initNumber(number,base,endian){number<0&&(this.negative=1,number=-number),number<67108864?(this.words=[67108863&number],this.length=1):number<4503599627370496?(this.words=[67108863&number,number/67108864&67108863],this.length=2):(assert(number<9007199254740992),this.words=[67108863&number,number/67108864&67108863,1],this.length=3),"le"===endian&&this._initArray(this.toArray(),base,endian)},BN.prototype._initArray=function _initArray(number,base,endian){if(assert("number"==typeof number.length),number.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(number.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var j,w,off=0;if("be"===endian)for(i=number.length-1,j=0;i>=0;i-=3)w=number[i]|number[i-1]<<8|number[i-2]<<16,this.words[j]|=w<<off&67108863,this.words[j+1]=w>>>26-off&67108863,(off+=24)>=26&&(off-=26,j++);else if("le"===endian)for(i=0,j=0;i<number.length;i+=3)w=number[i]|number[i+1]<<8|number[i+2]<<16,this.words[j]|=w<<off&67108863,this.words[j+1]=w>>>26-off&67108863,(off+=24)>=26&&(off-=26,j++);return this.strip()},BN.prototype._parseHex=function _parseHex(number,start){this.length=Math.ceil((number.length-start)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var j,w,off=0;for(i=number.length-6,j=0;i>=start;i-=6)w=parseHex(number,i,i+6),this.words[j]|=w<<off&67108863,this.words[j+1]|=w>>>26-off&4194303,(off+=24)>=26&&(off-=26,j++);i+6!==start&&(w=parseHex(number,start,i+6),this.words[j]|=w<<off&67108863,this.words[j+1]|=w>>>26-off&4194303),this.strip()},BN.prototype._parseBase=function _parseBase(number,base,start){this.words=[0],this.length=1;for(var limbLen=0,limbPow=1;limbPow<=67108863;limbPow*=base)limbLen++;limbLen--,limbPow=limbPow/base|0;for(var total=number.length-start,mod=total%limbLen,end=Math.min(total,total-mod)+start,word=0,i=start;i<end;i+=limbLen)word=parseBase(number,i,i+limbLen,base),this.imuln(limbPow),this.words[0]+word<67108864?this.words[0]+=word:this._iaddn(word);if(0!==mod){var pow=1;for(word=parseBase(number,i,number.length,base),i=0;i<mod;i++)pow*=base;this.imuln(pow),this.words[0]+word<67108864?this.words[0]+=word:this._iaddn(word)}},BN.prototype.copy=function copy(dest){dest.words=new Array(this.length);for(var i=0;i<this.length;i++)dest.words[i]=this.words[i];dest.length=this.length,dest.negative=this.negative,dest.red=this.red},BN.prototype.clone=function clone(){var r=new BN(null);return this.copy(r),r},BN.prototype._expand=function _expand(size){for(;this.length<size;)this.words[this.length++]=0;return this},BN.prototype.strip=function strip(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},BN.prototype._normSign=function _normSign(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},BN.prototype.inspect=function inspect(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var zeros=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],groupSizes=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],groupBases=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function smallMulTo(self,num,out){out.negative=num.negative^self.negative;var len=self.length+num.length|0;out.length=len,len=len-1|0;var a=0|self.words[0],b=0|num.words[0],r=a*b,lo=67108863&r,carry=r/67108864|0;out.words[0]=lo;for(var k=1;k<len;k++){for(var ncarry=carry>>>26,rword=67108863&carry,maxJ=Math.min(k,num.length-1),j=Math.max(0,k-self.length+1);j<=maxJ;j++){var i=k-j|0;ncarry+=(r=(a=0|self.words[i])*(b=0|num.words[j])+rword)/67108864|0,rword=67108863&r}out.words[k]=0|rword,carry=0|ncarry}return 0!==carry?out.words[k]=0|carry:out.length--,out.strip()}BN.prototype.toString=function toString(base,padding){var out;if(base=base||10,padding=0|padding||1,16===base||"hex"===base){out="";for(var off=0,carry=0,i=0;i<this.length;i++){var w=this.words[i],word=(16777215&(w<<off|carry)).toString(16);out=0!==(carry=w>>>24-off&16777215)||i!==this.length-1?zeros[6-word.length]+word+out:word+out,(off+=2)>=26&&(off-=26,i--)}for(0!==carry&&(out=carry.toString(16)+out);out.length%padding!=0;)out="0"+out;return 0!==this.negative&&(out="-"+out),out}if(base===(0|base)&&base>=2&&base<=36){var groupSize=groupSizes[base],groupBase=groupBases[base];out="";var c=this.clone();for(c.negative=0;!c.isZero();){var r=c.modn(groupBase).toString(base);out=(c=c.idivn(groupBase)).isZero()?r+out:zeros[groupSize-r.length]+r+out}for(this.isZero()&&(out="0"+out);out.length%padding!=0;)out="0"+out;return 0!==this.negative&&(out="-"+out),out}assert(!1,"Base should be between 2 and 36")},BN.prototype.toNumber=function toNumber(){var ret=this.words[0];return 2===this.length?ret+=67108864*this.words[1]:3===this.length&&1===this.words[2]?ret+=4503599627370496+67108864*this.words[1]:this.length>2&&assert(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-ret:ret},BN.prototype.toJSON=function toJSON(){return this.toString(16)},BN.prototype.toBuffer=function toBuffer(endian,length){return assert(void 0!==Buffer),this.toArrayLike(Buffer,endian,length)},BN.prototype.toArray=function toArray(endian,length){return this.toArrayLike(Array,endian,length)},BN.prototype.toArrayLike=function toArrayLike(ArrayType,endian,length){var byteLength=this.byteLength(),reqLength=length||Math.max(1,byteLength);assert(byteLength<=reqLength,"byte array longer than desired length"),assert(reqLength>0,"Requested array length <= 0"),this.strip();var b,i,littleEndian="le"===endian,res=new ArrayType(reqLength),q=this.clone();if(littleEndian){for(i=0;!q.isZero();i++)b=q.andln(255),q.iushrn(8),res[i]=b;for(;i<reqLength;i++)res[i]=0}else{for(i=0;i<reqLength-byteLength;i++)res[i]=0;for(i=0;!q.isZero();i++)b=q.andln(255),q.iushrn(8),res[reqLength-i-1]=b}return res},Math.clz32?BN.prototype._countBits=function _countBits(w){return 32-Math.clz32(w)}:BN.prototype._countBits=function _countBits(w){var t=w,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},BN.prototype._zeroBits=function _zeroBits(w){if(0===w)return 26;var t=w,r=0;return 0==(8191&t)&&(r+=13,t>>>=13),0==(127&t)&&(r+=7,t>>>=7),0==(15&t)&&(r+=4,t>>>=4),0==(3&t)&&(r+=2,t>>>=2),0==(1&t)&&r++,r},BN.prototype.bitLength=function bitLength(){var w=this.words[this.length-1],hi=this._countBits(w);return 26*(this.length-1)+hi},BN.prototype.zeroBits=function zeroBits(){if(this.isZero())return 0;for(var r=0,i=0;i<this.length;i++){var b=this._zeroBits(this.words[i]);if(r+=b,26!==b)break}return r},BN.prototype.byteLength=function byteLength(){return Math.ceil(this.bitLength()/8)},BN.prototype.toTwos=function toTwos(width){return 0!==this.negative?this.abs().inotn(width).iaddn(1):this.clone()},BN.prototype.fromTwos=function fromTwos(width){return this.testn(width-1)?this.notn(width).iaddn(1).ineg():this.clone()},BN.prototype.isNeg=function isNeg(){return 0!==this.negative},BN.prototype.neg=function neg(){return this.clone().ineg()},BN.prototype.ineg=function ineg(){return this.isZero()||(this.negative^=1),this},BN.prototype.iuor=function iuor(num){for(;this.length<num.length;)this.words[this.length++]=0;for(var i=0;i<num.length;i++)this.words[i]=this.words[i]|num.words[i];return this.strip()},BN.prototype.ior=function ior(num){return assert(0==(this.negative|num.negative)),this.iuor(num)},BN.prototype.or=function or(num){return this.length>num.length?this.clone().ior(num):num.clone().ior(this)},BN.prototype.uor=function uor(num){return this.length>num.length?this.clone().iuor(num):num.clone().iuor(this)},BN.prototype.iuand=function iuand(num){var b;b=this.length>num.length?num:this;for(var i=0;i<b.length;i++)this.words[i]=this.words[i]&num.words[i];return this.length=b.length,this.strip()},BN.prototype.iand=function iand(num){return assert(0==(this.negative|num.negative)),this.iuand(num)},BN.prototype.and=function and(num){return this.length>num.length?this.clone().iand(num):num.clone().iand(this)},BN.prototype.uand=function uand(num){return this.length>num.length?this.clone().iuand(num):num.clone().iuand(this)},BN.prototype.iuxor=function iuxor(num){var a,b;this.length>num.length?(a=this,b=num):(a=num,b=this);for(var i=0;i<b.length;i++)this.words[i]=a.words[i]^b.words[i];if(this!==a)for(;i<a.length;i++)this.words[i]=a.words[i];return this.length=a.length,this.strip()},BN.prototype.ixor=function ixor(num){return assert(0==(this.negative|num.negative)),this.iuxor(num)},BN.prototype.xor=function xor(num){return this.length>num.length?this.clone().ixor(num):num.clone().ixor(this)},BN.prototype.uxor=function uxor(num){return this.length>num.length?this.clone().iuxor(num):num.clone().iuxor(this)},BN.prototype.inotn=function inotn(width){assert("number"==typeof width&&width>=0);var bytesNeeded=0|Math.ceil(width/26),bitsLeft=width%26;this._expand(bytesNeeded),bitsLeft>0&&bytesNeeded--;for(var i=0;i<bytesNeeded;i++)this.words[i]=67108863&~this.words[i];return bitsLeft>0&&(this.words[i]=~this.words[i]&67108863>>26-bitsLeft),this.strip()},BN.prototype.notn=function notn(width){return this.clone().inotn(width)},BN.prototype.setn=function setn(bit,val){assert("number"==typeof bit&&bit>=0);var off=bit/26|0,wbit=bit%26;return this._expand(off+1),this.words[off]=val?this.words[off]|1<<wbit:this.words[off]&~(1<<wbit),this.strip()},BN.prototype.iadd=function iadd(num){var r,a,b;if(0!==this.negative&&0===num.negative)return this.negative=0,r=this.isub(num),this.negative^=1,this._normSign();if(0===this.negative&&0!==num.negative)return num.negative=0,r=this.isub(num),num.negative=1,r._normSign();this.length>num.length?(a=this,b=num):(a=num,b=this);for(var carry=0,i=0;i<b.length;i++)r=(0|a.words[i])+(0|b.words[i])+carry,this.words[i]=67108863&r,carry=r>>>26;for(;0!==carry&&i<a.length;i++)r=(0|a.words[i])+carry,this.words[i]=67108863&r,carry=r>>>26;if(this.length=a.length,0!==carry)this.words[this.length]=carry,this.length++;else if(a!==this)for(;i<a.length;i++)this.words[i]=a.words[i];return this},BN.prototype.add=function add(num){var res;return 0!==num.negative&&0===this.negative?(num.negative=0,res=this.sub(num),num.negative^=1,res):0===num.negative&&0!==this.negative?(this.negative=0,res=num.sub(this),this.negative=1,res):this.length>num.length?this.clone().iadd(num):num.clone().iadd(this)},BN.prototype.isub=function isub(num){if(0!==num.negative){num.negative=0;var r=this.iadd(num);return num.negative=1,r._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(num),this.negative=1,this._normSign();var a,b,cmp=this.cmp(num);if(0===cmp)return this.negative=0,this.length=1,this.words[0]=0,this;cmp>0?(a=this,b=num):(a=num,b=this);for(var carry=0,i=0;i<b.length;i++)carry=(r=(0|a.words[i])-(0|b.words[i])+carry)>>26,this.words[i]=67108863&r;for(;0!==carry&&i<a.length;i++)carry=(r=(0|a.words[i])+carry)>>26,this.words[i]=67108863&r;if(0===carry&&i<a.length&&a!==this)for(;i<a.length;i++)this.words[i]=a.words[i];return this.length=Math.max(this.length,i),a!==this&&(this.negative=1),this.strip()},BN.prototype.sub=function sub(num){return this.clone().isub(num)};var comb10MulTo=function comb10MulTo(self,num,out){var lo,mid,hi,a=self.words,b=num.words,o=out.words,c=0,a0=0|a[0],al0=8191&a0,ah0=a0>>>13,a1=0|a[1],al1=8191&a1,ah1=a1>>>13,a2=0|a[2],al2=8191&a2,ah2=a2>>>13,a3=0|a[3],al3=8191&a3,ah3=a3>>>13,a4=0|a[4],al4=8191&a4,ah4=a4>>>13,a5=0|a[5],al5=8191&a5,ah5=a5>>>13,a6=0|a[6],al6=8191&a6,ah6=a6>>>13,a7=0|a[7],al7=8191&a7,ah7=a7>>>13,a8=0|a[8],al8=8191&a8,ah8=a8>>>13,a9=0|a[9],al9=8191&a9,ah9=a9>>>13,b0=0|b[0],bl0=8191&b0,bh0=b0>>>13,b1=0|b[1],bl1=8191&b1,bh1=b1>>>13,b2=0|b[2],bl2=8191&b2,bh2=b2>>>13,b3=0|b[3],bl3=8191&b3,bh3=b3>>>13,b4=0|b[4],bl4=8191&b4,bh4=b4>>>13,b5=0|b[5],bl5=8191&b5,bh5=b5>>>13,b6=0|b[6],bl6=8191&b6,bh6=b6>>>13,b7=0|b[7],bl7=8191&b7,bh7=b7>>>13,b8=0|b[8],bl8=8191&b8,bh8=b8>>>13,b9=0|b[9],bl9=8191&b9,bh9=b9>>>13;out.negative=self.negative^num.negative,out.length=19;var w0=(c+(lo=Math.imul(al0,bl0))|0)+((8191&(mid=(mid=Math.imul(al0,bh0))+Math.imul(ah0,bl0)|0))<<13)|0;c=((hi=Math.imul(ah0,bh0))+(mid>>>13)|0)+(w0>>>26)|0,w0&=67108863,lo=Math.imul(al1,bl0),mid=(mid=Math.imul(al1,bh0))+Math.imul(ah1,bl0)|0,hi=Math.imul(ah1,bh0);var w1=(c+(lo=lo+Math.imul(al0,bl1)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al0,bh1)|0)+Math.imul(ah0,bl1)|0))<<13)|0;c=((hi=hi+Math.imul(ah0,bh1)|0)+(mid>>>13)|0)+(w1>>>26)|0,w1&=67108863,lo=Math.imul(al2,bl0),mid=(mid=Math.imul(al2,bh0))+Math.imul(ah2,bl0)|0,hi=Math.imul(ah2,bh0),lo=lo+Math.imul(al1,bl1)|0,mid=(mid=mid+Math.imul(al1,bh1)|0)+Math.imul(ah1,bl1)|0,hi=hi+Math.imul(ah1,bh1)|0;var w2=(c+(lo=lo+Math.imul(al0,bl2)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al0,bh2)|0)+Math.imul(ah0,bl2)|0))<<13)|0;c=((hi=hi+Math.imul(ah0,bh2)|0)+(mid>>>13)|0)+(w2>>>26)|0,w2&=67108863,lo=Math.imul(al3,bl0),mid=(mid=Math.imul(al3,bh0))+Math.imul(ah3,bl0)|0,hi=Math.imul(ah3,bh0),lo=lo+Math.imul(al2,bl1)|0,mid=(mid=mid+Math.imul(al2,bh1)|0)+Math.imul(ah2,bl1)|0,hi=hi+Math.imul(ah2,bh1)|0,lo=lo+Math.imul(al1,bl2)|0,mid=(mid=mid+Math.imul(al1,bh2)|0)+Math.imul(ah1,bl2)|0,hi=hi+Math.imul(ah1,bh2)|0;var w3=(c+(lo=lo+Math.imul(al0,bl3)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al0,bh3)|0)+Math.imul(ah0,bl3)|0))<<13)|0;c=((hi=hi+Math.imul(ah0,bh3)|0)+(mid>>>13)|0)+(w3>>>26)|0,w3&=67108863,lo=Math.imul(al4,bl0),mid=(mid=Math.imul(al4,bh0))+Math.imul(ah4,bl0)|0,hi=Math.imul(ah4,bh0),lo=lo+Math.imul(al3,bl1)|0,mid=(mid=mid+Math.imul(al3,bh1)|0)+Math.imul(ah3,bl1)|0,hi=hi+Math.imul(ah3,bh1)|0,lo=lo+Math.imul(al2,bl2)|0,mid=(mid=mid+Math.imul(al2,bh2)|0)+Math.imul(ah2,bl2)|0,hi=hi+Math.imul(ah2,bh2)|0,lo=lo+Math.imul(al1,bl3)|0,mid=(mid=mid+Math.imul(al1,bh3)|0)+Math.imul(ah1,bl3)|0,hi=hi+Math.imul(ah1,bh3)|0;var w4=(c+(lo=lo+Math.imul(al0,bl4)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al0,bh4)|0)+Math.imul(ah0,bl4)|0))<<13)|0;c=((hi=hi+Math.imul(ah0,bh4)|0)+(mid>>>13)|0)+(w4>>>26)|0,w4&=67108863,lo=Math.imul(al5,bl0),mid=(mid=Math.imul(al5,bh0))+Math.imul(ah5,bl0)|0,hi=Math.imul(ah5,bh0),lo=lo+Math.imul(al4,bl1)|0,mid=(mid=mid+Math.imul(al4,bh1)|0)+Math.imul(ah4,bl1)|0,hi=hi+Math.imul(ah4,bh1)|0,lo=lo+Math.imul(al3,bl2)|0,mid=(mid=mid+Math.imul(al3,bh2)|0)+Math.imul(ah3,bl2)|0,hi=hi+Math.imul(ah3,bh2)|0,lo=lo+Math.imul(al2,bl3)|0,mid=(mid=mid+Math.imul(al2,bh3)|0)+Math.imul(ah2,bl3)|0,hi=hi+Math.imul(ah2,bh3)|0,lo=lo+Math.imul(al1,bl4)|0,mid=(mid=mid+Math.imul(al1,bh4)|0)+Math.imul(ah1,bl4)|0,hi=hi+Math.imul(ah1,bh4)|0;var w5=(c+(lo=lo+Math.imul(al0,bl5)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al0,bh5)|0)+Math.imul(ah0,bl5)|0))<<13)|0;c=((hi=hi+Math.imul(ah0,bh5)|0)+(mid>>>13)|0)+(w5>>>26)|0,w5&=67108863,lo=Math.imul(al6,bl0),mid=(mid=Math.imul(al6,bh0))+Math.imul(ah6,bl0)|0,hi=Math.imul(ah6,bh0),lo=lo+Math.imul(al5,bl1)|0,mid=(mid=mid+Math.imul(al5,bh1)|0)+Math.imul(ah5,bl1)|0,hi=hi+Math.imul(ah5,bh1)|0,lo=lo+Math.imul(al4,bl2)|0,mid=(mid=mid+Math.imul(al4,bh2)|0)+Math.imul(ah4,bl2)|0,hi=hi+Math.imul(ah4,bh2)|0,lo=lo+Math.imul(al3,bl3)|0,mid=(mid=mid+Math.imul(al3,bh3)|0)+Math.imul(ah3,bl3)|0,hi=hi+Math.imul(ah3,bh3)|0,lo=lo+Math.imul(al2,bl4)|0,mid=(mid=mid+Math.imul(al2,bh4)|0)+Math.imul(ah2,bl4)|0,hi=hi+Math.imul(ah2,bh4)|0,lo=lo+Math.imul(al1,bl5)|0,mid=(mid=mid+Math.imul(al1,bh5)|0)+Math.imul(ah1,bl5)|0,hi=hi+Math.imul(ah1,bh5)|0;var w6=(c+(lo=lo+Math.imul(al0,bl6)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al0,bh6)|0)+Math.imul(ah0,bl6)|0))<<13)|0;c=((hi=hi+Math.imul(ah0,bh6)|0)+(mid>>>13)|0)+(w6>>>26)|0,w6&=67108863,lo=Math.imul(al7,bl0),mid=(mid=Math.imul(al7,bh0))+Math.imul(ah7,bl0)|0,hi=Math.imul(ah7,bh0),lo=lo+Math.imul(al6,bl1)|0,mid=(mid=mid+Math.imul(al6,bh1)|0)+Math.imul(ah6,bl1)|0,hi=hi+Math.imul(ah6,bh1)|0,lo=lo+Math.imul(al5,bl2)|0,mid=(mid=mid+Math.imul(al5,bh2)|0)+Math.imul(ah5,bl2)|0,hi=hi+Math.imul(ah5,bh2)|0,lo=lo+Math.imul(al4,bl3)|0,mid=(mid=mid+Math.imul(al4,bh3)|0)+Math.imul(ah4,bl3)|0,hi=hi+Math.imul(ah4,bh3)|0,lo=lo+Math.imul(al3,bl4)|0,mid=(mid=mid+Math.imul(al3,bh4)|0)+Math.imul(ah3,bl4)|0,hi=hi+Math.imul(ah3,bh4)|0,lo=lo+Math.imul(al2,bl5)|0,mid=(mid=mid+Math.imul(al2,bh5)|0)+Math.imul(ah2,bl5)|0,hi=hi+Math.imul(ah2,bh5)|0,lo=lo+Math.imul(al1,bl6)|0,mid=(mid=mid+Math.imul(al1,bh6)|0)+Math.imul(ah1,bl6)|0,hi=hi+Math.imul(ah1,bh6)|0;var w7=(c+(lo=lo+Math.imul(al0,bl7)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al0,bh7)|0)+Math.imul(ah0,bl7)|0))<<13)|0;c=((hi=hi+Math.imul(ah0,bh7)|0)+(mid>>>13)|0)+(w7>>>26)|0,w7&=67108863,lo=Math.imul(al8,bl0),mid=(mid=Math.imul(al8,bh0))+Math.imul(ah8,bl0)|0,hi=Math.imul(ah8,bh0),lo=lo+Math.imul(al7,bl1)|0,mid=(mid=mid+Math.imul(al7,bh1)|0)+Math.imul(ah7,bl1)|0,hi=hi+Math.imul(ah7,bh1)|0,lo=lo+Math.imul(al6,bl2)|0,mid=(mid=mid+Math.imul(al6,bh2)|0)+Math.imul(ah6,bl2)|0,hi=hi+Math.imul(ah6,bh2)|0,lo=lo+Math.imul(al5,bl3)|0,mid=(mid=mid+Math.imul(al5,bh3)|0)+Math.imul(ah5,bl3)|0,hi=hi+Math.imul(ah5,bh3)|0,lo=lo+Math.imul(al4,bl4)|0,mid=(mid=mid+Math.imul(al4,bh4)|0)+Math.imul(ah4,bl4)|0,hi=hi+Math.imul(ah4,bh4)|0,lo=lo+Math.imul(al3,bl5)|0,mid=(mid=mid+Math.imul(al3,bh5)|0)+Math.imul(ah3,bl5)|0,hi=hi+Math.imul(ah3,bh5)|0,lo=lo+Math.imul(al2,bl6)|0,mid=(mid=mid+Math.imul(al2,bh6)|0)+Math.imul(ah2,bl6)|0,hi=hi+Math.imul(ah2,bh6)|0,lo=lo+Math.imul(al1,bl7)|0,mid=(mid=mid+Math.imul(al1,bh7)|0)+Math.imul(ah1,bl7)|0,hi=hi+Math.imul(ah1,bh7)|0;var w8=(c+(lo=lo+Math.imul(al0,bl8)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al0,bh8)|0)+Math.imul(ah0,bl8)|0))<<13)|0;c=((hi=hi+Math.imul(ah0,bh8)|0)+(mid>>>13)|0)+(w8>>>26)|0,w8&=67108863,lo=Math.imul(al9,bl0),mid=(mid=Math.imul(al9,bh0))+Math.imul(ah9,bl0)|0,hi=Math.imul(ah9,bh0),lo=lo+Math.imul(al8,bl1)|0,mid=(mid=mid+Math.imul(al8,bh1)|0)+Math.imul(ah8,bl1)|0,hi=hi+Math.imul(ah8,bh1)|0,lo=lo+Math.imul(al7,bl2)|0,mid=(mid=mid+Math.imul(al7,bh2)|0)+Math.imul(ah7,bl2)|0,hi=hi+Math.imul(ah7,bh2)|0,lo=lo+Math.imul(al6,bl3)|0,mid=(mid=mid+Math.imul(al6,bh3)|0)+Math.imul(ah6,bl3)|0,hi=hi+Math.imul(ah6,bh3)|0,lo=lo+Math.imul(al5,bl4)|0,mid=(mid=mid+Math.imul(al5,bh4)|0)+Math.imul(ah5,bl4)|0,hi=hi+Math.imul(ah5,bh4)|0,lo=lo+Math.imul(al4,bl5)|0,mid=(mid=mid+Math.imul(al4,bh5)|0)+Math.imul(ah4,bl5)|0,hi=hi+Math.imul(ah4,bh5)|0,lo=lo+Math.imul(al3,bl6)|0,mid=(mid=mid+Math.imul(al3,bh6)|0)+Math.imul(ah3,bl6)|0,hi=hi+Math.imul(ah3,bh6)|0,lo=lo+Math.imul(al2,bl7)|0,mid=(mid=mid+Math.imul(al2,bh7)|0)+Math.imul(ah2,bl7)|0,hi=hi+Math.imul(ah2,bh7)|0,lo=lo+Math.imul(al1,bl8)|0,mid=(mid=mid+Math.imul(al1,bh8)|0)+Math.imul(ah1,bl8)|0,hi=hi+Math.imul(ah1,bh8)|0;var w9=(c+(lo=lo+Math.imul(al0,bl9)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al0,bh9)|0)+Math.imul(ah0,bl9)|0))<<13)|0;c=((hi=hi+Math.imul(ah0,bh9)|0)+(mid>>>13)|0)+(w9>>>26)|0,w9&=67108863,lo=Math.imul(al9,bl1),mid=(mid=Math.imul(al9,bh1))+Math.imul(ah9,bl1)|0,hi=Math.imul(ah9,bh1),lo=lo+Math.imul(al8,bl2)|0,mid=(mid=mid+Math.imul(al8,bh2)|0)+Math.imul(ah8,bl2)|0,hi=hi+Math.imul(ah8,bh2)|0,lo=lo+Math.imul(al7,bl3)|0,mid=(mid=mid+Math.imul(al7,bh3)|0)+Math.imul(ah7,bl3)|0,hi=hi+Math.imul(ah7,bh3)|0,lo=lo+Math.imul(al6,bl4)|0,mid=(mid=mid+Math.imul(al6,bh4)|0)+Math.imul(ah6,bl4)|0,hi=hi+Math.imul(ah6,bh4)|0,lo=lo+Math.imul(al5,bl5)|0,mid=(mid=mid+Math.imul(al5,bh5)|0)+Math.imul(ah5,bl5)|0,hi=hi+Math.imul(ah5,bh5)|0,lo=lo+Math.imul(al4,bl6)|0,mid=(mid=mid+Math.imul(al4,bh6)|0)+Math.imul(ah4,bl6)|0,hi=hi+Math.imul(ah4,bh6)|0,lo=lo+Math.imul(al3,bl7)|0,mid=(mid=mid+Math.imul(al3,bh7)|0)+Math.imul(ah3,bl7)|0,hi=hi+Math.imul(ah3,bh7)|0,lo=lo+Math.imul(al2,bl8)|0,mid=(mid=mid+Math.imul(al2,bh8)|0)+Math.imul(ah2,bl8)|0,hi=hi+Math.imul(ah2,bh8)|0;var w10=(c+(lo=lo+Math.imul(al1,bl9)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al1,bh9)|0)+Math.imul(ah1,bl9)|0))<<13)|0;c=((hi=hi+Math.imul(ah1,bh9)|0)+(mid>>>13)|0)+(w10>>>26)|0,w10&=67108863,lo=Math.imul(al9,bl2),mid=(mid=Math.imul(al9,bh2))+Math.imul(ah9,bl2)|0,hi=Math.imul(ah9,bh2),lo=lo+Math.imul(al8,bl3)|0,mid=(mid=mid+Math.imul(al8,bh3)|0)+Math.imul(ah8,bl3)|0,hi=hi+Math.imul(ah8,bh3)|0,lo=lo+Math.imul(al7,bl4)|0,mid=(mid=mid+Math.imul(al7,bh4)|0)+Math.imul(ah7,bl4)|0,hi=hi+Math.imul(ah7,bh4)|0,lo=lo+Math.imul(al6,bl5)|0,mid=(mid=mid+Math.imul(al6,bh5)|0)+Math.imul(ah6,bl5)|0,hi=hi+Math.imul(ah6,bh5)|0,lo=lo+Math.imul(al5,bl6)|0,mid=(mid=mid+Math.imul(al5,bh6)|0)+Math.imul(ah5,bl6)|0,hi=hi+Math.imul(ah5,bh6)|0,lo=lo+Math.imul(al4,bl7)|0,mid=(mid=mid+Math.imul(al4,bh7)|0)+Math.imul(ah4,bl7)|0,hi=hi+Math.imul(ah4,bh7)|0,lo=lo+Math.imul(al3,bl8)|0,mid=(mid=mid+Math.imul(al3,bh8)|0)+Math.imul(ah3,bl8)|0,hi=hi+Math.imul(ah3,bh8)|0;var w11=(c+(lo=lo+Math.imul(al2,bl9)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al2,bh9)|0)+Math.imul(ah2,bl9)|0))<<13)|0;c=((hi=hi+Math.imul(ah2,bh9)|0)+(mid>>>13)|0)+(w11>>>26)|0,w11&=67108863,lo=Math.imul(al9,bl3),mid=(mid=Math.imul(al9,bh3))+Math.imul(ah9,bl3)|0,hi=Math.imul(ah9,bh3),lo=lo+Math.imul(al8,bl4)|0,mid=(mid=mid+Math.imul(al8,bh4)|0)+Math.imul(ah8,bl4)|0,hi=hi+Math.imul(ah8,bh4)|0,lo=lo+Math.imul(al7,bl5)|0,mid=(mid=mid+Math.imul(al7,bh5)|0)+Math.imul(ah7,bl5)|0,hi=hi+Math.imul(ah7,bh5)|0,lo=lo+Math.imul(al6,bl6)|0,mid=(mid=mid+Math.imul(al6,bh6)|0)+Math.imul(ah6,bl6)|0,hi=hi+Math.imul(ah6,bh6)|0,lo=lo+Math.imul(al5,bl7)|0,mid=(mid=mid+Math.imul(al5,bh7)|0)+Math.imul(ah5,bl7)|0,hi=hi+Math.imul(ah5,bh7)|0,lo=lo+Math.imul(al4,bl8)|0,mid=(mid=mid+Math.imul(al4,bh8)|0)+Math.imul(ah4,bl8)|0,hi=hi+Math.imul(ah4,bh8)|0;var w12=(c+(lo=lo+Math.imul(al3,bl9)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al3,bh9)|0)+Math.imul(ah3,bl9)|0))<<13)|0;c=((hi=hi+Math.imul(ah3,bh9)|0)+(mid>>>13)|0)+(w12>>>26)|0,w12&=67108863,lo=Math.imul(al9,bl4),mid=(mid=Math.imul(al9,bh4))+Math.imul(ah9,bl4)|0,hi=Math.imul(ah9,bh4),lo=lo+Math.imul(al8,bl5)|0,mid=(mid=mid+Math.imul(al8,bh5)|0)+Math.imul(ah8,bl5)|0,hi=hi+Math.imul(ah8,bh5)|0,lo=lo+Math.imul(al7,bl6)|0,mid=(mid=mid+Math.imul(al7,bh6)|0)+Math.imul(ah7,bl6)|0,hi=hi+Math.imul(ah7,bh6)|0,lo=lo+Math.imul(al6,bl7)|0,mid=(mid=mid+Math.imul(al6,bh7)|0)+Math.imul(ah6,bl7)|0,hi=hi+Math.imul(ah6,bh7)|0,lo=lo+Math.imul(al5,bl8)|0,mid=(mid=mid+Math.imul(al5,bh8)|0)+Math.imul(ah5,bl8)|0,hi=hi+Math.imul(ah5,bh8)|0;var w13=(c+(lo=lo+Math.imul(al4,bl9)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al4,bh9)|0)+Math.imul(ah4,bl9)|0))<<13)|0;c=((hi=hi+Math.imul(ah4,bh9)|0)+(mid>>>13)|0)+(w13>>>26)|0,w13&=67108863,lo=Math.imul(al9,bl5),mid=(mid=Math.imul(al9,bh5))+Math.imul(ah9,bl5)|0,hi=Math.imul(ah9,bh5),lo=lo+Math.imul(al8,bl6)|0,mid=(mid=mid+Math.imul(al8,bh6)|0)+Math.imul(ah8,bl6)|0,hi=hi+Math.imul(ah8,bh6)|0,lo=lo+Math.imul(al7,bl7)|0,mid=(mid=mid+Math.imul(al7,bh7)|0)+Math.imul(ah7,bl7)|0,hi=hi+Math.imul(ah7,bh7)|0,lo=lo+Math.imul(al6,bl8)|0,mid=(mid=mid+Math.imul(al6,bh8)|0)+Math.imul(ah6,bl8)|0,hi=hi+Math.imul(ah6,bh8)|0;var w14=(c+(lo=lo+Math.imul(al5,bl9)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al5,bh9)|0)+Math.imul(ah5,bl9)|0))<<13)|0;c=((hi=hi+Math.imul(ah5,bh9)|0)+(mid>>>13)|0)+(w14>>>26)|0,w14&=67108863,lo=Math.imul(al9,bl6),mid=(mid=Math.imul(al9,bh6))+Math.imul(ah9,bl6)|0,hi=Math.imul(ah9,bh6),lo=lo+Math.imul(al8,bl7)|0,mid=(mid=mid+Math.imul(al8,bh7)|0)+Math.imul(ah8,bl7)|0,hi=hi+Math.imul(ah8,bh7)|0,lo=lo+Math.imul(al7,bl8)|0,mid=(mid=mid+Math.imul(al7,bh8)|0)+Math.imul(ah7,bl8)|0,hi=hi+Math.imul(ah7,bh8)|0;var w15=(c+(lo=lo+Math.imul(al6,bl9)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al6,bh9)|0)+Math.imul(ah6,bl9)|0))<<13)|0;c=((hi=hi+Math.imul(ah6,bh9)|0)+(mid>>>13)|0)+(w15>>>26)|0,w15&=67108863,lo=Math.imul(al9,bl7),mid=(mid=Math.imul(al9,bh7))+Math.imul(ah9,bl7)|0,hi=Math.imul(ah9,bh7),lo=lo+Math.imul(al8,bl8)|0,mid=(mid=mid+Math.imul(al8,bh8)|0)+Math.imul(ah8,bl8)|0,hi=hi+Math.imul(ah8,bh8)|0;var w16=(c+(lo=lo+Math.imul(al7,bl9)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al7,bh9)|0)+Math.imul(ah7,bl9)|0))<<13)|0;c=((hi=hi+Math.imul(ah7,bh9)|0)+(mid>>>13)|0)+(w16>>>26)|0,w16&=67108863,lo=Math.imul(al9,bl8),mid=(mid=Math.imul(al9,bh8))+Math.imul(ah9,bl8)|0,hi=Math.imul(ah9,bh8);var w17=(c+(lo=lo+Math.imul(al8,bl9)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al8,bh9)|0)+Math.imul(ah8,bl9)|0))<<13)|0;c=((hi=hi+Math.imul(ah8,bh9)|0)+(mid>>>13)|0)+(w17>>>26)|0,w17&=67108863;var w18=(c+(lo=Math.imul(al9,bl9))|0)+((8191&(mid=(mid=Math.imul(al9,bh9))+Math.imul(ah9,bl9)|0))<<13)|0;return c=((hi=Math.imul(ah9,bh9))+(mid>>>13)|0)+(w18>>>26)|0,w18&=67108863,o[0]=w0,o[1]=w1,o[2]=w2,o[3]=w3,o[4]=w4,o[5]=w5,o[6]=w6,o[7]=w7,o[8]=w8,o[9]=w9,o[10]=w10,o[11]=w11,o[12]=w12,o[13]=w13,o[14]=w14,o[15]=w15,o[16]=w16,o[17]=w17,o[18]=w18,0!==c&&(o[19]=c,out.length++),out};function jumboMulTo(self,num,out){return(new FFTM).mulp(self,num,out)}function FFTM(x,y){this.x=x,this.y=y}Math.imul||(comb10MulTo=smallMulTo),BN.prototype.mulTo=function mulTo(num,out){var len=this.length+num.length;return 10===this.length&&10===num.length?comb10MulTo(this,num,out):len<63?smallMulTo(this,num,out):len<1024?function bigMulTo(self,num,out){out.negative=num.negative^self.negative,out.length=self.length+num.length;for(var carry=0,hncarry=0,k=0;k<out.length-1;k++){var ncarry=hncarry;hncarry=0;for(var rword=67108863&carry,maxJ=Math.min(k,num.length-1),j=Math.max(0,k-self.length+1);j<=maxJ;j++){var i=k-j,r=(0|self.words[i])*(0|num.words[j]),lo=67108863&r;rword=67108863&(lo=lo+rword|0),hncarry+=(ncarry=(ncarry=ncarry+(r/67108864|0)|0)+(lo>>>26)|0)>>>26,ncarry&=67108863}out.words[k]=rword,carry=ncarry,ncarry=hncarry}return 0!==carry?out.words[k]=carry:out.length--,out.strip()}(this,num,out):jumboMulTo(this,num,out)},FFTM.prototype.makeRBT=function makeRBT(N){for(var t=new Array(N),l=BN.prototype._countBits(N)-1,i=0;i<N;i++)t[i]=this.revBin(i,l,N);return t},FFTM.prototype.revBin=function revBin(x,l,N){if(0===x||x===N-1)return x;for(var rb=0,i=0;i<l;i++)rb|=(1&x)<<l-i-1,x>>=1;return rb},FFTM.prototype.permute=function permute(rbt,rws,iws,rtws,itws,N){for(var i=0;i<N;i++)rtws[i]=rws[rbt[i]],itws[i]=iws[rbt[i]]},FFTM.prototype.transform=function transform(rws,iws,rtws,itws,N,rbt){this.permute(rbt,rws,iws,rtws,itws,N);for(var s=1;s<N;s<<=1)for(var l=s<<1,rtwdf=Math.cos(2*Math.PI/l),itwdf=Math.sin(2*Math.PI/l),p=0;p<N;p+=l)for(var rtwdf_=rtwdf,itwdf_=itwdf,j=0;j<s;j++){var re=rtws[p+j],ie=itws[p+j],ro=rtws[p+j+s],io=itws[p+j+s],rx=rtwdf_*ro-itwdf_*io;io=rtwdf_*io+itwdf_*ro,ro=rx,rtws[p+j]=re+ro,itws[p+j]=ie+io,rtws[p+j+s]=re-ro,itws[p+j+s]=ie-io,j!==l&&(rx=rtwdf*rtwdf_-itwdf*itwdf_,itwdf_=rtwdf*itwdf_+itwdf*rtwdf_,rtwdf_=rx)}},FFTM.prototype.guessLen13b=function guessLen13b(n,m){var N=1|Math.max(m,n),odd=1&N,i=0;for(N=N/2|0;N;N>>>=1)i++;return 1<<i+1+odd},FFTM.prototype.conjugate=function conjugate(rws,iws,N){if(!(N<=1))for(var i=0;i<N/2;i++){var t=rws[i];rws[i]=rws[N-i-1],rws[N-i-1]=t,t=iws[i],iws[i]=-iws[N-i-1],iws[N-i-1]=-t}},FFTM.prototype.normalize13b=function normalize13b(ws,N){for(var carry=0,i=0;i<N/2;i++){var w=8192*Math.round(ws[2*i+1]/N)+Math.round(ws[2*i]/N)+carry;ws[i]=67108863&w,carry=w<67108864?0:w/67108864|0}return ws},FFTM.prototype.convert13b=function convert13b(ws,len,rws,N){for(var carry=0,i=0;i<len;i++)carry+=0|ws[i],rws[2*i]=8191&carry,carry>>>=13,rws[2*i+1]=8191&carry,carry>>>=13;for(i=2*len;i<N;++i)rws[i]=0;assert(0===carry),assert(0==(-8192&carry))},FFTM.prototype.stub=function stub(N){for(var ph=new Array(N),i=0;i<N;i++)ph[i]=0;return ph},FFTM.prototype.mulp=function mulp(x,y,out){var N=2*this.guessLen13b(x.length,y.length),rbt=this.makeRBT(N),_=this.stub(N),rws=new Array(N),rwst=new Array(N),iwst=new Array(N),nrws=new Array(N),nrwst=new Array(N),niwst=new Array(N),rmws=out.words;rmws.length=N,this.convert13b(x.words,x.length,rws,N),this.convert13b(y.words,y.length,nrws,N),this.transform(rws,_,rwst,iwst,N,rbt),this.transform(nrws,_,nrwst,niwst,N,rbt);for(var i=0;i<N;i++){var rx=rwst[i]*nrwst[i]-iwst[i]*niwst[i];iwst[i]=rwst[i]*niwst[i]+iwst[i]*nrwst[i],rwst[i]=rx}return this.conjugate(rwst,iwst,N),this.transform(rwst,iwst,rmws,_,N,rbt),this.conjugate(rmws,_,N),this.normalize13b(rmws,N),out.negative=x.negative^y.negative,out.length=x.length+y.length,out.strip()},BN.prototype.mul=function mul(num){var out=new BN(null);return out.words=new Array(this.length+num.length),this.mulTo(num,out)},BN.prototype.mulf=function mulf(num){var out=new BN(null);return out.words=new Array(this.length+num.length),jumboMulTo(this,num,out)},BN.prototype.imul=function imul(num){return this.clone().mulTo(num,this)},BN.prototype.imuln=function imuln(num){assert("number"==typeof num),assert(num<67108864);for(var carry=0,i=0;i<this.length;i++){var w=(0|this.words[i])*num,lo=(67108863&w)+(67108863&carry);carry>>=26,carry+=w/67108864|0,carry+=lo>>>26,this.words[i]=67108863&lo}return 0!==carry&&(this.words[i]=carry,this.length++),this},BN.prototype.muln=function muln(num){return this.clone().imuln(num)},BN.prototype.sqr=function sqr(){return this.mul(this)},BN.prototype.isqr=function isqr(){return this.imul(this.clone())},BN.prototype.pow=function pow(num){var w=function toBitArray(num){for(var w=new Array(num.bitLength()),bit=0;bit<w.length;bit++){var off=bit/26|0,wbit=bit%26;w[bit]=(num.words[off]&1<<wbit)>>>wbit}return w}(num);if(0===w.length)return new BN(1);for(var res=this,i=0;i<w.length&&0===w[i];i++,res=res.sqr());if(++i<w.length)for(var q=res.sqr();i<w.length;i++,q=q.sqr())0!==w[i]&&(res=res.mul(q));return res},BN.prototype.iushln=function iushln(bits){assert("number"==typeof bits&&bits>=0);var i,r=bits%26,s=(bits-r)/26,carryMask=67108863>>>26-r<<26-r;if(0!==r){var carry=0;for(i=0;i<this.length;i++){var newCarry=this.words[i]&carryMask,c=(0|this.words[i])-newCarry<<r;this.words[i]=c|carry,carry=newCarry>>>26-r}carry&&(this.words[i]=carry,this.length++)}if(0!==s){for(i=this.length-1;i>=0;i--)this.words[i+s]=this.words[i];for(i=0;i<s;i++)this.words[i]=0;this.length+=s}return this.strip()},BN.prototype.ishln=function ishln(bits){return assert(0===this.negative),this.iushln(bits)},BN.prototype.iushrn=function iushrn(bits,hint,extended){var h;assert("number"==typeof bits&&bits>=0),h=hint?(hint-hint%26)/26:0;var r=bits%26,s=Math.min((bits-r)/26,this.length),mask=67108863^67108863>>>r<<r,maskedWords=extended;if(h-=s,h=Math.max(0,h),maskedWords){for(var i=0;i<s;i++)maskedWords.words[i]=this.words[i];maskedWords.length=s}if(0===s);else if(this.length>s)for(this.length-=s,i=0;i<this.length;i++)this.words[i]=this.words[i+s];else this.words[0]=0,this.length=1;var carry=0;for(i=this.length-1;i>=0&&(0!==carry||i>=h);i--){var word=0|this.words[i];this.words[i]=carry<<26-r|word>>>r,carry=word&mask}return maskedWords&&0!==carry&&(maskedWords.words[maskedWords.length++]=carry),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},BN.prototype.ishrn=function ishrn(bits,hint,extended){return assert(0===this.negative),this.iushrn(bits,hint,extended)},BN.prototype.shln=function shln(bits){return this.clone().ishln(bits)},BN.prototype.ushln=function ushln(bits){return this.clone().iushln(bits)},BN.prototype.shrn=function shrn(bits){return this.clone().ishrn(bits)},BN.prototype.ushrn=function ushrn(bits){return this.clone().iushrn(bits)},BN.prototype.testn=function testn(bit){assert("number"==typeof bit&&bit>=0);var r=bit%26,s=(bit-r)/26,q=1<<r;return!(this.length<=s)&&!!(this.words[s]&q)},BN.prototype.imaskn=function imaskn(bits){assert("number"==typeof bits&&bits>=0);var r=bits%26,s=(bits-r)/26;if(assert(0===this.negative,"imaskn works only with positive numbers"),this.length<=s)return this;if(0!==r&&s++,this.length=Math.min(s,this.length),0!==r){var mask=67108863^67108863>>>r<<r;this.words[this.length-1]&=mask}return this.strip()},BN.prototype.maskn=function maskn(bits){return this.clone().imaskn(bits)},BN.prototype.iaddn=function iaddn(num){return assert("number"==typeof num),assert(num<67108864),num<0?this.isubn(-num):0!==this.negative?1===this.length&&(0|this.words[0])<num?(this.words[0]=num-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(num),this.negative=1,this):this._iaddn(num)},BN.prototype._iaddn=function _iaddn(num){this.words[0]+=num;for(var i=0;i<this.length&&this.words[i]>=67108864;i++)this.words[i]-=67108864,i===this.length-1?this.words[i+1]=1:this.words[i+1]++;return this.length=Math.max(this.length,i+1),this},BN.prototype.isubn=function isubn(num){if(assert("number"==typeof num),assert(num<67108864),num<0)return this.iaddn(-num);if(0!==this.negative)return this.negative=0,this.iaddn(num),this.negative=1,this;if(this.words[0]-=num,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var i=0;i<this.length&&this.words[i]<0;i++)this.words[i]+=67108864,this.words[i+1]-=1;return this.strip()},BN.prototype.addn=function addn(num){return this.clone().iaddn(num)},BN.prototype.subn=function subn(num){return this.clone().isubn(num)},BN.prototype.iabs=function iabs(){return this.negative=0,this},BN.prototype.abs=function abs(){return this.clone().iabs()},BN.prototype._ishlnsubmul=function _ishlnsubmul(num,mul,shift){var i,w,len=num.length+shift;this._expand(len);var carry=0;for(i=0;i<num.length;i++){w=(0|this.words[i+shift])+carry;var right=(0|num.words[i])*mul;carry=((w-=67108863&right)>>26)-(right/67108864|0),this.words[i+shift]=67108863&w}for(;i<this.length-shift;i++)carry=(w=(0|this.words[i+shift])+carry)>>26,this.words[i+shift]=67108863&w;if(0===carry)return this.strip();for(assert(-1===carry),carry=0,i=0;i<this.length;i++)carry=(w=-(0|this.words[i])+carry)>>26,this.words[i]=67108863&w;return this.negative=1,this.strip()},BN.prototype._wordDiv=function _wordDiv(num,mode){var shift=(this.length,num.length),a=this.clone(),b=num,bhi=0|b.words[b.length-1];0!==(shift=26-this._countBits(bhi))&&(b=b.ushln(shift),a.iushln(shift),bhi=0|b.words[b.length-1]);var q,m=a.length-b.length;if("mod"!==mode){(q=new BN(null)).length=m+1,q.words=new Array(q.length);for(var i=0;i<q.length;i++)q.words[i]=0}var diff=a.clone()._ishlnsubmul(b,1,m);0===diff.negative&&(a=diff,q&&(q.words[m]=1));for(var j=m-1;j>=0;j--){var qj=67108864*(0|a.words[b.length+j])+(0|a.words[b.length+j-1]);for(qj=Math.min(qj/bhi|0,67108863),a._ishlnsubmul(b,qj,j);0!==a.negative;)qj--,a.negative=0,a._ishlnsubmul(b,1,j),a.isZero()||(a.negative^=1);q&&(q.words[j]=qj)}return q&&q.strip(),a.strip(),"div"!==mode&&0!==shift&&a.iushrn(shift),{div:q||null,mod:a}},BN.prototype.divmod=function divmod(num,mode,positive){return assert(!num.isZero()),this.isZero()?{div:new BN(0),mod:new BN(0)}:0!==this.negative&&0===num.negative?(res=this.neg().divmod(num,mode),"mod"!==mode&&(div=res.div.neg()),"div"!==mode&&(mod=res.mod.neg(),positive&&0!==mod.negative&&mod.iadd(num)),{div:div,mod:mod}):0===this.negative&&0!==num.negative?(res=this.divmod(num.neg(),mode),"mod"!==mode&&(div=res.div.neg()),{div:div,mod:res.mod}):0!=(this.negative&num.negative)?(res=this.neg().divmod(num.neg(),mode),"div"!==mode&&(mod=res.mod.neg(),positive&&0!==mod.negative&&mod.isub(num)),{div:res.div,mod:mod}):num.length>this.length||this.cmp(num)<0?{div:new BN(0),mod:this}:1===num.length?"div"===mode?{div:this.divn(num.words[0]),mod:null}:"mod"===mode?{div:null,mod:new BN(this.modn(num.words[0]))}:{div:this.divn(num.words[0]),mod:new BN(this.modn(num.words[0]))}:this._wordDiv(num,mode);var div,mod,res},BN.prototype.div=function div(num){return this.divmod(num,"div",!1).div},BN.prototype.mod=function mod(num){return this.divmod(num,"mod",!1).mod},BN.prototype.umod=function umod(num){return this.divmod(num,"mod",!0).mod},BN.prototype.divRound=function divRound(num){var dm=this.divmod(num);if(dm.mod.isZero())return dm.div;var mod=0!==dm.div.negative?dm.mod.isub(num):dm.mod,half=num.ushrn(1),r2=num.andln(1),cmp=mod.cmp(half);return cmp<0||1===r2&&0===cmp?dm.div:0!==dm.div.negative?dm.div.isubn(1):dm.div.iaddn(1)},BN.prototype.modn=function modn(num){assert(num<=67108863);for(var p=(1<<26)%num,acc=0,i=this.length-1;i>=0;i--)acc=(p*acc+(0|this.words[i]))%num;return acc},BN.prototype.idivn=function idivn(num){assert(num<=67108863);for(var carry=0,i=this.length-1;i>=0;i--){var w=(0|this.words[i])+67108864*carry;this.words[i]=w/num|0,carry=w%num}return this.strip()},BN.prototype.divn=function divn(num){return this.clone().idivn(num)},BN.prototype.egcd=function egcd(p){assert(0===p.negative),assert(!p.isZero());var x=this,y=p.clone();x=0!==x.negative?x.umod(p):x.clone();for(var A=new BN(1),B=new BN(0),C=new BN(0),D=new BN(1),g=0;x.isEven()&&y.isEven();)x.iushrn(1),y.iushrn(1),++g;for(var yp=y.clone(),xp=x.clone();!x.isZero();){for(var i=0,im=1;0==(x.words[0]&im)&&i<26;++i,im<<=1);if(i>0)for(x.iushrn(i);i-- >0;)(A.isOdd()||B.isOdd())&&(A.iadd(yp),B.isub(xp)),A.iushrn(1),B.iushrn(1);for(var j=0,jm=1;0==(y.words[0]&jm)&&j<26;++j,jm<<=1);if(j>0)for(y.iushrn(j);j-- >0;)(C.isOdd()||D.isOdd())&&(C.iadd(yp),D.isub(xp)),C.iushrn(1),D.iushrn(1);x.cmp(y)>=0?(x.isub(y),A.isub(C),B.isub(D)):(y.isub(x),C.isub(A),D.isub(B))}return{a:C,b:D,gcd:y.iushln(g)}},BN.prototype._invmp=function _invmp(p){assert(0===p.negative),assert(!p.isZero());var a=this,b=p.clone();a=0!==a.negative?a.umod(p):a.clone();for(var res,x1=new BN(1),x2=new BN(0),delta=b.clone();a.cmpn(1)>0&&b.cmpn(1)>0;){for(var i=0,im=1;0==(a.words[0]&im)&&i<26;++i,im<<=1);if(i>0)for(a.iushrn(i);i-- >0;)x1.isOdd()&&x1.iadd(delta),x1.iushrn(1);for(var j=0,jm=1;0==(b.words[0]&jm)&&j<26;++j,jm<<=1);if(j>0)for(b.iushrn(j);j-- >0;)x2.isOdd()&&x2.iadd(delta),x2.iushrn(1);a.cmp(b)>=0?(a.isub(b),x1.isub(x2)):(b.isub(a),x2.isub(x1))}return(res=0===a.cmpn(1)?x1:x2).cmpn(0)<0&&res.iadd(p),res},BN.prototype.gcd=function gcd(num){if(this.isZero())return num.abs();if(num.isZero())return this.abs();var a=this.clone(),b=num.clone();a.negative=0,b.negative=0;for(var shift=0;a.isEven()&&b.isEven();shift++)a.iushrn(1),b.iushrn(1);for(;;){for(;a.isEven();)a.iushrn(1);for(;b.isEven();)b.iushrn(1);var r=a.cmp(b);if(r<0){var t=a;a=b,b=t}else if(0===r||0===b.cmpn(1))break;a.isub(b)}return b.iushln(shift)},BN.prototype.invm=function invm(num){return this.egcd(num).a.umod(num)},BN.prototype.isEven=function isEven(){return 0==(1&this.words[0])},BN.prototype.isOdd=function isOdd(){return 1==(1&this.words[0])},BN.prototype.andln=function andln(num){return this.words[0]&num},BN.prototype.bincn=function bincn(bit){assert("number"==typeof bit);var r=bit%26,s=(bit-r)/26,q=1<<r;if(this.length<=s)return this._expand(s+1),this.words[s]|=q,this;for(var carry=q,i=s;0!==carry&&i<this.length;i++){var w=0|this.words[i];carry=(w+=carry)>>>26,w&=67108863,this.words[i]=w}return 0!==carry&&(this.words[i]=carry,this.length++),this},BN.prototype.isZero=function isZero(){return 1===this.length&&0===this.words[0]},BN.prototype.cmpn=function cmpn(num){var res,negative=num<0;if(0!==this.negative&&!negative)return-1;if(0===this.negative&&negative)return 1;if(this.strip(),this.length>1)res=1;else{negative&&(num=-num),assert(num<=67108863,"Number is too big");var w=0|this.words[0];res=w===num?0:w<num?-1:1}return 0!==this.negative?0|-res:res},BN.prototype.cmp=function cmp(num){if(0!==this.negative&&0===num.negative)return-1;if(0===this.negative&&0!==num.negative)return 1;var res=this.ucmp(num);return 0!==this.negative?0|-res:res},BN.prototype.ucmp=function ucmp(num){if(this.length>num.length)return 1;if(this.length<num.length)return-1;for(var res=0,i=this.length-1;i>=0;i--){var a=0|this.words[i],b=0|num.words[i];if(a!==b){a<b?res=-1:a>b&&(res=1);break}}return res},BN.prototype.gtn=function gtn(num){return 1===this.cmpn(num)},BN.prototype.gt=function gt(num){return 1===this.cmp(num)},BN.prototype.gten=function gten(num){return this.cmpn(num)>=0},BN.prototype.gte=function gte(num){return this.cmp(num)>=0},BN.prototype.ltn=function ltn(num){return-1===this.cmpn(num)},BN.prototype.lt=function lt(num){return-1===this.cmp(num)},BN.prototype.lten=function lten(num){return this.cmpn(num)<=0},BN.prototype.lte=function lte(num){return this.cmp(num)<=0},BN.prototype.eqn=function eqn(num){return 0===this.cmpn(num)},BN.prototype.eq=function eq(num){return 0===this.cmp(num)},BN.red=function red(num){return new Red(num)},BN.prototype.toRed=function toRed(ctx){return assert(!this.red,"Already a number in reduction context"),assert(0===this.negative,"red works only with positives"),ctx.convertTo(this)._forceRed(ctx)},BN.prototype.fromRed=function fromRed(){return assert(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},BN.prototype._forceRed=function _forceRed(ctx){return this.red=ctx,this},BN.prototype.forceRed=function forceRed(ctx){return assert(!this.red,"Already a number in reduction context"),this._forceRed(ctx)},BN.prototype.redAdd=function redAdd(num){return assert(this.red,"redAdd works only with red numbers"),this.red.add(this,num)},BN.prototype.redIAdd=function redIAdd(num){return assert(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,num)},BN.prototype.redSub=function redSub(num){return assert(this.red,"redSub works only with red numbers"),this.red.sub(this,num)},BN.prototype.redISub=function redISub(num){return assert(this.red,"redISub works only with red numbers"),this.red.isub(this,num)},BN.prototype.redShl=function redShl(num){return assert(this.red,"redShl works only with red numbers"),this.red.shl(this,num)},BN.prototype.redMul=function redMul(num){return assert(this.red,"redMul works only with red numbers"),this.red._verify2(this,num),this.red.mul(this,num)},BN.prototype.redIMul=function redIMul(num){return assert(this.red,"redMul works only with red numbers"),this.red._verify2(this,num),this.red.imul(this,num)},BN.prototype.redSqr=function redSqr(){return assert(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},BN.prototype.redISqr=function redISqr(){return assert(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},BN.prototype.redSqrt=function redSqrt(){return assert(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},BN.prototype.redInvm=function redInvm(){return assert(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},BN.prototype.redNeg=function redNeg(){return assert(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},BN.prototype.redPow=function redPow(num){return assert(this.red&&!num.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,num)};var primes={k256:null,p224:null,p192:null,p25519:null};function MPrime(name,p){this.name=name,this.p=new BN(p,16),this.n=this.p.bitLength(),this.k=new BN(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function K256(){MPrime.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function P224(){MPrime.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function P192(){MPrime.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function P25519(){MPrime.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function Red(m){if("string"==typeof m){var prime=BN._prime(m);this.m=prime.p,this.prime=prime}else assert(m.gtn(1),"modulus must be greater than 1"),this.m=m,this.prime=null}function Mont(m){Red.call(this,m),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new BN(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}MPrime.prototype._tmp=function _tmp(){var tmp=new BN(null);return tmp.words=new Array(Math.ceil(this.n/13)),tmp},MPrime.prototype.ireduce=function ireduce(num){var rlen,r=num;do{this.split(r,this.tmp),rlen=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(rlen>this.n);var cmp=rlen<this.n?-1:r.ucmp(this.p);return 0===cmp?(r.words[0]=0,r.length=1):cmp>0?r.isub(this.p):r.strip(),r},MPrime.prototype.split=function split(input,out){input.iushrn(this.n,0,out)},MPrime.prototype.imulK=function imulK(num){return num.imul(this.k)},inherits(K256,MPrime),K256.prototype.split=function split(input,output){for(var outLen=Math.min(input.length,9),i=0;i<outLen;i++)output.words[i]=input.words[i];if(output.length=outLen,input.length<=9)return input.words[0]=0,void(input.length=1);var prev=input.words[9];for(output.words[output.length++]=4194303&prev,i=10;i<input.length;i++){var next=0|input.words[i];input.words[i-10]=(4194303&next)<<4|prev>>>22,prev=next}prev>>>=22,input.words[i-10]=prev,0===prev&&input.length>10?input.length-=10:input.length-=9},K256.prototype.imulK=function imulK(num){num.words[num.length]=0,num.words[num.length+1]=0,num.length+=2;for(var lo=0,i=0;i<num.length;i++){var w=0|num.words[i];lo+=977*w,num.words[i]=67108863&lo,lo=64*w+(lo/67108864|0)}return 0===num.words[num.length-1]&&(num.length--,0===num.words[num.length-1]&&num.length--),num},inherits(P224,MPrime),inherits(P192,MPrime),inherits(P25519,MPrime),P25519.prototype.imulK=function imulK(num){for(var carry=0,i=0;i<num.length;i++){var hi=19*(0|num.words[i])+carry,lo=67108863&hi;hi>>>=26,num.words[i]=lo,carry=hi}return 0!==carry&&(num.words[num.length++]=carry),num},BN._prime=function prime(name){if(primes[name])return primes[name];var prime;if("k256"===name)prime=new K256;else if("p224"===name)prime=new P224;else if("p192"===name)prime=new P192;else{if("p25519"!==name)throw new Error("Unknown prime "+name);prime=new P25519}return primes[name]=prime,prime},Red.prototype._verify1=function _verify1(a){assert(0===a.negative,"red works only with positives"),assert(a.red,"red works only with red numbers")},Red.prototype._verify2=function _verify2(a,b){assert(0==(a.negative|b.negative),"red works only with positives"),assert(a.red&&a.red===b.red,"red works only with red numbers")},Red.prototype.imod=function imod(a){return this.prime?this.prime.ireduce(a)._forceRed(this):a.umod(this.m)._forceRed(this)},Red.prototype.neg=function neg(a){return a.isZero()?a.clone():this.m.sub(a)._forceRed(this)},Red.prototype.add=function add(a,b){this._verify2(a,b);var res=a.add(b);return res.cmp(this.m)>=0&&res.isub(this.m),res._forceRed(this)},Red.prototype.iadd=function iadd(a,b){this._verify2(a,b);var res=a.iadd(b);return res.cmp(this.m)>=0&&res.isub(this.m),res},Red.prototype.sub=function sub(a,b){this._verify2(a,b);var res=a.sub(b);return res.cmpn(0)<0&&res.iadd(this.m),res._forceRed(this)},Red.prototype.isub=function isub(a,b){this._verify2(a,b);var res=a.isub(b);return res.cmpn(0)<0&&res.iadd(this.m),res},Red.prototype.shl=function shl(a,num){return this._verify1(a),this.imod(a.ushln(num))},Red.prototype.imul=function imul(a,b){return this._verify2(a,b),this.imod(a.imul(b))},Red.prototype.mul=function mul(a,b){return this._verify2(a,b),this.imod(a.mul(b))},Red.prototype.isqr=function isqr(a){return this.imul(a,a.clone())},Red.prototype.sqr=function sqr(a){return this.mul(a,a)},Red.prototype.sqrt=function sqrt(a){if(a.isZero())return a.clone();var mod3=this.m.andln(3);if(assert(mod3%2==1),3===mod3){var pow=this.m.add(new BN(1)).iushrn(2);return this.pow(a,pow)}for(var q=this.m.subn(1),s=0;!q.isZero()&&0===q.andln(1);)s++,q.iushrn(1);assert(!q.isZero());var one=new BN(1).toRed(this),nOne=one.redNeg(),lpow=this.m.subn(1).iushrn(1),z=this.m.bitLength();for(z=new BN(2*z*z).toRed(this);0!==this.pow(z,lpow).cmp(nOne);)z.redIAdd(nOne);for(var c=this.pow(z,q),r=this.pow(a,q.addn(1).iushrn(1)),t=this.pow(a,q),m=s;0!==t.cmp(one);){for(var tmp=t,i=0;0!==tmp.cmp(one);i++)tmp=tmp.redSqr();assert(i<m);var b=this.pow(c,new BN(1).iushln(m-i-1));r=r.redMul(b),c=b.redSqr(),t=t.redMul(c),m=i}return r},Red.prototype.invm=function invm(a){var inv=a._invmp(this.m);return 0!==inv.negative?(inv.negative=0,this.imod(inv).redNeg()):this.imod(inv)},Red.prototype.pow=function pow(a,num){if(num.isZero())return new BN(1).toRed(this);if(0===num.cmpn(1))return a.clone();var wnd=new Array(16);wnd[0]=new BN(1).toRed(this),wnd[1]=a;for(var i=2;i<wnd.length;i++)wnd[i]=this.mul(wnd[i-1],a);var res=wnd[0],current=0,currentLen=0,start=num.bitLength()%26;for(0===start&&(start=26),i=num.length-1;i>=0;i--){for(var word=num.words[i],j=start-1;j>=0;j--){var bit=word>>j&1;res!==wnd[0]&&(res=this.sqr(res)),0!==bit||0!==current?(current<<=1,current|=bit,(4===++currentLen||0===i&&0===j)&&(res=this.mul(res,wnd[current]),currentLen=0,current=0)):currentLen=0}start=26}return res},Red.prototype.convertTo=function convertTo(num){var r=num.umod(this.m);return r===num?r.clone():r},Red.prototype.convertFrom=function convertFrom(num){var res=num.clone();return res.red=null,res},BN.mont=function mont(num){return new Mont(num)},inherits(Mont,Red),Mont.prototype.convertTo=function convertTo(num){return this.imod(num.ushln(this.shift))},Mont.prototype.convertFrom=function convertFrom(num){var r=this.imod(num.mul(this.rinv));return r.red=null,r},Mont.prototype.imul=function imul(a,b){if(a.isZero()||b.isZero())return a.words[0]=0,a.length=1,a;var t=a.imul(b),c=t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),u=t.isub(c).iushrn(this.shift),res=u;return u.cmp(this.m)>=0?res=u.isub(this.m):u.cmpn(0)<0&&(res=u.iadd(this.m)),res._forceRed(this)},Mont.prototype.mul=function mul(a,b){if(a.isZero()||b.isZero())return new BN(0)._forceRed(this);var t=a.mul(b),c=t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),u=t.isub(c).iushrn(this.shift),res=u;return u.cmp(this.m)>=0?res=u.isub(this.m):u.cmpn(0)<0&&(res=u.iadd(this.m)),res._forceRed(this)},Mont.prototype.invm=function invm(a){return this.imod(a._invmp(this.m).mul(this.r2))._forceRed(this)}}(_$bn_74,this),_$bn_74=_$bn_74.exports;var _$sign_60=function __sign_60(x){return x.cmp(new _$bn_74(0))};var _$double_130={};(function(Buffer){var hasTypedArrays=!1;if("undefined"!=typeof Float64Array){var DOUBLE_VIEW=new Float64Array(1),UINT_VIEW=new Uint32Array(DOUBLE_VIEW.buffer);if(DOUBLE_VIEW[0]=1,hasTypedArrays=!0,1072693248===UINT_VIEW[1]){(_$double_130=function doubleBitsLE(n){return DOUBLE_VIEW[0]=n,[UINT_VIEW[0],UINT_VIEW[1]]}).pack=function toDoubleLE(lo,hi){return UINT_VIEW[0]=lo,UINT_VIEW[1]=hi,DOUBLE_VIEW[0]},_$double_130.lo=function lowUintLE(n){return DOUBLE_VIEW[0]=n,UINT_VIEW[0]},_$double_130.hi=function highUintLE(n){return DOUBLE_VIEW[0]=n,UINT_VIEW[1]}}else if(1072693248===UINT_VIEW[0]){(_$double_130=function doubleBitsBE(n){return DOUBLE_VIEW[0]=n,[UINT_VIEW[1],UINT_VIEW[0]]}).pack=function toDoubleBE(lo,hi){return UINT_VIEW[1]=lo,UINT_VIEW[0]=hi,DOUBLE_VIEW[0]},_$double_130.lo=function lowUintBE(n){return DOUBLE_VIEW[0]=n,UINT_VIEW[1]},_$double_130.hi=function highUintBE(n){return DOUBLE_VIEW[0]=n,UINT_VIEW[0]}}else hasTypedArrays=!1}if(!hasTypedArrays){var buffer=new Buffer(8);(_$double_130=function doubleBits(n){return buffer.writeDoubleLE(n,0,!0),[buffer.readUInt32LE(0,!0),buffer.readUInt32LE(4,!0)]}).pack=function toDouble(lo,hi){return buffer.writeUInt32LE(lo,0,!0),buffer.writeUInt32LE(hi,4,!0),buffer.readDoubleLE(0,!0)},_$double_130.lo=function lowUint(n){return buffer.writeDoubleLE(n,0,!0),buffer.readUInt32LE(0,!0)},_$double_130.hi=function highUint(n){return buffer.writeDoubleLE(n,0,!0),buffer.readUInt32LE(4,!0)}}_$double_130.sign=function(n){return _$double_130.hi(n)>>>31},_$double_130.exponent=function(n){return(_$double_130.hi(n)<<1>>>21)-1023},_$double_130.fraction=function(n){var lo=_$double_130.lo(n),hi=_$double_130.hi(n),b=1048575&hi;return 2146435072&hi&&(b+=1<<20),[lo,b]},_$double_130.denormalized=function(n){return!(2146435072&_$double_130.hi(n))}}).call(this,_$buffer_84.Buffer);var _$num2bn_64=function num2bn(x){var e=_$double_130.exponent(x);return e<52?new _$bn_74(x):new _$bn_74(x*Math.pow(2,52-e)).ushln(e-52)};var _$rationalize_65=function rationalize(numer,denom){var snumer=_$sign_60(numer),sdenom=_$sign_60(denom);if(0===snumer)return[_$num2bn_64(0),_$num2bn_64(1)];if(0===sdenom)return[_$num2bn_64(0),_$num2bn_64(0)];sdenom<0&&(numer=numer.neg(),denom=denom.neg());var d=numer.gcd(denom);if(d.cmpn(1))return[numer.div(d),denom.div(d)];return[numer,denom]};var _$div_57=function div(a,b){return _$rationalize_65(a[0].mul(b[1]),a[1].mul(b[0]))};var _$isBN_63=function isBN(x){return x&&"object"==typeof x&&Boolean(x.words)};var _$isRat_59=function isRat(x){return Array.isArray(x)&&2===x.length&&_$isBN_63(x[0])&&_$isBN_63(x[1])};var _$str2BN_66=function str2BN(x){return new _$bn_74(x)};var _$makeRational_58=function makeRational(numer,denom){if(_$isRat_59(numer))return denom?_$div_57(numer,makeRational(denom)):[numer[0].clone(),numer[1].clone()];var shift=0;var a,b;if(_$isBN_63(numer))a=numer.clone();else if("string"==typeof numer)a=_$str2BN_66(numer);else{if(0===numer)return[_$num2bn_64(0),_$num2bn_64(1)];if(numer===Math.floor(numer))a=_$num2bn_64(numer);else{for(;numer!==Math.floor(numer);)numer*=Math.pow(2,256),shift-=256;a=_$num2bn_64(numer)}}if(_$isRat_59(denom))a.mul(denom[1]),b=denom[0].clone();else if(_$isBN_63(denom))b=denom.clone();else if("string"==typeof denom)b=_$str2BN_66(denom);else if(denom)if(denom===Math.floor(denom))b=_$num2bn_64(denom);else{for(;denom!==Math.floor(denom);)denom*=Math.pow(2,256),shift+=256;b=_$num2bn_64(denom)}else b=_$num2bn_64(1);shift>0?a=a.ushln(shift):shift<0&&(b=b.ushln(-shift));return _$rationalize_65(a,b)};var _$bn2num_61=function bn2num(b){var l=b.length,words=b.words,out=0;if(1===l)out=words[0];else if(2===l)out=words[0]+67108864*words[1];else for(var i=0;i<l;i++){var w=words[i];out+=w*Math.pow(67108864,i)}return _$sign_60(b)*out};var ctz=_$twiddle_72.countTrailingZeros,_$ctzNumber_62=function ctzNumber(x){var l=ctz(_$double_130.lo(x));if(l<32)return l;var h=ctz(_$double_130.hi(x));if(h>20)return 52;return h+32};var _$roundRat_70=function roundRat(f){var a=f[0],b=f[1];if(0===a.cmpn(0))return 0;var h=a.abs().divmod(b.abs()),iv=h.div,x=_$bn2num_61(iv),ir=h.mod,sgn=a.negative!==b.negative?-1:1;if(0===ir.cmpn(0))return sgn*x;if(x){var s=_$ctzNumber_62(x)+4,y=_$bn2num_61(ir.ushln(s).divRound(b));return sgn*(x+y*Math.pow(2,-s))}var ybits=b.bitLength()-ir.bitLength()+53,y=_$bn2num_61(ir.ushln(ybits).divRound(b));return ybits<1023?sgn*y*Math.pow(2,-ybits):(y*=Math.pow(2,-1023),sgn*y*Math.pow(2,1023-ybits))};var _$brute_77={},DIMENSION="d",AXIS="ax",VISIT="vv",FLIP="fp",ELEM_SIZE="es",RED_START="rs",RED_END="re",RED_BOXES="rb",RED_INDEX="ri",RED_PTR="rp",BLUE_START="bs",BLUE_END="be",BLUE_BOXES="bb",BLUE_INDEX="bi",BLUE_PTR="bp",RETVAL="rv",INNER_LABEL="Q",ARGS=[DIMENSION,AXIS,VISIT,RED_START,RED_END,RED_BOXES,RED_INDEX,BLUE_START,BLUE_END,BLUE_BOXES,BLUE_INDEX];function bruteForcePlanner(full){var funcName="bruteForce"+(full?"Full":"Partial"),prefix=[],fargs=ARGS.slice();full||fargs.splice(3,0,FLIP);var code=["function "+funcName+"("+fargs.join()+"){"];function invoke(redMajor,flip){var res=function generateBruteForce(redMajor,flip,full){var funcName="bruteForce"+(redMajor?"Red":"Blue")+(flip?"Flip":"")+(full?"Full":""),code=["function ",funcName,"(",ARGS.join(),"){","var ",ELEM_SIZE,"=2*",DIMENSION,";"],redLoop="for(var i="+RED_START+","+RED_PTR+"="+ELEM_SIZE+"*"+RED_START+";i<"+RED_END+";++i,"+RED_PTR+"+="+ELEM_SIZE+"){var x0="+RED_BOXES+"["+AXIS+"+"+RED_PTR+"],x1="+RED_BOXES+"["+AXIS+"+"+RED_PTR+"+"+DIMENSION+"],xi="+RED_INDEX+"[i];",blueLoop="for(var j="+BLUE_START+","+BLUE_PTR+"="+ELEM_SIZE+"*"+BLUE_START+";j<"+BLUE_END+";++j,"+BLUE_PTR+"+="+ELEM_SIZE+"){var y0="+BLUE_BOXES+"["+AXIS+"+"+BLUE_PTR+"],"+(full?"y1="+BLUE_BOXES+"["+AXIS+"+"+BLUE_PTR+"+"+DIMENSION+"],":"")+"yi="+BLUE_INDEX+"[j];";return redMajor?code.push(redLoop,INNER_LABEL,":",blueLoop):code.push(blueLoop,INNER_LABEL,":",redLoop),full?code.push("if(y1<x0||x1<y0)continue;"):flip?code.push("if(y0<=x0||x1<y0)continue;"):code.push("if(y0<x0||x1<y0)continue;"),code.push("for(var k="+AXIS+"+1;k<"+DIMENSION+";++k){var r0="+RED_BOXES+"[k+"+RED_PTR+"],r1="+RED_BOXES+"[k+"+DIMENSION+"+"+RED_PTR+"],b0="+BLUE_BOXES+"[k+"+BLUE_PTR+"],b1="+BLUE_BOXES+"[k+"+DIMENSION+"+"+BLUE_PTR+"];if(r1<b0||b1<r0)continue "+INNER_LABEL+";}var "+RETVAL+"="+VISIT+"("),flip?code.push("yi,xi"):code.push("xi,yi"),code.push(");if("+RETVAL+"!==void 0)return "+RETVAL+";}}}"),{name:funcName,code:code.join("")}}(redMajor,flip,full);prefix.push(res.code),code.push("return "+res.name+"("+ARGS.join()+");")}code.push("if("+RED_END+"-"+RED_START+">"+BLUE_END+"-"+BLUE_START+"){"),full?(invoke(!0,!1),code.push("}else{"),invoke(!1,!1)):(code.push("if("+FLIP+"){"),invoke(!0,!0),code.push("}else{"),invoke(!0,!1),code.push("}}else{if("+FLIP+"){"),invoke(!1,!0),code.push("}else{"),invoke(!1,!1),code.push("}")),code.push("}}return "+funcName);var codeStr=prefix.join("")+code.join("");return new Function(codeStr)()}_$brute_77.partial=bruteForcePlanner(!1),_$brute_77.full=bruteForcePlanner(!0);var _$genPartition_80=function genPartition(predicate,args){var fargs="abcdef".split("").concat(args),reads=[];predicate.indexOf("lo")>=0&&reads.push("lo=e[k+n]");predicate.indexOf("hi")>=0&&reads.push("hi=e[k+o]");return fargs.push(__code_80.replace("_",reads.join()).replace("$",predicate)),Function.apply(void 0,fargs)},__code_80="for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m";var _$findMedian_79=function findMedian(d,axis,start,end,boxes,ids){if(end<=start+1)return start;var lo=start,hi=end,mid=end+start>>>1,elemSize=2*d,pivot=mid,value=boxes[elemSize*mid+axis];for(;lo<hi;){if(hi-lo<PARTITION_THRESHOLD){insertionSort(d,axis,lo,hi,boxes,ids),value=boxes[elemSize*mid+axis];break}var count=hi-lo,pivot0=Math.random()*count+lo|0,value0=boxes[elemSize*pivot0+axis],pivot1=Math.random()*count+lo|0,value1=boxes[elemSize*pivot1+axis],pivot2=Math.random()*count+lo|0,value2=boxes[elemSize*pivot2+axis];value0<=value1?value2>=value1?(pivot=pivot1,value=value1):value0>=value2?(pivot=pivot0,value=value0):(pivot=pivot2,value=value2):value1>=value2?(pivot=pivot1,value=value1):value2>=value0?(pivot=pivot0,value=value0):(pivot=pivot2,value=value2);for(var aPtr=elemSize*(hi-1),bPtr=elemSize*pivot,i=0;i<elemSize;++i,++aPtr,++bPtr){var x=boxes[aPtr];boxes[aPtr]=boxes[bPtr],boxes[bPtr]=x}var y=ids[hi-1];ids[hi-1]=ids[pivot],ids[pivot]=y,pivot=partitionStartLessThan(d,axis,lo,hi-1,boxes,ids,value);for(var aPtr=elemSize*(hi-1),bPtr=elemSize*pivot,i=0;i<elemSize;++i,++aPtr,++bPtr){var x=boxes[aPtr];boxes[aPtr]=boxes[bPtr],boxes[bPtr]=x}var y=ids[hi-1];if(ids[hi-1]=ids[pivot],ids[pivot]=y,mid<pivot){for(hi=pivot-1;lo<hi&&boxes[elemSize*(hi-1)+axis]===value;)hi-=1;hi+=1}else{if(!(pivot<mid))break;for(lo=pivot+1;lo<hi&&boxes[elemSize*lo+axis]===value;)lo+=1}}return partitionStartLessThan(d,axis,start,mid,boxes,ids,boxes[elemSize*mid+axis])},partitionStartLessThan=_$genPartition_80("lo<p0",["p0"]),PARTITION_THRESHOLD=8;function insertionSort(d,axis,start,end,boxes,ids){for(var elemSize=2*d,boxPtr=elemSize*(start+1)+axis,i=start+1;i<end;++i,boxPtr+=elemSize)for(var x=boxes[boxPtr],j=i,ptr=elemSize*(i-1);j>start&&boxes[ptr+axis]>x;--j,ptr-=elemSize){for(var aPtr=ptr,bPtr=ptr+elemSize,k=0;k<elemSize;++k,++aPtr,++bPtr){var y=boxes[aPtr];boxes[aPtr]=boxes[bPtr],boxes[bPtr]=y}var tmp=ids[j];ids[j]=ids[j-1],ids[j-1]=tmp}}var _$wrapper_81=function wrapper(data,n0){n0<=4*INSERT_SORT_CUTOFF?__insertionSort_81(0,n0-1,data):function quickSort(left,right,data){var sixth=(right-left+1)/6|0,index1=left+sixth,index5=right-sixth,index3=left+right>>1,index2=index3-sixth,index4=index3+sixth,el1=index1,el2=index2,el3=index3,el4=index4,el5=index5,less=left+1,great=right-1,tmp=0;compare(el1,el2,data)&&(tmp=el1,el1=el2,el2=tmp);compare(el4,el5,data)&&(tmp=el4,el4=el5,el5=tmp);compare(el1,el3,data)&&(tmp=el1,el1=el3,el3=tmp);compare(el2,el3,data)&&(tmp=el2,el2=el3,el3=tmp);compare(el1,el4,data)&&(tmp=el1,el1=el4,el4=tmp);compare(el3,el4,data)&&(tmp=el3,el3=el4,el4=tmp);compare(el2,el5,data)&&(tmp=el2,el2=el5,el5=tmp);compare(el2,el3,data)&&(tmp=el2,el2=el3,el3=tmp);compare(el4,el5,data)&&(tmp=el4,el4=el5,el5=tmp);var pivot1X=data[2*el2];var pivot1Y=data[2*el2+1];var pivot2X=data[2*el4];var pivot2Y=data[2*el4+1];var ptr0=2*el1;var ptr2=2*el3;var ptr4=2*el5;var ptr5=2*index1;var ptr6=2*index3;var ptr7=2*index5;for(var i1=0;i1<2;++i1){var x=data[ptr0+i1],y=data[ptr2+i1],z=data[ptr4+i1];data[ptr5+i1]=x,data[ptr6+i1]=y,data[ptr7+i1]=z}move(index2,left,data);move(index4,right,data);for(var k=less;k<=great;++k)if(comparePivot(k,pivot1X,pivot1Y,data))k!==less&&__swap_81(k,less,data),++less;else if(!comparePivot(k,pivot2X,pivot2Y,data))for(;;){if(comparePivot(great,pivot2X,pivot2Y,data)){comparePivot(great,pivot1X,pivot1Y,data)?(rotate(k,less,great,data),++less,--great):(__swap_81(k,great,data),--great);break}if(--great<k)break}shufflePivot(left,less-1,pivot1X,pivot1Y,data);shufflePivot(right,great+1,pivot2X,pivot2Y,data);less-2-left<=INSERT_SORT_CUTOFF?__insertionSort_81(left,less-2,data):quickSort(left,less-2,data);right-(great+2)<=INSERT_SORT_CUTOFF?__insertionSort_81(great+2,right,data):quickSort(great+2,right,data);great-less<=INSERT_SORT_CUTOFF?__insertionSort_81(less,great,data):quickSort(less,great,data)}(0,n0-1,data)},INSERT_SORT_CUTOFF=32;function __insertionSort_81(left,right,data){for(var ptr=2*(left+1),i=left+1;i<=right;++i){for(var a=data[ptr++],b=data[ptr++],j=i,jptr=ptr-2;j-- >left;){var x=data[jptr-2],y=data[jptr-1];if(x<a)break;if(x===a&&y<b)break;data[jptr]=x,data[jptr+1]=y,jptr-=2}data[jptr]=a,data[jptr+1]=b}}function __swap_81(i,j,data){j*=2;var x=data[i*=2],y=data[i+1];data[i]=data[j],data[i+1]=data[j+1],data[j]=x,data[j+1]=y}function move(i,j,data){j*=2,data[i*=2]=data[j],data[i+1]=data[j+1]}function rotate(i,j,k,data){j*=2,k*=2;var x=data[i*=2],y=data[i+1];data[i]=data[j],data[i+1]=data[j+1],data[j]=data[k],data[j+1]=data[k+1],data[k]=x,data[k+1]=y}function shufflePivot(i,j,px,py,data){j*=2,data[i*=2]=data[j],data[j]=px,data[i+1]=data[j+1],data[j+1]=py}function compare(i,j,data){j*=2;var x=data[i*=2],y=data[j];return!(x<y)&&(x!==y||data[i+1]>data[j+1])}function comparePivot(i,y,b,data){var x=data[i*=2];return x<y||x===y&&data[i+1]<b}var _$sweep_82={init:function sqInit(count){var rcount=_$twiddle_72.nextPow2(count);RED_SWEEP_QUEUE.length<rcount&&(_$pool_360.free(RED_SWEEP_QUEUE),RED_SWEEP_QUEUE=_$pool_360.mallocInt32(rcount));RED_SWEEP_INDEX.length<rcount&&(_$pool_360.free(RED_SWEEP_INDEX),RED_SWEEP_INDEX=_$pool_360.mallocInt32(rcount));BLUE_SWEEP_QUEUE.length<rcount&&(_$pool_360.free(BLUE_SWEEP_QUEUE),BLUE_SWEEP_QUEUE=_$pool_360.mallocInt32(rcount));BLUE_SWEEP_INDEX.length<rcount&&(_$pool_360.free(BLUE_SWEEP_INDEX),BLUE_SWEEP_INDEX=_$pool_360.mallocInt32(rcount));COMMON_SWEEP_QUEUE.length<rcount&&(_$pool_360.free(COMMON_SWEEP_QUEUE),COMMON_SWEEP_QUEUE=_$pool_360.mallocInt32(rcount));COMMON_SWEEP_INDEX.length<rcount&&(_$pool_360.free(COMMON_SWEEP_INDEX),COMMON_SWEEP_INDEX=_$pool_360.mallocInt32(rcount));var eventLength=8*rcount;SWEEP_EVENTS.length<eventLength&&(_$pool_360.free(SWEEP_EVENTS),SWEEP_EVENTS=_$pool_360.mallocDouble(eventLength))},sweepBipartite:function sweepBipartite(d,visit,redStart,redEnd,red,redIndex,blueStart,blueEnd,blue,blueIndex){for(var ptr=0,elemSize=2*d,istart=d-1,iend=elemSize-1,i=redStart;i<redEnd;++i){var idx=redIndex[i],redOffset=elemSize*i;SWEEP_EVENTS[ptr++]=red[redOffset+istart],SWEEP_EVENTS[ptr++]=-(idx+1),SWEEP_EVENTS[ptr++]=red[redOffset+iend],SWEEP_EVENTS[ptr++]=idx}for(var i=blueStart;i<blueEnd;++i){var idx=blueIndex[i]+BLUE_FLAG,blueOffset=elemSize*i;SWEEP_EVENTS[ptr++]=blue[blueOffset+istart],SWEEP_EVENTS[ptr++]=-idx,SWEEP_EVENTS[ptr++]=blue[blueOffset+iend],SWEEP_EVENTS[ptr++]=idx}var n=ptr>>>1;_$wrapper_81(SWEEP_EVENTS,n);for(var redActive=0,blueActive=0,i=0;i<n;++i){var e=0|SWEEP_EVENTS[2*i+1];if(e>=BLUE_FLAG)sqPop(BLUE_SWEEP_QUEUE,BLUE_SWEEP_INDEX,blueActive--,e=e-BLUE_FLAG|0);else if(e>=0)sqPop(RED_SWEEP_QUEUE,RED_SWEEP_INDEX,redActive--,e);else if(e<=-BLUE_FLAG){e=-e-BLUE_FLAG|0;for(var j=0;j<redActive;++j){var retval=visit(RED_SWEEP_QUEUE[j],e);if(void 0!==retval)return retval}sqPush(BLUE_SWEEP_QUEUE,BLUE_SWEEP_INDEX,blueActive++,e)}else{e=-e-1|0;for(var j=0;j<blueActive;++j){var retval=visit(e,BLUE_SWEEP_QUEUE[j]);if(void 0!==retval)return retval}sqPush(RED_SWEEP_QUEUE,RED_SWEEP_INDEX,redActive++,e)}}},sweepComplete:function sweepComplete(d,visit,redStart,redEnd,red,redIndex,blueStart,blueEnd,blue,blueIndex){for(var ptr=0,elemSize=2*d,istart=d-1,iend=elemSize-1,i=redStart;i<redEnd;++i){var idx=redIndex[i]+1<<1,redOffset=elemSize*i;SWEEP_EVENTS[ptr++]=red[redOffset+istart],SWEEP_EVENTS[ptr++]=-idx,SWEEP_EVENTS[ptr++]=red[redOffset+iend],SWEEP_EVENTS[ptr++]=idx}for(var i=blueStart;i<blueEnd;++i){var idx=blueIndex[i]+1<<1,blueOffset=elemSize*i;SWEEP_EVENTS[ptr++]=blue[blueOffset+istart],SWEEP_EVENTS[ptr++]=1|-idx,SWEEP_EVENTS[ptr++]=blue[blueOffset+iend],SWEEP_EVENTS[ptr++]=1|idx}var n=ptr>>>1;_$wrapper_81(SWEEP_EVENTS,n);for(var redActive=0,blueActive=0,commonActive=0,i=0;i<n;++i){var e=0|SWEEP_EVENTS[2*i+1],color=1&e;if(i<n-1&&e>>1==SWEEP_EVENTS[2*i+3]>>1&&(color=2,i+=1),e<0){for(var id=-(e>>1)-1,j=0;j<commonActive;++j){var retval=visit(COMMON_SWEEP_QUEUE[j],id);if(void 0!==retval)return retval}if(0!==color)for(var j=0;j<redActive;++j){var retval=visit(RED_SWEEP_QUEUE[j],id);if(void 0!==retval)return retval}if(1!==color)for(var j=0;j<blueActive;++j){var retval=visit(BLUE_SWEEP_QUEUE[j],id);if(void 0!==retval)return retval}0===color?sqPush(RED_SWEEP_QUEUE,RED_SWEEP_INDEX,redActive++,id):1===color?sqPush(BLUE_SWEEP_QUEUE,BLUE_SWEEP_INDEX,blueActive++,id):2===color&&sqPush(COMMON_SWEEP_QUEUE,COMMON_SWEEP_INDEX,commonActive++,id)}else{var id=(e>>1)-1;0===color?sqPop(RED_SWEEP_QUEUE,RED_SWEEP_INDEX,redActive--,id):1===color?sqPop(BLUE_SWEEP_QUEUE,BLUE_SWEEP_INDEX,blueActive--,id):2===color&&sqPop(COMMON_SWEEP_QUEUE,COMMON_SWEEP_INDEX,commonActive--,id)}}},scanBipartite:function scanBipartite(d,axis,visit,flip,redStart,redEnd,red,redIndex,blueStart,blueEnd,blue,blueIndex){var ptr=0,elemSize=2*d,istart=axis,iend=axis+d,redShift=1,blueShift=1;flip?blueShift=BLUE_FLAG:redShift=BLUE_FLAG;for(var i=redStart;i<redEnd;++i){var idx=i+redShift,redOffset=elemSize*i;SWEEP_EVENTS[ptr++]=red[redOffset+istart],SWEEP_EVENTS[ptr++]=-idx,SWEEP_EVENTS[ptr++]=red[redOffset+iend],SWEEP_EVENTS[ptr++]=idx}for(var i=blueStart;i<blueEnd;++i){var idx=i+blueShift,blueOffset=elemSize*i;SWEEP_EVENTS[ptr++]=blue[blueOffset+istart],SWEEP_EVENTS[ptr++]=-idx}var n=ptr>>>1;_$wrapper_81(SWEEP_EVENTS,n);for(var redActive=0,i=0;i<n;++i){var e=0|SWEEP_EVENTS[2*i+1];if(e<0){var idx=-e,isRed=!1;if(idx>=BLUE_FLAG?(isRed=!flip,idx-=BLUE_FLAG):(isRed=!!flip,idx-=1),isRed)sqPush(RED_SWEEP_QUEUE,RED_SWEEP_INDEX,redActive++,idx);else{var blueId=blueIndex[idx],bluePtr=elemSize*idx,b0=blue[bluePtr+axis+1],b1=blue[bluePtr+axis+1+d];red_loop:for(var j=0;j<redActive;++j){var oidx=RED_SWEEP_QUEUE[j],redPtr=elemSize*oidx;if(!(b1<red[redPtr+axis+1]||red[redPtr+axis+1+d]<b0)){for(var k=axis+2;k<d;++k)if(blue[bluePtr+k+d]<red[redPtr+k]||red[redPtr+k+d]<blue[bluePtr+k])continue red_loop;var retval,redId=redIndex[oidx];if(void 0!==(retval=flip?visit(blueId,redId):visit(redId,blueId)))return retval}}}}else sqPop(RED_SWEEP_QUEUE,RED_SWEEP_INDEX,redActive--,e-redShift)}},scanComplete:function scanComplete(d,axis,visit,redStart,redEnd,red,redIndex,blueStart,blueEnd,blue,blueIndex){for(var ptr=0,elemSize=2*d,istart=axis,iend=axis+d,i=redStart;i<redEnd;++i){var idx=i+BLUE_FLAG,redOffset=elemSize*i;SWEEP_EVENTS[ptr++]=red[redOffset+istart],SWEEP_EVENTS[ptr++]=-idx,SWEEP_EVENTS[ptr++]=red[redOffset+iend],SWEEP_EVENTS[ptr++]=idx}for(var i=blueStart;i<blueEnd;++i){var idx=i+1,blueOffset=elemSize*i;SWEEP_EVENTS[ptr++]=blue[blueOffset+istart],SWEEP_EVENTS[ptr++]=-idx}var n=ptr>>>1;_$wrapper_81(SWEEP_EVENTS,n);for(var redActive=0,i=0;i<n;++i){var e=0|SWEEP_EVENTS[2*i+1];if(e<0){var idx=-e;if(idx>=BLUE_FLAG)RED_SWEEP_QUEUE[redActive++]=idx-BLUE_FLAG;else{var blueId=blueIndex[idx-=1],bluePtr=elemSize*idx,b0=blue[bluePtr+axis+1],b1=blue[bluePtr+axis+1+d];red_loop:for(var j=0;j<redActive;++j){var oidx=RED_SWEEP_QUEUE[j],redId=redIndex[oidx];if(redId===blueId)break;var redPtr=elemSize*oidx;if(!(b1<red[redPtr+axis+1]||red[redPtr+axis+1+d]<b0)){for(var k=axis+2;k<d;++k)if(blue[bluePtr+k+d]<red[redPtr+k]||red[redPtr+k+d]<blue[bluePtr+k])continue red_loop;var retval=visit(redId,blueId);if(void 0!==retval)return retval}}}}else{for(var idx=e-BLUE_FLAG,j=redActive-1;j>=0;--j)if(RED_SWEEP_QUEUE[j]===idx){for(var k=j+1;k<redActive;++k)RED_SWEEP_QUEUE[k-1]=RED_SWEEP_QUEUE[k];break}--redActive}}}},BLUE_FLAG=1<<28,RED_SWEEP_QUEUE=_$pool_360.mallocInt32(1024),RED_SWEEP_INDEX=_$pool_360.mallocInt32(1024),BLUE_SWEEP_QUEUE=_$pool_360.mallocInt32(1024),BLUE_SWEEP_INDEX=_$pool_360.mallocInt32(1024),COMMON_SWEEP_QUEUE=_$pool_360.mallocInt32(1024),COMMON_SWEEP_INDEX=_$pool_360.mallocInt32(1024),SWEEP_EVENTS=_$pool_360.mallocDouble(8192);function sqPop(queue,index,count,item){var idx=index[item],top=queue[count-1];queue[idx]=top,index[top]=idx}function sqPush(queue,index,count,item){queue[count]=item,index[item]=count}var _$boxIntersectIter_78=function boxIntersectIter(d,visit,initFull,xSize,xBoxes,xIndex,ySize,yBoxes,yIndex){!function iterInit(d,count){var levels=8*_$twiddle_72.log2(count+1)*(d+1)|0,maxInts=_$twiddle_72.nextPow2(IFRAME_SIZE*levels);BOX_ISTACK.length<maxInts&&(_$pool_360.free(BOX_ISTACK),BOX_ISTACK=_$pool_360.mallocInt32(maxInts));var maxDoubles=_$twiddle_72.nextPow2(DFRAME_SIZE*levels);BOX_DSTACK<maxDoubles&&(_$pool_360.free(BOX_DSTACK),BOX_DSTACK=_$pool_360.mallocDouble(maxDoubles))}(d,xSize+ySize);var retval,top=0,elemSize=2*d;iterPush(top++,0,0,xSize,0,ySize,initFull?16:0,-1/0,1/0),initFull||iterPush(top++,0,0,ySize,0,xSize,1,-1/0,1/0);for(;top>0;){var iptr=(top-=1)*IFRAME_SIZE,axis=BOX_ISTACK[iptr],redStart=BOX_ISTACK[iptr+1],redEnd=BOX_ISTACK[iptr+2],blueStart=BOX_ISTACK[iptr+3],blueEnd=BOX_ISTACK[iptr+4],state=BOX_ISTACK[iptr+5],dptr=top*DFRAME_SIZE,lo=BOX_DSTACK[dptr],hi=BOX_DSTACK[dptr+1],flip=1&state,full=!!(16&state),red=xBoxes,redIndex=xIndex,blue=yBoxes,blueIndex=yIndex;if(flip&&(red=yBoxes,redIndex=yIndex,blue=xBoxes,blueIndex=xIndex),!(2&state&&(redEnd=__partitionStartLessThan_78(d,axis,redStart,redEnd,red,redIndex,hi),redStart>=redEnd)||4&state&&(redStart=partitionEndLessThanEqual(d,axis,redStart,redEnd,red,redIndex,lo))>=redEnd)){var redCount=redEnd-redStart,blueCount=blueEnd-blueStart;if(full){if(d*redCount*(redCount+blueCount)<SCAN_COMPLETE_CUTOFF){if(void 0!==(retval=_$sweep_82.scanComplete(d,axis,visit,redStart,redEnd,red,redIndex,blueStart,blueEnd,blue,blueIndex)))return retval;continue}}else{if(d*Math.min(redCount,blueCount)<BRUTE_FORCE_CUTOFF){if(void 0!==(retval=bruteForcePartial(d,axis,visit,flip,redStart,redEnd,red,redIndex,blueStart,blueEnd,blue,blueIndex)))return retval;continue}if(d*redCount*blueCount<SCAN_CUTOFF){if(void 0!==(retval=_$sweep_82.scanBipartite(d,axis,visit,flip,redStart,redEnd,red,redIndex,blueStart,blueEnd,blue,blueIndex)))return retval;continue}}var red0=partitionInteriorContainsInterval(d,axis,redStart,redEnd,red,redIndex,lo,hi);if(redStart<red0)if(d*(red0-redStart)<BRUTE_FORCE_CUTOFF){if(void 0!==(retval=bruteForceFull(d,axis+1,visit,redStart,red0,red,redIndex,blueStart,blueEnd,blue,blueIndex)))return retval}else if(axis===d-2){if(void 0!==(retval=flip?_$sweep_82.sweepBipartite(d,visit,blueStart,blueEnd,blue,blueIndex,redStart,red0,red,redIndex):_$sweep_82.sweepBipartite(d,visit,redStart,red0,red,redIndex,blueStart,blueEnd,blue,blueIndex)))return retval}else iterPush(top++,axis+1,redStart,red0,blueStart,blueEnd,flip,-1/0,1/0),iterPush(top++,axis+1,blueStart,blueEnd,redStart,red0,1^flip,-1/0,1/0);if(red0<redEnd){var blue0=_$findMedian_79(d,axis,blueStart,blueEnd,blue,blueIndex),mid=blue[elemSize*blue0+axis],blue1=partitionStartEqual(d,axis,blue0,blueEnd,blue,blueIndex,mid);if(blue1<blueEnd&&iterPush(top++,axis,red0,redEnd,blue1,blueEnd,(4|flip)+(full?16:0),mid,hi),blueStart<blue0&&iterPush(top++,axis,red0,redEnd,blueStart,blue0,(2|flip)+(full?16:0),lo,mid),blue0+1===blue1){if(void 0!==(retval=full?onePointFull(d,axis,visit,red0,redEnd,red,redIndex,blue0,blue,blueIndex[blue0]):onePointPartial(d,axis,visit,flip,red0,redEnd,red,redIndex,blue0,blue,blueIndex[blue0])))return retval}else if(blue0<blue1){var red1;if(full){if(red1=partitionContainsPoint(d,axis,red0,redEnd,red,redIndex,mid),red0<red1){var redX=partitionStartEqual(d,axis,red0,red1,red,redIndex,mid);if(axis===d-2){if(red0<redX&&void 0!==(retval=_$sweep_82.sweepComplete(d,visit,red0,redX,red,redIndex,blue0,blue1,blue,blueIndex)))return retval;if(redX<red1&&void 0!==(retval=_$sweep_82.sweepBipartite(d,visit,redX,red1,red,redIndex,blue0,blue1,blue,blueIndex)))return retval}else red0<redX&&iterPush(top++,axis+1,red0,redX,blue0,blue1,16,-1/0,1/0),redX<red1&&(iterPush(top++,axis+1,redX,red1,blue0,blue1,0,-1/0,1/0),iterPush(top++,axis+1,blue0,blue1,redX,red1,1,-1/0,1/0))}}else red1=flip?partitionContainsPointProper(d,axis,red0,redEnd,red,redIndex,mid):partitionContainsPoint(d,axis,red0,redEnd,red,redIndex,mid),red0<red1&&(axis===d-2?retval=flip?_$sweep_82.sweepBipartite(d,visit,blue0,blue1,blue,blueIndex,red0,red1,red,redIndex):_$sweep_82.sweepBipartite(d,visit,red0,red1,red,redIndex,blue0,blue1,blue,blueIndex):(iterPush(top++,axis+1,red0,red1,blue0,blue1,flip,-1/0,1/0),iterPush(top++,axis+1,blue0,blue1,red0,red1,1^flip,-1/0,1/0)))}}}}},bruteForcePartial=_$brute_77.partial,bruteForceFull=_$brute_77.full,BRUTE_FORCE_CUTOFF=128,SCAN_CUTOFF=1<<22,SCAN_COMPLETE_CUTOFF=1<<22,partitionInteriorContainsInterval=_$genPartition_80("!(lo>=p0)&&!(p1>=hi)",["p0","p1"]),partitionStartEqual=_$genPartition_80("lo===p0",["p0"]),__partitionStartLessThan_78=_$genPartition_80("lo<p0",["p0"]),partitionEndLessThanEqual=_$genPartition_80("hi<=p0",["p0"]),partitionContainsPoint=_$genPartition_80("lo<=p0&&p0<=hi",["p0"]),partitionContainsPointProper=_$genPartition_80("lo<p0&&p0<=hi",["p0"]),IFRAME_SIZE=6,DFRAME_SIZE=2,BOX_ISTACK=_$pool_360.mallocInt32(1024),BOX_DSTACK=_$pool_360.mallocDouble(1024);function iterPush(ptr,axis,redStart,redEnd,blueStart,blueEnd,state,lo,hi){var iptr=IFRAME_SIZE*ptr;BOX_ISTACK[iptr]=axis,BOX_ISTACK[iptr+1]=redStart,BOX_ISTACK[iptr+2]=redEnd,BOX_ISTACK[iptr+3]=blueStart,BOX_ISTACK[iptr+4]=blueEnd,BOX_ISTACK[iptr+5]=state;var dptr=DFRAME_SIZE*ptr;BOX_DSTACK[dptr]=lo,BOX_DSTACK[dptr+1]=hi}function onePointPartial(d,axis,visit,flip,redStart,redEnd,red,redIndex,blueOffset,blue,blueId){var elemSize=2*d,bluePtr=blueOffset*elemSize,blueX=blue[bluePtr+axis];red_loop:for(var i=redStart,redPtr=redStart*elemSize;i<redEnd;++i,redPtr+=elemSize){var r0=red[redPtr+axis],r1=red[redPtr+axis+d];if(!(blueX<r0||r1<blueX)&&(!flip||blueX!==r0)){for(var retval,redId=redIndex[i],j=axis+1;j<d;++j){r0=red[redPtr+j],r1=red[redPtr+j+d];var b0=blue[bluePtr+j],b1=blue[bluePtr+j+d];if(r1<b0||b1<r0)continue red_loop}if(void 0!==(retval=flip?visit(blueId,redId):visit(redId,blueId)))return retval}}}function onePointFull(d,axis,visit,redStart,redEnd,red,redIndex,blueOffset,blue,blueId){var elemSize=2*d,bluePtr=blueOffset*elemSize,blueX=blue[bluePtr+axis];red_loop:for(var i=redStart,redPtr=redStart*elemSize;i<redEnd;++i,redPtr+=elemSize){var redId=redIndex[i];if(redId!==blueId){var r0=red[redPtr+axis],r1=red[redPtr+axis+d];if(!(blueX<r0||r1<blueX)){for(var j=axis+1;j<d;++j){r0=red[redPtr+j],r1=red[redPtr+j+d];var b0=blue[bluePtr+j],b1=blue[bluePtr+j+d];if(r1<b0||b1<r0)continue red_loop}var retval=visit(redId,blueId);if(void 0!==retval)return retval}}}}var RESULT,_$boxIntersectWrapper_76=function boxIntersectWrapper(arg0,arg1,arg2){switch(arguments.length){case 1:return function intersectFullArray(x){return RESULT=[],boxIntersect(x,x,appendItem,!0),RESULT}(arg0);case 2:return"function"==typeof arg1?boxIntersect(arg0,arg0,arg1,!0):function intersectBipartiteArray(x,y){return RESULT=[],boxIntersect(x,y,appendItem,!1),RESULT}(arg0,arg1);case 3:return boxIntersect(arg0,arg1,arg2,!1);default:throw new Error("box-intersect: Invalid arguments")}};function boxEmpty(d,box){for(var j=0;j<d;++j)if(!(box[j]<=box[j+d]))return!0;return!1}function convertBoxes(boxes,d,data,ids){for(var ptr=0,count=0,i=0,n=boxes.length;i<n;++i){var b=boxes[i];if(!boxEmpty(d,b)){for(var j=0;j<2*d;++j)data[ptr++]=b[j];ids[count++]=i}}return count}function boxIntersect(red,blue,visit,full){var n=red.length,m=blue.length;if(!(n<=0||m<=0)){var d=red[0].length>>>1;if(!(d<=0)){var retval,redList=_$pool_360.mallocDouble(2*d*n),redIds=_$pool_360.mallocInt32(n);if((n=convertBoxes(red,d,redList,redIds))>0){if(1===d&&full)_$sweep_82.init(n),retval=_$sweep_82.sweepComplete(d,visit,0,n,redList,redIds,0,n,redList,redIds);else{var blueList=_$pool_360.mallocDouble(2*d*m),blueIds=_$pool_360.mallocInt32(m);(m=convertBoxes(blue,d,blueList,blueIds))>0&&(_$sweep_82.init(n+m),retval=1===d?_$sweep_82.sweepBipartite(d,visit,0,n,redList,redIds,0,m,blueList,blueIds):_$boxIntersectIter_78(d,visit,full,n,redList,redIds,m,blueList,blueIds),_$pool_360.free(blueList),_$pool_360.free(blueIds))}_$pool_360.free(redList),_$pool_360.free(redIds)}return retval}}}function appendItem(i,j){RESULT.push([i,j])}var _$mul_67=function mul(a,b){return _$rationalize_65(a[0].mul(b[0]),a[1].mul(b[1]))};var _$sign_68=function __sign_68(x){return _$sign_60(x[0])*_$sign_60(x[1])};var _$sub_69=function sub(a,b){return _$rationalize_65(a[0].mul(b[1]).sub(a[1].mul(b[0])),a[1].mul(b[1]))};var _$add_55=function add(a,b){return _$rationalize_65(a[0].mul(b[1]).add(b[0].mul(a[1])),a[1].mul(b[1]))};var _$add_306=function __add_306(a,b){for(var n=a.length,r=new Array(n),i=0;i<n;++i)r[i]=_$add_55(a[i],b[i]);return r};var _$muls_308=function muls(a,x){for(var s=_$makeRational_58(x),n=a.length,r=new Array(n),i=0;i<n;++i)r[i]=_$mul_67(a[i],s);return r};var _$sub_309=function __sub_309(a,b){for(var n=a.length,r=new Array(n),i=0;i<n;++i)r[i]=_$sub_69(a[i],b[i]);return r};var _$solveIntersection_96=function solveIntersection(a,b,c,d){var ba=_$sub_309(b,a),dc=_$sub_309(d,c),baXdc=ratPerp(ba,dc);if(0===_$sign_68(baXdc))return null;var ac=_$sub_309(a,c),dcXac=ratPerp(dc,ac),t=_$div_57(dcXac,baXdc),s=_$muls_308(ba,t);return _$add_306(a,s)};function ratPerp(a,b){return _$sub_69(_$mul_67(a[0],b[1]),_$mul_67(a[1],b[0]))}var SMALLEST_DENORM=Math.pow(2,-1074),UINT_MAX=-1>>>0,_$nextafter_278=function nextafter(x,y){if(isNaN(x)||isNaN(y))return NaN;if(x===y)return x;if(0===x)return y<0?-SMALLEST_DENORM:SMALLEST_DENORM;var hi=_$double_130.hi(x),lo=_$double_130.lo(x);y>x==x>0?lo===UINT_MAX?(hi+=1,lo=0):lo+=1:0===lo?(lo=UINT_MAX,hi-=1):lo-=1;return _$double_130.pack(lo,hi)};var _$float2rat_307=function float2rat(v){for(var result=new Array(v.length),i=0;i<v.length;++i)result[i]=_$makeRational_58(v[i]);return result};var _$segmentsIntersect_326=function __segmentsIntersect_326(a0,a1,b0,b1){var x0=__orient_326(a0,b0,b1),y0=__orient_326(a1,b0,b1);if(x0>0&&y0>0||x0<0&&y0<0)return!1;var x1=__orient_326(b0,a0,a1),y1=__orient_326(b1,a0,a1);if(x1>0&&y1>0||x1<0&&y1<0)return!1;if(0===x0&&0===y0&&0===x1&&0===y1)return function checkCollinear(a0,a1,b0,b1){for(var d=0;d<2;++d){var x0=a0[d],y0=a1[d],l0=Math.min(x0,y0),h0=Math.max(x0,y0),x1=b0[d],y1=b1[d],l1=Math.min(x1,y1),h1=Math.max(x1,y1);if(h1<l0||h0<l1)return!1}return!0}(a0,a1,b0,b1);return!0},__orient_326=_$orientation_323[3];var _$UnionFind_361=UnionFind;function UnionFind(count){this.roots=new Array(count),this.ranks=new Array(count);for(var i=0;i<count;++i)this.roots[i]=i,this.ranks[i]=0}var __proto_361=UnionFind.prototype;Object.defineProperty(__proto_361,"length",{get:function(){return this.roots.length}}),__proto_361.makeSet=function(){var n=this.roots.length;return this.roots.push(n),this.ranks.push(0),n},__proto_361.find=function(x){for(var x0=x,roots=this.roots;roots[x]!==x;)x=roots[x];for(;roots[x0]!==x;){var y=roots[x0];roots[x0]=x,x0=y}return x},__proto_361.link=function(x,y){var xr=this.find(x),yr=this.find(y);if(xr!==yr){var ranks=this.ranks,roots=this.roots,xd=ranks[xr],yd=ranks[yr];xd<yd?roots[xr]=yr:yd<xd?roots[yr]=xr:(roots[yr]=xr,++ranks[xr])}};var _$cleanPSLG_95=function cleanPSLG(points,edges,colors){var prevEdges;if(colors){prevEdges=edges;for(var augEdges=new Array(edges.length),i=0;i<edges.length;++i){var e=edges[i];augEdges[i]=[e[0],e[1],colors[i]]}edges=augEdges}var modified=function preRound(points,edges,useColor){var labels=dedupPoints(points,[],boundPoints(points));return dedupEdges(edges,labels,useColor),!!labels}(points,edges,!!colors);for(;snapRound(points,edges,!!colors);)modified=!0;if(colors&&modified){prevEdges.length=0,colors.length=0;for(var i=0;i<edges.length;++i){var e=edges[i];prevEdges.push([e[0],e[1]]),colors.push(e[2])}}return modified};function boundRat(r){var f=_$roundRat_70(r);return[_$nextafter_278(f,-1/0),_$nextafter_278(f,1/0)]}function boundPoints(points){for(var bounds=new Array(points.length),i=0;i<points.length;++i){var p=points[i];bounds[i]=[_$nextafter_278(p[0],-1/0),_$nextafter_278(p[1],-1/0),_$nextafter_278(p[0],1/0),_$nextafter_278(p[1],1/0)]}return bounds}function dedupPoints(floatPoints,ratPoints,floatBounds){for(var numPoints=ratPoints.length,uf=new _$UnionFind_361(numPoints),bounds=[],i=0;i<ratPoints.length;++i){var p=ratPoints[i],xb=boundRat(p[0]),yb=boundRat(p[1]);bounds.push([_$nextafter_278(xb[0],-1/0),_$nextafter_278(yb[0],-1/0),_$nextafter_278(xb[1],1/0),_$nextafter_278(yb[1],1/0)])}_$boxIntersectWrapper_76(bounds,function(i,j){uf.link(i,j)});var noDupes=!0,labels=new Array(numPoints);for(i=0;i<numPoints;++i){(j=uf.find(i))!==i&&(noDupes=!1,floatPoints[j]=[Math.min(floatPoints[i][0],floatPoints[j][0]),Math.min(floatPoints[i][1],floatPoints[j][1])])}if(noDupes)return null;var ptr=0;for(i=0;i<numPoints;++i){var j;(j=uf.find(i))===i?(labels[i]=ptr,floatPoints[ptr++]=floatPoints[i]):labels[i]=-1}floatPoints.length=ptr;for(i=0;i<numPoints;++i)labels[i]<0&&(labels[i]=labels[uf.find(i)]);return labels}function compareLex2(a,b){return a[0]-b[0]||a[1]-b[1]}function compareLex3(a,b){var d=a[0]-b[0]||a[1]-b[1];return d||(a[2]<b[2]?-1:a[2]>b[2]?1:0)}function dedupEdges(edges,labels,useColor){if(0!==edges.length){if(labels)for(var i=0;i<edges.length;++i){var a=labels[(e=edges[i])[0]],b=labels[e[1]];e[0]=Math.min(a,b),e[1]=Math.max(a,b)}else for(i=0;i<edges.length;++i){var e;a=(e=edges[i])[0],b=e[1];e[0]=Math.min(a,b),e[1]=Math.max(a,b)}useColor?edges.sort(compareLex3):edges.sort(compareLex2);var ptr=1;for(i=1;i<edges.length;++i){var prev=edges[i-1],next=edges[i];(next[0]!==prev[0]||next[1]!==prev[1]||useColor&&next[2]!==prev[2])&&(edges[ptr++]=next)}edges.length=ptr}}function snapRound(points,edges,useColor){var edgeBounds=function boundEdges(points,edges){for(var bounds=new Array(edges.length),i=0;i<edges.length;++i){var e=edges[i],a=points[e[0]],b=points[e[1]];bounds[i]=[_$nextafter_278(Math.min(a[0],b[0]),-1/0),_$nextafter_278(Math.min(a[1],b[1]),-1/0),_$nextafter_278(Math.max(a[0],b[0]),1/0),_$nextafter_278(Math.max(a[1],b[1]),1/0)]}return bounds}(points,edges),crossings=function getCrossings(points,edges,edgeBounds){var result=[];return _$boxIntersectWrapper_76(edgeBounds,function(i,j){var e=edges[i],f=edges[j];if(e[0]!==f[0]&&e[0]!==f[1]&&e[1]!==f[0]&&e[1]!==f[1]){var a=points[e[0]],b=points[e[1]],c=points[f[0]],d=points[f[1]];_$segmentsIntersect_326(a,b,c,d)&&result.push([i,j])}}),result}(points,edges,edgeBounds),vertBounds=boundPoints(points),tjunctions=function getTJunctions(points,edges,edgeBounds,vertBounds){var result=[];return _$boxIntersectWrapper_76(edgeBounds,vertBounds,function(i,v){var e=edges[i];if(e[0]!==v&&e[1]!==v){var p=points[v],a=points[e[0]],b=points[e[1]];_$segmentsIntersect_326(a,b,p,p)&&result.push([i,v])}}),result}(points,edges,edgeBounds,vertBounds),labels=dedupPoints(points,function cutEdges(floatPoints,edges,crossings,junctions,useColor){var i,e,ratPoints=floatPoints.map(function(p){return[_$makeRational_58(p[0]),_$makeRational_58(p[1])]});for(i=0;i<crossings.length;++i){var crossing=crossings[i];e=crossing[0];var f=crossing[1],ee=edges[e],ef=edges[f],x=_$solveIntersection_96(_$float2rat_307(floatPoints[ee[0]]),_$float2rat_307(floatPoints[ee[1]]),_$float2rat_307(floatPoints[ef[0]]),_$float2rat_307(floatPoints[ef[1]]));if(x){var idx=floatPoints.length;floatPoints.push([_$roundRat_70(x[0]),_$roundRat_70(x[1])]),ratPoints.push(x),junctions.push([e,idx],[f,idx])}}for(junctions.sort(function(a,b){if(a[0]!==b[0])return a[0]-b[0];var u=ratPoints[a[1]],v=ratPoints[b[1]];return _$cmp_56(u[0],v[0])||_$cmp_56(u[1],v[1])}),i=junctions.length-1;i>=0;--i){var edge=edges[e=(junction=junctions[i])[0]],s=edge[0],t=edge[1],a=floatPoints[s],b=floatPoints[t];if((a[0]-b[0]||a[1]-b[1])<0){var tmp=s;s=t,t=tmp}edge[0]=s;var color,last=edge[1]=junction[1];for(useColor&&(color=edge[2]);i>0&&junctions[i-1][0]===e;){var junction,next=(junction=junctions[--i])[1];useColor?edges.push([last,next,color]):edges.push([last,next]),last=next}useColor?edges.push([last,t,color]):edges.push([last,t])}return ratPoints}(points,edges,crossings,tjunctions,useColor));return dedupEdges(edges,labels,useColor),!!labels||(crossings.length>0||tjunctions.length>0)}var _$edgeToAdjacency_135=function edgeToAdjacency(edges,numVertices){var numEdges=edges.length;if("number"!=typeof numVertices){numVertices=0;for(var i=0;i<numEdges;++i){var e=edges[i];numVertices=Math.max(numVertices,e[0],e[1])}numVertices=1+(0|numVertices)}numVertices|=0;for(var adj=new Array(numVertices),i=0;i<numVertices;++i)adj[i]=[];for(var i=0;i<numEdges;++i){var e=edges[i];adj[e[0]].push(e[1]),adj[e[1]].push(e[0])}for(var j=0;j<numVertices;++j)_$unique_362(adj[j],function(a,b){return a-b});return adj};var _$robustProduct_324=function robustProduct(a,b){if(1===a.length)return _$scaleLinearExpansion_325(b,a[0]);if(1===b.length)return _$scaleLinearExpansion_325(a,b[0]);if(0===a.length||0===b.length)return[0];var r=[0];if(a.length<b.length)for(var i=0;i<a.length;++i)r=_$linearExpansionSum_328(r,_$scaleLinearExpansion_325(b,a[i]));else for(var i=0;i<b.length;++i)r=_$linearExpansionSum_328(r,_$scaleLinearExpansion_325(a,b[i]));return r};var _$signum_329=function signum(x){return x<0?-1:x>0?1:0},_$compareAngle_106=function compareAngle(a,b,c,d){var bcd=_$orientation_323(b,c,d);if(0===bcd){var sabc=_$signum_329(_$orientation_323(a,b,c)),sabd=_$signum_329(_$orientation_323(a,b,d));if(sabc===sabd){if(0===sabc){var ic=testInterior(a,b,c),id=testInterior(a,b,d);return ic===id?0:ic?1:-1}return 0}return 0===sabd?sabc>0?-1:testInterior(a,b,d)?-1:1:0===sabc?sabd>0?1:testInterior(a,b,c)?1:-1:_$signum_329(sabd-sabc)}var abc=_$orientation_323(a,b,c);if(abc>0)return bcd>0&&_$orientation_323(a,b,d)>0?1:-1;if(abc<0)return bcd>0||_$orientation_323(a,b,d)>0?1:-1;var abd=_$orientation_323(a,b,d);return abd>0?1:testInterior(a,b,c)?1:-1};function testInterior(a,b,c){var x0=_$fastTwoSum_359(a[0],-b[0]),y0=_$fastTwoSum_359(a[1],-b[1]),x1=_$fastTwoSum_359(c[0],-b[0]),y1=_$fastTwoSum_359(c[1],-b[1]),d=_$linearExpansionSum_328(_$robustProduct_324(x0,x1),_$robustProduct_324(y0,y1));return d[d.length-1]>=0}var _$planarDual_291=function planarDual(cells,positions){for(var numVertices=0|positions.length,numEdges=cells.length,adj=[new Array(numVertices),new Array(numVertices)],i=0;i<numVertices;++i)adj[0][i]=[],adj[1][i]=[];for(var i=0;i<numEdges;++i){var c=cells[i];adj[0][c[0]].push(c),adj[1][c[1]].push(c)}for(var cycles=[],i=0;i<numVertices;++i)adj[0][i].length+adj[1][i].length===0&&cycles.push([i]);function cut(c,i){var a=adj[i][c[i]];a.splice(a.indexOf(c),1)}function next(a,b,noCut){for(var nextCell,nextVertex,nextDir,i=0;i<2;++i)if(adj[i][b].length>0){nextCell=adj[i][b][0],nextDir=i;break}nextVertex=nextCell[1^nextDir];for(var dir=0;dir<2;++dir)for(var nbhd=adj[dir][b],k=0;k<nbhd.length;++k){var e=nbhd[k],p=e[1^dir],cmp=_$compareAngle_106(positions[a],positions[b],positions[nextVertex],positions[p]);cmp>0&&(nextCell=e,nextVertex=p,nextDir=dir)}return noCut?nextVertex:(nextCell&&cut(nextCell,nextDir),nextVertex)}function extractCycle(v,dir){var e0=adj[dir][v][0],cycle=[v];cut(e0,dir);for(var u=e0[1^dir];;){for(;u!==v;)cycle.push(u),u=next(cycle[cycle.length-2],u,!1);if(adj[0][v].length+adj[1][v].length===0)break;var a=cycle[cycle.length-1],b=v,c=cycle[1],d=next(a,b,!0);if(_$compareAngle_106(positions[a],positions[b],positions[c],positions[d])<0)break;cycle.push(v),u=next(a,b)}return cycle}function shouldGlue(pcycle,ncycle){return ncycle[1]===ncycle[ncycle.length-1]}for(var i=0;i<numVertices;++i)for(var j=0;j<2;++j){for(var pcycle=[];adj[j][i].length>0;){adj[0][i].length;var ncycle=extractCycle(i,j);shouldGlue(pcycle,ncycle)?pcycle.push.apply(pcycle,ncycle):(pcycle.length>0&&cycles.push(pcycle),pcycle=ncycle)}pcycle.length>0&&cycles.push(pcycle)}return cycles};var _$trimLeaves_292=function trimLeaves(edges,positions){for(var adj=_$edgeToAdjacency_135(edges,positions.length),live=new Array(positions.length),nbhd=new Array(positions.length),dead=[],i=0;i<positions.length;++i){var count=adj[i].length;nbhd[i]=count,live[i]=!0,count<=1&&dead.push(i)}for(;dead.length>0;){var v=dead.pop();live[v]=!1;for(var n=adj[v],i=0;i<n.length;++i){var u=n[i];0==--nbhd[u]&&dead.push(u)}}for(var newIndex=new Array(positions.length),npositions=[],i=0;i<positions.length;++i)if(live[i]){var v=npositions.length;newIndex[i]=v,npositions.push(positions[i])}else newIndex[i]=-1;for(var nedges=[],i=0;i<edges.length;++i){var e=edges[i];live[e[0]]&&live[e[1]]&&nedges.push([newIndex[e[0]],newIndex[e[1]]])}return[nedges,npositions]};function __compileSearch_71(funcName,predicate,reversed,extraArgs,useNdarray,earlyOut){var code=["function ",funcName,"(a,l,h,",extraArgs.join(","),"){",earlyOut?"":"var i=",reversed?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",useNdarray?".get(m)":"[m]"];return earlyOut?predicate.indexOf("c")<0?code.push(";if(x===y){return m}else if(x<=y){"):code.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):code.push(";if(",predicate,"){i=m;"),reversed?code.push("l=m+1}else{h=m-1}"):code.push("h=m-1}else{l=m+1}"),code.push("}"),earlyOut?code.push("return -1};"):code.push("return i};"),code.join("")}function __compileBoundsSearch_71(predicate,reversed,suffix,earlyOut){return new Function([__compileSearch_71("A","x"+predicate+"y",reversed,["y"],!1,earlyOut),__compileSearch_71("B","x"+predicate+"y",reversed,["y"],!0,earlyOut),__compileSearch_71("P","c(x,y)"+predicate+"0",reversed,["y","c"],!1,earlyOut),__compileSearch_71("Q","c(x,y)"+predicate+"0",reversed,["y","c"],!0,earlyOut),"function dispatchBsearch",suffix,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",suffix].join(""))()}var _$searchBounds_71={ge:__compileBoundsSearch_71(">=",!1,"GE"),gt:__compileBoundsSearch_71(">",!1,"GT"),lt:__compileBoundsSearch_71("<",!0,"LT"),le:__compileBoundsSearch_71("<=",!0,"LE"),eq:__compileBoundsSearch_71("-",!0,"EQ",!0)},NOT_FOUND=0,SUCCESS=1,_$createWrapper_243=function createWrapper(intervals){if(!intervals||0===intervals.length)return new IntervalTree(null);return new IntervalTree(createIntervalTree(intervals))};function IntervalTreeNode(mid,left,right,leftPoints,rightPoints){this.mid=mid,this.left=left,this.right=right,this.leftPoints=leftPoints,this.rightPoints=rightPoints,this.count=(left?left.count:0)+(right?right.count:0)+leftPoints.length}var __proto_243=IntervalTreeNode.prototype;function copy(a,b){a.mid=b.mid,a.left=b.left,a.right=b.right,a.leftPoints=b.leftPoints,a.rightPoints=b.rightPoints,a.count=b.count}function rebuild(node,intervals){var ntree=createIntervalTree(intervals);node.mid=ntree.mid,node.left=ntree.left,node.right=ntree.right,node.leftPoints=ntree.leftPoints,node.rightPoints=ntree.rightPoints,node.count=ntree.count}function rebuildWithInterval(node,interval){var intervals=node.intervals([]);intervals.push(interval),rebuild(node,intervals)}function rebuildWithoutInterval(node,interval){var intervals=node.intervals([]),idx=intervals.indexOf(interval);return idx<0?NOT_FOUND:(intervals.splice(idx,1),rebuild(node,intervals),SUCCESS)}function reportLeftRange(arr,hi,cb){for(var i=0;i<arr.length&&arr[i][0]<=hi;++i){var r=cb(arr[i]);if(r)return r}}function reportRightRange(arr,lo,cb){for(var i=arr.length-1;i>=0&&arr[i][1]>=lo;--i){var r=cb(arr[i]);if(r)return r}}function reportRange(arr,cb){for(var i=0;i<arr.length;++i){var r=cb(arr[i]);if(r)return r}}function compareNumbers(a,b){return a-b}function compareBegin(a,b){var d=a[0]-b[0];return d||a[1]-b[1]}function compareEnd(a,b){var d=a[1]-b[1];return d||a[0]-b[0]}function createIntervalTree(intervals){if(0===intervals.length)return null;for(var pts=[],i=0;i<intervals.length;++i)pts.push(intervals[i][0],intervals[i][1]);pts.sort(compareNumbers);var mid=pts[pts.length>>1],leftIntervals=[],rightIntervals=[],centerIntervals=[];for(i=0;i<intervals.length;++i){var s=intervals[i];s[1]<mid?leftIntervals.push(s):mid<s[0]?rightIntervals.push(s):centerIntervals.push(s)}var leftPoints=centerIntervals,rightPoints=centerIntervals.slice();return leftPoints.sort(compareBegin),rightPoints.sort(compareEnd),new IntervalTreeNode(mid,createIntervalTree(leftIntervals),createIntervalTree(rightIntervals),leftPoints,rightPoints)}function IntervalTree(root){this.root=root}__proto_243.intervals=function(result){return result.push.apply(result,this.leftPoints),this.left&&this.left.intervals(result),this.right&&this.right.intervals(result),result},__proto_243.insert=function(interval){var weight=this.count-this.leftPoints.length;if(this.count+=1,interval[1]<this.mid)this.left?4*(this.left.count+1)>3*(weight+1)?rebuildWithInterval(this,interval):this.left.insert(interval):this.left=createIntervalTree([interval]);else if(interval[0]>this.mid)this.right?4*(this.right.count+1)>3*(weight+1)?rebuildWithInterval(this,interval):this.right.insert(interval):this.right=createIntervalTree([interval]);else{var l=_$searchBounds_71.ge(this.leftPoints,interval,compareBegin),r=_$searchBounds_71.ge(this.rightPoints,interval,compareEnd);this.leftPoints.splice(l,0,interval),this.rightPoints.splice(r,0,interval)}},__proto_243.remove=function(interval){var weight=this.count-this.leftPoints;if(interval[1]<this.mid){return this.left?4*(this.right?this.right.count:0)>3*(weight-1)?rebuildWithoutInterval(this,interval):2===(r=this.left.remove(interval))?(this.left=null,this.count-=1,SUCCESS):(r===SUCCESS&&(this.count-=1),r):NOT_FOUND}else{if(!(interval[0]>this.mid)){if(1===this.count)return this.leftPoints[0]===interval?2:NOT_FOUND;if(1===this.leftPoints.length&&this.leftPoints[0]===interval){if(this.left&&this.right){for(var p=this,n=this.left;n.right;)p=n,n=n.right;if(p===this)n.right=this.right;else{var l=this.left;r=this.right;p.count-=n.count,p.right=n.left,n.left=l,n.right=r}copy(this,n),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?copy(this,this.left):copy(this,this.right);return SUCCESS}for(l=_$searchBounds_71.ge(this.leftPoints,interval,compareBegin);l<this.leftPoints.length&&this.leftPoints[l][0]===interval[0];++l)if(this.leftPoints[l]===interval){this.count-=1,this.leftPoints.splice(l,1);for(r=_$searchBounds_71.ge(this.rightPoints,interval,compareEnd);r<this.rightPoints.length&&this.rightPoints[r][1]===interval[1];++r)if(this.rightPoints[r]===interval)return this.rightPoints.splice(r,1),SUCCESS}return NOT_FOUND}return this.right?4*(this.left?this.left.count:0)>3*(weight-1)?rebuildWithoutInterval(this,interval):2===(r=this.right.remove(interval))?(this.right=null,this.count-=1,SUCCESS):(r===SUCCESS&&(this.count-=1),r):NOT_FOUND;var r}},__proto_243.queryPoint=function(x,cb){if(x<this.mid){if(this.left)if(r=this.left.queryPoint(x,cb))return r;return reportLeftRange(this.leftPoints,x,cb)}if(x>this.mid){var r;if(this.right)if(r=this.right.queryPoint(x,cb))return r;return reportRightRange(this.rightPoints,x,cb)}return reportRange(this.leftPoints,cb)},__proto_243.queryInterval=function(lo,hi,cb){var r;if(lo<this.mid&&this.left&&(r=this.left.queryInterval(lo,hi,cb)))return r;if(hi>this.mid&&this.right&&(r=this.right.queryInterval(lo,hi,cb)))return r;return hi<this.mid?reportLeftRange(this.leftPoints,hi,cb):lo>this.mid?reportRightRange(this.rightPoints,lo,cb):reportRange(this.leftPoints,cb)};var tproto=IntervalTree.prototype;tproto.insert=function(interval){this.root?this.root.insert(interval):this.root=new IntervalTreeNode(interval[0],null,null,[interval],[interval])},tproto.remove=function(interval){if(this.root){var r=this.root.remove(interval);return 2===r&&(this.root=null),r!==NOT_FOUND}return!1},tproto.queryPoint=function(p,cb){if(this.root)return this.root.queryPoint(p,cb)},tproto.queryInterval=function(lo,hi,cb){if(lo<=hi&&this.root)return this.root.queryInterval(lo,hi,cb)},Object.defineProperty(tproto,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(tproto,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});var _$createRBTree_142=function createRBTree(compare){return new RedBlackTree(compare||defaultCompare,null)},RED=0,BLACK=1;function RBNode(color,key,value,left,right,count){this._color=color,this.key=key,this.value=value,this.left=left,this.right=right,this._count=count}function cloneNode(node){return new RBNode(node._color,node.key,node.value,node.left,node.right,node._count)}function repaint(color,node){return new RBNode(color,node.key,node.value,node.left,node.right,node._count)}function recount(node){node._count=1+(node.left?node.left._count:0)+(node.right?node.right._count:0)}function RedBlackTree(compare,root){this._compare=compare,this.root=root}var __proto_142=RedBlackTree.prototype;function RedBlackTreeIterator(tree,stack){this.tree=tree,this._stack=stack}Object.defineProperty(__proto_142,"keys",{get:function(){var result=[];return this.forEach(function(k,v){result.push(k)}),result}}),Object.defineProperty(__proto_142,"values",{get:function(){var result=[];return this.forEach(function(k,v){result.push(v)}),result}}),Object.defineProperty(__proto_142,"length",{get:function(){return this.root?this.root._count:0}}),__proto_142.insert=function(key,value){for(var cmp=this._compare,n=this.root,n_stack=[],d_stack=[];n;){var d=cmp(key,n.key);n_stack.push(n),d_stack.push(d),n=d<=0?n.left:n.right}n_stack.push(new RBNode(RED,key,value,null,null,1));for(var s=n_stack.length-2;s>=0;--s){n=n_stack[s];d_stack[s]<=0?n_stack[s]=new RBNode(n._color,n.key,n.value,n_stack[s+1],n.right,n._count+1):n_stack[s]=new RBNode(n._color,n.key,n.value,n.left,n_stack[s+1],n._count+1)}for(s=n_stack.length-1;s>1;--s){var p=n_stack[s-1];n=n_stack[s];if(p._color===BLACK||n._color===BLACK)break;var pp=n_stack[s-2];if(pp.left===p)if(p.left===n){if(!(y=pp.right)||y._color!==RED){if(pp._color=RED,pp.left=p.right,p._color=BLACK,p.right=pp,n_stack[s-2]=p,n_stack[s-1]=n,recount(pp),recount(p),s>=3)(ppp=n_stack[s-3]).left===pp?ppp.left=p:ppp.right=p;break}p._color=BLACK,pp.right=repaint(BLACK,y),pp._color=RED,s-=1}else{if(!(y=pp.right)||y._color!==RED){if(p.right=n.left,pp._color=RED,pp.left=n.right,n._color=BLACK,n.left=p,n.right=pp,n_stack[s-2]=n,n_stack[s-1]=p,recount(pp),recount(p),recount(n),s>=3)(ppp=n_stack[s-3]).left===pp?ppp.left=n:ppp.right=n;break}p._color=BLACK,pp.right=repaint(BLACK,y),pp._color=RED,s-=1}else if(p.right===n){if(!(y=pp.left)||y._color!==RED){if(pp._color=RED,pp.right=p.left,p._color=BLACK,p.left=pp,n_stack[s-2]=p,n_stack[s-1]=n,recount(pp),recount(p),s>=3)(ppp=n_stack[s-3]).right===pp?ppp.right=p:ppp.left=p;break}p._color=BLACK,pp.left=repaint(BLACK,y),pp._color=RED,s-=1}else{var y;if(!(y=pp.left)||y._color!==RED){var ppp;if(p.left=n.right,pp._color=RED,pp.right=n.left,n._color=BLACK,n.right=p,n.left=pp,n_stack[s-2]=n,n_stack[s-1]=p,recount(pp),recount(p),recount(n),s>=3)(ppp=n_stack[s-3]).right===pp?ppp.right=n:ppp.left=n;break}p._color=BLACK,pp.left=repaint(BLACK,y),pp._color=RED,s-=1}}return n_stack[0]._color=BLACK,new RedBlackTree(cmp,n_stack[0])},__proto_142.forEach=function rbTreeForEach(visit,lo,hi){if(this.root)switch(arguments.length){case 1:return function doVisitFull(visit,node){var v;if(node.left&&(v=doVisitFull(visit,node.left)))return v;return(v=visit(node.key,node.value))||(node.right?doVisitFull(visit,node.right):void 0)}(visit,this.root);case 2:return function doVisitHalf(lo,compare,visit,node){if(compare(lo,node.key)<=0){var v;if(node.left&&(v=doVisitHalf(lo,compare,visit,node.left)))return v;if(v=visit(node.key,node.value))return v}if(node.right)return doVisitHalf(lo,compare,visit,node.right)}(lo,this._compare,visit,this.root);case 3:if(this._compare(lo,hi)>=0)return;return function doVisit(lo,hi,compare,visit,node){var v,l=compare(lo,node.key),h=compare(hi,node.key);if(l<=0){if(node.left&&(v=doVisit(lo,hi,compare,visit,node.left)))return v;if(h>0&&(v=visit(node.key,node.value)))return v}if(h>0&&node.right)return doVisit(lo,hi,compare,visit,node.right)}(lo,hi,this._compare,visit,this.root)}},Object.defineProperty(__proto_142,"begin",{get:function(){for(var stack=[],n=this.root;n;)stack.push(n),n=n.left;return new RedBlackTreeIterator(this,stack)}}),Object.defineProperty(__proto_142,"end",{get:function(){for(var stack=[],n=this.root;n;)stack.push(n),n=n.right;return new RedBlackTreeIterator(this,stack)}}),__proto_142.at=function(idx){if(idx<0)return new RedBlackTreeIterator(this,[]);for(var n=this.root,stack=[];;){if(stack.push(n),n.left){if(idx<n.left._count){n=n.left;continue}idx-=n.left._count}if(!idx)return new RedBlackTreeIterator(this,stack);if(idx-=1,!n.right)break;if(idx>=n.right._count)break;n=n.right}return new RedBlackTreeIterator(this,[])},__proto_142.ge=function(key){for(var cmp=this._compare,n=this.root,stack=[],last_ptr=0;n;){var d=cmp(key,n.key);stack.push(n),d<=0&&(last_ptr=stack.length),n=d<=0?n.left:n.right}return stack.length=last_ptr,new RedBlackTreeIterator(this,stack)},__proto_142.gt=function(key){for(var cmp=this._compare,n=this.root,stack=[],last_ptr=0;n;){var d=cmp(key,n.key);stack.push(n),d<0&&(last_ptr=stack.length),n=d<0?n.left:n.right}return stack.length=last_ptr,new RedBlackTreeIterator(this,stack)},__proto_142.lt=function(key){for(var cmp=this._compare,n=this.root,stack=[],last_ptr=0;n;){var d=cmp(key,n.key);stack.push(n),d>0&&(last_ptr=stack.length),n=d<=0?n.left:n.right}return stack.length=last_ptr,new RedBlackTreeIterator(this,stack)},__proto_142.le=function(key){for(var cmp=this._compare,n=this.root,stack=[],last_ptr=0;n;){var d=cmp(key,n.key);stack.push(n),d>=0&&(last_ptr=stack.length),n=d<0?n.left:n.right}return stack.length=last_ptr,new RedBlackTreeIterator(this,stack)},__proto_142.find=function(key){for(var cmp=this._compare,n=this.root,stack=[];n;){var d=cmp(key,n.key);if(stack.push(n),0===d)return new RedBlackTreeIterator(this,stack);n=d<=0?n.left:n.right}return new RedBlackTreeIterator(this,[])},__proto_142.remove=function(key){var iter=this.find(key);return iter?iter.remove():this},__proto_142.get=function(key){for(var cmp=this._compare,n=this.root;n;){var d=cmp(key,n.key);if(0===d)return n.value;n=d<=0?n.left:n.right}};var iproto=RedBlackTreeIterator.prototype;function swapNode(n,v){n.key=v.key,n.value=v.value,n.left=v.left,n.right=v.right,n._color=v._color,n._count=v._count}function defaultCompare(a,b){return a<b?-1:a>b?1:0}Object.defineProperty(iproto,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(iproto,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),iproto.clone=function(){return new RedBlackTreeIterator(this.tree,this._stack.slice())},iproto.remove=function(){var stack=this._stack;if(0===stack.length)return this.tree;var cstack=new Array(stack.length),n=stack[stack.length-1];cstack[cstack.length-1]=new RBNode(n._color,n.key,n.value,n.left,n.right,n._count);for(var i=stack.length-2;i>=0;--i){(n=stack[i]).left===stack[i+1]?cstack[i]=new RBNode(n._color,n.key,n.value,cstack[i+1],n.right,n._count):cstack[i]=new RBNode(n._color,n.key,n.value,n.left,cstack[i+1],n._count)}if((n=cstack[cstack.length-1]).left&&n.right){var split=cstack.length;for(n=n.left;n.right;)cstack.push(n),n=n.right;var v=cstack[split-1];cstack.push(new RBNode(n._color,v.key,v.value,n.left,n.right,n._count)),cstack[split-1].key=n.key,cstack[split-1].value=n.value;for(i=cstack.length-2;i>=split;--i)n=cstack[i],cstack[i]=new RBNode(n._color,n.key,n.value,n.left,cstack[i+1],n._count);cstack[split-1].left=cstack[split]}if((n=cstack[cstack.length-1])._color===RED){var p=cstack[cstack.length-2];p.left===n?p.left=null:p.right===n&&(p.right=null),cstack.pop();for(i=0;i<cstack.length;++i)cstack[i]._count--;return new RedBlackTree(this.tree._compare,cstack[0])}if(n.left||n.right){n.left?swapNode(n,n.left):n.right&&swapNode(n,n.right),n._color=BLACK;for(i=0;i<cstack.length-1;++i)cstack[i]._count--;return new RedBlackTree(this.tree._compare,cstack[0])}if(1===cstack.length)return new RedBlackTree(this.tree._compare,null);for(i=0;i<cstack.length;++i)cstack[i]._count--;var parent=cstack[cstack.length-2];return function fixDoubleBlack(stack){for(var n,p,s,z,i=stack.length-1;i>=0;--i){if(n=stack[i],0===i)return void(n._color=BLACK);if((p=stack[i-1]).left===n){if((s=p.right).right&&s.right._color===RED)return z=(s=p.right=cloneNode(s)).right=cloneNode(s.right),p.right=s.left,s.left=p,s.right=z,s._color=p._color,n._color=BLACK,p._color=BLACK,z._color=BLACK,recount(p),recount(s),i>1&&((pp=stack[i-2]).left===p?pp.left=s:pp.right=s),void(stack[i-1]=s);if(s.left&&s.left._color===RED)return z=(s=p.right=cloneNode(s)).left=cloneNode(s.left),p.right=z.left,s.left=z.right,z.left=p,z.right=s,z._color=p._color,p._color=BLACK,s._color=BLACK,n._color=BLACK,recount(p),recount(s),recount(z),i>1&&((pp=stack[i-2]).left===p?pp.left=z:pp.right=z),void(stack[i-1]=z);if(s._color===BLACK){if(p._color===RED)return p._color=BLACK,void(p.right=repaint(RED,s));p.right=repaint(RED,s);continue}s=cloneNode(s),p.right=s.left,s.left=p,s._color=p._color,p._color=RED,recount(p),recount(s),i>1&&((pp=stack[i-2]).left===p?pp.left=s:pp.right=s),stack[i-1]=s,stack[i]=p,i+1<stack.length?stack[i+1]=n:stack.push(n),i+=2}else{if((s=p.left).left&&s.left._color===RED)return z=(s=p.left=cloneNode(s)).left=cloneNode(s.left),p.left=s.right,s.right=p,s.left=z,s._color=p._color,n._color=BLACK,p._color=BLACK,z._color=BLACK,recount(p),recount(s),i>1&&((pp=stack[i-2]).right===p?pp.right=s:pp.left=s),void(stack[i-1]=s);if(s.right&&s.right._color===RED)return z=(s=p.left=cloneNode(s)).right=cloneNode(s.right),p.left=z.right,s.right=z.left,z.right=p,z.left=s,z._color=p._color,p._color=BLACK,s._color=BLACK,n._color=BLACK,recount(p),recount(s),recount(z),i>1&&((pp=stack[i-2]).right===p?pp.right=z:pp.left=z),void(stack[i-1]=z);if(s._color===BLACK){if(p._color===RED)return p._color=BLACK,void(p.left=repaint(RED,s));p.left=repaint(RED,s);continue}var pp;s=cloneNode(s),p.left=s.right,s.right=p,s._color=p._color,p._color=RED,recount(p),recount(s),i>1&&((pp=stack[i-2]).right===p?pp.right=s:pp.left=s),stack[i-1]=s,stack[i]=p,i+1<stack.length?stack[i+1]=n:stack.push(n),i+=2}}}(cstack),parent.left===n?parent.left=null:parent.right=null,new RedBlackTree(this.tree._compare,cstack[0])},Object.defineProperty(iproto,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(iproto,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(iproto,"index",{get:function(){var idx=0,stack=this._stack;if(0===stack.length){var r=this.tree.root;return r?r._count:0}stack[stack.length-1].left&&(idx=stack[stack.length-1].left._count);for(var s=stack.length-2;s>=0;--s)stack[s+1]===stack[s].right&&(++idx,stack[s].left&&(idx+=stack[s].left._count));return idx},enumerable:!0}),iproto.next=function(){var stack=this._stack;if(0!==stack.length){var n=stack[stack.length-1];if(n.right)for(n=n.right;n;)stack.push(n),n=n.left;else for(stack.pop();stack.length>0&&stack[stack.length-1].right===n;)n=stack[stack.length-1],stack.pop()}},Object.defineProperty(iproto,"hasNext",{get:function(){var stack=this._stack;if(0===stack.length)return!1;if(stack[stack.length-1].right)return!0;for(var s=stack.length-1;s>0;--s)if(stack[s-1].left===stack[s])return!0;return!1}}),iproto.update=function(value){var stack=this._stack;if(0===stack.length)throw new Error("Can't update empty node!");var cstack=new Array(stack.length),n=stack[stack.length-1];cstack[cstack.length-1]=new RBNode(n._color,n.key,value,n.left,n.right,n._count);for(var i=stack.length-2;i>=0;--i)(n=stack[i]).left===stack[i+1]?cstack[i]=new RBNode(n._color,n.key,n.value,cstack[i+1],n.right,n._count):cstack[i]=new RBNode(n._color,n.key,n.value,n.left,cstack[i+1],n._count);return new RedBlackTree(this.tree._compare,cstack[0])},iproto.prev=function(){var stack=this._stack;if(0!==stack.length){var n=stack[stack.length-1];if(n.left)for(n=n.left;n;)stack.push(n),n=n.right;else for(stack.pop();stack.length>0&&stack[stack.length-1].left===n;)n=stack[stack.length-1],stack.pop()}},Object.defineProperty(iproto,"hasPrev",{get:function(){var stack=this._stack;if(0===stack.length)return!1;if(stack[stack.length-1].left)return!0;for(var s=stack.length-1;s>0;--s)if(stack[s-1].right===stack[s])return!0;return!1}});var _$orderSegments_338=function orderSegments(b,a){var al,ar,bl,br;if(a[0][0]<a[1][0])al=a[0],ar=a[1];else{if(!(a[0][0]>a[1][0]))return horizontalOrder(a,b);al=a[1],ar=a[0]}if(b[0][0]<b[1][0])bl=b[0],br=b[1];else{if(!(b[0][0]>b[1][0]))return-horizontalOrder(b,a);bl=b[1],br=b[0]}var d1=_$orientation_323(al,ar,br),d2=_$orientation_323(al,ar,bl);if(d1<0){if(d2<=0)return d1}else if(d1>0){if(d2>=0)return d1}else if(d2)return d2;if(d1=_$orientation_323(br,bl,ar),d2=_$orientation_323(br,bl,al),d1<0){if(d2<=0)return d1}else if(d1>0){if(d2>=0)return d1}else if(d2)return d2;return ar[0]-br[0]};function horizontalOrder(a,b){var bl,br,al,ar;if(b[0][0]<b[1][0])bl=b[0],br=b[1];else{if(!(b[0][0]>b[1][0])){var alo=Math.min(a[0][1],a[1][1]),ahi=Math.max(a[0][1],a[1][1]),blo=Math.min(b[0][1],b[1][1]),bhi=Math.max(b[0][1],b[1][1]);return ahi<blo?ahi-blo:alo>bhi?alo-bhi:ahi-bhi}bl=b[1],br=b[0]}a[0][1]<a[1][1]?(al=a[0],ar=a[1]):(al=a[1],ar=a[0]);var d=_$orientation_323(br,bl,al);return d||((d=_$orientation_323(br,bl,ar))||ar-br)}var _$createSlabDecomposition_339=function createSlabDecomposition(segments){for(var numSegments=segments.length,numEvents=2*numSegments,events=new Array(numEvents),i=0;i<numSegments;++i){var s=segments[i],f=s[0][0]<s[1][0];events[2*i]=new __Event_339(s[0][0],s,f,i),events[2*i+1]=new __Event_339(s[1][0],s,!f,i)}events.sort(function(a,b){var d=a.x-b.x;return d||((d=a.create-b.create)||Math.min(a.segment[0][1],a.segment[1][1])-Math.min(b.segment[0][1],b.segment[1][1]))});for(var tree=_$createRBTree_142(_$orderSegments_338),slabs=[],lines=[],horizontal=[],i=0;i<numEvents;){for(var x=events[i].x,horiz=[];i<numEvents;){var e=events[i];if(e.x!==x)break;i+=1,e.segment[0][0]===e.x&&e.segment[1][0]===e.x?e.create&&(e.segment[0][1]<e.segment[1][1]?(horiz.push(new IntervalSegment(e.segment[0][1],e.index,!0,!0)),horiz.push(new IntervalSegment(e.segment[1][1],e.index,!1,!1))):(horiz.push(new IntervalSegment(e.segment[1][1],e.index,!0,!1)),horiz.push(new IntervalSegment(e.segment[0][1],e.index,!1,!0)))):tree=e.create?tree.insert(e.segment,e.index):tree.remove(e.segment)}slabs.push(tree.root),lines.push(x),horizontal.push(horiz)}return new SlabDecomposition(slabs,lines,horizontal)};function SlabDecomposition(slabs,coordinates,horizontal){this.slabs=slabs,this.coordinates=coordinates,this.horizontal=horizontal}function compareHorizontal(e,y){return e.y-y}function searchBucket(root,p){for(var lastNode=null;root;){var l,r,seg=root.key;seg[0][0]<seg[1][0]?(l=seg[0],r=seg[1]):(l=seg[1],r=seg[0]);var o=_$orientation_323(l,r,p);if(o<0)root=root.left;else if(o>0)if(p[0]!==seg[1][0])lastNode=root,root=root.right;else{if(val=searchBucket(root.right,p))return val;root=root.left}else{if(p[0]!==seg[1][0])return root;var val;if(val=searchBucket(root.right,p))return val;root=root.left}}return lastNode}function IntervalSegment(y,index,start,closed){this.y=y,this.index=index,this.start=start,this.closed=closed}function __Event_339(x,segment,create,index){this.x=x,this.segment=segment,this.create=create,this.index=index}SlabDecomposition.prototype.castUp=function(p){var bucket=_$searchBounds_71.le(this.coordinates,p[0]);if(bucket<0)return-1;this.slabs[bucket];var hitNode=searchBucket(this.slabs[bucket],p),lastHit=-1;if(hitNode&&(lastHit=hitNode.value),this.coordinates[bucket]===p[0]){var lastSegment=null;if(hitNode&&(lastSegment=hitNode.key),bucket>0){var otherHitNode=searchBucket(this.slabs[bucket-1],p);otherHitNode&&(lastSegment?_$orderSegments_338(otherHitNode.key,lastSegment)>0&&(lastSegment=otherHitNode.key,lastHit=otherHitNode.value):(lastHit=otherHitNode.value,lastSegment=otherHitNode.key))}var horiz=this.horizontal[bucket];if(horiz.length>0){var hbucket=_$searchBounds_71.ge(horiz,p[1],compareHorizontal);if(hbucket<horiz.length){var e=horiz[hbucket];if(p[1]===e.y){if(e.closed)return e.index;for(;hbucket<horiz.length-1&&horiz[hbucket+1].y===p[1];)if((e=horiz[hbucket+=1]).closed)return e.index;if(e.y===p[1]&&!e.start){if((hbucket+=1)>=horiz.length)return lastHit;e=horiz[hbucket]}}if(e.start)if(lastSegment){var o=_$orientation_323(lastSegment[0],lastSegment[1],[p[0],e.y]);lastSegment[0][0]>lastSegment[1][0]&&(o=-o),o>0&&(lastHit=e.index)}else lastHit=e.index;else e.y!==p[1]&&(lastHit=e.index)}}}return lastHit};var _$preprocessPolygon_294=function preprocessPolygon(loops){for(var numLoops=loops.length,segments=[],vsegments=[],i=0;i<numLoops;++i)for(var loop=loops[i],numVertices=loop.length,s=numVertices-1,t=0;t<numVertices;s=t++){var a=loop[s],b=loop[t];a[0]===b[0]?vsegments.push([a,b]):segments.push([a,b])}if(0===segments.length)return 0===vsegments.length?classifyEmpty:function createClassifyVertical(testVertical){return function classify(p){return testVertical(p[0],p[1])?0:1}}(buildVerticalIndex(vsegments));var slabs=_$createSlabDecomposition_339(segments),testSlab=function buildSlabSearch(slabs,coordinates){return function(p){var bucket=_$searchBounds_71.le(coordinates,p[0]);if(bucket<0)return 1;var root=slabs[bucket];if(!root){if(!(bucket>0&&coordinates[bucket]===p[0]))return 1;root=slabs[bucket-1]}for(var lastOrientation=1;root;){var s=root.key,o=__orient_294(p,s[0],s[1]);if(s[0][0]<s[1][0])if(o<0)root=root.left;else{if(!(o>0))return 0;lastOrientation=-1,root=root.right}else if(o>0)root=root.left;else{if(!(o<0))return 0;lastOrientation=1,root=root.right}}return lastOrientation}}(slabs.slabs,slabs.coordinates);return 0===vsegments.length?testSlab:function createClassifyPointDegen(testVertical,testNormal){return function classify(p){return testVertical(p[0],p[1])?0:testNormal(p)}}(buildVerticalIndex(vsegments),testSlab)},__orient_294=_$orientation_323[3];function visitInterval(){return!0}function buildVerticalIndex(segments){for(var table={},i=0;i<segments.length;++i){var s=segments[i],x=s[0][0],y0=s[0][1],y1=s[1][1],p=[Math.min(y0,y1),Math.max(y0,y1)];x in table?table[x].push(p):table[x]=[p]}var intervalTable={},keys=Object.keys(table);for(i=0;i<keys.length;++i){var segs=table[keys[i]];intervalTable[keys[i]]=_$createWrapper_243(segs)}return function intervalSearch(table){return function(x,y){var tree=table[x];return!!tree&&!!tree.queryPoint(y,visitInterval)}}(intervalTable)}function classifyEmpty(p){return 1}var _$planarGraphToPolyline_293=function planarGraphToPolyline(edges,positions){var result=_$trimLeaves_292(edges,positions);edges=result[0];for(var numVertices=(positions=result[1]).length,adj=(edges.length,_$edgeToAdjacency_135(edges,positions.length)),i=0;i<numVertices;++i)if(adj[i].length%2==1)throw new Error("planar-graph-to-polyline: graph must be manifold");var faces=_$planarDual_291(edges,positions);for(var numFaces=(faces=faces.filter(function ccw(c){for(var n=c.length,area=[0],j=0;j<n;++j){var a=positions[c[j]],b=positions[c[(j+1)%n]],t00=_$twoProduct_358(-a[0],a[1]),t01=_$twoProduct_358(-a[0],b[1]),t10=_$twoProduct_358(b[0],a[1]),t11=_$twoProduct_358(b[0],b[1]);area=_$linearExpansionSum_328(area,_$linearExpansionSum_328(_$linearExpansionSum_328(t00,t01),_$linearExpansionSum_328(t10,t11)))}return area[area.length-1]>0})).length,parent=new Array(numFaces),containment=new Array(numFaces),i=0;i<numFaces;++i){parent[i]=i;var row=new Array(numFaces),loopVertices=faces[i].map(function(v){return positions[v]}),pmc=_$preprocessPolygon_294([loopVertices]),count=0;outer:for(var j=0;j<numFaces;++j)if(row[j]=0,i!==j){for(var c=faces[j],n=c.length,k=0;k<n;++k){var d=pmc(positions[c[k]]);if(0!==d){d<0&&(row[j]=1,count+=1);continue outer}}row[j]=1,count+=1}containment[i]=[count,i,row]}containment.sort(function(a,b){return b[0]-a[0]});for(var i=0;i<numFaces;++i)for(var row=containment[i],idx=row[1],children=row[2],j=0;j<numFaces;++j)children[j]&&(parent[j]=idx);for(var fadj=function makeArrayOfArrays(length){for(var result=new Array(length),i=0;i<length;++i)result[i]=[];return result}(numFaces),i=0;i<numFaces;++i)fadj[i].push(parent[i]),fadj[parent[i]].push(i);for(var edgeAdjacency={},internalVertices=makeArray(numVertices,!1),i=0;i<numFaces;++i)for(var c=faces[i],n=c.length,j=0;j<n;++j){var a=c[j],b=c[(j+1)%n],key=Math.min(a,b)+":"+Math.max(a,b);if(key in edgeAdjacency){var neighbor=edgeAdjacency[key];fadj[neighbor].push(i),fadj[i].push(neighbor),internalVertices[a]=internalVertices[b]=!0}else edgeAdjacency[key]=i}function sharedBoundary(c){for(var n=c.length,i=0;i<n;++i)if(!internalVertices[c[i]])return!1;return!0}for(var toVisit=[],parity=makeArray(numFaces,-1),i=0;i<numFaces;++i)parent[i]!==i||sharedBoundary(faces[i])?parity[i]=-1:(toVisit.push(i),parity[i]=0);var result=[];for(;toVisit.length>0;){var top=toVisit.pop(),nbhd=fadj[top];_$unique_362(nbhd,function(a,b){return a-b});var polyline,nnbhr=nbhd.length,p=parity[top];if(0===p){var c=faces[top];polyline=[c]}for(var i=0;i<nnbhr;++i){var f=nbhd[i];if(!(parity[f]>=0)&&(parity[f]=1^p,toVisit.push(f),0===p)){var c=faces[f];sharedBoundary(c)||(c.reverse(),polyline.push(c))}}0===p&&result.push(polyline)}return result};function makeArray(length,fill){for(var result=new Array(length),i=0;i<length;++i)result[i]=fill;return result}var _$topology_333={};function compareCells(a,b){var n=a.length,t=a.length-b.length,min=Math.min;if(t)return t;switch(n){case 0:return 0;case 1:return a[0]-b[0];case 2:return(d=a[0]+a[1]-b[0]-b[1])||min(a[0],a[1])-min(b[0],b[1]);case 3:var l1=a[0]+a[1],m1=b[0]+b[1];if(d=l1+a[2]-(m1+b[2]))return d;var d,l0=min(a[0],a[1]),m0=min(b[0],b[1]);return(d=min(l0,a[2])-min(m0,b[2]))||min(l0+a[2],l1)-min(m0+b[2],m1);default:var as=a.slice(0);as.sort();var bs=b.slice(0);bs.sort();for(var i=0;i<n;++i)if(t=as[i]-bs[i])return t;return 0}}function compareZipped(a,b){return compareCells(a[0],b[0])}function normalize(cells,attr){if(attr){for(var len=cells.length,zipped=new Array(len),i=0;i<len;++i)zipped[i]=[cells[i],attr[i]];zipped.sort(compareZipped);for(i=0;i<len;++i)cells[i]=zipped[i][0],attr[i]=zipped[i][1];return cells}return cells.sort(compareCells),cells}function __unique_333(cells){if(0===cells.length)return[];for(var ptr=1,len=cells.length,i=1;i<len;++i){var a=cells[i];if(compareCells(a,cells[i-1])){if(i===ptr){ptr++;continue}cells[ptr++]=a}}return cells.length=ptr,cells}function findCell(cells,c){for(var lo=0,hi=cells.length-1,r=-1;lo<=hi;){var mid=lo+hi>>1,s=compareCells(cells[mid],c);s<=0?(0===s&&(r=mid),lo=mid+1):s>0&&(hi=mid-1)}return r}function incidence(from_cells,to_cells){for(var index=new Array(from_cells.length),i=0,il=index.length;i<il;++i)index[i]=[];for(var b=[],n=(i=0,to_cells.length);i<n;++i)for(var c=to_cells[i],cl=c.length,k=1,kn=1<<cl;k<kn;++k){b.length=_$twiddle_72.popCount(k);for(var l=0,j=0;j<cl;++j)k&1<<j&&(b[l++]=c[j]);var idx=findCell(from_cells,b);if(!(idx<0))for(;index[idx++].push(i),!(idx>=from_cells.length||0!==compareCells(from_cells[idx],b)););}return index}function skeleton(cells,n){if(n<0)return[];for(var result=[],k0=(1<<n+1)-1,i=0;i<cells.length;++i)for(var c=cells[i],k=k0;k<1<<c.length;k=_$twiddle_72.nextCombination(k)){for(var b=new Array(n+1),l=0,j=0;j<c.length;++j)k&1<<j&&(b[l++]=c[j]);result.push(b)}return normalize(result)}_$topology_333.dimension=function dimension(cells){for(var d=0,max=Math.max,i=0,il=cells.length;i<il;++i)d=max(d,cells[i].length);return d-1},_$topology_333.countVertices=function countVertices(cells){for(var vc=-1,max=Math.max,i=0,il=cells.length;i<il;++i)for(var c=cells[i],j=0,jl=c.length;j<jl;++j)vc=max(vc,c[j]);return vc+1},_$topology_333.cloneCells=function cloneCells(cells){for(var ncells=new Array(cells.length),i=0,il=cells.length;i<il;++i)ncells[i]=cells[i].slice(0);return ncells},_$topology_333.compareCells=compareCells,_$topology_333.normalize=normalize,_$topology_333.unique=__unique_333,_$topology_333.findCell=findCell,_$topology_333.incidence=incidence,_$topology_333.dual=function dual(cells,vertex_count){if(!vertex_count)return incidence(__unique_333(skeleton(cells,0)),cells);for(var res=new Array(vertex_count),i=0;i<vertex_count;++i)res[i]=[];i=0;for(var len=cells.length;i<len;++i)for(var c=cells[i],j=0,cl=c.length;j<cl;++j)res[c[j]].push(i);return res},_$topology_333.explode=function explode(cells){for(var result=[],i=0,il=cells.length;i<il;++i)for(var c=cells[i],cl=0|c.length,j=1,jl=1<<cl;j<jl;++j){for(var b=[],k=0;k<cl;++k)j>>>k&1&&b.push(c[k]);result.push(b)}return normalize(result)},_$topology_333.skeleton=skeleton,_$topology_333.boundary=function boundary(cells){for(var res=[],i=0,il=cells.length;i<il;++i)for(var c=cells[i],j=0,cl=c.length;j<cl;++j){for(var b=new Array(c.length-1),k=0,l=0;k<cl;++k)k!==j&&(b[l++]=c[k]);res.push(b)}return normalize(res)},_$topology_333.connectedComponents=function connectedComponents(cells,vertex_count){return vertex_count?function connectedComponents_dense(cells,vertex_count){for(var labels=new _$UnionFind_361(vertex_count),i=0;i<cells.length;++i)for(var c=cells[i],j=0;j<c.length;++j)for(var k=j+1;k<c.length;++k)labels.link(c[j],c[k]);var components=[],component_labels=labels.ranks;for(i=0;i<component_labels.length;++i)component_labels[i]=-1;for(i=0;i<cells.length;++i){var l=labels.find(cells[i][0]);component_labels[l]<0?(component_labels[l]=components.length,components.push([cells[i].slice(0)])):components[component_labels[l]].push(cells[i].slice(0))}return components}(cells,vertex_count):function connectedComponents_sparse(cells){for(var vertices=__unique_333(normalize(skeleton(cells,0))),labels=new _$UnionFind_361(vertices.length),i=0;i<cells.length;++i)for(var c=cells[i],j=0;j<c.length;++j)for(var vj=findCell(vertices,[c[j]]),k=j+1;k<c.length;++k)labels.link(vj,findCell(vertices,[c[k]]));var components=[],component_labels=labels.ranks;for(i=0;i<component_labels.length;++i)component_labels[i]=-1;for(i=0;i<cells.length;++i){var l=labels.find(findCell(vertices,[cells[i][0]]));component_labels[l]<0?(component_labels[l]=components.length,components.push([cells[i].slice(0)])):components[component_labels[l]].push(cells[i].slice(0))}return components}(cells)};var _$twiddle_334={};function __countTrailingZeros_334(v){var c=32;return(v&=-v)&&c--,65535&v&&(c-=16),16711935&v&&(c-=8),252645135&v&&(c-=4),858993459&v&&(c-=2),1431655765&v&&(c-=1),c}_$twiddle_334.INT_BITS=32,_$twiddle_334.INT_MAX=2147483647,_$twiddle_334.INT_MIN=-1<<31,_$twiddle_334.sign=function(v){return(v>0)-(v<0)},_$twiddle_334.abs=function(v){var mask=v>>31;return(v^mask)-mask},_$twiddle_334.min=function(x,y){return y^(x^y)&-(x<y)},_$twiddle_334.max=function(x,y){return x^(x^y)&-(x<y)},_$twiddle_334.isPow2=function(v){return!(v&v-1||!v)},_$twiddle_334.log2=function(v){var r,shift;return r=(v>65535)<<4,r|=shift=((v>>>=r)>255)<<3,r|=shift=((v>>>=shift)>15)<<2,(r|=shift=((v>>>=shift)>3)<<1)|(v>>>=shift)>>1},_$twiddle_334.log10=function(v){return v>=1e9?9:v>=1e8?8:v>=1e7?7:v>=1e6?6:v>=1e5?5:v>=1e4?4:v>=1e3?3:v>=100?2:v>=10?1:0},_$twiddle_334.popCount=function(v){return 16843009*((v=(858993459&(v-=v>>>1&1431655765))+(v>>>2&858993459))+(v>>>4)&252645135)>>>24},_$twiddle_334.countTrailingZeros=__countTrailingZeros_334,_$twiddle_334.nextPow2=function(v){return v+=0===v,--v,v|=v>>>1,v|=v>>>2,v|=v>>>4,v|=v>>>8,(v|=v>>>16)+1},_$twiddle_334.prevPow2=function(v){return v|=v>>>1,v|=v>>>2,v|=v>>>4,v|=v>>>8,(v|=v>>>16)-(v>>>1)},_$twiddle_334.parity=function(v){return v^=v>>>16,v^=v>>>8,v^=v>>>4,27030>>>(v&=15)&1};var __REVERSE_TABLE_334=new Array(256);!function(tab){for(var i=0;i<256;++i){var v=i,r=i,s=7;for(v>>>=1;v;v>>>=1)r<<=1,r|=1&v,--s;tab[i]=r<<s&255}}(__REVERSE_TABLE_334),_$twiddle_334.reverse=function(v){return __REVERSE_TABLE_334[255&v]<<24|__REVERSE_TABLE_334[v>>>8&255]<<16|__REVERSE_TABLE_334[v>>>16&255]<<8|__REVERSE_TABLE_334[v>>>24&255]},_$twiddle_334.interleave2=function(x,y){return(x=1431655765&((x=858993459&((x=252645135&((x=16711935&((x&=65535)|x<<8))|x<<4))|x<<2))|x<<1))|(y=1431655765&((y=858993459&((y=252645135&((y=16711935&((y&=65535)|y<<8))|y<<4))|y<<2))|y<<1))<<1},_$twiddle_334.deinterleave2=function(v,n){return(v=65535&((v=16711935&((v=252645135&((v=858993459&((v=v>>>n&1431655765)|v>>>1))|v>>>2))|v>>>4))|v>>>16))<<16>>16},_$twiddle_334.interleave3=function(x,y,z){return x=1227133513&((x=3272356035&((x=251719695&((x=4278190335&((x&=1023)|x<<16))|x<<8))|x<<4))|x<<2),(x|=(y=1227133513&((y=3272356035&((y=251719695&((y=4278190335&((y&=1023)|y<<16))|y<<8))|y<<4))|y<<2))<<1)|(z=1227133513&((z=3272356035&((z=251719695&((z=4278190335&((z&=1023)|z<<16))|z<<8))|z<<4))|z<<2))<<2},_$twiddle_334.deinterleave3=function(v,n){return(v=1023&((v=4278190335&((v=251719695&((v=3272356035&((v=v>>>n&1227133513)|v>>>2))|v>>>4))|v>>>8))|v>>>16))<<22>>22},_$twiddle_334.nextCombination=function(v){var t=v|v-1;return t+1|(~t&-~t)-1>>>__countTrailingZeros_334(v)+1};var _$UnionFind_336=__UnionFind_336;function __UnionFind_336(count){this.roots=new Array(count),this.ranks=new Array(count);for(var i=0;i<count;++i)this.roots[i]=i,this.ranks[i]=0}__UnionFind_336.prototype.length=function(){return this.roots.length},__UnionFind_336.prototype.makeSet=function(){var n=this.roots.length;return this.roots.push(n),this.ranks.push(0),n},__UnionFind_336.prototype.find=function(x){for(var roots=this.roots;roots[x]!==x;){var y=roots[x];roots[x]=roots[y],x=y}return x},__UnionFind_336.prototype.link=function(x,y){var xr=this.find(x),yr=this.find(y);if(xr!==yr){var ranks=this.ranks,roots=this.roots,xd=ranks[xr],yd=ranks[yr];xd<yd?roots[xr]=yr:yd<xd?roots[yr]=xr:(roots[yr]=xr,++ranks[xr])}};var _$topology_335={};function __compareCells_335(a,b){var n=a.length,t=a.length-b.length,min=Math.min;if(t)return t;switch(n){case 0:return 0;case 1:return a[0]-b[0];case 2:return(d=a[0]+a[1]-b[0]-b[1])||min(a[0],a[1])-min(b[0],b[1]);case 3:var l1=a[0]+a[1],m1=b[0]+b[1];if(d=l1+a[2]-(m1+b[2]))return d;var d,l0=min(a[0],a[1]),m0=min(b[0],b[1]);return(d=min(l0,a[2])-min(m0,b[2]))||min(l0+a[2],l1)-min(m0+b[2],m1);default:var as=a.slice(0);as.sort();var bs=b.slice(0);bs.sort();for(var i=0;i<n;++i)if(t=as[i]-bs[i])return t;return 0}}function __compareZipped_335(a,b){return __compareCells_335(a[0],b[0])}function __normalize_335(cells,attr){if(attr){for(var len=cells.length,zipped=new Array(len),i=0;i<len;++i)zipped[i]=[cells[i],attr[i]];zipped.sort(__compareZipped_335);for(i=0;i<len;++i)cells[i]=zipped[i][0],attr[i]=zipped[i][1];return cells}return cells.sort(__compareCells_335),cells}function __unique_335(cells){if(0===cells.length)return[];for(var ptr=1,len=cells.length,i=1;i<len;++i){var a=cells[i];if(__compareCells_335(a,cells[i-1])){if(i===ptr){ptr++;continue}cells[ptr++]=a}}return cells.length=ptr,cells}function __findCell_335(cells,c){for(var lo=0,hi=cells.length-1,r=-1;lo<=hi;){var mid=lo+hi>>1,s=__compareCells_335(cells[mid],c);s<=0?(0===s&&(r=mid),lo=mid+1):s>0&&(hi=mid-1)}return r}function __incidence_335(from_cells,to_cells){for(var index=new Array(from_cells.length),i=0,il=index.length;i<il;++i)index[i]=[];for(var b=[],n=(i=0,to_cells.length);i<n;++i)for(var c=to_cells[i],cl=c.length,k=1,kn=1<<cl;k<kn;++k){b.length=_$twiddle_334.popCount(k);for(var l=0,j=0;j<cl;++j)k&1<<j&&(b[l++]=c[j]);var idx=__findCell_335(from_cells,b);if(!(idx<0))for(;index[idx++].push(i),!(idx>=from_cells.length||0!==__compareCells_335(from_cells[idx],b)););}return index}function __skeleton_335(cells,n){if(n<0)return[];for(var result=[],k0=(1<<n+1)-1,i=0;i<cells.length;++i)for(var c=cells[i],k=k0;k<1<<c.length;k=_$twiddle_334.nextCombination(k)){for(var b=new Array(n+1),l=0,j=0;j<c.length;++j)k&1<<j&&(b[l++]=c[j]);result.push(b)}return __normalize_335(result)}_$topology_335.dimension=function __dimension_335(cells){for(var d=0,max=Math.max,i=0,il=cells.length;i<il;++i)d=max(d,cells[i].length);return d-1},_$topology_335.countVertices=function __countVertices_335(cells){for(var vc=-1,max=Math.max,i=0,il=cells.length;i<il;++i)for(var c=cells[i],j=0,jl=c.length;j<jl;++j)vc=max(vc,c[j]);return vc+1},_$topology_335.cloneCells=function __cloneCells_335(cells){for(var ncells=new Array(cells.length),i=0,il=cells.length;i<il;++i)ncells[i]=cells[i].slice(0);return ncells},_$topology_335.compareCells=__compareCells_335,_$topology_335.normalize=__normalize_335,_$topology_335.unique=__unique_335,_$topology_335.findCell=__findCell_335,_$topology_335.incidence=__incidence_335,_$topology_335.dual=function __dual_335(cells,vertex_count){if(!vertex_count)return __incidence_335(__unique_335(__skeleton_335(cells,0)),cells);for(var res=new Array(vertex_count),i=0;i<vertex_count;++i)res[i]=[];i=0;for(var len=cells.length;i<len;++i)for(var c=cells[i],j=0,cl=c.length;j<cl;++j)res[c[j]].push(i);return res},_$topology_335.explode=function __explode_335(cells){for(var result=[],i=0,il=cells.length;i<il;++i)for(var c=cells[i],cl=0|c.length,j=1,jl=1<<cl;j<jl;++j){for(var b=[],k=0;k<cl;++k)j>>>k&1&&b.push(c[k]);result.push(b)}return __normalize_335(result)},_$topology_335.skeleton=__skeleton_335,_$topology_335.boundary=function __boundary_335(cells){for(var res=[],i=0,il=cells.length;i<il;++i)for(var c=cells[i],j=0,cl=c.length;j<cl;++j){for(var b=new Array(c.length-1),k=0,l=0;k<cl;++k)k!==j&&(b[l++]=c[k]);res.push(b)}return __normalize_335(res)},_$topology_335.connectedComponents=function __connectedComponents_335(cells,vertex_count){return vertex_count?function __connectedComponents_dense_335(cells,vertex_count){for(var labels=new _$UnionFind_336(vertex_count),i=0;i<cells.length;++i)for(var c=cells[i],j=0;j<c.length;++j)for(var k=j+1;k<c.length;++k)labels.link(c[j],c[k]);var components=[],component_labels=labels.ranks;for(i=0;i<component_labels.length;++i)component_labels[i]=-1;for(i=0;i<cells.length;++i){var l=labels.find(cells[i][0]);component_labels[l]<0?(component_labels[l]=components.length,components.push([cells[i].slice(0)])):components[component_labels[l]].push(cells[i].slice(0))}return components}(cells,vertex_count):function __connectedComponents_sparse_335(cells){for(var vertices=__unique_335(__normalize_335(__skeleton_335(cells,0))),labels=new _$UnionFind_336(vertices.length),i=0;i<cells.length;++i)for(var c=cells[i],j=0;j<c.length;++j)for(var vj=__findCell_335(vertices,[c[j]]),k=j+1;k<c.length;++k)labels.link(vj,__findCell_335(vertices,[c[k]]));var components=[],component_labels=labels.ranks;for(i=0;i<component_labels.length;++i)component_labels[i]=-1;for(i=0;i<cells.length;++i){var l=labels.find(__findCell_335(vertices,[cells[i][0]]));component_labels[l]<0?(component_labels[l]=components.length,components.push([cells[i].slice(0)])):components[component_labels[l]].push(cells[i].slice(0))}return components}(cells)};var _$simplifyPolygon_337=function simplifyPolygon(cells,positions,minArea){for(var n=positions.length,nc=cells.length,inv=new Array(n),outv=new Array(n),weights=new Array(n),dead=new Array(n),i=0;i<n;++i)inv[i]=outv[i]=-1,weights[i]=1/0,dead[i]=!1;for(var i=0;i<nc;++i){var c=cells[i];if(2!==c.length)throw new Error("Input must be a graph");var s=c[1],t=c[0];-1!==outv[t]?outv[t]=-2:outv[t]=s,-1!==inv[s]?inv[s]=-2:inv[s]=t}function computeWeight(i){if(dead[i])return 1/0;var s=inv[i],t=outv[i];return s<0||t<0?1/0:function errorWeight(base,a,b){var area=Math.abs(_$orientation_323(base,a,b)),perim=Math.sqrt(Math.pow(a[0]-b[0],2)+Math.pow(a[1]-b[1],2));return area/perim}(positions[i],positions[s],positions[t])}function heapSwap(i,j){var a=heap[i],b=heap[j];heap[i]=b,heap[j]=a,index[a]=j,index[b]=i}function heapWeight(i){return weights[heap[i]]}function heapParent(i){return 1&i?i-1>>1:(i>>1)-1}function heapDown(i){for(var w=heapWeight(i);;){var tw=w,left=2*i+1,right=2*(i+1),next=i;if(left<heapCount){var lw=heapWeight(left);lw<tw&&(next=left,tw=lw)}if(right<heapCount){var rw=heapWeight(right);rw<tw&&(next=right)}if(next===i)return i;heapSwap(i,next),i=next}}function heapUp(i){for(var w=heapWeight(i);i>0;){var parent=heapParent(i);if(parent>=0){var pw=heapWeight(parent);if(w<pw){heapSwap(i,parent),i=parent;continue}}return i}}function heapPop(){if(heapCount>0){var head=heap[0];return heapSwap(0,heapCount-1),heapCount-=1,heapDown(0),head}return-1}function heapUpdate(i,w){var a=heap[i];return weights[a]===w?i:(weights[a]=-1/0,heapUp(i),heapPop(),weights[a]=w,heapUp((heapCount+=1)-1))}function kill(i){if(!dead[i]){dead[i]=!0;var s=inv[i],t=outv[i];inv[t]>=0&&(inv[t]=s),outv[s]>=0&&(outv[s]=t),index[s]>=0&&heapUpdate(index[s],computeWeight(s)),index[t]>=0&&heapUpdate(index[t],computeWeight(t))}}for(var heap=[],index=new Array(n),i=0;i<n;++i){var w=weights[i]=computeWeight(i);w<1/0?(index[i]=heap.length,heap.push(i)):index[i]=-1}for(var heapCount=heap.length,i=heapCount>>1;i>=0;--i)heapDown(i);for(;;){var hmin=heapPop();if(hmin<0||weights[hmin]>minArea)break;kill(hmin)}for(var npositions=[],i=0;i<n;++i)dead[i]||(index[i]=npositions.length,npositions.push(positions[i].slice()));npositions.length;function tortoiseHare(seq,start){if(seq[start]<0)return start;var t=start,h=start;do{var nh=seq[h];if(!dead[h]||nh<0||nh===h)break;if(nh=seq[h=nh],!dead[h]||nh<0||nh===h)break;h=nh,t=seq[t]}while(t!==h);for(var v=start;v!==h;v=seq[v])seq[v]=h;return h}var ncells=[];return cells.forEach(function(c){var tin=tortoiseHare(inv,c[0]),tout=tortoiseHare(outv,c[1]);if(tin>=0&&tout>=0&&tin!==tout){var cin=index[tin],cout=index[tout];cin!==cout&&ncells.push([cin,cout])}}),_$topology_335.unique(_$topology_335.normalize(ncells)),{positions:npositions,edges:ncells}};var _$createSurfaceExtractor_266=function createSurfaceExtractor(args){function error(msg){throw new Error("ndarray-extract-contour: "+msg)}"object"!=typeof args&&error("Must specify arguments");var order=args.order;Array.isArray(order)||error("Must specify order");var arrays=args.arrayArguments||1;arrays<1&&error("Must have at least one array argument");var scalars=args.scalarArguments||0;scalars<0&&error("Scalar arg count must be > 0");"function"!=typeof args.vertex&&error("Must specify vertex creation function");"function"!=typeof args.cell&&error("Must specify cell creation function");"function"!=typeof args.phase&&error("Must specify phase function");for(var getters=args.getters||[],typesig=new Array(arrays),i=0;i<arrays;++i)getters.indexOf(i)>=0?typesig[i]=!0:typesig[i]=!1;return function compileSurfaceProcedure(vertexFunc,faceFunc,phaseFunc,scalarArgs,order,typesig){var arrayArgs=typesig.length,dimension=order.length;if(dimension<2)throw new Error("ndarray-extract-contour: Dimension must be at least 2");for(var funcName="extractContour"+order.join("_"),code=[],vars=[],args=[],i=0;i<arrayArgs;++i)args.push(array(i));for(var i=0;i<scalarArgs;++i)args.push(scalar(i));for(var i=0;i<dimension;++i)vars.push(shape(i)+"="+array(0)+".shape["+i+"]|0");for(var i=0;i<arrayArgs;++i){vars.push(data(i)+"="+array(i)+".data",offset(i)+"="+array(i)+".offset|0");for(var j=0;j<dimension;++j)vars.push(stride(i,j)+"="+array(i)+".stride["+j+"]|0")}for(var i=0;i<arrayArgs;++i){vars.push(pointer(i)+"="+offset(i)),vars.push(cube(i,0));for(var j=1;j<1<<dimension;++j){for(var ptrStr=[],k=0;k<dimension;++k)j&1<<k&&ptrStr.push("-"+stride(i,k));vars.push(delta(i,j)+"=("+ptrStr.join("")+")|0"),vars.push(cube(i,j)+"=0")}}for(var i=0;i<arrayArgs;++i)for(var j=0;j<dimension;++j){var stepVal=[stride(i,order[j])];j>0&&stepVal.push(stride(i,order[j-1])+"*"+shape(order[j-1])),vars.push(step(i,order[j])+"=("+stepVal.join("-")+")|0")}for(var i=0;i<dimension;++i)vars.push(index(i)+"=0");vars.push(VERTEX_COUNT+"=0");for(var sizeVariable=["2"],i=dimension-2;i>=0;--i)sizeVariable.push(shape(order[i]));vars.push(POOL_SIZE+"=("+sizeVariable.join("*")+")|0",PHASES+"=mallocUint32("+POOL_SIZE+")",VERTEX_IDS+"=mallocUint32("+POOL_SIZE+")",POINTER+"=0"),vars.push(pcube(0)+"=0");for(var j=1;j<1<<dimension;++j){for(var cubeDelta=[],cubeStep=[],k=0;k<dimension;++k)j&1<<k&&(0===cubeStep.length?cubeDelta.push("1"):cubeDelta.unshift(cubeStep.join("*"))),cubeStep.push(shape(order[k]));var signFlag="";cubeDelta[0].indexOf(shape(order[dimension-2]))<0&&(signFlag="-");var jperm=permBitmask(dimension,j,order);vars.push(pdelta(jperm)+"=(-"+cubeDelta.join("-")+")|0",qcube(jperm)+"=("+signFlag+cubeDelta.join("-")+")|0",pcube(jperm)+"=0")}function forLoopBegin(i,start){code.push("for(",index(order[i]),"=",start,";",index(order[i]),"<",shape(order[i]),";","++",index(order[i]),"){")}function forLoopEnd(i){for(var j=0;j<arrayArgs;++j)code.push(pointer(j),"+=",step(j,order[i]),";");code.push("}")}function flip(){for(var j=1;j<1<<dimension;++j)code.push(TEMPORARY,"=",pdelta(j),";",pdelta(j),"=",qcube(j),";",qcube(j),"=",TEMPORARY,";")}vars.push(vert(0)+"=0",TEMPORARY+"=0"),function createLoop(i,mask){if(i<0)return void function processGridCell(mask){for(var i=0;i<arrayArgs;++i)typesig[i]?code.push(cube(i,0),"=",data(i),".get(",pointer(i),");"):code.push(cube(i,0),"=",data(i),"[",pointer(i),"];");for(var phaseFuncArgs=[],i=0;i<arrayArgs;++i)phaseFuncArgs.push(cube(i,0));for(var i=0;i<scalarArgs;++i)phaseFuncArgs.push(scalar(i));code.push(pcube(0),"=",PHASES,"[",POINTER,"]=phase(",phaseFuncArgs.join(),");");for(var j=1;j<1<<dimension;++j)code.push(pcube(j),"=",PHASES,"[",POINTER,"+",pdelta(j),"];");for(var vertexPredicate=[],j=1;j<1<<dimension;++j)vertexPredicate.push("("+pcube(0)+"!=="+pcube(j)+")");code.push("if(",vertexPredicate.join("||"),"){");for(var vertexArgs=[],i=0;i<dimension;++i)vertexArgs.push(index(i));for(var i=0;i<arrayArgs;++i){vertexArgs.push(cube(i,0));for(var j=1;j<1<<dimension;++j)typesig[i]?code.push(cube(i,j),"=",data(i),".get(",pointer(i),"+",delta(i,j),");"):code.push(cube(i,j),"=",data(i),"[",pointer(i),"+",delta(i,j),"];"),vertexArgs.push(cube(i,j))}for(var i=0;i<1<<dimension;++i)vertexArgs.push(pcube(i));for(var i=0;i<scalarArgs;++i)vertexArgs.push(scalar(i));code.push("vertex(",vertexArgs.join(),");",vert(0),"=",VERTEX_IDS,"[",POINTER,"]=",VERTEX_COUNT,"++;");for(var base=(1<<dimension)-1,corner=pcube(base),j=0;j<dimension;++j)if(0==(mask&~(1<<j))){for(var subset=base^1<<j,edge=pcube(subset),faceArgs=[],k=subset;k>0;k=k-1&subset)faceArgs.push(VERTEX_IDS+"["+POINTER+"+"+pdelta(k)+"]");faceArgs.push(vert(0));for(var k=0;k<arrayArgs;++k)1&j?faceArgs.push(cube(k,base),cube(k,subset)):faceArgs.push(cube(k,subset),cube(k,base));1&j?faceArgs.push(corner,edge):faceArgs.push(edge,corner);for(var k=0;k<scalarArgs;++k)faceArgs.push(scalar(k));code.push("if(",corner,"!==",edge,"){","face(",faceArgs.join(),")}")}code.push("}",POINTER,"+=1;")}(mask);!function fillEmptySlice(k){for(var i=k-1;i>=0;--i)forLoopBegin(i,0);for(var phaseFuncArgs=[],i=0;i<arrayArgs;++i)typesig[i]?phaseFuncArgs.push(data(i)+".get("+pointer(i)+")"):phaseFuncArgs.push(data(i)+"["+pointer(i)+"]");for(var i=0;i<scalarArgs;++i)phaseFuncArgs.push(scalar(i));code.push(PHASES,"[",POINTER,"++]=phase(",phaseFuncArgs.join(),");");for(var i=0;i<k;++i)forLoopEnd(i);for(var j=0;j<arrayArgs;++j)code.push(pointer(j),"+=",step(j,order[k]),";")}(i);code.push("if(",shape(order[i]),">0){",index(order[i]),"=1;");createLoop(i-1,mask|1<<order[i]);for(var j=0;j<arrayArgs;++j)code.push(pointer(j),"+=",step(j,order[i]),";");i===dimension-1&&(code.push(POINTER,"=0;"),flip());forLoopBegin(i,2);createLoop(i-1,mask);i===dimension-1&&(code.push("if(",index(order[dimension-1]),"&1){",POINTER,"=0;}"),flip());forLoopEnd(i);code.push("}")}(dimension-1,0),code.push("freeUint32(",VERTEX_IDS,");freeUint32(",PHASES,");");var procedureCode=["'use strict';","function ",funcName,"(",args.join(),"){","var ",vars.join(),";",code.join(""),"}","return ",funcName].join("");return new Function("vertex","face","phase","mallocUint32","freeUint32",procedureCode)(vertexFunc,faceFunc,phaseFunc,_$pool_360.mallocUint32,_$pool_360.freeUint32)}(args.vertex,args.cell,args.phase,scalars,order,typesig)};function array(i){return"a"+i}function data(i){return"d"+i}function cube(i,bitmask){return"c"+i+"_"+bitmask}function shape(i){return"s"+i}function stride(i,j){return"t"+i+"_"+j}function offset(i){return"o"+i}function scalar(i){return"x"+i}function pointer(i){return"p"+i}function delta(i,bitmask){return"d"+i+"_"+bitmask}function index(i){return"i"+i}function step(i,j){return"u"+i+"_"+j}function pcube(bitmask){return"b"+bitmask}function qcube(bitmask){return"y"+bitmask}function pdelta(bitmask){return"e"+bitmask}function vert(i){return"v"+i}var VERTEX_IDS="V",PHASES="P",VERTEX_COUNT="N",POOL_SIZE="Q",POINTER="X",TEMPORARY="T";function permBitmask(dimension,mask,order){for(var r=0,i=0;i<dimension;++i)mask&1<<i&&(r|=1<<order[i]);return r}var _$gamma_143={},p=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7],g_ln=607/128,p_ln=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function lngamma(z){if(z<0)return Number("0/0");for(var x=p_ln[0],i=p_ln.length-1;i>0;--i)x+=p_ln[i]/(z+i);var t=z+g_ln+.5;return.5*Math.log(2*Math.PI)+(z+.5)*Math.log(t)-t+Math.log(x)-Math.log(z)}(_$gamma_143=function gamma(z){if(z<.5)return Math.PI/(Math.sin(Math.PI*z)*gamma(1-z));if(z>100)return Math.exp(lngamma(z));z-=1;for(var x=p[0],i=1;i<9;i++)x+=p[i]/(z+i);var t=z+7+.5;return Math.sqrt(2*Math.PI)*Math.pow(t,z+.5)*Math.exp(-t)*x}).log=lngamma;var _$permutationSign_288=function permutationSign(p){var n=p.length;if(n<__BRUTE_FORCE_CUTOFF_288){for(var sgn=1,i=0;i<n;++i)for(var j=0;j<i;++j)if(p[i]<p[j])sgn=-sgn;else if(p[i]===p[j])return 0;return sgn}for(var visited=_$pool_360.mallocUint8(n),i=0;i<n;++i)visited[i]=0;for(var sgn=1,i=0;i<n;++i)if(!visited[i]){var count=1;visited[i]=1;for(var j=p[i];j!==i;j=p[j]){if(visited[j])return _$pool_360.freeUint8(visited),0;count+=1,visited[j]=1}1&count||(sgn=-sgn)}return _$pool_360.freeUint8(visited),sgn},__BRUTE_FORCE_CUTOFF_288=32;var _$invertPermutation_244=function invertPermutation(pi,result){result=result||new Array(pi.length);for(var i=0;i<pi.length;++i)result[pi[i]]=i;return result},_$permutationRank_289={};_$permutationRank_289.rank=function rank(permutation){var n=permutation.length;switch(n){case 0:case 1:return 0;case 2:return permutation[1]}var s,t,i,p=_$pool_360.mallocUint32(n),pinv=_$pool_360.mallocUint32(n),r=0;for(_$invertPermutation_244(permutation,pinv),i=0;i<n;++i)p[i]=permutation[i];for(i=n-1;i>0;--i)t=pinv[i],s=p[i],p[i]=p[t],p[t]=s,pinv[i]=pinv[s],pinv[s]=t,r=(r+s)*i;return _$pool_360.freeUint32(pinv),_$pool_360.freeUint32(p),r},_$permutationRank_289.unrank=function unrank(n,r,p){switch(n){case 0:return p||[];case 1:return p?(p[0]=0,p):[0];case 2:return p?(r?(p[0]=0,p[1]=1):(p[0]=1,p[1]=0),p):r?[0,1]:[1,0]}var s,t,i,nf=1;for((p=p||new Array(n))[0]=0,i=1;i<n;++i)p[i]=i,nf=nf*i|0;for(i=n-1;i>0;--i)r=r-(s=r/nf|0)*nf|0,nf=nf/i|0,t=0|p[i],p[i]=0|p[s],p[s]=0|t;return p};var _$triangulateCube_356=function triangulateCube(dimension){if(dimension<0)return[];if(0===dimension)return[[0]];for(var dfactorial=0|Math.round(_$gamma_143(dimension+1)),result=[],i=0;i<dfactorial;++i){for(var p=_$permutationRank_289.unrank(dimension,i),cell=[0],v=0,j=0;j<p.length;++j)v+=1<<p[j],cell.push(v);_$permutationSign_288(p)<1&&(cell[0]=v,cell[dimension]=0),result.push(cell)}return result};var _$zcCore_390=_$compileCwise_115({args:["array",{offset:[1],array:0},"scalar","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\n        var _inline_1_da = _inline_1_arg0_ - _inline_1_arg3_\n        var _inline_1_db = _inline_1_arg1_ - _inline_1_arg3_\n        if((_inline_1_da >= 0) !== (_inline_1_db >= 0)) {\n          _inline_1_arg2_.push(_inline_1_arg4_[0] + 0.5 + 0.5 * (_inline_1_da + _inline_1_db) / (_inline_1_da - _inline_1_db))\n        }\n      }",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg3_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:[],localVars:["_inline_1_da","_inline_1_db"]},funcName:"zeroCrossings"}),_$findZeroCrossings_391=function findZeroCrossings(array,level){var cross=[];return level=+level||0,_$zcCore_390(array.hi(array.shape[0]-1),cross,level),cross};var _$surfaceNets_346=function surfaceNets(array,level){if(array.dimension<=0)return{positions:[],cells:[]};if(1===array.dimension)return function mesh1D(array,level){for(var zc=_$findZeroCrossings_391(array,level),n=zc.length,npos=new Array(n),ncel=new Array(n),i=0;i<n;++i)npos[i]=[zc[i]],ncel[i]=[i];return{positions:npos,cells:ncel}}(array,level);var typesig=array.order.join()+"-"+array.dtype,proc=__CACHE_346[typesig],level=+level||0;proc||(proc=__CACHE_346[typesig]=function buildSurfaceNets(order,dtype){var dimension=order.length,code=["'use strict';"],funcName="surfaceNets"+order.join("_")+"d"+dtype;code.push("var contour=genContour({","order:[",order.join(),"],","scalarArguments: 3,","phase:function phaseFunc(p,a,b,c) { return (p > c)|0 },"),"generic"===dtype&&code.push("getters:[0],");for(var cubeArgs=[],extraArgs=[],i=0;i<dimension;++i)cubeArgs.push("d"+i),extraArgs.push("d"+i);for(var i=0;i<1<<dimension;++i)cubeArgs.push("v"+i),extraArgs.push("v"+i);for(var i=0;i<1<<dimension;++i)cubeArgs.push("p"+i),extraArgs.push("p"+i);cubeArgs.push("a","b","c"),extraArgs.push("a","c"),code.push("vertex:function vertexFunc(",cubeArgs.join(),"){");for(var maskStr=[],i=0;i<1<<dimension;++i)maskStr.push("(p"+i+"<<"+i+")");code.push("var m=(",maskStr.join("+"),")|0;if(m===0||m===",(1<<(1<<dimension))-1,"){return}");var extraFuncs=[],currentFunc=[];1<<(1<<dimension)<=128?(code.push("switch(m){"),currentFunc=code):code.push("switch(m>>>7){");for(var i=0;i<1<<(1<<dimension);++i){if(1<<(1<<dimension)>128&&i%128==0){extraFuncs.length>0&&currentFunc.push("}}");var efName="vExtra"+extraFuncs.length;code.push("case ",i>>>7,":",efName,"(m&0x7f,",extraArgs.join(),");break;"),currentFunc=["function ",efName,"(m,",extraArgs.join(),"){switch(m){"],extraFuncs.push(currentFunc)}currentFunc.push("case ",127&i,":");for(var crossings=new Array(dimension),denoms=new Array(dimension),crossingCount=new Array(dimension),bias=new Array(dimension),totalCrossings=0,j=0;j<dimension;++j)crossings[j]=[],denoms[j]=[],crossingCount[j]=0,bias[j]=0;for(var j=0;j<1<<dimension;++j)for(var k=0;k<dimension;++k){var u=j^1<<k;if(!(u>j)&&!(i&1<<u)!=!(i&1<<j)){var sign=1;i&1<<u?denoms[k].push("v"+u+"-v"+j):(denoms[k].push("v"+j+"-v"+u),sign=-sign),sign<0?(crossings[k].push("-v"+j+"-v"+u),crossingCount[k]+=2):(crossings[k].push("v"+j+"+v"+u),crossingCount[k]-=2),totalCrossings+=1;for(var l=0;l<dimension;++l)l!==k&&(u&1<<l?bias[l]+=1:bias[l]-=1)}}for(var vertexStr=[],k=0;k<dimension;++k)if(0===crossings[k].length)vertexStr.push("d"+k+"-0.5");else{var cStr="";crossingCount[k]<0?cStr=crossingCount[k]+"*c":crossingCount[k]>0&&(cStr="+"+crossingCount[k]+"*c");var weight=crossings[k].length/totalCrossings*.5,shift=.5+bias[k]/totalCrossings*.5;vertexStr.push("d"+k+"-"+shift+"-"+weight+"*("+crossings[k].join("+")+cStr+")/("+denoms[k].join("+")+")")}currentFunc.push("a.push([",vertexStr.join(),"]);","break;")}code.push("}},"),extraFuncs.length>0&&currentFunc.push("}}");for(var faceArgs=[],i=0;i<1<<dimension-1;++i)faceArgs.push("v"+i);faceArgs.push("c0","c1","p0","p1","a","b","c"),code.push("cell:function cellFunc(",faceArgs.join(),"){");var facets=_$triangulateCube_356(dimension-1);code.push("if(p0){b.push(",facets.map(function(f){return"["+f.map(function(v){return"v"+v})+"]"}).join(),")}else{b.push(",facets.map(function(f){var e=f.slice();return e.reverse(),"["+e.map(function(v){return"v"+v})+"]"}).join(),")}}});function ",funcName,"(array,level){var verts=[],cells=[];contour(array,verts,cells,level);return {positions:verts,cells:cells};} return ",funcName,";");for(var i=0;i<extraFuncs.length;++i)code.push(extraFuncs[i].join(""));return new Function("genContour",code.join(""))(_$createSurfaceExtractor_266)}(array.order,array.dtype));return proc(array,level)};var __CACHE_346={};var _$vtext_368={};function processPixelsImpl(pixels,options,size,simplify){var contour=function getContour(pixels,doSimplify){var contour=_$surfaceNets_346(pixels,128);return doSimplify?_$simplifyPolygon_337(contour.cells,contour.positions,.25):{edges:contour.cells,positions:contour.positions}}(pixels,simplify),positions=function transformPositions(positions,options,size){for(var align=options.textAlign||"start",baseline=options.textBaseline||"alphabetic",lo=[1<<30,1<<30],hi=[0,0],n=positions.length,i=0;i<n;++i)for(var p=positions[i],j=0;j<2;++j)lo[j]=0|Math.min(lo[j],p[j]),hi[j]=0|Math.max(hi[j],p[j]);var xShift=0;switch(align){case"center":xShift=-.5*(lo[0]+hi[0]);break;case"right":case"end":xShift=-hi[0];break;case"left":case"start":xShift=-lo[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+align+"'")}var yShift=0;switch(baseline){case"hanging":case"top":yShift=-lo[1];break;case"middle":yShift=-.5*(lo[1]+hi[1]);break;case"alphabetic":case"ideographic":yShift=-3*size;break;case"bottom":yShift=-hi[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+baseline+"'")}var scale=1/size;return"lineHeight"in options?scale*=+options.lineHeight:"width"in options?scale=options.width/(hi[0]-lo[0]):"height"in options&&(scale=options.height/(hi[1]-lo[1])),positions.map(function(p){return[scale*(p[0]+xShift),scale*(p[1]+yShift)]})}(contour.positions,options,size),edges=contour.edges,flip="ccw"===options.orientation;if(_$cleanPSLG_95(positions,edges),options.polygons||options.polygon||options.polyline){for(var result=_$planarGraphToPolyline_293(edges,positions),nresult=new Array(result.length),i=0;i<result.length;++i){for(var loops=result[i],nloops=new Array(loops.length),j=0;j<loops.length;++j){for(var loop=loops[j],nloop=new Array(loop.length),k=0;k<loop.length;++k)nloop[k]=positions[loop[k]].slice();flip&&nloop.reverse(),nloops[j]=nloop}nresult[i]=nloops}return nresult}return options.triangles||options.triangulate||options.triangle?{cells:_$cdt2d_85(positions,edges,{delaunay:!1,exterior:!1,interior:!0}),positions:positions}:{edges:edges,positions:positions}}function processPixels(pixels,options,size){try{return processPixelsImpl(pixels,options,size,!0)}catch(e){}try{return processPixelsImpl(pixels,options,size,!1)}catch(e){}return options.polygons||options.polyline||options.polygon?[]:options.triangles||options.triangulate||options.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}(_$vtext_368=function vectorizeText(str,canvas,context,options){var size=options.size||64,family=options.font||"normal";return context.font=size+"px "+family,context.textAlign="start",context.textBaseline="alphabetic",context.direction="ltr",processPixels(function getPixels(canvas,context,str,size){var width=0|Math.ceil(context.measureText(str).width+2*size);if(width>8192)throw new Error("vectorize-text: String too long (sorry, this will get fixed later)");var height=3*size;canvas.height<height&&(canvas.height=height),context.fillStyle="#000",context.fillRect(0,0,canvas.width,canvas.height),context.fillStyle="#fff",context.fillText(str,size,2*size);var pixelData=context.getImageData(0,0,width,height);return _$wrappedNDArrayCtor_277(pixelData.data,[height,width,4]).pick(-1,-1,0).transpose(1,0)}(canvas,context,str,size),options,size)}).processPixels=processPixels;var _$createText_367=function createText(str,options){"object"==typeof options&&null!==options||(options={});return _$vtext_368(str,options.canvas||defaultCanvas,options.context||defaultContext,options)},defaultCanvas=null,defaultContext=null;"undefined"!=typeof document&&((defaultCanvas=document.createElement("canvas")).width=8192,defaultCanvas.height=1024,defaultContext=defaultCanvas.getContext("2d"));var _$textGet_351={};(function(process){"use strict";_$textGet_351=function textGet(font,text,opts){var opts=opts||{};var fontcache=__TEXT_CACHE[font];fontcache||(fontcache=__TEXT_CACHE[font]={" ":{data:new Float32Array(0),shape:.2}});var mesh=fontcache[text];if(!mesh)if(text.length<=1||!/\d/.test(text))mesh=fontcache[text]=function unwrap(mesh){for(var cells=mesh.cells,positions=mesh.positions,data=new Float32Array(6*cells.length),ptr=0,shapeX=0,i=0;i<cells.length;++i)for(var tri=cells[i],j=0;j<3;++j){var point=positions[tri[j]];data[ptr++]=point[0],data[ptr++]=point[1]+1.4,shapeX=Math.max(point[0],shapeX)}return{data:data,shape:shapeX}}(_$createText_367(text,{triangles:!0,font:font,textAlign:opts.textAlign||"left",textBaseline:"alphabetic"}));else{for(var parts=text.split(/(\d|\s)/),buffer=new Array(parts.length),bufferSize=0,shapeX=0,i=0;i<parts.length;++i)buffer[i]=textGet(font,parts[i]),bufferSize+=buffer[i].data.length,shapeX+=buffer[i].shape,i>0&&(shapeX+=.02);for(var data=new Float32Array(bufferSize),ptr=0,xOffset=-.5*shapeX,i=0;i<buffer.length;++i){for(var bdata=buffer[i].data,j=0;j<bdata.length;j+=2)data[ptr++]=bdata[j]+xOffset,data[ptr++]=bdata[j+1];xOffset+=buffer[i].shape+.02}mesh=fontcache[text]={data:data,shape:shapeX}}return mesh};var globals=window||process.global||{},__TEXT_CACHE=globals.__TEXT_CACHE||{};globals.__TEXT_CACHE={}}).call(this,_$browser_304);var _$createTextElements_192=function createTextElements(plot){var gl=plot.gl,vbo=_$createBuffer_153(gl),shader=_$createShader_206(gl,_$shaders_191.textVert,_$shaders_191.textFrag);return new TextElements(plot,vbo,shader)};function TextElements(plot,vbo,shader){this.plot=plot,this.vbo=vbo,this.shader=shader,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}var __proto_192=TextElements.prototype;__proto_192.drawTicks=function(){var DATA_AXIS=[0,0],SCREEN_OFFSET=[0,0],ZERO_2=[0,0];return function(axis){var plot=this.plot,shader=this.shader,tickX=this.tickX[axis],tickOffset=this.tickOffset[axis],gl=plot.gl,viewBox=plot.viewBox,dataBox=plot.dataBox,screenBox=plot.screenBox,pixelRatio=plot.pixelRatio,tickEnable=plot.tickEnable,tickPad=plot.tickPad,textColor=plot.tickColor,textAngle=plot.tickAngle,labelEnable=plot.labelEnable,labelPad=plot.labelPad,labelColor=plot.labelColor,labelAngle=plot.labelAngle,labelOffset=this.labelOffset[axis],labelCount=this.labelCount[axis],start=_$searchBounds_193.lt(tickX,dataBox[axis]),end=_$searchBounds_193.le(tickX,dataBox[axis+2]);DATA_AXIS[0]=DATA_AXIS[1]=0,DATA_AXIS[axis]=1,SCREEN_OFFSET[axis]=(viewBox[2+axis]+viewBox[axis])/(screenBox[2+axis]-screenBox[axis])-1;var screenScale=2/screenBox[2+(1^axis)]-screenBox[1^axis];SCREEN_OFFSET[1^axis]=screenScale*viewBox[1^axis]-1,tickEnable[axis]&&(SCREEN_OFFSET[1^axis]-=screenScale*pixelRatio*tickPad[axis],start<end&&tickOffset[end]>tickOffset[start]&&(shader.uniforms.dataAxis=DATA_AXIS,shader.uniforms.screenOffset=SCREEN_OFFSET,shader.uniforms.color=textColor[axis],shader.uniforms.angle=textAngle[axis],gl.drawArrays(gl.TRIANGLES,tickOffset[start],tickOffset[end]-tickOffset[start]))),labelEnable[axis]&&labelCount&&(SCREEN_OFFSET[1^axis]-=screenScale*pixelRatio*labelPad[axis],shader.uniforms.dataAxis=ZERO_2,shader.uniforms.screenOffset=SCREEN_OFFSET,shader.uniforms.color=labelColor[axis],shader.uniforms.angle=labelAngle[axis],gl.drawArrays(gl.TRIANGLES,labelOffset,labelCount)),SCREEN_OFFSET[1^axis]=screenScale*viewBox[2+(1^axis)]-1,tickEnable[axis+2]&&(SCREEN_OFFSET[1^axis]+=screenScale*pixelRatio*tickPad[axis+2],start<end&&tickOffset[end]>tickOffset[start]&&(shader.uniforms.dataAxis=DATA_AXIS,shader.uniforms.screenOffset=SCREEN_OFFSET,shader.uniforms.color=textColor[axis+2],shader.uniforms.angle=textAngle[axis+2],gl.drawArrays(gl.TRIANGLES,tickOffset[start],tickOffset[end]-tickOffset[start]))),labelEnable[axis+2]&&labelCount&&(SCREEN_OFFSET[1^axis]+=screenScale*pixelRatio*labelPad[axis+2],shader.uniforms.dataAxis=ZERO_2,shader.uniforms.screenOffset=SCREEN_OFFSET,shader.uniforms.color=labelColor[axis+2],shader.uniforms.angle=labelAngle[axis+2],gl.drawArrays(gl.TRIANGLES,labelOffset,labelCount))}}(),__proto_192.drawTitle=function(){var DATA_AXIS=[0,0],SCREEN_OFFSET=[0,0];return function(){var plot=this.plot,shader=this.shader,gl=plot.gl,screenBox=plot.screenBox,titleCenter=plot.titleCenter,titleAngle=plot.titleAngle,titleColor=plot.titleColor,pixelRatio=plot.pixelRatio;if(this.titleCount){for(var i=0;i<2;++i)SCREEN_OFFSET[i]=2*(titleCenter[i]*pixelRatio-screenBox[i])/(screenBox[2+i]-screenBox[i])-1;shader.bind(),shader.uniforms.dataAxis=DATA_AXIS,shader.uniforms.screenOffset=SCREEN_OFFSET,shader.uniforms.angle=titleAngle,shader.uniforms.color=titleColor,gl.drawArrays(gl.TRIANGLES,this.titleOffset,this.titleCount)}}}(),__proto_192.bind=function(){var DATA_SHIFT=[0,0],DATA_SCALE=[0,0],TEXT_SCALE=[0,0];return function(){var plot=this.plot,shader=this.shader,bounds=plot._tickBounds,dataBox=plot.dataBox,screenBox=plot.screenBox,viewBox=plot.viewBox;shader.bind();for(var i=0;i<2;++i){var lo=bounds[i],boundScale=bounds[i+2]-lo,dataCenter=.5*(dataBox[i+2]+dataBox[i]),dataWidth=dataBox[i+2]-dataBox[i],viewLo=viewBox[i],viewScale=viewBox[i+2]-viewLo,screenLo=screenBox[i],screenScale=screenBox[i+2]-screenLo;DATA_SCALE[i]=2*boundScale/dataWidth*viewScale/screenScale,DATA_SHIFT[i]=2*(lo-dataCenter)/dataWidth*viewScale/screenScale}TEXT_SCALE[1]=2*plot.pixelRatio/(screenBox[3]-screenBox[1]),TEXT_SCALE[0]=TEXT_SCALE[1]*(screenBox[3]-screenBox[1])/(screenBox[2]-screenBox[0]),shader.uniforms.dataScale=DATA_SCALE,shader.uniforms.dataShift=DATA_SHIFT,shader.uniforms.textScale=TEXT_SCALE,this.vbo.bind(),shader.attributes.textCoordinate.pointer()}}(),__proto_192.update=function(options){var i,j,data,scale,dimension,vertices=[],axesTicks=options.ticks,bounds=options.bounds;for(dimension=0;dimension<2;++dimension){var offsets=[Math.floor(vertices.length/3)],tickX=[-1/0],ticks=axesTicks[dimension];for(i=0;i<ticks.length;++i){var tick=ticks[i],x=tick.x,text=tick.text,font=tick.font||"sans-serif";scale=tick.fontSize||12;for(var coordScale=1/(bounds[dimension+2]-bounds[dimension]),coordShift=bounds[dimension],rows=text.split("\n"),r=0;r<rows.length;r++)for(data=_$textGet_351(font,rows[r]).data,j=0;j<data.length;j+=2)vertices.push(data[j]*scale,-data[j+1]*scale-r*scale*1.2,(x-coordShift)*coordScale);offsets.push(Math.floor(vertices.length/3)),tickX.push(x)}this.tickOffset[dimension]=offsets,this.tickX[dimension]=tickX}for(dimension=0;dimension<2;++dimension){for(this.labelOffset[dimension]=Math.floor(vertices.length/3),data=_$textGet_351(options.labelFont[dimension],options.labels[dimension],{textAlign:"center"}).data,scale=options.labelSize[dimension],i=0;i<data.length;i+=2)vertices.push(data[i]*scale,-data[i+1]*scale,0);this.labelCount[dimension]=Math.floor(vertices.length/3)-this.labelOffset[dimension]}for(this.titleOffset=Math.floor(vertices.length/3),data=_$textGet_351(options.titleFont,options.title).data,scale=options.titleSize,i=0;i<data.length;i+=2)vertices.push(data[i]*scale,-data[i+1]*scale,0);this.titleCount=Math.floor(vertices.length/3)-this.titleOffset,this.vbo.update(vertices)},__proto_192.dispose=function(){this.vbo.dispose(),this.shader.dispose()};var _$wrapper_118=_$compileCwise_115,_$createTexture2D_218=function createTexture2D(gl){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");linearTypes||function lazyInitLinearTypes(gl){linearTypes=[gl.LINEAR,gl.NEAREST_MIPMAP_LINEAR,gl.LINEAR_MIPMAP_NEAREST,gl.LINEAR_MIPMAP_NEAREST],filterTypes=[gl.NEAREST,gl.LINEAR,gl.NEAREST_MIPMAP_NEAREST,gl.NEAREST_MIPMAP_LINEAR,gl.LINEAR_MIPMAP_NEAREST,gl.LINEAR_MIPMAP_LINEAR],wrapTypes=[gl.REPEAT,gl.CLAMP_TO_EDGE,gl.MIRRORED_REPEAT]}(gl);if("number"==typeof arguments[1])return createTextureShape(gl,arguments[1],arguments[2],arguments[3]||gl.RGBA,arguments[4]||gl.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return createTextureShape(gl,0|arguments[1][0],0|arguments[1][1],arguments[2]||gl.RGBA,arguments[3]||gl.UNSIGNED_BYTE);if("object"==typeof arguments[1]){var obj=arguments[1],directData=acceptTextureDOM(obj)?obj:obj.raw;if(directData)return function createTextureDOM(gl,directData,width,height,format,type){var tex=initTexture(gl);return gl.texImage2D(gl.TEXTURE_2D,0,format,format,type,directData),new Texture2D(gl,tex,width,height,format,type)}(gl,directData,0|obj.width,0|obj.height,arguments[2]||gl.RGBA,arguments[3]||gl.UNSIGNED_BYTE);if(obj.shape&&obj.data&&obj.stride)return function createTextureArray(gl,array){var dtype=array.dtype,shape=array.shape.slice(),maxSize=gl.getParameter(gl.MAX_TEXTURE_SIZE);if(shape[0]<0||shape[0]>maxSize||shape[1]<0||shape[1]>maxSize)throw new Error("gl-texture2d: Invalid texture size");var packed=__isPacked_218(shape,array.stride.slice()),type=0;"float32"===dtype?type=gl.FLOAT:"float64"===dtype?(type=gl.FLOAT,packed=!1,dtype="float32"):"uint8"===dtype?type=gl.UNSIGNED_BYTE:(type=gl.UNSIGNED_BYTE,packed=!1,dtype="uint8");var buffer,buf_store,format=0;if(2===shape.length)format=gl.LUMINANCE,shape=[shape[0],shape[1],1],array=_$wrappedNDArrayCtor_277(array.data,shape,[array.stride[0],array.stride[1],1],array.offset);else{if(3!==shape.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===shape[2])format=gl.ALPHA;else if(2===shape[2])format=gl.LUMINANCE_ALPHA;else if(3===shape[2])format=gl.RGB;else{if(4!==shape[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");format=gl.RGBA}}type!==gl.FLOAT||gl.getExtension("OES_texture_float")||(type=gl.UNSIGNED_BYTE,packed=!1);var size=array.size;if(packed)buffer=0===array.offset&&array.data.length===size?array.data:array.data.subarray(array.offset,array.offset+size);else{var stride=[shape[2],shape[2]*shape[0],1];buf_store=_$pool_360.malloc(size,dtype);var buf_array=_$wrappedNDArrayCtor_277(buf_store,shape,stride,0);"float32"!==dtype&&"float64"!==dtype||type!==gl.UNSIGNED_BYTE?_$ndarrayOps_271.assign(buf_array,array):convertFloatToUint8(buf_array,array),buffer=buf_store.subarray(0,size)}var tex=initTexture(gl);gl.texImage2D(gl.TEXTURE_2D,0,format,shape[0],shape[1],0,format,type,buffer),packed||_$pool_360.free(buf_store);return new Texture2D(gl,tex,shape[0],shape[1],format,type)}(gl,obj)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")},linearTypes=null,filterTypes=null,wrapTypes=null;function acceptTextureDOM(obj){return"undefined"!=typeof HTMLCanvasElement&&obj instanceof HTMLCanvasElement||"undefined"!=typeof HTMLImageElement&&obj instanceof HTMLImageElement||"undefined"!=typeof HTMLVideoElement&&obj instanceof HTMLVideoElement||"undefined"!=typeof ImageData&&obj instanceof ImageData}var convertFloatToUint8=function(out,inp){_$ndarrayOps_271.muls(out,inp,255)};function reshapeTexture(tex,w,h){var gl=tex.gl,maxSize=gl.getParameter(gl.MAX_TEXTURE_SIZE);if(w<0||w>maxSize||h<0||h>maxSize)throw new Error("gl-texture2d: Invalid texture size");return tex._shape=[w,h],tex.bind(),gl.texImage2D(gl.TEXTURE_2D,0,tex.format,w,h,0,tex.format,tex.type,null),tex._mipLevels=[0],tex}function Texture2D(gl,handle,width,height,format,type){this.gl=gl,this.handle=handle,this.format=format,this.type=type,this._shape=[width,height],this._mipLevels=[0],this._magFilter=gl.NEAREST,this._minFilter=gl.NEAREST,this._wrapS=gl.CLAMP_TO_EDGE,this._wrapT=gl.CLAMP_TO_EDGE,this._anisoSamples=1;var parent=this,wrapVector=[this._wrapS,this._wrapT];Object.defineProperties(wrapVector,[{get:function(){return parent._wrapS},set:function(v){return parent.wrapS=v}},{get:function(){return parent._wrapT},set:function(v){return parent.wrapT=v}}]),this._wrapVector=wrapVector;var shapeVector=[this._shape[0],this._shape[1]];Object.defineProperties(shapeVector,[{get:function(){return parent._shape[0]},set:function(v){return parent.width=v}},{get:function(){return parent._shape[1]},set:function(v){return parent.height=v}}]),this._shapeVector=shapeVector}var __proto_218=Texture2D.prototype;function __isPacked_218(shape,stride){return 3===shape.length?1===stride[2]&&stride[1]===shape[0]*shape[2]&&stride[0]===shape[2]:1===stride[0]&&stride[1]===shape[0]}function initTexture(gl){var tex=gl.createTexture();return gl.bindTexture(gl.TEXTURE_2D,tex),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),tex}function createTextureShape(gl,width,height,format,type){var maxTextureSize=gl.getParameter(gl.MAX_TEXTURE_SIZE);if(width<0||width>maxTextureSize||height<0||height>maxTextureSize)throw new Error("gl-texture2d: Invalid texture shape");if(type===gl.FLOAT&&!gl.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var tex=initTexture(gl);return gl.texImage2D(gl.TEXTURE_2D,0,format,width,height,0,format,type,null),new Texture2D(gl,tex,width,height,format,type)}Object.defineProperties(__proto_218,{minFilter:{get:function(){return this._minFilter},set:function(v){this.bind();var gl=this.gl;if(this.type===gl.FLOAT&&linearTypes.indexOf(v)>=0&&(gl.getExtension("OES_texture_float_linear")||(v=gl.NEAREST)),filterTypes.indexOf(v)<0)throw new Error("gl-texture2d: Unknown filter mode "+v);return gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,v),this._minFilter=v}},magFilter:{get:function(){return this._magFilter},set:function(v){this.bind();var gl=this.gl;if(this.type===gl.FLOAT&&linearTypes.indexOf(v)>=0&&(gl.getExtension("OES_texture_float_linear")||(v=gl.NEAREST)),filterTypes.indexOf(v)<0)throw new Error("gl-texture2d: Unknown filter mode "+v);return gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,v),this._magFilter=v}},mipSamples:{get:function(){return this._anisoSamples},set:function(i){var psamples=this._anisoSamples;if(this._anisoSamples=0|Math.max(i,1),psamples!==this._anisoSamples){var ext=this.gl.getExtension("EXT_texture_filter_anisotropic");ext&&this.gl.texParameterf(this.gl.TEXTURE_2D,ext.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(v){if(this.bind(),wrapTypes.indexOf(v)<0)throw new Error("gl-texture2d: Unknown wrap mode "+v);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,v),this._wrapS=v}},wrapT:{get:function(){return this._wrapT},set:function(v){if(this.bind(),wrapTypes.indexOf(v)<0)throw new Error("gl-texture2d: Unknown wrap mode "+v);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,v),this._wrapT=v}},wrap:{get:function(){return this._wrapVector},set:function(v){if(Array.isArray(v)||(v=[v,v]),2!==v.length)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var i=0;i<2;++i)if(wrapTypes.indexOf(v[i])<0)throw new Error("gl-texture2d: Unknown wrap mode "+v);this._wrapS=v[0],this._wrapT=v[1];var gl=this.gl;return this.bind(),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,this._wrapS),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,this._wrapT),v}},shape:{get:function(){return this._shapeVector},set:function(x){if(Array.isArray(x)){if(2!==x.length)throw new Error("gl-texture2d: Invalid texture shape")}else x=[0|x,0|x];return reshapeTexture(this,0|x[0],0|x[1]),[0|x[0],0|x[1]]}},width:{get:function(){return this._shape[0]},set:function(w){return reshapeTexture(this,w|=0,this._shape[1]),w}},height:{get:function(){return this._shape[1]},set:function(h){return h|=0,reshapeTexture(this,this._shape[0],h),h}}}),__proto_218.bind=function(unit){var gl=this.gl;return void 0!==unit&&gl.activeTexture(gl.TEXTURE0+(0|unit)),gl.bindTexture(gl.TEXTURE_2D,this.handle),void 0!==unit?0|unit:gl.getParameter(gl.ACTIVE_TEXTURE)-gl.TEXTURE0},__proto_218.dispose=function(){this.gl.deleteTexture(this.handle)},__proto_218.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var l=Math.min(this._shape[0],this._shape[1]),i=0;l>0;++i,l>>>=1)this._mipLevels.indexOf(i)<0&&this._mipLevels.push(i)},__proto_218.setPixels=function(data,x_off,y_off,mip_level){var gl=this.gl;this.bind(),Array.isArray(x_off)?(mip_level=y_off,y_off=0|x_off[1],x_off=0|x_off[0]):(x_off=x_off||0,y_off=y_off||0),mip_level=mip_level||0;var directData=acceptTextureDOM(data)?data:data.raw;if(directData){this._mipLevels.indexOf(mip_level)<0?(gl.texImage2D(gl.TEXTURE_2D,0,this.format,this.format,this.type,directData),this._mipLevels.push(mip_level)):gl.texSubImage2D(gl.TEXTURE_2D,mip_level,x_off,y_off,this.format,this.type,directData)}else{if(!(data.shape&&data.stride&&data.data))throw new Error("gl-texture2d: Unsupported data type");if(data.shape.length<2||x_off+data.shape[1]>this._shape[1]>>>mip_level||y_off+data.shape[0]>this._shape[0]>>>mip_level||x_off<0||y_off<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");!function texSubImageArray(gl,x_off,y_off,mip_level,cformat,ctype,mipLevels,array){var dtype=array.dtype,shape=array.shape.slice();if(shape.length<2||shape.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var type=0,format=0,packed=__isPacked_218(shape,array.stride.slice());"float32"===dtype?type=gl.FLOAT:"float64"===dtype?(type=gl.FLOAT,packed=!1,dtype="float32"):"uint8"===dtype?type=gl.UNSIGNED_BYTE:(type=gl.UNSIGNED_BYTE,packed=!1,dtype="uint8");if(2===shape.length)format=gl.LUMINANCE,shape=[shape[0],shape[1],1],array=_$wrappedNDArrayCtor_277(array.data,shape,[array.stride[0],array.stride[1],1],array.offset);else{if(3!==shape.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===shape[2])format=gl.ALPHA;else if(2===shape[2])format=gl.LUMINANCE_ALPHA;else if(3===shape[2])format=gl.RGB;else{if(4!==shape[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");format=gl.RGBA}shape[2]}format!==gl.LUMINANCE&&format!==gl.ALPHA||cformat!==gl.LUMINANCE&&cformat!==gl.ALPHA||(format=cformat);if(format!==cformat)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var size=array.size,needsMip=mipLevels.indexOf(mip_level)<0;needsMip&&mipLevels.push(mip_level);if(type===ctype&&packed)0===array.offset&&array.data.length===size?needsMip?gl.texImage2D(gl.TEXTURE_2D,mip_level,cformat,shape[0],shape[1],0,cformat,ctype,array.data):gl.texSubImage2D(gl.TEXTURE_2D,mip_level,x_off,y_off,shape[0],shape[1],cformat,ctype,array.data):needsMip?gl.texImage2D(gl.TEXTURE_2D,mip_level,cformat,shape[0],shape[1],0,cformat,ctype,array.data.subarray(array.offset,array.offset+size)):gl.texSubImage2D(gl.TEXTURE_2D,mip_level,x_off,y_off,shape[0],shape[1],cformat,ctype,array.data.subarray(array.offset,array.offset+size));else{var pack_buffer;pack_buffer=ctype===gl.FLOAT?_$pool_360.mallocFloat32(size):_$pool_360.mallocUint8(size);var pack_view=_$wrappedNDArrayCtor_277(pack_buffer,shape,[shape[2],shape[2]*shape[0],1]);type===gl.FLOAT&&ctype===gl.UNSIGNED_BYTE?convertFloatToUint8(pack_view,array):_$ndarrayOps_271.assign(pack_view,array),needsMip?gl.texImage2D(gl.TEXTURE_2D,mip_level,cformat,shape[0],shape[1],0,cformat,ctype,pack_buffer.subarray(0,size)):gl.texSubImage2D(gl.TEXTURE_2D,mip_level,x_off,y_off,shape[0],shape[1],cformat,ctype,pack_buffer.subarray(0,size)),ctype===gl.FLOAT?_$pool_360.freeFloat32(pack_buffer):_$pool_360.freeUint8(pack_buffer)}}(gl,x_off,y_off,mip_level,this.format,this.type,this._mipLevels,data)}};var FRAMEBUFFER_UNSUPPORTED,FRAMEBUFFER_INCOMPLETE_ATTACHMENT,FRAMEBUFFER_INCOMPLETE_DIMENSIONS,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT,_$createFBO_158=function createFBO(gl,width,height,options){FRAMEBUFFER_UNSUPPORTED||(FRAMEBUFFER_UNSUPPORTED=gl.FRAMEBUFFER_UNSUPPORTED,FRAMEBUFFER_INCOMPLETE_ATTACHMENT=gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,FRAMEBUFFER_INCOMPLETE_DIMENSIONS=gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var WEBGL_draw_buffers=gl.getExtension("WEBGL_draw_buffers");!colorAttachmentArrays&&WEBGL_draw_buffers&&function lazyInitColorAttachments(gl,ext){var maxColorAttachments=gl.getParameter(ext.MAX_COLOR_ATTACHMENTS_WEBGL);colorAttachmentArrays=new Array(maxColorAttachments+1);for(var i=0;i<=maxColorAttachments;++i){for(var x=new Array(maxColorAttachments),j=0;j<i;++j)x[j]=gl.COLOR_ATTACHMENT0+j;for(var j=i;j<maxColorAttachments;++j)x[j]=gl.NONE;colorAttachmentArrays[i]=x}}(gl,WEBGL_draw_buffers);Array.isArray(width)&&(options=height,height=0|width[1],width=0|width[0]);if("number"!=typeof width)throw new Error("gl-fbo: Missing shape parameter");var maxFBOSize=gl.getParameter(gl.MAX_RENDERBUFFER_SIZE);if(width<0||width>maxFBOSize||height<0||height>maxFBOSize)throw new Error("gl-fbo: Parameters are too large for FBO");var numColors=1;if("color"in(options=options||{})){if((numColors=Math.max(0|options.color,0))<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(numColors>1){if(!WEBGL_draw_buffers)throw new Error("gl-fbo: Multiple draw buffer extension not supported");if(numColors>gl.getParameter(WEBGL_draw_buffers.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+numColors+" draw buffers")}}var colorType=gl.UNSIGNED_BYTE,OES_texture_float=gl.getExtension("OES_texture_float");if(options.float&&numColors>0){if(!OES_texture_float)throw new Error("gl-fbo: Context does not support floating point textures");colorType=gl.FLOAT}else options.preferFloat&&numColors>0&&OES_texture_float&&(colorType=gl.FLOAT);var useDepth=!0;"depth"in options&&(useDepth=!!options.depth);var useStencil=!1;"stencil"in options&&(useStencil=!!options.stencil);return new Framebuffer(gl,width,height,colorType,numColors,useDepth,useStencil,WEBGL_draw_buffers)},colorAttachmentArrays=null;function saveFBOState(gl){return[gl.getParameter(gl.FRAMEBUFFER_BINDING),gl.getParameter(gl.RENDERBUFFER_BINDING),gl.getParameter(gl.TEXTURE_BINDING_2D)]}function restoreFBOState(gl,data){gl.bindFramebuffer(gl.FRAMEBUFFER,data[0]),gl.bindRenderbuffer(gl.RENDERBUFFER,data[1]),gl.bindTexture(gl.TEXTURE_2D,data[2])}function throwFBOError(status){switch(status){case FRAMEBUFFER_UNSUPPORTED:throw new Error("gl-fbo: Framebuffer unsupported");case FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw new Error("gl-fbo: Framebuffer incomplete attachment");case FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function __initTexture_158(gl,width,height,type,format,attachment){if(!type)return null;var result=_$createTexture2D_218(gl,width,height,format,type);return result.magFilter=gl.NEAREST,result.minFilter=gl.NEAREST,result.mipSamples=1,result.bind(),gl.framebufferTexture2D(gl.FRAMEBUFFER,attachment,gl.TEXTURE_2D,result.handle,0),result}function initRenderBuffer(gl,width,height,component,attachment){var result=gl.createRenderbuffer();return gl.bindRenderbuffer(gl.RENDERBUFFER,result),gl.renderbufferStorage(gl.RENDERBUFFER,component,width,height),gl.framebufferRenderbuffer(gl.FRAMEBUFFER,attachment,gl.RENDERBUFFER,result),result}function Framebuffer(gl,width,height,colorType,numColors,useDepth,useStencil,ext){this.gl=gl,this._shape=[0|width,0|height],this._destroyed=!1,this._ext=ext,this.color=new Array(numColors);for(var i=0;i<numColors;++i)this.color[i]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=colorType,this._useDepth=useDepth,this._useStencil=useStencil;var parent=this,shapeVector=[0|width,0|height];Object.defineProperties(shapeVector,{0:{get:function(){return parent._shape[0]},set:function(w){return parent.width=w}},1:{get:function(){return parent._shape[1]},set:function(h){return parent.height=h}}}),this._shapeVector=shapeVector,function rebuildFBO(fbo){var state=saveFBOState(fbo.gl),gl=fbo.gl,handle=fbo.handle=gl.createFramebuffer(),width=fbo._shape[0],height=fbo._shape[1],numColors=fbo.color.length,ext=fbo._ext,useStencil=fbo._useStencil,useDepth=fbo._useDepth,colorType=fbo._colorType;gl.bindFramebuffer(gl.FRAMEBUFFER,handle);for(var i=0;i<numColors;++i)fbo.color[i]=__initTexture_158(gl,width,height,colorType,gl.RGBA,gl.COLOR_ATTACHMENT0+i);0===numColors?(fbo._color_rb=initRenderBuffer(gl,width,height,gl.RGBA4,gl.COLOR_ATTACHMENT0),ext&&ext.drawBuffersWEBGL(colorAttachmentArrays[0])):numColors>1&&ext.drawBuffersWEBGL(colorAttachmentArrays[numColors]);var WEBGL_depth_texture=gl.getExtension("WEBGL_depth_texture");WEBGL_depth_texture?useStencil?fbo.depth=__initTexture_158(gl,width,height,WEBGL_depth_texture.UNSIGNED_INT_24_8_WEBGL,gl.DEPTH_STENCIL,gl.DEPTH_STENCIL_ATTACHMENT):useDepth&&(fbo.depth=__initTexture_158(gl,width,height,gl.UNSIGNED_SHORT,gl.DEPTH_COMPONENT,gl.DEPTH_ATTACHMENT)):useDepth&&useStencil?fbo._depth_rb=initRenderBuffer(gl,width,height,gl.DEPTH_STENCIL,gl.DEPTH_STENCIL_ATTACHMENT):useDepth?fbo._depth_rb=initRenderBuffer(gl,width,height,gl.DEPTH_COMPONENT16,gl.DEPTH_ATTACHMENT):useStencil&&(fbo._depth_rb=initRenderBuffer(gl,width,height,gl.STENCIL_INDEX,gl.STENCIL_ATTACHMENT));var status=gl.checkFramebufferStatus(gl.FRAMEBUFFER);if(status!==gl.FRAMEBUFFER_COMPLETE){for(fbo._destroyed=!0,gl.bindFramebuffer(gl.FRAMEBUFFER,null),gl.deleteFramebuffer(fbo.handle),fbo.handle=null,fbo.depth&&(fbo.depth.dispose(),fbo.depth=null),fbo._depth_rb&&(gl.deleteRenderbuffer(fbo._depth_rb),fbo._depth_rb=null),i=0;i<fbo.color.length;++i)fbo.color[i].dispose(),fbo.color[i]=null;fbo._color_rb&&(gl.deleteRenderbuffer(fbo._color_rb),fbo._color_rb=null),restoreFBOState(gl,state),throwFBOError(status)}restoreFBOState(gl,state)}(this)}var __proto_158=Framebuffer.prototype;function reshapeFBO(fbo,w,h){if(fbo._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(fbo._shape[0]!==w||fbo._shape[1]!==h){var gl=fbo.gl,maxFBOSize=gl.getParameter(gl.MAX_RENDERBUFFER_SIZE);if(w<0||w>maxFBOSize||h<0||h>maxFBOSize)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");fbo._shape[0]=w,fbo._shape[1]=h;for(var state=saveFBOState(gl),i=0;i<fbo.color.length;++i)fbo.color[i].shape=fbo._shape;fbo._color_rb&&(gl.bindRenderbuffer(gl.RENDERBUFFER,fbo._color_rb),gl.renderbufferStorage(gl.RENDERBUFFER,gl.RGBA4,fbo._shape[0],fbo._shape[1])),fbo.depth&&(fbo.depth.shape=fbo._shape),fbo._depth_rb&&(gl.bindRenderbuffer(gl.RENDERBUFFER,fbo._depth_rb),fbo._useDepth&&fbo._useStencil?gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,fbo._shape[0],fbo._shape[1]):fbo._useDepth?gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_COMPONENT16,fbo._shape[0],fbo._shape[1]):fbo._useStencil&&gl.renderbufferStorage(gl.RENDERBUFFER,gl.STENCIL_INDEX,fbo._shape[0],fbo._shape[1])),gl.bindFramebuffer(gl.FRAMEBUFFER,fbo.handle);var status=gl.checkFramebufferStatus(gl.FRAMEBUFFER);status!==gl.FRAMEBUFFER_COMPLETE&&(fbo.dispose(),restoreFBOState(gl,state),throwFBOError(status)),restoreFBOState(gl,state)}}Object.defineProperties(__proto_158,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(x){if(Array.isArray(x)||(x=[0|x,0|x]),2!==x.length)throw new Error("gl-fbo: Shape vector must be length 2");var w=0|x[0],h=0|x[1];return reshapeFBO(this,w,h),[w,h]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(w){return reshapeFBO(this,w|=0,this._shape[1]),w},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(h){return h|=0,reshapeFBO(this,this._shape[0],h),h},enumerable:!1}}),__proto_158.bind=function(){if(!this._destroyed){var gl=this.gl;gl.bindFramebuffer(gl.FRAMEBUFFER,this.handle),gl.viewport(0,0,this._shape[0],this._shape[1])}},__proto_158.dispose=function(){if(!this._destroyed){this._destroyed=!0;var gl=this.gl;gl.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(gl.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var i=0;i<this.color.length;++i)this.color[i].dispose(),this.color[i]=null;this._color_rb&&(gl.deleteRenderbuffer(this._color_rb),this._color_rb=null)}};var _$createSelectBuffer_205=function createSelectBuffer(gl,shape){var fbo=_$createFBO_158(gl,shape),buffer=_$pool_360.mallocUint8(shape[0]*shape[1]*4);return new SelectBuffer(gl,fbo,buffer)},nextPow2=_$twiddle_72.nextPow2,selectRange=_$wrapper_118({args:["array",{offset:[0,0,1],array:0},{offset:[0,0,2],array:0},{offset:[0,0,3],array:0},"scalar","scalar","index"],pre:{body:"{this_closestD2=1e8,this_closestX=-1,this_closestY=-1}",args:[],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:[]},body:{body:"{if(_inline_16_arg0_<255||_inline_16_arg1_<255||_inline_16_arg2_<255||_inline_16_arg3_<255){var _inline_16_l=_inline_16_arg4_-_inline_16_arg6_[0],_inline_16_a=_inline_16_arg5_-_inline_16_arg6_[1],_inline_16_f=_inline_16_l*_inline_16_l+_inline_16_a*_inline_16_a;_inline_16_f<this_closestD2&&(this_closestD2=_inline_16_f,this_closestX=_inline_16_arg6_[0],this_closestY=_inline_16_arg6_[1])}}",args:[{name:"_inline_16_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg4_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg5_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg6_",lvalue:!1,rvalue:!0,count:4}],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:["_inline_16_a","_inline_16_f","_inline_16_l"]},post:{body:"{return[this_closestX,this_closestY,this_closestD2]}",args:[],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:[]},debug:!1,funcName:"cwise",blockSize:64});function SelectBuffer(gl,fbo,buffer){this.gl=gl,this.fbo=fbo,this.buffer=buffer,this._readTimeout=null;var self=this;this._readCallback=function(){self.gl&&(fbo.bind(),gl.readPixels(0,0,fbo.shape[0],fbo.shape[1],gl.RGBA,gl.UNSIGNED_BYTE,self.buffer),self._readTimeout=null)}}var __proto_205=SelectBuffer.prototype;Object.defineProperty(__proto_205,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(v){if(this.gl){this.fbo.shape=v;var c=this.fbo.shape[0],r=this.fbo.shape[1];if(r*c*4>this.buffer.length){_$pool_360.free(this.buffer);for(var buffer=this.buffer=_$pool_360.mallocUint8(nextPow2(r*c*4)),i=0;i<r*c*4;++i)buffer[i]=255}return v}}}),__proto_205.begin=function(){var gl=this.gl;this.shape;gl&&(this.fbo.bind(),gl.clearColor(1,1,1,1),gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT))},__proto_205.end=function(){var gl=this.gl;gl&&(gl.bindFramebuffer(gl.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},__proto_205.query=function(x,y,radius){if(!this.gl)return null;var shape=this.fbo.shape.slice();x|=0,y|=0,"number"!=typeof radius&&(radius=1);var x0=0|Math.min(Math.max(x-radius,0),shape[0]),x1=0|Math.min(Math.max(x+radius,0),shape[0]),y0=0|Math.min(Math.max(y-radius,0),shape[1]),y1=0|Math.min(Math.max(y+radius,0),shape[1]);if(x1<=x0||y1<=y0)return null;var dims=[x1-x0,y1-y0],region=_$wrappedNDArrayCtor_277(this.buffer,[dims[0],dims[1],4],[4,4*shape[0],1],4*(x0+shape[0]*y0)),closest=selectRange(region.hi(dims[0],dims[1],1),radius,radius),dx=closest[0],dy=closest[1];return dx<0||Math.pow(this.radius,2)<closest[2]?null:new function SelectResult(x,y,id,value,distance){this.coord=[x,y],this.id=id,this.value=value,this.distance=distance}(dx+x0|0,dy+y0|0,region.get(dx,dy,0),[region.get(dx,dy,1),region.get(dx,dy,2),region.get(dx,dy,3)],Math.sqrt(closest[2]))},__proto_205.dispose=function(){this.gl&&(this.fbo.dispose(),_$pool_360.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))};var _$createGLPlot2D_194=function createGLPlot2D(options){var gl=options.gl,pickBuffer=_$createSelectBuffer_205(gl,[gl.drawingBufferWidth,gl.drawingBufferHeight]),plot=new GLPlot2D(gl,pickBuffer);return plot.grid=_$createGrid_189(plot),plot.text=_$createTextElements_192(plot),plot.line=_$createLines_190(plot),plot.box=_$createBoxes_188(plot),plot.update(options),plot};function GLPlot2D(gl,pickBuffer){this.gl=gl,this.pickBuffer=pickBuffer,this.screenBox=[0,0,gl.drawingBufferWidth,gl.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}var __proto_194=GLPlot2D.prototype;function deepClone(array){for(var result=array.slice(),i=0;i<result.length;++i)result[i]=result[i].slice();return result}function compareTicks(a,b){return a.x-b.x}__proto_194.setDirty=function(){this.dirty=this.pickDirty=!0},__proto_194.setOverlayDirty=function(){this.dirty=!0},__proto_194.nextDepthValue=function(){return this._depthCounter++/65536},__proto_194.draw=function(){var gl=this.gl,screenBox=this.screenBox,viewPixels=this.viewBox,dataBox=this.dataBox,pixelRatio=this.pixelRatio,grid=this.grid,line=this.line,text=this.text,objects=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),this.dirty){if(this.dirty=!1,gl.bindFramebuffer(gl.FRAMEBUFFER,null),gl.enable(gl.SCISSOR_TEST),gl.disable(gl.DEPTH_TEST),gl.depthFunc(gl.LESS),gl.depthMask(!1),gl.enable(gl.BLEND),gl.blendEquation(gl.FUNC_ADD,gl.FUNC_ADD),gl.blendFunc(gl.ONE,gl.ONE_MINUS_SRC_ALPHA),this.borderColor){gl.scissor(screenBox[0],screenBox[1],screenBox[2]-screenBox[0],screenBox[3]-screenBox[1]);var borderColor=this.borderColor;gl.clearColor(borderColor[0]*borderColor[3],borderColor[1]*borderColor[3],borderColor[2]*borderColor[3],borderColor[3]),gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT)}gl.scissor(viewPixels[0],viewPixels[1],viewPixels[2]-viewPixels[0],viewPixels[3]-viewPixels[1]),gl.viewport(viewPixels[0],viewPixels[1],viewPixels[2]-viewPixels[0],viewPixels[3]-viewPixels[1]);var backgroundColor=this.backgroundColor;gl.clearColor(backgroundColor[0]*backgroundColor[3],backgroundColor[1]*backgroundColor[3],backgroundColor[2]*backgroundColor[3],backgroundColor[3]),gl.clear(gl.COLOR_BUFFER_BIT),grid.draw();var zeroLineEnable=this.zeroLineEnable,zeroLineColor=this.zeroLineColor,zeroLineWidth=this.zeroLineWidth;if(zeroLineEnable[0]||zeroLineEnable[1]){line.bind();for(var i=0;i<2;++i)if(zeroLineEnable[i]&&dataBox[i]<=0&&dataBox[i+2]>=0){var zeroIntercept=screenBox[i]-dataBox[i]*(screenBox[i+2]-screenBox[i])/(dataBox[i+2]-dataBox[i]);0===i?line.drawLine(zeroIntercept,screenBox[1],zeroIntercept,screenBox[3],zeroLineWidth[i],zeroLineColor[i]):line.drawLine(screenBox[0],zeroIntercept,screenBox[2],zeroIntercept,zeroLineWidth[i],zeroLineColor[i])}}for(i=0;i<objects.length;++i)objects[i].draw();gl.viewport(screenBox[0],screenBox[1],screenBox[2]-screenBox[0],screenBox[3]-screenBox[1]),gl.scissor(screenBox[0],screenBox[1],screenBox[2]-screenBox[0],screenBox[3]-screenBox[1]),this.grid.drawTickMarks(),line.bind();var borderLineEnable=this.borderLineEnable,borderLineWidth=this.borderLineWidth,borderLineColor=this.borderLineColor;for(borderLineEnable[1]&&line.drawLine(viewPixels[0],viewPixels[1]-.5*borderLineWidth[1]*pixelRatio,viewPixels[0],viewPixels[3]+.5*borderLineWidth[3]*pixelRatio,borderLineWidth[1],borderLineColor[1]),borderLineEnable[0]&&line.drawLine(viewPixels[0]-.5*borderLineWidth[0]*pixelRatio,viewPixels[1],viewPixels[2]+.5*borderLineWidth[2]*pixelRatio,viewPixels[1],borderLineWidth[0],borderLineColor[0]),borderLineEnable[3]&&line.drawLine(viewPixels[2],viewPixels[1]-.5*borderLineWidth[1]*pixelRatio,viewPixels[2],viewPixels[3]+.5*borderLineWidth[3]*pixelRatio,borderLineWidth[3],borderLineColor[3]),borderLineEnable[2]&&line.drawLine(viewPixels[0]-.5*borderLineWidth[0]*pixelRatio,viewPixels[3],viewPixels[2]+.5*borderLineWidth[2]*pixelRatio,viewPixels[3],borderLineWidth[2],borderLineColor[2]),text.bind(),i=0;i<2;++i)text.drawTicks(i);this.titleEnable&&text.drawTitle();var overlays=this.overlays;for(i=0;i<overlays.length;++i)overlays[i].draw();gl.disable(gl.SCISSOR_TEST),gl.disable(gl.BLEND),gl.depthMask(!0)}},__proto_194.drawPick=function(){if(!this.static){var pickBuffer=this.pickBuffer;this.gl;this._pickTimeout=null,pickBuffer.begin();for(var pickOffset=1,objects=this.objects,i=0;i<objects.length;++i)pickOffset=objects[i].drawPick(pickOffset);pickBuffer.end()}},__proto_194.pick=function(x,y){if(!this.static){var pixelRatio=this.pixelRatio,pickPixelRatio=this.pickPixelRatio,viewBox=this.viewBox,scrX=0|Math.round((x-viewBox[0]/pixelRatio)*pickPixelRatio),scrY=0|Math.round((y-viewBox[1]/pixelRatio)*pickPixelRatio),pickResult=this.pickBuffer.query(scrX,scrY,this.pickRadius);if(!pickResult)return null;for(var pickValue=pickResult.id+(pickResult.value[0]<<8)+(pickResult.value[1]<<16)+(pickResult.value[2]<<24),objects=this.objects,i=0;i<objects.length;++i){var result=objects[i].pick(scrX,scrY,pickValue);if(result)return result}return null}},__proto_194.setScreenBox=function(nbox){var screenBox=this.screenBox,pixelRatio=this.pixelRatio;screenBox[0]=0|Math.round(nbox[0]*pixelRatio),screenBox[1]=0|Math.round(nbox[1]*pixelRatio),screenBox[2]=0|Math.round(nbox[2]*pixelRatio),screenBox[3]=0|Math.round(nbox[3]*pixelRatio),this.setDirty()},__proto_194.setDataBox=function(nbox){var dataBox=this.dataBox;(dataBox[0]!==nbox[0]||dataBox[1]!==nbox[1]||dataBox[2]!==nbox[2]||dataBox[3]!==nbox[3])&&(dataBox[0]=nbox[0],dataBox[1]=nbox[1],dataBox[2]=nbox[2],dataBox[3]=nbox[3],this.setDirty())},__proto_194.setViewBox=function(nbox){var pixelRatio=this.pixelRatio,viewBox=this.viewBox;viewBox[0]=0|Math.round(nbox[0]*pixelRatio),viewBox[1]=0|Math.round(nbox[1]*pixelRatio),viewBox[2]=0|Math.round(nbox[2]*pixelRatio),viewBox[3]=0|Math.round(nbox[3]*pixelRatio);var pickPixelRatio=this.pickPixelRatio;this.pickBuffer.shape=[0|Math.round((nbox[2]-nbox[0])*pickPixelRatio),0|Math.round((nbox[3]-nbox[1])*pickPixelRatio)],this.setDirty()},__proto_194.update=function(options){options=options||{};var gl=this.gl;this.pixelRatio=options.pixelRatio||1;var pixelRatio=this.pixelRatio;this.pickPixelRatio=Math.max(pixelRatio,1),this.setScreenBox(options.screenBox||[0,0,gl.drawingBufferWidth/pixelRatio,gl.drawingBufferHeight/pixelRatio]);this.screenBox;this.setViewBox(options.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/pixelRatio,.125*(this.screenBox[3]-this.screenBox[1])/pixelRatio,.875*(this.screenBox[2]-this.screenBox[0])/pixelRatio,.875*(this.screenBox[3]-this.screenBox[1])/pixelRatio]);var viewBox=this.viewBox,aspectRatio=(viewBox[2]-viewBox[0])/(viewBox[3]-viewBox[1]);this.setDataBox(options.dataBox||[-10,-10/aspectRatio,10,10/aspectRatio]),this.borderColor=!1!==options.borderColor&&(options.borderColor||[0,0,0,0]).slice(),this.backgroundColor=(options.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(options.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(options.gridLineWidth||[1,1]).slice(),this.gridLineColor=deepClone(options.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(options.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(options.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=deepClone(options.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(options.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(options.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=deepClone(options.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(options.titleCenter||[.5*(viewBox[0]+viewBox[2])/pixelRatio,(viewBox[3]+120)/pixelRatio]).slice(),this.titleEnable=!("titleEnable"in options&&!options.titleEnable),this.titleAngle=options.titleAngle||0,this.titleColor=(options.titleColor||[0,0,0,1]).slice(),this.labelPad=(options.labelPad||[15,15,15,15]).slice(),this.labelAngle=(options.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(options.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=deepClone(options.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(options.tickPad||[15,15,15,15]).slice(),this.tickAngle=(options.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(options.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=deepClone(options.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(options.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(options.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=deepClone(options.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var ticks=options.ticks||[[],[]],bounds=this._tickBounds;bounds[0]=bounds[1]=1/0,bounds[2]=bounds[3]=-1/0;for(var i=0;i<2;++i){var axisTicks=ticks[i].slice(0);0!==axisTicks.length&&(axisTicks.sort(compareTicks),bounds[i]=Math.min(bounds[i],axisTicks[0].x),bounds[i+2]=Math.max(bounds[i+2],axisTicks[axisTicks.length-1].x))}this.grid.update({bounds:bounds,ticks:ticks}),this.text.update({bounds:bounds,ticks:ticks,labels:options.labels||["x","y"],labelSize:options.labelSize||[12,12],labelFont:options.labelFont||["sans-serif","sans-serif"],title:options.title||"",titleSize:options.titleSize||18,titleFont:options.titleFont||"sans-serif"}),this.static=!!options.static,this.setDirty()},__proto_194.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var i=this.objects.length-1;i>=0;--i)this.objects[i].dispose();this.objects.length=0;for(i=this.overlays.length-1;i>=0;--i)this.overlays[i].dispose();this.overlays.length=0,this.gl=null},__proto_194.addObject=function(object){this.objects.indexOf(object)<0&&(this.objects.push(object),this.setDirty())},__proto_194.removeObject=function(object){for(var objects=this.objects,i=0;i<objects.length;++i)if(objects[i]===object){objects.splice(i,1),this.setDirty();break}},__proto_194.addOverlay=function(object){this.overlays.indexOf(object)<0&&(this.overlays.push(object),this.setOverlayDirty())},__proto_194.removeOverlay=function(object){for(var objects=this.overlays,i=0;i<objects.length;++i)if(objects[i]===object){objects.splice(i,1),this.setOverlayDirty();break}};var _$shaders_203={};_$shaders_203.boxVertex=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 vertex;\n\nuniform vec2 cornerA, cornerB;\n\nvoid main() {\n  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);\n}\n"]),_$shaders_203.boxFragment=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvoid main() {\n  gl_FragColor = color;\n}\n"]);var _$createSelectBox_204=function createSelectBox(plot,options){var gl=plot.gl,buffer=_$createBuffer_153(gl,[0,0,0,1,1,0,1,1]),shader=_$createShader_206(gl,_$shaders_203.boxVertex,_$shaders_203.boxFragment),selectBox=new SelectBox(plot,buffer,shader);return selectBox.update(options),plot.addOverlay(selectBox),selectBox};function SelectBox(plot,boxBuffer,boxShader){this.plot=plot,this.boxBuffer=boxBuffer,this.boxShader=boxShader,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}var __proto_204=SelectBox.prototype;__proto_204.draw=function(){if(this.enabled){var plot=this.plot,selectBox=this.selectBox,lineWidth=this.borderWidth,innerColor=(this.innerFill,this.innerColor),outerColor=(this.outerFill,this.outerColor),borderColor=this.borderColor,boxes=plot.box,screenBox=plot.screenBox,dataBox=plot.dataBox,viewBox=plot.viewBox,pixelRatio=plot.pixelRatio,loX=(selectBox[0]-dataBox[0])*(viewBox[2]-viewBox[0])/(dataBox[2]-dataBox[0])+viewBox[0],loY=(selectBox[1]-dataBox[1])*(viewBox[3]-viewBox[1])/(dataBox[3]-dataBox[1])+viewBox[1],hiX=(selectBox[2]-dataBox[0])*(viewBox[2]-viewBox[0])/(dataBox[2]-dataBox[0])+viewBox[0],hiY=(selectBox[3]-dataBox[1])*(viewBox[3]-viewBox[1])/(dataBox[3]-dataBox[1])+viewBox[1];if(loX=Math.max(loX,viewBox[0]),loY=Math.max(loY,viewBox[1]),hiX=Math.min(hiX,viewBox[2]),hiY=Math.min(hiY,viewBox[3]),!(hiX<loX||hiY<loY)){boxes.bind();var screenWidth=screenBox[2]-screenBox[0],screenHeight=screenBox[3]-screenBox[1];if(this.outerFill&&(boxes.drawBox(0,0,screenWidth,loY,outerColor),boxes.drawBox(0,loY,loX,hiY,outerColor),boxes.drawBox(0,hiY,screenWidth,screenHeight,outerColor),boxes.drawBox(hiX,loY,screenWidth,hiY,outerColor)),this.innerFill&&boxes.drawBox(loX,loY,hiX,hiY,innerColor),lineWidth>0){var w=lineWidth*pixelRatio;boxes.drawBox(loX-w,loY-w,hiX+w,loY+w,borderColor),boxes.drawBox(loX-w,hiY-w,hiX+w,hiY+w,borderColor),boxes.drawBox(loX-w,loY-w,loX+w,hiY+w,borderColor),boxes.drawBox(hiX-w,loY-w,hiX+w,hiY+w,borderColor)}}}},__proto_204.update=function(options){options=options||{},this.innerFill=!!options.innerFill,this.outerFill=!!options.outerFill,this.innerColor=(options.innerColor||[0,0,0,.5]).slice(),this.outerColor=(options.outerColor||[0,0,0,.5]).slice(),this.borderColor=(options.borderColor||[0,0,0,1]).slice(),this.borderWidth=options.borderWidth||0,this.selectBox=(options.selectBox||this.selectBox).slice()},__proto_204.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)};var _$createSpikes2D_213=function createSpikes2D(plot,options){var spikes=new GLSpikes2D(plot);return spikes.update(options),plot.addOverlay(spikes),spikes};function GLSpikes2D(plot){this.plot=plot,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}var __proto_213=GLSpikes2D.prototype;__proto_213.update=function(options){options=options||{},this.enable=(options.enable||[!0,!0,!1,!1]).slice(),this.width=(options.width||[1,1,1,1]).slice(),this.color=(options.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(x){return x.slice()}),this.center=(options.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},__proto_213.draw=function(){var spikeEnable=this.enable,spikeWidth=this.width,spikeColor=this.color,spikeCenter=this.center,plot=this.plot,line=plot.line,dataBox=plot.dataBox,viewPixels=plot.viewBox;if(line.bind(),dataBox[0]<=spikeCenter[0]&&spikeCenter[0]<=dataBox[2]&&dataBox[1]<=spikeCenter[1]&&spikeCenter[1]<=dataBox[3]){var centerX=viewPixels[0]+(spikeCenter[0]-dataBox[0])/(dataBox[2]-dataBox[0])*(viewPixels[2]-viewPixels[0]),centerY=viewPixels[1]+(spikeCenter[1]-dataBox[1])/(dataBox[3]-dataBox[1])*(viewPixels[3]-viewPixels[1]);spikeEnable[0]&&line.drawLine(centerX,centerY,viewPixels[0],centerY,spikeWidth[0],spikeColor[0]),spikeEnable[1]&&line.drawLine(centerX,centerY,centerX,viewPixels[1],spikeWidth[1],spikeColor[1]),spikeEnable[2]&&line.drawLine(centerX,centerY,viewPixels[2],centerY,spikeWidth[2],spikeColor[2]),spikeEnable[3]&&line.drawLine(centerX,centerY,centerX,viewPixels[3],spikeWidth[3],spikeColor[3])}},__proto_213.dispose=function(){this.plot.removeOverlay(this)};var _$getCanvasContext_144=function getCanvasContext(type,opts){if("string"!=typeof type)throw new TypeError("must specify type string");if(opts=opts||{},"undefined"==typeof document&&!opts.canvas)return null;var canvas=opts.canvas||document.createElement("canvas");"number"==typeof opts.width&&(canvas.width=opts.width);"number"==typeof opts.height&&(canvas.height=opts.height);var gl,attribs=opts;try{var names=[type];0===type.indexOf("webgl")&&names.push("experimental-"+type);for(var i=0;i<names.length;i++)if(gl=canvas.getContext(names[i],attribs))return gl}catch(e){gl=null}return gl||null};var _$getWebGLContext_373=function getWebGLContext(opt){return _$getCanvasContext_144("webgl",opt)},_$toSuperScript_345=function toSuperScript(x){return x.split("").map(function(c){return c in SUPERSCRIPTS?SUPERSCRIPTS[c]:""}).join("")},SUPERSCRIPTS={" ":" ",0:"⁰",1:"¹",2:"²",3:"³",4:"⁴",5:"⁵",6:"⁶",7:"⁷",8:"⁸",9:"⁹","+":"⁺","-":"⁻",a:"ᵃ",b:"ᵇ",c:"ᶜ",d:"ᵈ",e:"ᵉ",f:"ᶠ",g:"ᵍ",h:"ʰ",i:"ⁱ",j:"ʲ",k:"ᵏ",l:"ˡ",m:"ᵐ",n:"ⁿ",o:"ᵒ",p:"ᵖ",r:"ʳ",s:"ˢ",t:"ᵗ",u:"ᵘ",v:"ᵛ",w:"ʷ",x:"ˣ",y:"ʸ",z:"ᶻ"};var _$convertHTMLToUnicode_537=function convertHTMLToUnicode(html){return""+function fixEntities(x){for(var entityToUnicode=_$string_mappings_518.entityToUnicode,idx=0;(idx=x.indexOf("&",idx))>=0;){var nidx=x.indexOf(";",idx);if(nidx<idx)idx+=1;else{var entity=entityToUnicode[x.slice(idx+1,nidx)];x=entity?x.slice(0,idx)+entity+x.slice(nidx+1):x.slice(0,idx)+x.slice(nidx+1)}}return x}(function stripTags(x){return x.replace(/\<.*\>/g,"")}(function fixSuperScript(x){for(var idx=0;(idx=x.indexOf("<sup>",idx))>=0;){var nidx=x.indexOf("</sup>",idx);if(nidx<idx)break;x=x.slice(0,idx)+_$toSuperScript_345(x.slice(idx+5,nidx))+x.slice(nidx+6)}return x}(function fixBR(x){return x.replace(/\<br\>/g,"\n")}(html))))},__noop_559=function(){},_$showWebGlMsg_559=function showWebGlMsg(scene){for(var prop in scene)"function"==typeof scene[prop]&&(scene[prop]=__noop_559);scene.destroy=function(){scene.container.parentNode.removeChild(scene.container)};var div=document.createElement("div");return div.textContent="Webgl is not supported by your browser - visit http://get.webgl.org for more info",div.style.cursor="pointer",div.style.fontSize="24px",div.style.color=_$color_411.defaults[0],scene.container.appendChild(div),scene.container.style.background="#FFFFFF",scene.container.onclick=function(){window.open("http://get.webgl.org")},!1},_$mouse_264={};function mouseElement(ev){return ev.target||ev.srcElement||window}_$mouse_264.buttons=function mouseButtons(ev){if("object"==typeof ev){if("buttons"in ev)return ev.buttons;if("which"in ev){if(2===(b=ev.which))return 4;if(3===b)return 2;if(b>0)return 1<<b-1}else if("button"in ev){var b;if(1===(b=ev.button))return 4;if(2===b)return 2;if(b>=0)return 1<<b}}return 0},_$mouse_264.element=mouseElement,_$mouse_264.x=function mouseRelativeX(ev){if("object"==typeof ev){if("offsetX"in ev)return ev.offsetX;var bounds=mouseElement(ev).getBoundingClientRect();return ev.clientX-bounds.left}return 0},_$mouse_264.y=function mouseRelativeY(ev){if("object"==typeof ev){if("offsetY"in ev)return ev.offsetY;var bounds=mouseElement(ev).getBoundingClientRect();return ev.clientY-bounds.top}return 0};var _$mouseListen_262=function mouseListen(element,callback){callback||(callback=element,element=window);var buttonState=0,x=0,y=0,mods={shift:!1,alt:!1,control:!1,meta:!1},attached=!1;function updateMods(ev){var changed=!1;return"altKey"in ev&&(changed=changed||ev.altKey!==mods.alt,mods.alt=!!ev.altKey),"shiftKey"in ev&&(changed=changed||ev.shiftKey!==mods.shift,mods.shift=!!ev.shiftKey),"ctrlKey"in ev&&(changed=changed||ev.ctrlKey!==mods.control,mods.control=!!ev.ctrlKey),"metaKey"in ev&&(changed=changed||ev.metaKey!==mods.meta,mods.meta=!!ev.metaKey),changed}function handleEvent(nextButtons,ev){var nextX=_$mouse_264.x(ev),nextY=_$mouse_264.y(ev);"buttons"in ev&&(nextButtons=0|ev.buttons),(nextButtons!==buttonState||nextX!==x||nextY!==y||updateMods(ev))&&(buttonState=0|nextButtons,x=nextX||0,y=nextY||0,callback&&callback(buttonState,x,y,mods))}function clearState(ev){handleEvent(0,ev)}function handleBlur(){(buttonState||x||y||mods.shift||mods.alt||mods.meta||mods.control)&&(x=y=0,buttonState=0,mods.shift=mods.alt=mods.control=mods.meta=!1,callback&&callback(0,0,0,mods))}function handleMods(ev){updateMods(ev)&&callback&&callback(buttonState,x,y,mods)}function handleMouseMove(ev){0===_$mouse_264.buttons(ev)?handleEvent(0,ev):handleEvent(buttonState,ev)}function handleMouseDown(ev){handleEvent(buttonState|_$mouse_264.buttons(ev),ev)}function handleMouseUp(ev){handleEvent(buttonState&~_$mouse_264.buttons(ev),ev)}function attachListeners(){attached||(attached=!0,element.addEventListener("mousemove",handleMouseMove),element.addEventListener("mousedown",handleMouseDown),element.addEventListener("mouseup",handleMouseUp),element.addEventListener("mouseleave",clearState),element.addEventListener("mouseenter",clearState),element.addEventListener("mouseout",clearState),element.addEventListener("mouseover",clearState),element.addEventListener("blur",handleBlur),element.addEventListener("keyup",handleMods),element.addEventListener("keydown",handleMods),element.addEventListener("keypress",handleMods),element!==window&&(window.addEventListener("blur",handleBlur),window.addEventListener("keyup",handleMods),window.addEventListener("keydown",handleMods),window.addEventListener("keypress",handleMods)))}attachListeners();var result={element:element};return Object.defineProperties(result,{enabled:{get:function(){return attached},set:function(f){f?attachListeners():function detachListeners(){attached&&(attached=!1,element.removeEventListener("mousemove",handleMouseMove),element.removeEventListener("mousedown",handleMouseDown),element.removeEventListener("mouseup",handleMouseUp),element.removeEventListener("mouseleave",clearState),element.removeEventListener("mouseenter",clearState),element.removeEventListener("mouseout",clearState),element.removeEventListener("mouseover",clearState),element.removeEventListener("blur",handleBlur),element.removeEventListener("keyup",handleMods),element.removeEventListener("keydown",handleMods),element.removeEventListener("keypress",handleMods),element!==window&&(window.removeEventListener("blur",handleBlur),window.removeEventListener("keyup",handleMods),window.removeEventListener("keydown",handleMods),window.removeEventListener("keypress",handleMods)))}()},enumerable:!0},buttons:{get:function(){return buttonState},enumerable:!0},x:{get:function(){return x},enumerable:!0},y:{get:function(){return y},enumerable:!0},mods:{get:function(){return mods},enumerable:!0}}),result};var _$parseUnit_287=function parseUnit(str,out){out||(out=[0,""]),str=String(str);var num=parseFloat(str,10);return out[0]=num,out[1]=str.match(/[\d.\-\+]*\s*(.*)/)[1]||"",out},_$toPX_354=toPX,PIXELS_PER_INCH=96;function getPropertyInPX(element,prop){var parts=_$parseUnit_287(getComputedStyle(element).getPropertyValue(prop));return parts[0]*toPX(parts[1],element)}function toPX(str,element){switch(element=element||document.body,str=(str||"px").trim().toLowerCase(),element!==window&&element!==document||(element=document.body),str){case"%":return element.clientHeight/100;case"ch":case"ex":return function getSizeBrutal(unit,element){var testDIV=document.createElement("div");testDIV.style["font-size"]="128"+unit,element.appendChild(testDIV);var size=getPropertyInPX(testDIV,"font-size")/128;return element.removeChild(testDIV),size}(str,element);case"em":return getPropertyInPX(element,"font-size");case"rem":return getPropertyInPX(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return PIXELS_PER_INCH;case"cm":return PIXELS_PER_INCH/2.54;case"mm":return PIXELS_PER_INCH/25.4;case"pt":return PIXELS_PER_INCH/72;case"pc":return PIXELS_PER_INCH/6}return 1}var _$mouseWheelListen_265=function mouseWheelListen(element,callback,noScroll){"function"==typeof element&&(noScroll=!!callback,callback=element,element=window);var lineHeight=_$toPX_354("ex",element),listener=function(ev){noScroll&&ev.preventDefault();var dx=ev.deltaX||0,dy=ev.deltaY||0,dz=ev.deltaZ||0,mode=ev.deltaMode,scale=1;switch(mode){case 1:scale=lineHeight;break;case 2:scale=window.innerHeight}if(dy*=scale,dz*=scale,(dx*=scale)||dy||dz)return callback(dx,dy,dz,ev)};return element.addEventListener("wheel",listener),listener};var _$createCamera_622=function createCamera(scene){var element=scene.mouseContainer,plot=scene.glplot,result=new function Camera2D(element,plot){this.element=element,this.plot=plot,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}(element,plot);function unSetAutoRange(){scene.xaxis.autorange=!1,scene.yaxis.autorange=!1}function handleInteraction(buttons,x,y){var dx,dy,dataBox=scene.calcDataBox(),viewBox=plot.viewBox,lastX=result.lastPos[0],lastY=result.lastPos[1],MINDRAG=_$constants_589.MINDRAG*plot.pixelRatio,MINZOOM=_$constants_589.MINZOOM*plot.pixelRatio;function updateRange(i0,start,end){var range0=Math.min(start,end),range1=Math.max(start,end);range0!==range1?(dataBox[i0]=range0,dataBox[i0+2]=range1,result.dataBox=dataBox,scene.setRanges(dataBox)):(scene.selectBox.selectBox=[0,0,1,1],scene.glplot.setDirty())}switch(x*=plot.pixelRatio,y*=plot.pixelRatio,y=viewBox[3]-viewBox[1]-y,scene.fullLayout.dragmode){case"zoom":if(buttons){var dataX=x/(viewBox[2]-viewBox[0])*(dataBox[2]-dataBox[0])+dataBox[0],dataY=y/(viewBox[3]-viewBox[1])*(dataBox[3]-dataBox[1])+dataBox[1];result.boxInited||(result.boxStart[0]=dataX,result.boxStart[1]=dataY,result.dragStart[0]=x,result.dragStart[1]=y),result.boxEnd[0]=dataX,result.boxEnd[1]=dataY,result.boxInited=!0,result.boxEnabled||result.boxStart[0]===result.boxEnd[0]&&result.boxStart[1]===result.boxEnd[1]||(result.boxEnabled=!0);var smallDx=Math.abs(result.dragStart[0]-x)<MINZOOM,smallDy=Math.abs(result.dragStart[1]-y)<MINZOOM;if(!function getSubplotConstraint(){for(var constraints=scene.graphDiv._fullLayout._axisConstraintGroups,xaId=scene.xaxis._id,yaId=scene.yaxis._id,i=0;i<constraints.length;i++)if(-1!==constraints[i][xaId]){if(-1!==constraints[i][yaId])return!0;break}return!1}()||smallDx&&smallDy)smallDx&&(result.boxEnd[0]=result.boxStart[0]),smallDy&&(result.boxEnd[1]=result.boxStart[1]);else{dx=result.boxEnd[0]-result.boxStart[0],dy=result.boxEnd[1]-result.boxStart[1];var dydx=(dataBox[3]-dataBox[1])/(dataBox[2]-dataBox[0]);Math.abs(dx*dydx)>Math.abs(dy)?(result.boxEnd[1]=result.boxStart[1]+Math.abs(dx)*dydx*(dy>=0?1:-1),result.boxEnd[1]<dataBox[1]?(result.boxEnd[1]=dataBox[1],result.boxEnd[0]=result.boxStart[0]+(dataBox[1]-result.boxStart[1])/Math.abs(dydx)):result.boxEnd[1]>dataBox[3]&&(result.boxEnd[1]=dataBox[3],result.boxEnd[0]=result.boxStart[0]+(dataBox[3]-result.boxStart[1])/Math.abs(dydx))):(result.boxEnd[0]=result.boxStart[0]+Math.abs(dy)/dydx*(dx>=0?1:-1),result.boxEnd[0]<dataBox[0]?(result.boxEnd[0]=dataBox[0],result.boxEnd[1]=result.boxStart[1]+(dataBox[0]-result.boxStart[0])*Math.abs(dydx)):result.boxEnd[0]>dataBox[2]&&(result.boxEnd[0]=dataBox[2],result.boxEnd[1]=result.boxStart[1]+(dataBox[2]-result.boxStart[0])*Math.abs(dydx)))}}else result.boxEnabled?(dx=result.boxStart[0]!==result.boxEnd[0],dy=result.boxStart[1]!==result.boxEnd[1],dx||dy?(dx&&(updateRange(0,result.boxStart[0],result.boxEnd[0]),scene.xaxis.autorange=!1),dy&&(updateRange(1,result.boxStart[1],result.boxEnd[1]),scene.yaxis.autorange=!1),scene.relayoutCallback()):scene.glplot.setDirty(),result.boxEnabled=!1,result.boxInited=!1):result.boxInited&&(result.boxInited=!1);break;case"pan":result.boxEnabled=!1,result.boxInited=!1,buttons?(result.panning||(result.dragStart[0]=x,result.dragStart[1]=y),Math.abs(result.dragStart[0]-x)<MINDRAG&&(x=result.dragStart[0]),Math.abs(result.dragStart[1]-y)<MINDRAG&&(y=result.dragStart[1]),dx=(lastX-x)*(dataBox[2]-dataBox[0])/(plot.viewBox[2]-plot.viewBox[0]),dy=(lastY-y)*(dataBox[3]-dataBox[1])/(plot.viewBox[3]-plot.viewBox[1]),dataBox[0]+=dx,dataBox[2]+=dx,dataBox[1]+=dy,dataBox[3]+=dy,scene.setRanges(dataBox),result.panning=!0,result.lastInputTime=Date.now(),unSetAutoRange(),scene.cameraChanged(),scene.handleAnnotations()):result.panning&&(result.panning=!1,scene.relayoutCallback())}result.lastPos[0]=x,result.lastPos[1]=y}return result.mouseListener=_$mouseListen_262(element,handleInteraction),element.addEventListener("touchstart",function(ev){var xy=_$mouseEventOffset_263(ev.changedTouches[0],element);handleInteraction(0,xy[0],xy[1]),handleInteraction(1,xy[0],xy[1]),ev.preventDefault()},!!_$hasPassiveEvents_240&&{passive:!1}),element.addEventListener("touchmove",function(ev){ev.preventDefault();var xy=_$mouseEventOffset_263(ev.changedTouches[0],element);handleInteraction(1,xy[0],xy[1]),ev.preventDefault()},!!_$hasPassiveEvents_240&&{passive:!1}),element.addEventListener("touchend",function(ev){handleInteraction(0,result.lastPos[0],result.lastPos[1]),ev.preventDefault()},!!_$hasPassiveEvents_240&&{passive:!1}),result.wheelListener=_$mouseWheelListen_265(element,function(dx,dy){if(!scene.scrollZoom)return!1;var dataBox=scene.calcDataBox(),viewBox=plot.viewBox,lastX=result.lastPos[0],lastY=result.lastPos[1],scale=Math.exp(5*dy/(viewBox[3]-viewBox[1])),cx=lastX/(viewBox[2]-viewBox[0])*(dataBox[2]-dataBox[0])+dataBox[0],cy=lastY/(viewBox[3]-viewBox[1])*(dataBox[3]-dataBox[1])+dataBox[1];return dataBox[0]=(dataBox[0]-cx)*scale+cx,dataBox[2]=(dataBox[2]-cx)*scale+cx,dataBox[1]=(dataBox[1]-cy)*scale+cy,dataBox[3]=(dataBox[3]-cy)*scale+cy,scene.setRanges(dataBox),result.lastInputTime=Date.now(),unSetAutoRange(),scene.cameraChanged(),scene.handleAnnotations(),scene.relayoutCallback(),!0},!0),result};var _$clamp_94=function clamp(value,min,max){return min<max?value<min?min:value>max?max:value:value<max?max:value>min?min:value};var _$colorName_98={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},_$defined_128=function(){for(var i=0;i<arguments.length;i++)if(void 0!==arguments[i])return arguments[i]},__toString_250=Object.prototype.toString,_$isPlainObj_250=function(x){var prototype;return"[object Object]"===__toString_250.call(x)&&(null===(prototype=Object.getPrototypeOf(x))||prototype===Object.getPrototypeOf({}))},_$parse_100={};(function(global){"use strict";_$parse_100=function parse(cstr){var m,space,parts=[],alpha=1;if("string"==typeof cstr)if(_$colorName_98[cstr])parts=_$colorName_98[cstr].slice(),space="rgb";else if("transparent"===cstr)alpha=0,space="rgb",parts=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(cstr)){var base=cstr.slice(1),size=base.length,isShort=size<=4;alpha=1,isShort?(parts=[parseInt(base[0]+base[0],16),parseInt(base[1]+base[1],16),parseInt(base[2]+base[2],16)],4===size&&(alpha=parseInt(base[3]+base[3],16)/255)):(parts=[parseInt(base[0]+base[1],16),parseInt(base[2]+base[3],16),parseInt(base[4]+base[5],16)],8===size&&(alpha=parseInt(base[6]+base[7],16)/255)),parts[0]||(parts[0]=0),parts[1]||(parts[1]=0),parts[2]||(parts[2]=0),space="rgb"}else if(m=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(cstr)){var name=m[1],base=name.replace(/a$/,"");space=base;var size="cmyk"===base?4:"gray"===base?1:3;parts=m[2].trim().split(/\s*,\s*/).map(function(x,i){if(/%$/.test(x))return i===size?parseFloat(x)/100:"rgb"===base?255*parseFloat(x)/100:parseFloat(x);if("h"===base[i]){if(/deg$/.test(x))return parseFloat(x);if(void 0!==baseHues[x])return baseHues[x]}return parseFloat(x)}),name===base&&parts.push(1),alpha=void 0===parts[size]?1:parts[size],parts=parts.slice(0,size)}else cstr.length>10&&/[0-9](?:\s|\/)/.test(cstr)&&(parts=cstr.match(/([0-9]+)/g).map(function(value){return parseFloat(value)}),space=cstr.match(/([a-z])/gi).join("").toLowerCase());else if("number"==typeof cstr)space="rgb",parts=[cstr>>>16,(65280&cstr)>>>8,255&cstr];else if(_$isPlainObj_250(cstr)){var r=_$defined_128(cstr.r,cstr.red,cstr.R,null);null!==r?(space="rgb",parts=[r,_$defined_128(cstr.g,cstr.green,cstr.G),_$defined_128(cstr.b,cstr.blue,cstr.B)]):(space="hsl",parts=[_$defined_128(cstr.h,cstr.hue,cstr.H),_$defined_128(cstr.s,cstr.saturation,cstr.S),_$defined_128(cstr.l,cstr.lightness,cstr.L,cstr.b,cstr.brightness)]),alpha=_$defined_128(cstr.a,cstr.alpha,cstr.opacity,1),null!=cstr.opacity&&(alpha/=100)}else(Array.isArray(cstr)||global.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(cstr))&&(parts=[cstr[0],cstr[1],cstr[2]],space="rgb",alpha=4===cstr.length?cstr[3]:1);return{space:space,values:parts,alpha:alpha}};var baseHues={red:0,orange:60,yellow:120,green:180,blue:240,purple:300}}).call(this,void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var _$hsl___rgb=function(hsl){var t1,t2,t3,rgb,val,h=hsl[0]/360,s=hsl[1]/100,l=hsl[2]/100;if(0===s)return[val=255*l,val,val];t1=2*l-(t2=l<.5?l*(1+s):l+s-l*s),rgb=[0,0,0];for(var i=0;i<3;i++)(t3=h+1/3*-(i-1))<0?t3++:t3>1&&t3--,val=6*t3<1?t1+6*(t2-t1)*t3:2*t3<1?t2:3*t3<2?t1+(t2-t1)*(2/3-t3)*6:t1,rgb[i]=255*val;return rgb},_$dtype_132=function(dtype){switch(dtype){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}},_$normalize_99=function normalize(color,type){"float"!==type&&type||(type="array"),"uint"===type&&(type="uint8"),"uint_clamped"===type&&(type="uint8_clamped");var Ctor=_$dtype_132(type),output=new Ctor(4);if(color instanceof Ctor)return Array.isArray(color)?color.slice():(output.set(color),output);var normalize="uint8"!==type&&"uint8_clamped"!==type;return color instanceof Uint8Array||color instanceof Uint8ClampedArray?(output[0]=color[0],output[1]=color[1],output[2]=color[2],output[3]=null!=color[3]?color[3]:255,normalize&&(output[0]/=255,output[1]/=255,output[2]/=255,output[3]/=255),output):(color.length&&"string"!=typeof color||((color=function rgba(color){var values;if("string"!=typeof color)throw Error("Argument should be a string");var parsed=_$parse_100(color);return parsed.space?((values=Array(3))[0]=_$clamp_94(parsed.values[0],0,255),values[1]=_$clamp_94(parsed.values[1],0,255),values[2]=_$clamp_94(parsed.values[2],0,255),"h"===parsed.space[0]&&(values=_$hsl___rgb(values)),values.push(_$clamp_94(parsed.alpha,0,1)),values):[]}(color))[0]/=255,color[1]/=255,color[2]/=255),normalize?(output[0]=color[0],output[1]=color[1],output[2]=color[2],output[3]=null!=color[3]?color[3]:1):(output[0]=_$clamp_94(Math.round(255*color[0]),0,255),output[1]=_$clamp_94(Math.round(255*color[1]),0,255),output[2]=_$clamp_94(Math.round(255*color[2]),0,255),output[3]=null==color[3]?255:_$clamp_94(Math.floor(255*color[3]),0,255)),output)};var _$str2RgbaArray_561=function str2RgbaArray(color){return color?_$normalize_99(color):[0,0,0,1]};function Axes2DOptions(scene){this.scene=scene,this.gl=scene.gl,this.pixelRatio=scene.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=!1,this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var __proto_623=Axes2DOptions.prototype,AXES=["xaxis","yaxis"];__proto_623.merge=function(options){var axisName,ax,axTitle,axMirror,hasAxisInDfltPos,hasAxisInAltrPos,hasSharedAxis,mirrorLines,mirrorTicks,i,j;for(this.titleEnable=!1,this.backgroundColor=_$str2RgbaArray_561(options.plot_bgcolor),i=0;i<2;++i){var axisLetter=(axisName=AXES[i]).charAt(0);for(axTitle=(ax=options[this.scene[axisName]._name]).title===this.scene.fullLayout._dfltTitle[axisLetter]?"":ax.title,j=0;j<=2;j+=2)this.labelEnable[i+j]=!1,this.labels[i+j]=_$convertHTMLToUnicode_537(axTitle),this.labelColor[i+j]=_$str2RgbaArray_561(ax.titlefont.color),this.labelFont[i+j]=ax.titlefont.family,this.labelSize[i+j]=ax.titlefont.size,this.labelPad[i+j]=this.getLabelPad(axisName,ax),this.tickEnable[i+j]=!1,this.tickColor[i+j]=_$str2RgbaArray_561((ax.tickfont||{}).color),this.tickAngle[i+j]="auto"===ax.tickangle?0:Math.PI*-ax.tickangle/180,this.tickPad[i+j]=this.getTickPad(ax),this.tickMarkLength[i+j]=0,this.tickMarkWidth[i+j]=ax.tickwidth||0,this.tickMarkColor[i+j]=_$str2RgbaArray_561(ax.tickcolor),this.borderLineEnable[i+j]=!1,this.borderLineColor[i+j]=_$str2RgbaArray_561(ax.linecolor),this.borderLineWidth[i+j]=ax.linewidth||0;hasSharedAxis=this.hasSharedAxis(ax),hasAxisInDfltPos=this.hasAxisInDfltPos(axisName,ax)&&!hasSharedAxis,hasAxisInAltrPos=this.hasAxisInAltrPos(axisName,ax)&&!hasSharedAxis,axMirror=ax.mirror||!1,mirrorLines=hasSharedAxis?-1!==String(axMirror).indexOf("all"):!!axMirror,mirrorTicks=hasSharedAxis?"allticks"===axMirror:-1!==String(axMirror).indexOf("ticks"),hasAxisInDfltPos?this.labelEnable[i]=!0:hasAxisInAltrPos&&(this.labelEnable[i+2]=!0),hasAxisInDfltPos?this.tickEnable[i]=ax.showticklabels:hasAxisInAltrPos&&(this.tickEnable[i+2]=ax.showticklabels),(hasAxisInDfltPos||mirrorLines)&&(this.borderLineEnable[i]=ax.showline),(hasAxisInAltrPos||mirrorLines)&&(this.borderLineEnable[i+2]=ax.showline),(hasAxisInDfltPos||mirrorTicks)&&(this.tickMarkLength[i]=this.getTickMarkLength(ax)),(hasAxisInAltrPos||mirrorTicks)&&(this.tickMarkLength[i+2]=this.getTickMarkLength(ax)),this.gridLineEnable[i]=ax.showgrid,this.gridLineColor[i]=_$str2RgbaArray_561(ax.gridcolor),this.gridLineWidth[i]=ax.gridwidth,this.zeroLineEnable[i]=ax.zeroline,this.zeroLineColor[i]=_$str2RgbaArray_561(ax.zerolinecolor),this.zeroLineWidth[i]=ax.zerolinewidth}},__proto_623.hasSharedAxis=function(ax){var scene=this.scene,subplotIds=scene.fullLayout._subplots.gl2d;return 0!==_$axes_584.findSubplotsWithAxis(subplotIds,ax).indexOf(scene.id)},__proto_623.hasAxisInDfltPos=function(axisName,ax){var axSide=ax.side;return"xaxis"===axisName?"bottom"===axSide:"yaxis"===axisName?"left"===axSide:void 0},__proto_623.hasAxisInAltrPos=function(axisName,ax){var axSide=ax.side;return"xaxis"===axisName?"top"===axSide:"yaxis"===axisName?"right"===axSide:void 0},__proto_623.getLabelPad=function(axisName,ax){var fontSize=ax.titlefont.size,showticklabels=ax.showticklabels;return"xaxis"===axisName?"top"===ax.side?fontSize*(1.5+(showticklabels?1:0))-10:fontSize*(1.5+(showticklabels?.5:0))-10:"yaxis"===axisName?"right"===ax.side?10+fontSize*(1.5+(showticklabels?1:.5)):10+fontSize*(1.5+(showticklabels?.5:0)):void 0},__proto_623.getTickPad=function(ax){return"outside"===ax.ticks?10+ax.ticklen:15},__proto_623.getTickMarkLength=function(ax){if(!ax.ticks)return 0;var ticklen=ax.ticklen;return"inside"===ax.ticks?-ticklen:ticklen};var STATIC_CANVAS,STATIC_CONTEXT,_$createAxes2D_623=function createAxes2D(scene){return new Axes2DOptions(scene)},__enforceAxisConstraints_625=_$constraints_591.enforce,__cleanAxisConstraints_625=_$constraints_591.clean,__doAutoRange_625=_$autorange___doAutoRange,__AXES_625=["xaxis","yaxis"],__SUBPLOT_PATTERN_625=_$constants_589.SUBPLOT_PATTERN;function Scene2D(options,fullLayout){this.container=options.container,this.graphDiv=options.graphDiv,this.pixelRatio=options.plotGlPixelRatio||window.devicePixelRatio,this.id=options.id,this.staticPlot=!!options.staticPlot,this.scrollZoom=this.graphDiv._context.scrollZoom,this.fullData=null,this.updateRefs(fullLayout),this.makeFramework(),this.glplotOptions=_$createAxes2D_623(this),this.glplotOptions.merge(fullLayout),this.glplot=_$createGLPlot2D_194(this.glplotOptions),this.camera=_$createCamera_622(this),this.traces={},this.spikes=_$createSpikes2D_213(this.glplot),this.selectBox=_$createSelectBox_204(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw()}var _$Scene2D_625=Scene2D,__proto_625=Scene2D.prototype;__proto_625.makeFramework=function(){if(this.staticPlot){if(!(STATIC_CONTEXT||(STATIC_CANVAS=document.createElement("canvas"),STATIC_CONTEXT=_$getWebGLContext_373({canvas:STATIC_CANVAS,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}))))throw new Error("Error creating static canvas/context for image server");this.canvas=STATIC_CANVAS,this.gl=STATIC_CONTEXT}else{var liveCanvas=this.container.querySelector(".gl-canvas-focus"),gl=_$getWebGLContext_373({canvas:liveCanvas,preserveDrawingBuffer:!0,premultipliedAlpha:!0});gl||_$showWebGlMsg_559(this),this.canvas=liveCanvas,this.gl=gl}var canvas=this.canvas;canvas.style.width="100%",canvas.style.height="100%",canvas.style.position="absolute",canvas.style.top="0px",canvas.style.left="0px",canvas.style["pointer-events"]="none",this.updateSize(canvas),canvas.className+=" user-select-none";var svgContainer=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");svgContainer.style.position="absolute",svgContainer.style.top=svgContainer.style.left="0px",svgContainer.style.width=svgContainer.style.height="100%",svgContainer.style["z-index"]=20,svgContainer.style["pointer-events"]="none";var mouseContainer=this.mouseContainer=document.createElement("div");mouseContainer.style.position="absolute",mouseContainer.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var container=this.container;container.appendChild(svgContainer),container.appendChild(mouseContainer);var self=this;mouseContainer.addEventListener("mouseout",function(){self.isMouseOver=!1,self.unhover()}),mouseContainer.addEventListener("mouseover",function(){self.isMouseOver=!0})},__proto_625.toImage=function(format){format||(format="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(STATIC_CANVAS),this.updateSize(this.canvas);var gl=this.glplot.gl,w=gl.drawingBufferWidth,h=gl.drawingBufferHeight;gl.clearColor(1,1,1,0),gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),gl.bindFramebuffer(gl.FRAMEBUFFER,null);var pixels=new Uint8Array(w*h*4);gl.readPixels(0,0,w,h,gl.RGBA,gl.UNSIGNED_BYTE,pixels);for(var j=0,k=h-1;j<k;++j,--k)for(var i=0;i<w;++i)for(var l=0;l<4;++l){var tmp=pixels[4*(w*j+i)+l];pixels[4*(w*j+i)+l]=pixels[4*(w*k+i)+l],pixels[4*(w*k+i)+l]=tmp}var canvas=document.createElement("canvas");canvas.width=w,canvas.height=h;var dataURL,context=canvas.getContext("2d"),imageData=context.createImageData(w,h);switch(imageData.data.set(pixels),context.putImageData(imageData,0,0),format){case"jpeg":dataURL=canvas.toDataURL("image/jpeg");break;case"webp":dataURL=canvas.toDataURL("image/webp");break;default:dataURL=canvas.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(STATIC_CANVAS),dataURL},__proto_625.updateSize=function(canvas){canvas||(canvas=this.canvas);var pixelRatio=this.pixelRatio,fullLayout=this.fullLayout,width=fullLayout.width,height=fullLayout.height,pixelWidth=0|Math.ceil(pixelRatio*width),pixelHeight=0|Math.ceil(pixelRatio*height);return canvas.width===pixelWidth&&canvas.height===pixelHeight||(canvas.width=pixelWidth,canvas.height=pixelHeight),canvas},__proto_625.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var nextTicks=[_$axes_584.calcTicks(this.xaxis),_$axes_584.calcTicks(this.yaxis)],j=0;j<2;++j)for(var i=0;i<nextTicks[j].length;++i)nextTicks[j][i].text=_$convertHTMLToUnicode_537(nextTicks[j][i].text+"");return nextTicks},__proto_625.updateRefs=function(newFullLayout){this.fullLayout=newFullLayout;var spmatch=this.id.match(__SUBPLOT_PATTERN_625),xaxisName="xaxis"+spmatch[1],yaxisName="yaxis"+spmatch[2];this.xaxis=this.fullLayout[xaxisName],this.yaxis=this.fullLayout[yaxisName]},__proto_625.relayoutCallback=function(){var graphDiv=this.graphDiv,xaxis=this.xaxis,yaxis=this.yaxis,layout=graphDiv.layout;layout.xaxis.autorange=xaxis.autorange,layout.xaxis.range=xaxis.range.slice(0),layout.yaxis.autorange=yaxis.autorange,layout.yaxis.range=yaxis.range.slice(0);var update={lastInputTime:this.camera.lastInputTime};update[xaxis._name]=xaxis.range.slice(0),update[yaxis._name]=yaxis.range.slice(0),graphDiv.emit("plotly_relayout",update)},__proto_625.cameraChanged=function(){var camera=this.camera;this.glplot.setDataBox(this.calcDataBox());var nextTicks=this.computeTickMarks();(function __compareTicks_625(a,b){for(var i=0;i<2;++i){var aticks=a[i],bticks=b[i];if(aticks.length!==bticks.length)return!0;for(var j=0;j<aticks.length;++j)if(aticks[j].x!==bticks[j].x)return!0}return!1})(nextTicks,this.glplotOptions.ticks)&&(this.glplotOptions.ticks=nextTicks,this.glplotOptions.dataBox=camera.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},__proto_625.handleAnnotations=function(){for(var gd=this.graphDiv,annotations=this.fullLayout.annotations,i=0;i<annotations.length;i++){var ann=annotations[i];ann.xref===this.xaxis._id&&ann.yref===this.yaxis._id&&_$registry_668.getComponentMethod("annotations","drawOne")(gd,i)}},__proto_625.destroy=function(){if(this.glplot){var traces=this.traces;traces&&Object.keys(traces).map(function(key){traces[key].dispose(),delete traces[key]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},__proto_625.plot=function(fullData,calcData,fullLayout){var glplot=this.glplot;this.updateRefs(fullLayout),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(fullData,calcData),this.updateFx(fullLayout.dragmode);var width=fullLayout.width,height=fullLayout.height;this.updateSize(this.canvas);var options=this.glplotOptions;options.merge(fullLayout),options.screenBox=[0,0,width,height];var mockGraphDiv={_fullLayout:{_axisConstraintGroups:this.graphDiv._fullLayout._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis}};__cleanAxisConstraints_625(mockGraphDiv,this.xaxis),__cleanAxisConstraints_625(mockGraphDiv,this.yaxis);var ax,i,size=fullLayout._size,domainX=this.xaxis.domain,domainY=this.yaxis.domain;for(options.viewBox=[size.l+domainX[0]*size.w,size.b+domainY[0]*size.h,width-size.r-(1-domainX[1])*size.w,height-size.t-(1-domainY[1])*size.h],this.mouseContainer.style.width=size.w*(domainX[1]-domainX[0])+"px",this.mouseContainer.style.height=size.h*(domainY[1]-domainY[0])+"px",this.mouseContainer.height=size.h*(domainY[1]-domainY[0]),this.mouseContainer.style.left=size.l+domainX[0]*size.w+"px",this.mouseContainer.style.top=size.t+(1-domainY[1])*size.h+"px",i=0;i<2;++i)(ax=this[__AXES_625[i]])._length=options.viewBox[i+2]-options.viewBox[i],__doAutoRange_625(ax),ax.setScale();__enforceAxisConstraints_625(mockGraphDiv),options.ticks=this.computeTickMarks(),options.dataBox=this.calcDataBox(),options.merge(fullLayout),glplot.update(options),this.glplot.draw()},__proto_625.calcDataBox=function(){var xaxis=this.xaxis,yaxis=this.yaxis,xrange=xaxis.range,yrange=yaxis.range,xr2l=xaxis.r2l,yr2l=yaxis.r2l;return[xr2l(xrange[0]),yr2l(yrange[0]),xr2l(xrange[1]),yr2l(yrange[1])]},__proto_625.setRanges=function(dataBox){var xaxis=this.xaxis,yaxis=this.yaxis,xl2r=xaxis.l2r,yl2r=yaxis.l2r;xaxis.range=[xl2r(dataBox[0]),xl2r(dataBox[2])],yaxis.range=[yl2r(dataBox[1]),yl2r(dataBox[3])]},__proto_625.updateTraces=function(fullData,calcData){var i,j,fullTrace,traceIds=Object.keys(this.traces);this.fullData=fullData;trace_id_loop:for(i=0;i<traceIds.length;i++){var oldUid=traceIds[i],oldTrace=this.traces[oldUid];for(j=0;j<fullData.length;j++)if((fullTrace=fullData[j]).uid===oldUid&&fullTrace.type===oldTrace.type)continue trace_id_loop;oldTrace.dispose(),delete this.traces[oldUid]}for(i=0;i<fullData.length;i++){fullTrace=fullData[i];var calcTrace=calcData[i],traceObj=this.traces[fullTrace.uid];traceObj?traceObj.update(fullTrace,calcTrace):(traceObj=fullTrace._module.plot(this,fullTrace,calcTrace),this.traces[fullTrace.uid]=traceObj)}this.glplot.objects.sort(function(a,b){return a._trace.index-b._trace.index})},__proto_625.updateFx=function(dragmode){"lasso"===dragmode||"select"===dragmode?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),this.mouseContainer.style.cursor="pan"===dragmode?"move":"zoom"===dragmode?"crosshair":null},__proto_625.emitPointAction=function(nextSelection,eventType){for(var trace,uid=nextSelection.trace.uid,ptNumber=nextSelection.pointIndex,i=0;i<this.fullData.length;i++)this.fullData[i].uid===uid&&(trace=this.fullData[i]);var pointData={x:nextSelection.traceCoord[0],y:nextSelection.traceCoord[1],curveNumber:trace.index,pointNumber:ptNumber,data:trace._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};_$fx_453.appendArrayPointValue(pointData,trace,ptNumber),this.graphDiv.emit(eventType,{points:[pointData]})},__proto_625.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var glplot=this.glplot,camera=this.camera,mouseListener=camera.mouseListener,mouseUp=1===this.lastButtonState&&0===mouseListener.buttons,fullLayout=this.fullLayout;this.lastButtonState=mouseListener.buttons,this.cameraChanged();var result,x=mouseListener.x*glplot.pixelRatio,y=this.canvas.height-glplot.pixelRatio*mouseListener.y;if(camera.boxEnabled&&"zoom"===fullLayout.dragmode){this.selectBox.enabled=!0;for(var selectBox=this.selectBox.selectBox=[Math.min(camera.boxStart[0],camera.boxEnd[0]),Math.min(camera.boxStart[1],camera.boxEnd[1]),Math.max(camera.boxStart[0],camera.boxEnd[0]),Math.max(camera.boxStart[1],camera.boxEnd[1])],i=0;i<2;i++)camera.boxStart[i]===camera.boxEnd[i]&&(selectBox[i]=glplot.dataBox[i],selectBox[i+2]=glplot.dataBox[i+2]);glplot.setDirty()}else if(!camera.panning&&this.isMouseOver){this.selectBox.enabled=!1;var size=fullLayout._size,domainX=this.xaxis.domain,domainY=this.yaxis.domain,nextSelection=(result=glplot.pick(x/glplot.pixelRatio+size.l+domainX[0]*size.w,y/glplot.pixelRatio-(size.t+(1-domainY[1])*size.h)))&&result.object._trace.handlePick(result);if(nextSelection&&mouseUp&&this.emitPointAction(nextSelection,"plotly_click"),result&&"skip"!==result.object._trace.hoverinfo&&fullLayout.hovermode&&nextSelection&&(!this.lastPickResult||this.lastPickResult.traceUid!==nextSelection.trace.uid||this.lastPickResult.dataCoord[0]!==nextSelection.dataCoord[0]||this.lastPickResult.dataCoord[1]!==nextSelection.dataCoord[1])){var selection=nextSelection;this.lastPickResult={traceUid:nextSelection.trace?nextSelection.trace.uid:null,dataCoord:nextSelection.dataCoord.slice()},this.spikes.update({center:result.dataCoord}),selection.screenCoord=[((glplot.viewBox[2]-glplot.viewBox[0])*(result.dataCoord[0]-glplot.dataBox[0])/(glplot.dataBox[2]-glplot.dataBox[0])+glplot.viewBox[0])/glplot.pixelRatio,(this.canvas.height-(glplot.viewBox[3]-glplot.viewBox[1])*(result.dataCoord[1]-glplot.dataBox[1])/(glplot.dataBox[3]-glplot.dataBox[1])-glplot.viewBox[1])/glplot.pixelRatio],this.emitPointAction(nextSelection,"plotly_hover");var trace=this.fullData[selection.trace.index]||{},ptNumber=selection.pointIndex,hoverinfo=_$fx_453.castHoverinfo(trace,fullLayout,ptNumber);if(hoverinfo&&"all"!==hoverinfo){var parts=hoverinfo.split("+");-1===parts.indexOf("x")&&(selection.traceCoord[0]=void 0),-1===parts.indexOf("y")&&(selection.traceCoord[1]=void 0),-1===parts.indexOf("z")&&(selection.traceCoord[2]=void 0),-1===parts.indexOf("text")&&(selection.textLabel=void 0),-1===parts.indexOf("name")&&(selection.name=void 0)}_$fx_453.loneHover({x:selection.screenCoord[0],y:selection.screenCoord[1],xLabel:this.hoverFormatter("xaxis",selection.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",selection.traceCoord[1]),zLabel:selection.traceCoord[2],text:selection.textLabel,name:selection.name,color:_$fx_453.castHoverOption(trace,ptNumber,"bgcolor")||selection.color,borderColor:_$fx_453.castHoverOption(trace,ptNumber,"bordercolor"),fontFamily:_$fx_453.castHoverOption(trace,ptNumber,"font.family"),fontSize:_$fx_453.castHoverOption(trace,ptNumber,"font.size"),fontColor:_$fx_453.castHoverOption(trace,ptNumber,"font.color")},{container:this.svgContainer,gd:this.graphDiv})}}result||this.unhover(),glplot.draw()}},__proto_625.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),_$fx_453.loneUnhover(this.svgContainer))},__proto_625.hoverFormatter=function(axisName,val){if(void 0!==val){var axis=this[axisName];return _$axes_584.tickText(axis,axis.c2l(val),"hover").text}};var _$gl2d_624={},__overrideAll_624=_$edit_types_569.overrideAll,getSubplotData=_$get_data_621.getSubplotData;_$gl2d_624.name="gl2d",_$gl2d_624.attr=["xaxis","yaxis"],_$gl2d_624.idRoot=["x","y"],_$gl2d_624.idRegex=_$constants_589.idRegex,_$gl2d_624.attrRegex=_$constants_589.attrRegex,_$gl2d_624.attributes=_$attributes_582,_$gl2d_624.supplyLayoutDefaults=function(layoutIn,layoutOut,fullData){layoutOut._has("cartesian")||_$cartesian_595.supplyLayoutDefaults(layoutIn,layoutOut,fullData)},_$gl2d_624.layoutAttrOverrides=__overrideAll_624(_$cartesian_595.layoutAttributes,"plot","from-root"),_$gl2d_624.baseLayoutAttrOverrides=__overrideAll_624({plot_bgcolor:_$layout_attributes_638.plot_bgcolor,hoverlabel:_$layout_attributes_454.hoverlabel},"plot","nested"),_$gl2d_624.plot=function plotGl2d(gd){for(var fullLayout=gd._fullLayout,fullData=gd._fullData,subplotIds=fullLayout._subplots.gl2d,i=0;i<subplotIds.length;i++){var subplotId=subplotIds[i],subplotObj=fullLayout._plots[subplotId],fullSubplotData=getSubplotData(fullData,"gl2d",subplotId),scene=subplotObj._scene2d;void 0===scene&&(scene=new _$Scene2D_625({id:subplotId,graphDiv:gd,container:gd.querySelector(".gl-container"),staticPlot:gd._context.staticPlot,plotGlPixelRatio:gd._context.plotGlPixelRatio},fullLayout),subplotObj._scene2d=scene),scene.plot(fullSubplotData,gd.calcdata,fullLayout,gd.layout)}},_$gl2d_624.clean=function(newFullData,newFullLayout,oldFullData,oldFullLayout){for(var oldSceneKeys=oldFullLayout._subplots.gl2d||[],i=0;i<oldSceneKeys.length;i++){var id=oldSceneKeys[i],oldSubplot=oldFullLayout._plots[id];if(oldSubplot._scene2d)0===getSubplotData(newFullData,"gl2d",id).length&&(oldSubplot._scene2d.destroy(),delete oldFullLayout._plots[id])}_$cartesian_595.clean.apply(this,arguments)},_$gl2d_624.drawFramework=function(gd){gd._context.staticPlot||_$cartesian_595.drawFramework(gd)},_$gl2d_624.toSVG=function(gd){for(var fullLayout=gd._fullLayout,subplotIds=fullLayout._subplots.gl2d,i=0;i<subplotIds.length;i++){var scene=fullLayout._plots[subplotIds[i]]._scene2d,imageData=scene.toImage("png");fullLayout._glimages.append("svg:image").attr({xmlns:_$xmlns_namespaces_519.svg,"xlink:href":imageData,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),scene.destroy()}},_$gl2d_624.updateFx=function(fullLayout){for(var subplotIds=fullLayout._subplots.gl2d,i=0;i<subplotIds.length;i++){fullLayout._plots[subplotIds[i]]._scene2d.updateFx(fullLayout.dragmode)}};for(var __extendFlat_790=_$extend_528.extendFlat,__overrideAll_790=_$edit_types_569.overrideAll,commonList=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],__attrs_790={},__i_790=0;__i_790<commonList.length;__i_790++){var k=commonList[__i_790];__attrs_790[k]=_$attributes_773[k]}__extendFlat_790(__attrs_790,_$attributes_417,{autocolorscale:__extendFlat_790({},_$attributes_417.autocolorscale,{dflt:!1})},{colorbar:_$attributes_412});var _$attributes_790=__overrideAll_790(__attrs_790,"calc","nested"),_$shaders_161={fragment:_$browser_238(["precision lowp float;\n#define GLSLIFY 1\nvarying vec4 fragColor;\nvoid main() {\n  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);\n}\n"]),vertex:_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 color;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  fragColor = color;\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"]),pickFragment:_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nuniform vec2 shape;\nuniform vec4 pickOffset;\n\nvoid main() {\n  vec2 d = step(.5, vWeight);\n  vec4 id = fragId + pickOffset;\n  id.x += d.x + d.y*shape.x;\n\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  gl_FragColor = id/255.;\n}\n"]),pickVertex:_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nvoid main() {\n  vWeight = weight;\n\n  fragId = pickId;\n\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"])};function __compileSearch_162(funcName,predicate,reversed,extraArgs,earlyOut){var code=["function ",funcName,"(a,l,h,",extraArgs.join(","),"){",earlyOut?"":"var i=",reversed?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a[m]"];return earlyOut?predicate.indexOf("c")<0?code.push(";if(x===y){return m}else if(x<=y){"):code.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):code.push(";if(",predicate,"){i=m;"),reversed?code.push("l=m+1}else{h=m-1}"):code.push("h=m-1}else{l=m+1}"),code.push("}"),earlyOut?code.push("return -1};"):code.push("return i};"),code.join("")}function __compileBoundsSearch_162(predicate,reversed,suffix,earlyOut){return new Function([__compileSearch_162("A","x"+predicate+"y",reversed,["y"],earlyOut),__compileSearch_162("P","c(x,y)"+predicate+"0",reversed,["y","c"],earlyOut),"function dispatchBsearch",suffix,"(a,y,c,l,h){if(typeof(c)==='function'){return P(a,(l===void 0)?0:l|0,(h===void 0)?a.length-1:h|0,y,c)}else{return A(a,(c===void 0)?0:c|0,(l===void 0)?a.length-1:l|0,y)}}return dispatchBsearch",suffix].join(""))()}var _$searchBounds_162={ge:__compileBoundsSearch_162(">=",!1,"GE"),gt:__compileBoundsSearch_162(">",!1,"GT"),lt:__compileBoundsSearch_162("<",!0,"LT"),le:__compileBoundsSearch_162("<=",!0,"LE"),eq:__compileBoundsSearch_162("-",!0,"EQ",!0)},_$createHeatmap2D_160=function createHeatmap2D(plot,options){var gl=plot.gl,shader=_$createShader_206(gl,_$shaders_161.vertex,_$shaders_161.fragment),pickShader=_$createShader_206(gl,_$shaders_161.pickVertex,_$shaders_161.pickFragment),positionBuffer=_$createBuffer_153(gl),weightBuffer=_$createBuffer_153(gl),colorBuffer=_$createBuffer_153(gl),idBuffer=_$createBuffer_153(gl),heatmap=new GLHeatmap2D(plot,shader,pickShader,positionBuffer,weightBuffer,colorBuffer,idBuffer);return heatmap.update(options),plot.addObject(heatmap),heatmap};function GLHeatmap2D(plot,shader,pickShader,positionBuffer,weightBuffer,colorBuffer,idBuffer){this.plot=plot,this.shader=shader,this.pickShader=pickShader,this.positionBuffer=positionBuffer,this.weightBuffer=weightBuffer,this.colorBuffer=colorBuffer,this.idBuffer=idBuffer,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}var MATRIX,__proto_160=GLHeatmap2D.prototype,WEIGHTS=[0,0,1,0,0,1,1,0,1,1,0,1];function __Heatmap_791(scene,uid){this.scene=scene,this.uid=uid,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=_$createHeatmap2D_160(scene.glplot,this.options),this.heatmap._trace=this}__proto_160.draw=(MATRIX=[1,0,0,0,1,0,0,0,1],function(){var plot=this.plot,shader=this.shader,bounds=this.bounds,numVertices=this.numVertices;if(!(numVertices<=0)){var gl=plot.gl,dataBox=plot.dataBox,boundX=bounds[2]-bounds[0],boundY=bounds[3]-bounds[1],dataX=dataBox[2]-dataBox[0],dataY=dataBox[3]-dataBox[1];MATRIX[0]=2*boundX/dataX,MATRIX[4]=2*boundY/dataY,MATRIX[6]=2*(bounds[0]-dataBox[0])/dataX-1,MATRIX[7]=2*(bounds[1]-dataBox[1])/dataY-1,shader.bind();var uniforms=shader.uniforms;uniforms.viewTransform=MATRIX,uniforms.shape=this.shape;var attributes=shader.attributes;this.positionBuffer.bind(),attributes.position.pointer(),this.weightBuffer.bind(),attributes.weight.pointer(gl.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),attributes.color.pointer(gl.UNSIGNED_BYTE,!0),gl.drawArrays(gl.TRIANGLES,0,numVertices)}}),__proto_160.drawPick=function(){var MATRIX=[1,0,0,0,1,0,0,0,1],PICK_VECTOR=[0,0,0,0];return function(pickOffset){var plot=this.plot,shader=this.pickShader,bounds=this.bounds,numVertices=this.numVertices;if(!(numVertices<=0)){var gl=plot.gl,dataBox=plot.dataBox,boundX=bounds[2]-bounds[0],boundY=bounds[3]-bounds[1],dataX=dataBox[2]-dataBox[0],dataY=dataBox[3]-dataBox[1];MATRIX[0]=2*boundX/dataX,MATRIX[4]=2*boundY/dataY,MATRIX[6]=2*(bounds[0]-dataBox[0])/dataX-1,MATRIX[7]=2*(bounds[1]-dataBox[1])/dataY-1;for(var i=0;i<4;++i)PICK_VECTOR[i]=pickOffset>>8*i&255;this.pickOffset=pickOffset,shader.bind();var uniforms=shader.uniforms;uniforms.viewTransform=MATRIX,uniforms.pickOffset=PICK_VECTOR,uniforms.shape=this.shape;var attributes=shader.attributes;return this.positionBuffer.bind(),attributes.position.pointer(),this.weightBuffer.bind(),attributes.weight.pointer(gl.UNSIGNED_BYTE,!1),this.idBuffer.bind(),attributes.pickId.pointer(gl.UNSIGNED_BYTE,!1),gl.drawArrays(gl.TRIANGLES,0,numVertices),pickOffset+this.shape[0]*this.shape[1]}}}(),__proto_160.pick=function(x,y,value){var pickOffset=this.pickOffset,pointCount=this.shape[0]*this.shape[1];if(value<pickOffset||value>=pickOffset+pointCount)return null;var pointId=value-pickOffset,xData=this.xData,yData=this.yData;return{object:this,pointId:pointId,dataCoord:[xData[pointId%this.shape[0]],yData[pointId/this.shape[0]|0]]}},__proto_160.update=function(options){var shape=(options=options||{}).shape||[0,0],x=options.x||_$iota_245(shape[0]),y=options.y||_$iota_245(shape[1]),z=options.z||new Float32Array(shape[0]*shape[1]);this.xData=x,this.yData=y;var colorLevels=options.colorLevels||[0],colorValues=options.colorValues||[0,0,0,1],colorCount=colorLevels.length,bounds=this.bounds,lox=bounds[0]=x[0],loy=bounds[1]=y[0],xs=1/((bounds[2]=x[x.length-1])-lox),ys=1/((bounds[3]=y[y.length-1])-loy),numX=shape[0],numY=shape[1];this.shape=[numX,numY];var numVerts=(numX-1)*(numY-1)*(WEIGHTS.length>>>1);this.numVertices=numVerts;for(var colors=_$pool_360.mallocUint8(4*numVerts),positions=_$pool_360.mallocFloat32(2*numVerts),weights=_$pool_360.mallocUint8(2*numVerts),ids=_$pool_360.mallocUint32(numVerts),ptr=0,j=0;j<numY-1;++j)for(var yc0=ys*(y[j]-loy),yc1=ys*(y[j+1]-loy),i=0;i<numX-1;++i)for(var xc0=xs*(x[i]-lox),xc1=xs*(x[i+1]-lox),dd=0;dd<WEIGHTS.length;dd+=2){var r,g,b,a,dx=WEIGHTS[dd],dy=WEIGHTS[dd+1],zc=z[(j+dy)*numX+(i+dx)],colorIdx=_$searchBounds_162.le(colorLevels,zc);if(colorIdx<0)r=colorValues[0],g=colorValues[1],b=colorValues[2],a=colorValues[3];else if(colorIdx===colorCount-1)r=colorValues[4*colorCount-4],g=colorValues[4*colorCount-3],b=colorValues[4*colorCount-2],a=colorValues[4*colorCount-1];else{var t=(zc-colorLevels[colorIdx])/(colorLevels[colorIdx+1]-colorLevels[colorIdx]),ti=1-t,i0=4*colorIdx,i1=4*(colorIdx+1);r=ti*colorValues[i0]+t*colorValues[i1],g=ti*colorValues[i0+1]+t*colorValues[i1+1],b=ti*colorValues[i0+2]+t*colorValues[i1+2],a=ti*colorValues[i0+3]+t*colorValues[i1+3]}colors[4*ptr]=255*r,colors[4*ptr+1]=255*g,colors[4*ptr+2]=255*b,colors[4*ptr+3]=255*a,positions[2*ptr]=.5*xc0+.5*xc1,positions[2*ptr+1]=.5*yc0+.5*yc1,weights[2*ptr]=dx,weights[2*ptr+1]=dy,ids[ptr]=j*numX+i,ptr+=1}this.positionBuffer.update(positions),this.weightBuffer.update(weights),this.colorBuffer.update(colors),this.idBuffer.update(ids),_$pool_360.free(positions),_$pool_360.free(colors),_$pool_360.free(weights),_$pool_360.free(ids)},__proto_160.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)};var __proto_791=__Heatmap_791.prototype;__proto_791.handlePick=function(pickResult){var options=this.options,shape=options.shape,index=pickResult.pointId,xIndex=index%shape[0],yIndex=Math.floor(index/shape[0]),zIndex=index;return{trace:this,dataCoord:pickResult.dataCoord,traceCoord:[options.x[xIndex],options.y[yIndex],options.z[zIndex]],textLabel:this.textLabels[index],name:this.name,pointIndex:[yIndex,xIndex],hoverinfo:this.hoverinfo}},__proto_791.update=function(fullTrace,calcTrace){var calcPt=calcTrace[0];this.index=fullTrace.index,this.name=fullTrace.name,this.hoverinfo=fullTrace.hoverinfo;var z=calcPt.z;this.options.z=[].concat.apply([],z);var rowLen=z[0].length,colLen=z.length;this.options.shape=[rowLen,colLen],this.options.x=calcPt.x,this.options.y=calcPt.y;var colorOptions=function convertColorscale(fullTrace){for(var scl=fullTrace.colorscale,zmin=fullTrace.zmin,zmax=fullTrace.zmax,N=scl.length,domain=new Array(N),range=new Array(4*N),i=0;i<N;i++){var si=scl[i],color=_$str2RgbaArray_561(si[1]);domain[i]=zmin+si[0]*(zmax-zmin);for(var j=0;j<4;j++)range[4*i+j]=color[j]}return{colorLevels:domain,colorValues:range}}(fullTrace);this.options.colorLevels=colorOptions.colorLevels,this.options.colorValues=colorOptions.colorValues,this.textLabels=[].concat.apply([],fullTrace.text),this.heatmap.update(this.options),_$axes_584.expand(this.scene.xaxis,calcPt.x),_$axes_584.expand(this.scene.yaxis,calcPt.y)},__proto_791.dispose=function(){this.heatmap.dispose()};var _$createHeatmap_791=function createHeatmap(scene,fullTrace,calcTrace){var plot=new __Heatmap_791(scene,fullTrace.uid);return plot.update(fullTrace,calcTrace),plot},HeatmapGl={};HeatmapGl.attributes=_$attributes_790,HeatmapGl.supplyDefaults=_$supplyDefaults_778,HeatmapGl.colorbar=_$colorbar_776,HeatmapGl.calc=_$calc_774,HeatmapGl.plot=_$createHeatmap_791,HeatmapGl.moduleType="trace",HeatmapGl.name="heatmapgl",HeatmapGl.basePlotModule=_$gl2d_624,HeatmapGl.categories=["gl","gl2d","2dMap"],HeatmapGl.meta={};var _$heatmapgl_16=HeatmapGl,_$attributes_793={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},text:_$attributes_678.text,orientation:_$attributes_678.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},autobinx:{valType:"boolean",dflt:null,editType:"calc",impliedEdits:{"xbins.start":void 0,"xbins.end":void 0,"xbins.size":void 0}},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:makeBinsAttr("x"),autobiny:{valType:"boolean",dflt:null,editType:"calc",impliedEdits:{"ybins.start":void 0,"ybins.end":void 0,"ybins.size":void 0}},nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:makeBinsAttr("y"),marker:_$attributes_678.marker,selected:_$attributes_678.selected,unselected:_$attributes_678.unselected,_deprecated:{bardir:_$attributes_678._deprecated.bardir}};function makeBinsAttr(axLetter){var impliedEdits={};impliedEdits["autobin"+axLetter]=!1;var impliedEditsInner={};return impliedEditsInner["^autobin"+axLetter]=!1,{start:{valType:"any",dflt:null,editType:"calc",impliedEdits:impliedEditsInner},end:{valType:"any",dflt:null,editType:"calc",impliedEdits:impliedEditsInner},size:{valType:"any",dflt:null,editType:"calc",impliedEdits:impliedEditsInner},editType:"calc",impliedEdits:impliedEdits}}var __oneMonth_798=_$numerical_517.ONEAVGMONTH;function calcAllAutoBins(gd,trace,pa,mainData,_overlayEdgeCase){var i,tracei,calendar,firstManual,pos0,binAttr=mainData+"bins",isOverlay="overlay"===gd._fullLayout.barmode;if(trace._autoBinFinished)delete trace._autoBinFinished;else{var traceGroup=isOverlay?[trace]:getConnectedHistograms(gd,trace),autoBinnedTraces=[],minSize=1/0,minStart=1/0,maxEnd=-1/0,autoBinAttr="autobin"+mainData;for(i=0;i<traceGroup.length;i++){pos0=(tracei=traceGroup[i])._pos0=pa.makeCalcdata(tracei,mainData);var binSpec=tracei[binAttr];if(tracei[autoBinAttr]||!binSpec||null===binSpec.start||null===binSpec.end){calendar=tracei[mainData+"calendar"];var cumulativeSpec=tracei.cumulative;if(binSpec=_$axes_584.autoBin(pos0,pa,tracei["nbins"+mainData],!1,calendar),isOverlay&&0===binSpec._dataSpan&&"category"!==pa.type){if(_overlayEdgeCase)return[binSpec,pos0,!0];binSpec=handleSingleValueOverlays(gd,trace,pa,mainData,binAttr)}cumulativeSpec.enabled&&"include"!==cumulativeSpec.currentbin&&("decreasing"===cumulativeSpec.direction?minStart=Math.min(minStart,pa.r2c(binSpec.start,0,calendar)-binSpec.size):maxEnd=Math.max(maxEnd,pa.r2c(binSpec.end,0,calendar)+binSpec.size)),autoBinnedTraces.push(tracei)}else firstManual||(firstManual={size:binSpec.size,start:pa.r2c(binSpec.start,0,calendar),end:pa.r2c(binSpec.end,0,calendar)});minSize=getMinSize(minSize,binSpec.size),minStart=Math.min(minStart,pa.r2c(binSpec.start,0,calendar)),maxEnd=Math.max(maxEnd,pa.r2c(binSpec.end,0,calendar)),i&&(tracei._autoBinFinished=1)}if(firstManual&&_$fastIsnumeric_139(firstManual.size)&&_$fastIsnumeric_139(minSize)){minSize=minSize>firstManual.size/1.9?firstManual.size:firstManual.size/Math.ceil(firstManual.size/minSize);var adjustedFirstStart=firstManual.start+(firstManual.size-minSize)/2;minStart=adjustedFirstStart-minSize*Math.ceil((adjustedFirstStart-minStart)/minSize)}for(i=0;i<autoBinnedTraces.length;i++)calendar=(tracei=autoBinnedTraces[i])[mainData+"calendar"],tracei._input[binAttr]=tracei[binAttr]={start:pa.c2r(minStart,0,calendar),end:pa.c2r(maxEnd,0,calendar),size:minSize},tracei._input[autoBinAttr]=tracei[autoBinAttr]}return pos0=trace._pos0,delete trace._pos0,[trace[binAttr],pos0]}function handleSingleValueOverlays(gd,trace,pa,mainData,binAttr){var i,tracei,overlaidTraceGroup=getConnectedHistograms(gd,trace),pastThisTrace=!1,minSize=1/0,singleValuedTraces=[trace];for(i=0;i<overlaidTraceGroup.length;i++)if((tracei=overlaidTraceGroup[i])===trace)pastThisTrace=!0;else if(pastThisTrace){var resulti=calcAllAutoBins(gd,tracei,pa,mainData,!0),binSpeci=resulti[0],isSingleValued=resulti[2];tracei._autoBinFinished=1,tracei._pos0=resulti[1],isSingleValued?singleValuedTraces.push(tracei):minSize=Math.min(minSize,binSpeci.size)}else minSize=Math.min(minSize,tracei[binAttr].size);var dataVals=new Array(singleValuedTraces.length);for(i=0;i<singleValuedTraces.length;i++)for(var pos0=singleValuedTraces[i]._pos0,j=0;j<pos0.length;j++)if(void 0!==pos0[j]){dataVals[i]=pos0[j];break}for(isFinite(minSize)||(minSize=_$lib_539.distinctVals(dataVals).minDiff),i=0;i<singleValuedTraces.length;i++){var calendar=(tracei=singleValuedTraces[i])[mainData+"calendar"];tracei._input[binAttr]=tracei[binAttr]={start:pa.c2r(dataVals[i]-minSize/2,0,calendar),end:pa.c2r(dataVals[i]+minSize/2,0,calendar),size:minSize}}return trace[binAttr]}function getConnectedHistograms(gd,trace){for(var xid=trace.xaxis,yid=trace.yaxis,orientation=trace.orientation,out=[],fullData=gd._fullData,i=0;i<fullData.length;i++){var tracei=fullData[i];"histogram"===tracei.type&&tracei.orientation===orientation&&tracei.xaxis===xid&&tracei.yaxis===yid&&out.push(tracei)}return out}function getMinSize(size1,size2){if(size1===1/0)return size2;var sizeNumeric1=numericSize(size1);return numericSize(size2)<sizeNumeric1?size2:size1}function numericSize(size){return _$fastIsnumeric_139(size)?size:"string"==typeof size&&"M"===size.charAt(0)?__oneMonth_798*+size.substr(1):1/0}var _$handleBinDefaults_795=function handleBinDefaults(traceIn,traceOut,coerce,binDirections){return coerce("histnorm"),binDirections.forEach(function(binDirection){coerce(binDirection+"bins.start"),coerce(binDirection+"bins.end"),coerce(binDirection+"bins.size"),!1!==coerce("autobin"+binDirection)&&coerce("nbins"+binDirection)}),traceOut},_$eventData_801=function eventData(out,pt,trace,cd,pointNumber){if(out.x="xVal"in pt?pt.xVal:pt.x,out.y="yVal"in pt?pt.yVal:pt.y,pt.xa&&(out.xaxis=pt.xa),pt.ya&&(out.yaxis=pt.ya),!(trace.cumulative||{}).enabled){var pointIndices,pts=Array.isArray(pointNumber)?cd[0].pts[pointNumber[0]][pointNumber[1]]:cd[pointNumber].pts;if(out.pointNumbers=pts,out.binNumber=out.pointNumber,delete out.pointNumber,delete out.pointIndex,trace._indexToPoints){pointIndices=[];for(var i=0;i<pts.length;i++)pointIndices=pointIndices.concat(trace._indexToPoints[pts[i]])}else pointIndices=pts;out.pointIndices=pointIndices}return out},hoverLabelText=_$axes_584.hoverLabelText,Histogram={};Histogram.attributes=_$attributes_793,Histogram.layoutAttributes=_$layout_attributes_683,Histogram.supplyDefaults=function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_793,attr,dflt)}var x=coerce("x"),y=coerce("y");coerce("cumulative.enabled")&&(coerce("cumulative.direction"),coerce("cumulative.currentbin")),coerce("text");var orientation=coerce("orientation",y&&!x?"h":"v"),sample=traceOut["v"===orientation?"x":"y"];if(sample&&sample.length){_$registry_668.getComponentMethod("calendars","handleTraceDefaults")(traceIn,traceOut,["x","y"],layout),traceOut["h"===orientation?"x":"y"]&&coerce("histfunc"),_$handleBinDefaults_795(0,traceOut,coerce,"h"===orientation?["y"]:["x"]),_$handleStyleDefaults_690(traceIn,traceOut,coerce,defaultColor,layout);var errorBarsSupplyDefaults=_$registry_668.getComponentMethod("errorbars","supplyDefaults");errorBarsSupplyDefaults(traceIn,traceOut,_$color_411.defaultLine,{axis:"y"}),errorBarsSupplyDefaults(traceIn,traceOut,_$color_411.defaultLine,{axis:"x",inherit:"y"}),_$lib_539.coerceSelectionMarkerOpacity(traceOut,coerce)}else traceOut.visible=!1},Histogram.supplyLayoutDefaults=_$layout_defaults_684,Histogram.calc=function calc(gd,trace){if(!0===trace.visible){var i,pos=[],size=[],pa=_$axes_584.getFromId(gd,"h"===trace.orientation?trace.yaxis||"y":trace.xaxis||"x"),mainData="h"===trace.orientation?"y":"x",counterData={x:"y",y:"x"}[mainData],calendar=trace[mainData+"calendar"],cumulativeSpec=trace.cumulative;_$cleanBins_799(trace,pa,mainData);var i2,binEnd,n,binsAndPos=calcAllAutoBins(gd,trace,pa,mainData),binSpec=binsAndPos[0],pos0=binsAndPos[1],nonuniformBins="string"==typeof binSpec.size,binEdges=[],bins=nonuniformBins?binEdges:binSpec,inc=[],counts=[],inputPoints=[],total=0,norm=trace.histnorm,func=trace.histfunc,densityNorm=-1!==norm.indexOf("density");cumulativeSpec.enabled&&densityNorm&&(norm=norm.replace(/ ?density$/,""),densityNorm=!1);var rawCounterData,sizeInit="max"===func||"min"===func?null:0,binFunc=_$bin_functions_796.count,normFunc=_$norm_functions_804[norm],isAvg=!1,pr2c=function(v){return pa.r2c(v,0,calendar)};for(_$lib_539.isArrayOrTypedArray(trace[counterData])&&"count"!==func&&(rawCounterData=trace[counterData],isAvg="avg"===func,binFunc=_$bin_functions_796[func]),i=pr2c(binSpec.start),binEnd=pr2c(binSpec.end)+(i-_$axes_584.tickIncrement(i,binSpec.size,!1,calendar))/1e6;i<binEnd&&pos.length<1e6&&(i2=_$axes_584.tickIncrement(i,binSpec.size,!1,calendar),pos.push((i+i2)/2),size.push(sizeInit),inputPoints.push([]),binEdges.push(i),densityNorm&&inc.push(1/(i2-i)),isAvg&&counts.push(0),!(i2<=i));)i=i2;binEdges.push(i),nonuniformBins||"date"!==pa.type||(bins={start:pr2c(bins.start),end:pr2c(bins.end),size:bins.size});var roundFn,nMax=size.length,uniqueValsPerBin=!0,leftGap=1/0,rightGap=1/0,ptNumber2cdIndex={};for(i=0;i<pos0.length;i++){var posi=pos0[i];(n=_$lib_539.findBin(posi,bins))>=0&&n<nMax&&(total+=binFunc(n,i,size,rawCounterData,counts),uniqueValsPerBin&&inputPoints[n].length&&posi!==pos0[inputPoints[n][0]]&&(uniqueValsPerBin=!1),inputPoints[n].push(i),ptNumber2cdIndex[i]=n,leftGap=Math.min(leftGap,posi-binEdges[n]),rightGap=Math.min(rightGap,binEdges[n+1]-posi))}uniqueValsPerBin||(roundFn=_$getBinSpanLabelRound_797(leftGap,rightGap,binEdges,pa,calendar)),isAvg&&(total=_$doAvg_794(size,counts)),normFunc&&normFunc(size,total,inc),cumulativeSpec.enabled&&function cdf(size,direction,currentBin){var i,vi,prevSum;function firstHalfPoint(i){prevSum=size[i],size[i]/=2}function nextHalfPoint(i){vi=size[i],size[i]=prevSum+vi/2,prevSum+=vi}if("half"===currentBin)if("increasing"===direction)for(firstHalfPoint(0),i=1;i<size.length;i++)nextHalfPoint(i);else for(firstHalfPoint(size.length-1),i=size.length-2;i>=0;i--)nextHalfPoint(i);else if("increasing"===direction){for(i=1;i<size.length;i++)size[i]+=size[i-1];"exclude"===currentBin&&(size.unshift(0),size.pop())}else{for(i=size.length-2;i>=0;i--)size[i]+=size[i+1];"exclude"===currentBin&&(size.push(0),size.shift())}}(size,cumulativeSpec.direction,cumulativeSpec.currentbin);var seriesLen=Math.min(pos.length,size.length),cd=[],firstNonzero=0,lastNonzero=seriesLen-1;for(i=0;i<seriesLen;i++)if(size[i]){firstNonzero=i;break}for(i=seriesLen-1;i>=firstNonzero;i--)if(size[i]){lastNonzero=i;break}for(i=firstNonzero;i<=lastNonzero;i++)if(_$fastIsnumeric_139(pos[i])&&_$fastIsnumeric_139(size[i])){var cdi={p:pos[i],s:size[i],b:0};cumulativeSpec.enabled||(cdi.pts=inputPoints[i],uniqueValsPerBin?cdi.p0=cdi.p1=inputPoints[i].length?pos0[inputPoints[i][0]]:pos[i]:(cdi.p0=roundFn(binEdges[i]),cdi.p1=roundFn(binEdges[i+1],!0))),cd.push(cdi)}return 1===cd.length&&(cd[0].width1=_$axes_584.tickIncrement(cd[0].p,binSpec.size,!1,calendar)-cd[0].p),_$arraysToCalcdata_677(cd,trace),_$lib_539.isArrayOrTypedArray(trace.selectedpoints)&&_$lib_539.tagSelected(cd,trace,ptNumber2cdIndex),cd}},Histogram.setPositions=_$setPositions_687,Histogram.plot=_$plot_685,Histogram.style=_$style_689,Histogram.colorbar=_$colorbar_866,Histogram.hoverPoints=function hoverPoints(pointData,xval,yval,hovermode){var pts=_$hoverPoints_681(pointData,xval,yval,hovermode);if(pts){var di=(pointData=pts[0]).cd[pointData.index],trace=pointData.cd[0].trace;if(!trace.cumulative.enabled){var posLetter="h"===trace.orientation?"y":"x";pointData[posLetter+"Label"]=hoverLabelText(pointData[posLetter+"a"],di.p0,di.p1)}return pts}},Histogram.selectPoints=_$selectPoints_686,Histogram.eventData=_$eventData_801,Histogram.moduleType="trace",Histogram.name="histogram",Histogram.basePlotModule=_$cartesian_595,Histogram.categories=["cartesian","bar","histogram","oriented","errorBarsOK","showLegend"],Histogram.meta={};var _$histogram_17=Histogram,__extendFlat_805=_$extend_528.extendFlat,_$attributes_805=__extendFlat_805({},{x:_$attributes_793.x,y:_$attributes_793.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:_$attributes_793.histnorm,histfunc:_$attributes_793.histfunc,autobinx:_$attributes_793.autobinx,nbinsx:_$attributes_793.nbinsx,xbins:_$attributes_793.xbins,autobiny:_$attributes_793.autobiny,nbinsy:_$attributes_793.nbinsy,ybins:_$attributes_793.ybins,xgap:_$attributes_773.xgap,ygap:_$attributes_773.ygap,zsmooth:_$attributes_773.zsmooth,zhoverformat:_$attributes_773.zhoverformat},_$attributes_417,{autocolorscale:__extendFlat_805({},_$attributes_417.autocolorscale,{dflt:!1})},{colorbar:_$attributes_412}),_$handleSampleDefaults_810=function handleSampleDefaults(traceIn,traceOut,coerce,layout){var x=coerce("x"),y=coerce("y");if(x&&x.length&&y&&y.length){_$registry_668.getComponentMethod("calendars","handleTraceDefaults")(traceIn,traceOut,["x","y"],layout),(coerce("z")||coerce("marker.color"))&&coerce("histfunc");_$handleBinDefaults_795(0,traceOut,coerce,["x","y"])}else traceOut.visible=!1},__hoverLabelText_808=_$axes_584.hoverLabelText,Histogram2D={};Histogram2D.attributes=_$attributes_805,Histogram2D.supplyDefaults=function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_805,attr,dflt)}_$handleSampleDefaults_810(traceIn,traceOut,coerce,layout),!1!==traceOut.visible&&(_$handleStyleDefaults_788(0,0,coerce),_$colorScaleDefaults_421(traceIn,traceOut,layout,coerce,{prefix:"",cLetter:"z"}))},Histogram2D.calc=_$calc_774,Histogram2D.plot=_$plot_786,Histogram2D.colorbar=_$colorbar_776,Histogram2D.style=_$style_787,Histogram2D.hoverPoints=function hoverPoints(pointData,xval,yval,hovermode,hoverLayer,contour){var pts=_$hoverPoints_781(pointData,xval,yval,0,0,contour);if(pts){var indices=(pointData=pts[0]).index,ny=indices[0],nx=indices[1],cd0=pointData.cd[0],xRange=cd0.xRanges[nx],yRange=cd0.yRanges[ny];return pointData.xLabel=__hoverLabelText_808(pointData.xa,xRange[0],xRange[1]),pointData.yLabel=__hoverLabelText_808(pointData.ya,yRange[0],yRange[1]),pts}},Histogram2D.eventData=_$eventData_801,Histogram2D.moduleType="trace",Histogram2D.name="histogram2d",Histogram2D.basePlotModule=_$cartesian_595,Histogram2D.categories=["cartesian","2dMap","histogram"],Histogram2D.meta={};var _$histogram2d_18=Histogram2D,__extendFlat_811=_$extend_528.extendFlat,_$attributes_811=__extendFlat_811({x:_$attributes_805.x,y:_$attributes_805.y,z:_$attributes_805.z,marker:_$attributes_805.marker,histnorm:_$attributes_805.histnorm,histfunc:_$attributes_805.histfunc,autobinx:_$attributes_805.autobinx,nbinsx:_$attributes_805.nbinsx,xbins:_$attributes_805.xbins,autobiny:_$attributes_805.autobiny,nbinsy:_$attributes_805.nbinsy,ybins:_$attributes_805.ybins,autocontour:_$attributes_744.autocontour,ncontours:_$attributes_744.ncontours,contours:_$attributes_744.contours,line:_$attributes_744.line,zhoverformat:_$attributes_805.zhoverformat},_$attributes_417,{zmin:__extendFlat_811({},_$attributes_417.zmin,{editType:"calc"}),zmax:__extendFlat_811({},_$attributes_417.zmax,{editType:"calc"})},{colorbar:_$attributes_412}),Histogram2dContour={};Histogram2dContour.attributes=_$attributes_811,Histogram2dContour.supplyDefaults=function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_811,attr,dflt)}_$handleSampleDefaults_810(traceIn,traceOut,coerce,layout),!1!==traceOut.visible&&(_$handleContourDefaults_751(0,traceOut,coerce,function coerce2(attr){return _$lib_539.coerce2(traceIn,traceOut,_$attributes_811,attr)}),_$handleStyleDefaults_765(traceIn,traceOut,coerce,layout))},Histogram2dContour.calc=_$calc_745,Histogram2dContour.plot=_$plot_762.plot,Histogram2dContour.style=_$style_764,Histogram2dContour.colorbar=_$colorbar_747,Histogram2dContour.hoverPoints=_$hoverPoints_757,Histogram2dContour.moduleType="trace",Histogram2dContour.name="histogram2dcontour",Histogram2dContour.basePlotModule=_$cartesian_595,Histogram2dContour.categories=["cartesian","2dMap","contour","histogram"],Histogram2dContour.meta={};var _$histogram2dcontour_19=Histogram2dContour,__extendFlat_629=_$extend_528.extendFlat,_$axis_attributes_629=(0,_$edit_types_569.overrideAll)({visible:_$layout_attributes_596.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:_$color_411.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:_$layout_attributes_596.color,categoryorder:_$layout_attributes_596.categoryorder,categoryarray:_$layout_attributes_596.categoryarray,title:_$layout_attributes_596.title,titlefont:_$layout_attributes_596.titlefont,type:_$layout_attributes_596.type,autorange:_$layout_attributes_596.autorange,rangemode:_$layout_attributes_596.rangemode,range:_$layout_attributes_596.range,tickmode:_$layout_attributes_596.tickmode,nticks:_$layout_attributes_596.nticks,tick0:_$layout_attributes_596.tick0,dtick:_$layout_attributes_596.dtick,tickvals:_$layout_attributes_596.tickvals,ticktext:_$layout_attributes_596.ticktext,ticks:_$layout_attributes_596.ticks,mirror:_$layout_attributes_596.mirror,ticklen:_$layout_attributes_596.ticklen,tickwidth:_$layout_attributes_596.tickwidth,tickcolor:_$layout_attributes_596.tickcolor,showticklabels:_$layout_attributes_596.showticklabels,tickfont:_$layout_attributes_596.tickfont,tickangle:_$layout_attributes_596.tickangle,tickprefix:_$layout_attributes_596.tickprefix,showtickprefix:_$layout_attributes_596.showtickprefix,ticksuffix:_$layout_attributes_596.ticksuffix,showticksuffix:_$layout_attributes_596.showticksuffix,showexponent:_$layout_attributes_596.showexponent,exponentformat:_$layout_attributes_596.exponentformat,separatethousands:_$layout_attributes_596.separatethousands,tickformat:_$layout_attributes_596.tickformat,tickformatstops:_$layout_attributes_596.tickformatstops,hoverformat:_$layout_attributes_596.hoverformat,showline:_$layout_attributes_596.showline,linecolor:_$layout_attributes_596.linecolor,linewidth:_$layout_attributes_596.linewidth,showgrid:_$layout_attributes_596.showgrid,gridcolor:__extendFlat_629({},_$layout_attributes_596.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:_$layout_attributes_596.gridwidth,zeroline:_$layout_attributes_596.zeroline,zerolinecolor:_$layout_attributes_596.zerolinecolor,zerolinewidth:_$layout_attributes_596.zerolinewidth},"plot","from-root"),__colorMix_630=_$tinycolor_352.mix,__axesNames_630=["xaxis","yaxis","zaxis"],_$supplyLayoutDefaults_630=function supplyLayoutDefaults(layoutIn,layoutOut,options){var containerIn,containerOut;function coerce(attr,dflt){return _$lib_539.coerce(containerIn,containerOut,_$axis_attributes_629,attr,dflt)}for(var j=0;j<__axesNames_630.length;j++){var axName=__axesNames_630[j];containerIn=layoutIn[axName]||{},containerOut=layoutOut[axName]={_id:axName[0]+options.scene,_name:axName},_$handleTypeDefaults_608(containerIn,containerOut,coerce,options.data),_$handleAxisDefaults_586(containerIn,containerOut,coerce,{font:options.font,letter:axName[0],data:options.data,showGrid:!0,bgColor:options.bgColor,calendar:options.calendar},options.fullLayout),coerce("gridcolor",__colorMix_630(containerOut.color,options.bgColor,13600/187).toRgbString()),coerce("title",axName[0]),containerOut.setScale=_$lib_539.noop,coerce("showspikes")&&(coerce("spikesides"),coerce("spikethickness"),coerce("spikecolor",containerOut.color)),coerce("showaxeslabels"),coerce("showbackground")&&coerce("backgroundcolor")}},__domainAttrs_633=_$domain_610.attributes,__extendFlat_633=_$extend_528.extendFlat;function makeCameraVector(x,y,z){return{x:{valType:"number",dflt:x,editType:"camera"},y:{valType:"number",dflt:y,editType:"camera"},z:{valType:"number",dflt:z,editType:"camera"},editType:"camera"}}var _$layout_attributes_633={_arrayAttrRegexps:[(0,_$lib_539.counterRegex)("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:__extendFlat_633(makeCameraVector(0,0,1),{}),center:__extendFlat_633(makeCameraVector(0,0,0),{}),eye:__extendFlat_633(makeCameraVector(1.25,1.25,1.25),{}),editType:"camera"},domain:__domainAttrs_633({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:_$axis_attributes_629,yaxis:_$axis_attributes_629,zaxis:_$axis_attributes_629,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],dflt:"turntable",editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}};function handleGl3dDefaults(sceneLayoutIn,sceneLayoutOut,coerce,opts){for(var bgcolor=coerce("bgcolor"),bgColorCombined=_$color_411.combine(bgcolor,opts.paper_bgcolor),cameraKeys=["up","center","eye"],j=0;j<cameraKeys.length;j++)coerce("camera."+cameraKeys[j]+".x"),coerce("camera."+cameraKeys[j]+".y"),coerce("camera."+cameraKeys[j]+".z");var hasAspect=!!coerce("aspectratio.x")&&!!coerce("aspectratio.y")&&!!coerce("aspectratio.z"),aspectMode=coerce("aspectmode",hasAspect?"manual":"auto");hasAspect||(sceneLayoutIn.aspectratio=sceneLayoutOut.aspectratio={x:1,y:1,z:1},"manual"===aspectMode&&(sceneLayoutOut.aspectmode="auto"),sceneLayoutIn.aspectmode=sceneLayoutOut.aspectmode),_$supplyLayoutDefaults_630(sceneLayoutIn,sceneLayoutOut,{font:opts.font,scene:opts.id,data:opts.fullData,bgColor:bgColorCombined,calendar:opts.calendar,fullLayout:opts.fullLayout}),_$registry_668.getComponentMethod("annotations3d","handleDefaults")(sceneLayoutIn,sceneLayoutOut,opts),coerce("dragmode",opts.getDfltFromLayout("dragmode")),coerce("hovermode",opts.getDfltFromLayout("hovermode"))}var _$invert_173=function invert(out,a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b00=a00*a11-a01*a10,b01=a00*a12-a02*a10,b02=a00*a13-a03*a10,b03=a01*a12-a02*a11,b04=a01*a13-a03*a11,b05=a02*a13-a03*a12,b06=a20*a31-a21*a30,b07=a20*a32-a22*a30,b08=a20*a33-a23*a30,b09=a21*a32-a22*a31,b10=a21*a33-a23*a31,b11=a22*a33-a23*a32,det=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;if(!det)return null;return det=1/det,out[0]=(a11*b11-a12*b10+a13*b09)*det,out[1]=(a02*b10-a01*b11-a03*b09)*det,out[2]=(a31*b05-a32*b04+a33*b03)*det,out[3]=(a22*b04-a21*b05-a23*b03)*det,out[4]=(a12*b08-a10*b11-a13*b07)*det,out[5]=(a00*b11-a02*b08+a03*b07)*det,out[6]=(a32*b02-a30*b05-a33*b01)*det,out[7]=(a20*b05-a22*b02+a23*b01)*det,out[8]=(a10*b10-a11*b08+a13*b06)*det,out[9]=(a01*b08-a00*b10-a03*b06)*det,out[10]=(a30*b04-a31*b02+a33*b00)*det,out[11]=(a21*b02-a20*b04-a23*b00)*det,out[12]=(a11*b07-a10*b09-a12*b06)*det,out[13]=(a00*b09-a01*b07+a02*b06)*det,out[14]=(a31*b01-a30*b03-a32*b00)*det,out[15]=(a20*b03-a21*b01+a22*b00)*det,out};var _$identity_172=function __identity_172(out){return out[0]=1,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=1,out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[10]=1,out[11]=0,out[12]=0,out[13]=0,out[14]=0,out[15]=1,out};var _$lookAt_174=function lookAt(out,eye,center,up){var x0,x1,x2,y0,y1,y2,z0,z1,z2,len,eyex=eye[0],eyey=eye[1],eyez=eye[2],upx=up[0],upy=up[1],upz=up[2],centerx=center[0],centery=center[1],centerz=center[2];if(Math.abs(eyex-centerx)<1e-6&&Math.abs(eyey-centery)<1e-6&&Math.abs(eyez-centerz)<1e-6)return _$identity_172(out);z0=eyex-centerx,z1=eyey-centery,z2=eyez-centerz,len=1/Math.sqrt(z0*z0+z1*z1+z2*z2),x0=upy*(z2*=len)-upz*(z1*=len),x1=upz*(z0*=len)-upx*z2,x2=upx*z1-upy*z0,(len=Math.sqrt(x0*x0+x1*x1+x2*x2))?(x0*=len=1/len,x1*=len,x2*=len):(x0=0,x1=0,x2=0);y0=z1*x2-z2*x1,y1=z2*x0-z0*x2,y2=z0*x1-z1*x0,(len=Math.sqrt(y0*y0+y1*y1+y2*y2))?(y0*=len=1/len,y1*=len,y2*=len):(y0=0,y1=0,y2=0);return out[0]=x0,out[1]=y0,out[2]=z0,out[3]=0,out[4]=x1,out[5]=y1,out[6]=z1,out[7]=0,out[8]=x2,out[9]=y2,out[10]=z2,out[11]=0,out[12]=-(x0*eyex+x1*eyey+x2*eyez),out[13]=-(y0*eyex+y1*eyey+y2*eyez),out[14]=-(z0*eyex+z1*eyey+z2*eyez),out[15]=1,out};var _$rotateX_178=function rotateX(out,a,rad){var s=Math.sin(rad),c=Math.cos(rad),a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11];a!==out&&(out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15]);return out[4]=a10*c+a20*s,out[5]=a11*c+a21*s,out[6]=a12*c+a22*s,out[7]=a13*c+a23*s,out[8]=a20*c-a10*s,out[9]=a21*c-a11*s,out[10]=a22*c-a12*s,out[11]=a23*c-a13*s,out};var _$rotateY_179=function rotateY(out,a,rad){var s=Math.sin(rad),c=Math.cos(rad),a00=a[0],a01=a[1],a02=a[2],a03=a[3],a20=a[8],a21=a[9],a22=a[10],a23=a[11];a!==out&&(out[4]=a[4],out[5]=a[5],out[6]=a[6],out[7]=a[7],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15]);return out[0]=a00*c-a20*s,out[1]=a01*c-a21*s,out[2]=a02*c-a22*s,out[3]=a03*c-a23*s,out[8]=a00*s+a20*c,out[9]=a01*s+a21*c,out[10]=a02*s+a22*c,out[11]=a03*s+a23*c,out};var _$rotateZ_180=function rotateZ(out,a,rad){var s=Math.sin(rad),c=Math.cos(rad),a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7];a!==out&&(out[8]=a[8],out[9]=a[9],out[10]=a[10],out[11]=a[11],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15]);return out[0]=a00*c+a10*s,out[1]=a01*c+a11*s,out[2]=a02*c+a12*s,out[3]=a03*c+a13*s,out[4]=a10*c-a00*s,out[5]=a11*c-a01*s,out[6]=a12*c-a02*s,out[7]=a13*c-a03*s,out};var _$scale_181=function scale(out,a,v){var x=v[0],y=v[1],z=v[2];return out[0]=a[0]*x,out[1]=a[1]*x,out[2]=a[2]*x,out[3]=a[3]*x,out[4]=a[4]*y,out[5]=a[5]*y,out[6]=a[6]*y,out[7]=a[7]*y,out[8]=a[8]*z,out[9]=a[9]*z,out[10]=a[10]*z,out[11]=a[11]*z,out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15],out};var _$translate_182=function translate(out,a,v){var a00,a01,a02,a03,a10,a11,a12,a13,a20,a21,a22,a23,x=v[0],y=v[1],z=v[2];a===out?(out[12]=a[0]*x+a[4]*y+a[8]*z+a[12],out[13]=a[1]*x+a[5]*y+a[9]*z+a[13],out[14]=a[2]*x+a[6]*y+a[10]*z+a[14],out[15]=a[3]*x+a[7]*y+a[11]*z+a[15]):(a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],out[0]=a00,out[1]=a01,out[2]=a02,out[3]=a03,out[4]=a10,out[5]=a11,out[6]=a12,out[7]=a13,out[8]=a20,out[9]=a21,out[10]=a22,out[11]=a23,out[12]=a00*x+a10*y+a20*z+a[12],out[13]=a01*x+a11*y+a21*z+a[13],out[14]=a02*x+a12*y+a22*z+a[14],out[15]=a03*x+a13*y+a23*z+a[15]);return out};var _$normalize_227=function __normalize_227(out,a){var x=a[0],y=a[1],z=a[2],len=x*x+y*y+z*z;len>0&&(len=1/Math.sqrt(len),out[0]=a[0]*len,out[1]=a[1]*len,out[2]=a[2]*len);return out};var _$determinant_169=function __determinant_169(a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15];return(a00*a11-a01*a10)*(a22*a33-a23*a32)-(a00*a12-a02*a10)*(a21*a33-a23*a31)+(a00*a13-a03*a10)*(a21*a32-a22*a31)+(a01*a12-a02*a11)*(a20*a33-a23*a30)-(a01*a13-a03*a11)*(a20*a32-a22*a30)+(a02*a13-a03*a12)*(a20*a31-a21*a30)};var _$lerp_226=function __lerp_226(out,a,b,t){var ax=a[0],ay=a[1],az=a[2];return out[0]=ax+t*(b[0]-ax),out[1]=ay+t*(b[1]-ay),out[2]=az+t*(b[2]-az),out};var _$clone_167=function clone(a){var out=new Float32Array(16);return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[4]=a[4],out[5]=a[5],out[6]=a[6],out[7]=a[7],out[8]=a[8],out[9]=a[9],out[10]=a[10],out[11]=a[11],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15],out};var _$create_168=function create(){var out=new Float32Array(16);return out[0]=1,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=1,out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[10]=1,out[11]=0,out[12]=0,out[13]=0,out[14]=0,out[15]=1,out};var _$transpose_183=function transpose(out,a){if(out===a){var a01=a[1],a02=a[2],a03=a[3],a12=a[6],a13=a[7],a23=a[11];out[1]=a[4],out[2]=a[8],out[3]=a[12],out[4]=a01,out[6]=a[9],out[7]=a[13],out[8]=a02,out[9]=a12,out[11]=a[14],out[12]=a03,out[13]=a13,out[14]=a23}else out[0]=a[0],out[1]=a[4],out[2]=a[8],out[3]=a[12],out[4]=a[1],out[5]=a[5],out[6]=a[9],out[7]=a[13],out[8]=a[2],out[9]=a[6],out[10]=a[10],out[11]=a[14],out[12]=a[3],out[13]=a[7],out[14]=a[11],out[15]=a[15];return out};var _$cross_223=function __cross_223(out,a,b){var ax=a[0],ay=a[1],az=a[2],bx=b[0],by=b[1],bz=b[2];return out[0]=ay*bz-az*by,out[1]=az*bx-ax*bz,out[2]=ax*by-ay*bx,out};var _$dot_224=function __dot_224(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};var vec3={length:function length(a){var x=a[0],y=a[1],z=a[2];return Math.sqrt(x*x+y*y+z*z)},normalize:_$normalize_227,dot:_$dot_224,cross:_$cross_223},tmp=_$create_168(),perspectiveMatrix=_$create_168(),tmpVec4=[0,0,0,0],row=[[0,0,0],[0,0,0],[0,0,0]],pdum3=[0,0,0],_$decomposeMat4_256=function decomposeMat4(matrix,translation,scale,skew,perspective,quaternion){if(translation||(translation=[0,0,0]),scale||(scale=[0,0,0]),skew||(skew=[0,0,0]),perspective||(perspective=[0,0,0,1]),quaternion||(quaternion=[0,0,0,1]),!function normalize(out,mat){var m44=mat[15];if(0===m44)return!1;for(var scale=1/m44,i=0;i<16;i++)out[i]=mat[i]*scale;return!0}(tmp,matrix))return!1;if(_$clone_167(perspectiveMatrix,tmp),perspectiveMatrix[3]=0,perspectiveMatrix[7]=0,perspectiveMatrix[11]=0,perspectiveMatrix[15]=1,Math.abs(_$determinant_169(perspectiveMatrix)<1e-8))return!1;var a03=tmp[3],a13=tmp[7],a23=tmp[11],a30=tmp[12],a31=tmp[13],a32=tmp[14],a33=tmp[15];if(0!==a03||0!==a13||0!==a23){if(tmpVec4[0]=a03,tmpVec4[1]=a13,tmpVec4[2]=a23,tmpVec4[3]=a33,!_$invert_173(perspectiveMatrix,perspectiveMatrix))return!1;_$transpose_183(perspectiveMatrix,perspectiveMatrix),function vec4multMat4(out,a,m){var x=a[0],y=a[1],z=a[2],w=a[3];return out[0]=m[0]*x+m[4]*y+m[8]*z+m[12]*w,out[1]=m[1]*x+m[5]*y+m[9]*z+m[13]*w,out[2]=m[2]*x+m[6]*y+m[10]*z+m[14]*w,out[3]=m[3]*x+m[7]*y+m[11]*z+m[15]*w,out}(perspective,tmpVec4,perspectiveMatrix)}else perspective[0]=perspective[1]=perspective[2]=0,perspective[3]=1;if(translation[0]=a30,translation[1]=a31,translation[2]=a32,function mat3from4(out,mat4x4){out[0][0]=mat4x4[0],out[0][1]=mat4x4[1],out[0][2]=mat4x4[2],out[1][0]=mat4x4[4],out[1][1]=mat4x4[5],out[1][2]=mat4x4[6],out[2][0]=mat4x4[8],out[2][1]=mat4x4[9],out[2][2]=mat4x4[10]}(row,tmp),scale[0]=vec3.length(row[0]),vec3.normalize(row[0],row[0]),skew[0]=vec3.dot(row[0],row[1]),combine(row[1],row[1],row[0],1,-skew[0]),scale[1]=vec3.length(row[1]),vec3.normalize(row[1],row[1]),skew[0]/=scale[1],skew[1]=vec3.dot(row[0],row[2]),combine(row[2],row[2],row[0],1,-skew[1]),skew[2]=vec3.dot(row[1],row[2]),combine(row[2],row[2],row[1],1,-skew[2]),scale[2]=vec3.length(row[2]),vec3.normalize(row[2],row[2]),skew[1]/=scale[2],skew[2]/=scale[2],vec3.cross(pdum3,row[1],row[2]),vec3.dot(row[0],pdum3)<0)for(var i=0;i<3;i++)scale[i]*=-1,row[i][0]*=-1,row[i][1]*=-1,row[i][2]*=-1;return quaternion[0]=.5*Math.sqrt(Math.max(1+row[0][0]-row[1][1]-row[2][2],0)),quaternion[1]=.5*Math.sqrt(Math.max(1-row[0][0]+row[1][1]-row[2][2],0)),quaternion[2]=.5*Math.sqrt(Math.max(1-row[0][0]-row[1][1]+row[2][2],0)),quaternion[3]=.5*Math.sqrt(Math.max(1+row[0][0]+row[1][1]+row[2][2],0)),row[2][1]>row[1][2]&&(quaternion[0]=-quaternion[0]),row[0][2]>row[2][0]&&(quaternion[1]=-quaternion[1]),row[1][0]>row[0][1]&&(quaternion[2]=-quaternion[2]),!0};function combine(out,a,b,scale1,scale2){out[0]=a[0]*scale1+b[0]*scale2,out[1]=a[1]*scale1+b[1]*scale2,out[2]=a[2]*scale1+b[2]*scale2}var _$multiply_175=function __multiply_175(out,a,b){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b0=b[0],b1=b[1],b2=b[2],b3=b[3];return out[0]=b0*a00+b1*a10+b2*a20+b3*a30,out[1]=b0*a01+b1*a11+b2*a21+b3*a31,out[2]=b0*a02+b1*a12+b2*a22+b3*a32,out[3]=b0*a03+b1*a13+b2*a23+b3*a33,b0=b[4],b1=b[5],b2=b[6],b3=b[7],out[4]=b0*a00+b1*a10+b2*a20+b3*a30,out[5]=b0*a01+b1*a11+b2*a21+b3*a31,out[6]=b0*a02+b1*a12+b2*a22+b3*a32,out[7]=b0*a03+b1*a13+b2*a23+b3*a33,b0=b[8],b1=b[9],b2=b[10],b3=b[11],out[8]=b0*a00+b1*a10+b2*a20+b3*a30,out[9]=b0*a01+b1*a11+b2*a21+b3*a31,out[10]=b0*a02+b1*a12+b2*a22+b3*a32,out[11]=b0*a03+b1*a13+b2*a23+b3*a33,b0=b[12],b1=b[13],b2=b[14],b3=b[15],out[12]=b0*a00+b1*a10+b2*a20+b3*a30,out[13]=b0*a01+b1*a11+b2*a21+b3*a31,out[14]=b0*a02+b1*a12+b2*a22+b3*a32,out[15]=b0*a03+b1*a13+b2*a23+b3*a33,out};var mat4={identity:_$identity_172,translate:_$translate_182,multiply:_$multiply_175,create:_$create_168,scale:_$scale_181,fromRotationTranslation:function fromRotationTranslation(out,q,v){var x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,xy=x*y2,xz=x*z2,yy=y*y2,yz=y*z2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2;return out[0]=1-(yy+zz),out[1]=xy+wz,out[2]=xz-wy,out[3]=0,out[4]=xy-wz,out[5]=1-(xx+zz),out[6]=yz+wx,out[7]=0,out[8]=xz+wy,out[9]=yz-wx,out[10]=1-(xx+yy),out[11]=0,out[12]=v[0],out[13]=v[1],out[14]=v[2],out[15]=1,out}},temp=(mat4.create(),mat4.create()),_$recomposeMat4_259=function recomposeMat4(matrix,translation,scale,skew,perspective,quaternion){return mat4.identity(matrix),mat4.fromRotationTranslation(matrix,quaternion,translation),matrix[3]=perspective[0],matrix[7]=perspective[1],matrix[11]=perspective[2],matrix[15]=perspective[3],mat4.identity(temp),0!==skew[2]&&(temp[9]=skew[2],mat4.multiply(matrix,matrix,temp)),0!==skew[1]&&(temp[9]=0,temp[8]=skew[1],mat4.multiply(matrix,matrix,temp)),0!==skew[0]&&(temp[8]=0,temp[4]=skew[0],mat4.multiply(matrix,matrix,temp)),mat4.scale(matrix,matrix,scale),matrix};var _$quatSlerp_305=function slerp(out,a,b,t){var omega,cosom,sinom,scale0,scale1,ax=a[0],ay=a[1],az=a[2],aw=a[3],bx=b[0],by=b[1],bz=b[2],bw=b[3];(cosom=ax*bx+ay*by+az*bz+aw*bw)<0&&(cosom=-cosom,bx=-bx,by=-by,bz=-bz,bw=-bw);1-cosom>1e-6?(omega=Math.acos(cosom),sinom=Math.sin(omega),scale0=Math.sin((1-t)*omega)/sinom,scale1=Math.sin(t*omega)/sinom):(scale0=1-t,scale1=t);return out[0]=scale0*ax+scale1*bx,out[1]=scale0*ay+scale1*by,out[2]=scale0*az+scale1*bz,out[3]=scale0*aw+scale1*bw,out},state0=state(),state1=state(),__tmp_258=state(),_$interpolate_258=function interpolate(out,start,end,alpha){if(0===_$determinant_169(start)||0===_$determinant_169(end))return!1;var r0=_$decomposeMat4_256(start,state0.translate,state0.scale,state0.skew,state0.perspective,state0.quaternion),r1=_$decomposeMat4_256(end,state1.translate,state1.scale,state1.skew,state1.perspective,state1.quaternion);return!(!r0||!r1||(_$lerp_226(__tmp_258.translate,state0.translate,state1.translate,alpha),_$lerp_226(__tmp_258.skew,state0.skew,state1.skew,alpha),_$lerp_226(__tmp_258.scale,state0.scale,state1.scale,alpha),_$lerp_226(__tmp_258.perspective,state0.perspective,state1.perspective,alpha),_$quatSlerp_305(__tmp_258.quaternion,state0.quaternion,state1.quaternion,alpha),_$recomposeMat4_259(out,__tmp_258.translate,__tmp_258.scale,__tmp_258.skew,__tmp_258.perspective,__tmp_258.quaternion),0))};function state(){return{translate:__vec3_258(),scale:__vec3_258(1),skew:__vec3_258(),perspective:[0,0,0,1],quaternion:[0,0,0,1]}}function __vec3_258(n){return[n||0,n||0,n||0]}var DEFAULT_CENTER=[0,0,0],_$createMatrixCameraController_260=function createMatrixCameraController(options){return new MatrixCameraController((options=options||{}).matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};function MatrixCameraController(initialMatrix){this._components=initialMatrix.slice(),this._time=[0],this.prevMatrix=initialMatrix.slice(),this.nextMatrix=initialMatrix.slice(),this.computedMatrix=initialMatrix.slice(),this.computedInverse=initialMatrix.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}var __proto_260=MatrixCameraController.prototype;__proto_260.recalcMatrix=function(t){var time=this._time,tidx=_$searchBounds_71.le(time,t),mat=this.computedMatrix;if(!(tidx<0)){var comps=this._components;if(tidx===time.length-1)for(var ptr=16*tidx,i=0;i<16;++i)mat[i]=comps[ptr++];else{var dt=time[tidx+1]-time[tidx],prev=(ptr=16*tidx,this.prevMatrix),allEqual=!0;for(i=0;i<16;++i)prev[i]=comps[ptr++];var next=this.nextMatrix;for(i=0;i<16;++i)next[i]=comps[ptr++],allEqual=allEqual&&prev[i]===next[i];if(dt<1e-6||allEqual)for(i=0;i<16;++i)mat[i]=prev[i];else _$interpolate_258(mat,prev,next,(t-time[tidx])/dt)}var up=this.computedUp;up[0]=mat[1],up[1]=mat[5],up[2]=mat[9],_$normalize_227(up,up);var imat=this.computedInverse;_$invert_173(imat,mat);var eye=this.computedEye,w=imat[15];eye[0]=imat[12]/w,eye[1]=imat[13]/w,eye[2]=imat[14]/w;var center=this.computedCenter,radius=Math.exp(this.computedRadius[0]);for(i=0;i<3;++i)center[i]=eye[i]-mat[2+4*i]*radius}},__proto_260.idle=function(t){if(!(t<this.lastT())){for(var mc=this._components,ptr=mc.length-16,i=0;i<16;++i)mc.push(mc[ptr++]);this._time.push(t)}},__proto_260.flush=function(t){var idx=_$searchBounds_71.gt(this._time,t)-2;idx<0||(this._time.splice(0,idx),this._components.splice(0,16*idx))},__proto_260.lastT=function(){return this._time[this._time.length-1]},__proto_260.lookAt=function(t,eye,center,up){this.recalcMatrix(t),eye=eye||this.computedEye,center=center||DEFAULT_CENTER,up=up||this.computedUp,this.setMatrix(t,_$lookAt_174(this.computedMatrix,eye,center,up));for(var d2=0,i=0;i<3;++i)d2+=Math.pow(center[i]-eye[i],2);d2=Math.log(Math.sqrt(d2)),this.computedRadius[0]=d2},__proto_260.rotate=function(t,yaw,pitch,roll){this.recalcMatrix(t);var mat=this.computedInverse;yaw&&_$rotateY_179(mat,mat,yaw),pitch&&_$rotateX_178(mat,mat,pitch),roll&&_$rotateZ_180(mat,mat,roll),this.setMatrix(t,_$invert_173(this.computedMatrix,mat))};var tvec=[0,0,0];__proto_260.pan=function(t,dx,dy,dz){tvec[0]=-(dx||0),tvec[1]=-(dy||0),tvec[2]=-(dz||0),this.recalcMatrix(t);var mat=this.computedInverse;_$translate_182(mat,mat,tvec),this.setMatrix(t,_$invert_173(mat,mat))},__proto_260.translate=function(t,dx,dy,dz){tvec[0]=dx||0,tvec[1]=dy||0,tvec[2]=dz||0,this.recalcMatrix(t);var mat=this.computedMatrix;_$translate_182(mat,mat,tvec),this.setMatrix(t,mat)},__proto_260.setMatrix=function(t,mat){if(!(t<this.lastT())){this._time.push(t);for(var i=0;i<16;++i)this._components.push(mat[i])}},__proto_260.setDistance=function(t,d){this.computedRadius[0]=d},__proto_260.setDistanceLimits=function(a,b){var lim=this._limits;lim[0]=a,lim[1]=b},__proto_260.getDistanceLimits=function(out){var lim=this._limits;return out?(out[0]=lim[0],out[1]=lim[1],out):lim};var _$hermite_114={};(_$hermite_114=function cubicHermite(p0,v0,p1,v1,t,f){var ti=t-1,t2=t*t,ti2=ti*ti,h00=(1+2*t)*ti2,h10=t*ti2,h01=t2*(3-2*t),h11=t2*ti;if(p0.length){f||(f=new Array(p0.length));for(var i=p0.length-1;i>=0;--i)f[i]=h00*p0[i]+h10*v0[i]+h01*p1[i]+h11*v1[i];return f}return h00*p0+h10*v0+h01*p1+h11*v1}).derivative=function dcubicHermite(p0,v0,p1,v1,t,f){var dh00=6*t*t-6*t,dh10=3*t*t-4*t+1,dh01=-6*t*t+6*t,dh11=3*t*t-2*t;if(p0.length){f||(f=new Array(p0.length));for(var i=p0.length-1;i>=0;--i)f[i]=dh00*p0[i]+dh10*v0[i]+dh01*p1[i]+dh11*v1[i];return f}return dh00*p0+dh10*v0+dh01*p1[i]+dh11*v1};var _$createFilteredVector_140=function createFilteredVector(initState,initVelocity,initTime){switch(arguments.length){case 0:return new FilteredVector([0],[0],0);case 1:if("number"==typeof initState){var zero=getZero(initState);return new FilteredVector(zero,zero,0)}return new FilteredVector(initState,getZero(initState.length),0);case 2:if("number"==typeof initVelocity){var zero=getZero(initState.length);return new FilteredVector(initState,zero,+initVelocity)}initTime=0;case 3:if(initState.length!==initVelocity.length)throw new Error("state and velocity lengths must match");return new FilteredVector(initState,initVelocity,initTime)}};function __clamp_140(lo,hi,x){return Math.min(hi,Math.max(lo,x))}function FilteredVector(state0,velocity0,t0){this.dimension=state0.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var i=0;i<this.dimension;++i)this.bounds[0][i]=-1/0,this.bounds[1][i]=1/0;this._state=state0.slice().reverse(),this._velocity=velocity0.slice().reverse(),this._time=[t0],this._scratch=[state0.slice(),state0.slice(),state0.slice(),state0.slice(),state0.slice()]}var __proto_140=FilteredVector.prototype;function getZero(d){for(var result=new Array(d),i=0;i<d;++i)result[i]=0;return result}__proto_140.flush=function(t){var idx=_$searchBounds_71.gt(this._time,t)-1;idx<=0||(this._time.splice(0,idx),this._state.splice(0,idx*this.dimension),this._velocity.splice(0,idx*this.dimension))},__proto_140.curve=function(t){var time=this._time,n=time.length,idx=_$searchBounds_71.le(time,t),result=this._scratch[0],state=this._state,velocity=this._velocity,d=this.dimension,bounds=this.bounds;if(idx<0)for(var ptr=d-1,i=0;i<d;++i,--ptr)result[i]=state[ptr];else if(idx>=n-1){ptr=state.length-1;var tf=t-time[n-1];for(i=0;i<d;++i,--ptr)result[i]=state[ptr]+tf*velocity[ptr]}else{ptr=d*(idx+1)-1;var t0=time[idx],dt=time[idx+1]-t0||1,x0=this._scratch[1],x1=this._scratch[2],v0=this._scratch[3],v1=this._scratch[4],steady=!0;for(i=0;i<d;++i,--ptr)x0[i]=state[ptr],v0[i]=velocity[ptr]*dt,x1[i]=state[ptr+d],v1[i]=velocity[ptr+d]*dt,steady=steady&&x0[i]===x1[i]&&v0[i]===v1[i]&&0===v0[i];if(steady)for(i=0;i<d;++i)result[i]=x0[i];else _$hermite_114(x0,v0,x1,v1,(t-t0)/dt,result)}var lo=bounds[0],hi=bounds[1];for(i=0;i<d;++i)result[i]=__clamp_140(lo[i],hi[i],result[i]);return result},__proto_140.dcurve=function(t){var time=this._time,n=time.length,idx=_$searchBounds_71.le(time,t),result=this._scratch[0],state=this._state,velocity=this._velocity,d=this.dimension;if(idx>=n-1)for(var ptr=state.length-1,i=(time[n-1],0);i<d;++i,--ptr)result[i]=velocity[ptr];else{ptr=d*(idx+1)-1;var t0=time[idx],dt=time[idx+1]-t0||1,x0=this._scratch[1],x1=this._scratch[2],v0=this._scratch[3],v1=this._scratch[4],steady=!0;for(i=0;i<d;++i,--ptr)x0[i]=state[ptr],v0[i]=velocity[ptr]*dt,x1[i]=state[ptr+d],v1[i]=velocity[ptr+d]*dt,steady=steady&&x0[i]===x1[i]&&v0[i]===v1[i]&&0===v0[i];if(steady)for(i=0;i<d;++i)result[i]=0;else{_$hermite_114.derivative(x0,v0,x1,v1,(t-t0)/dt,result);for(i=0;i<d;++i)result[i]/=dt}}return result},__proto_140.lastT=function(){var time=this._time;return time[time.length-1]},__proto_140.stable=function(){for(var velocity=this._velocity,ptr=velocity.length,i=this.dimension-1;i>=0;--i)if(velocity[--ptr])return!1;return!0},__proto_140.jump=function(t){var t0=this.lastT(),d=this.dimension;if(!(t<t0||arguments.length!==d+1)){var state=this._state,velocity=this._velocity,ptr=state.length-this.dimension,bounds=this.bounds,lo=bounds[0],hi=bounds[1];this._time.push(t0,t);for(var j=0;j<2;++j)for(var i=0;i<d;++i)state.push(state[ptr++]),velocity.push(0);this._time.push(t);for(i=d;i>0;--i)state.push(__clamp_140(lo[i-1],hi[i-1],arguments[i])),velocity.push(0)}},__proto_140.push=function(t){var t0=this.lastT(),d=this.dimension;if(!(t<t0||arguments.length!==d+1)){var state=this._state,velocity=this._velocity,ptr=state.length-this.dimension,dt=t-t0,bounds=this.bounds,lo=bounds[0],hi=bounds[1],sf=dt>1e-6?1/dt:0;this._time.push(t);for(var i=d;i>0;--i){var xc=__clamp_140(lo[i-1],hi[i-1],arguments[i]);state.push(xc),velocity.push((xc-state[ptr++])*sf)}}},__proto_140.set=function(t){var d=this.dimension;if(!(t<this.lastT()||arguments.length!==d+1)){var state=this._state,velocity=this._velocity,bounds=this.bounds,lo=bounds[0],hi=bounds[1];this._time.push(t);for(var i=d;i>0;--i)state.push(__clamp_140(lo[i-1],hi[i-1],arguments[i])),velocity.push(0)}},__proto_140.move=function(t){var t0=this.lastT(),d=this.dimension;if(!(t<=t0||arguments.length!==d+1)){var state=this._state,velocity=this._velocity,statePtr=state.length-this.dimension,bounds=this.bounds,lo=bounds[0],hi=bounds[1],dt=t-t0,sf=dt>1e-6?1/dt:0;this._time.push(t);for(var i=d;i>0;--i){var dx=arguments[i];state.push(__clamp_140(lo[i-1],hi[i-1],state[statePtr++]+dx)),velocity.push(dx*sf)}}},__proto_140.idle=function(t){var t0=this.lastT();if(!(t<t0)){var d=this.dimension,state=this._state,velocity=this._velocity,statePtr=state.length-d,bounds=this.bounds,lo=bounds[0],hi=bounds[1],dt=t-t0;this._time.push(t);for(var i=d-1;i>=0;--i)state.push(__clamp_140(lo[i],hi[i],state[statePtr]+dt*velocity[statePtr])),velocity.push(0),statePtr+=1}};var _$quatFromFrame_282=function quatFromFrame(out,rx,ry,rz,ux,uy,uz,fx,fy,fz){var tr=rx+uy+fz;if(l>0){var l=Math.sqrt(tr+1);out[0]=.5*(uz-fy)/l,out[1]=.5*(fx-rz)/l,out[2]=.5*(ry-uy)/l,out[3]=.5*l}else{var tf=Math.max(rx,uy,fz),l=Math.sqrt(2*tf-tr+1);rx>=tf?(out[0]=.5*l,out[1]=.5*(ux+ry)/l,out[2]=.5*(fx+rz)/l,out[3]=.5*(uz-fy)/l):uy>=tf?(out[0]=.5*(ry+ux)/l,out[1]=.5*l,out[2]=.5*(fy+uz)/l,out[3]=.5*(fx-rz)/l):(out[0]=.5*(rz+fx)/l,out[1]=.5*(uz+fy)/l,out[2]=.5*l,out[3]=.5*(ry-ux)/l)}return out};var _$createOrbitController_283=function createOrbitController(options){var center=(options=options||{}).center||[0,0,0],rotation=options.rotation||[0,0,0,1],radius=options.radius||1;center=[].slice.call(center,0,3),normalize4(rotation=[].slice.call(rotation,0,4),rotation);var result=new OrbitCameraController(rotation,center,Math.log(radius));result.setDistanceLimits(options.zoomMin,options.zoomMax),("eye"in options||"up"in options)&&result.lookAt(0,options.eye,options.center,options.up);return result};function len3(x,y,z){return Math.sqrt(Math.pow(x,2)+Math.pow(y,2)+Math.pow(z,2))}function len4(w,x,y,z){return Math.sqrt(Math.pow(w,2)+Math.pow(x,2)+Math.pow(y,2)+Math.pow(z,2))}function normalize4(out,a){var ax=a[0],ay=a[1],az=a[2],aw=a[3],al=len4(ax,ay,az,aw);al>1e-6?(out[0]=ax/al,out[1]=ay/al,out[2]=az/al,out[3]=aw/al):(out[0]=out[1]=out[2]=0,out[3]=1)}function OrbitCameraController(initQuat,initCenter,initRadius){this.radius=_$createFilteredVector_140([initRadius]),this.center=_$createFilteredVector_140(initCenter),this.rotation=_$createFilteredVector_140(initQuat),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var __proto_283=OrbitCameraController.prototype;__proto_283.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},__proto_283.recalcMatrix=function(t){this.radius.curve(t),this.center.curve(t),this.rotation.curve(t);var quat=this.computedRotation;normalize4(quat,quat);var mat=this.computedMatrix;_$fromQuat_170(mat,quat);var center=this.computedCenter,eye=this.computedEye,up=this.computedUp,radius=Math.exp(this.computedRadius[0]);eye[0]=center[0]+radius*mat[2],eye[1]=center[1]+radius*mat[6],eye[2]=center[2]+radius*mat[10],up[0]=mat[1],up[1]=mat[5],up[2]=mat[9];for(var i=0;i<3;++i){for(var rr=0,j=0;j<3;++j)rr+=mat[i+4*j]*eye[j];mat[12+i]=-rr}},__proto_283.getMatrix=function(t,result){this.recalcMatrix(t);var m=this.computedMatrix;if(result){for(var i=0;i<16;++i)result[i]=m[i];return result}return m},__proto_283.idle=function(t){this.center.idle(t),this.radius.idle(t),this.rotation.idle(t)},__proto_283.flush=function(t){this.center.flush(t),this.radius.flush(t),this.rotation.flush(t)},__proto_283.pan=function(t,dx,dy,dz){dx=dx||0,dy=dy||0,dz=dz||0,this.recalcMatrix(t);var mat=this.computedMatrix,ux=mat[1],uy=mat[5],uz=mat[9],ul=len3(ux,uy,uz);ux/=ul,uy/=ul,uz/=ul;var rx=mat[0],ry=mat[4],rz=mat[8],ru=rx*ux+ry*uy+rz*uz,rl=len3(rx-=ux*ru,ry-=uy*ru,rz-=uz*ru);rx/=rl,ry/=rl,rz/=rl;var fx=mat[2],fy=mat[6],fz=mat[10],fu=fx*ux+fy*uy+fz*uz,fr=fx*rx+fy*ry+fz*rz,fl=len3(fx-=fu*ux+fr*rx,fy-=fu*uy+fr*ry,fz-=fu*uz+fr*rz);fx/=fl,fy/=fl,fz/=fl;var vx=rx*dx+ux*dy,vy=ry*dx+uy*dy,vz=rz*dx+uz*dy;this.center.move(t,vx,vy,vz);var radius=Math.exp(this.computedRadius[0]);radius=Math.max(1e-4,radius+dz),this.radius.set(t,Math.log(radius))},__proto_283.rotate=function(t,dx,dy,dz){this.recalcMatrix(t),dx=dx||0,dy=dy||0;var mat=this.computedMatrix,rx=mat[0],ry=mat[4],rz=mat[8],ux=mat[1],uy=mat[5],uz=mat[9],fx=mat[2],fy=mat[6],fz=mat[10],qx=dx*rx+dy*ux,qy=dx*ry+dy*uy,qz=dx*rz+dy*uz,bx=-(fy*qz-fz*qy),by=-(fz*qx-fx*qz),bz=-(fx*qy-fy*qx),bw=Math.sqrt(Math.max(0,1-Math.pow(bx,2)-Math.pow(by,2)-Math.pow(bz,2))),bl=len4(bx,by,bz,bw);bl>1e-6?(bx/=bl,by/=bl,bz/=bl,bw/=bl):(bx=by=bz=0,bw=1);var rotation=this.computedRotation,ax=rotation[0],ay=rotation[1],az=rotation[2],aw=rotation[3],cx=ax*bw+aw*bx+ay*bz-az*by,cy=ay*bw+aw*by+az*bx-ax*bz,cz=az*bw+aw*bz+ax*by-ay*bx,cw=aw*bw-ax*bx-ay*by-az*bz;if(dz){bx=fx,by=fy,bz=fz;var s=Math.sin(dz)/len3(bx,by,bz);bx*=s,by*=s,bz*=s,cw=cw*(bw=Math.cos(dx))-(cx=cx*bw+cw*bx+cy*bz-cz*by)*bx-(cy=cy*bw+cw*by+cz*bx-cx*bz)*by-(cz=cz*bw+cw*bz+cx*by-cy*bx)*bz}var cl=len4(cx,cy,cz,cw);cl>1e-6?(cx/=cl,cy/=cl,cz/=cl,cw/=cl):(cx=cy=cz=0,cw=1),this.rotation.set(t,cx,cy,cz,cw)},__proto_283.lookAt=function(t,eye,center,up){this.recalcMatrix(t),center=center||this.computedCenter,eye=eye||this.computedEye,up=up||this.computedUp;var mat=this.computedMatrix;_$lookAt_174(mat,eye,center,up);var rotation=this.computedRotation;_$quatFromFrame_282(rotation,mat[0],mat[1],mat[2],mat[4],mat[5],mat[6],mat[8],mat[9],mat[10]),normalize4(rotation,rotation),this.rotation.set(t,rotation[0],rotation[1],rotation[2],rotation[3]);for(var fl=0,i=0;i<3;++i)fl+=Math.pow(center[i]-eye[i],2);this.radius.set(t,.5*Math.log(Math.max(fl,1e-6))),this.center.set(t,center[0],center[1],center[2])},__proto_283.translate=function(t,dx,dy,dz){this.center.move(t,dx||0,dy||0,dz||0)},__proto_283.setMatrix=function(t,matrix){var rotation=this.computedRotation;_$quatFromFrame_282(rotation,matrix[0],matrix[1],matrix[2],matrix[4],matrix[5],matrix[6],matrix[8],matrix[9],matrix[10]),normalize4(rotation,rotation),this.rotation.set(t,rotation[0],rotation[1],rotation[2],rotation[3]);var mat=this.computedMatrix;_$invert_173(mat,matrix);var w=mat[15];if(Math.abs(w)>1e-6){var cx=mat[12]/w,cy=mat[13]/w,cz=mat[14]/w;this.recalcMatrix(t);var r=Math.exp(this.computedRadius[0]);this.center.set(t,cx-mat[2]*r,cy-mat[6]*r,cz-mat[10]*r),this.radius.idle(t)}else this.center.idle(t),this.radius.idle(t)},__proto_283.setDistance=function(t,d){d>0&&this.radius.set(t,Math.log(d))},__proto_283.setDistanceLimits=function(lo,hi){lo=lo>0?Math.log(lo):-1/0,hi=hi>0?Math.log(hi):1/0,hi=Math.max(hi,lo),this.radius.bounds[0][0]=lo,this.radius.bounds[1][0]=hi},__proto_283.getDistanceLimits=function(out){var bounds=this.radius.bounds;return out?(out[0]=Math.exp(bounds[0][0]),out[1]=Math.exp(bounds[1][0]),out):[Math.exp(bounds[0][0]),Math.exp(bounds[1][0])]},__proto_283.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},__proto_283.fromJSON=function(options){var t=this.lastT(),c=options.center;c&&this.center.set(t,c[0],c[1],c[2]);var r=options.rotation;r&&this.rotation.set(t,r[0],r[1],r[2],r[3]);var d=options.distance;d&&d>0&&this.radius.set(t,Math.log(d)),this.setDistanceLimits(options.zoomMin,options.zoomMax)};var _$rotate_177=function __rotate_177(out,a,rad,axis){var s,c,t,a00,a01,a02,a03,a10,a11,a12,a13,a20,a21,a22,a23,b00,b01,b02,b10,b11,b12,b20,b21,b22,x=axis[0],y=axis[1],z=axis[2],len=Math.sqrt(x*x+y*y+z*z);if(Math.abs(len)<1e-6)return null;x*=len=1/len,y*=len,z*=len,s=Math.sin(rad),c=Math.cos(rad),t=1-c,a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],b00=x*x*t+c,b01=y*x*t+z*s,b02=z*x*t-y*s,b10=x*y*t-z*s,b11=y*y*t+c,b12=z*y*t+x*s,b20=x*z*t+y*s,b21=y*z*t-x*s,b22=z*z*t+c,out[0]=a00*b00+a10*b01+a20*b02,out[1]=a01*b00+a11*b01+a21*b02,out[2]=a02*b00+a12*b01+a22*b02,out[3]=a03*b00+a13*b01+a23*b02,out[4]=a00*b10+a10*b11+a20*b12,out[5]=a01*b10+a11*b11+a21*b12,out[6]=a02*b10+a12*b11+a22*b12,out[7]=a03*b10+a13*b11+a23*b12,out[8]=a00*b20+a10*b21+a20*b22,out[9]=a01*b20+a11*b21+a21*b22,out[10]=a02*b20+a12*b21+a22*b22,out[11]=a03*b20+a13*b21+a23*b22,a!==out&&(out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15]);return out};var _$createTurntableController_357=function createTurntableController(options){var center=(options=options||{}).center||[0,0,0],up=options.up||[0,1,0],right=options.right||findOrthoPair(up),radius=options.radius||1,theta=options.theta||0,phi=options.phi||0;if(center=[].slice.call(center,0,3),up=[].slice.call(up,0,3),_$normalize_227(up,up),right=[].slice.call(right,0,3),_$normalize_227(right,right),"eye"in options){var eye=options.eye,toward=[eye[0]-center[0],eye[1]-center[1],eye[2]-center[2]];_$cross_223(right,toward,up),__len3_357(right[0],right[1],right[2])<1e-6?right=findOrthoPair(up):_$normalize_227(right,right),radius=__len3_357(toward[0],toward[1],toward[2]);var ut=_$dot_224(up,toward)/radius,rt=_$dot_224(right,toward)/radius;phi=Math.acos(ut),theta=Math.acos(rt)}return radius=Math.log(radius),new TurntableController(options.zoomMin,options.zoomMax,center,up,right,radius,theta,phi)};function __len3_357(x,y,z){return Math.sqrt(Math.pow(x,2)+Math.pow(y,2)+Math.pow(z,2))}function clamp1(x){return Math.min(1,Math.max(-1,x))}function findOrthoPair(v){var vx=Math.abs(v[0]),vy=Math.abs(v[1]),vz=Math.abs(v[2]),u=[0,0,0];vx>Math.max(vy,vz)?u[2]=1:vy>Math.max(vx,vz)?u[0]=1:u[1]=1;for(var vv=0,uv=0,i=0;i<3;++i)vv+=v[i]*v[i],uv+=u[i]*v[i];for(i=0;i<3;++i)u[i]-=uv/vv*v[i];return _$normalize_227(u,u),u}function TurntableController(zoomMin,zoomMax,center,up,right,radius,theta,phi){this.center=_$createFilteredVector_140(center),this.up=_$createFilteredVector_140(up),this.right=_$createFilteredVector_140(right),this.radius=_$createFilteredVector_140([radius]),this.angle=_$createFilteredVector_140([theta,phi]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(zoomMin,zoomMax),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var i=0;i<16;++i)this.computedMatrix[i]=.5;this.recalcMatrix(0)}var __proto_357=TurntableController.prototype;__proto_357.setDistanceLimits=function(minDist,maxDist){minDist=minDist>0?Math.log(minDist):-1/0,maxDist=maxDist>0?Math.log(maxDist):1/0,maxDist=Math.max(maxDist,minDist),this.radius.bounds[0][0]=minDist,this.radius.bounds[1][0]=maxDist},__proto_357.getDistanceLimits=function(out){var bounds=this.radius.bounds[0];return out?(out[0]=Math.exp(bounds[0][0]),out[1]=Math.exp(bounds[1][0]),out):[Math.exp(bounds[0][0]),Math.exp(bounds[1][0])]},__proto_357.recalcMatrix=function(t){this.center.curve(t),this.up.curve(t),this.right.curve(t),this.radius.curve(t),this.angle.curve(t);for(var up=this.computedUp,right=this.computedRight,uu=0,ur=0,i=0;i<3;++i)ur+=up[i]*right[i],uu+=up[i]*up[i];var ul=Math.sqrt(uu),rr=0;for(i=0;i<3;++i)right[i]-=up[i]*ur/uu,rr+=right[i]*right[i],up[i]/=ul;var rl=Math.sqrt(rr);for(i=0;i<3;++i)right[i]/=rl;var toward=this.computedToward;_$cross_223(toward,up,right),_$normalize_227(toward,toward);var radius=Math.exp(this.computedRadius[0]),theta=this.computedAngle[0],phi=this.computedAngle[1],ctheta=Math.cos(theta),stheta=Math.sin(theta),cphi=Math.cos(phi),sphi=Math.sin(phi),center=this.computedCenter,wx=ctheta*cphi,wy=stheta*cphi,wz=sphi,sx=-ctheta*sphi,sy=-stheta*sphi,sz=cphi,eye=this.computedEye,mat=this.computedMatrix;for(i=0;i<3;++i){var x=wx*right[i]+wy*toward[i]+wz*up[i];mat[4*i+1]=sx*right[i]+sy*toward[i]+sz*up[i],mat[4*i+2]=x,mat[4*i+3]=0}var ax=mat[1],ay=mat[5],az=mat[9],bx=mat[2],by=mat[6],bz=mat[10],cx=ay*bz-az*by,cy=az*bx-ax*bz,cz=ax*by-ay*bx,cl=__len3_357(cx,cy,cz);cx/=cl,cy/=cl,cz/=cl,mat[0]=cx,mat[4]=cy,mat[8]=cz;for(i=0;i<3;++i)eye[i]=center[i]+mat[2+4*i]*radius;for(i=0;i<3;++i){rr=0;for(var j=0;j<3;++j)rr+=mat[i+4*j]*eye[j];mat[12+i]=-rr}mat[15]=1},__proto_357.getMatrix=function(t,result){this.recalcMatrix(t);var mat=this.computedMatrix;if(result){for(var i=0;i<16;++i)result[i]=mat[i];return result}return mat};var zAxis=[0,0,0];__proto_357.rotate=function(t,dtheta,dphi,droll){if(this.angle.move(t,dtheta,dphi),droll){this.recalcMatrix(t);var mat=this.computedMatrix;zAxis[0]=mat[2],zAxis[1]=mat[6],zAxis[2]=mat[10];for(var up=this.computedUp,right=this.computedRight,toward=this.computedToward,i=0;i<3;++i)mat[4*i]=up[i],mat[4*i+1]=right[i],mat[4*i+2]=toward[i];_$rotate_177(mat,mat,droll,zAxis);for(i=0;i<3;++i)up[i]=mat[4*i],right[i]=mat[4*i+1];this.up.set(t,up[0],up[1],up[2]),this.right.set(t,right[0],right[1],right[2])}},__proto_357.pan=function(t,dx,dy,dz){dx=dx||0,dy=dy||0,dz=dz||0,this.recalcMatrix(t);var mat=this.computedMatrix,ux=(Math.exp(this.computedRadius[0]),mat[1]),uy=mat[5],uz=mat[9],ul=__len3_357(ux,uy,uz);ux/=ul,uy/=ul,uz/=ul;var rx=mat[0],ry=mat[4],rz=mat[8],ru=rx*ux+ry*uy+rz*uz,rl=__len3_357(rx-=ux*ru,ry-=uy*ru,rz-=uz*ru),vx=(rx/=rl)*dx+ux*dy,vy=(ry/=rl)*dx+uy*dy,vz=(rz/=rl)*dx+uz*dy;this.center.move(t,vx,vy,vz);var radius=Math.exp(this.computedRadius[0]);radius=Math.max(1e-4,radius+dz),this.radius.set(t,Math.log(radius))},__proto_357.translate=function(t,dx,dy,dz){this.center.move(t,dx||0,dy||0,dz||0)},__proto_357.setMatrix=function(t,mat,axes,noSnap){var ushift=1;"number"==typeof axes&&(ushift=0|axes),(ushift<0||ushift>3)&&(ushift=1);var vshift=(ushift+2)%3;mat||(this.recalcMatrix(t),mat=this.computedMatrix);var ux=mat[ushift],uy=mat[ushift+4],uz=mat[ushift+8];if(noSnap){var ax=Math.abs(ux),ay=Math.abs(uy),az=Math.abs(uz),am=Math.max(ax,ay,az);ax===am?(ux=ux<0?-1:1,uy=uz=0):az===am?(uz=uz<0?-1:1,ux=uy=0):(uy=uy<0?-1:1,ux=uz=0)}else{var ul=__len3_357(ux,uy,uz);ux/=ul,uy/=ul,uz/=ul}var phi,theta,rx=mat[vshift],ry=mat[vshift+4],rz=mat[vshift+8],ru=rx*ux+ry*uy+rz*uz,rl=__len3_357(rx-=ux*ru,ry-=uy*ru,rz-=uz*ru),fx=uy*(rz/=rl)-uz*(ry/=rl),fy=uz*(rx/=rl)-ux*rz,fz=ux*ry-uy*rx,fl=__len3_357(fx,fy,fz);if(fx/=fl,fy/=fl,fz/=fl,this.center.jump(t,ex,ey,ez),this.radius.idle(t),this.up.jump(t,ux,uy,uz),this.right.jump(t,rx,ry,rz),2===ushift){var cx=mat[1],cy=mat[5],cz=mat[9],cr=cx*rx+cy*ry+cz*rz,cf=cx*fx+cy*fy+cz*fz;phi=tu<0?-Math.PI/2:Math.PI/2,theta=Math.atan2(cf,cr)}else{var tx=mat[2],ty=mat[6],tz=mat[10],tu=tx*ux+ty*uy+tz*uz,tr=tx*rx+ty*ry+tz*rz,tf=tx*fx+ty*fy+tz*fz;phi=Math.asin(clamp1(tu)),theta=Math.atan2(tf,tr)}this.angle.jump(t,theta,phi),this.recalcMatrix(t);var dx=mat[2],dy=mat[6],dz=mat[10],imat=this.computedMatrix;_$invert_173(imat,mat);var w=imat[15],ex=imat[12]/w,ey=imat[13]/w,ez=imat[14]/w,gs=Math.exp(this.computedRadius[0]);this.center.jump(t,ex-dx*gs,ey-dy*gs,ez-dz*gs)},__proto_357.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},__proto_357.idle=function(t){this.center.idle(t),this.up.idle(t),this.right.idle(t),this.radius.idle(t),this.angle.idle(t)},__proto_357.flush=function(t){this.center.flush(t),this.up.flush(t),this.right.flush(t),this.radius.flush(t),this.angle.flush(t)},__proto_357.setDistance=function(t,d){d>0&&this.radius.set(t,Math.log(d))},__proto_357.lookAt=function(t,eye,center,up){this.recalcMatrix(t),eye=eye||this.computedEye,center=center||this.computedCenter;var ux=(up=up||this.computedUp)[0],uy=up[1],uz=up[2],ul=__len3_357(ux,uy,uz);if(!(ul<1e-6)){ux/=ul,uy/=ul,uz/=ul;var tx=eye[0]-center[0],ty=eye[1]-center[1],tz=eye[2]-center[2],tl=__len3_357(tx,ty,tz);if(!(tl<1e-6)){tx/=tl,ty/=tl,tz/=tl;var right=this.computedRight,rx=right[0],ry=right[1],rz=right[2],ru=ux*rx+uy*ry+uz*rz,rl=__len3_357(rx-=ru*ux,ry-=ru*uy,rz-=ru*uz);if(!(rl<.01&&(rl=__len3_357(rx=uy*tz-uz*ty,ry=uz*tx-ux*tz,rz=ux*ty-uy*tx))<1e-6)){rx/=rl,ry/=rl,rz/=rl,this.up.set(t,ux,uy,uz),this.right.set(t,rx,ry,rz),this.center.set(t,center[0],center[1],center[2]),this.radius.set(t,Math.log(tl));var fx=uy*rz-uz*ry,fy=uz*rx-ux*rz,fz=ux*ry-uy*rx,fl=__len3_357(fx,fy,fz),tu=ux*tx+uy*ty+uz*tz,tr=rx*tx+ry*ty+rz*tz,tf=(fx/=fl)*tx+(fy/=fl)*ty+(fz/=fl)*tz,phi=Math.asin(clamp1(tu)),theta=Math.atan2(tf,tr),angleState=this.angle._state,lastTheta=angleState[angleState.length-1],lastPhi=angleState[angleState.length-2];lastTheta%=2*Math.PI;var dp=Math.abs(lastTheta+2*Math.PI-theta),d0=Math.abs(lastTheta-theta),dn=Math.abs(lastTheta-2*Math.PI-theta);dp<d0&&(lastTheta+=2*Math.PI),dn<d0&&(lastTheta-=2*Math.PI),this.angle.jump(this.angle.lastT(),lastTheta,lastPhi),this.angle.set(t,theta,phi)}}}};var _$createViewController_40=function createViewController(options){var eye=(options=options||{}).eye||[0,0,1],center=options.center||[0,0,0],up=options.up||[0,1,0],limits=options.distanceLimits||[0,1/0],mode=options.mode||"turntable",turntable=_$createTurntableController_357(),orbit=_$createOrbitController_283(),matrix=_$createMatrixCameraController_260();return turntable.setDistanceLimits(limits[0],limits[1]),turntable.lookAt(0,eye,center,up),orbit.setDistanceLimits(limits[0],limits[1]),orbit.lookAt(0,eye,center,up),matrix.setDistanceLimits(limits[0],limits[1]),matrix.lookAt(0,eye,center,up),new ViewController({turntable:turntable,orbit:orbit,matrix:matrix},mode)};function ViewController(controllers,mode){this._controllerNames=Object.keys(controllers),this._controllerList=this._controllerNames.map(function(n){return controllers[n]}),this._mode=mode,this._active=controllers[mode],this._active||(this._mode="turntable",this._active=controllers.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var __proto_40=ViewController.prototype;[["flush",1],["idle",1],["lookAt",4],["rotate",4],["pan",4],["translate",4],["setMatrix",2],["setDistanceLimits",2],["setDistance",2]].forEach(function(method){for(var name=method[0],argNames=[],i=0;i<method[1];++i)argNames.push("a"+i);var code="var cc=this._controllerList;for(var i=0;i<cc.length;++i){cc[i]."+method[0]+"("+argNames.join()+")}";__proto_40[name]=Function.apply(null,argNames.concat(code))}),__proto_40.recalcMatrix=function(t){this._active.recalcMatrix(t)},__proto_40.getDistance=function(t){return this._active.getDistance(t)},__proto_40.getDistanceLimits=function(out){return this._active.getDistanceLimits(out)},__proto_40.lastT=function(){return this._active.lastT()},__proto_40.setMode=function(mode){if(mode!==this._mode){var idx=this._controllerNames.indexOf(mode);if(!(idx<0)){var prev=this._active,next=this._controllerList[idx],lastT=Math.max(prev.lastT(),next.lastT());prev.recalcMatrix(lastT),next.setMatrix(lastT,prev.computedMatrix),this._active=next,this._mode=mode,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},__proto_40.getMode=function(){return this._mode};var _$browser_317={};(function(global){_$browser_317=global.performance&&global.performance.now?function now(){return performance.now()}:Date.now||function now(){return+new Date}}).call(this,void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var _$createCamera_39=function __createCamera_39(element,options){element=element||document.body,options=options||{};var limits=[.01,1/0];"distanceLimits"in options&&(limits[0]=options.distanceLimits[0],limits[1]=options.distanceLimits[1]);"zoomMin"in options&&(limits[0]=options.zoomMin);"zoomMax"in options&&(limits[1]=options.zoomMax);var view=_$createViewController_40({center:options.center||[0,0,0],up:options.up||[0,1,0],eye:options.eye||[0,0,10],mode:options.mode||"orbit",distanceLimits:limits}),pmatrix=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],distance=0,width=element.clientWidth,height=element.clientHeight,camera={view:view,element:element,delay:options.delay||16,rotateSpeed:options.rotateSpeed||1,zoomSpeed:options.zoomSpeed||1,translateSpeed:options.translateSpeed||1,flipX:!!options.flipX,flipY:!!options.flipY,modes:view.modes,tick:function(){var t=_$browser_317(),delay=this.delay;view.idle(t-delay),view.flush(t-(100+2*delay));var ctime=t-2*delay;view.recalcMatrix(ctime);for(var allEqual=!0,matrix=view.computedMatrix,i=0;i<16;++i)allEqual=allEqual&&pmatrix[i]===matrix[i],pmatrix[i]=matrix[i];var sizeChanged=element.clientWidth===width&&element.clientHeight===height;return width=element.clientWidth,height=element.clientHeight,allEqual?!sizeChanged:(distance=Math.exp(view.computedRadius[0]),!0)},lookAt:function(center,eye,up){view.lookAt(view.lastT(),center,eye,up)},rotate:function(pitch,yaw,roll){view.rotate(view.lastT(),pitch,yaw,roll)},pan:function(dx,dy,dz){view.pan(view.lastT(),dx,dy,dz)},translate:function(dx,dy,dz){view.translate(view.lastT(),dx,dy,dz)}};Object.defineProperties(camera,{matrix:{get:function(){return view.computedMatrix},set:function(mat){return view.setMatrix(view.lastT(),mat),view.computedMatrix},enumerable:!0},mode:{get:function(){return view.getMode()},set:function(mode){return view.setMode(mode),view.getMode()},enumerable:!0},center:{get:function(){return view.computedCenter},set:function(ncenter){return view.lookAt(view.lastT(),ncenter),view.computedCenter},enumerable:!0},eye:{get:function(){return view.computedEye},set:function(neye){return view.lookAt(view.lastT(),null,neye),view.computedEye},enumerable:!0},up:{get:function(){return view.computedUp},set:function(nup){return view.lookAt(view.lastT(),null,null,nup),view.computedUp},enumerable:!0},distance:{get:function(){return distance},set:function(d){return view.setDistance(view.lastT(),d),d},enumerable:!0},distanceLimits:{get:function(){return view.getDistanceLimits(limits)},set:function(v){return view.setDistanceLimits(v),v},enumerable:!0}}),element.addEventListener("contextmenu",function(ev){return ev.preventDefault(),!1});var lastX=0,lastY=0,lastMods={shift:!1,control:!1,alt:!1,meta:!1};function handleInteraction(buttons,x,y,mods){var scale=1/element.clientHeight,dx=scale*(x-lastX),dy=scale*(y-lastY),flipX=camera.flipX?1:-1,flipY=camera.flipY?1:-1,drot=Math.PI*camera.rotateSpeed,t=_$browser_317();if(1&buttons)mods.shift?view.rotate(t,0,0,-dx*drot):view.rotate(t,flipX*drot*dx,-flipY*drot*dy,0);else if(2&buttons)view.pan(t,-camera.translateSpeed*dx*distance,camera.translateSpeed*dy*distance,0);else if(4&buttons){var kzoom=camera.zoomSpeed*dy/window.innerHeight*(t-view.lastT())*50;view.pan(t,0,0,distance*(Math.exp(kzoom)-1))}lastX=x,lastY=y,lastMods=mods}return _$mouseListen_262(element,handleInteraction),element.addEventListener("touchstart",function(ev){var xy=_$mouseEventOffset_263(ev.changedTouches[0],element);handleInteraction(0,xy[0],xy[1],lastMods),handleInteraction(1,xy[0],xy[1],lastMods),ev.preventDefault()},!!_$hasPassiveEvents_240&&{passive:!1}),element.addEventListener("touchmove",function(ev){var xy=_$mouseEventOffset_263(ev.changedTouches[0],element);handleInteraction(1,xy[0],xy[1],lastMods),ev.preventDefault()},!!_$hasPassiveEvents_240&&{passive:!1}),element.addEventListener("touchend",function(ev){_$mouseEventOffset_263(ev.changedTouches[0],element),handleInteraction(0,lastX,lastY,lastMods),ev.preventDefault()},!!_$hasPassiveEvents_240&&{passive:!1}),_$mouseWheelListen_265(element,function(dx,dy,dz){var flipX=camera.flipX?1:-1,flipY=camera.flipY?1:-1,t=_$browser_317();if(Math.abs(dx)>Math.abs(dy))view.rotate(t,0,0,-dx*flipX*Math.PI*camera.rotateSpeed/window.innerWidth);else{var kzoom=camera.zoomSpeed*flipY*dy/window.innerHeight*(t-view.lastT())/100;view.pan(t,0,0,distance*(Math.exp(kzoom)-1))}},!0),camera};var _$doBind_219=function doBind(gl,elements,attributes){elements?elements.bind():gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,null);var nattribs=0|gl.getParameter(gl.MAX_VERTEX_ATTRIBS);if(attributes){if(attributes.length>nattribs)throw new Error("gl-vao: Too many vertex attributes");for(var i=0;i<attributes.length;++i){var attrib=attributes[i];if(attrib.buffer){var buffer=attrib.buffer,size=attrib.size||4,type=attrib.type||gl.FLOAT,normalized=!!attrib.normalized,stride=attrib.stride||0,offset=attrib.offset||0;buffer.bind(),gl.enableVertexAttribArray(i),gl.vertexAttribPointer(i,size,type,normalized,stride,offset)}else{if("number"==typeof attrib)gl.vertexAttrib1f(i,attrib);else if(1===attrib.length)gl.vertexAttrib1f(i,attrib[0]);else if(2===attrib.length)gl.vertexAttrib2f(i,attrib[0],attrib[1]);else if(3===attrib.length)gl.vertexAttrib3f(i,attrib[0],attrib[1],attrib[2]);else{if(4!==attrib.length)throw new Error("gl-vao: Invalid vertex attribute");gl.vertexAttrib4f(i,attrib[0],attrib[1],attrib[2],attrib[3])}gl.disableVertexAttribArray(i)}}for(;i<nattribs;++i)gl.disableVertexAttribArray(i)}else for(gl.bindBuffer(gl.ARRAY_BUFFER,null),i=0;i<nattribs;++i)gl.disableVertexAttribArray(i)};function VAOEmulated(gl){this.gl=gl,this._elements=null,this._attributes=null,this._elementsType=gl.UNSIGNED_SHORT}VAOEmulated.prototype.bind=function(){_$doBind_219(this.gl,this._elements,this._attributes)},VAOEmulated.prototype.update=function(attributes,elements,elementsType){this._elements=elements,this._attributes=attributes,this._elementsType=elementsType||this.gl.UNSIGNED_SHORT},VAOEmulated.prototype.dispose=function(){},VAOEmulated.prototype.unbind=function(){},VAOEmulated.prototype.draw=function(mode,count,offset){offset=offset||0;var gl=this.gl;this._elements?gl.drawElements(mode,count,this._elementsType,offset):gl.drawArrays(mode,offset,count)};var _$createVAOEmulated_220=function createVAOEmulated(gl){return new VAOEmulated(gl)};function VertexAttribute(location,dimension,a,b,c,d){this.location=location,this.dimension=dimension,this.a=a,this.b=b,this.c=c,this.d=d}function VAONative(gl,ext,handle){this.gl=gl,this._ext=ext,this.handle=handle,this._attribs=[],this._useElements=!1,this._elementsType=gl.UNSIGNED_SHORT}VertexAttribute.prototype.bind=function(gl){switch(this.dimension){case 1:gl.vertexAttrib1f(this.location,this.a);break;case 2:gl.vertexAttrib2f(this.location,this.a,this.b);break;case 3:gl.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:gl.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d)}},VAONative.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var i=0;i<this._attribs.length;++i)this._attribs[i].bind(this.gl)},VAONative.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},VAONative.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},VAONative.prototype.update=function(attributes,elements,elementsType){if(this.bind(),_$doBind_219(this.gl,elements,attributes),this.unbind(),this._attribs.length=0,attributes)for(var i=0;i<attributes.length;++i){var a=attributes[i];"number"==typeof a?this._attribs.push(new VertexAttribute(i,1,a)):Array.isArray(a)&&this._attribs.push(new VertexAttribute(i,a.length,a[0],a[1],a[2],a[3]))}this._useElements=!!elements,this._elementsType=elementsType||this.gl.UNSIGNED_SHORT},VAONative.prototype.draw=function(mode,count,offset){offset=offset||0;var gl=this.gl;this._useElements?gl.drawElements(mode,count,this._elementsType,offset):gl.drawArrays(mode,offset,count)};var _$createVAONative_221=function createVAONative(gl,ext){return new VAONative(gl,ext,ext.createVertexArrayOES())};var _$createVAO_222=function createVAO(gl,attributes,elements,elementsType){var vao,ext=gl.createVertexArray?new function ExtensionShim(gl){this.bindVertexArrayOES=gl.bindVertexArray.bind(gl),this.createVertexArrayOES=gl.createVertexArray.bind(gl),this.deleteVertexArrayOES=gl.deleteVertexArray.bind(gl)}(gl):gl.getExtension("OES_vertex_array_object");return(vao=ext?_$createVAONative_221(gl,ext):_$createVAOEmulated_220(gl)).update(attributes,elements,elementsType),vao},_$weakMap_369={};!function WeakMapModule(){"use strict";if("undefined"==typeof ses||!ses.ok||ses.ok()){"undefined"!=typeof ses&&(ses.weakMapPermitHostObjects=weakMapPermitHostObjects);var doubleWeakMapCheckSilentFailure=!1;if("function"==typeof WeakMap){var HostWeakMap=WeakMap;if("undefined"!=typeof navigator&&/Firefox/.test(navigator.userAgent));else{var testMap=new HostWeakMap,testObject=Object.freeze({});if(testMap.set(testObject,1),1===testMap.get(testObject))return void(_$weakMap_369=WeakMap);doubleWeakMapCheckSilentFailure=!0}}Object.prototype.hasOwnProperty;var gopn=Object.getOwnPropertyNames,defProp=Object.defineProperty,isExtensible=Object.isExtensible,HIDDEN_NAME_PREFIX="weakmap:",HIDDEN_NAME=HIDDEN_NAME_PREFIX+"ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var ab=new ArrayBuffer(25),u8s=new Uint8Array(ab);crypto.getRandomValues(u8s),HIDDEN_NAME=HIDDEN_NAME_PREFIX+"rand:"+Array.prototype.map.call(u8s,function(u8){return(u8%36).toString(36)}).join("")+"___"}if(defProp(Object,"getOwnPropertyNames",{value:function fakeGetOwnPropertyNames(obj){return gopn(obj).filter(isNotHiddenName)}}),"getPropertyNames"in Object){var originalGetPropertyNames=Object.getPropertyNames;defProp(Object,"getPropertyNames",{value:function fakeGetPropertyNames(obj){return originalGetPropertyNames(obj).filter(isNotHiddenName)}})}!function(){var oldFreeze=Object.freeze;defProp(Object,"freeze",{value:function identifyingFreeze(obj){return getHiddenRecord(obj),oldFreeze(obj)}});var oldSeal=Object.seal;defProp(Object,"seal",{value:function identifyingSeal(obj){return getHiddenRecord(obj),oldSeal(obj)}});var oldPreventExtensions=Object.preventExtensions;defProp(Object,"preventExtensions",{value:function identifyingPreventExtensions(obj){return getHiddenRecord(obj),oldPreventExtensions(obj)}})}();var calledAsFunctionWarningDone=!1,nextId=0,OurWeakMap=function(){this instanceof OurWeakMap||calledAsFunctionWarning();var keys=[],values=[],id=nextId++;return Object.create(OurWeakMap.prototype,{get___:{value:constFunc(function get___(key,opt_default){var index,hiddenRecord=getHiddenRecord(key);return hiddenRecord?id in hiddenRecord?hiddenRecord[id]:opt_default:(index=keys.indexOf(key))>=0?values[index]:opt_default})},has___:{value:constFunc(function has___(key){var hiddenRecord=getHiddenRecord(key);return hiddenRecord?id in hiddenRecord:keys.indexOf(key)>=0})},set___:{value:constFunc(function set___(key,value){var index,hiddenRecord=getHiddenRecord(key);return hiddenRecord?hiddenRecord[id]=value:(index=keys.indexOf(key))>=0?values[index]=value:(index=keys.length,values[index]=value,keys[index]=key),this})},delete___:{value:constFunc(function delete___(key){var index,lastIndex,hiddenRecord=getHiddenRecord(key);return hiddenRecord?id in hiddenRecord&&delete hiddenRecord[id]:!((index=keys.indexOf(key))<0||(lastIndex=keys.length-1,keys[index]=void 0,values[index]=values[lastIndex],keys[index]=keys[lastIndex],keys.length=lastIndex,values.length=lastIndex,0))})}})};OurWeakMap.prototype=Object.create(Object.prototype,{get:{value:function get(key,opt_default){return this.get___(key,opt_default)},writable:!0,configurable:!0},has:{value:function has(key){return this.has___(key)},writable:!0,configurable:!0},set:{value:function set(key,value){return this.set___(key,value)},writable:!0,configurable:!0},delete:{value:function remove(key){return this.delete___(key)},writable:!0,configurable:!0}}),"function"==typeof HostWeakMap?function(){function DoubleWeakMap(){this instanceof OurWeakMap||calledAsFunctionWarning();var dset,hmap=new HostWeakMap,omap=void 0,enableSwitching=!1;return dset=doubleWeakMapCheckSilentFailure?function(key,value){return hmap.set(key,value),hmap.has(key)||(omap||(omap=new OurWeakMap),omap.set(key,value)),this}:function(key,value){if(enableSwitching)try{hmap.set(key,value)}catch(e){omap||(omap=new OurWeakMap),omap.set___(key,value)}else hmap.set(key,value);return this},Object.create(OurWeakMap.prototype,{get___:{value:constFunc(function dget(key,opt_default){return omap?hmap.has(key)?hmap.get(key):omap.get___(key,opt_default):hmap.get(key,opt_default)})},has___:{value:constFunc(function dhas(key){return hmap.has(key)||!!omap&&omap.has___(key)})},set___:{value:constFunc(dset)},delete___:{value:constFunc(function ddelete(key){var result=!!hmap.delete(key);return omap&&omap.delete___(key)||result})},permitHostObjects___:{value:constFunc(function(token){if(token!==weakMapPermitHostObjects)throw new Error("bogus call to permitHostObjects___");enableSwitching=!0})}})}doubleWeakMapCheckSilentFailure&&"undefined"!=typeof Proxy&&(Proxy=void 0),DoubleWeakMap.prototype=OurWeakMap.prototype,_$weakMap_369=DoubleWeakMap,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():("undefined"!=typeof Proxy&&(Proxy=void 0),_$weakMap_369=OurWeakMap)}function weakMapPermitHostObjects(map){map.permitHostObjects___&&map.permitHostObjects___(weakMapPermitHostObjects)}function isNotHiddenName(name){return!(name.substr(0,HIDDEN_NAME_PREFIX.length)==HIDDEN_NAME_PREFIX&&"___"===name.substr(name.length-3))}function getHiddenRecord(key){if(key!==Object(key))throw new TypeError("Not an object: "+key);var hiddenRecord=key[HIDDEN_NAME];if(hiddenRecord&&hiddenRecord.key===key)return hiddenRecord;if(isExtensible(key)){hiddenRecord={key:key};try{return defProp(key,HIDDEN_NAME,{value:hiddenRecord,writable:!1,enumerable:!1,configurable:!1}),hiddenRecord}catch(error){return}}}function constFunc(func){return func.prototype=null,Object.freeze(func)}function calledAsFunctionWarning(){calledAsFunctionWarningDone||"undefined"==typeof console||(calledAsFunctionWarningDone=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}}();var TriangleCache=new("undefined"==typeof WeakMap?_$weakMap_369:WeakMap);var _$createABigTriangle_42=function createABigTriangle(gl){var triangleVAO=TriangleCache.get(gl),handle=triangleVAO&&(triangleVAO._triangleBuffer.handle||triangleVAO._triangleBuffer.buffer);if(!handle||!gl.isBuffer(handle)){var buf=_$createBuffer_153(gl,new Float32Array([-1,-1,-1,4,4,-1]));(triangleVAO=_$createVAO_222(gl,[{buffer:buf,type:gl.FLOAT,size:2}]))._triangleBuffer=buf,TriangleCache.set(gl,triangleVAO)}triangleVAO.bind(),gl.drawArrays(gl.TRIANGLES,0,3),triangleVAO.unbind()},_$shaders_149={},lineVert=_$browser_238(["#define GLSLIFY 1\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, majorAxis, minorAxis, screenAxis;\nuniform float lineWidth;\nuniform vec2 screenShape;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nvoid main() {\n  vec3 major = position.x * majorAxis;\n  vec3 minor = position.y * minorAxis;\n\n  vec3 vPosition = major + minor + offset;\n  vec3 pPosition = project(vPosition);\n  vec3 offset = project(vPosition + screenAxis * position.z);\n\n  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;\n\n  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);\n}\n"]),lineFrag=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);_$shaders_149.line=function(gl){return _$createShader_206(gl,lineVert,lineFrag,null,[{name:"position",type:"vec3"}])};var textVert=_$browser_238(["#define GLSLIFY 1\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, axis;\nuniform float scale, angle, pixelScale;\nuniform vec2 resolution;\n\nvoid main() {  \n  //Compute plane offset\n  vec2 planeCoord = position.xy * pixelScale;\n  mat2 planeXform = scale * mat2(cos(angle), sin(angle),\n                                -sin(angle), cos(angle));\n  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;\n\n  //Compute world offset\n  float axisDistance = position.z;\n  vec3 dataPosition = axisDistance * axis + offset;\n  vec4 worldPosition = model * vec4(dataPosition, 1);\n  \n  //Compute clip position\n  vec4 viewPosition = view * worldPosition;\n  vec4 clipPosition = projection * viewPosition;\n  clipPosition /= clipPosition.w;\n\n  //Apply text offset in clip coordinates\n  clipPosition += vec4(viewOffset, 0, 0);\n\n  //Done\n  gl_Position = clipPosition;\n}"]),textFrag=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);_$shaders_149.text=function(gl){return _$createShader_206(gl,textVert,textFrag,null,[{name:"position",type:"vec3"}])};var bgVert=_$browser_238(["#define GLSLIFY 1\nattribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 model, view, projection;\nuniform vec3 enable;\nuniform vec3 bounds[2];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n  if(dot(normal, enable) > 0.0) {\n    vec3 nPosition = mix(bounds[0], bounds[1], 0.5 * (position + 1.0));\n    gl_Position = projection * view * model * vec4(nPosition, 1.0);\n  } else {\n    gl_Position = vec4(0,0,0,0);\n  }\n  colorChannel = abs(normal);\n}"]),bgFrag=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 colors[3];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n  gl_FragColor = colorChannel.x * colors[0] + \n                 colorChannel.y * colors[1] +\n                 colorChannel.z * colors[2];\n}"]);_$shaders_149.bg=function(gl){return _$createShader_206(gl,bgVert,bgFrag,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])};var _$createBackgroundCube_146=function createBackgroundCube(gl){for(var vertices=[],indices=[],ptr=0,d=0;d<3;++d)for(var u=(d+1)%3,v=(d+2)%3,x=[0,0,0],c=[0,0,0],s=-1;s<=1;s+=2){indices.push(ptr,ptr+2,ptr+1,ptr+1,ptr+2,ptr+3),x[d]=s,c[d]=s;for(var i=-1;i<=1;i+=2){x[u]=i;for(var j=-1;j<=1;j+=2)x[v]=j,vertices.push(x[0],x[1],x[2],c[0],c[1],c[2]),ptr+=1}var tt=u;u=v,v=tt}var buffer=_$createBuffer_153(gl,new Float32Array(vertices)),elements=_$createBuffer_153(gl,new Uint16Array(indices),gl.ELEMENT_ARRAY_BUFFER),vao=_$createVAO_222(gl,[{buffer:buffer,type:gl.FLOAT,size:3,offset:0,stride:24},{buffer:buffer,type:gl.FLOAT,size:3,offset:12,stride:24}],elements),shader=__createShader_146(gl);return shader.attributes.position.location=0,shader.attributes.normal.location=1,new BackgroundCube(gl,buffer,vao,shader)},__createShader_146=_$shaders_149.bg;function BackgroundCube(gl,buffer,vao,shader){this.gl=gl,this.buffer=buffer,this.vao=vao,this.shader=shader}var __proto_146=BackgroundCube.prototype;__proto_146.draw=function(model,view,projection,bounds,enable,colors){for(var needsBG=!1,i=0;i<3;++i)needsBG=needsBG||enable[i];if(needsBG){var gl=this.gl;gl.enable(gl.POLYGON_OFFSET_FILL),gl.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:model,view:view,projection:projection,bounds:bounds,enable:enable,colors:colors},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),gl.disable(gl.POLYGON_OFFSET_FILL)}},__proto_146.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()};var _$robustDotProduct_320=function robustDotProduct(a,b){for(var r=_$twoProduct_358(a[0],b[0]),i=1;i<a.length;++i)r=_$linearExpansionSum_328(r,_$twoProduct_358(a[i],b[i]));return r};var _$clipPoly_342={};function planeT(p,plane){var r=_$linearExpansionSum_328(_$robustDotProduct_320(p,plane),[plane[plane.length-1]]);return r[r.length-1]}function lerpW(a,wa,b,wb){var t=-wa/(wb-wa);t<0?t=0:t>1&&(t=1);for(var ti=1-t,n=a.length,r=new Array(n),i=0;i<n;++i)r[i]=t*a[i]+ti*b[i];return r}(_$clipPoly_342=function splitPolygon(points,plane){for(var pos=[],neg=[],a=planeT(points[points.length-1],plane),s=points[points.length-1],t=points[0],i=0;i<points.length;++i,s=t){var b=planeT(t=points[i],plane);if(a<0&&b>0||a>0&&b<0){var p=lerpW(s,b,t,a);pos.push(p),neg.push(p.slice())}b<0?neg.push(t.slice()):b>0?pos.push(t.slice()):(pos.push(t.slice()),neg.push(t.slice())),a=b}return{positive:pos,negative:neg}}).positive=function positive(points,plane){for(var pos=[],a=planeT(points[points.length-1],plane),s=points[points.length-1],t=points[0],i=0;i<points.length;++i,s=t){var b=planeT(t=points[i],plane);(a<0&&b>0||a>0&&b<0)&&pos.push(lerpW(s,b,t,a)),b>=0&&pos.push(t.slice()),a=b}return pos},_$clipPoly_342.negative=function negative(points,plane){for(var neg=[],a=planeT(points[points.length-1],plane),s=points[points.length-1],t=points[0],i=0;i<points.length;++i,s=t){var b=planeT(t=points[i],plane);(a<0&&b>0||a>0&&b<0)&&neg.push(lerpW(s,b,t,a)),b<=0&&neg.push(t.slice()),a=b}return neg};var _$getCubeEdges_147=function getCubeEdges(model,view,projection,bounds){_$multiply_175(mvp,view,model),_$multiply_175(mvp,projection,mvp);for(var ptr=0,i=0;i<2;++i){x[2]=bounds[i][2];for(var j=0;j<2;++j){x[1]=bounds[j][1];for(var k=0;k<2;++k)x[0]=bounds[k][0],transformHg(pCubeVerts[ptr],x,mvp),ptr+=1}}for(var closest=-1,i=0;i<8;++i){for(var w=pCubeVerts[i][3],l=0;l<3;++l)cubeVerts[i][l]=pCubeVerts[i][l]/w;w<0&&(closest<0?closest=i:cubeVerts[i][2]<cubeVerts[closest][2]&&(closest=i))}if(closest<0){closest=0;for(var d=0;d<3;++d){for(var u=(d+2)%3,v=(d+1)%3,o0=-1,o1=-1,s=0;s<2;++s){var f0=s<<d,f1=f0+(s<<u)+(1-s<<v),f2=f0+(1-s<<u)+(s<<v);_$orientation_323(cubeVerts[f0],cubeVerts[f1],cubeVerts[f2],zero3)<0||(s?o0=1:o1=1)}if(o0<0||o1<0)o1>o0&&(closest|=1<<d);else{for(var s=0;s<2;++s){var f0=s<<d,f1=f0+(s<<u)+(1-s<<v),f2=f0+(1-s<<u)+(s<<v),o=polygonArea([pCubeVerts[f0],pCubeVerts[f1],pCubeVerts[f2],pCubeVerts[f0+(1<<u)+(1<<v)]]);s?o0=o:o1=o}o1>o0&&(closest|=1<<d)}}}for(var farthest=7^closest,bottom=-1,i=0;i<8;++i)i!==closest&&i!==farthest&&(bottom<0?bottom=i:cubeVerts[bottom][1]>cubeVerts[i][1]&&(bottom=i));for(var left=-1,i=0;i<3;++i){var idx=bottom^1<<i;if(idx!==closest&&idx!==farthest){left<0&&(left=idx);var v=cubeVerts[idx];v[0]<cubeVerts[left][0]&&(left=idx)}}for(var right=-1,i=0;i<3;++i){var idx=bottom^1<<i;if(idx!==closest&&idx!==farthest&&idx!==left){right<0&&(right=idx);var v=cubeVerts[idx];v[0]>cubeVerts[right][0]&&(right=idx)}}var cubeEdges=CUBE_EDGES;cubeEdges[0]=cubeEdges[1]=cubeEdges[2]=0,cubeEdges[_$twiddle_72.log2(left^bottom)]=bottom&left,cubeEdges[_$twiddle_72.log2(bottom^right)]=bottom&right;var top=7^right;top===closest||top===farthest?(top=7^left,cubeEdges[_$twiddle_72.log2(right^top)]=top&right):cubeEdges[_$twiddle_72.log2(left^top)]=top&left;for(var axis=CUBE_AXIS,cutCorner=closest,d=0;d<3;++d)axis[d]=cutCorner&1<<d?-1:1;return CUBE_RESULT},mvp=new Array(16),pCubeVerts=(new Array(16),new Array(8)),cubeVerts=new Array(8),x=new Array(3),zero3=[0,0,0];function transformHg(result,x,mat){for(var i=0;i<4;++i){result[i]=mat[12+i];for(var j=0;j<3;++j)result[i]+=x[j]*mat[4*j+i]}}!function(){for(var i=0;i<8;++i)pCubeVerts[i]=[1,1,1,1],cubeVerts[i]=[1,1,1]}();var FRUSTUM_PLANES=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function polygonArea(p){for(var i=0;i<FRUSTUM_PLANES.length;++i)if((p=_$clipPoly_342.positive(p,FRUSTUM_PLANES[i])).length<3)return 0;var base=p[0],ax=base[0]/base[3],ay=base[1]/base[3],area=0;for(i=1;i+1<p.length;++i){var b=p[i],c=p[i+1],ux=b[0]/b[3]-ax,uy=b[1]/b[3]-ay,vx=c[0]/c[3]-ax,vy=c[1]/c[3]-ay;area+=Math.abs(ux*vy-uy*vx)}return area}var CUBE_EDGES=[1,1,1],CUBE_AXIS=[0,0,0],CUBE_RESULT={cubeEdges:CUBE_EDGES,axis:CUBE_AXIS};var _$createLines_148=function __createLines_148(gl,bounds,ticks){var vertices=[],tickOffset=[0,0,0],tickCount=[0,0,0],gridOffset=[0,0,0],gridCount=[0,0,0];vertices.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var i=0;i<3;++i){for(var start=vertices.length/3|0,j=0;j<ticks[i].length;++j){var x=+ticks[i][j].x;vertices.push(x,0,1,x,1,1,x,0,-1,x,0,-1,x,1,1,x,1,-1)}var end=vertices.length/3|0;tickOffset[i]=start,tickCount[i]=end-start;for(var start=vertices.length/3|0,k=0;k<ticks[i].length;++k){var x=+ticks[i][k].x;vertices.push(x,0,1,x,1,1,x,0,-1,x,0,-1,x,1,1,x,1,-1)}var end=vertices.length/3|0;gridOffset[i]=start,gridCount[i]=end-start}var vertBuf=_$createBuffer_153(gl,new Float32Array(vertices)),vao=_$createVAO_222(gl,[{buffer:vertBuf,type:gl.FLOAT,size:3,stride:0,offset:0}]),shader=__createShader_148(gl);return shader.attributes.position.location=0,new __Lines_148(gl,vertBuf,vao,shader,tickCount,tickOffset,gridCount,gridOffset)},__createShader_148=_$shaders_149.line,MAJOR_AXIS=[0,0,0],MINOR_AXIS=[0,0,0],SCREEN_AXIS=[0,0,0],OFFSET_VEC=[0,0,0],SHAPE=[1,1];function zeroVec(a){return a[0]=a[1]=a[2]=0,a}function copyVec(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a}function __Lines_148(gl,vertBuffer,vao,shader,tickCount,tickOffset,gridCount,gridOffset){this.gl=gl,this.vertBuffer=vertBuffer,this.vao=vao,this.shader=shader,this.tickCount=tickCount,this.tickOffset=tickOffset,this.gridCount=gridCount,this.gridOffset=gridOffset}var __proto_148=__Lines_148.prototype;__proto_148.bind=function(model,view,projection){this.shader.bind(),this.shader.uniforms.model=model,this.shader.uniforms.view=view,this.shader.uniforms.projection=projection,SHAPE[0]=this.gl.drawingBufferWidth,SHAPE[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=SHAPE,this.vao.bind()},__proto_148.unbind=function(){this.vao.unbind()},__proto_148.drawAxisLine=function(j,bounds,offset,color,lineWidth){var minorAxis=zeroVec(MINOR_AXIS);this.shader.uniforms.majorAxis=MINOR_AXIS,minorAxis[j]=bounds[1][j]-bounds[0][j],this.shader.uniforms.minorAxis=minorAxis;var screenAxis,noffset=copyVec(OFFSET_VEC,offset);noffset[j]+=bounds[0][j],this.shader.uniforms.offset=noffset,this.shader.uniforms.lineWidth=lineWidth,this.shader.uniforms.color=color,(screenAxis=zeroVec(SCREEN_AXIS))[(j+2)%3]=1,this.shader.uniforms.screenAxis=screenAxis,this.vao.draw(this.gl.TRIANGLES,6),(screenAxis=zeroVec(SCREEN_AXIS))[(j+1)%3]=1,this.shader.uniforms.screenAxis=screenAxis,this.vao.draw(this.gl.TRIANGLES,6)},__proto_148.drawAxisTicks=function(j,offset,minorAxis,color,lineWidth){if(this.tickCount[j]){var majorAxis=zeroVec(MAJOR_AXIS);majorAxis[j]=1,this.shader.uniforms.majorAxis=majorAxis,this.shader.uniforms.offset=offset,this.shader.uniforms.minorAxis=minorAxis,this.shader.uniforms.color=color,this.shader.uniforms.lineWidth=lineWidth;var screenAxis=zeroVec(SCREEN_AXIS);screenAxis[j]=1,this.shader.uniforms.screenAxis=screenAxis,this.vao.draw(this.gl.TRIANGLES,this.tickCount[j],this.tickOffset[j])}},__proto_148.drawGrid=function(i,j,bounds,offset,color,lineWidth){if(this.gridCount[i]){var minorAxis=zeroVec(MINOR_AXIS);minorAxis[j]=bounds[1][j]-bounds[0][j],this.shader.uniforms.minorAxis=minorAxis;var noffset=copyVec(OFFSET_VEC,offset);noffset[j]+=bounds[0][j],this.shader.uniforms.offset=noffset;var majorAxis=zeroVec(MAJOR_AXIS);majorAxis[i]=1,this.shader.uniforms.majorAxis=majorAxis;var screenAxis=zeroVec(SCREEN_AXIS);screenAxis[i]=1,this.shader.uniforms.screenAxis=screenAxis,this.shader.uniforms.lineWidth=lineWidth,this.shader.uniforms.color=color,this.vao.draw(this.gl.TRIANGLES,this.gridCount[i],this.gridOffset[i])}},__proto_148.drawZero=function(j,i,bounds,offset,color,lineWidth){var minorAxis=zeroVec(MINOR_AXIS);this.shader.uniforms.majorAxis=minorAxis,minorAxis[j]=bounds[1][j]-bounds[0][j],this.shader.uniforms.minorAxis=minorAxis;var noffset=copyVec(OFFSET_VEC,offset);noffset[j]+=bounds[0][j],this.shader.uniforms.offset=noffset;var screenAxis=zeroVec(SCREEN_AXIS);screenAxis[i]=1,this.shader.uniforms.screenAxis=screenAxis,this.shader.uniforms.lineWidth=lineWidth,this.shader.uniforms.color=color,this.vao.draw(this.gl.TRIANGLES,6)},__proto_148.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()};var _$createTextSprites_150={};(function(process){"use strict";_$createTextSprites_150=function createTextSprites(gl,bounds,labels,labelFont,ticks,tickFont){var buffer=_$createBuffer_153(gl),vao=_$createVAO_222(gl,[{buffer:buffer,size:3}]),shader=createShader(gl);shader.attributes.position.location=0;var result=new TextSprites(gl,shader,buffer,vao);return result.update(bounds,labels,labelFont,ticks,tickFont),result};var createShader=_$shaders_149.text,globals=window||process.global||{},__TEXT_CACHE=globals.__TEXT_CACHE||{};globals.__TEXT_CACHE={};function TextSprites(gl,shader,buffer,vao){this.gl=gl,this.shader=shader,this.buffer=buffer,this.vao=vao,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}var proto=TextSprites.prototype,SHAPE=[0,0];proto.bind=function(model,view,projection,pixelScale){this.vao.bind(),this.shader.bind();var uniforms=this.shader.uniforms;uniforms.model=model,uniforms.view=view,uniforms.projection=projection,uniforms.pixelScale=pixelScale,SHAPE[0]=this.gl.drawingBufferWidth,SHAPE[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=SHAPE},proto.unbind=function(){this.vao.unbind()},proto.update=function(bounds,labels,labelFont,ticks,tickFont){this.gl;var data=[];function addItem(t,text,font,size){var fontcache=__TEXT_CACHE[font];fontcache||(fontcache=__TEXT_CACHE[font]={});var mesh=fontcache[text];mesh||(mesh=fontcache[text]=function tryVectorizeText(text,options){try{return _$createText_367(text,options)}catch(e){return console.warn("error vectorizing text:",e),{cells:[],positions:[]}}}(text,{triangles:!0,font:font,textAlign:"center",textBaseline:"middle"}));for(var scale=(size||12)/12,positions=mesh.positions,cells=mesh.cells,i=0,nc=cells.length;i<nc;++i)for(var c=cells[i],j=2;j>=0;--j){var p=positions[c[j]];data.push(scale*p[0],-scale*p[1],t)}}for(var tickOffset=[0,0,0],tickCount=[0,0,0],labelOffset=[0,0,0],labelCount=[0,0,0],d=0;d<3;++d){labelOffset[d]=data.length/3|0,addItem(.5*(bounds[0][d]+bounds[1][d]),labels[d],labelFont),labelCount[d]=(data.length/3|0)-labelOffset[d],tickOffset[d]=data.length/3|0;for(var i=0;i<ticks[d].length;++i)ticks[d][i].text&&addItem(ticks[d][i].x,ticks[d][i].text,ticks[d][i].font||tickFont,ticks[d][i].fontSize||12);tickCount[d]=(data.length/3|0)-tickOffset[d]}this.buffer.update(data),this.tickOffset=tickOffset,this.tickCount=tickCount,this.labelOffset=labelOffset,this.labelCount=labelCount};var AXIS=[0,0,0];proto.drawTicks=function(d,scale,angle,offset,color){if(this.tickCount[d]){var v=AXIS;v[0]=v[1]=v[2]=0,v[d]=1,this.shader.uniforms.axis=v,this.shader.uniforms.color=color,this.shader.uniforms.angle=angle,this.shader.uniforms.scale=scale,this.shader.uniforms.offset=offset,this.vao.draw(this.gl.TRIANGLES,this.tickCount[d],this.tickOffset[d])}};var ZERO=[0,0,0];proto.drawLabel=function(d,scale,angle,offset,color){this.labelCount[d]&&(this.shader.uniforms.axis=ZERO,this.shader.uniforms.color=color,this.shader.uniforms.angle=angle,this.shader.uniforms.scale=scale,this.shader.uniforms.offset=offset,this.vao.draw(this.gl.TRIANGLES,this.labelCount[d],this.labelOffset[d]))},proto.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()}}).call(this,_$browser_304);var _$ticks_151={};function prettyPrint(spacing,i){var stepStr=spacing+"",u=stepStr.indexOf("."),sigFigs=0;u>=0&&(sigFigs=stepStr.length-u-1);var shift=Math.pow(10,sigFigs),x=Math.round(spacing*i*shift),xstr=x+"";if(xstr.indexOf("e")>=0)return xstr;var xi=x/shift,xf=x%shift;x<0?(xi=0|-Math.ceil(xi),xf=0|-xf):(xi=0|Math.floor(xi),xf|=0);var xis=""+xi;if(x<0&&(xis="-"+xis),sigFigs){for(var xs=""+xf;xs.length<sigFigs;)xs="0"+xs;return xis+"."+xs}return xis}_$ticks_151.create=function defaultTicks(bounds,tickSpacing){for(var array=[],d=0;d<3;++d){for(var ticks=[],t=(bounds[0][d],bounds[1][d],0);t*tickSpacing[d]<=bounds[1][d];++t)ticks.push({x:t*tickSpacing[d],text:prettyPrint(tickSpacing[d],t)});for(var t=-1;t*tickSpacing[d]>=bounds[0][d];--t)ticks.push({x:t*tickSpacing[d],text:prettyPrint(tickSpacing[d],t)});array.push(ticks)}return array},_$ticks_151.equal=function ticksEqual(ticksA,ticksB){for(var i=0;i<3;++i){if(ticksA[i].length!==ticksB[i].length)return!1;for(var j=0;j<ticksA[i].length;++j){var a=ticksA[i][j],b=ticksB[i][j];if(a.x!==b.x||a.text!==b.text||a.font!==b.font||a.fontColor!==b.fontColor||a.fontSize!==b.fontSize||a.dx!==b.dx||a.dy!==b.dy)return!1}}return!0};var _$createAxes_145=function createAxes(gl,options){var axes=new __Axes_145(gl);return axes.update(options),axes},__identity_145=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function copyVec3(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a}function __Axes_145(gl){this.gl=gl,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=_$createBackgroundCube_146(gl)}var __proto_145=__Axes_145.prototype;function OffsetInfo(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}__proto_145.update=function(options){function parseOption(nest,cons,name){if(name in options){var next,opt=options[name],prev=this[name];(nest?Array.isArray(opt)&&Array.isArray(opt[0]):Array.isArray(opt))?this[name]=next=[cons(opt[0]),cons(opt[1]),cons(opt[2])]:this[name]=next=[cons(opt),cons(opt),cons(opt)];for(var i=0;i<3;++i)if(next[i]!==prev[i])return!0}return!1}options=options||{};var nextTicks,NUMBER=parseOption.bind(this,!1,Number),BOOLEAN=parseOption.bind(this,!1,Boolean),STRING=parseOption.bind(this,!1,String),COLOR=parseOption.bind(this,!0,function(v){if(Array.isArray(v)){if(3===v.length)return[+v[0],+v[1],+v[2],1];if(4===v.length)return[+v[0],+v[1],+v[2],+v[3]]}return[0,0,0,1]}),ticksUpdate=!1,boundsChanged=!1;if("bounds"in options)for(var bounds=options.bounds,i=0;i<2;++i)for(var j=0;j<3;++j)bounds[i][j]!==this.bounds[i][j]&&(boundsChanged=!0),this.bounds[i][j]=bounds[i][j];if("ticks"in options){nextTicks=options.ticks,ticksUpdate=!0,this.autoTicks=!1;for(i=0;i<3;++i)this.tickSpacing[i]=0}else NUMBER("tickSpacing")&&(this.autoTicks=!0,boundsChanged=!0);if(this._firstInit&&("ticks"in options||"tickSpacing"in options||(this.autoTicks=!0),boundsChanged=!0,ticksUpdate=!0,this._firstInit=!1),boundsChanged&&this.autoTicks&&(nextTicks=_$ticks_151.create(this.bounds,this.tickSpacing),ticksUpdate=!0),ticksUpdate){for(i=0;i<3;++i)nextTicks[i].sort(function(a,b){return a.x-b.x});_$ticks_151.equal(nextTicks,this.ticks)?ticksUpdate=!1:this.ticks=nextTicks}BOOLEAN("tickEnable"),STRING("tickFont")&&(ticksUpdate=!0),NUMBER("tickSize"),NUMBER("tickAngle"),NUMBER("tickPad"),COLOR("tickColor");var labelUpdate=STRING("labels");STRING("labelFont")&&(labelUpdate=!0),BOOLEAN("labelEnable"),NUMBER("labelSize"),NUMBER("labelPad"),COLOR("labelColor"),BOOLEAN("lineEnable"),BOOLEAN("lineMirror"),NUMBER("lineWidth"),COLOR("lineColor"),BOOLEAN("lineTickEnable"),BOOLEAN("lineTickMirror"),NUMBER("lineTickLength"),NUMBER("lineTickWidth"),COLOR("lineTickColor"),BOOLEAN("gridEnable"),NUMBER("gridWidth"),COLOR("gridColor"),BOOLEAN("zeroEnable"),COLOR("zeroLineColor"),NUMBER("zeroLineWidth"),BOOLEAN("backgroundEnable"),COLOR("backgroundColor"),this._text?this._text&&(labelUpdate||ticksUpdate)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=_$createTextSprites_150(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&ticksUpdate&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=_$createLines_148(this.gl,this.bounds,this.ticks))};var LINE_OFFSET=[new OffsetInfo,new OffsetInfo,new OffsetInfo];function computeLineOffset(result,i,bounds,cubeEdges,cubeAxis){for(var primalOffset=result.primalOffset,primalMinor=result.primalMinor,dualOffset=result.mirrorOffset,dualMinor=result.mirrorMinor,e=cubeEdges[i],j=0;j<3;++j)if(i!==j){var a=primalOffset,b=dualOffset,c=primalMinor,d=dualMinor;e&1<<j&&(a=dualOffset,b=primalOffset,c=dualMinor,d=primalMinor),a[j]=bounds[0][j],b[j]=bounds[1][j],cubeAxis[j]>0?(c[j]=-1,d[j]=0):(c[j]=0,d[j]=1)}}var CUBE_ENABLE=[0,0,0],DEFAULT_PARAMS={model:__identity_145,view:__identity_145,projection:__identity_145};__proto_145.isOpaque=function(){return!0},__proto_145.isTransparent=function(){return!1},__proto_145.drawTransparent=function(params){};var PRIMAL_MINOR=[0,0,0],MIRROR_MINOR=[0,0,0],PRIMAL_OFFSET=[0,0,0];__proto_145.draw=function(params){params=params||DEFAULT_PARAMS;for(var gl=this.gl,model=params.model||__identity_145,view=params.view||__identity_145,projection=params.projection||__identity_145,bounds=this.bounds,cubeParams=_$getCubeEdges_147(model,view,projection,bounds),cubeEdges=cubeParams.cubeEdges,cubeAxis=cubeParams.axis,cx=view[12],cy=view[13],cz=view[14],cw=view[15],pixelScaleF=this.pixelRatio*(projection[3]*cx+projection[7]*cy+projection[11]*cz+projection[15]*cw)/gl.drawingBufferHeight,i=0;i<3;++i)this.lastCubeProps.cubeEdges[i]=cubeEdges[i],this.lastCubeProps.axis[i]=cubeAxis[i];var lineOffset=LINE_OFFSET;for(i=0;i<3;++i)computeLineOffset(LINE_OFFSET[i],i,this.bounds,cubeEdges,cubeAxis);gl=this.gl;var cubeEnable=CUBE_ENABLE;for(i=0;i<3;++i)this.backgroundEnable[i]?cubeEnable[i]=cubeAxis[i]:cubeEnable[i]=0;this._background.draw(model,view,projection,bounds,cubeEnable,this.backgroundColor),this._lines.bind(model,view,projection,this);for(i=0;i<3;++i){var x=[0,0,0];cubeAxis[i]>0?x[i]=bounds[1][i]:x[i]=bounds[0][i];for(var j=0;j<2;++j){var u=(i+1+j)%3,v=(i+1+(1^j))%3;this.gridEnable[u]&&this._lines.drawGrid(u,v,this.bounds,x,this.gridColor[u],this.gridWidth[u]*this.pixelRatio)}for(j=0;j<2;++j){u=(i+1+j)%3,v=(i+1+(1^j))%3;this.zeroEnable[v]&&bounds[0][v]<=0&&bounds[1][v]>=0&&this._lines.drawZero(u,v,this.bounds,x,this.zeroLineColor[v],this.zeroLineWidth[v]*this.pixelRatio)}}for(i=0;i<3;++i){this.lineEnable[i]&&this._lines.drawAxisLine(i,this.bounds,lineOffset[i].primalOffset,this.lineColor[i],this.lineWidth[i]*this.pixelRatio),this.lineMirror[i]&&this._lines.drawAxisLine(i,this.bounds,lineOffset[i].mirrorOffset,this.lineColor[i],this.lineWidth[i]*this.pixelRatio);var primalMinor=copyVec3(PRIMAL_MINOR,lineOffset[i].primalMinor),mirrorMinor=copyVec3(MIRROR_MINOR,lineOffset[i].mirrorMinor),tickLength=this.lineTickLength;for(j=0;j<3;++j){var scaleFactor=pixelScaleF/model[5*j];primalMinor[j]*=tickLength[j]*scaleFactor,mirrorMinor[j]*=tickLength[j]*scaleFactor}this.lineTickEnable[i]&&this._lines.drawAxisTicks(i,lineOffset[i].primalOffset,primalMinor,this.lineTickColor[i],this.lineTickWidth[i]*this.pixelRatio),this.lineTickMirror[i]&&this._lines.drawAxisTicks(i,lineOffset[i].mirrorOffset,mirrorMinor,this.lineTickColor[i],this.lineTickWidth[i]*this.pixelRatio)}this._lines.unbind(),this._text.bind(model,view,projection,this.pixelRatio);for(i=0;i<3;++i){var minor=lineOffset[i].primalMinor,offset=copyVec3(PRIMAL_OFFSET,lineOffset[i].primalOffset);for(j=0;j<3;++j)this.lineTickEnable[i]&&(offset[j]+=pixelScaleF*minor[j]*Math.max(this.lineTickLength[j],0)/model[5*j]);if(this.tickEnable[i]){for(j=0;j<3;++j)offset[j]+=pixelScaleF*minor[j]*this.tickPad[j]/model[5*j];this._text.drawTicks(i,this.tickSize[i],this.tickAngle[i],offset,this.tickColor[i])}if(this.labelEnable[i]){for(j=0;j<3;++j)offset[j]+=pixelScaleF*minor[j]*this.labelPad[j]/model[5*j];offset[i]+=.5*(bounds[0][i]+bounds[1][i]),this._text.drawLabel(i,this.labelSize[i],this.labelAngle[i],offset,this.labelColor[i])}}this._text.unbind()},__proto_145.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null};var _$extractPlanes_138=function extractPlanes(M,zNear,zFar){var z=zNear||0,zf=zFar||1;return[[M[12]+M[0],M[13]+M[1],M[14]+M[2],M[15]+M[3]],[M[12]-M[0],M[13]-M[1],M[14]-M[2],M[15]-M[3]],[M[12]+M[4],M[13]+M[5],M[14]+M[6],M[15]+M[7]],[M[12]-M[4],M[13]-M[5],M[14]-M[6],M[15]-M[7]],[z*M[12]+M[8],z*M[13]+M[9],z*M[14]+M[10],z*M[15]+M[11]],[zf*M[12]-M[8],zf*M[13]-M[9],zf*M[14]-M[10],zf*M[15]-M[11]]]};var _$transformMat4_228=function transformMat4(out,a,m){var x=a[0],y=a[1],z=a[2],w=a[3];return out[0]=m[0]*x+m[4]*y+m[8]*z+m[12]*w,out[1]=m[1]*x+m[5]*y+m[9]*z+m[13]*w,out[2]=m[2]*x+m[6]*y+m[10]*z+m[14]*w,out[3]=m[3]*x+m[7]*y+m[11]*z+m[15]*w,out};var _$axesProperties_152=function axesProperties(axes,camera,width,height,params){var model=camera.model||__identity_152,view=camera.view||__identity_152,projection=camera.projection||__identity_152,bounds=axes.bounds,axis=(params=params||_$getCubeEdges_147(model,view,projection,bounds)).axis;params.edges;_$multiply_175(__mvp_152,view,model),_$multiply_175(__mvp_152,projection,__mvp_152);for(var ranges=RANGES,i=0;i<3;++i)ranges[i].lo=1/0,ranges[i].hi=-1/0,ranges[i].pixelsPerDataUnit=1/0;var frustum=_$extractPlanes_138(_$transpose_183(__mvp_152,__mvp_152));_$transpose_183(__mvp_152,__mvp_152);for(var d=0;d<3;++d){var u=(d+1)%3,v=(d+2)%3,x=SCRATCH_X;i_loop:for(var i=0;i<2;++i){var poly=[];if(axis[d]<0!=!!i){x[d]=bounds[i][d];for(var j=0;j<2;++j){x[u]=bounds[j^i][u];for(var k=0;k<2;++k)x[v]=bounds[k^j^i][v],poly.push(x.slice())}for(var j=0;j<frustum.length;++j){if(0===poly.length)continue i_loop;poly=_$clipPoly_342.positive(poly,frustum[j])}for(var j=0;j<poly.length;++j)for(var v=poly[j],grad=gradient(SCRATCH_X,__mvp_152,v,width,height),k=0;k<3;++k)ranges[k].lo=Math.min(ranges[k].lo,v[k]),ranges[k].hi=Math.max(ranges[k].hi,v[k]),k!==d&&(ranges[k].pixelsPerDataUnit=Math.min(ranges[k].pixelsPerDataUnit,Math.abs(grad[k])))}}}return ranges},__identity_152=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),__mvp_152=new Float32Array(16);function AxesRange3D(lo,hi,pixelsPerDataUnit){this.lo=lo,this.hi=hi,this.pixelsPerDataUnit=pixelsPerDataUnit}var SCRATCH_P=[0,0,0,1],SCRATCH_Q=[0,0,0,1];function gradient(result,M,v,width,height){for(var i=0;i<3;++i){for(var p=SCRATCH_P,q=SCRATCH_Q,j=0;j<3;++j)q[j]=p[j]=v[j];q[3]=p[3]=1,q[i]+=1,_$transformMat4_228(q,q,M),q[3]<0&&(result[i]=1/0),p[i]-=1,_$transformMat4_228(p,p,M),p[3]<0&&(result[i]=1/0);var dx=(p[0]/p[3]-q[0]/q[3])*width,dy=(p[1]/p[3]-q[1]/q[3])*height;result[i]=.25*Math.sqrt(dx*dx+dy*dy)}return result}var RANGES=[new AxesRange3D(1/0,-1/0,1/0),new AxesRange3D(1/0,-1/0,1/0),new AxesRange3D(1/0,-1/0,1/0)],SCRATCH_X=[0,0,0];var _$perspective_176=function perspective(out,fovy,aspect,near,far){var f=1/Math.tan(fovy/2),nf=1/(near-far);return out[0]=f/aspect,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=f,out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[10]=(far+near)*nf,out[11]=-1,out[12]=0,out[13]=0,out[14]=2*far*near*nf,out[15]=0,out};var vertSrc=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\nattribute vec2 position;\nvarying vec2 uv;\nvoid main() {\n  uv = position;\n  gl_Position = vec4(position, 0, 1);\n}"]),fragSrc=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D accumBuffer;\nvarying vec2 uv;\n\nvoid main() {\n  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));\n  gl_FragColor = min(vec4(1,1,1,1), accum);\n}"]),_$shader_195=function(gl){return _$createShader_206(gl,vertSrc,fragSrc,null,[{name:"position",type:"vec2"}])},__vertSrc_214=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, color;\nattribute float weight;\n\nuniform mat4 model, view, projection;\nuniform vec3 coordinates[3];\nuniform vec4 colors[3];\nuniform vec2 screenShape;\nuniform float lineWidth;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vertexPosition = mix(coordinates[0],\n    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));\n\n  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);\n  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;\n  vec2 delta = weight * clipOffset * screenShape;\n  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;\n\n  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);\n  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];\n}\n"]),__fragSrc_214=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n  gl_FragColor = fragColor;\n}"]),_$shaders_214=function(gl){return _$createShader_206(gl,__vertSrc_214,__fragSrc_214,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])},_$createSpikes_215=function __createSpikes_215(gl,options){var data=[];function line(x,y,z,i,l,h){var row=[x,y,z,0,0,0,1];row[i+3]=1,row[i]=l,data.push.apply(data,row),row[6]=-1,data.push.apply(data,row),row[i]=h,data.push.apply(data,row),data.push.apply(data,row),row[6]=1,data.push.apply(data,row),row[i]=l,data.push.apply(data,row)}line(0,0,0,0,0,1),line(0,0,0,1,0,1),line(0,0,0,2,0,1),line(1,0,0,1,-1,1),line(1,0,0,2,-1,1),line(0,1,0,0,-1,1),line(0,1,0,2,-1,1),line(0,0,1,0,-1,1),line(0,0,1,1,-1,1);var buffer=_$createBuffer_153(gl,data),vao=_$createVAO_222(gl,[{type:gl.FLOAT,buffer:buffer,size:3,offset:0,stride:28},{type:gl.FLOAT,buffer:buffer,size:3,offset:12,stride:28},{type:gl.FLOAT,buffer:buffer,size:1,offset:24,stride:28}]),shader=_$shaders_214(gl);shader.attributes.position.location=0,shader.attributes.color.location=1,shader.attributes.weight.location=2;var spikes=new AxisSpikes(gl,buffer,vao,shader);return spikes.update(options),spikes},__identity_215=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function AxisSpikes(gl,buffer,vao,shader){this.gl=gl,this.buffer=buffer,this.vao=vao,this.shader=shader,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var __proto_215=AxisSpikes.prototype,OUTER_FACE=[0,0,0],INNER_FACE=[0,0,0],__SHAPE_215=[0,0];__proto_215.isTransparent=function(){return!1},__proto_215.drawTransparent=function(camera){},__proto_215.draw=function(camera){var gl=this.gl,vao=this.vao,shader=this.shader;vao.bind(),shader.bind();var axis,model=camera.model||__identity_215,view=camera.view||__identity_215,projection=camera.projection||__identity_215;this.axes&&(axis=this.axes.lastCubeProps.axis);for(var outerFace=OUTER_FACE,innerFace=INNER_FACE,i=0;i<3;++i)axis&&axis[i]<0?(outerFace[i]=this.bounds[0][i],innerFace[i]=this.bounds[1][i]):(outerFace[i]=this.bounds[1][i],innerFace[i]=this.bounds[0][i]);__SHAPE_215[0]=gl.drawingBufferWidth,__SHAPE_215[1]=gl.drawingBufferHeight,shader.uniforms.model=model,shader.uniforms.view=view,shader.uniforms.projection=projection,shader.uniforms.coordinates=[this.position,outerFace,innerFace],shader.uniforms.colors=this.colors,shader.uniforms.screenShape=__SHAPE_215;for(i=0;i<3;++i)shader.uniforms.lineWidth=this.lineWidth[i]*this.pixelRatio,this.enabled[i]&&(vao.draw(gl.TRIANGLES,6,6*i),this.drawSides[i]&&vao.draw(gl.TRIANGLES,12,18+12*i));vao.unbind()},__proto_215.update=function(options){options&&("bounds"in options&&(this.bounds=options.bounds),"position"in options&&(this.position=options.position),"lineWidth"in options&&(this.lineWidth=options.lineWidth),"colors"in options&&(this.colors=options.colors),"enabled"in options&&(this.enabled=options.enabled),"drawSides"in options&&(this.drawSides=options.drawSides))},__proto_215.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()};var _$createScene_196=function createScene(options){var stopped=!1,canvas=((options=options||{}).pixelRatio||parseFloat(window.devicePixelRatio),options.canvas);if(!canvas)if(canvas=document.createElement("canvas"),options.container){var container=options.container;container.appendChild(canvas)}else document.body.appendChild(canvas);var gl=options.gl;gl||(gl=function __getContext_196(canvas,options){var gl=null;try{(gl=canvas.getContext("webgl",options))||(gl=canvas.getContext("experimental-webgl",options))}catch(e){return null}return gl}(canvas,options.glOptions||{premultipliedAlpha:!0,antialias:!0}));if(!gl)throw new Error("webgl not supported");var bounds=options.bounds||[[-10,-10,-10],[10,10,10]],selection=new function MouseSelect(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null},accumBuffer=_$createFBO_158(gl,[gl.drawingBufferWidth,gl.drawingBufferHeight],{preferFloat:!__isMobile_196}),accumShader=_$shader_195(gl),cameraOptions=options.camera||{eye:[2,0,0],center:[0,0,0],up:[0,1,0],zoomMin:.1,zoomMax:100,mode:"turntable"},axesOptions=options.axes||{},axes=_$createAxes_145(gl,axesOptions);axes.enable=!axesOptions.disable;var spikeOptions=options.spikes||{},spikes=_$createSpikes_215(gl,spikeOptions),objects=[],pickBufferIds=[],pickBufferCount=[],pickBuffers=[],dirty=!0,pickDirty=!0,projection=new Array(16),model=new Array(16),cameraParams={view:null,projection:projection,model:model},pickDirty=!0,viewShape=[gl.drawingBufferWidth,gl.drawingBufferHeight],scene={gl:gl,contextLost:!1,pixelRatio:options.pixelRatio||parseFloat(window.devicePixelRatio),canvas:canvas,selection:selection,camera:_$createCamera_39(canvas,cameraOptions),axes:axes,axesPixels:null,spikes:spikes,bounds:bounds,objects:objects,shape:viewShape,aspect:options.aspectRatio||[1,1,1],pickRadius:options.pickRadius||10,zNear:options.zNear||.01,zFar:options.zFar||1e3,fovy:options.fovy||Math.PI/4,clearColor:options.clearColor||[0,0,0,0],autoResize:defaultBool(options.autoResize),autoBounds:defaultBool(options.autoBounds),autoScale:!!options.autoScale,autoCenter:defaultBool(options.autoCenter),clipToBounds:defaultBool(options.clipToBounds),snapToData:!!options.snapToData,onselect:options.onselect||null,onrender:options.onrender||null,onclick:options.onclick||null,cameraParams:cameraParams,oncontextloss:null,mouseListener:null},pickShape=[gl.drawingBufferWidth/scene.pixelRatio|0,gl.drawingBufferHeight/scene.pixelRatio|0];function resizeListener(){if(!stopped&&scene.autoResize){var parent=canvas.parentNode,width=1,height=1;parent&&parent!==document.body?(width=parent.clientWidth,height=parent.clientHeight):(width=window.innerWidth,height=window.innerHeight);var nextWidth=0|Math.ceil(width*scene.pixelRatio),nextHeight=0|Math.ceil(height*scene.pixelRatio);if(nextWidth!==canvas.width||nextHeight!==canvas.height){canvas.width=nextWidth,canvas.height=nextHeight;var style=canvas.style;style.position=style.position||"absolute",style.left="0px",style.top="0px",style.width=width+"px",style.height=height+"px",dirty=!0}}}scene.autoResize&&resizeListener();function reallocPickIds(){for(var numObjs=objects.length,numPick=pickBuffers.length,i=0;i<numPick;++i)pickBufferCount[i]=0;obj_loop:for(var i=0;i<numObjs;++i){var obj=objects[i],pickCount=obj.pickSlots;if(pickCount){for(var j=0;j<numPick;++j)if(pickBufferCount[j]+pickCount<255){pickBufferIds[i]=j,obj.setPickBase(pickBufferCount[j]+1),pickBufferCount[j]+=pickCount;continue obj_loop}var nbuffer=_$createSelectBuffer_205(gl,viewShape);pickBufferIds[i]=numPick,pickBuffers.push(nbuffer),pickBufferCount.push(pickCount),obj.setPickBase(1),numPick+=1}else pickBufferIds[i]=-1}for(;numPick>0&&0===pickBufferCount[numPick-1];)pickBufferCount.pop(),pickBuffers.pop().dispose()}window.addEventListener("resize",resizeListener),scene.update=function(options){stopped||(options=options||{},dirty=!0,pickDirty=!0)},scene.add=function(obj){stopped||(obj.axes=axes,objects.push(obj),pickBufferIds.push(-1),dirty=!0,pickDirty=!0,reallocPickIds())},scene.remove=function(obj){if(!stopped){var idx=objects.indexOf(obj);idx<0||(objects.splice(idx,1),pickBufferIds.pop(),dirty=!0,pickDirty=!0,reallocPickIds())}},scene.dispose=function(){if(!stopped&&(stopped=!0,window.removeEventListener("resize",resizeListener),canvas.removeEventListener("webglcontextlost",checkContextLoss),scene.mouseListener.enabled=!1,!scene.contextLost)){axes.dispose(),spikes.dispose();for(var i=0;i<objects.length;++i)objects[i].dispose();accumBuffer.dispose();for(var i=0;i<pickBuffers.length;++i)pickBuffers[i].dispose();accumShader.dispose(),gl=null,axes=null,spikes=null,objects=[]}};var mouseRotating=!1,prevButtons=0;function checkContextLoss(){if(scene.contextLost)return!0;gl.isContextLost()&&(scene.contextLost=!0,scene.mouseListener.enabled=!1,scene.selection.object=null,scene.oncontextloss&&scene.oncontextloss())}scene.mouseListener=_$mouseListen_262(canvas,function(buttons,x,y){if(!stopped){var numPick=pickBuffers.length,numObjs=objects.length,prevObj=selection.object;selection.distance=1/0,selection.mouse[0]=x,selection.mouse[1]=y,selection.object=null,selection.screen=null,selection.dataCoordinate=selection.dataPosition=null;var change=!1;if(buttons&&prevButtons)mouseRotating=!0;else{mouseRotating&&(pickDirty=!0),mouseRotating=!1;for(var i=0;i<numPick;++i){var result=pickBuffers[i].query(x,pickShape[1]-y-1,scene.pickRadius);if(result){if(result.distance>selection.distance)continue;for(var j=0;j<numObjs;++j){var obj=objects[j];if(pickBufferIds[j]===i){var objPick=obj.pick(result);objPick&&(selection.buttons=buttons,selection.screen=result.coord,selection.distance=result.distance,selection.object=obj,selection.index=objPick.distance,selection.dataPosition=objPick.position,selection.dataCoordinate=objPick.dataCoordinate,selection.data=objPick,change=!0)}}}}}prevObj&&prevObj!==selection.object&&(prevObj.highlight&&prevObj.highlight(null),dirty=!0),selection.object&&(selection.object.highlight&&selection.object.highlight(selection.data),dirty=!0),(change=change||selection.object!==prevObj)&&scene.onselect&&scene.onselect(selection),1&buttons&&!(1&prevButtons)&&scene.onclick&&scene.onclick(selection),prevButtons=buttons}}),canvas.addEventListener("webglcontextlost",checkContextLoss);var nBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],prevBounds=[nBounds[0].slice(),nBounds[1].slice()];function redraw(){if(!checkContextLoss()){resizeListener();var cameraMoved=scene.camera.tick();cameraParams.view=scene.camera.matrix,dirty=dirty||cameraMoved,pickDirty=pickDirty||cameraMoved,axes.pixelRatio=scene.pixelRatio,spikes.pixelRatio=scene.pixelRatio;var numObjs=objects.length,lo=nBounds[0],hi=nBounds[1];lo[0]=lo[1]=lo[2]=1/0,hi[0]=hi[1]=hi[2]=-1/0;for(var i=0;i<numObjs;++i){var obj=objects[i];obj.pixelRatio=scene.pixelRatio,obj.axes=scene.axes,dirty=dirty||!!obj.dirty,pickDirty=pickDirty||!!obj.dirty;var obb=obj.bounds;if(obb)for(var olo=obb[0],ohi=obb[1],j=0;j<3;++j)lo[j]=Math.min(lo[j],olo[j]),hi[j]=Math.max(hi[j],ohi[j])}var bounds=scene.bounds;if(scene.autoBounds)for(var j=0;j<3;++j){if(hi[j]<lo[j])lo[j]=-1,hi[j]=1;else{lo[j]===hi[j]&&(lo[j]-=1,hi[j]+=1);var padding=.05*(hi[j]-lo[j]);lo[j]=lo[j]-padding,hi[j]=hi[j]+padding}bounds[0][j]=lo[j],bounds[1][j]=hi[j]}for(var boundsChanged=!1,j=0;j<3;++j)boundsChanged=boundsChanged||prevBounds[0][j]!==bounds[0][j]||prevBounds[1][j]!==bounds[1][j],prevBounds[0][j]=bounds[0][j],prevBounds[1][j]=bounds[1][j];if(pickDirty=pickDirty||boundsChanged,dirty=dirty||boundsChanged){if(boundsChanged){for(var tickSpacing=[0,0,0],i=0;i<3;++i)tickSpacing[i]=roundUpPow10((bounds[1][i]-bounds[0][i])/10);axes.autoTicks?axes.update({bounds:bounds,tickSpacing:tickSpacing}):axes.update({bounds:bounds})}var width=gl.drawingBufferWidth,height=gl.drawingBufferHeight;viewShape[0]=width,viewShape[1]=height,pickShape[0]=0|Math.max(width/scene.pixelRatio,1),pickShape[1]=0|Math.max(height/scene.pixelRatio,1),_$perspective_176(projection,scene.fovy,width/height,scene.zNear,scene.zFar);for(var i=0;i<16;++i)model[i]=0;model[15]=1;for(var maxS=0,i=0;i<3;++i)maxS=Math.max(maxS,bounds[1][i]-bounds[0][i]);for(var i=0;i<3;++i)scene.autoScale?model[5*i]=scene.aspect[i]/(bounds[1][i]-bounds[0][i]):model[5*i]=1/maxS,scene.autoCenter&&(model[12+i]=.5*-model[5*i]*(bounds[0][i]+bounds[1][i]));for(var i=0;i<numObjs;++i){var obj=objects[i];obj.axesBounds=bounds,scene.clipToBounds&&(obj.clipBounds=bounds)}selection.object&&(scene.snapToData?spikes.position=selection.dataCoordinate:spikes.position=selection.dataPosition,spikes.bounds=bounds),pickDirty&&(pickDirty=!1,function renderPick(){if(checkContextLoss())return;gl.colorMask(!0,!0,!0,!0),gl.depthMask(!0),gl.disable(gl.BLEND),gl.enable(gl.DEPTH_TEST);for(var numObjs=objects.length,numPick=pickBuffers.length,j=0;j<numPick;++j){var buf=pickBuffers[j];buf.shape=pickShape,buf.begin();for(var i=0;i<numObjs;++i)if(pickBufferIds[i]===j){var obj=objects[i];obj.drawPick&&(obj.pixelRatio=1,obj.drawPick(cameraParams))}buf.end()}}()),scene.axesPixels=_$axesProperties_152(scene.axes,cameraParams,width,height),scene.onrender&&scene.onrender(),gl.bindFramebuffer(gl.FRAMEBUFFER,null),gl.viewport(0,0,width,height);var clearColor=scene.clearColor;gl.clearColor(clearColor[0],clearColor[1],clearColor[2],clearColor[3]),gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT),gl.depthMask(!0),gl.colorMask(!0,!0,!0,!0),gl.enable(gl.DEPTH_TEST),gl.depthFunc(gl.LEQUAL),gl.disable(gl.BLEND),gl.disable(gl.CULL_FACE);var hasTransparent=!1;axes.enable&&(hasTransparent=hasTransparent||axes.isTransparent(),axes.draw(cameraParams)),spikes.axes=axes,selection.object&&spikes.draw(cameraParams),gl.disable(gl.CULL_FACE);for(var i=0;i<numObjs;++i){var obj=objects[i];obj.axes=axes,obj.pixelRatio=scene.pixelRatio,obj.isOpaque&&obj.isOpaque()&&obj.draw(cameraParams),obj.isTransparent&&obj.isTransparent()&&(hasTransparent=!0)}if(hasTransparent){accumBuffer.shape=viewShape,accumBuffer.bind(),gl.clear(gl.DEPTH_BUFFER_BIT),gl.colorMask(!1,!1,!1,!1),gl.depthMask(!0),gl.depthFunc(gl.LESS),axes.enable&&axes.isTransparent()&&axes.drawTransparent(cameraParams);for(var i=0;i<numObjs;++i){var obj=objects[i];obj.isOpaque&&obj.isOpaque()&&obj.draw(cameraParams)}gl.enable(gl.BLEND),gl.blendEquation(gl.FUNC_ADD),gl.blendFunc(gl.ONE,gl.ONE_MINUS_SRC_ALPHA),gl.colorMask(!0,!0,!0,!0),gl.depthMask(!1),gl.clearColor(0,0,0,0),gl.clear(gl.COLOR_BUFFER_BIT),axes.isTransparent()&&axes.drawTransparent(cameraParams);for(var i=0;i<numObjs;++i){var obj=objects[i];obj.isTransparent&&obj.isTransparent()&&obj.drawTransparent(cameraParams)}gl.bindFramebuffer(gl.FRAMEBUFFER,null),gl.blendFunc(gl.ONE,gl.ONE_MINUS_SRC_ALPHA),gl.disable(gl.DEPTH_TEST),accumShader.bind(),accumBuffer.color[0].bind(0),accumShader.uniforms.accumBuffer=0,_$createABigTriangle_42(gl),gl.disable(gl.BLEND)}dirty=!1;for(var i=0;i<numObjs;++i)objects[i].dirty=!1}}}return function render(){stopped||scene.contextLost||(requestAnimationFrame(render),redraw())}(),scene.redraw=function(){stopped||(dirty=!0,redraw())},scene},__isMobile_196=function isMobile(ua){ua||"undefined"==typeof navigator||(ua=navigator.userAgent);ua&&ua.headers&&"string"==typeof ua.headers["user-agent"]&&(ua=ua.headers["user-agent"]);return"string"==typeof ua&&(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(ua)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(ua.substr(0,4)))}();function roundUpPow10(x){var y=Math.round(Math.log(Math.abs(x))/Math.log(10));if(y<0){var base=Math.round(Math.pow(10,-y));return Math.ceil(x*base)/base}if(y>0){base=Math.round(Math.pow(10,y));return Math.ceil(x/base)*base}return Math.ceil(x)}function defaultBool(x){return"boolean"!=typeof x||x}var _$createCamera_626=function __createCamera_626(element,options){element=element||document.body,options=options||{};var limits=[.01,1/0];"distanceLimits"in options&&(limits[0]=options.distanceLimits[0],limits[1]=options.distanceLimits[1]);"zoomMin"in options&&(limits[0]=options.zoomMin);"zoomMax"in options&&(limits[1]=options.zoomMax);var view=_$createViewController_40({center:options.center||[0,0,0],up:options.up||[0,1,0],eye:options.eye||[0,0,10],mode:options.mode||"orbit",distanceLimits:limits}),pmatrix=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],distance=0,width=element.clientWidth,height=element.clientHeight,camera={keyBindingMode:"rotate",view:view,element:element,delay:options.delay||16,rotateSpeed:options.rotateSpeed||1,zoomSpeed:options.zoomSpeed||1,translateSpeed:options.translateSpeed||1,flipX:!!options.flipX,flipY:!!options.flipY,modes:view.modes,tick:function(){var t=_$browser_317(),delay=this.delay,ctime=t-2*delay;view.idle(t-delay),view.recalcMatrix(ctime),view.flush(t-(100+2*delay));for(var allEqual=!0,matrix=view.computedMatrix,i=0;i<16;++i)allEqual=allEqual&&pmatrix[i]===matrix[i],pmatrix[i]=matrix[i];var sizeChanged=element.clientWidth===width&&element.clientHeight===height;return width=element.clientWidth,height=element.clientHeight,allEqual?!sizeChanged:(distance=Math.exp(view.computedRadius[0]),!0)},lookAt:function(center,eye,up){view.lookAt(view.lastT(),center,eye,up)},rotate:function(pitch,yaw,roll){view.rotate(view.lastT(),pitch,yaw,roll)},pan:function(dx,dy,dz){view.pan(view.lastT(),dx,dy,dz)},translate:function(dx,dy,dz){view.translate(view.lastT(),dx,dy,dz)}};Object.defineProperties(camera,{matrix:{get:function(){return view.computedMatrix},set:function(mat){return view.setMatrix(view.lastT(),mat),view.computedMatrix},enumerable:!0},mode:{get:function(){return view.getMode()},set:function(mode){var curUp=view.computedUp.slice(),curEye=view.computedEye.slice(),curCenter=view.computedCenter.slice();if(view.setMode(mode),"turntable"===mode){var t0=_$browser_317();view._active.lookAt(t0,curEye,curCenter,curUp),view._active.lookAt(t0+500,curEye,curCenter,[0,0,1]),view._active.flush(t0)}return view.getMode()},enumerable:!0},center:{get:function(){return view.computedCenter},set:function(ncenter){return view.lookAt(view.lastT(),null,ncenter),view.computedCenter},enumerable:!0},eye:{get:function(){return view.computedEye},set:function(neye){return view.lookAt(view.lastT(),neye),view.computedEye},enumerable:!0},up:{get:function(){return view.computedUp},set:function(nup){return view.lookAt(view.lastT(),null,null,nup),view.computedUp},enumerable:!0},distance:{get:function(){return distance},set:function(d){return view.setDistance(view.lastT(),d),d},enumerable:!0},distanceLimits:{get:function(){return view.getDistanceLimits(limits)},set:function(v){return view.setDistanceLimits(v),v},enumerable:!0}}),element.addEventListener("contextmenu",function(ev){return ev.preventDefault(),!1});var lastX=0,lastY=0,lastMods={shift:!1,control:!1,alt:!1,meta:!1};function handleInteraction(buttons,x,y,mods){var keyBindingMode=camera.keyBindingMode;if(!1!==keyBindingMode){var rotate="rotate"===keyBindingMode,pan="pan"===keyBindingMode,zoom="zoom"===keyBindingMode,ctrl=!!mods.control,alt=!!mods.alt,shift=!!mods.shift,left=!!(1&buttons),right=!!(2&buttons),middle=!!(4&buttons),scale=1/element.clientHeight,dx=scale*(x-lastX),dy=scale*(y-lastY),flipX=camera.flipX?1:-1,flipY=camera.flipY?1:-1,t=_$browser_317(),drot=Math.PI*camera.rotateSpeed;if((rotate&&left&&!ctrl&&!alt&&!shift||left&&!ctrl&&!alt&&shift)&&view.rotate(t,flipX*drot*dx,-flipY*drot*dy,0),(pan&&left&&!ctrl&&!alt&&!shift||right||left&&ctrl&&!alt&&!shift)&&view.pan(t,-camera.translateSpeed*dx*distance,camera.translateSpeed*dy*distance,0),zoom&&left&&!ctrl&&!alt&&!shift||middle||left&&!ctrl&&alt&&!shift){var kzoom=-camera.zoomSpeed*dy/window.innerHeight*(t-view.lastT())*100;view.pan(t,0,0,distance*(Math.exp(kzoom)-1))}return lastX=x,lastY=y,lastMods=mods,!0}}return camera.mouseListener=_$mouseListen_262(element,handleInteraction),element.addEventListener("touchstart",function(ev){var xy=_$mouseEventOffset_263(ev.changedTouches[0],element);handleInteraction(0,xy[0],xy[1],lastMods),handleInteraction(1,xy[0],xy[1],lastMods),ev.preventDefault()},!!_$hasPassiveEvents_240&&{passive:!1}),element.addEventListener("touchmove",function(ev){var xy=_$mouseEventOffset_263(ev.changedTouches[0],element);handleInteraction(1,xy[0],xy[1],lastMods),ev.preventDefault()},!!_$hasPassiveEvents_240&&{passive:!1}),element.addEventListener("touchend",function(ev){handleInteraction(0,lastX,lastY,lastMods),ev.preventDefault()},!!_$hasPassiveEvents_240&&{passive:!1}),camera.wheelListener=_$mouseWheelListen_265(element,function(dx,dy){if(!1!==camera.keyBindingMode){var flipX=camera.flipX?1:-1,flipY=camera.flipY?1:-1,t=_$browser_317();if(Math.abs(dx)>Math.abs(dy))view.rotate(t,0,0,-dx*flipX*Math.PI*camera.rotateSpeed/window.innerWidth);else{var kzoom=-camera.zoomSpeed*flipY*dy/window.innerHeight*(t-view.lastT())/20;view.pan(t,0,0,distance*(Math.exp(kzoom)-1))}}},!0),camera};var AXES_NAMES=["xaxis","yaxis","zaxis"];function AxesOptions(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}AxesOptions.prototype.merge=function(sceneLayout){for(var i=0;i<3;++i){var axes=sceneLayout[AXES_NAMES[i]];axes.visible?(this.labels[i]=_$convertHTMLToUnicode_537(axes.title),"titlefont"in axes&&(axes.titlefont.color&&(this.labelColor[i]=_$str2RgbaArray_561(axes.titlefont.color)),axes.titlefont.family&&(this.labelFont[i]=axes.titlefont.family),axes.titlefont.size&&(this.labelSize[i]=axes.titlefont.size)),"showline"in axes&&(this.lineEnable[i]=axes.showline),"linecolor"in axes&&(this.lineColor[i]=_$str2RgbaArray_561(axes.linecolor)),"linewidth"in axes&&(this.lineWidth[i]=axes.linewidth),"showgrid"in axes&&(this.gridEnable[i]=axes.showgrid),"gridcolor"in axes&&(this.gridColor[i]=_$str2RgbaArray_561(axes.gridcolor)),"gridwidth"in axes&&(this.gridWidth[i]=axes.gridwidth),"log"===axes.type?this.zeroEnable[i]=!1:"zeroline"in axes&&(this.zeroEnable[i]=axes.zeroline),"zerolinecolor"in axes&&(this.zeroLineColor[i]=_$str2RgbaArray_561(axes.zerolinecolor)),"zerolinewidth"in axes&&(this.zeroLineWidth[i]=axes.zerolinewidth),"ticks"in axes&&axes.ticks?this.lineTickEnable[i]=!0:this.lineTickEnable[i]=!1,"ticklen"in axes&&(this.lineTickLength[i]=this._defaultLineTickLength[i]=axes.ticklen),"tickcolor"in axes&&(this.lineTickColor[i]=_$str2RgbaArray_561(axes.tickcolor)),"tickwidth"in axes&&(this.lineTickWidth[i]=axes.tickwidth),"tickangle"in axes&&(this.tickAngle[i]="auto"===axes.tickangle?0:Math.PI*-axes.tickangle/180),"showticklabels"in axes&&(this.tickEnable[i]=axes.showticklabels),"tickfont"in axes&&(axes.tickfont.color&&(this.tickColor[i]=_$str2RgbaArray_561(axes.tickfont.color)),axes.tickfont.family&&(this.tickFont[i]=axes.tickfont.family),axes.tickfont.size&&(this.tickSize[i]=axes.tickfont.size)),"mirror"in axes?-1!==["ticks","all","allticks"].indexOf(axes.mirror)?(this.lineTickMirror[i]=!0,this.lineMirror[i]=!0):!0===axes.mirror?(this.lineTickMirror[i]=!1,this.lineMirror[i]=!0):(this.lineTickMirror[i]=!1,this.lineMirror[i]=!1):this.lineMirror[i]=!1,"showbackground"in axes&&!1!==axes.showbackground?(this.backgroundEnable[i]=!0,this.backgroundColor[i]=_$str2RgbaArray_561(axes.backgroundcolor)):this.backgroundEnable[i]=!1):(this.tickEnable[i]=!1,this.labelEnable[i]=!1,this.lineEnable[i]=!1,this.lineTickEnable[i]=!1,this.gridEnable[i]=!1,this.zeroEnable[i]=!1,this.backgroundEnable[i]=!1)}};var _$createAxesOptions_631=function createAxesOptions(plotlyOptions){var result=new AxesOptions;return result.merge(plotlyOptions),result},__AXES_NAMES_634=["xaxis","yaxis","zaxis"];function SpikeOptions(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}SpikeOptions.prototype.merge=function(sceneLayout){for(var i=0;i<3;++i){var axes=sceneLayout[__AXES_NAMES_634[i]];axes.visible?(this.enabled[i]=axes.showspikes,this.colors[i]=_$str2RgbaArray_561(axes.spikecolor),this.drawSides[i]=axes.spikesides,this.lineWidth[i]=axes.spikethickness):(this.enabled[i]=!1,this.drawSides[i]=!1)}};var __STATIC_CANVAS_637,__STATIC_CONTEXT_637,_$createSpikeOptions_634=function createSpikeOptions(layout){var result=new SpikeOptions;return result.merge(layout),result},_$computeTickMarks_635=function computeTickMarks(scene){for(var axesOptions=scene.axesOptions,glRange=scene.glplot.axesPixels,sceneLayout=scene.fullSceneLayout,ticks=[[],[],[]],i=0;i<3;++i){var axes=sceneLayout[__AXES_NAMES_635[i]];if(axes._length=(glRange[i].hi-glRange[i].lo)*glRange[i].pixelsPerDataUnit/scene.dataScale[i],Math.abs(axes._length)===1/0)ticks[i]=[];else{axes._input_range=axes.range.slice(),axes.range[0]=glRange[i].lo/scene.dataScale[i],axes.range[1]=glRange[i].hi/scene.dataScale[i],axes._m=1/(scene.dataScale[i]*glRange[i].pixelsPerDataUnit),axes.range[0]===axes.range[1]&&(axes.range[0]-=1,axes.range[1]+=1);var tickModeCached=axes.tickmode;if("auto"===axes.tickmode){axes.tickmode="linear";var nticks=axes.nticks||_$lib_539.constrain(axes._length/40,4,9);_$axes_584.autoTicks(axes,Math.abs(axes.range[1]-axes.range[0])/nticks)}for(var dataTicks=_$axes_584.calcTicks(axes),j=0;j<dataTicks.length;++j)dataTicks[j].x=dataTicks[j].x*scene.dataScale[i],dataTicks[j].text=_$convertHTMLToUnicode_537(dataTicks[j].text);ticks[i]=dataTicks,axes.tickmode=tickModeCached}}axesOptions.ticks=ticks;for(var i=0;i<3;++i){centerPoint[i]=.5*(scene.glplot.bounds[0][i]+scene.glplot.bounds[1][i]);for(var j=0;j<2;++j)axesOptions.bounds[j][i]=scene.glplot.bounds[j][i]}scene.contourLevels=function contourLevelsFromTicks(ticks){for(var result=new Array(3),i=0;i<3;++i){for(var tlevel=ticks[i],clevel=new Array(tlevel.length),j=0;j<tlevel.length;++j)clevel[j]=tlevel[j].x;result[i]=clevel}return result}(ticks)},__AXES_NAMES_635=["xaxis","yaxis","zaxis"],centerPoint=[0,0,0];function initializeGLPlot(scene,fullLayout,canvas,gl){var glplotOptions={canvas:canvas,gl:gl,container:scene.container,axes:scene.axesOptions,spikes:scene.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1};if(scene.staticMode){if(!(__STATIC_CONTEXT_637||(__STATIC_CANVAS_637=document.createElement("canvas"),__STATIC_CONTEXT_637=_$getWebGLContext_373({canvas:__STATIC_CANVAS_637,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}))))throw new Error("error creating static canvas/context for image server");glplotOptions.pixelRatio=scene.pixelRatio,glplotOptions.gl=__STATIC_CONTEXT_637,glplotOptions.canvas=__STATIC_CANVAS_637}try{scene.glplot=_$createScene_196(glplotOptions)}catch(e){_$showWebGlMsg_559(scene)}var relayoutCallback=function(scene){if(!1!==scene.fullSceneLayout.dragmode){var update={};update[scene.id+".camera"]=getLayoutCamera(scene.camera),scene.saveCamera(scene.graphDiv.layout),scene.graphDiv.emit("plotly_relayout",update)}};if(scene.glplot.canvas.addEventListener("mouseup",relayoutCallback.bind(null,scene)),scene.glplot.canvas.addEventListener("wheel",relayoutCallback.bind(null,scene),!!_$hasPassiveEvents_240&&{passive:!1}),scene.staticMode||scene.glplot.canvas.addEventListener("webglcontextlost",function(ev){_$lib_539.warn("Lost WebGL context."),ev.preventDefault()}),!scene.camera){var cameraData=scene.fullSceneLayout.camera;scene.camera=_$createCamera_626(scene.container,{center:[cameraData.center.x,cameraData.center.y,cameraData.center.z],eye:[cameraData.eye.x,cameraData.eye.y,cameraData.eye.z],up:[cameraData.up.x,cameraData.up.y,cameraData.up.z],zoomMin:.1,zoomMax:100,mode:"orbit"})}return scene.glplot.camera=scene.camera,scene.glplot.oncontextloss=function(){scene.recoverContext()},scene.glplot.onrender=function render(scene){var trace,svgContainer=scene.svgContainer,clientRect=scene.container.getBoundingClientRect(),width=clientRect.width,height=clientRect.height;svgContainer.setAttributeNS(null,"viewBox","0 0 "+width+" "+height),svgContainer.setAttributeNS(null,"width",width),svgContainer.setAttributeNS(null,"height",height),_$computeTickMarks_635(scene),scene.glplot.axes.update(scene.axesOptions);for(var oldEventData,keys=Object.keys(scene.traces),lastPicked=null,selection=scene.glplot.selection,i=0;i<keys.length;++i)"skip"!==(trace=scene.traces[keys[i]]).data.hoverinfo&&trace.handlePick(selection)&&(lastPicked=trace),trace.setContourLevels&&trace.setContourLevels();function formatter(axisName,val){var axis=scene.fullSceneLayout[axisName];return _$axes_584.tickText(axis,axis.d2l(val),"hover").text}if(null!==lastPicked){var pdata=_$project_636(scene.glplot.cameraParams,selection.dataCoordinate);trace=lastPicked.data;var ptNumber=selection.index,hoverinfo=_$fx_453.castHoverinfo(trace,scene.fullLayout,ptNumber),xVal=formatter("xaxis",selection.traceCoordinate[0]),yVal=formatter("yaxis",selection.traceCoordinate[1]),zVal=formatter("zaxis",selection.traceCoordinate[2]);if("all"!==hoverinfo){var hoverinfoParts=hoverinfo.split("+");-1===hoverinfoParts.indexOf("x")&&(xVal=void 0),-1===hoverinfoParts.indexOf("y")&&(yVal=void 0),-1===hoverinfoParts.indexOf("z")&&(zVal=void 0),-1===hoverinfoParts.indexOf("text")&&(selection.textLabel=void 0),-1===hoverinfoParts.indexOf("name")&&(lastPicked.name=void 0)}scene.fullSceneLayout.hovermode&&_$fx_453.loneHover({x:(.5+.5*pdata[0]/pdata[3])*width,y:(.5-.5*pdata[1]/pdata[3])*height,xLabel:xVal,yLabel:yVal,zLabel:zVal,text:selection.textLabel,name:lastPicked.name,color:_$fx_453.castHoverOption(trace,ptNumber,"bgcolor")||lastPicked.color,borderColor:_$fx_453.castHoverOption(trace,ptNumber,"bordercolor"),fontFamily:_$fx_453.castHoverOption(trace,ptNumber,"font.family"),fontSize:_$fx_453.castHoverOption(trace,ptNumber,"font.size"),fontColor:_$fx_453.castHoverOption(trace,ptNumber,"font.color")},{container:svgContainer,gd:scene.graphDiv});var pointData={x:selection.traceCoordinate[0],y:selection.traceCoordinate[1],z:selection.traceCoordinate[2],data:trace._input,fullData:trace,curveNumber:trace.index,pointNumber:ptNumber};_$fx_453.appendArrayPointValue(pointData,trace,ptNumber);var eventData={points:[pointData]};selection.buttons&&selection.distance<5?scene.graphDiv.emit("plotly_click",eventData):scene.graphDiv.emit("plotly_hover",eventData),oldEventData=eventData}else _$fx_453.loneUnhover(svgContainer),scene.graphDiv.emit("plotly_unhover",oldEventData);scene.drawAnnotations(scene)}.bind(null,scene),scene.traces={},!0}function Scene(options,fullLayout){var sceneContainer=document.createElement("div"),plotContainer=options.container;this.graphDiv=options.graphDiv;var svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");svgContainer.style.position="absolute",svgContainer.style.top=svgContainer.style.left="0px",svgContainer.style.width=svgContainer.style.height="100%",svgContainer.style["z-index"]=20,svgContainer.style["pointer-events"]="none",sceneContainer.appendChild(svgContainer),this.svgContainer=svgContainer,sceneContainer.id=options.id,sceneContainer.style.position="absolute",sceneContainer.style.top=sceneContainer.style.left="0px",sceneContainer.style.width=sceneContainer.style.height="100%",plotContainer.appendChild(sceneContainer),this.fullLayout=fullLayout,this.id=options.id||"scene",this.fullSceneLayout=fullLayout[this.id],this.plotArgs=[[],{},{}],this.axesOptions=_$createAxesOptions_631(fullLayout[this.id]),this.spikeOptions=_$createSpikeOptions_634(fullLayout[this.id]),this.container=sceneContainer,this.staticMode=!!options.staticPlot,this.pixelRatio=options.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=_$registry_668.getComponentMethod("annotations3d","convert"),this.drawAnnotations=_$registry_668.getComponentMethod("annotations3d","draw"),initializeGLPlot(this)}var __proto_637=Scene.prototype;__proto_637.recoverContext=function(){var scene=this,gl=this.glplot.gl,canvas=this.glplot.canvas;this.glplot.dispose(),requestAnimationFrame(function tryRecover(){gl.isContextLost()?requestAnimationFrame(tryRecover):initializeGLPlot(scene,scene.fullLayout,canvas,gl)?scene.plot.apply(scene,scene.plotArgs):_$lib_539.error("Catastrophic and unrecoverable WebGL error. Context lost.")})};var axisProperties=["xaxis","yaxis","zaxis"];function coordinateBound(axis,coord,len,d,bounds,calendar){var x;if(!_$lib_539.isArrayOrTypedArray(coord))return bounds[0][d]=Math.min(bounds[0][d],0),void(bounds[1][d]=Math.max(bounds[1][d],len-1));for(var i=0;i<(len||coord.length);++i)if(_$lib_539.isArrayOrTypedArray(coord[i]))for(var j=0;j<coord[i].length;++j)x=axis.d2l(coord[i][j],0,calendar),!isNaN(x)&&isFinite(x)&&(bounds[0][d]=Math.min(bounds[0][d],x),bounds[1][d]=Math.max(bounds[1][d],x));else x=axis.d2l(coord[i],0,calendar),!isNaN(x)&&isFinite(x)&&(bounds[0][d]=Math.min(bounds[0][d],x),bounds[1][d]=Math.max(bounds[1][d],x))}function computeTraceBounds(scene,trace,bounds){var sceneLayout=scene.fullSceneLayout;coordinateBound(sceneLayout.xaxis,trace.x,trace._xlength,0,bounds,trace.xcalendar),coordinateBound(sceneLayout.yaxis,trace.y,trace._ylength,1,bounds,trace.ycalendar),coordinateBound(sceneLayout.zaxis,trace.z,trace._zlength,2,bounds,trace.zcalendar)}function getLayoutCamera(camera){return{up:{x:camera.up[0],y:camera.up[1],z:camera.up[2]},center:{x:camera.center[0],y:camera.center[1],z:camera.center[2]},eye:{x:camera.eye[0],y:camera.eye[1],z:camera.eye[2]}}}__proto_637.plot=function(sceneData,fullLayout,layout){if(this.plotArgs=[sceneData,fullLayout,layout],!this.glplot.contextLost){var data,trace,i,j,axis,axisType,fullSceneLayout=fullLayout[this.id],sceneLayout=layout[this.id];fullSceneLayout.bgcolor?this.glplot.clearColor=_$str2RgbaArray_561(fullSceneLayout.bgcolor):this.glplot.clearColor=[0,0,0,0],this.glplot.snapToData=!0,this.fullLayout=fullLayout,this.fullSceneLayout=fullSceneLayout,this.glplotLayout=fullSceneLayout,this.axesOptions.merge(fullSceneLayout),this.spikeOptions.merge(fullSceneLayout),this.setCamera(fullSceneLayout.camera),this.updateFx(fullSceneLayout.dragmode,fullSceneLayout.hovermode),this.glplot.update({}),this.setConvert(axis),sceneData?Array.isArray(sceneData)||(sceneData=[sceneData]):sceneData=[];var dataBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(i=0;i<sceneData.length;++i)!0===(data=sceneData[i]).visible&&computeTraceBounds(this,data,dataBounds);var dataScale=[1,1,1];for(j=0;j<3;++j)dataBounds[0][j]>dataBounds[1][j]?dataScale[j]=1:dataBounds[1][j]===dataBounds[0][j]?dataScale[j]=1:dataScale[j]=1/(dataBounds[1][j]-dataBounds[0][j]);for(this.dataScale=dataScale,this.convertAnnotations(this),i=0;i<sceneData.length;++i)!0===(data=sceneData[i]).visible&&((trace=this.traces[data.uid])?trace.update(data):(trace=data._module.plot(this,data),this.traces[data.uid]=trace),trace.name=data.name);var traceIds=Object.keys(this.traces);trace_id_loop:for(i=0;i<traceIds.length;++i){for(j=0;j<sceneData.length;++j)if(sceneData[j].uid===traceIds[i]&&!0===sceneData[j].visible)continue trace_id_loop;(trace=this.traces[traceIds[i]]).dispose(),delete this.traces[traceIds[i]]}this.glplot.objects.sort(function(a,b){return a._trace.data.index-b._trace.data.index});var sceneBounds=[[0,0,0],[0,0,0]],axisDataRange=[],axisTypeRatios={};for(i=0;i<3;++i){if((axisType=(axis=fullSceneLayout[axisProperties[i]]).type)in axisTypeRatios?(axisTypeRatios[axisType].acc*=dataScale[i],axisTypeRatios[axisType].count+=1):axisTypeRatios[axisType]={acc:dataScale[i],count:1},axis.autorange){sceneBounds[0][i]=1/0,sceneBounds[1][i]=-1/0;var objects=this.glplot.objects,annotations=this.fullSceneLayout.annotations||[],axLetter=axis._name.charAt(0);for(j=0;j<objects.length;j++){var objBounds=objects[j].bounds;sceneBounds[0][i]=Math.min(sceneBounds[0][i],objBounds[0][i]/dataScale[i]),sceneBounds[1][i]=Math.max(sceneBounds[1][i],objBounds[1][i]/dataScale[i])}for(j=0;j<annotations.length;j++){var ann=annotations[j];if(ann.visible){var pos=axis.r2l(ann[axLetter]);sceneBounds[0][i]=Math.min(sceneBounds[0][i],pos),sceneBounds[1][i]=Math.max(sceneBounds[1][i],pos)}}if("rangemode"in axis&&"tozero"===axis.rangemode&&(sceneBounds[0][i]=Math.min(sceneBounds[0][i],0),sceneBounds[1][i]=Math.max(sceneBounds[1][i],0)),sceneBounds[0][i]>sceneBounds[1][i])sceneBounds[0][i]=-1,sceneBounds[1][i]=1;else{var d=sceneBounds[1][i]-sceneBounds[0][i];sceneBounds[0][i]-=d/32,sceneBounds[1][i]+=d/32}}else{var range=axis.range;sceneBounds[0][i]=axis.r2l(range[0]),sceneBounds[1][i]=axis.r2l(range[1])}sceneBounds[0][i]===sceneBounds[1][i]&&(sceneBounds[0][i]-=1,sceneBounds[1][i]+=1),axisDataRange[i]=sceneBounds[1][i]-sceneBounds[0][i],this.glplot.bounds[0][i]=sceneBounds[0][i]*dataScale[i],this.glplot.bounds[1][i]=sceneBounds[1][i]*dataScale[i]}var axesScaleRatio=[1,1,1];for(i=0;i<3;++i){var axisRatio=axisTypeRatios[axisType=(axis=fullSceneLayout[axisProperties[i]]).type];axesScaleRatio[i]=Math.pow(axisRatio.acc,1/axisRatio.count)/dataScale[i]}var aspectRatio;if("auto"===fullSceneLayout.aspectmode)aspectRatio=Math.max.apply(null,axesScaleRatio)/Math.min.apply(null,axesScaleRatio)<=4?axesScaleRatio:[1,1,1];else if("cube"===fullSceneLayout.aspectmode)aspectRatio=[1,1,1];else if("data"===fullSceneLayout.aspectmode)aspectRatio=axesScaleRatio;else{if("manual"!==fullSceneLayout.aspectmode)throw new Error("scene.js aspectRatio was not one of the enumerated types");var userRatio=fullSceneLayout.aspectratio;aspectRatio=[userRatio.x,userRatio.y,userRatio.z]}fullSceneLayout.aspectratio.x=sceneLayout.aspectratio.x=aspectRatio[0],fullSceneLayout.aspectratio.y=sceneLayout.aspectratio.y=aspectRatio[1],fullSceneLayout.aspectratio.z=sceneLayout.aspectratio.z=aspectRatio[2],this.glplot.aspect=aspectRatio;var domain=fullSceneLayout.domain||null,size=fullLayout._size||null;if(domain&&size){var containerStyle=this.container.style;containerStyle.position="absolute",containerStyle.left=size.l+domain.x[0]*size.w+"px",containerStyle.top=size.t+(1-domain.y[1])*size.h+"px",containerStyle.width=size.w*(domain.x[1]-domain.x[0])+"px",containerStyle.height=size.h*(domain.y[1]-domain.y[0])+"px"}this.glplot.redraw()}},__proto_637.destroy=function(){this.glplot&&(this.camera.mouseListener.enabled=!1,this.container.removeEventListener("wheel",this.camera.wheelListener),this.camera=this.glplot.camera=null,this.glplot.dispose(),this.container.parentNode.removeChild(this.container),this.glplot=null)},__proto_637.getCamera=function getCamera(){return this.glplot.camera.view.recalcMatrix(this.camera.view.lastT()),getLayoutCamera(this.glplot.camera)},__proto_637.setCamera=function setCamera(cameraData){this.glplot.camera.lookAt.apply(this,function getOrbitCamera(camera){return[[camera.eye.x,camera.eye.y,camera.eye.z],[camera.center.x,camera.center.y,camera.center.z],[camera.up.x,camera.up.y,camera.up.z]]}(cameraData))},__proto_637.saveCamera=function saveCamera(layout){var cameraData=this.getCamera(),cameraNestedProp=_$lib_539.nestedProperty(layout,this.id+".camera"),cameraDataLastSave=cameraNestedProp.get(),hasChanged=!1;function same(x,y,i,j){var vectors=["up","center","eye"],components=["x","y","z"];return y[vectors[i]]&&x[vectors[i]][components[j]]===y[vectors[i]][components[j]]}if(void 0===cameraDataLastSave)hasChanged=!0;else for(var i=0;i<3;i++)for(var j=0;j<3;j++)if(!same(cameraData,cameraDataLastSave,i,j)){hasChanged=!0;break}return hasChanged&&cameraNestedProp.set(cameraData),hasChanged},__proto_637.updateFx=function(dragmode,hovermode){var camera=this.camera;camera&&("orbit"===dragmode?(camera.mode="orbit",camera.keyBindingMode="rotate"):"turntable"===dragmode?(camera.up=[0,0,1],camera.mode="turntable",camera.keyBindingMode="rotate"):camera.keyBindingMode=dragmode),this.fullSceneLayout.hovermode=hovermode},__proto_637.toImage=function(format){format||(format="png"),this.staticMode&&this.container.appendChild(__STATIC_CANVAS_637),this.glplot.redraw();var gl=this.glplot.gl,w=gl.drawingBufferWidth,h=gl.drawingBufferHeight;gl.bindFramebuffer(gl.FRAMEBUFFER,null);var pixels=new Uint8Array(w*h*4);gl.readPixels(0,0,w,h,gl.RGBA,gl.UNSIGNED_BYTE,pixels);for(var j=0,k=h-1;j<k;++j,--k)for(var i=0;i<w;++i)for(var l=0;l<4;++l){var tmp=pixels[4*(w*j+i)+l];pixels[4*(w*j+i)+l]=pixels[4*(w*k+i)+l],pixels[4*(w*k+i)+l]=tmp}var canvas=document.createElement("canvas");canvas.width=w,canvas.height=h;var dataURL,context=canvas.getContext("2d"),imageData=context.createImageData(w,h);switch(imageData.data.set(pixels),context.putImageData(imageData,0,0),format){case"jpeg":dataURL=canvas.toDataURL("image/jpeg");break;case"webp":dataURL=canvas.toDataURL("image/webp");break;default:dataURL=canvas.toDataURL("image/png")}return this.staticMode&&this.container.removeChild(__STATIC_CANVAS_637),dataURL},__proto_637.setConvert=function(){for(var i=0;i<3;i++){var ax=this.fullSceneLayout[axisProperties[i]];_$axes_584.setConvert(ax,this.fullLayout),ax.setScale=_$lib_539.noop}};var _$Scene_637=Scene,_$gl3d_627={},__overrideAll_627=_$edit_types_569.overrideAll,__getSubplotData_627=_$get_data_621.getSubplotData;_$gl3d_627.name="gl3d",_$gl3d_627.attr="scene",_$gl3d_627.idRoot="scene",_$gl3d_627.idRegex=_$gl3d_627.attrRegex=_$lib_539.counterRegex("scene"),_$gl3d_627.attributes={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}},_$gl3d_627.layoutAttributes=_$layout_attributes_633,_$gl3d_627.baseLayoutAttrOverrides=__overrideAll_627({hoverlabel:_$layout_attributes_454.hoverlabel},"plot","nested"),_$gl3d_627.supplyLayoutDefaults=function supplyLayoutDefaults(layoutIn,layoutOut,fullData){var hasNon3D=layoutOut._basePlotModules.length>1;_$handleSubplotDefaults_660(layoutIn,layoutOut,0,{type:"gl3d",attributes:_$layout_attributes_633,handleDefaults:handleGl3dDefaults,fullLayout:layoutOut,font:layoutOut.font,fullData:fullData,getDfltFromLayout:function getDfltFromLayout(attr){if(!hasNon3D)return _$lib_539.validate(layoutIn[attr],_$layout_attributes_633[attr])?layoutIn[attr]:void 0},paper_bgcolor:layoutOut.paper_bgcolor,calendar:layoutOut.calendar})},_$gl3d_627.plot=function plotGl3d(gd){for(var fullLayout=gd._fullLayout,fullData=gd._fullData,sceneIds=fullLayout._subplots.gl3d,i=0;i<sceneIds.length;i++){var sceneId=sceneIds[i],fullSceneData=__getSubplotData_627(fullData,"gl3d",sceneId),sceneLayout=fullLayout[sceneId],scene=sceneLayout._scene;scene||(scene=new _$Scene_637({id:sceneId,graphDiv:gd,container:gd.querySelector(".gl-container"),staticPlot:gd._context.staticPlot,plotGlPixelRatio:gd._context.plotGlPixelRatio},fullLayout),sceneLayout._scene=scene),scene.cameraInitial||(scene.cameraInitial=_$lib_539.extendDeep({},sceneLayout.camera)),scene.plot(fullSceneData,fullLayout,gd.layout)}},_$gl3d_627.clean=function(newFullData,newFullLayout,oldFullData,oldFullLayout){for(var oldSceneKeys=oldFullLayout._subplots.gl3d||[],i=0;i<oldSceneKeys.length;i++){var oldSceneKey=oldSceneKeys[i];!newFullLayout[oldSceneKey]&&oldFullLayout[oldSceneKey]._scene&&(oldFullLayout[oldSceneKey]._scene.destroy(),oldFullLayout._infolayer&&oldFullLayout._infolayer.selectAll(".annotation-"+oldSceneKey).remove())}},_$gl3d_627.toSVG=function(gd){for(var fullLayout=gd._fullLayout,sceneIds=fullLayout._subplots.gl3d,size=fullLayout._size,i=0;i<sceneIds.length;i++){var sceneLayout=fullLayout[sceneIds[i]],domain=sceneLayout.domain,scene=sceneLayout._scene,imageData=scene.toImage("png");fullLayout._glimages.append("svg:image").attr({xmlns:_$xmlns_namespaces_519.svg,"xlink:href":imageData,x:size.l+size.w*domain.x[0],y:size.t+size.h*(1-domain.y[1]),width:size.w*(domain.x[1]-domain.x[0]),height:size.h*(domain.y[1]-domain.y[0]),preserveAspectRatio:"none"}),scene.destroy()}},_$gl3d_627.cleanId=function cleanId(id){if(id.match(/^scene[0-9]*$/)){var sceneNum=id.substr(5);return"1"===sceneNum&&(sceneNum=""),"scene"+sceneNum}},_$gl3d_627.updateFx=function(fullLayout){for(var subplotIds=fullLayout._subplots.gl3d,i=0;i<subplotIds.length;i++){fullLayout[subplotIds[i]]._scene.updateFx(fullLayout.dragmode,fullLayout.hovermode)}};var _$attributes_936={},__extendFlat_936=_$extend_528.extendFlat,__overrideAll_936=_$edit_types_569.overrideAll;function makeContourAttr(axLetter){return{show:{valType:"boolean",dflt:!1},project:{x:{valType:"boolean",dflt:!1},y:{valType:"boolean",dflt:!1},z:{valType:"boolean",dflt:!1}},color:{valType:"color",dflt:_$color_411.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:_$color_411.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var __attrs_936=_$attributes_936=__overrideAll_936({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},surfacecolor:{valType:"data_array"},cauto:_$attributes_417.zauto,cmin:_$attributes_417.zmin,cmax:_$attributes_417.zmax,colorscale:_$attributes_417.colorscale,autocolorscale:__extendFlat_936({},_$attributes_417.autocolorscale,{dflt:!1}),reversescale:_$attributes_417.reversescale,showscale:_$attributes_417.showscale,colorbar:_$attributes_412,contours:{x:makeContourAttr(),y:makeContourAttr(),z:makeContourAttr()},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},_deprecated:{zauto:__extendFlat_936({},_$attributes_417.zauto,{}),zmin:__extendFlat_936({},_$attributes_417.zmin,{}),zmax:__extendFlat_936({},_$attributes_417.zmax,{})},hoverinfo:__extendFlat_936({},_$attributes_581.hoverinfo)},"calc","nested");__attrs_936.x.editType=__attrs_936.y.editType=__attrs_936.z.editType="calc+clearAxisTypes";var __extendFlat_814=_$extend_528.extendFlat,_$attributes_814=__extendFlat_814(_$makeColorScaleAttributes_419(0,"calc",!1),{x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},opacity:_$attributes_936.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:__extendFlat_814({},_$attributes_936.contours.x.show,{}),color:_$attributes_936.contours.x.color,width:_$attributes_936.contours.x.width,editType:"calc"},showscale:_$attributes_417.showscale,colorbar:_$attributes_412,lightposition:{x:__extendFlat_814({},_$attributes_936.lightposition.x,{dflt:1e5}),y:__extendFlat_814({},_$attributes_936.lightposition.y,{dflt:1e5}),z:__extendFlat_814({},_$attributes_936.lightposition.z,{dflt:0}),editType:"calc"},lighting:__extendFlat_814({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},_$attributes_936.lighting),hoverinfo:__extendFlat_814({},_$attributes_581.hoverinfo,{editType:"calc"})}),_$compressExpansion_318=function compressExpansion(e){for(var m=e.length,Q=e[e.length-1],bottom=m,i=m-2;i>=0;--i){var a=Q,b=e[i],bv=(Q=a+b)-a,q=b-bv;q&&(e[--bottom]=Q,Q=q)}for(var top=0,i=bottom;i<m;++i){var a=e[i],b=Q,bv=(Q=a+b)-a,q=b-bv;q&&(e[top++]=q)}return e[top++]=Q,e.length=top,e};var _$robustDeterminant_319={},NUM_EXPANDED=6;function __cofactor_319(m,c){for(var result=new Array(m.length-1),i=1;i<m.length;++i)for(var r=result[i-1]=new Array(m.length-1),j=0,k=0;j<m.length;++j)j!==c&&(r[k++]=m[i][j]);return result}function __determinant_319(m){if(2===m.length)return["sum(prod(",m[0][0],",",m[1][1],"),prod(-",m[0][1],",",m[1][0],"))"].join("");for(var expr=[],i=0;i<m.length;++i)expr.push(["scale(",__determinant_319(__cofactor_319(m,i)),",",(n=i,1&n?"-":""),m[0][i],")"].join(""));return function __generateSum_319(expr){if(1===expr.length)return expr[0];if(2===expr.length)return["sum(",expr[0],",",expr[1],")"].join("");var m=expr.length>>1;return["sum(",__generateSum_319(expr.slice(0,m)),",",__generateSum_319(expr.slice(m)),")"].join("")}(expr);var n}function compileDeterminant(n){return new Function("sum","scale","prod","compress",["function robustDeterminant",n,"(m){return compress(",__determinant_319(function __matrix_319(n){for(var result=new Array(n),i=0;i<n;++i){result[i]=new Array(n);for(var j=0;j<n;++j)result[i][j]=["m[",i,"][",j,"]"].join("")}return result}(n)),")};return robustDeterminant",n].join(""))(_$linearExpansionSum_328,_$scaleLinearExpansion_325,_$twoProduct_358,_$compressExpansion_318)}var __CACHE_319=[function robustDeterminant0(){return[0]},function robustDeterminant1(m){return[m[0][0]]}];!function generateDispatch(){for(;__CACHE_319.length<NUM_EXPANDED;)__CACHE_319.push(compileDeterminant(__CACHE_319.length));for(var procArgs=[],code=["function robustDeterminant(m){switch(m.length){"],i=0;i<NUM_EXPANDED;++i)procArgs.push("det"+i),code.push("case ",i,":return det",i,"(m);");code.push("}var det=CACHE[m.length];if(!det)det=CACHE[m.length]=gen(m.length);return det(m);}return robustDeterminant"),procArgs.push("CACHE","gen",code.join(""));var proc=Function.apply(void 0,procArgs);for(_$robustDeterminant_319=proc.apply(void 0,__CACHE_319.concat([__CACHE_319,compileDeterminant])),i=0;i<__CACHE_319.length;++i)_$robustDeterminant_319[i]=__CACHE_319[i]}();var _$linsolve_322={},__NUM_EXPAND_322=6;function generateSolver(n){for(var funcName="robustLinearSolve"+n+"d",code=["function ",funcName,"(A,b){return ["],i=0;i<n;++i){code.push("det([");for(var j=0;j<n;++j){j>0&&code.push(","),code.push("[");for(var k=0;k<n;++k)k>0&&code.push(","),k===i?code.push("+b[",j,"]"):code.push("+A[",j,"][",k,"]");code.push("]")}code.push("]),")}code.push("det(A)]}return ",funcName);var proc=new Function("det",code.join(""));return proc(n<6?_$robustDeterminant_319[n]:_$robustDeterminant_319)}var __CACHE_322=[function robustLinearSolve0d(){return[0]},function robustLinearSolve1d(A,b){return[[b[0]],[A[0][0]]]}];function __dot_92(a,b){for(var s=0,d=a.length,i=0;i<d;++i)s+=a[i]*b[i];return s}function barycentricCircumcenter(points){var N=points.length;if(0===N)return[];points[0].length;var A=_$dupe_133([points.length+1,points.length+1],1),b=_$dupe_133([points.length+1],1);A[N][N]=0;for(var i=0;i<N;++i){for(var j=0;j<=i;++j)A[j][i]=A[i][j]=2*__dot_92(points[i],points[j]);b[i]=__dot_92(points[i],points[i])}var x=_$linsolve_322(A,b),denom=0,h=x[N+1];for(i=0;i<h.length;++i)denom+=h[i];var y=new Array(N);for(i=0;i<N;++i){h=x[i];var numer=0;for(j=0;j<h.length;++j)numer+=h[j];y[i]=numer/denom}return y}function circumcenter(points){if(0===points.length)return[];for(var D=points[0].length,result=_$dupe_133([D]),weights=barycentricCircumcenter(points),i=0;i<points.length;++i)for(var j=0;j<D;++j)result[j]+=points[i][j]*weights[i];return result}!function __generateDispatch_322(){for(;__CACHE_322.length<__NUM_EXPAND_322;)__CACHE_322.push(generateSolver(__CACHE_322.length));for(var procArgs=[],code=["function dispatchLinearSolve(A,b){switch(A.length){"],i=0;i<__NUM_EXPAND_322;++i)procArgs.push("s"+i),code.push("case ",i,":return s",i,"(A,b);");code.push("}var s=CACHE[A.length];if(!s)s=CACHE[A.length]=g(A.length);return s(A,b)}return dispatchLinearSolve"),procArgs.push("CACHE","g",code.join(""));var proc=Function.apply(void 0,procArgs);for(_$linsolve_322=proc.apply(void 0,__CACHE_322.concat([__CACHE_322,generateSolver])),i=0;i<__NUM_EXPAND_322;++i)_$linsolve_322[i]=__CACHE_322[i]}(),circumcenter.barycenetric=barycentricCircumcenter;var _$circumcenter_92=circumcenter,_$circumradius_93=function circumradius(points){for(var center=_$circumcenter_92(points),avgDist=0,i=0;i<points.length;++i)for(var p=points[i],j=0;j<center.length;++j)avgDist+=Math.pow(p[j]-center[j],2);return Math.sqrt(avgDist/points.length)};var _$incrementalConvexHull_242=function incrementalConvexHull(points,randomSearch){var n=points.length;if(0===n)throw new Error("Must have at least d+1 points");var d=points[0].length;if(n<=d)throw new Error("Must input at least d+1 points");var initialSimplex=points.slice(0,d+1),o=_$orientation_323.apply(void 0,initialSimplex);if(0===o)throw new Error("Input not in general position");for(var initialCoords=new Array(d+1),i=0;i<=d;++i)initialCoords[i]=i;o<0&&(initialCoords[0]=1,initialCoords[1]=0);for(var initialCell=new Simplex(initialCoords,new Array(d+1),!1),boundary=initialCell.adjacent,list=new Array(d+2),i=0;i<=d;++i){for(var verts=initialCoords.slice(),j=0;j<=d;++j)j===i&&(verts[j]=-1);var t=verts[0];verts[0]=verts[1],verts[1]=t;var cell=new Simplex(verts,new Array(d+1),!0);boundary[i]=cell,list[i]=cell}list[d+1]=initialCell;for(var i=0;i<=d;++i)for(var verts=boundary[i].vertices,adj=boundary[i].adjacent,j=0;j<=d;++j){var v=verts[j];if(v<0)adj[j]=initialCell;else for(var k=0;k<=d;++k)boundary[k].vertices.indexOf(v)<0&&(adj[j]=boundary[k])}for(var triangles=new __Triangulation_242(d,initialSimplex,list),useRandom=!!randomSearch,i=d+1;i<n;++i)triangles.insert(points[i],useRandom);return triangles.boundary()},__compareCell_242=_$topology_333.compareCells;function Simplex(vertices,adjacent,boundary){this.vertices=vertices,this.adjacent=adjacent,this.boundary=boundary,this.lastVisited=-1}function GlueFacet(vertices,cell,index){this.vertices=vertices,this.cell=cell,this.index=index}function compareGlue(a,b){return __compareCell_242(a.vertices,b.vertices)}Simplex.prototype.flip=function(){var t=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=t;var u=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=u};var BAKED=[];function __Triangulation_242(dimension,vertices,simplices){this.dimension=dimension,this.vertices=vertices,this.simplices=simplices,this.interior=simplices.filter(function(c){return!c.boundary}),this.tuple=new Array(dimension+1);for(var i=0;i<=dimension;++i)this.tuple[i]=this.vertices[i];var o=BAKED[dimension];o||(o=BAKED[dimension]=function bakeOrient(d){for(var code=["function orient(){var tuple=this.tuple;return test("],i=0;i<=d;++i)i>0&&code.push(","),code.push("tuple[",i,"]");code.push(")}return orient");var proc=new Function("test",code.join("")),test=_$orientation_323[d+1];return test||(test=_$orientation_323),proc(test)}(dimension)),this.orient=o}var __proto_242=__Triangulation_242.prototype;__proto_242.handleBoundaryDegeneracy=function(cell,point){var d=this.dimension,n=this.vertices.length-1,tuple=this.tuple,verts=this.vertices,toVisit=[cell];for(cell.lastVisited=-n;toVisit.length>0;){(cell=toVisit.pop()).vertices;for(var cellAdj=cell.adjacent,i=0;i<=d;++i){var neighbor=cellAdj[i];if(neighbor.boundary&&!(neighbor.lastVisited<=-n)){for(var nv=neighbor.vertices,j=0;j<=d;++j){var vv=nv[j];tuple[j]=vv<0?point:verts[vv]}var o=this.orient();if(o>0)return neighbor;neighbor.lastVisited=-n,0===o&&toVisit.push(neighbor)}}}return null},__proto_242.walk=function(point,random){var n=this.vertices.length-1,d=this.dimension,verts=this.vertices,tuple=this.tuple,initIndex=random?this.interior.length*Math.random()|0:this.interior.length-1,cell=this.interior[initIndex];outerLoop:for(;!cell.boundary;){for(var cellVerts=cell.vertices,cellAdj=cell.adjacent,i=0;i<=d;++i)tuple[i]=verts[cellVerts[i]];cell.lastVisited=n;for(i=0;i<=d;++i){var neighbor=cellAdj[i];if(!(neighbor.lastVisited>=n)){var prev=tuple[i];tuple[i]=point;var o=this.orient();if(tuple[i]=prev,o<0){cell=neighbor;continue outerLoop}neighbor.boundary?neighbor.lastVisited=-n:neighbor.lastVisited=n}}return}return cell},__proto_242.addPeaks=function(point,cell){var n=this.vertices.length-1,d=this.dimension,verts=this.vertices,tuple=this.tuple,interior=this.interior,simplices=this.simplices,tovisit=[cell];cell.lastVisited=n,cell.vertices[cell.vertices.indexOf(-1)]=n,cell.boundary=!1,interior.push(cell);for(var glueFacets=[];tovisit.length>0;){var cellVerts=(cell=tovisit.pop()).vertices,cellAdj=cell.adjacent,indexOfN=cellVerts.indexOf(n);if(!(indexOfN<0))for(var i=0;i<=d;++i)if(i!==indexOfN){var neighbor=cellAdj[i];if(neighbor.boundary&&!(neighbor.lastVisited>=n)){var nv=neighbor.vertices;if(neighbor.lastVisited!==-n){for(var indexOfNeg1=0,j=0;j<=d;++j)nv[j]<0?(indexOfNeg1=j,tuple[j]=point):tuple[j]=verts[nv[j]];if(this.orient()>0){nv[indexOfNeg1]=n,neighbor.boundary=!1,interior.push(neighbor),tovisit.push(neighbor),neighbor.lastVisited=n;continue}neighbor.lastVisited=-n}var na=neighbor.adjacent,vverts=cellVerts.slice(),vadj=cellAdj.slice(),ncell=new Simplex(vverts,vadj,!0);simplices.push(ncell);var opposite=na.indexOf(cell);if(!(opposite<0)){na[opposite]=ncell,vadj[indexOfN]=neighbor,vverts[i]=-1,vadj[i]=cell,cellAdj[i]=ncell,ncell.flip();for(j=0;j<=d;++j){var uu=vverts[j];if(!(uu<0||uu===n)){for(var nface=new Array(d-1),nptr=0,k=0;k<=d;++k){var vv=vverts[k];vv<0||k===j||(nface[nptr++]=vv)}glueFacets.push(new GlueFacet(nface,ncell,j))}}}}}}glueFacets.sort(compareGlue);for(i=0;i+1<glueFacets.length;i+=2){var a=glueFacets[i],b=glueFacets[i+1],ai=a.index,bi=b.index;ai<0||bi<0||(a.cell.adjacent[a.index]=b.cell,b.cell.adjacent[b.index]=a.cell)}},__proto_242.insert=function(point,random){var verts=this.vertices;verts.push(point);var cell=this.walk(point,random);if(cell){for(var d=this.dimension,tuple=this.tuple,i=0;i<=d;++i){var vv=cell.vertices[i];tuple[i]=vv<0?point:verts[vv]}var o=this.orient(tuple);o<0||(0!==o||(cell=this.handleBoundaryDegeneracy(cell,point)))&&this.addPeaks(point,cell)}},__proto_242.boundary=function(){for(var d=this.dimension,boundary=[],cells=this.simplices,nc=cells.length,i=0;i<nc;++i){var c=cells[i];if(c.boundary){for(var bcell=new Array(d),cv=c.vertices,ptr=0,parity=0,j=0;j<=d;++j)cv[j]>=0?bcell[ptr++]=cv[j]:parity=1&j;if(parity===(1&d)){var t=bcell[0];bcell[0]=bcell[1],bcell[1]=t}boundary.push(bcell)}}return boundary};var _$triangulate_129=function triangulate(points,includePointAtInfinity){var n=points.length;if(0===n)return[];var d=points[0].length;if(d<1)return[];if(1===d)return function triangulate1D(n,points,includePointAtInfinity){if(1===n)return includePointAtInfinity?[[-1,0]]:[];var lifted=points.map(function(p,i){return[p[0],i]});lifted.sort(function(a,b){return a[0]-b[0]});for(var cells=new Array(n-1),i=1;i<n;++i){var a=lifted[i-1],b=lifted[i];cells[i-1]=[a[1],b[1]]}includePointAtInfinity&&cells.push([-1,cells[0][1]],[cells[n-1][1],-1]);return cells}(n,points,includePointAtInfinity);for(var lifted=new Array(n),upper=1,i=0;i<n;++i){for(var p=points[i],x=new Array(d+1),l=0,j=0;j<d;++j){var v=p[j];x[j]=v,l+=v*v}x[d]=l,lifted[i]=new LiftedPoint(x,i),upper=Math.max(l,upper)}_$unique_362(lifted,compareLifted),n=lifted.length;for(var dpoints=new Array(n+d+1),dindex=new Array(n+d+1),u=(d+1)*(d+1)*upper,y=new Array(d+1),i=0;i<=d;++i)y[i]=0;y[d]=u,dpoints[0]=y.slice(),dindex[0]=-1;for(var i=0;i<=d;++i){var x=y.slice();x[i]=1,dpoints[i+1]=x,dindex[i+1]=-1}for(var i=0;i<n;++i){var h=lifted[i];dpoints[i+d+1]=h.point,dindex[i+d+1]=h.index}var hull=_$incrementalConvexHull_242(dpoints,!1);hull=includePointAtInfinity?hull.filter(function(cell){for(var count=0,j=0;j<=d;++j){var v=dindex[cell[j]];if(v<0&&++count>=2)return!1;cell[j]=v}return!0}):hull.filter(function(cell){for(var i=0;i<=d;++i){var v=dindex[cell[i]];if(v<0)return!1;cell[i]=v}return!0});if(1&d)for(var i=0;i<hull.length;++i){var h=hull[i],x=h[0];h[0]=h[1],h[1]=x}return hull};function LiftedPoint(p,i){this.point=p,this.index=i}function compareLifted(a,b){for(var ap=a.point,bp=b.point,d=ap.length,i=0;i<d;++i){var s=bp[i]-ap[i];if(s)return s}return 0}var _$alphaComplex_46=function alphaComplex(alpha,points){return _$triangulate_129(points).filter(function(cell){for(var simplex=new Array(cell.length),i=0;i<cell.length;++i)simplex[i]=points[cell[i]];return _$circumradius_93(simplex)*alpha<1})};var _$boundary_75=function __boundary_75(cells){var i,j,k,n=cells.length,sz=0;for(i=0;i<n;++i)sz+=cells[i].length;var result=new Array(sz),ptr=0;for(i=0;i<n;++i){var c=cells[i],d=c.length;for(j=0;j<d;++j){var b=result[ptr++]=new Array(d-1),p=0;for(k=0;k<d;++k)k!==j&&(b[p++]=c[k]);if(1&j){var tmp=b[1];b[1]=b[0],b[0]=tmp}}}return result};var _$orientation_91=function __orientation_91(s){for(var p=1,i=1;i<s.length;++i)for(var j=0;j<i;++j)if(s[i]<s[j])p=-p;else if(s[j]===s[i])return 0;return p};var _$compareCells_107=function __compareCells_107(a,b){var n=a.length,t=a.length-b.length;if(t)return t;switch(n){case 0:return 0;case 1:return a[0]-b[0];case 2:return a[0]+a[1]-b[0]-b[1]||min(a[0],a[1])-min(b[0],b[1]);case 3:var l1=a[0]+a[1],m1=b[0]+b[1];if(t=l1+a[2]-(m1+b[2]))return t;var l0=min(a[0],a[1]),m0=min(b[0],b[1]);return min(l0,a[2])-min(m0,b[2])||min(l0+a[2],l1)-min(m0+b[2],m1);case 4:var aw=a[0],ax=a[1],ay=a[2],az=a[3],bw=b[0],bx=b[1],by=b[2],bz=b[3];return aw+ax+ay+az-(bw+bx+by+bz)||min(aw,ax,ay,az)-min(bw,bx,by,bz,bw)||min(aw+ax,aw+ay,aw+az,ax+ay,ax+az,ay+az)-min(bw+bx,bw+by,bw+bz,bx+by,bx+bz,by+bz)||min(aw+ax+ay,aw+ax+az,aw+ay+az,ax+ay+az)-min(bw+bx+by,bw+bx+bz,bw+by+bz,bx+by+bz);default:for(var as=a.slice().sort(__compareInt_107),bs=b.slice().sort(__compareInt_107),i=0;i<n;++i)if(t=as[i]-bs[i])return t;return 0}},min=Math.min;function __compareInt_107(a,b){return a-b}var _$compareOrientedCells_108=function compareOrientedCells(a,b){return _$compareCells_107(a,b)||_$orientation_91(a)-_$orientation_91(b)};var _$reduceCellComplex_310=function reduceCellComplex(cells){cells.sort(_$compareOrientedCells_108);for(var n=cells.length,ptr=0,i=0;i<n;++i){var c=cells[i],o=_$orientation_91(c);if(0!==o){if(ptr>0){var f=cells[ptr-1];if(0===_$compareCells_107(c,f)&&_$orientation_91(f)!==o){ptr-=1;continue}}cells[ptr++]=c}}return cells.length=ptr,cells};var _$boundary_330=function __boundary_330(cells){return _$reduceCellComplex_310(_$boundary_75(cells))};var _$alphaShape_47=function alphaShape(alpha,points){return _$boundary_330(_$alphaComplex_46(alpha,points))};var _$convexHull1d_110=function convexHull1d(points){for(var lo=0,hi=0,i=1;i<points.length;++i)points[i][0]<points[lo][0]&&(lo=i),points[i][0]>points[hi][0]&&(hi=i);return lo<hi?[[lo],[hi]]:lo>hi?[[hi],[lo]]:[[lo]]};var _$monotoneConvexHull2D_261=function monotoneConvexHull2D(points){var n=points.length;if(n<3){for(var result=new Array(n),i=0;i<n;++i)result[i]=i;return 2===n&&points[0][0]===points[1][0]&&points[0][1]===points[1][1]?[0]:result}for(var sorted=new Array(n),i=0;i<n;++i)sorted[i]=i;sorted.sort(function(a,b){var d=points[a][0]-points[b][0];return d||points[a][1]-points[b][1]});for(var lower=[sorted[0],sorted[1]],upper=[sorted[0],sorted[1]],i=2;i<n;++i){for(var idx=sorted[i],p=points[idx],m=lower.length;m>1&&__orient_261(points[lower[m-2]],points[lower[m-1]],p)<=0;)m-=1,lower.pop();for(lower.push(idx),m=upper.length;m>1&&__orient_261(points[upper[m-2]],points[upper[m-1]],p)>=0;)m-=1,upper.pop();upper.push(idx)}for(var result=new Array(upper.length+lower.length-2),ptr=0,i=0,nl=lower.length;i<nl;++i)result[ptr++]=lower[i];for(var j=upper.length-2;j>0;--j)result[ptr++]=upper[j];return result},__orient_261=_$orientation_323[3];var _$convexHull2D_111=function convexHull2D(points){var hull=_$monotoneConvexHull2D_261(points),h=hull.length;if(h<=2)return[];for(var edges=new Array(h),a=hull[h-1],i=0;i<h;++i){var b=hull[i];edges[i]=[a,b],a=b}return edges};var _$affineHull_45=function affineHull(points){var n=points.length;if(0===n)return[];if(1===n)return[0];for(var d=points[0].length,frame=[points[0]],index=[0],i=1;i<n;++i)if(frame.push(points[i]),linearlyIndependent(frame,d)){if(index.push(i),index.length===d+1)return index}else frame.pop();return index};function linearlyIndependent(points,d){for(var nhull=new Array(d+1),i=0;i<points.length;++i)nhull[i]=points[i];for(i=0;i<=points.length;++i){for(var j=points.length;j<=d;++j){for(var x=new Array(d),k=0;k<d;++k)x[k]=Math.pow(j+1-i,k);nhull[j]=x}if(_$orientation_323.apply(void 0,nhull))return!0}return!1}var _$convexHullnD_112=function convexHullnD(points,d){try{return _$incrementalConvexHull_242(points,!0)}catch(e){var ah=_$affineHull_45(points);if(ah.length<=d)return[];var npoints=function permute(points,front){for(var n=points.length,npoints=new Array(n),i=0;i<front.length;++i)npoints[i]=points[front[i]];for(var ptr=front.length,i=0;i<n;++i)front.indexOf(i)<0&&(npoints[ptr++]=points[i]);return npoints}(points,ah),nhull=_$incrementalConvexHull_242(npoints,!0);return function invPermute(cells,front){for(var nc=cells.length,nf=front.length,i=0;i<nc;++i)for(var c=cells[i],j=0;j<c.length;++j){var x=c[j];if(x<nf)c[j]=front[x];else{x-=nf;for(var k=0;k<nf;++k)x>=front[k]&&(x+=1);c[j]=x}}return cells}(nhull,ah)}};var _$convexHull_109=function convexHull(points){var n=points.length;if(0===n)return[];if(1===n)return[[0]];var d=points[0].length;if(0===d)return[];if(1===d)return _$convexHull1d_110(points);if(2===d)return _$convexHull2D_111(points);return _$convexHullnD_112(points,d)};var _$colorScale_104={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],cool:[{index:0,rgb:[0,255,255]},{index:1,rgb:[255,0,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]};var _$lerp_253=function __lerp_253(v0,v1,t){return v0*(1-t)+v1*t},_$createColormap_105=function createColormap(spec){var indicies,fromrgba,torgba,nsteps,cmap,colormap,format,nshades,alpha,i;spec||(spec={});nshades=(spec.nshades||72)-1,format=spec.format||"hex",(colormap=spec.colormap)||(colormap="jet");if("string"==typeof colormap){if(colormap=colormap.toLowerCase(),!_$colorScale_104[colormap])throw Error(colormap+" not a supported colorscale");cmap=_$colorScale_104[colormap]}else{if(!Array.isArray(colormap))throw Error("unsupported colormap option",colormap);cmap=colormap.slice()}if(cmap.length>nshades)throw new Error(colormap+" map requires nshades to be at least size "+cmap.length);alpha=Array.isArray(spec.alpha)?2!==spec.alpha.length?[1,1]:spec.alpha.slice():"number"==typeof spec.alpha?[spec.alpha,spec.alpha]:[1,1];indicies=cmap.map(function(c){return Math.round(c.index*nshades)}),alpha[0]=Math.min(Math.max(alpha[0],0),1),alpha[1]=Math.min(Math.max(alpha[1],0),1);var steps=cmap.map(function(c,i){var index=cmap[i].index,rgba=cmap[i].rgb.slice();return 4===rgba.length&&rgba[3]>=0&&rgba[3]<=1?rgba:(rgba[3]=alpha[0]+(alpha[1]-alpha[0])*index,rgba)}),colors=[];for(i=0;i<indicies.length-1;++i){nsteps=indicies[i+1]-indicies[i],fromrgba=steps[i],torgba=steps[i+1];for(var j=0;j<nsteps;j++){var amt=j/nsteps;colors.push([Math.round(_$lerp_253(fromrgba[0],torgba[0],amt)),Math.round(_$lerp_253(fromrgba[1],torgba[1],amt)),Math.round(_$lerp_253(fromrgba[2],torgba[2],amt)),_$lerp_253(fromrgba[3],torgba[3],amt)])}}colors.push(cmap[cmap.length-1].rgb.concat(alpha[1])),"hex"===format?colors=colors.map(rgb2hex):"rgbaString"===format?colors=colors.map(rgbaStr):"float"===format&&(colors=colors.map(rgb2float));return colors};function rgb2float(rgba){return[rgba[0]/255,rgba[1]/255,rgba[2]/255,rgba[3]]}function rgb2hex(rgba){for(var dig,hex="#",i=0;i<3;++i)hex+=("00"+(dig=(dig=rgba[i]).toString(16))).substr(dig.length);return hex}function rgbaStr(rgba){return"rgba("+rgba.join(",")+")"}var _$barycentric_53=function barycentric(simplex,point){for(var d=point.length,A=new Array(d+1),i=0;i<d;++i){for(var row=new Array(d+1),j=0;j<=d;++j)row[j]=simplex[j][i];A[i]=row}A[d]=new Array(d+1);for(var i=0;i<=d;++i)A[d][i]=1;for(var b=new Array(d+1),i=0;i<d;++i)b[i]=point[i];b[d]=1;var x=_$linsolve_322(A,b),w=__reduce_53(x[d+1]);0===w&&(w=1);for(var y=new Array(d+1),i=0;i<=d;++i)y[i]=__reduce_53(x[i])/w;return y};function __reduce_53(x){for(var r=0,i=0;i<x.length;++i)r+=x[i];return r}var diff=new Float64Array(4),edge0=new Float64Array(4),edge1=new Float64Array(4);var _$closestPoint2d_303=function closestPoint2d(V0,V1,V2,point,result){diff.length<point.length&&(diff=new Float64Array(point.length),edge0=new Float64Array(point.length),edge1=new Float64Array(point.length));for(var i=0;i<point.length;++i)diff[i]=V0[i]-point[i],edge0[i]=V1[i]-V0[i],edge1[i]=V2[i]-V0[i];var a00=0,a01=0,a11=0,b0=0,b1=0,c=0;for(i=0;i<point.length;++i){var e0=edge0[i],e1=edge1[i],d=diff[i];a00+=e0*e0,a01+=e0*e1,a11+=e1*e1,b0+=d*e0,b1+=d*e1,c+=d*d}var sqrDistance,tmp0,tmp1,numer,denom,det=Math.abs(a00*a11-a01*a01),s=a01*b1-a11*b0,t=a01*b0-a00*b1;if(s+t<=det)if(s<0)t<0&&b0<0?(t=0,-b0>=a00?(s=1,sqrDistance=a00+2*b0+c):sqrDistance=b0*(s=-b0/a00)+c):(s=0,b1>=0?(t=0,sqrDistance=c):-b1>=a11?(t=1,sqrDistance=a11+2*b1+c):sqrDistance=b1*(t=-b1/a11)+c);else if(t<0)t=0,b0>=0?(s=0,sqrDistance=c):-b0>=a00?(s=1,sqrDistance=a00+2*b0+c):sqrDistance=b0*(s=-b0/a00)+c;else{var invDet=1/det;sqrDistance=(s*=invDet)*(a00*s+a01*(t*=invDet)+2*b0)+t*(a01*s+a11*t+2*b1)+c}else s<0?(tmp1=a11+b1)>(tmp0=a01+b0)?(numer=tmp1-tmp0)>=(denom=a00-2*a01+a11)?(s=1,t=0,sqrDistance=a00+2*b0+c):sqrDistance=(s=numer/denom)*(a00*s+a01*(t=1-s)+2*b0)+t*(a01*s+a11*t+2*b1)+c:(s=0,tmp1<=0?(t=1,sqrDistance=a11+2*b1+c):b1>=0?(t=0,sqrDistance=c):sqrDistance=b1*(t=-b1/a11)+c):t<0?(tmp1=a00+b0)>(tmp0=a01+b1)?(numer=tmp1-tmp0)>=(denom=a00-2*a01+a11)?(t=1,s=0,sqrDistance=a11+2*b1+c):sqrDistance=(s=1-(t=numer/denom))*(a00*s+a01*t+2*b0)+t*(a01*s+a11*t+2*b1)+c:(t=0,tmp1<=0?(s=1,sqrDistance=a00+2*b0+c):b0>=0?(s=0,sqrDistance=c):sqrDistance=b0*(s=-b0/a00)+c):(numer=a11+b1-a01-b0)<=0?(s=0,t=1,sqrDistance=a11+2*b1+c):numer>=(denom=a00-2*a01+a11)?(s=1,t=0,sqrDistance=a00+2*b0+c):sqrDistance=(s=numer/denom)*(a00*s+a01*(t=1-s)+2*b0)+t*(a01*s+a11*t+2*b1)+c;var u=1-s-t;for(i=0;i<point.length;++i)result[i]=u*V0[i]+s*V1[i]+t*V2[i];return sqrDistance<0?0:sqrDistance},_$closestPointToPickLocation_185=function closestPointToPickLocation(simplex,pixelCoord,model,view,projection,resolution){if(1===simplex.length)return[0,simplex[0].slice()];for(var simplex2D=new Array(simplex.length),i=0;i<simplex.length;++i)simplex2D[i]=projectVertex(simplex[i],model,view,projection,resolution);for(var closestIndex=0,closestDist=1/0,i=0;i<simplex2D.length;++i){for(var d2=0,j=0;j<2;++j)d2+=Math.pow(simplex2D[i][j]-pixelCoord[j],2);d2<closestDist&&(closestDist=d2,closestIndex=i)}for(var weights=function barycentricCoord(simplex,point){if(2===simplex.length){for(var d0=0,d1=0,i=0;i<2;++i)d0+=Math.pow(point[i]-simplex[0][i],2),d1+=Math.pow(point[i]-simplex[1][i],2);return d0=Math.sqrt(d0),d1=Math.sqrt(d1),d0+d1<1e-6?[1,0]:[d1/(d0+d1),d0/(d1+d0)]}if(3===simplex.length){var closestPoint=[0,0];return _$closestPoint2d_303(simplex[0],simplex[1],simplex[2],point,closestPoint),_$barycentric_53(simplex,closestPoint)}return[]}(simplex2D,pixelCoord),s=0,i=0;i<3;++i){if(weights[i]<-.001||weights[i]>1.0001)return null;s+=weights[i]}if(Math.abs(s-1)>.001)return null;return[closestIndex,function __interpolate_185(simplex,weights){for(var result=[0,0,0],i=0;i<simplex.length;++i)for(var p=simplex[i],w=weights[i],j=0;j<3;++j)result[j]+=w*p[j];return result}(simplex,weights),weights]};function __xformMatrix_185(m,v){for(var out=[0,0,0,0],i=0;i<4;++i)for(var j=0;j<4;++j)out[j]+=m[4*i+j]*v[i];return out}function projectVertex(v,model,view,projection,resolution){for(var p=__xformMatrix_185(projection,__xformMatrix_185(view,__xformMatrix_185(model,[v[0],v[1],v[2],1]))),i=0;i<3;++i)p[i]/=p[3];return[.5*resolution[0]*(1+p[0]),.5*resolution[1]*(1-p[1])]}var _$shaders_186={},triVertSrc=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, normal;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model\n           , view\n           , projection;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec4 m_position  = model * vec4(position, 1.0);\n  vec4 t_position  = view * m_position;\n  gl_Position      = projection * t_position;\n  f_color          = color;\n  f_normal         = normal;\n  f_data           = position;\n  f_eyeDirection   = eyePosition   - position;\n  f_lightDirection = lightPosition - position;\n  f_uv             = uv;\n}"]),triFragSrc=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular\n            , opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if(any(lessThan(f_data, clipBounds[0])) || \n     any(greaterThan(f_data, clipBounds[1]))) {\n    discard;\n  }\n\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n  \n  if(!gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = cookTorranceSpecular(L, V, N, roughness, fresnel);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}"]),edgeVertSrc=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model, view, projection;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_color = color;\n  f_data  = position;\n  f_uv    = uv;\n}"]),edgeFragSrc=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3 clipBounds[2];\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  if(any(lessThan(f_data, clipBounds[0])) || \n     any(greaterThan(f_data, clipBounds[1]))) {\n    discard;\n  }\n\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),pointVertSrc=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\nattribute float pointSize;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if(any(lessThan(position, clipBounds[0])) || \n     any(greaterThan(position, clipBounds[1]))) {\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    gl_Position = projection * view * model * vec4(position, 1.0);\n  }\n  gl_PointSize = pointSize;\n  f_color = color;\n  f_uv = uv;\n}"]),pointFragSrc=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec2 pointR = gl_PointCoord.xy - vec2(0.5,0.5);\n  if(dot(pointR, pointR) > 0.25) {\n    discard;\n  }\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),pickVertSrc=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_id        = id;\n  f_position  = position;\n}"]),pickFragSrc=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if(any(lessThan(f_position, clipBounds[0])) || \n     any(greaterThan(f_position, clipBounds[1]))) {\n    discard;\n  }\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]),pickPointVertSrc=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3  position;\nattribute float pointSize;\nattribute vec4  id;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if(any(lessThan(position, clipBounds[0])) || \n     any(greaterThan(position, clipBounds[1]))) {\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    gl_Position  = projection * view * model * vec4(position, 1.0);\n    gl_PointSize = pointSize;\n  }\n  f_id         = id;\n  f_position   = position;\n}"]),contourVertSrc=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n}"]),contourFragSrc=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3 contourColor;\n\nvoid main() {\n  gl_FragColor = vec4(contourColor,1);\n}\n"]);_$shaders_186.meshShader={vertex:triVertSrc,fragment:triFragSrc,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},_$shaders_186.wireShader={vertex:edgeVertSrc,fragment:edgeFragSrc,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},_$shaders_186.pointShader={vertex:pointVertSrc,fragment:pointFragSrc,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},_$shaders_186.pickShader={vertex:pickVertSrc,fragment:pickFragSrc,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},_$shaders_186.pointPickShader={vertex:pickPointVertSrc,fragment:pickFragSrc,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},_$shaders_186.contourShader={vertex:contourVertSrc,fragment:contourFragSrc,attributes:[{name:"position",type:"vec3"}]};var _$normals_280={};_$normals_280.vertexNormals=function(faces,positions,specifiedEpsilon){for(var N=positions.length,normals=new Array(N),epsilon=void 0===specifiedEpsilon?1e-6:specifiedEpsilon,i=0;i<N;++i)normals[i]=[0,0,0];for(i=0;i<faces.length;++i)for(var f=faces[i],p=0,c=f[f.length-1],n=f[0],j=0;j<f.length;++j){p=c,c=n,n=f[(j+1)%f.length];for(var v0=positions[p],v1=positions[c],v2=positions[n],d01=new Array(3),m01=0,d21=new Array(3),m21=0,k=0;k<3;++k)d01[k]=v0[k]-v1[k],m01+=d01[k]*d01[k],d21[k]=v2[k]-v1[k],m21+=d21[k]*d21[k];if(m01*m21>epsilon){var norm=normals[c],w=1/Math.sqrt(m01*m21);for(k=0;k<3;++k){var u=(k+1)%3,v=(k+2)%3;norm[k]+=w*(d21[u]*d01[v]-d21[v]*d01[u])}}}for(i=0;i<N;++i){norm=normals[i];var m=0;for(k=0;k<3;++k)m+=norm[k]*norm[k];if(m>epsilon)for(w=1/Math.sqrt(m),k=0;k<3;++k)norm[k]*=w;else for(k=0;k<3;++k)norm[k]=0}return normals},_$normals_280.faceNormals=function(faces,positions,specifiedEpsilon){for(var N=faces.length,normals=new Array(N),epsilon=void 0===specifiedEpsilon?1e-6:specifiedEpsilon,i=0;i<N;++i){for(var f=faces[i],pos=new Array(3),j=0;j<3;++j)pos[j]=positions[f[j]];var d01=new Array(3),d21=new Array(3);for(j=0;j<3;++j)d01[j]=pos[1][j]-pos[0][j],d21[j]=pos[2][j]-pos[0][j];var n=new Array(3),l=0;for(j=0;j<3;++j){var u=(j+1)%3,v=(j+2)%3;n[j]=d01[u]*d21[v]-d01[v]*d21[u],l+=n[j]*n[j]}l=l>epsilon?1/Math.sqrt(l):0;for(j=0;j<3;++j)n[j]*=l;normals[i]=n}return normals};var INSERTION_SORT_THRESHOLD=32;function getMallocFree(dtype){switch(dtype){case"uint8":return[_$pool_360.mallocUint8,_$pool_360.freeUint8];case"uint16":return[_$pool_360.mallocUint16,_$pool_360.freeUint16];case"uint32":return[_$pool_360.mallocUint32,_$pool_360.freeUint32];case"int8":return[_$pool_360.mallocInt8,_$pool_360.freeInt8];case"int16":return[_$pool_360.mallocInt16,_$pool_360.freeInt16];case"int32":return[_$pool_360.mallocInt32,_$pool_360.freeInt32];case"float32":return[_$pool_360.mallocFloat,_$pool_360.freeFloat];case"float64":return[_$pool_360.mallocDouble,_$pool_360.freeDouble];default:return null}}function shapeArgs(dimension){for(var args=[],i=0;i<dimension;++i)args.push("s"+i);for(i=0;i<dimension;++i)args.push("n"+i);for(i=1;i<dimension;++i)args.push("d"+i);for(i=1;i<dimension;++i)args.push("e"+i);for(i=1;i<dimension;++i)args.push("f"+i);return args}var _$compileSort_274=function compileSort(order,dtype){var code=["'use strict'"],funcName=["ndarraySortWrapper",order.join("d"),dtype].join("");code.push(["function ",funcName,"(",["array"].join(","),"){"].join(""));for(var vars=["data=array.data,offset=array.offset|0,shape=array.shape,stride=array.stride"],i=0;i<order.length;++i)vars.push(["s",i,"=stride[",i,"]|0,n",i,"=shape[",i,"]|0"].join(""));var scratch_stride=new Array(order.length),nprod=[];for(i=0;i<order.length;++i)0!==(k=order[i])&&(0===nprod.length?scratch_stride[k]="1":scratch_stride[k]=nprod.join("*"),nprod.push("n"+k));var p=-1,q=-1;for(i=0;i<order.length;++i){var k,j=order[i];0!==j&&(p>0?vars.push(["d",j,"=s",j,"-d",p,"*n",p].join("")):vars.push(["d",j,"=s",j].join("")),p=j),0!=(k=order.length-1-i)&&(q>0?vars.push(["e",k,"=s",k,"-e",q,"*n",q,",f",k,"=",scratch_stride[k],"-f",q,"*n",q].join("")):vars.push(["e",k,"=s",k,",f",k,"=",scratch_stride[k]].join("")),q=k)}code.push("var "+vars.join(","));var sortArgs=["0","n0-1","data","offset"].concat(shapeArgs(order.length));code.push(["if(n0<=",INSERTION_SORT_THRESHOLD,"){","insertionSort(",sortArgs.join(","),")}else{","quickSort(",sortArgs.join(","),")}"].join("")),code.push("}return "+funcName);var result=new Function("insertionSort","quickSort",code.join("\n")),insertionSort=function createInsertionSort(order,dtype){var code=["'use strict'"],funcName=["ndarrayInsertionSort",order.join("d"),dtype].join(""),funcArgs=["left","right","data","offset"].concat(shapeArgs(order.length)),allocator=getMallocFree(dtype),vars=["i,j,cptr,ptr=left*s0+offset"];if(order.length>1){for(var scratch_shape=[],i=1;i<order.length;++i)vars.push("i"+i),scratch_shape.push("n"+i);allocator?vars.push("scratch=malloc("+scratch_shape.join("*")+")"):vars.push("scratch=new Array("+scratch_shape.join("*")+")"),vars.push("dptr","sptr","a","b")}else vars.push("scratch");function dataRead(ptr){return"generic"===dtype?["data.get(",ptr,")"].join(""):["data[",ptr,"]"].join("")}function dataWrite(ptr,v){return"generic"===dtype?["data.set(",ptr,",",v,")"].join(""):["data[",ptr,"]=",v].join("")}if(code.push(["function ",funcName,"(",funcArgs.join(","),"){var ",vars.join(",")].join(""),"for(i=left+1;i<=right;++i){","j=i;ptr+=s0","cptr=ptr"),order.length>1){for(code.push("dptr=0;sptr=ptr"),i=order.length-1;i>=0;--i)0!==(j=order[i])&&code.push(["for(i",j,"=0;i",j,"<n",j,";++i",j,"){"].join(""));for(code.push("scratch[dptr++]=",dataRead("sptr")),i=0;i<order.length;++i)0!==(j=order[i])&&code.push("sptr+=d"+j,"}");for(code.push("__g:while(j--\x3eleft){","dptr=0","sptr=cptr-s0"),i=1;i<order.length;++i)1===i&&code.push("__l:"),code.push(["for(i",i,"=0;i",i,"<n",i,";++i",i,"){"].join(""));for(code.push(["a=",dataRead("sptr"),"\nb=scratch[dptr]\nif(a<b){break __g}\nif(a>b){break __l}"].join("")),i=order.length-1;i>=1;--i)code.push("sptr+=e"+i,"dptr+=f"+i,"}");for(code.push("dptr=cptr;sptr=cptr-s0"),i=order.length-1;i>=0;--i)0!==(j=order[i])&&code.push(["for(i",j,"=0;i",j,"<n",j,";++i",j,"){"].join(""));for(code.push(dataWrite("dptr",dataRead("sptr"))),i=0;i<order.length;++i)0!==(j=order[i])&&code.push(["dptr+=d",j,";sptr+=d",j].join(""),"}");for(code.push("cptr-=s0\n}"),code.push("dptr=cptr;sptr=0"),i=order.length-1;i>=0;--i)0!==(j=order[i])&&code.push(["for(i",j,"=0;i",j,"<n",j,";++i",j,"){"].join(""));for(code.push(dataWrite("dptr","scratch[sptr++]")),i=0;i<order.length;++i){var j;0!==(j=order[i])&&code.push("dptr+=d"+j,"}")}}else code.push("scratch="+dataRead("ptr"),"while((j--\x3eleft)&&("+dataRead("cptr-s0")+">scratch)){",dataWrite("cptr",dataRead("cptr-s0")),"cptr-=s0","}",dataWrite("cptr","scratch"));return code.push("}"),order.length>1&&allocator&&code.push("free(scratch)"),code.push("} return "+funcName),allocator?new Function("malloc","free",code.join("\n"))(allocator[0],allocator[1]):new Function(code.join("\n"))()}(order,dtype);return result(insertionSort,function createQuickSort(order,dtype,insertionSort){var code=["'use strict'"],funcName=["ndarrayQuickSort",order.join("d"),dtype].join(""),funcArgs=["left","right","data","offset"].concat(shapeArgs(order.length)),allocator=getMallocFree(dtype),labelCounter=0;code.push(["function ",funcName,"(",funcArgs.join(","),"){"].join(""));var vars=["sixth=((right-left+1)/6)|0","index1=left+sixth","index5=right-sixth","index3=(left+right)>>1","index2=index3-sixth","index4=index3+sixth","el1=index1","el2=index2","el3=index3","el4=index4","el5=index5","less=left+1","great=right-1","pivots_are_equal=true","tmp","tmp0","x","y","z","k","ptr0","ptr1","ptr2","comp_pivot1=0","comp_pivot2=0","comp=0"];if(order.length>1){for(var ele_size=[],i=1;i<order.length;++i)ele_size.push("n"+i),vars.push("i"+i);for(i=0;i<8;++i)vars.push("b_ptr"+i);vars.push("ptr3","ptr4","ptr5","ptr6","ptr7","pivot_ptr","ptr_shift","elementSize="+ele_size.join("*")),allocator?vars.push("pivot1=malloc(elementSize)","pivot2=malloc(elementSize)"):vars.push("pivot1=new Array(elementSize),pivot2=new Array(elementSize)")}else vars.push("pivot1","pivot2");function toPointer(v){return["(offset+",v,"*s0)"].join("")}function dataRead(ptr){return"generic"===dtype?["data.get(",ptr,")"].join(""):["data[",ptr,"]"].join("")}function dataWrite(ptr,v){return"generic"===dtype?["data.set(",ptr,",",v,")"].join(""):["data[",ptr,"]=",v].join("")}function cacheLoop(ptrs,usePivot,body){if(1===ptrs.length)code.push("ptr0="+toPointer(ptrs[0]));else for(var i=0;i<ptrs.length;++i)code.push(["b_ptr",i,"=s0*",ptrs[i]].join(""));for(usePivot&&code.push("pivot_ptr=0"),code.push("ptr_shift=offset"),i=order.length-1;i>=0;--i)0!==(j=order[i])&&code.push(["for(i",j,"=0;i",j,"<n",j,";++i",j,"){"].join(""));if(ptrs.length>1)for(i=0;i<ptrs.length;++i)code.push(["ptr",i,"=b_ptr",i,"+ptr_shift"].join(""));for(code.push(body),usePivot&&code.push("++pivot_ptr"),i=0;i<order.length;++i){var j;0!==(j=order[i])&&(ptrs.length>1?code.push("ptr_shift+=d"+j):code.push("ptr0+=d"+j),code.push("}"))}}function lexicoLoop(label,ptrs,usePivot,body){if(1===ptrs.length)code.push("ptr0="+toPointer(ptrs[0]));else{for(var i=0;i<ptrs.length;++i)code.push(["b_ptr",i,"=s0*",ptrs[i]].join(""));code.push("ptr_shift=offset")}for(usePivot&&code.push("pivot_ptr=0"),label&&code.push(label+":"),i=1;i<order.length;++i)code.push(["for(i",i,"=0;i",i,"<n",i,";++i",i,"){"].join(""));if(ptrs.length>1)for(i=0;i<ptrs.length;++i)code.push(["ptr",i,"=b_ptr",i,"+ptr_shift"].join(""));for(code.push(body),i=order.length-1;i>=1;--i)usePivot&&code.push("pivot_ptr+=f"+i),ptrs.length>1?code.push("ptr_shift+=e"+i):code.push("ptr0+=e"+i),code.push("}")}function cleanUp(){order.length>1&&allocator&&code.push("free(pivot1)","free(pivot2)")}function compareSwap(a_id,b_id){var a="el"+a_id,b="el"+b_id;if(order.length>1){var lbl="__l"+ ++labelCounter;lexicoLoop(lbl,[a,b],!1,["comp=",dataRead("ptr0"),"-",dataRead("ptr1"),"\n","if(comp>0){tmp0=",a,";",a,"=",b,";",b,"=tmp0;break ",lbl,"}\n","if(comp<0){break ",lbl,"}"].join(""))}else code.push(["if(",dataRead(toPointer(a)),">",dataRead(toPointer(b)),"){tmp0=",a,";",a,"=",b,";",b,"=tmp0}"].join(""))}function moveElement(dst,src){order.length>1?cacheLoop([dst,src],!1,dataWrite("ptr0",dataRead("ptr1"))):code.push(dataWrite(toPointer(dst),dataRead(toPointer(src))))}function comparePivot(result,ptr,n){if(order.length>1){var lbl="__l"+ ++labelCounter;lexicoLoop(lbl,[ptr],!0,[result,"=",dataRead("ptr0"),"-pivot",n,"[pivot_ptr]\n","if(",result,"!==0){break ",lbl,"}"].join(""))}else code.push([result,"=",dataRead(toPointer(ptr)),"-pivot",n].join(""))}function swapElements(a,b){order.length>1?cacheLoop([a,b],!1,["tmp=",dataRead("ptr0"),"\n",dataWrite("ptr0",dataRead("ptr1")),"\n",dataWrite("ptr1","tmp")].join("")):code.push(["ptr0=",toPointer(a),"\n","ptr1=",toPointer(b),"\n","tmp=",dataRead("ptr0"),"\n",dataWrite("ptr0",dataRead("ptr1")),"\n",dataWrite("ptr1","tmp")].join(""))}function tripleSwap(k,less,great){order.length>1?(cacheLoop([k,less,great],!1,["tmp=",dataRead("ptr0"),"\n",dataWrite("ptr0",dataRead("ptr1")),"\n",dataWrite("ptr1",dataRead("ptr2")),"\n",dataWrite("ptr2","tmp")].join("")),code.push("++"+less,"--"+great)):code.push(["ptr0=",toPointer(k),"\n","ptr1=",toPointer(less),"\n","ptr2=",toPointer(great),"\n","++",less,"\n","--",great,"\n","tmp=",dataRead("ptr0"),"\n",dataWrite("ptr0",dataRead("ptr1")),"\n",dataWrite("ptr1",dataRead("ptr2")),"\n",dataWrite("ptr2","tmp")].join(""))}function swapAndDecrement(k,great){swapElements(k,great),code.push("--"+great)}function storePivot(mem_dest,pivot_dest,pivot){order.length>1?cacheLoop([mem_dest,pivot_dest],!0,[dataWrite("ptr0",dataRead("ptr1")),"\n",dataWrite("ptr1",["pivot",pivot,"[pivot_ptr]"].join(""))].join("")):code.push(dataWrite(toPointer(mem_dest),dataRead(toPointer(pivot_dest))),dataWrite(toPointer(pivot_dest),"pivot"+pivot))}function doSort(left,right){code.push(["if((",right,"-",left,")<=",INSERTION_SORT_THRESHOLD,"){\n","insertionSort(",left,",",right,",data,offset,",shapeArgs(order.length).join(","),")\n","}else{\n",funcName,"(",left,",",right,",data,offset,",shapeArgs(order.length).join(","),")\n","}"].join(""))}function walkPointer(ptr,pivot,body){order.length>1?(code.push(["__l",++labelCounter,":while(true){"].join("")),cacheLoop([ptr],!0,["if(",dataRead("ptr0"),"!==pivot",pivot,"[pivot_ptr]){break __l",labelCounter,"}"].join("")),code.push(body,"}")):code.push(["while(",dataRead(toPointer(ptr)),"===pivot",pivot,"){",body,"}"].join(""))}return code.push("var "+vars.join(",")),compareSwap(1,2),compareSwap(4,5),compareSwap(1,3),compareSwap(2,3),compareSwap(1,4),compareSwap(3,4),compareSwap(2,5),compareSwap(2,3),compareSwap(4,5),order.length>1?cacheLoop(["el1","el2","el3","el4","el5","index1","index3","index5"],!0,["pivot1[pivot_ptr]=",dataRead("ptr1"),"\n","pivot2[pivot_ptr]=",dataRead("ptr3"),"\n","pivots_are_equal=pivots_are_equal&&(pivot1[pivot_ptr]===pivot2[pivot_ptr])\n","x=",dataRead("ptr0"),"\n","y=",dataRead("ptr2"),"\n","z=",dataRead("ptr4"),"\n",dataWrite("ptr5","x"),"\n",dataWrite("ptr6","y"),"\n",dataWrite("ptr7","z")].join("")):code.push(["pivot1=",dataRead(toPointer("el2")),"\n","pivot2=",dataRead(toPointer("el4")),"\n","pivots_are_equal=pivot1===pivot2\n","x=",dataRead(toPointer("el1")),"\n","y=",dataRead(toPointer("el3")),"\n","z=",dataRead(toPointer("el5")),"\n",dataWrite(toPointer("index1"),"x"),"\n",dataWrite(toPointer("index3"),"y"),"\n",dataWrite(toPointer("index5"),"z")].join("")),moveElement("index2","left"),moveElement("index4","right"),code.push("if(pivots_are_equal){"),code.push("for(k=less;k<=great;++k){"),comparePivot("comp","k",1),code.push("if(comp===0){continue}"),code.push("if(comp<0){"),code.push("if(k!==less){"),swapElements("k","less"),code.push("}"),code.push("++less"),code.push("}else{"),code.push("while(true){"),comparePivot("comp","great",1),code.push("if(comp>0){"),code.push("great--"),code.push("}else if(comp<0){"),tripleSwap("k","less","great"),code.push("break"),code.push("}else{"),swapAndDecrement("k","great"),code.push("break"),code.push("}"),code.push("}"),code.push("}"),code.push("}"),code.push("}else{"),code.push("for(k=less;k<=great;++k){"),comparePivot("comp_pivot1","k",1),code.push("if(comp_pivot1<0){"),code.push("if(k!==less){"),swapElements("k","less"),code.push("}"),code.push("++less"),code.push("}else{"),comparePivot("comp_pivot2","k",2),code.push("if(comp_pivot2>0){"),code.push("while(true){"),comparePivot("comp","great",2),code.push("if(comp>0){"),code.push("if(--great<k){break}"),code.push("continue"),code.push("}else{"),comparePivot("comp","great",1),code.push("if(comp<0){"),tripleSwap("k","less","great"),code.push("}else{"),swapAndDecrement("k","great"),code.push("}"),code.push("break"),code.push("}"),code.push("}"),code.push("}"),code.push("}"),code.push("}"),code.push("}"),storePivot("left","(less-1)",1),storePivot("right","(great+1)",2),doSort("left","(less-2)"),doSort("(great+2)","right"),code.push("if(pivots_are_equal){"),cleanUp(),code.push("return"),code.push("}"),code.push("if(less<index1&&great>index5){"),walkPointer("less",1,"++less"),walkPointer("great",2,"--great"),code.push("for(k=less;k<=great;++k){"),comparePivot("comp_pivot1","k",1),code.push("if(comp_pivot1===0){"),code.push("if(k!==less){"),swapElements("k","less"),code.push("}"),code.push("++less"),code.push("}else{"),comparePivot("comp_pivot2","k",2),code.push("if(comp_pivot2===0){"),code.push("while(true){"),comparePivot("comp","great",2),code.push("if(comp===0){"),code.push("if(--great<k){break}"),code.push("continue"),code.push("}else{"),comparePivot("comp","great",1),code.push("if(comp<0){"),tripleSwap("k","less","great"),code.push("}else{"),swapAndDecrement("k","great"),code.push("}"),code.push("break"),code.push("}"),code.push("}"),code.push("}"),code.push("}"),code.push("}"),code.push("}"),cleanUp(),doSort("less","great"),code.push("}return "+funcName),order.length>1&&allocator?new Function("insertionSort","malloc","free",code.join("\n"))(insertionSort,allocator[0],allocator[1]):new Function("insertionSort",code.join("\n"))(insertionSort)}(order,dtype,insertionSort))},__CACHE_275={};var _$sort_275=function sort(array){var order=array.order,dtype=array.dtype,typeName=[order,dtype].join(":"),compiled=__CACHE_275[typeName];return compiled||(__CACHE_275[typeName]=compiled=_$compileSort_274(order,dtype)),compiled(array),array},_$createTable_255=function createTable(dimension){for(var numCells=1<<dimension+1,result=new Array(numCells),i=0;i<numCells;++i)result[i]=constructCell(dimension,i);return result};function constructVertex(d,a,b){for(var x=new Array(d),i=0;i<d;++i)x[i]=0,i===a&&(x[i]+=.5),i===b&&(x[i]+=.5);return x}function constructCell(dimension,mask){if(0===mask||mask===(1<<dimension+1)-1)return[];for(var points=[],index=[],i=0;i<=dimension;++i)if(mask&1<<i){points.push(constructVertex(dimension,i-1,i-1)),index.push(null);for(var j=0;j<=dimension;++j)~mask&1<<j&&(points.push(constructVertex(dimension,i-1,j-1)),index.push([i,j]))}var hull=_$convexHull_109(points),faces=[];i_loop:for(i=0;i<hull.length;++i){var face=hull[i],nface=[];for(j=0;j<face.length;++j){if(!index[face[j]])continue i_loop;nface.push(index[face[j]].slice())}faces.push(nface)}return faces}var _$getPolygonizer_332=function getPolygonizer(d){var alg=__CACHE_332[d];alg||(alg=__CACHE_332[d]=function createCellPolygonizer(d){var maxCellSize=0,tables=new Array(d+1);tables[0]=[[]];for(var i=1;i<=d;++i)for(var tab=tables[i]=_$createTable_255(i),j=0;j<tab.length;++j)maxCellSize=Math.max(maxCellSize,tab[i].length);var code=["function B(C,E,i,j){","var a=Math.min(i,j)|0,b=Math.max(i,j)|0,l=C[2*a],h=C[2*a+1];","while(l<h){","var m=(l+h)>>1,v=E[2*m+1];","if(v===b){return m}","if(b<v){h=m}else{l=m+1}","}","return l;","};","function getContour",d,"d(F,E,C,S){","var n=F.length,R=[];","for(var i=0;i<n;++i){var c=F[i],l=c.length;"];function generateCase(facets){if(!(facets.length<=0)){code.push("R.push(");for(var i=0;i<facets.length;++i){var facet=facets[i];i>0&&code.push(","),code.push("[");for(var j=0;j<facet.length;++j){var f=facet[j];j>0&&code.push(","),code.push("B(C,E,c[",f[0],"],c[",f[1],"])")}code.push("]")}code.push(");")}}for(var i=d+1;i>1;--i){i<d+1&&code.push("else "),code.push("if(l===",i,"){");for(var maskStr=[],j=0;j<i;++j)maskStr.push("(S[c["+j+"]]<<"+j+")");code.push("var M=",maskStr.join("+"),";if(M===0||M===",(1<<i)-1,"){continue}switch(M){");for(var tab=tables[i-1],j=0;j<tab.length;++j)code.push("case ",j,":"),generateCase(tab[j]),code.push("break;");code.push("}}")}return code.push("}return R;};return getContour",d,"d"),new Function("pool",code.join(""))(_$pool_360)}(d));return alg},__CACHE_332={};var _$extractContour_331=function extractContour(cells,values,level,d){level=level||0,void 0===d&&(d=function getDimension(cells){for(var numCells=cells.length,d=0,i=0;i<numCells;++i)d=0|Math.max(d,cells[i].length);return d-1}(cells));if(0===cells.length||d<1)return{cells:[],vertexIds:[],vertexWeights:[]};var vertexSigns=function getSigns(values,level){for(var numVerts=values.length,vertexSigns=_$pool_360.mallocUint8(numVerts),i=0;i<numVerts;++i)vertexSigns[i]=values[i]<level|0;return vertexSigns}(values,+level),edges=function getEdges(cells,d){for(var numCells=cells.length,maxEdges=d*(d+1)/2*numCells|0,edges=_$pool_360.mallocUint32(2*maxEdges),ePtr=0,i=0;i<numCells;++i)for(var c=cells[i],d=c.length,j=0;j<d;++j)for(var k=0;k<j;++k){var a=c[k],b=c[j];edges[ePtr++]=0|Math.min(a,b),edges[ePtr++]=0|Math.max(a,b)}_$sort_275(_$wrappedNDArrayCtor_277(edges,[ePtr/2|0,2]));for(var ptr=2,i=2;i<ePtr;i+=2)edges[i-2]===edges[i]&&edges[i-1]===edges[i+1]||(edges[ptr++]=edges[i],edges[ptr++]=edges[i+1]);return _$wrappedNDArrayCtor_277(edges,[ptr/2|0,2])}(cells,d),weights=function getCrossingWeights(edges,values,signs,level){for(var edata=edges.data,numEdges=edges.shape[0],weights=_$pool_360.mallocDouble(numEdges),ptr=0,i=0;i<numEdges;++i){var a=edata[2*i],b=edata[2*i+1];if(signs[a]!==signs[b]){var va=values[a],vb=values[b];edata[2*ptr]=a,edata[2*ptr+1]=b,weights[ptr++]=(vb-level)/(vb-va)}}return edges.shape[0]=ptr,_$wrappedNDArrayCtor_277(weights,[ptr])}(edges,values,vertexSigns,+level),vcascade=function getCascade(edges,numVerts){var result=_$pool_360.mallocInt32(2*numVerts),numEdges=edges.shape[0],edata=edges.data;result[0]=0;for(var lastV=0,i=0;i<numEdges;++i){var a=edata[2*i];if(a!==lastV){for(result[2*lastV+1]=i;++lastV<a;)result[2*lastV]=i,result[2*lastV+1]=i;result[2*lastV]=i}}result[2*lastV+1]=numEdges;for(;++lastV<numVerts;)result[2*lastV]=result[2*lastV+1]=numEdges;return result}(edges,0|values.length),faces=_$getPolygonizer_332(d)(cells,edges.data,vcascade,vertexSigns),uedges=function unpackEdges(edges){for(var ne=0|edges.shape[0],edata=edges.data,result=new Array(ne),i=0;i<ne;++i)result[i]=[edata[2*i],edata[2*i+1]];return result}(edges),uweights=[].slice.call(weights.data,0,weights.shape[0]);return _$pool_360.free(vertexSigns),_$pool_360.free(edges.data),_$pool_360.free(weights.data),_$pool_360.free(vcascade),{cells:faces,vertexIds:uedges,vertexWeights:uweights}};var meshShader=_$shaders_186.meshShader,wireShader=_$shaders_186.wireShader,pointShader=_$shaders_186.pointShader,pickShader=_$shaders_186.pickShader,pointPickShader=_$shaders_186.pointPickShader,contourShader=_$shaders_186.contourShader,identityMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function SimplicialMesh(gl,texture,triShader,lineShader,pointShader,pickShader,pointPickShader,contourShader,trianglePositions,triangleIds,triangleColors,triangleUVs,triangleNormals,triangleVAO,edgePositions,edgeIds,edgeColors,edgeUVs,edgeVAO,pointPositions,pointIds,pointColors,pointUVs,pointSizes,pointVAO,contourPositions,contourVAO){this.gl=gl,this.cells=[],this.positions=[],this.intensity=[],this.texture=texture,this.dirty=!0,this.triShader=triShader,this.lineShader=lineShader,this.pointShader=pointShader,this.pickShader=pickShader,this.pointPickShader=pointPickShader,this.contourShader=contourShader,this.trianglePositions=trianglePositions,this.triangleColors=triangleColors,this.triangleNormals=triangleNormals,this.triangleUVs=triangleUVs,this.triangleIds=triangleIds,this.triangleVAO=triangleVAO,this.triangleCount=0,this.lineWidth=1,this.edgePositions=edgePositions,this.edgeColors=edgeColors,this.edgeUVs=edgeUVs,this.edgeIds=edgeIds,this.edgeVAO=edgeVAO,this.edgeCount=0,this.pointPositions=pointPositions,this.pointColors=pointColors,this.pointUVs=pointUVs,this.pointSizes=pointSizes,this.pointIds=pointIds,this.pointVAO=pointVAO,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=contourPositions,this.contourVAO=contourVAO,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this._model=identityMatrix,this._view=identityMatrix,this._projection=identityMatrix,this._resolution=[1,1]}var __proto_187=SimplicialMesh.prototype;function createPointShader(gl){var shader=_$createShader_206(gl,pointShader.vertex,pointShader.fragment);return shader.attributes.position.location=0,shader.attributes.color.location=2,shader.attributes.uv.location=3,shader.attributes.pointSize.location=4,shader}function createPickShader(gl){var shader=_$createShader_206(gl,pickShader.vertex,pickShader.fragment);return shader.attributes.position.location=0,shader.attributes.id.location=1,shader}function createPointPickShader(gl){var shader=_$createShader_206(gl,pointPickShader.vertex,pointPickShader.fragment);return shader.attributes.position.location=0,shader.attributes.id.location=1,shader.attributes.pointSize.location=4,shader}function createContourShader(gl){var shader=_$createShader_206(gl,contourShader.vertex,contourShader.fragment);return shader.attributes.position.location=0,shader}__proto_187.isOpaque=function(){return this.opacity>=1},__proto_187.isTransparent=function(){return this.opacity<1},__proto_187.pickSlots=1,__proto_187.setPickBase=function(id){this.pickId=id},__proto_187.highlight=function(selection){if(selection&&this.contourEnable){for(var level=_$extractContour_331(this.cells,this.intensity,selection.intensity),cells=level.cells,vertexIds=level.vertexIds,vertexWeights=level.vertexWeights,numCells=cells.length,result=_$pool_360.mallocFloat32(6*numCells),ptr=0,i=0;i<numCells;++i)for(var c=cells[i],j=0;j<2;++j){var v=c[0];2===c.length&&(v=c[j]);for(var a=vertexIds[v][0],b=vertexIds[v][1],w=vertexWeights[v],wi=1-w,pa=this.positions[a],pb=this.positions[b],k=0;k<3;++k)result[ptr++]=w*pa[k]+wi*pb[k]}this.contourCount=ptr/3|0,this.contourPositions.update(result.subarray(0,ptr)),_$pool_360.free(result)}else this.contourCount=0},__proto_187.update=function(params){params=params||{};var gl=this.gl;this.dirty=!0,"contourEnable"in params&&(this.contourEnable=params.contourEnable),"contourColor"in params&&(this.contourColor=params.contourColor),"lineWidth"in params&&(this.lineWidth=params.lineWidth),"lightPosition"in params&&(this.lightPosition=params.lightPosition),"opacity"in params&&(this.opacity=params.opacity),"ambient"in params&&(this.ambientLight=params.ambient),"diffuse"in params&&(this.diffuseLight=params.diffuse),"specular"in params&&(this.specularLight=params.specular),"roughness"in params&&(this.roughness=params.roughness),"fresnel"in params&&(this.fresnel=params.fresnel),params.texture?(this.texture.dispose(),this.texture=_$createTexture2D_218(gl,params.texture)):params.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=gl.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=gl.LINEAR,this.texture.setPixels(function genColormap(param){for(var colors=_$createColormap_105({colormap:param,nshades:256,format:"rgba"}),result=new Uint8Array(1024),i=0;i<256;++i){for(var c=colors[i],j=0;j<3;++j)result[4*i+j]=c[j];result[4*i+3]=255*c[3]}return _$wrappedNDArrayCtor_277(result,[256,256,4],[4,0,1])}(params.colormap)),this.texture.generateMipmap());var cells=params.cells,positions=params.positions;if(positions&&cells){var tPos=[],tCol=[],tNor=[],tUVs=[],tIds=[],ePos=[],eCol=[],eUVs=[],eIds=[],pPos=[],pCol=[],pUVs=[],pSiz=[],pIds=[];this.cells=cells,this.positions=positions;var vertexNormals=params.vertexNormals,cellNormals=params.cellNormals,vertexNormalsEpsilon=void 0===params.vertexNormalsEpsilon?1e-6:params.vertexNormalsEpsilon,faceNormalsEpsilon=void 0===params.faceNormalsEpsilon?1e-6:params.faceNormalsEpsilon;params.useFacetNormals&&!cellNormals&&(cellNormals=_$normals_280.faceNormals(cells,positions,faceNormalsEpsilon)),cellNormals||vertexNormals||(vertexNormals=_$normals_280.vertexNormals(cells,positions,vertexNormalsEpsilon));var vertexColors=params.vertexColors,cellColors=params.cellColors,meshColor=params.meshColor||[1,1,1,1],vertexUVs=params.vertexUVs,vertexIntensity=params.vertexIntensity,cellUVs=params.cellUVs,cellIntensity=params.cellIntensity,intensityLo=1/0,intensityHi=-1/0;if(!vertexUVs&&!cellUVs)if(vertexIntensity)if(params.vertexIntensityBounds)intensityLo=+params.vertexIntensityBounds[0],intensityHi=+params.vertexIntensityBounds[1];else for(var i=0;i<vertexIntensity.length;++i){var f=vertexIntensity[i];intensityLo=Math.min(intensityLo,f),intensityHi=Math.max(intensityHi,f)}else if(cellIntensity)for(i=0;i<cellIntensity.length;++i){f=cellIntensity[i];intensityLo=Math.min(intensityLo,f),intensityHi=Math.max(intensityHi,f)}else for(i=0;i<positions.length;++i){f=positions[i][2];intensityLo=Math.min(intensityLo,f),intensityHi=Math.max(intensityHi,f)}this.intensity=vertexIntensity||(cellIntensity?function unpackIntensity(cells,numVerts,cellIntensity){for(var result=new Array(numVerts),i=0;i<numVerts;++i)result[i]=0;var numCells=cells.length;for(i=0;i<numCells;++i)for(var c=cells[i],j=0;j<c.length;++j)result[c[j]]=cellIntensity[i];return result}(cells,positions.length,cellIntensity):function takeZComponent(array){for(var n=array.length,result=new Array(n),i=0;i<n;++i)result[i]=array[i][2];return result}(positions));var pointSizes=params.pointSizes,meshPointSize=params.pointSize||1;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(i=0;i<positions.length;++i)for(var p=positions[i],j=0;j<3;++j)!isNaN(p[j])&&isFinite(p[j])&&(this.bounds[0][j]=Math.min(this.bounds[0][j],p[j]),this.bounds[1][j]=Math.max(this.bounds[1][j],p[j]));var triangleCount=0,edgeCount=0,pointCount=0;fill_loop:for(i=0;i<cells.length;++i){var cell=cells[i];switch(cell.length){case 1:for(p=positions[v=cell[0]],j=0;j<3;++j)if(isNaN(p[j])||!isFinite(p[j]))continue fill_loop;pPos.push(p[0],p[1],p[2]),3===(c=vertexColors?vertexColors[v]:cellColors?cellColors[i]:meshColor).length?pCol.push(c[0],c[1],c[2],1):pCol.push(c[0],c[1],c[2],c[3]),uv=vertexUVs?vertexUVs[v]:vertexIntensity?[(vertexIntensity[v]-intensityLo)/(intensityHi-intensityLo),0]:cellUVs?cellUVs[i]:cellIntensity?[(cellIntensity[i]-intensityLo)/(intensityHi-intensityLo),0]:[(p[2]-intensityLo)/(intensityHi-intensityLo),0],pUVs.push(uv[0],uv[1]),pointSizes?pSiz.push(pointSizes[v]):pSiz.push(meshPointSize),pIds.push(i),pointCount+=1;break;case 2:for(j=0;j<2;++j){p=positions[v=cell[j]];for(var k=0;k<3;++k)if(isNaN(p[k])||!isFinite(p[k]))continue fill_loop}for(j=0;j<2;++j){p=positions[v=cell[j]];ePos.push(p[0],p[1],p[2]),3===(c=vertexColors?vertexColors[v]:cellColors?cellColors[i]:meshColor).length?eCol.push(c[0],c[1],c[2],1):eCol.push(c[0],c[1],c[2],c[3]),uv=vertexUVs?vertexUVs[v]:vertexIntensity?[(vertexIntensity[v]-intensityLo)/(intensityHi-intensityLo),0]:cellUVs?cellUVs[i]:cellIntensity?[(cellIntensity[i]-intensityLo)/(intensityHi-intensityLo),0]:[(p[2]-intensityLo)/(intensityHi-intensityLo),0],eUVs.push(uv[0],uv[1]),eIds.push(i)}edgeCount+=1;break;case 3:for(j=0;j<3;++j)for(p=positions[v=cell[j]],k=0;k<3;++k)if(isNaN(p[k])||!isFinite(p[k]))continue fill_loop;for(j=0;j<3;++j){var v,c,uv,q;p=positions[v=cell[j]];tPos.push(p[0],p[1],p[2]),3===(c=vertexColors?vertexColors[v]:cellColors?cellColors[i]:meshColor).length?tCol.push(c[0],c[1],c[2],1):tCol.push(c[0],c[1],c[2],c[3]),uv=vertexUVs?vertexUVs[v]:vertexIntensity?[(vertexIntensity[v]-intensityLo)/(intensityHi-intensityLo),0]:cellUVs?cellUVs[i]:cellIntensity?[(cellIntensity[i]-intensityLo)/(intensityHi-intensityLo),0]:[(p[2]-intensityLo)/(intensityHi-intensityLo),0],tUVs.push(uv[0],uv[1]),q=vertexNormals?vertexNormals[v]:cellNormals[i],tNor.push(q[0],q[1],q[2]),tIds.push(i)}triangleCount+=1}}this.pointCount=pointCount,this.edgeCount=edgeCount,this.triangleCount=triangleCount,this.pointPositions.update(pPos),this.pointColors.update(pCol),this.pointUVs.update(pUVs),this.pointSizes.update(pSiz),this.pointIds.update(new Uint32Array(pIds)),this.edgePositions.update(ePos),this.edgeColors.update(eCol),this.edgeUVs.update(eUVs),this.edgeIds.update(new Uint32Array(eIds)),this.trianglePositions.update(tPos),this.triangleColors.update(tCol),this.triangleUVs.update(tUVs),this.triangleNormals.update(tNor),this.triangleIds.update(new Uint32Array(tIds))}},__proto_187.drawTransparent=__proto_187.draw=function(params){params=params||{};for(var gl=this.gl,model=params.model||identityMatrix,view=params.view||identityMatrix,projection=params.projection||identityMatrix,clipBounds=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],i=0;i<3;++i)clipBounds[0][i]=Math.max(clipBounds[0][i],this.clipBounds[0][i]),clipBounds[1][i]=Math.min(clipBounds[1][i],this.clipBounds[1][i]);var uniforms={model:model,view:view,projection:projection,clipBounds:clipBounds,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,contourColor:this.contourColor,texture:0};this.texture.bind(0);var invCameraMatrix=new Array(16);_$multiply_175(invCameraMatrix,uniforms.view,uniforms.model),_$multiply_175(invCameraMatrix,uniforms.projection,invCameraMatrix),_$invert_173(invCameraMatrix,invCameraMatrix);for(i=0;i<3;++i)uniforms.eyePosition[i]=invCameraMatrix[12+i]/invCameraMatrix[15];var shader,w=invCameraMatrix[15];for(i=0;i<3;++i)w+=this.lightPosition[i]*invCameraMatrix[4*i+3];for(i=0;i<3;++i){for(var s=invCameraMatrix[12+i],j=0;j<3;++j)s+=invCameraMatrix[4*j+i]*this.lightPosition[j];uniforms.lightPosition[i]=s/w}this.triangleCount>0&&((shader=this.triShader).bind(),shader.uniforms=uniforms,this.triangleVAO.bind(),gl.drawArrays(gl.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind());this.edgeCount>0&&this.lineWidth>0&&((shader=this.lineShader).bind(),shader.uniforms=uniforms,this.edgeVAO.bind(),gl.lineWidth(this.lineWidth),gl.drawArrays(gl.LINES,0,2*this.edgeCount),this.edgeVAO.unbind());this.pointCount>0&&((shader=this.pointShader).bind(),shader.uniforms=uniforms,this.pointVAO.bind(),gl.drawArrays(gl.POINTS,0,this.pointCount),this.pointVAO.unbind());this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0&&((shader=this.contourShader).bind(),shader.uniforms=uniforms,this.contourVAO.bind(),gl.drawArrays(gl.LINES,0,this.contourCount),this.contourVAO.unbind())},__proto_187.drawPick=function(params){params=params||{};for(var gl=this.gl,model=params.model||identityMatrix,view=params.view||identityMatrix,projection=params.projection||identityMatrix,clipBounds=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],i=0;i<3;++i)clipBounds[0][i]=Math.max(clipBounds[0][i],this.clipBounds[0][i]),clipBounds[1][i]=Math.min(clipBounds[1][i],this.clipBounds[1][i]);this._model=[].slice.call(model),this._view=[].slice.call(view),this._projection=[].slice.call(projection),this._resolution=[gl.drawingBufferWidth,gl.drawingBufferHeight];var shader,uniforms={model:model,view:view,projection:projection,clipBounds:clipBounds,pickId:this.pickId/255};((shader=this.pickShader).bind(),shader.uniforms=uniforms,this.triangleCount>0&&(this.triangleVAO.bind(),gl.drawArrays(gl.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),gl.lineWidth(this.lineWidth),gl.drawArrays(gl.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0)&&((shader=this.pointPickShader).bind(),shader.uniforms=uniforms,this.pointVAO.bind(),gl.drawArrays(gl.POINTS,0,this.pointCount),this.pointVAO.unbind())},__proto_187.pick=function(pickData){if(!pickData)return null;if(pickData.id!==this.pickId)return null;for(var cellId=pickData.value[0]+256*pickData.value[1]+65536*pickData.value[2],cell=this.cells[cellId],positions=this.positions,simplex=new Array(cell.length),i=0;i<cell.length;++i)simplex[i]=positions[cell[i]];var data=_$closestPointToPickLocation_185(simplex,[pickData.coord[0],this._resolution[1]-pickData.coord[1]],this._model,this._view,this._projection,this._resolution);if(!data)return null;var weights=data[2],interpIntensity=0;for(i=0;i<cell.length;++i)interpIntensity+=weights[i]*this.intensity[cell[i]];return{position:data[1],index:cell[data[0]],cell:cell,cellId:cellId,intensity:interpIntensity,dataCoordinate:this.positions[cell[data[0]]]}},__proto_187.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()};var _$createSimplicialMesh_187=function createSimplicialMesh(gl,params){1===arguments.length&&(gl=(params=gl).gl);var triShader=function createMeshShader(gl){var shader=_$createShader_206(gl,meshShader.vertex,meshShader.fragment);return shader.attributes.position.location=0,shader.attributes.color.location=2,shader.attributes.uv.location=3,shader.attributes.normal.location=4,shader}(gl),lineShader=function createWireShader(gl){var shader=_$createShader_206(gl,wireShader.vertex,wireShader.fragment);return shader.attributes.position.location=0,shader.attributes.color.location=2,shader.attributes.uv.location=3,shader}(gl),pointShader=createPointShader(gl),pickShader=createPickShader(gl),pointPickShader=createPointPickShader(gl),contourShader=createContourShader(gl),meshTexture=_$createTexture2D_218(gl,_$wrappedNDArrayCtor_277(new Uint8Array([255,255,255,255]),[1,1,4]));meshTexture.generateMipmap(),meshTexture.minFilter=gl.LINEAR_MIPMAP_LINEAR,meshTexture.magFilter=gl.LINEAR;var trianglePositions=_$createBuffer_153(gl),triangleColors=_$createBuffer_153(gl),triangleUVs=_$createBuffer_153(gl),triangleNormals=_$createBuffer_153(gl),triangleIds=_$createBuffer_153(gl),triangleVAO=_$createVAO_222(gl,[{buffer:trianglePositions,type:gl.FLOAT,size:3},{buffer:triangleIds,type:gl.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:triangleColors,type:gl.FLOAT,size:4},{buffer:triangleUVs,type:gl.FLOAT,size:2},{buffer:triangleNormals,type:gl.FLOAT,size:3}]),edgePositions=_$createBuffer_153(gl),edgeColors=_$createBuffer_153(gl),edgeUVs=_$createBuffer_153(gl),edgeIds=_$createBuffer_153(gl),edgeVAO=_$createVAO_222(gl,[{buffer:edgePositions,type:gl.FLOAT,size:3},{buffer:edgeIds,type:gl.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:edgeColors,type:gl.FLOAT,size:4},{buffer:edgeUVs,type:gl.FLOAT,size:2}]),pointPositions=_$createBuffer_153(gl),pointColors=_$createBuffer_153(gl),pointUVs=_$createBuffer_153(gl),pointSizes=_$createBuffer_153(gl),pointIds=_$createBuffer_153(gl),pointVAO=_$createVAO_222(gl,[{buffer:pointPositions,type:gl.FLOAT,size:3},{buffer:pointIds,type:gl.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:pointColors,type:gl.FLOAT,size:4},{buffer:pointUVs,type:gl.FLOAT,size:2},{buffer:pointSizes,type:gl.FLOAT,size:1}]),contourPositions=_$createBuffer_153(gl),mesh=new SimplicialMesh(gl,meshTexture,triShader,lineShader,pointShader,pickShader,pointPickShader,contourShader,trianglePositions,triangleIds,triangleColors,triangleUVs,triangleNormals,triangleVAO,edgePositions,edgeIds,edgeColors,edgeUVs,edgeVAO,pointPositions,pointIds,pointColors,pointUVs,pointSizes,pointVAO,contourPositions,_$createVAO_222(gl,[{buffer:contourPositions,type:gl.FLOAT,size:3}]));return mesh.update(params),mesh};function Mesh3DTrace(scene,mesh,uid){this.scene=scene,this.uid=uid,this.mesh=mesh,this.name="",this.color="#fff",this.data=null,this.showContour=!1}var __proto_817=Mesh3DTrace.prototype;function parseColorArray(colors){return colors.map(_$str2RgbaArray_561)}function zip3(x,y,z){for(var result=new Array(x.length),i=0;i<x.length;++i)result[i]=[x[i],y[i],z[i]];return result}__proto_817.handlePick=function(selection){if(selection.object===this.mesh){var selectIndex=selection.index=selection.data.index;selection.traceCoordinate=[this.data.x[selectIndex],this.data.y[selectIndex],this.data.z[selectIndex]];var text=this.data.text;return Array.isArray(text)&&void 0!==text[selectIndex]?selection.textLabel=text[selectIndex]:text&&(selection.textLabel=text),!0}},__proto_817.update=function(data){var scene=this.scene,layout=scene.fullSceneLayout;function toDataCoords(axis,coord,scale,calendar){return coord.map(function(x){return axis.d2l(x,0,calendar)*scale})}this.data=data;var cells,positions=zip3(toDataCoords(layout.xaxis,data.x,scene.dataScale[0],data.xcalendar),toDataCoords(layout.yaxis,data.y,scene.dataScale[1],data.ycalendar),toDataCoords(layout.zaxis,data.z,scene.dataScale[2],data.zcalendar));if(data.i&&data.j&&data.k)cells=zip3(data.i,data.j,data.k);else if(0===data.alphahull)cells=_$convexHull_109(positions);else if(data.alphahull>0)cells=_$alphaShape_47(data.alphahull,positions);else{var d=["x","y","z"].indexOf(data.delaunayaxis);cells=_$triangulate_129(positions.map(function(c){return[c[(d+1)%3],c[(d+2)%3]]}))}var config={positions:positions,cells:cells,lightPosition:[data.lightposition.x,data.lightposition.y,data.lightposition.z],ambient:data.lighting.ambient,diffuse:data.lighting.diffuse,specular:data.lighting.specular,roughness:data.lighting.roughness,fresnel:data.lighting.fresnel,vertexNormalsEpsilon:data.lighting.vertexnormalsepsilon,faceNormalsEpsilon:data.lighting.facenormalsepsilon,opacity:data.opacity,contourEnable:data.contour.show,contourColor:_$str2RgbaArray_561(data.contour.color).slice(0,3),contourWidth:data.contour.width,useFacetNormals:data.flatshading};data.intensity?(this.color="#fff",config.vertexIntensity=data.intensity,config.vertexIntensityBounds=[data.cmin,data.cmax],config.colormap=function parseColorScale(colorscale){return colorscale.map(function(elem){var index=elem[0],rgb=_$tinycolor_352(elem[1]).toRgb();return{index:index,rgb:[rgb.r,rgb.g,rgb.b,1]}})}(data.colorscale)):data.vertexcolor?(this.color=data.vertexcolor[0],config.vertexColors=parseColorArray(data.vertexcolor)):data.facecolor?(this.color=data.facecolor[0],config.cellColors=parseColorArray(data.facecolor)):(this.color=data.color,config.meshColor=_$str2RgbaArray_561(data.color)),this.mesh.update(config)},__proto_817.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var _$createMesh3DTrace_817=function createMesh3DTrace(scene,data){var gl=scene.glplot.gl,mesh=_$createSimplicialMesh_187({gl:gl}),result=new Mesh3DTrace(scene,mesh,data.uid);return mesh._trace=result,result.update(data),scene.glplot.add(mesh),result},Mesh3D={};Mesh3D.attributes=_$attributes_814,Mesh3D.supplyDefaults=function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_814,attr,dflt)}function readComponents(array){var ret=array.map(function(attr){var result=coerce(attr);return result&&_$lib_539.isArrayOrTypedArray(result)?result:null});return ret.every(function(x){return x&&x.length===ret[0].length})&&ret}var coords=readComponents(["x","y","z"]),indices=readComponents(["i","j","k"]);coords?(indices&&indices.forEach(function(index){for(var i=0;i<index.length;++i)index[i]|=0}),_$registry_668.getComponentMethod("calendars","handleTraceDefaults")(traceIn,traceOut,["x","y","z"],layout),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","contour.show","contour.color","contour.width","colorscale","reversescale","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(x){coerce(x)}),"intensity"in traceIn?(coerce("intensity"),_$colorScaleDefaults_421(traceIn,traceOut,layout,coerce,{prefix:"",cLetter:"c"})):(traceOut.showscale=!1,"facecolor"in traceIn?coerce("facecolor"):"vertexcolor"in traceIn?coerce("vertexcolor"):coerce("color",defaultColor)),coerce("text")):traceOut.visible=!1},Mesh3D.calc=function calc(gd,trace){trace.intensity&&_$calc_418(trace,trace.intensity,"","c")},Mesh3D.colorbar=function colorbar(gd,cd){var trace=cd[0].trace,cbId="cb"+trace.uid,cmin=trace.cmin,cmax=trace.cmax,vals=trace.intensity||[];if(_$fastIsnumeric_139(cmin)||(cmin=_$lib_539.aggNums(Math.min,null,vals)),_$fastIsnumeric_139(cmax)||(cmax=_$lib_539.aggNums(Math.max,null,vals)),gd._fullLayout._infolayer.selectAll("."+cbId).remove(),trace.showscale){var cb=cd[0].t.cb=_$draw_415(gd,cbId),sclFunc=_$colorscale_426.makeColorScaleFunc(_$colorscale_426.extractScale(trace.colorscale,cmin,cmax),{noNumericCheck:!0});cb.fillcolor(sclFunc).filllevels({start:cmin,end:cmax,size:(cmax-cmin)/254}).options(trace.colorbar)()}else _$plots_647.autoMargin(gd,cbId)},Mesh3D.plot=_$createMesh3DTrace_817,Mesh3D.moduleType="trace",Mesh3D.name="mesh3d",Mesh3D.basePlotModule=_$gl3d_627,Mesh3D.categories=["gl3d"],Mesh3D.meta={};var _$mesh3d_21=Mesh3D;function __handleDirection_821(traceIn,traceOut,coerce,direction){_$handleDirectionDefaults_822(traceIn,traceOut,coerce,direction),coerce(direction+".line.color"),coerce(direction+".line.width",traceOut.line.width),coerce(direction+".line.dash",traceOut.line.dash)}var _$transform_826={},____826=_$lib_539._;function __makeTrace_826(traceIn,state,direction){var traceOut={type:"scatter",mode:"lines",connectgaps:!1,visible:traceIn.visible,opacity:traceIn.opacity,xaxis:traceIn.xaxis,yaxis:traceIn.yaxis,hoverinfo:function __makeHoverInfo_826(traceIn){var hoverinfo=traceIn.hoverinfo;if("all"===hoverinfo)return"x+text+name";var parts=hoverinfo.split("+"),indexOfY=parts.indexOf("y"),indexOfText=parts.indexOf("text");-1!==indexOfY&&(parts.splice(indexOfY,1),-1===indexOfText&&parts.push("text"));return parts.join("+")}(traceIn),transforms:_$helpers_823.makeTransform(traceIn,state,direction)},directionOpts=traceIn[direction];return directionOpts&&_$lib_539.extendFlat(traceOut,{x:traceIn.x||[0],xcalendar:traceIn.xcalendar,y:[].concat(traceIn.low).concat(traceIn.high),text:traceIn.text,name:directionOpts.name,showlegend:directionOpts.showlegend,line:directionOpts.line}),traceOut}_$transform_826.moduleType="transform",_$transform_826.name="ohlc",_$transform_826.attributes={},_$transform_826.supplyDefaults=function(transformIn,traceOut,layout,traceIn){return _$helpers_823.clearEphemeralTransformOpts(traceIn),_$helpers_823.copyOHLC(transformIn,traceOut),transformIn},_$transform_826.transform=function transform(dataIn,state){for(var dataOut=[],i=0;i<dataIn.length;i++){var traceIn=dataIn[i];"ohlc"===traceIn.type?dataOut.push(__makeTrace_826(traceIn,state,"increasing"),__makeTrace_826(traceIn,state,"decreasing")):dataOut.push(traceIn)}return _$helpers_823.addRangeSlider(dataOut,state.layout),dataOut},_$transform_826.calcTransform=function calcTransform(gd,trace,opts){var appendX,direction=opts.direction,filterFn=_$helpers_823.getFilterFn(direction),xa=_$axis_ids_587.getFromTrace(gd,trace,"x"),ya=_$axis_ids_587.getFromTrace(gd,trace,"y"),tickWidth=function convertTickWidth(gd,xa,trace){var fullInput=trace._fullInput,tickWidth=fullInput.tickwidth,minDiff=fullInput._minDiff;if(!minDiff){var i,fullData=gd._fullData,ohlcTracesOnThisXaxis=[];for(minDiff=1/0,i=0;i<fullData.length;i++){var _trace=fullData[i]._fullInput;if("ohlc"===_trace.type&&!0===_trace.visible&&_trace.xaxis===xa._id&&(ohlcTracesOnThisXaxis.push(_trace),_trace.x&&_trace.x.length>1)){var xcalc=_$lib_539.simpleMap(_trace.x,xa.d2c,0,trace.xcalendar),_minDiff=_$lib_539.distinctVals(xcalc).minDiff;minDiff=Math.min(minDiff,_minDiff)}}for(minDiff===1/0&&(minDiff=1),i=0;i<ohlcTracesOnThisXaxis.length;i++)ohlcTracesOnThisXaxis[i]._minDiff=minDiff}return minDiff*tickWidth}(gd,xa,trace),open=trace.open,high=trace.high,low=trace.low,close=trace.close,textIn=trace.text,openName=____826(gd,"open:")+" ",highName=____826(gd,"high:")+" ",lowName=____826(gd,"low:")+" ",closeName=____826(gd,"close:")+" ",len=open.length,x=[],y=[],textOut=[];appendX=trace._fullInput.x?function(i){var xi=trace.x[i],xcalendar=trace.xcalendar,xcalc=xa.d2c(xi,0,xcalendar);x.push(xa.c2d(xcalc-tickWidth,0,xcalendar),xi,xi,xi,xi,xa.c2d(xcalc+tickWidth,0,xcalendar),null)}:function(i){x.push(i-tickWidth,i,i,i,i,i+tickWidth,null)};for(var o,h,l,c,format=function(ax,val){return _$axes_584.tickText(ax,ax.c2l(val),"hover").text},hoverinfo=trace._fullInput.hoverinfo,hoverParts=hoverinfo.split("+"),hasAll="all"===hoverinfo,hasY=hasAll||-1!==hoverParts.indexOf("y"),hasText=hasAll||-1!==hoverParts.indexOf("text"),getTextItem=Array.isArray(textIn)?function(i){return textIn[i]||""}:function(){return textIn},appendText=function(i,o,h,l,c){var t=[];hasY&&(t.push(openName+format(ya,o)),t.push(highName+format(ya,h)),t.push(lowName+format(ya,l)),t.push(closeName+format(ya,c))),hasText&&t.push(getTextItem(i));var _t=t.join("<br>");textOut.push(_t,_t,_t,_t,_t,_t,null)},i=0;i<len;i++)filterFn(open[i],close[i])&&_$fastIsnumeric_139(high[i])&&_$fastIsnumeric_139(low[i])&&(appendX(i),o=open[i],h=high[i],l=low[i],c=close[i],y.push(o,o,h,l,c,c,null),appendText(i,open[i],high[i],low[i],close[i]));trace.x=x,trace.y=y,trace.text=textOut,trace._length=x.length};var _$ohlc_824={moduleType:"trace",name:"ohlc",basePlotModule:_$cartesian_595,categories:["cartesian","showLegend"],meta:{},attributes:_$attributes_820,supplyDefaults:function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_820,attr,dflt)}_$helpers_823.pushDummyTransformOpts(traceIn,traceOut),0!==_$handleOHLC_825(traceIn,traceOut,coerce,layout)?(coerce("line.width"),coerce("line.dash"),__handleDirection_821(traceIn,traceOut,coerce,"increasing"),__handleDirection_821(traceIn,traceOut,coerce,"decreasing"),coerce("text"),coerce("tickwidth")):traceOut.visible=!1}};_$registry_668.register(_$Scatter_874),_$registry_668.register(_$transform_826);var da,ea,_$ohlc_22=_$ohlc_824,__domainAttrs_827=_$domain_610.attributes,__extendDeepAll_827=_$extend_528.extendDeepAll,__extendFlat_827=_$extend_528.extendFlat,_$attributes_827={domain:__domainAttrs_827({name:"parcoords",trace:!0,editType:"calc"}),labelfont:_$font_attributes_611({editType:"calc"}),tickfont:_$font_attributes_611({editType:"calc"}),rangefont:_$font_attributes_611({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},tickvals:__extendFlat_827({},_$layout_attributes_596.tickvals,{editType:"calc"}),ticktext:__extendFlat_827({},_$layout_attributes_596.ticktext,{editType:"calc"}),tickformat:{valType:"string",dflt:"3s",editType:"calc"},visible:{valType:"boolean",dflt:!0,editType:"calc"},range:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},constraintrange:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},values:{valType:"data_array",editType:"calc"},editType:"calc"},line:__extendFlat_827(__extendDeepAll_827(_$makeColorScaleAttributes_419(0,"calc"),{colorscale:{dflt:_$scales_430.Viridis},autocolorscale:{dflt:!1}}),{showscale:{valType:"boolean",dflt:!1,editType:"calc"},colorbar:_$attributes_412,editType:"calc"})},_$regl_315={exports:{}};function wrap(d){return[d]}da=this,ea=function(){function da(a,b){this.id=vb++,this.type=a,this.data=b}function Wa(a){return"["+function ea(a){if(0===a.length)return[];var b=a.charAt(0),c=a.charAt(a.length-1);if(1<a.length&&b===c&&('"'===b||"'"===b))return['"'+a.substr(1,a.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(b=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(a))return ea(a.substr(0,b.index)).concat(ea(b[1])).concat(ea(a.substr(b.index+b[0].length)));if(1===(b=a.split(".")).length)return['"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(a=[],c=0;c<b.length;++c)a=a.concat(ea(b[c]));return a}(a).join("][")+"]"}function Xa(a){return"string"==typeof a?a.split():a}function Ya(a){return"string"==typeof a?document.querySelector(a):a}function zb(a){var c,d,f,k,b=a||{};a={};var p=[],h=[],g="undefined"==typeof window?1:window.devicePixelRatio,r=!1,v=function(a){},l=function(){};if("string"==typeof b?c=document.querySelector(b):"object"==typeof b&&("string"==typeof b.nodeName&&"function"==typeof b.appendChild&&"function"==typeof b.getBoundingClientRect?c=b:"function"==typeof b.drawArrays||"function"==typeof b.drawElements?f=(k=b).canvas:("gl"in b?k=b.gl:"canvas"in b?f=Ya(b.canvas):"container"in b&&(d=Ya(b.container)),"attributes"in b&&(a=b.attributes),"extensions"in b&&(p=Xa(b.extensions)),"optionalExtensions"in b&&(h=Xa(b.optionalExtensions)),"onDone"in b&&(v=b.onDone),"profile"in b&&(r=!!b.profile),"pixelRatio"in b&&(g=+b.pixelRatio))),c&&("canvas"===c.nodeName.toLowerCase()?f=c:d=c),!k){if(!f){if(!(c=function xb(a,b,c){function d(){var b=window.innerWidth,d=window.innerHeight;a!==document.body&&(b=(d=a.getBoundingClientRect()).right-d.left,d=d.bottom-d.top),f.width=c*b,f.height=c*d,A(f.style,{width:b+"px",height:d+"px"})}var f=document.createElement("canvas");return A(f.style,{border:0,margin:0,padding:0,top:0,left:0}),a.appendChild(f),a===document.body&&(f.style.position="absolute",A(a.style,{margin:0,padding:0})),window.addEventListener("resize",d,!1),d(),{canvas:f,onDestroy:function(){window.removeEventListener("resize",d),a.removeChild(f)}}}(d||document.body,0,g)))return null;f=c.canvas,l=c.onDestroy}k=function yb(a,b){function c(c){try{return a.getContext(c,b)}catch(f){return null}}return c("webgl")||c("experimental-webgl")||c("webgl-experimental")}(f,a)}return k?{gl:k,canvas:f,container:d,extensions:p,optionalExtensions:h,pixelRatio:g,profile:r,onDone:v,onDestroy:l}:(l(),v("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function ja(a){return!!a&&"object"==typeof a&&Array.isArray(a.shape)&&Array.isArray(a.stride)&&"number"==typeof a.offset&&a.shape.length===a.stride.length&&(Array.isArray(a.data)||O(a.data))}function J(a,b){for(var c=Array(a),d=0;d<a;++d)c[d]=b(d);return c}function Za(a){var b,c;return b=(65535<a)<<4,b|=c=(255<(a>>>=b))<<3,(b|=c=(15<(a>>>=c))<<2)|(c=(3<(a>>>=c))<<1)|a>>>c>>1}function fa(a){a:{for(var b=16;268435456>=b;b*=16)if(a<=b){a=b;break a}a=0}return 0<(b=$a[Za(a)>>2]).length?b.pop():new ArrayBuffer(a)}function ab(a){$a[Za(a.byteLength)>>2].push(a)}function bb(a,b,c,d,f,k){for(var p=0;p<b;++p)for(var h=a[p],g=0;g<c;++g)for(var r=h[g],v=0;v<d;++v)f[k++]=r[v]}function Ga(a){return 0|Ha[Object.prototype.toString.call(a)]}function db(a,b){for(var c=0;c<b.length;++c)a[c]=b[c]}function eb(a,b,c,d,f,k,p){for(var h=0,g=0;g<c;++g)for(var r=0;r<d;++r)a[h++]=b[f*g+k*r+p]}function Bb(a,b,c){function d(b){this.id=h++,this.buffer=a.createBuffer(),this.type=b,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,c.profile&&(this.stats={size:0})}function f(b,c,d){b.byteLength=c.byteLength,a.bufferData(b.type,c,d)}function k(a,b,c,d,e,n){if(a.usage=c,Array.isArray(b)){if(a.dtype=d||5126,0<b.length)if(Array.isArray(b[0])){e=fb(b);for(var D=d=1;D<e.length;++D)d*=e[D];a.dimension=d,f(a,b=Pa(b,e,a.dtype),c),n?a.persistentData=b:x.freeType(b)}else"number"==typeof b[0]?(a.dimension=e,db(e=x.allocType(a.dtype,b.length),b),f(a,e,c),n?a.persistentData=e:x.freeType(e)):O(b[0])&&(a.dimension=b[0].length,a.dtype=d||Ga(b[0])||5126,f(a,b=Pa(b,[b.length,b[0].length],a.dtype),c),n?a.persistentData=b:x.freeType(b))}else if(O(b))a.dtype=d||Ga(b),a.dimension=e,f(a,b,c),n&&(a.persistentData=new Uint8Array(new Uint8Array(b.buffer)));else if(ja(b)){e=b.shape;var g=b.stride,t=(D=b.offset,0),k=0,p=0,r=0;1===e.length?(t=e[0],k=1,p=g[0],r=0):2===e.length&&(t=e[0],k=e[1],p=g[0],r=g[1]),a.dtype=d||Ga(b.data)||5126,a.dimension=k,eb(e=x.allocType(a.dtype,t*k),b.data,t,k,p,r,D),f(a,e,c),n?a.persistentData=e:x.freeType(e)}}function p(c){b.bufferCount--,a.deleteBuffer(c.buffer),c.buffer=null,delete g[c.id]}var h=0,g={};d.prototype.bind=function(){a.bindBuffer(this.type,this.buffer)},d.prototype.destroy=function(){p(this)};var r=[];return c.profile&&(b.getTotalBufferSize=function(){var a=0;return Object.keys(g).forEach(function(b){a+=g[b].stats.size}),a}),{create:function(f,l,u,m){function e(b){var d=35044,g=null,l=0,f=0,u=1;return Array.isArray(b)||O(b)||ja(b)?g=b:"number"==typeof b?l=0|b:b&&("data"in b&&(g=b.data),"usage"in b&&(d=hb[b.usage]),"type"in b&&(f=Qa[b.type]),"dimension"in b&&(u=0|b.dimension),"length"in b&&(l=0|b.length)),n.bind(),g?k(n,g,d,f,u,m):(a.bufferData(n.type,l,d),n.dtype=f||5121,n.usage=d,n.dimension=u,n.byteLength=l),c.profile&&(n.stats.size=n.byteLength*ga[n.dtype]),e}b.bufferCount++;var n=new d(l);return g[n.id]=n,u||e(f),e._reglType="buffer",e._buffer=n,e.subdata=function(b,c){var g,d=0|(c||0);if(n.bind(),O(b))a.bufferSubData(n.type,d,b);else if(Array.isArray(b)){if(0<b.length)if("number"==typeof b[0]){var l=x.allocType(n.dtype,b.length);db(l,b),a.bufferSubData(n.type,d,l),x.freeType(l)}else(Array.isArray(b[0])||O(b[0]))&&(g=fb(b),l=Pa(b,g,n.dtype),a.bufferSubData(n.type,d,l),x.freeType(l))}else if(ja(b)){g=b.shape;var f=b.stride,m=l=0,u=0,k=0;1===g.length?(l=g[0],m=1,u=f[0],k=0):2===g.length&&(l=g[0],m=g[1],u=f[0],k=f[1]),g=Array.isArray(b.data)?n.dtype:Ga(b.data),eb(g=x.allocType(g,l*m),b.data,l,m,u,k,b.offset),a.bufferSubData(n.type,d,g),x.freeType(g)}return e},c.profile&&(e.stats=n.stats),e.destroy=function(){p(n)},e},createStream:function(a,b){var c=r.pop();return c||(c=new d(a)),c.bind(),k(c,b,35040,0,1,!1),c},destroyStream:function(a){r.push(a)},clear:function(){H(g).forEach(p),r.forEach(p)},getBuffer:function(a){return a&&a._buffer instanceof d?a._buffer:null},restore:function(){H(g).forEach(function(b){b.buffer=a.createBuffer(),a.bindBuffer(b.type,b.buffer),a.bufferData(b.type,b.persistentData||b.byteLength,b.usage)})},_initBuffer:k}}function Cb(a,b,c,d){function f(a){this.id=g++,h[this.id]=this,this.buffer=a,this.primType=4,this.type=this.vertCount=0}function k(d,g,f,e,n,k,w){if(d.buffer.bind(),g){var t=w;w||O(g)&&(!ja(g)||O(g.data))||(t=b.oes_element_index_uint?5125:5123),c._initBuffer(d.buffer,g,f,t,3)}else a.bufferData(34963,k,f),d.buffer.dtype=t||5121,d.buffer.usage=f,d.buffer.dimension=3,d.buffer.byteLength=k;if(t=w,!w){switch(d.buffer.dtype){case 5121:case 5120:t=5121;break;case 5123:case 5122:t=5123;break;case 5125:case 5124:t=5125}d.buffer.dtype=t}d.type=t,0>(g=n)&&(g=d.buffer.byteLength,5123===t?g>>=1:5125===t&&(g>>=2)),d.vertCount=g,g=e,0>e&&(g=4,1===(e=d.buffer.dimension)&&(g=0),2===e&&(g=1),3===e&&(g=4)),d.primType=g}function p(a){d.elementsCount--,delete h[a.id],a.buffer.destroy(),a.buffer=null}var h={},g=0,r={uint8:5121,uint16:5123};b.oes_element_index_uint&&(r.uint32=5125),f.prototype.bind=function(){this.buffer.bind()};var v=[];return{create:function(a,b){function g(a){if(a)if("number"==typeof a)e(a),n.primType=4,n.vertCount=0|a,n.type=5121;else{var b=null,c=35044,d=-1,f=-1,l=0,p=0;Array.isArray(a)||O(a)||ja(a)?b=a:("data"in a&&(b=a.data),"usage"in a&&(c=hb[a.usage]),"primitive"in a&&(d=Ra[a.primitive]),"count"in a&&(f=0|a.count),"type"in a&&(p=r[a.type]),"length"in a?l=0|a.length:(l=f,5123===p||5122===p?l*=2:5125!==p&&5124!==p||(l*=4))),k(n,b,c,d,f,l,p)}else e(),n.primType=4,n.vertCount=0,n.type=5121;return g}var e=c.create(null,34963,!0),n=new f(e._buffer);return d.elementsCount++,g(a),g._reglType="elements",g._elements=n,g.subdata=function(a,b){return e.subdata(a,b),g},g.destroy=function(){p(n)},g},createStream:function(a){var b=v.pop();return b||(b=new f(c.create(null,34963,!0,!1)._buffer)),k(b,a,35040,-1,-1,0,0),b},destroyStream:function(a){v.push(a)},getElements:function(a){return"function"==typeof a&&a._elements instanceof f?a._elements:null},clear:function(){H(h).forEach(p)}}}function ib(a){for(var b=x.allocType(5123,a.length),c=0;c<a.length;++c)if(isNaN(a[c]))b[c]=65535;else if(1/0===a[c])b[c]=31744;else if(-1/0===a[c])b[c]=64512;else{jb[0]=a[c];var f=(d=Db[0])>>>31<<15,k=(d<<1>>>24)-127,d=d>>13&1023;b[c]=-24>k?f:-14>k?f+(d+1024>>-14-k):15<k?f+31744:f+(k+15<<10)+d}return b}function na(a){return Array.isArray(a)||O(a)}function kb(a){return Array.isArray(a)&&(0===a.length||"number"==typeof a[0])}function lb(a){return!(!Array.isArray(a)||0===a.length||!na(a[0]))}function oa(a){return Object.prototype.toString.call(a)}function Sa(a){if(!a)return!1;var b=oa(a);return 0<=Eb.indexOf(b)||(kb(a)||lb(a)||ja(a))}function mb(a,b){36193===a.type?(a.data=ib(b),x.freeType(b)):a.data=b}function Ia(a,b,c,d,f,k){if(a=void 0!==C[a]?C[a]:R[a]*za[b],k&&(a*=6),f){for(d=0;1<=c;)d+=a*c*c,c/=2;return d}return a*c*d}function Fb(a,b,c,d,f,k,p){function h(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function g(a,b){a.internalformat=b.internalformat,a.format=b.format,a.type=b.type,a.compressed=b.compressed,a.premultiplyAlpha=b.premultiplyAlpha,a.flipY=b.flipY,a.unpackAlignment=b.unpackAlignment,a.colorSpace=b.colorSpace,a.width=b.width,a.height=b.height,a.channels=b.channels}function r(a,b){if("object"==typeof b&&b){"premultiplyAlpha"in b&&(a.premultiplyAlpha=b.premultiplyAlpha),"flipY"in b&&(a.flipY=b.flipY),"alignment"in b&&(a.unpackAlignment=b.alignment),"colorSpace"in b&&(a.colorSpace=ua[b.colorSpace]),"type"in b&&(a.type=E[b.type]);var c=a.width,g=a.height,e=a.channels,d=!1;"shape"in b?(c=b.shape[0],g=b.shape[1],3===b.shape.length&&(e=b.shape[2],d=!0)):("radius"in b&&(c=g=b.radius),"width"in b&&(c=b.width),"height"in b&&(g=b.height),"channels"in b&&(e=b.channels,d=!0)),a.width=0|c,a.height=0|g,a.channels=0|e,c=!1,"format"in b&&(c=b.format,g=a.internalformat=S[c],a.format=Gb[g],c in E&&!("type"in b)&&(a.type=E[c]),c in U&&(a.compressed=!0),c=!0),!d&&c?a.channels=R[a.format]:d&&!c&&a.channels!==Ka[a.format]&&(a.format=a.internalformat=Ka[a.channels])}}function v(b){a.pixelStorei(37440,b.flipY),a.pixelStorei(37441,b.premultiplyAlpha),a.pixelStorei(37443,b.colorSpace),a.pixelStorei(3317,b.unpackAlignment)}function l(){h.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function u(a,b){var c=null;if(Sa(b)?c=b:b&&(r(a,b),"x"in b&&(a.xOffset=0|b.x),"y"in b&&(a.yOffset=0|b.y),Sa(b.data)&&(c=b.data)),b.copy){var g=f.viewportWidth,e=f.viewportHeight;a.width=a.width||g-a.xOffset,a.height=a.height||e-a.yOffset,a.needsCopy=!0}else if(c){if(O(c))a.channels=a.channels||4,a.data=c,"type"in b||5121!==a.type||(a.type=0|Ha[Object.prototype.toString.call(c)]);else if(kb(c)){switch(a.channels=a.channels||4,e=(g=c).length,a.type){case 5121:case 5123:case 5125:case 5126:(e=x.allocType(a.type,e)).set(g),a.data=e;break;case 36193:a.data=ib(g)}a.alignment=1,a.needsFree=!0}else if(ja(c)){g=c.data,Array.isArray(g)||5121!==a.type||(a.type=0|Ha[Object.prototype.toString.call(g)]);e=c.shape;var n,l,q,y,d=c.stride;3===e.length?(q=e[2],y=d[2]):y=q=1,n=e[0],l=e[1],e=d[0],d=d[1],a.alignment=1,a.width=n,a.height=l,a.channels=q,a.format=a.internalformat=Ka[q],a.needsFree=!0,n=y,c=c.offset,q=a.width,y=a.height,l=a.channels;for(var K=x.allocType(36193===a.type?5126:a.type,q*y*l),aa=0,va=0;va<y;++va)for(var wa=0;wa<q;++wa)for(var ca=0;ca<l;++ca)K[aa++]=g[e*wa+d*va+n*ca+c];mb(a,K)}else if("[object HTMLCanvasElement]"===oa(c)||"[object CanvasRenderingContext2D]"===oa(c))"[object HTMLCanvasElement]"===oa(c)?a.element=c:a.element=c.canvas,a.width=a.element.width,a.height=a.element.height,a.channels=4;else if("[object HTMLImageElement]"===oa(c))a.element=c,a.width=c.naturalWidth,a.height=c.naturalHeight,a.channels=4;else if("[object HTMLVideoElement]"===oa(c))a.element=c,a.width=c.videoWidth,a.height=c.videoHeight,a.channels=4;else if(lb(c)){for(g=a.width||c[0].length,e=a.height||c.length,d=a.channels,d=na(c[0][0])?d||c[0][0].length:d||1,n=La.shape(c),q=1,y=0;y<n.length;++y)q*=n[y];q=x.allocType(36193===a.type?5126:a.type,q),La.flatten(c,n,"",q),mb(a,q),a.alignment=1,a.width=g,a.height=e,a.channels=d,a.format=a.internalformat=Ka[d],a.needsFree=!0}}else a.width=a.width||1,a.height=a.height||1,a.channels=a.channels||4}function m(b,c,g,e,f){var n=b.element,l=b.data,k=b.internalformat,q=b.format,y=b.type,K=b.width,aa=b.height;v(b),n?a.texSubImage2D(c,f,g,e,q,y,n):b.compressed?a.compressedTexSubImage2D(c,f,g,e,k,K,aa,l):b.needsCopy?(d(),a.copyTexSubImage2D(c,f,g,e,b.xOffset,b.yOffset,K,aa)):a.texSubImage2D(c,f,g,e,K,aa,q,y,l)}function e(){return N.pop()||new l}function n(a){a.needsFree&&x.freeType(a.data),l.call(a),N.push(a)}function w(a,b,c){var g=a.images[0]=e();a.mipmask=1,g.width=a.width=b,g.height=a.height=c,g.channels=a.channels=4}function t(a,b){var c=null;if(Sa(b))g(c=a.images[0]=e(),a),u(c,b),a.mipmask=1;else if(r(a,b),Array.isArray(b.mipmap))for(var d=b.mipmap,f=0;f<d.length;++f)g(c=a.images[f]=e(),a),c.width>>=f,c.height>>=f,u(c,d[f]),a.mipmask|=1<<f;else g(c=a.images[0]=e(),a),u(c,b),a.mipmask=1;g(a,a.images[0])}function Z(b,c){for(var g=b.images,e=0;e<g.length&&g[e];++e){var f=g[e],n=c,l=e,k=f.element,q=f.data,y=f.internalformat,K=f.format,aa=f.type,va=f.width,wa=f.height;v(f),k?a.texImage2D(n,l,K,K,aa,k):f.compressed?a.compressedTexImage2D(n,l,y,va,wa,0,q):f.needsCopy?(d(),a.copyTexImage2D(n,l,K,f.xOffset,f.yOffset,va,wa,0)):a.texImage2D(n,l,K,va,wa,0,K,aa,q)}}function B(){var a=nb.pop()||new function D(){h.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)};h.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function gb(a){for(var b=a.images,c=0;c<b.length;++c)b[c]&&n(b[c]),b[c]=null;nb.push(a)}function C(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function M(a,b){"min"in b&&(a.minFilter=Ta[b.min],0<=Hb.indexOf(a.minFilter)&&(a.genMipmaps=!0)),"mag"in b&&(a.magFilter=T[b.mag]);var c=a.wrapS,g=a.wrapT;if("wrap"in b){var e=b.wrap;"string"==typeof e?c=g=I[e]:Array.isArray(e)&&(c=I[e[0]],g=I[e[1]])}else"wrapS"in b&&(c=I[b.wrapS]),"wrapT"in b&&(g=I[b.wrapT]);if(a.wrapS=c,a.wrapT=g,"anisotropic"in b&&(a.anisotropic=b.anisotropic),"mipmap"in b){switch(c=!1,typeof b.mipmap){case"string":a.mipmapHint=sa[b.mipmap],c=a.genMipmaps=!0;break;case"boolean":c=a.genMipmaps=b.mipmap;break;case"object":a.genMipmaps=!1,c=!0}!c||"min"in b||(a.minFilter=9984)}}function P(c,g){a.texParameteri(g,10241,c.minFilter),a.texParameteri(g,10240,c.magFilter),a.texParameteri(g,10242,c.wrapS),a.texParameteri(g,10243,c.wrapT),b.ext_texture_filter_anisotropic&&a.texParameteri(g,34046,c.anisotropic),c.genMipmaps&&(a.hint(33170,c.mipmapHint),a.generateMipmap(g))}function G(b){h.call(this),this.mipmask=0,this.internalformat=6408,this.id=xa++,this.refCount=1,this.target=b,this.texture=a.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new C,p.profile&&(this.stats={size:0})}function Q(b){a.activeTexture(33984),a.bindTexture(b.target,b.texture)}function Aa(){var b=ka[0];b?a.bindTexture(b.target,b.texture):a.bindTexture(3553,null)}function z(b){var c=b.texture,g=b.unit,e=b.target;0<=g&&(a.activeTexture(33984+g),a.bindTexture(e,null),ka[g]=null),a.deleteTexture(c),b.texture=null,b.params=null,b.pixels=null,b.refCount=0,delete V[b.id],k.textureCount--}var sa={"don't care":4352,"dont care":4352,nice:4354,fast:4353},I={repeat:10497,clamp:33071,mirror:33648},T={nearest:9728,linear:9729},Ta=A({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},T),ua={none:0,browser:37444},E={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},S={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},U={};b.ext_srgb&&(S.srgb=35904,S.srgba=35906),b.oes_texture_float&&(E.float32=E.float=5126),b.oes_texture_half_float&&(E.float16=E["half float"]=36193),b.webgl_depth_texture&&(A(S,{depth:6402,"depth stencil":34041}),A(E,{uint16:5123,uint32:5125,"depth stencil":34042})),b.webgl_compressed_texture_s3tc&&A(U,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),b.webgl_compressed_texture_atc&&A(U,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),b.webgl_compressed_texture_pvrtc&&A(U,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),b.webgl_compressed_texture_etc1&&(U["rgb etc1"]=36196);var Ib=Array.prototype.slice.call(a.getParameter(34467));Object.keys(U).forEach(function(a){var b=U[a];0<=Ib.indexOf(b)&&(S[a]=b)});var ba=Object.keys(S);c.textureFormats=ba;var J=[];Object.keys(S).forEach(function(a){J[S[a]]=a});var W=[];Object.keys(E).forEach(function(a){W[E[a]]=a});var la=[];Object.keys(T).forEach(function(a){la[T[a]]=a});var ya=[];Object.keys(Ta).forEach(function(a){ya[Ta[a]]=a});var ha=[];Object.keys(I).forEach(function(a){ha[I[a]]=a});var Gb=ba.reduce(function(a,b){var c=S[b];return 6409===c||6406===c||6409===c||6410===c||6402===c||34041===c?a[c]=c:32855===c||0<=b.indexOf("rgba")?a[c]=6408:a[c]=6407,a},{}),N=[],nb=[],xa=0,V={},ma=c.maxTextureUnits,ka=Array(ma).map(function(){return null});return A(G.prototype,{bind:function(){this.bindCount+=1;var b=this.unit;if(0>b){for(var c=0;c<ma;++c){var g=ka[c];if(g){if(0<g.bindCount)continue;g.unit=-1}ka[c]=this,b=c;break}p.profile&&k.maxTextureUnits<b+1&&(k.maxTextureUnits=b+1),this.unit=b,a.activeTexture(33984+b),a.bindTexture(this.target,this.texture)}return b},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&z(this)}}),p.profile&&(k.getTotalTextureSize=function(){var a=0;return Object.keys(V).forEach(function(b){a+=V[b].stats.size}),a}),{create2D:function(b,c){function d(a,b){var c=f.texInfo;C.call(c);var e=B();return"number"==typeof a?w(e,0|a,"number"==typeof b?0|b:0|a):a?(M(c,a),t(e,a)):w(e,1,1),c.genMipmaps&&(e.mipmask=(e.width<<1)-1),f.mipmask=e.mipmask,g(f,e),f.internalformat=e.internalformat,d.width=e.width,d.height=e.height,Q(f),Z(e,3553),P(c,3553),Aa(),gb(e),p.profile&&(f.stats.size=Ia(f.internalformat,f.type,e.width,e.height,c.genMipmaps,!1)),d.format=J[f.internalformat],d.type=W[f.type],d.mag=la[c.magFilter],d.min=ya[c.minFilter],d.wrapS=ha[c.wrapS],d.wrapT=ha[c.wrapT],d}var f=new G(3553);return V[f.id]=f,k.textureCount++,d(b,c),d.subimage=function(a,b,c,l){b|=0,c|=0,l|=0;var q=e();return g(q,f),q.width=0,q.height=0,u(q,a),q.width=q.width||(f.width>>l)-b,q.height=q.height||(f.height>>l)-c,Q(f),m(q,3553,b,c,l),Aa(),n(q),d},d.resize=function(b,c){var e=0|b,g=0|c||e;if(e===f.width&&g===f.height)return d;d.width=f.width=e,d.height=f.height=g,Q(f);for(var q=0;f.mipmask>>q;++q)a.texImage2D(3553,q,f.format,e>>q,g>>q,0,f.format,f.type,null);return Aa(),p.profile&&(f.stats.size=Ia(f.internalformat,f.type,e,g,!1,!1)),d},d._reglType="texture2d",d._texture=f,p.profile&&(d.stats=f.stats),d.destroy=function(){f.decRef()},d},createCube:function(b,c,d,f,l,sa){function z(a,b,c,e,d,f){var F,X=h.texInfo;for(C.call(X),F=0;6>F;++F)q[F]=B();if("number"!=typeof a&&a){if("object"==typeof a)if(b)t(q[0],a),t(q[1],b),t(q[2],c),t(q[3],e),t(q[4],d),t(q[5],f);else if(M(X,a),r(h,a),"faces"in a)for(a=a.faces,F=0;6>F;++F)g(q[F],h),t(q[F],a[F]);else for(F=0;6>F;++F)t(q[F],a)}else for(a=0|a||1,F=0;6>F;++F)w(q[F],a,a);for(g(h,q[0]),h.mipmask=X.genMipmaps?(q[0].width<<1)-1:q[0].mipmask,h.internalformat=q[0].internalformat,z.width=q[0].width,z.height=q[0].height,Q(h),F=0;6>F;++F)Z(q[F],34069+F);for(P(X,34067),Aa(),p.profile&&(h.stats.size=Ia(h.internalformat,h.type,z.width,z.height,X.genMipmaps,!0)),z.format=J[h.internalformat],z.type=W[h.type],z.mag=la[X.magFilter],z.min=ya[X.minFilter],z.wrapS=ha[X.wrapS],z.wrapT=ha[X.wrapT],F=0;6>F;++F)gb(q[F]);return z}var h=new G(34067);V[h.id]=h,k.cubeCount++;var q=Array(6);return z(b,c,d,f,l,sa),z.subimage=function(a,b,c,q,d){c|=0,q|=0,d|=0;var f=e();return g(f,h),f.width=0,f.height=0,u(f,b),f.width=f.width||(h.width>>d)-c,f.height=f.height||(h.height>>d)-q,Q(h),m(f,34069+a,c,q,d),Aa(),n(f),z},z.resize=function(b){if((b|=0)!==h.width){z.width=h.width=b,z.height=h.height=b,Q(h);for(var c=0;6>c;++c)for(var q=0;h.mipmask>>q;++q)a.texImage2D(34069+c,q,h.format,b>>q,b>>q,0,h.format,h.type,null);return Aa(),p.profile&&(h.stats.size=Ia(h.internalformat,h.type,z.width,z.height,!1,!0)),z}},z._reglType="textureCube",z._texture=h,p.profile&&(z.stats=h.stats),z.destroy=function(){h.decRef()},z},clear:function(){for(var b=0;b<ma;++b)a.activeTexture(33984+b),a.bindTexture(3553,null),ka[b]=null;H(V).forEach(z),k.cubeCount=0,k.textureCount=0},getTexture:function(a){return null},restore:function(){H(V).forEach(function(b){b.texture=a.createTexture(),a.bindTexture(b.target,b.texture);for(var c=0;32>c;++c)if(0!=(b.mipmask&1<<c))if(3553===b.target)a.texImage2D(3553,c,b.internalformat,b.width>>c,b.height>>c,0,b.internalformat,b.type,null);else for(var e=0;6>e;++e)a.texImage2D(34069+e,c,b.internalformat,b.width>>c,b.height>>c,0,b.internalformat,b.type,null);P(b.texInfo,b.target)})}}}function Jb(a,b,c,d,f,k){function p(a,b,c){this.target=a,this.texture=b,this.renderbuffer=c;var e=a=0;b?(a=b.width,e=b.height):c&&(a=c.width,e=c.height),this.width=a,this.height=e}function h(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function g(a,b,c){a&&(a.texture?a.texture._texture.refCount+=1:a.renderbuffer._renderbuffer.refCount+=1)}function r(b,c){c&&(c.texture?a.framebufferTexture2D(36160,b,c.target,c.texture._texture.texture,0):a.framebufferRenderbuffer(36160,b,36161,c.renderbuffer._renderbuffer.renderbuffer))}function v(a){var b=3553,c=null,e=null,g=a;return"object"==typeof a&&(g=a.data,"target"in a&&(b=0|a.target)),"texture2d"===(a=g._reglType)?c=g:"textureCube"===a?c=g:"renderbuffer"===a&&(e=g,b=36161),new p(b,c,e)}function l(a,b,c,e,g){return c?((a=d.create2D({width:a,height:b,format:e,type:g}))._texture.refCount=0,new p(3553,a,null)):((a=f.create({width:a,height:b,format:e}))._renderbuffer.refCount=0,new p(36161,null,a))}function u(a){return a&&(a.texture||a.renderbuffer)}function m(a,b,c){a&&(a.texture?a.texture.resize(b,c):a.renderbuffer&&a.renderbuffer.resize(b,c))}function e(){this.id=M++,P[this.id]=this,this.framebuffer=a.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function n(a){a.colorAttachments.forEach(h),h(a.depthAttachment),h(a.stencilAttachment),h(a.depthStencilAttachment)}function D(b){a.deleteFramebuffer(b.framebuffer),b.framebuffer=null,k.framebufferCount--,delete P[b.id]}function w(b){var e;a.bindFramebuffer(36160,b.framebuffer);var g=b.colorAttachments;for(e=0;e<g.length;++e)r(36064+e,g[e]);for(e=g.length;e<c.maxColorAttachments;++e)a.framebufferTexture2D(36160,36064+e,3553,null,0);a.framebufferTexture2D(36160,33306,3553,null,0),a.framebufferTexture2D(36160,36096,3553,null,0),a.framebufferTexture2D(36160,36128,3553,null,0),r(36096,b.depthAttachment),r(36128,b.stencilAttachment),r(33306,b.depthStencilAttachment),a.checkFramebufferStatus(36160),a.bindFramebuffer(36160,Z.next),Z.cur=Z.next,a.getError()}function t(a,b){function c(a,b){var e,f=0,h=0,k=!0,m=!0;e=null;var p=!0,t="rgba",r="uint8",D=1,W=null,la=null,Z=null,ha=!1;"number"==typeof a?(f=0|a,h=0|b||f):a?("shape"in a?(f=(h=a.shape)[0],h=h[1]):("radius"in a&&(f=h=a.radius),"width"in a&&(f=a.width),"height"in a&&(h=a.height)),("color"in a||"colors"in a)&&(e=a.color||a.colors,Array.isArray(e)),e||("colorCount"in a&&(D=0|a.colorCount),"colorTexture"in a&&(p=!!a.colorTexture,t="rgba4"),"colorType"in a&&(r=a.colorType,!p)&&("half float"===r||"float16"===r?t="rgba16f":"float"!==r&&"float32"!==r||(t="rgba32f")),"colorFormat"in a&&(t=a.colorFormat,0<=B.indexOf(t)?p=!0:0<=C.indexOf(t)&&(p=!1))),("depthTexture"in a||"depthStencilTexture"in a)&&(ha=!(!a.depthTexture&&!a.depthStencilTexture)),"depth"in a&&("boolean"==typeof a.depth?k=a.depth:(W=a.depth,m=!1)),"stencil"in a&&("boolean"==typeof a.stencil?m=a.stencil:(la=a.stencil,k=!1)),"depthStencil"in a&&("boolean"==typeof a.depthStencil?k=m=a.depthStencil:(Z=a.depthStencil,m=k=!1))):f=h=1;var G=null,A=null,Q=null,x=null;if(Array.isArray(e))G=e.map(v);else if(e)G=[v(e)];else for(G=Array(D),e=0;e<D;++e)G[e]=l(f,h,p,t,r);for(f=f||G[0].width,h=h||G[0].height,W?A=v(W):k&&!m&&(A=l(f,h,ha,"depth","uint32")),la?Q=v(la):m&&!k&&(Q=l(f,h,!1,"stencil","uint8")),Z?x=v(Z):!W&&!la&&m&&k&&(x=l(f,h,ha,"depth stencil","depth stencil")),k=null,e=0;e<G.length;++e)g(G[e]),G[e]&&G[e].texture&&(m=ob[G[e].texture._texture.format]*Ma[G[e].texture._texture.type],null===k&&(k=m));return g(A),g(Q),g(x),n(d),d.width=f,d.height=h,d.colorAttachments=G,d.depthAttachment=A,d.stencilAttachment=Q,d.depthStencilAttachment=x,c.color=G.map(u),c.depth=u(A),c.stencil=u(Q),c.depthStencil=u(x),c.width=d.width,c.height=d.height,w(d),c}var d=new e;return k.framebufferCount++,c(a,b),A(c,{resize:function(a,b){var e=0|a,g=0|b||e;if(e===d.width&&g===d.height)return c;for(var f=d.colorAttachments,h=0;h<f.length;++h)m(f[h],e,g);return m(d.depthAttachment,e,g),m(d.stencilAttachment,e,g),m(d.depthStencilAttachment,e,g),d.width=c.width=e,d.height=c.height=g,w(d),c},_reglType:"framebuffer",_framebuffer:d,destroy:function(){D(d),n(d)},use:function(a){Z.setFBO({framebuffer:c},a)}})}var Z={cur:null,next:null,dirty:!1,setFBO:null},B=["rgba"],C=["rgba4","rgb565","rgb5 a1"];b.ext_srgb&&C.push("srgba"),b.ext_color_buffer_half_float&&C.push("rgba16f","rgb16f"),b.webgl_color_buffer_float&&C.push("rgba32f");var x=["uint8"];b.oes_texture_half_float&&x.push("half float","float16"),b.oes_texture_float&&x.push("float","float32");var M=0,P={};return A(Z,{getFramebuffer:function(a){return"function"==typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer)instanceof e?a:null},create:t,createCube:function(a){function b(a){var e,g={color:null},f=0,h=null;e="rgba";var l="uint8",n=1;if("number"==typeof a?f=0|a:a?("shape"in a?f=a.shape[0]:("radius"in a&&(f=0|a.radius),"width"in a?f=0|a.width:"height"in a&&(f=0|a.height)),("color"in a||"colors"in a)&&(h=a.color||a.colors,Array.isArray(h)),h||("colorCount"in a&&(n=0|a.colorCount),"colorType"in a&&(l=a.colorType),"colorFormat"in a&&(e=a.colorFormat)),"depth"in a&&(g.depth=a.depth),"stencil"in a&&(g.stencil=a.stencil),"depthStencil"in a&&(g.depthStencil=a.depthStencil)):f=1,h)if(Array.isArray(h))for(a=[],e=0;e<h.length;++e)a[e]=h[e];else a=[h];else for(a=Array(n),h={radius:f,format:e,type:l},e=0;e<n;++e)a[e]=d.createCube(h);for(g.color=Array(a.length),e=0;e<a.length;++e)n=a[e],f=f||n.width,g.color[e]={target:34069,data:a[e]};for(e=0;6>e;++e){for(n=0;n<a.length;++n)g.color[n].target=34069+e;0<e&&(g.depth=c[0].depth,g.stencil=c[0].stencil,g.depthStencil=c[0].depthStencil),c[e]?c[e](g):c[e]=t(g)}return A(b,{width:f,height:f,color:a})}var c=Array(6);return b(a),A(b,{faces:c,resize:function(a){var e=0|a;if(e===b.width)return b;var g=b.color;for(a=0;a<g.length;++a)g[a].resize(e);for(a=0;6>a;++a)c[a].resize(e);return b.width=b.height=e,b},_reglType:"framebufferCube",destroy:function(){c.forEach(function(a){a.destroy()})}})},clear:function(){H(P).forEach(D)},restore:function(){H(P).forEach(function(b){b.framebuffer=a.createFramebuffer(),w(b)})}})}function pb(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function Lb(a,b,c,d){function f(a,b,c,g){this.name=a,this.id=b,this.location=c,this.info=g}function k(a,b){for(var c=0;c<a.length;++c)if(a[c].id===b.id)return void(a[c].location=b.location);a.push(b)}function p(c,g,d){if(!(f=(d=35632===c?r:v)[g])){var h=b.str(g),f=a.createShader(c);a.shaderSource(f,h),a.compileShader(f),d[g]=f}return f}function h(a,b){this.id=m++,this.fragId=a,this.vertId=b,this.program=null,this.uniforms=[],this.attributes=[],d.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function g(c,g){var h,l;h=p(35632,c.fragId),l=p(35633,c.vertId);var m=c.program=a.createProgram();a.attachShader(m,h),a.attachShader(m,l),a.linkProgram(m);var r=a.getProgramParameter(m,35718);d.profile&&(c.stats.uniformsCount=r);var u=c.uniforms;for(h=0;h<r;++h)if(l=a.getActiveUniform(m,h))if(1<l.size)for(var v=0;v<l.size;++v){var A=l.name.replace("[0]","["+v+"]");k(u,new f(A,b.id(A),a.getUniformLocation(m,A),l))}else k(u,new f(l.name,b.id(l.name),a.getUniformLocation(m,l.name),l));for(r=a.getProgramParameter(m,35721),d.profile&&(c.stats.attributesCount=r),u=c.attributes,h=0;h<r;++h)(l=a.getActiveAttrib(m,h))&&k(u,new f(l.name,b.id(l.name),a.getAttribLocation(m,l.name),l))}var r={},v={},l={},u=[],m=0;return d.profile&&(c.getMaxUniformsCount=function(){var a=0;return u.forEach(function(b){b.stats.uniformsCount>a&&(a=b.stats.uniformsCount)}),a},c.getMaxAttributesCount=function(){var a=0;return u.forEach(function(b){b.stats.attributesCount>a&&(a=b.stats.attributesCount)}),a}),{clear:function(){var b=a.deleteShader.bind(a);H(r).forEach(b),r={},H(v).forEach(b),v={},u.forEach(function(b){a.deleteProgram(b.program)}),u.length=0,l={},c.shaderCount=0},program:function(a,b,f){var d=l[b];d||(d=l[b]={});var m=d[a];return m||(m=new h(b,a),c.shaderCount++,g(m),d[a]=m,u.push(m)),m},restore:function(){r={},v={};for(var a=0;a<u.length;++a)g(u[a])},shader:p,frag:-1,vert:-1}}function Mb(a,b,c,d,f,k){function p(g){var f;f=null===b.next?5121:b.next.colorAttachments[0].texture._texture.type;var h=0,l=0,k=d.framebufferWidth,m=d.framebufferHeight,e=null;return O(g)?e=g:g&&(h=0|g.x,l=0|g.y,k=0|(g.width||d.framebufferWidth-h),m=0|(g.height||d.framebufferHeight-l),e=g.data||null),c(),g=k*m*4,e||(5121===f?e=new Uint8Array(g):5126===f&&(e=e||new Float32Array(g))),a.pixelStorei(3333,4),a.readPixels(h,l,k,m,6408,f,e),e}return function(a){return a&&"framebuffer"in a?function h(a){var c;return b.setFBO({framebuffer:a.framebuffer},function(){c=p(a)}),c}(a):p(a)}}function Ba(a){return Array.prototype.slice.call(a)}function Ca(a){return Ba(a).join("")}function Nb(){function a(){var a=[],b=[];return A(function(){a.push.apply(a,Ba(arguments))},{def:function(){var f="v"+c++;return b.push(f),0<arguments.length&&(a.push(f,"="),a.push.apply(a,Ba(arguments)),a.push(";")),f},toString:function(){return Ca([0<b.length?"var "+b+";":"",Ca(a)])}})}function b(){function b(a,d){f(a,d,"=",c.def(a,d),";")}var c=a(),f=a(),d=c.toString,l=f.toString;return A(function(){c.apply(c,Ba(arguments))},{def:c.def,entry:c,exit:f,save:b,set:function(a,f,e){b(a,f),c(a,f,"=",e,";")},toString:function(){return d()+l()}})}var c=0,d=[],f=[],k=a(),p={};return{global:k,link:function(a){for(var b=0;b<f.length;++b)if(f[b]===a)return d[b];return b="g"+c++,d.push(b),f.push(a),b},block:a,proc:function(a,c){function f(){var a="a"+d.length;return d.push(a),a}var d=[];c=c||0;for(var l=0;l<c;++l)f();var k=(l=b()).toString;return p[a]=A(l,{arg:f,toString:function(){return Ca(["function(",d.join(),"){",k(),"}"])}})},scope:b,cond:function(){var a=Ca(arguments),c=b(),f=b(),d=c.toString,l=f.toString;return A(c,{then:function(){return c.apply(c,Ba(arguments)),this},else:function(){return f.apply(f,Ba(arguments)),this},toString:function(){var b=l();return b&&(b="else{"+b+"}"),Ca(["if(",a,"){",d(),"}",b])}})},compile:function(){var a=['"use strict";',k,"return {"];Object.keys(p).forEach(function(b){a.push('"',b,'":',p[b].toString(),",")}),a.push("}");var b=Ca(a).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,d.concat(b)).apply(null,f)}}}function Na(a){return Array.isArray(a)||O(a)||ja(a)}function qb(a){return a.sort(function(a,c){return"viewport"===a?-1:"viewport"===c?1:a<c?-1:1})}function Y(a,b,c,d){this.thisDep=a,this.contextDep=b,this.propDep=c,this.append=d}function ta(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function B(a){return new Y(!1,!1,!1,a)}function N(a,b){var c=a.type;return 0===c?new Y(!0,1<=(c=a.data.length),2<=c,b):4===c?new Y((c=a.data).thisDep,c.contextDep,c.propDep,b):new Y(3===c,2===c,1===c,b)}function Ob(a,b,c,d,f,k,p,h,g,r,v,l,u,m,e){function n(a){return a.replace(".","_")}function D(a,b,c){var e=n(a);Ja.push(a),Ea[e]=pa[e]=!!c,qa[e]=b}function w(a,b,c){var e=n(a);Ja.push(a),Array.isArray(c)?(pa[e]=c.slice(),Ea[e]=c.slice()):pa[e]=Ea[e]=c,ra[e]=b}function t(){var a=Nb(),c=a.link,e=a.global;a.id=oa++,a.batchId="0";var f=c(ga),d=a.shared={props:"a0"};Object.keys(ga).forEach(function(a){d[a]=e.def(f,".",a)});var g=a.next={},ca=a.current={};Object.keys(ra).forEach(function(a){Array.isArray(pa[a])&&(g[a]=e.def(d.next,".",a),ca[a]=e.def(d.current,".",a))});var F=a.constants={};Object.keys(da).forEach(function(a){F[a]=e.def(JSON.stringify(da[a]))}),a.invoke=function(b,e){switch(e.type){case 0:var X=["this",d.context,d.props,a.batchId];return b.def(c(e.data),".call(",X.slice(0,Math.max(e.data.length+1,4)),")");case 1:return b.def(d.props,e.data);case 2:return b.def(d.context,e.data);case 3:return b.def("this",e.data);case 4:return e.data.append(a,b),e.data.ref}},a.attribCache={};var X={};return a.scopeAttrib=function(a){if((a=b.id(a))in X)return X[a];var e=r.scope[a];return e||(e=r.scope[a]=new xa),X[a]=c(e)},a}function A(a,b){var c=a.static,e=a.dynamic;if("framebuffer"in c){var f=c.framebuffer;return f?(f=h.getFramebuffer(f),B(function(a,b){var c=a.link(f),e=a.shared;return b.set(e.framebuffer,".next",c),e=e.context,b.set(e,".framebufferWidth",c+".width"),b.set(e,".framebufferHeight",c+".height"),c})):B(function(a,b){var c=a.shared;return b.set(c.framebuffer,".next","null"),c=c.context,b.set(c,".framebufferWidth",c+".drawingBufferWidth"),b.set(c,".framebufferHeight",c+".drawingBufferHeight"),"null"})}if("framebuffer"in e){var d=e.framebuffer;return N(d,function(a,b){var c=a.invoke(b,d),e=a.shared,q=e.framebuffer;c=b.def(q,".getFramebuffer(",c,")");return b.set(q,".next",c),e=e.context,b.set(e,".framebufferWidth",c+"?"+c+".width:"+e+".drawingBufferWidth"),b.set(e,".framebufferHeight",c+"?"+c+".height:"+e+".drawingBufferHeight"),c})}return null}function C(a){function c(a){if(a in e){var d=b.id(e[a]);return(a=B(function(){return d})).id=d,a}if(a in f){var q=f[a];return N(q,function(a,b){var c=a.invoke(b,q);return b.def(a.shared.strings,".id(",c,")")})}return null}var e=a.static,f=a.dynamic,d=c("frag"),g=c("vert"),ca=null;return ta(d)&&ta(g)?(ca=v.program(g.id,d.id),a=B(function(a,b){return a.link(ca)})):a=new Y(d&&d.thisDep||g&&g.thisDep,d&&d.contextDep||g&&g.contextDep,d&&d.propDep||g&&g.propDep,function(a,b){var e,f,c=a.shared.shader;return e=d?d.append(a,b):b.def(c,".","frag"),f=g?g.append(a,b):b.def(c,".","vert"),b.def(c+".program("+f+","+e+")")}),{frag:d,vert:g,progVar:a,program:ca}}function M(a,b){function c(a,b){if(a in e){var q=0|e[a];return B(function(a,c){return b&&(a.OFFSET=q),q})}if(a in f){var g=f[a];return N(g,function(a,c){var e=a.invoke(c,g);return b&&(a.OFFSET=e),e})}return b&&d?B(function(a,b){return a.OFFSET="0",0}):null}var e=a.static,f=a.dynamic,d=function(){if("elements"in e){var a=e.elements;Na(a)?a=k.getElements(k.create(a,!0)):a&&(a=k.getElements(a));var b=B(function(b,c){if(a){var e=b.link(a);return b.ELEMENTS=e}return b.ELEMENTS=null});return b.value=a,b}if("elements"in f){var c=f.elements;return N(c,function(a,b){var d=(e=a.shared).isBufferArgs,e=e.elements,f=a.invoke(b,c),q=b.def("null");d=b.def(d,"(",f,")"),f=a.cond(d).then(q,"=",e,".createStream(",f,");").else(q,"=",e,".getElements(",f,");");return b.entry(f),b.exit(a.cond(d).then(e,".destroyStream(",q,");")),a.ELEMENTS=q})}return null}(),g=c("offset",!0);return{elements:d,primitive:function(){if("primitive"in e){var a=e.primitive;return B(function(b,c){return Ra[a]})}if("primitive"in f){var b=f.primitive;return N(b,function(a,c){var e=a.constants.primTypes,d=a.invoke(c,b);return c.def(e,"[",d,"]")})}return d?ta(d)?d.value?B(function(a,b){return b.def(a.ELEMENTS,".primType")}):B(function(){return 4}):new Y(d.thisDep,d.contextDep,d.propDep,function(a,b){var c=a.ELEMENTS;return b.def(c,"?",c,".primType:",4)}):null}(),count:function(){if("count"in e){var a=0|e.count;return B(function(){return a})}if("count"in f){var b=f.count;return N(b,function(a,c){return a.invoke(c,b)})}return d?ta(d)?d?g?new Y(g.thisDep,g.contextDep,g.propDep,function(a,b){return b.def(a.ELEMENTS,".vertCount-",a.OFFSET)}):B(function(a,b){return b.def(a.ELEMENTS,".vertCount")}):B(function(){return-1}):new Y(d.thisDep||g.thisDep,d.contextDep||g.contextDep,d.propDep||g.propDep,function(a,b){var c=a.ELEMENTS;return a.OFFSET?b.def(c,"?",c,".vertCount-",a.OFFSET,":-1"):b.def(c,"?",c,".vertCount:-1")}):null}(),instances:c("instances",!1),offset:g}}function Q(a,c){var e=a.static,d=a.dynamic,g={};return Object.keys(e).forEach(function(a){var c=e[a],d=b.id(a),q=new xa;if(Na(c))q.state=1,q.buffer=f.getBuffer(f.create(c,34962,!1,!0)),q.type=0;else if(y=f.getBuffer(c))q.state=1,q.buffer=y,q.type=0;else if(c.constant){var l=c.constant;q.buffer="null",q.state=2,"number"==typeof l?q.x=l:Da.forEach(function(a,b){b<l.length&&(q[a]=l[b])})}else{var y=Na(c.buffer)?f.getBuffer(f.create(c.buffer,34962,!1,!0)):f.getBuffer(c.buffer),h=0|c.offset,k=0|c.stride,m=0|c.size,n=!!c.normalized,aa=0;"type"in c&&(aa=Qa[c.type]),c=0|c.divisor,q.buffer=y,q.state=1,q.size=m,q.normalized=n,q.type=aa||y.dtype,q.offset=h,q.stride=k,q.divisor=c}g[a]=B(function(a,b){var c=a.attribCache;if(d in c)return c[d];var e={isStream:!1};return Object.keys(q).forEach(function(a){e[a]=q[a]}),q.buffer&&(e.buffer=a.link(q.buffer),e.type=e.type||e.buffer+".dtype"),c[d]=e})}),Object.keys(d).forEach(function(a){var b=d[a];g[a]=N(b,function(a,c){function e(a){c(y[a],"=",d,".",a,"|0;")}var d=a.invoke(c,b),f=a.shared,q=f.isBufferArgs,g=f.buffer,y={isStream:c.def(!1)},l=new xa;l.state=1,Object.keys(l).forEach(function(a){y[a]=c.def(""+l[a])});var h=y.buffer,K=y.type;return c("if(",q,"(",d,")){",y.isStream,"=true;",h,"=",g,".createStream(",34962,",",d,");",K,"=",h,".dtype;","}else{",h,"=",g,".getBuffer(",d,");","if(",h,"){",K,"=",h,".dtype;",'}else if("constant" in ',d,"){",y.state,"=",2,";","if(typeof "+d+'.constant === "number"){',y[Da[0]],"=",d,".constant;",Da.slice(1).map(function(a){return y[a]}).join("="),"=0;","}else{",Da.map(function(a,b){return y[a]+"="+d+".constant.length>="+b+"?"+d+".constant["+b+"]:0;"}).join(""),"}}else{","if(",q,"(",d,".buffer)){",h,"=",g,".createStream(",34962,",",d,".buffer);","}else{",h,"=",g,".getBuffer(",d,".buffer);","}",K,'="type" in ',d,"?",f.glTypes,"[",d,".type]:",h,".dtype;",y.normalized,"=!!",d,".normalized;"),e("size"),e("offset"),e("stride"),e("divisor"),c("}}"),c.exit("if(",y.isStream,"){",g,".destroyStream(",h,");","}"),y})}),g}function z(a,b,c,e,d){var f=A(a),g=function x(a,b,c){function e(a){if(a in f){var c=f[a];a=!0;var K,ca,q=0|c.x,g=0|c.y;return"width"in c?K=0|c.width:a=!1,"height"in c?ca=0|c.height:a=!1,new Y(!a&&b&&b.thisDep,!a&&b&&b.contextDep,!a&&b&&b.propDep,function(a,b){var e=a.shared.context,f=K;"width"in c||(f=b.def(e,".","framebufferWidth","-",q));var d=ca;return"height"in c||(d=b.def(e,".","framebufferHeight","-",g)),[q,g,f,d]})}if(a in d){var l=d[a];return a=N(l,function(a,b){var c=a.invoke(b,l),e=a.shared.context,q=b.def(c,".x|0"),f=b.def(c,".y|0");return[q,f,b.def('"width" in ',c,"?",c,".width|0:","(",e,".","framebufferWidth","-",q,")"),c=b.def('"height" in ',c,"?",c,".height|0:","(",e,".","framebufferHeight","-",f,")")]}),b&&(a.thisDep=a.thisDep||b.thisDep,a.contextDep=a.contextDep||b.contextDep,a.propDep=a.propDep||b.propDep),a}return b?new Y(b.thisDep,b.contextDep,b.propDep,function(a,b){var c=a.shared.context;return[0,0,b.def(c,".","framebufferWidth"),b.def(c,".","framebufferHeight")]}):null}var f=a.static,d=a.dynamic;if(a=e("viewport")){var g=a;a=new Y(a.thisDep,a.contextDep,a.propDep,function(a,b){var c=g.append(a,b),e=a.shared.context;return b.set(e,".viewportWidth",c[2]),b.set(e,".viewportHeight",c[3]),c})}return{viewport:a,scissor_box:e("scissor.box")}}(a,f),l=M(a),h=function P(a,b){var c=a.static,e=a.dynamic,d={};return Ja.forEach(function(a){function b(q,g){if(a in c){var y=q(c[a]);d[f]=B(function(){return y})}else if(a in e){var l=e[a];d[f]=N(l,function(a,b){return g(a,b,a.invoke(b,l))})}}var f=n(a);switch(a){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return b(function(a){return a},function(a,b,c){return c});case"depth.func":return b(function(a){return Ua[a]},function(a,b,c){return b.def(a.constants.compareFuncs,"[",c,"]")});case"depth.range":return b(function(a){return a},function(a,b,c){return[b.def("+",c,"[0]"),b=b.def("+",c,"[1]")]});case"blend.func":return b(function(a){return[Fa["srcRGB"in a?a.srcRGB:a.src],Fa["dstRGB"in a?a.dstRGB:a.dst],Fa["srcAlpha"in a?a.srcAlpha:a.src],Fa["dstAlpha"in a?a.dstAlpha:a.dst]]},function(a,b,c){function e(a,d){return b.def('"',a,d,'" in ',c,"?",c,".",a,d,":",c,".",a)}a=a.constants.blendFuncs;var d=e("src","RGB"),f=e("dst","RGB"),q=(d=b.def(a,"[",d,"]"),b.def(a,"[",e("src","Alpha"),"]"));return[d,f=b.def(a,"[",f,"]"),q,a=b.def(a,"[",e("dst","Alpha"),"]")]});case"blend.equation":return b(function(a){return"string"==typeof a?[V[a],V[a]]:"object"==typeof a?[V[a.rgb],V[a.alpha]]:void 0},function(a,b,c){var e=a.constants.blendEquations,d=b.def(),f=b.def();return(a=a.cond("typeof ",c,'==="string"')).then(d,"=",f,"=",e,"[",c,"];"),a.else(d,"=",e,"[",c,".rgb];",f,"=",e,"[",c,".alpha];"),b(a),[d,f]});case"blend.color":return b(function(a){return J(4,function(b){return+a[b]})},function(a,b,c){return J(4,function(a){return b.def("+",c,"[",a,"]")})});case"stencil.mask":return b(function(a){return 0|a},function(a,b,c){return b.def(c,"|0")});case"stencil.func":return b(function(a){return[Ua[a.cmp||"keep"],a.ref||0,"mask"in a?a.mask:-1]},function(a,b,c){return[a=b.def('"cmp" in ',c,"?",a.constants.compareFuncs,"[",c,".cmp]",":",7680),b.def(c,".ref|0"),b=b.def('"mask" in ',c,"?",c,".mask|0:-1")]});case"stencil.opFront":case"stencil.opBack":return b(function(b){return["stencil.opBack"===a?1029:1028,Oa[b.fail||"keep"],Oa[b.zfail||"keep"],Oa[b.zpass||"keep"]]},function(b,c,e){function d(a){return c.def('"',a,'" in ',e,"?",f,"[",e,".",a,"]:",7680)}var f=b.constants.stencilOps;return["stencil.opBack"===a?1029:1028,d("fail"),d("zfail"),d("zpass")]});case"polygonOffset.offset":return b(function(a){return[0|a.factor,0|a.units]},function(a,b,c){return[b.def(c,".factor|0"),b=b.def(c,".units|0")]});case"cull.face":return b(function(a){var b=0;return"front"===a?b=1028:"back"===a&&(b=1029),b},function(a,b,c){return b.def(c,'==="front"?',1028,":",1029)});case"lineWidth":return b(function(a){return a},function(a,b,c){return c});case"frontFace":return b(function(a){return rb[a]},function(a,b,c){return b.def(c+'==="cw"?2304:2305')});case"colorMask":return b(function(a){return a.map(function(a){return!!a})},function(a,b,c){return J(4,function(a){return"!!"+c+"["+a+"]"})});case"sample.coverage":return b(function(a){return["value"in a?a.value:1,!!a.invert]},function(a,b,c){return[b.def('"value" in ',c,"?+",c,".value:1"),b=b.def("!!",c,".invert")]})}}),d}(a),k=C(a),m=g.viewport;return m&&(h.viewport=m),(g=g[m=n("scissor.box")])&&(h[m]=g),(f={framebuffer:f,draw:l,shader:k,state:h,dirty:g=0<Object.keys(h).length}).profile=function Z(a){var c,b=a.static;if(a=a.dynamic,"profile"in b){var e=!!b.profile;(c=B(function(a,b){return e})).enable=e}else if("profile"in a){var f=a.profile;c=N(f,function(a,b){return a.invoke(b,f)})}return c}(a),f.uniforms=function G(a,b){var c=a.static,e=a.dynamic,d={};return Object.keys(c).forEach(function(a){var e,b=c[a];if("number"==typeof b||"boolean"==typeof b)e=B(function(){return b});else if("function"==typeof b){var f=b._reglType;"texture2d"===f||"textureCube"===f?e=B(function(a){return a.link(b)}):"framebuffer"!==f&&"framebufferCube"!==f||(e=B(function(a){return a.link(b.color[0])}))}else na(b)&&(e=B(function(a){return a.global.def("[",J(b.length,function(a){return b[a]}),"]")}));e.value=b,d[a]=e}),Object.keys(e).forEach(function(a){var b=e[a];d[a]=N(b,function(a,c){return a.invoke(c,b)})}),d}(c),f.attributes=Q(b),f.context=function O(a){var b=a.static,c=a.dynamic,e={};return Object.keys(b).forEach(function(a){var c=b[a];e[a]=B(function(a,b){return"number"==typeof c||"boolean"==typeof c?""+c:a.link(c)})}),Object.keys(c).forEach(function(a){var b=c[a];e[a]=N(b,function(a,c){return a.invoke(c,b)})}),e}(e),f}function sa(a,b,c){var e=a.shared.context,d=a.scope();Object.keys(c).forEach(function(f){b.save(e,"."+f),d(e,".",f,"=",c[f].append(a,b),";")}),b(d)}function I(a,b,c,e){var l,f=(d=a.shared).gl,g=d.framebuffer;ka&&(l=b.def(d.extensions,".webgl_draw_buffers"));var d=(h=a.constants).drawBuffer,h=h.backBuffer;a=c?c.append(a,b):b.def(g,".next"),e||b("if(",a,"!==",g,".cur){"),b("if(",a,"){",f,".bindFramebuffer(",36160,",",a,".framebuffer);"),ka&&b(l,".drawBuffersWEBGL(",d,"[",a,".colorAttachments.length]);"),b("}else{",f,".bindFramebuffer(",36160,",null);"),ka&&b(l,".drawBuffersWEBGL(",h,");"),b("}",g,".cur=",a,";"),e||b("}")}function T(a,b,c){var e=a.shared,d=e.gl,f=a.current,g=a.next,l=e.current,h=e.next,k=a.cond(l,".dirty");Ja.forEach(function(b){var e,y;if(!((b=n(b))in c.state))if(b in g){e=g[b],y=f[b];var m=J(pa[b].length,function(a){return k.def(e,"[",a,"]")});k(a.cond(m.map(function(a,b){return a+"!=="+y+"["+b+"]"}).join("||")).then(d,".",ra[b],"(",m,");",m.map(function(a,b){return y+"["+b+"]="+a}).join(";"),";"))}else e=k.def(h,".",b),m=a.cond(e,"!==",l,".",b),k(m),b in qa?m(a.cond(e).then(d,".enable(",qa[b],");").else(d,".disable(",qa[b],");"),l,".",b,"=",e,";"):m(d,".",ra[b],"(",e,");",l,".",b,"=",e,";")}),0===Object.keys(c.state).length&&k(l,".dirty=false;"),b(k)}function L(a,b,c,e){var d=a.shared,f=a.current,g=d.current,l=d.gl;qb(Object.keys(c)).forEach(function(d){var h=c[d];if(!e||e(h)){var k=h.append(a,b);if(qa[d]){var m=qa[d];ta(h)?b(l,k?".enable(":".disable(",m,");"):b(a.cond(k).then(l,".enable(",m,");").else(l,".disable(",m,");")),b(g,".",d,"=",k,";")}else if(na(k)){var n=f[d];b(l,".",ra[d],"(",k,");",k.map(function(a,b){return n+"["+b+"]="+a}).join(";"),";")}else b(l,".",ra[d],"(",k,");",g,".",d,"=",k,";")}})}function ua(a,b){ma&&(a.instancing=b.def(a.shared.extensions,".angle_instanced_arrays"))}function E(a,b,c,e,d){function f(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function g(a){a(r=b.def(),"=",f(),";"),"string"==typeof d?a(n,".count+=",d,";"):a(n,".count++;"),m&&(e?a(u=b.def(),"=",t,".getNumPendingQueries();"):a(t,".beginQuery(",n,");"))}function l(a){a(n,".cpuTime+=",f(),"-",r,";"),m&&(e?a(t,".pushScopeStats(",u,",",t,".getNumPendingQueries(),",n,");"):a(t,".endQuery();"))}function h(a){var c=b.def(p,".profile");b(p,".profile=",a,";"),b.exit(p,".profile=",c,";")}var r,u,k=a.shared,n=a.stats,p=k.current,t=k.timer;if(c=c.profile){if(ta(c))return void(c.enable?(g(b),l(b.exit),h("true")):h("false"));h(c=c.append(a,b))}else c=b.def(p,".profile");g(k=a.block()),b("if(",c,"){",k,"}"),l(a=a.block()),b.exit("if(",c,"){",a,"}")}function S(a,b,c,e,d){function g(c,e,d){function f(){b("if(!",n,".buffer){",k,".enableVertexAttribArray(",m,");}");var g,c=d.type;g=d.size?b.def(d.size,"||",e):e,b("if(",n,".type!==",c,"||",n,".size!==",g,"||",aa.map(function(a){return n+"."+a+"!=="+d[a]}).join("||"),"){",k,".bindBuffer(",34962,",",K,".buffer);",k,".vertexAttribPointer(",[m,g,c,d.normalized,d.stride,d.offset],");",n,".type=",c,";",n,".size=",g,";",aa.map(function(a){return n+"."+a+"="+d[a]+";"}).join(""),"}"),ma&&(c=d.divisor,b("if(",n,".divisor!==",c,"){",a.instancing,".vertexAttribDivisorANGLE(",[m,c],");",n,".divisor=",c,";}"))}function h(){b("if(",n,".buffer){",k,".disableVertexAttribArray(",m,");","}if(",Da.map(function(a,b){return n+"."+a+"!=="+p[b]}).join("||"),"){",k,".vertexAttrib4f(",m,",",p,");",Da.map(function(a,b){return n+"."+a+"="+p[b]+";"}).join(""),"}")}var k=l.gl,m=b.def(c,".location"),n=b.def(l.attributes,"[",m,"]");c=d.state;var K=d.buffer,p=[d.x,d.y,d.z,d.w],aa=["buffer","normalized","offset","stride"];1===c?f():2===c?h():(b("if(",c,"===",1,"){"),f(),b("}else{"),h(),b("}"))}var l=a.shared;e.forEach(function(e){var k,l=e.name,h=c.attributes[l];if(h){if(!d(h))return;k=h.append(a,b)}else{if(!d(sb))return;var m=a.scopeAttrib(l);k={},Object.keys(new xa).forEach(function(a){k[a]=b.def(m,".",a)})}g(a.link(e),function f(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(e.info.type),k)})}function U(a,c,e,d,f){for(var h,g=a.shared,l=g.gl,k=0;k<d.length;++k){var r,n=(m=d[k]).name,p=m.info.type,t=e.uniforms[n],m=a.link(m)+".location";if(t){if(!f(t))continue;if(ta(t)){if(n=t.value,35678===p||35680===p)c(l,".uniform1i(",m,",",(p=a.link(n._texture||n.color[0]._texture))+".bind());"),c.exit(p,".unbind();");else if(35674===p||35675===p||35676===p)n=a.global.def("new Float32Array(["+Array.prototype.slice.call(n)+"])"),t=2,35675===p?t=3:35676===p&&(t=4),c(l,".uniformMatrix",t,"fv(",m,",false,",n,");");else{switch(p){case 5126:h="1f";break;case 35664:h="2f";break;case 35665:h="3f";break;case 35666:h="4f";break;case 35670:case 5124:h="1i";break;case 35671:case 35667:h="2i";break;case 35672:case 35668:h="3i";break;case 35673:h="4i";break;case 35669:h="4i"}c(l,".uniform",h,"(",m,",",na(n)?Array.prototype.slice.call(n):n,");")}continue}r=t.append(a,c)}else{if(!f(sb))continue;r=c.def(g.uniforms,"[",b.id(n),"]")}switch(35678===p?c("if(",r,"&&",r,'._reglType==="framebuffer"){',r,"=",r,".color[0];","}"):35680===p&&c("if(",r,"&&",r,'._reglType==="framebufferCube"){',r,"=",r,".color[0];","}"),n=1,p){case 35678:case 35680:c(l,".uniform1i(",m,",",p=c.def(r,"._texture"),".bind());"),c.exit(p,".unbind();");continue;case 5124:case 35670:h="1i";break;case 35667:case 35671:h="2i",n=2;break;case 35668:case 35672:h="3i",n=3;break;case 35669:case 35673:h="4i",n=4;break;case 5126:h="1f";break;case 35664:h="2f",n=2;break;case 35665:h="3f",n=3;break;case 35666:h="4f",n=4;break;case 35674:h="Matrix2fv";break;case 35675:h="Matrix3fv";break;case 35676:h="Matrix4fv"}if(c(l,".uniform",h,"(",m,","),"M"===h.charAt(0)){m=Math.pow(p-35674+2,2);var u=a.global.def("new Float32Array(",m,")");c("false,(Array.isArray(",r,")||",r," instanceof Float32Array)?",r,":(",J(m,function(a){return u+"["+a+"]="+r+"["+a+"]"}),",",u,")")}else c(1<n?J(n,function(a){return r+"["+a+"]"}):r);c(");")}}function H(a,b,c,e){function d(f){var g=m[f];return g?g.contextDep&&e.contextDynamic||g.propDep?g.append(a,c):g.append(a,b):b.def(k,".",f)}function f(){function a(){c(w,".drawElementsInstancedANGLE(",[p,t,W,r+"<<(("+W+"-5121)>>1)",u],");")}function b(){c(w,".drawArraysInstancedANGLE(",[p,r,t,u],");")}n?v?a():(c("if(",n,"){"),a(),c("}else{"),b(),c("}")):b()}function g(){function a(){c(l+".drawElements("+[p,t,W,r+"<<(("+W+"-5121)>>1)"]+");")}function b(){c(l+".drawArrays("+[p,r,t]+");")}n?v?a():(c("if(",n,"){"),a(),c("}else{"),b(),c("}")):b()}var u,w,h=a.shared,l=h.gl,k=h.draw,m=e.draw,n=function(){var d=m.elements,f=b;return d?((d.contextDep&&e.contextDynamic||d.propDep)&&(f=c),d=d.append(a,f)):d=f.def(k,".","elements"),d&&f("if("+d+")"+l+".bindBuffer(34963,"+d+".buffer.buffer);"),d}(),p=d("primitive"),r=d("offset"),t=function(){var d=m.count,f=b;return d?((d.contextDep&&e.contextDynamic||d.propDep)&&(f=c),d=d.append(a,f)):d=f.def(k,".","count"),d}();if("number"==typeof t){if(0===t)return}else c("if(",t,"){"),c.exit("}");ma&&(u=d("instances"),w=a.instancing);var W=n+".type",v=m.elements&&ta(m.elements);ma&&("number"!=typeof u||0<=u)?"string"==typeof u?(c("if(",u,">0){"),f(),c("}else if(",u,"<0){"),g(),c("}")):f():g()}function ba(a,b,c,e,d){return d=(b=t()).proc("body",d),ma&&(b.instancing=d.def(b.shared.extensions,".angle_instanced_arrays")),a(b,d,c,e),b.compile().body}function R(a,b,c,e){ua(a,b),S(a,b,c,e.attributes,function(){return!0}),U(a,b,c,e.uniforms,function(){return!0}),H(a,b,b,c)}function la(a,b,c,e){function d(){return!0}a.batchId="a1",ua(a,b),S(a,b,c,e.attributes,d),U(a,b,c,e.uniforms,d),H(a,b,b,c)}function ya(a,b,c,e){function d(a){return a.contextDep&&g||a.propDep}function f(a){return!d(a)}ua(a,b);var g=c.contextDep,h=b.def(),l=b.def();a.shared.props=l,a.batchId=h;var k=a.scope(),m=a.scope();b(k.entry,"for(",h,"=0;",h,"<","a1",";++",h,"){",l,"=","a0","[",h,"];",m,"}",k.exit),c.needsContext&&sa(a,m,c.context),c.needsFramebuffer&&I(a,m,c.framebuffer),L(a,m,c.state,d),c.profile&&d(c.profile)&&E(a,m,c,!1,!0),e?(S(a,k,c,e.attributes,f),S(a,m,c,e.attributes,d),U(a,k,c,e.uniforms,f),U(a,m,c,e.uniforms,d),H(a,k,m,c)):(b=a.global.def("{}"),e=c.shader.progVar.append(a,m),l=m.def(e,".id"),k=m.def(b,"[",l,"]"),m(a.shared.gl,".useProgram(",e,".program);","if(!",k,"){",k,"=",b,"[",l,"]=",a.link(function(b){return ba(la,a,c,b,2)}),"(",e,");}",k,".call(this,a0[",h,"],",h,");"))}function ea(a,c){function e(b){var g=c.shader[b];g&&d.set(f.shader,"."+b,g.append(a,d))}var d=a.proc("scope",3);a.batchId="a2";var f=a.shared,g=f.current;sa(a,d,c.context),c.framebuffer&&c.framebuffer.append(a,d),qb(Object.keys(c.state)).forEach(function(b){var e=c.state[b].append(a,d);na(e)?e.forEach(function(c,e){d.set(a.next[b],"["+e+"]",c)}):d.set(f.next,"."+b,e)}),E(a,d,c,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(b){var e=c.draw[b];e&&d.set(f.draw,"."+b,""+e.append(a,d))}),Object.keys(c.uniforms).forEach(function(e){d.set(f.uniforms,"["+b.id(e)+"]",c.uniforms[e].append(a,d))}),Object.keys(c.attributes).forEach(function(b){var e=c.attributes[b].append(a,d),f=a.scopeAttrib(b);Object.keys(new xa).forEach(function(a){d.set(f,"."+a,e[a])})}),e("vert"),e("frag"),0<Object.keys(c.state).length&&(d(g,".dirty=true;"),d.exit(g,".dirty=true;")),d("a1(",a.shared.context,",a0,",a.batchId,");")}function fa(a,b,c){var d=b.static[c];if(d&&function ja(a){if("object"==typeof a&&!na(a)){for(var b=Object.keys(a),c=0;c<b.length;++c)if(ia.isDynamic(a[b[c]]))return!0;return!1}}(d)){var f=a.global,g=Object.keys(d),h=!1,l=!1,m=!1,k=a.global.def("{}");g.forEach(function(b){var c=d[b];if(ia.isDynamic(c))"function"==typeof c&&(c=d[b]=ia.unbox(c)),b=N(c,null),h=h||b.thisDep,m=m||b.propDep,l=l||b.contextDep;else{switch(f(k,".",b,"="),typeof c){case"number":f(c);break;case"string":f('"',c,'"');break;case"object":Array.isArray(c)&&f("[",c.join(),"]");break;default:f(a.link(c))}f(";")}}),b.dynamic[c]=new ia.DynamicVariable(4,{thisDep:h,contextDep:l,propDep:m,ref:k,append:function e(a,b){g.forEach(function(c){var e=d[c];ia.isDynamic(e)&&(e=a.invoke(b,e),b(k,".",c,"=",e,";"))})}}),delete b.static[c]}}var xa=r.Record,V={add:32774,subtract:32778,"reverse subtract":32779};c.ext_blend_minmax&&(V.min=32775,V.max=32776);var ma=c.angle_instanced_arrays,ka=c.webgl_draw_buffers,pa={dirty:!0,profile:e.profile},Ea={},Ja=[],qa={},ra={};D("dither",3024),D("blend.enable",3042),w("blend.color","blendColor",[0,0,0,0]),w("blend.equation","blendEquationSeparate",[32774,32774]),w("blend.func","blendFuncSeparate",[1,0,1,0]),D("depth.enable",2929,!0),w("depth.func","depthFunc",513),w("depth.range","depthRange",[0,1]),w("depth.mask","depthMask",!0),w("colorMask","colorMask",[!0,!0,!0,!0]),D("cull.enable",2884),w("cull.face","cullFace",1029),w("frontFace","frontFace",2305),w("lineWidth","lineWidth",1),D("polygonOffset.enable",32823),w("polygonOffset.offset","polygonOffset",[0,0]),D("sample.alpha",32926),D("sample.enable",32928),w("sample.coverage","sampleCoverage",[1,!1]),D("stencil.enable",2960),w("stencil.mask","stencilMask",-1),w("stencil.func","stencilFunc",[519,0,-1]),w("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),w("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),D("scissor.enable",3089),w("scissor.box","scissor",[0,0,a.drawingBufferWidth,a.drawingBufferHeight]),w("viewport","viewport",[0,0,a.drawingBufferWidth,a.drawingBufferHeight]);var ga={gl:a,context:u,strings:b,next:Ea,current:pa,draw:l,elements:k,buffer:f,shader:v,attributes:r.state,uniforms:g,framebuffer:h,extensions:c,timer:m,isBufferArgs:Na},da={primTypes:Ra,compareFuncs:Ua,blendFuncs:Fa,blendEquations:V,stencilOps:Oa,glTypes:Qa,orientationType:rb};ka&&(da.backBuffer=[1029],da.drawBuffer=J(d.maxDrawbuffers,function(a){return 0===a?[0]:J(a,function(a){return 36064+a})}));var oa=0;return{next:Ea,current:pa,procs:function(){var b=t(),c=b.proc("poll"),e=b.proc("refresh"),f=b.block();c(f),e(f);var g=b.shared,h=g.gl,l=g.next,m=g.current;f(m,".dirty=false;"),I(b,c),I(b,e,null,!0);var n,k=a.getExtension("angle_instanced_arrays");k&&(n=b.link(k));for(var p=0;p<d.maxAttributes;++p){var r=e.def(g.attributes,"[",p,"]"),u=b.cond(r,".buffer");u.then(h,".enableVertexAttribArray(",p,");",h,".bindBuffer(",34962,",",r,".buffer.buffer);",h,".vertexAttribPointer(",p,",",r,".size,",r,".type,",r,".normalized,",r,".stride,",r,".offset);").else(h,".disableVertexAttribArray(",p,");",h,".vertexAttrib4f(",p,",",r,".x,",r,".y,",r,".z,",r,".w);",r,".buffer=null;"),e(u),k&&e(n,".vertexAttribDivisorANGLE(",p,",",r,".divisor);")}return Object.keys(qa).forEach(function(a){var d=qa[a],g=f.def(l,".",a),k=b.block();k("if(",g,"){",h,".enable(",d,")}else{",h,".disable(",d,")}",m,".",a,"=",g,";"),e(k),c("if(",g,"!==",m,".",a,"){",k,"}")}),Object.keys(ra).forEach(function(a){var k,n,d=ra[a],g=pa[a],p=b.block();p(h,".",d,"("),na(g)?(d=g.length,k=b.global.def(l,".",a),n=b.global.def(m,".",a),p(J(d,function(a){return k+"["+a+"]"}),");",J(d,function(a){return n+"["+a+"]="+k+"["+a+"];"}).join("")),c("if(",J(d,function(a){return k+"["+a+"]!=="+n+"["+a+"]"}).join("||"),"){",p,"}")):(k=f.def(l,".",a),n=f.def(m,".",a),p(k,");",m,".",a,"=",k,";"),c("if(",k,"!==",n,"){",p,"}")),e(p)}),b.compile()}(),compile:function(a,b,c,e,d){var f=t();return f.stats=f.link(d),Object.keys(b.static).forEach(function(a){fa(f,b,a)}),Pb.forEach(function(b){fa(f,a,b)}),c=z(a,b,c,e),function W(a,b){var c=a.proc("draw",1);ua(a,c),sa(a,c,b.context),I(a,c,b.framebuffer),T(a,c,b),L(a,c,b.state),E(a,c,b,!1,!0);var e=b.shader.progVar.append(a,c);if(c(a.shared.gl,".useProgram(",e,".program);"),b.shader.program)R(a,c,b,b.shader.program);else{var d=a.global.def("{}"),f=c.def(e,".id"),g=c.def(d,"[",f,"]");c(a.cond(g).then(g,".call(this,a0);").else(g,"=",d,"[",f,"]=",a.link(function(c){return ba(R,a,b,c,1)}),"(",e,");",g,".call(this,a0);"))}0<Object.keys(b.state).length&&c(a.shared.current,".dirty=true;")}(f,c),ea(f,c),function ha(a,b){function c(a){return a.contextDep&&d||a.propDep}var e=a.proc("batch",2);a.batchId="0",ua(a,e);var d=!1,f=!0;Object.keys(b.context).forEach(function(a){d=d||b.context[a].propDep}),d||(sa(a,e,b.context),f=!1);var h=!1;if((g=b.framebuffer)?(g.propDep?d=h=!0:g.contextDep&&d&&(h=!0),h||I(a,e,g)):I(a,e,null),b.state.viewport&&b.state.viewport.propDep&&(d=!0),T(a,e,b),L(a,e,b.state,function(a){return!c(a)}),b.profile&&c(b.profile)||E(a,e,b,!1,"a1"),b.contextDep=d,b.needsContext=f,b.needsFramebuffer=h,(f=b.shader.progVar).contextDep&&d||f.propDep)ya(a,e,b,null);else if(f=f.append(a,e),e(a.shared.gl,".useProgram(",f,".program);"),b.shader.program)ya(a,e,b,b.shader.program);else{var g=a.global.def("{}"),l=(h=e.def(f,".id"),e.def(g,"[",h,"]"));e(a.cond(l).then(l,".call(this,a0,a1);").else(l,"=",g,"[",h,"]=",a.link(function(c){return ba(ya,a,b,c,2)}),"(",f,");",l,".call(this,a0,a1);"))}0<Object.keys(b.state).length&&e(a.shared.current,".dirty=true;")}(f,c),f.compile()}}}function tb(a,b){for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1}var A=function(a,b){for(var c=Object.keys(b),d=0;d<c.length;++d)a[c[d]]=b[c[d]];return a},vb=0,ia={DynamicVariable:da,define:function(a,b){return new da(a,Wa(b+""))},isDynamic:function(a){return"function"==typeof a&&!a._reglType||a instanceof da},unbox:function(a,b){return"function"==typeof a?new da(0,a):a},accessor:Wa},Va={next:"function"==typeof requestAnimationFrame?function(a){return requestAnimationFrame(a)}:function(a){return setTimeout(a,16)},cancel:"function"==typeof cancelAnimationFrame?function(a){return cancelAnimationFrame(a)}:clearTimeout},ub="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},O=function(a){return a instanceof Uint8Array||a instanceof Uint16Array||a instanceof Uint32Array||a instanceof Int8Array||a instanceof Int16Array||a instanceof Int32Array||a instanceof Float32Array||a instanceof Float64Array||a instanceof Uint8ClampedArray},H=function(a){return Object.keys(a).map(function(b){return a[b]})},$a=J(8,function(){return[]}),x={alloc:fa,free:ab,allocType:function(a,b){var c=null;switch(a){case 5120:c=new Int8Array(fa(b),0,b);break;case 5121:c=new Uint8Array(fa(b),0,b);break;case 5122:c=new Int16Array(fa(2*b),0,b);break;case 5123:c=new Uint16Array(fa(2*b),0,b);break;case 5124:c=new Int32Array(fa(4*b),0,b);break;case 5125:c=new Uint32Array(fa(4*b),0,b);break;case 5126:c=new Float32Array(fa(4*b),0,b);break;default:return null}return c.length!==b?c.subarray(0,b):c},freeType:function(a){ab(a.buffer)}},La={shape:function(a){for(var b=[];a.length;a=a[0])b.push(a.length);return b},flatten:function(a,b,c,d){var f=1;if(b.length)for(var k=0;k<b.length;++k)f*=b[k];else f=0;switch(c=d||x.allocType(c,f),b.length){case 0:break;case 1:for(d=b[0],b=0;b<d;++b)c[b]=a[b];break;case 2:for(d=b[0],b=b[1],k=f=0;k<d;++k)for(var p=a[k],h=0;h<b;++h)c[f++]=p[h];break;case 3:bb(a,b[0],b[1],b[2],c,0);break;default:!function cb(a,b,c,d,f){for(var k=1,p=c+1;p<b.length;++p)k*=b[p];var h=b[c];if(4==b.length-c){var g=b[c+1],r=b[c+2];for(b=b[c+3],p=0;p<h;++p)bb(a[p],g,r,b,d,f),f+=k}else for(p=0;p<h;++p)cb(a[p],b,c+1,d,f),f+=k}(a,b,0,c,0)}return c}},Ha={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Qa={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},hb={dynamic:35048,stream:35040,static:35044},Pa=La.flatten,fb=La.shape,ga=[];ga[5120]=1,ga[5122]=2,ga[5124]=4,ga[5121]=1,ga[5123]=2,ga[5125]=4,ga[5126]=4;var Ra={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},jb=new Float32Array(1),Db=new Uint32Array(jb.buffer),Hb=[9984,9986,9985,9987],Ka=[0,6409,6410,6407,6408],R={};R[6409]=R[6406]=R[6402]=1,R[34041]=R[6410]=2,R[6407]=R[35904]=3,R[6408]=R[35906]=4;var Eb=Object.keys(Ha).concat(["[object HTMLCanvasElement]","[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]),za=[];za[5121]=1,za[5126]=4,za[36193]=2,za[5123]=2,za[5125]=4;var C=[];C[32854]=2,C[32855]=2,C[36194]=2,C[34041]=4,C[33776]=.5,C[33777]=.5,C[33778]=1,C[33779]=1,C[35986]=.5,C[35987]=1,C[34798]=1,C[35840]=.5,C[35841]=.25,C[35842]=.5,C[35843]=.25,C[36196]=.5;var L=[];L[32854]=2,L[32855]=2,L[36194]=2,L[33189]=2,L[36168]=1,L[34041]=4,L[35907]=4,L[34836]=16,L[34842]=8,L[34843]=6;var Rb=function(a,b,c,d,f){function k(a){this.id=r++,this.refCount=1,this.renderbuffer=a,this.format=32854,this.height=this.width=0,f.profile&&(this.stats={size:0})}function p(b){var c=b.renderbuffer;a.bindRenderbuffer(36161,null),a.deleteRenderbuffer(c),b.renderbuffer=null,b.refCount=0,delete v[b.id],d.renderbufferCount--}var h={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};b.ext_srgb&&(h.srgba=35907),b.ext_color_buffer_half_float&&(h.rgba16f=34842,h.rgb16f=34843),b.webgl_color_buffer_float&&(h.rgba32f=34836);var g=[];Object.keys(h).forEach(function(a){g[h[a]]=a});var r=0,v={};return k.prototype.decRef=function(){0>=--this.refCount&&p(this)},f.profile&&(d.getTotalRenderbufferSize=function(){var a=0;return Object.keys(v).forEach(function(b){a+=v[b].stats.size}),a}),{create:function(b,c){function m(b,c){var d=0,l=0,k=32854;if("object"==typeof b&&b?("shape"in b?(d=0|(l=b.shape)[0],l=0|l[1]):("radius"in b&&(d=l=0|b.radius),"width"in b&&(d=0|b.width),"height"in b&&(l=0|b.height)),"format"in b&&(k=h[b.format])):"number"==typeof b?(d=0|b,l="number"==typeof c?0|c:d):b||(d=l=1),d!==e.width||l!==e.height||k!==e.format)return m.width=e.width=d,m.height=e.height=l,e.format=k,a.bindRenderbuffer(36161,e.renderbuffer),a.renderbufferStorage(36161,k,d,l),f.profile&&(e.stats.size=L[e.format]*e.width*e.height),m.format=g[e.format],m}var e=new k(a.createRenderbuffer());return v[e.id]=e,d.renderbufferCount++,m(b,c),m.resize=function(b,c){var d=0|b,g=0|c||d;return d===e.width&&g===e.height?m:(m.width=e.width=d,m.height=e.height=g,a.bindRenderbuffer(36161,e.renderbuffer),a.renderbufferStorage(36161,e.format,d,g),f.profile&&(e.stats.size=L[e.format]*e.width*e.height),m)},m._reglType="renderbuffer",m._renderbuffer=e,f.profile&&(m.stats=e.stats),m.destroy=function(){e.decRef()},m},clear:function(){H(v).forEach(p)},restore:function(){H(v).forEach(function(b){b.renderbuffer=a.createRenderbuffer(),a.bindRenderbuffer(36161,b.renderbuffer),a.renderbufferStorage(36161,b.format,b.width,b.height)}),a.bindRenderbuffer(36161,null)}}},ob=[];ob[6408]=4;var Ma=[];Ma[5121]=1,Ma[5126]=4,Ma[36193]=2;var Da=["x","y","z","w"],Pb="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),Fa={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Ua={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Oa={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},rb={cw:2304,ccw:2305},sb=new Y(!1,!1,!1,function(){});return function(a){function b(){if(0===E.length)x&&x.update(),ba=null;else{ba=Va.next(b),v();for(var a=E.length-1;0<=a;--a){var c=E[a];c&&c(M,null,0)}m.flush(),x&&x.update()}}function c(){!ba&&0<E.length&&(ba=Va.next(b))}function d(){ba&&(Va.cancel(b),ba=null)}function f(a){a.preventDefault(),d(),S.forEach(function(a){a()})}function k(a){m.getError(),n.restore(),N.restore(),G.restore(),z.restore(),L.restore(),I.restore(),x&&x.restore(),T.procs.refresh(),c(),U.forEach(function(a){a()})}function p(a){function b(a){var c={},d={};return Object.keys(a).forEach(function(b){var e=a[b];ia.isDynamic(e)?d[b]=ia.unbox(e,b):c[b]=e}),{dynamic:d,static:c}}var d=b(a.context||{}),e=b(a.uniforms||{}),f=b(a.attributes||{}),g=b(function(a){function b(a){if(a in c){var d=c[a];delete c[a],Object.keys(d).forEach(function(b){c[a+"."+b]=d[b]})}}var c=A({},a);return delete c.uniforms,delete c.attributes,delete c.context,"stencil"in c&&c.stencil.op&&(c.stencil.opBack=c.stencil.opFront=c.stencil.op,delete c.stencil.op),b("blend"),b("depth"),b("cull"),b("stencil"),b("polygonOffset"),b("scissor"),b("sample"),c}(a));a={gpuTime:0,cpuTime:0,count:0};var h=(d=T.compile(g,f,e,d,a)).draw,k=d.batch,l=d.scope,m=[];return A(function(a,b){var d;if("function"==typeof a)return l.call(this,null,a,0);if("function"==typeof b)if("number"==typeof a)for(d=0;d<a;++d)l.call(this,null,b,d);else{if(!Array.isArray(a))return l.call(this,a,b,0);for(d=0;d<a.length;++d)l.call(this,a[d],b,d)}else if("number"==typeof a){if(0<a)return k.call(this,function c(a){for(;m.length<a;)m.push(null);return m}(0|a),0|a)}else{if(!Array.isArray(a))return h.call(this,a);if(a.length)return k.call(this,a,a.length)}},{stats:a})}function h(a,b){var c=0;T.procs.poll();var d=b.color;d&&(m.clearColor(+d[0]||0,+d[1]||0,+d[2]||0,+d[3]||0),c|=16384),"depth"in b&&(m.clearDepth(+b.depth),c|=256),"stencil"in b&&(m.clearStencil(0|b.stencil),c|=1024),m.clear(c)}function g(a){return E.push(a),c(),{cancel:function(){var c=tb(E,a);E[c]=function b(){var a=tb(E,b);E[a]=E[E.length-1],--E.length,0>=E.length&&d()}}}}function r(){var a=O.viewport,b=O.scissor_box;a[0]=a[1]=b[0]=b[1]=0,M.viewportWidth=M.framebufferWidth=M.drawingBufferWidth=a[2]=b[2]=m.drawingBufferWidth,M.viewportHeight=M.framebufferHeight=M.drawingBufferHeight=a[3]=b[3]=m.drawingBufferHeight}function v(){M.tick+=1,M.time=u(),r(),T.procs.poll()}function l(){r(),T.procs.refresh(),x&&x.update()}function u(){return(ub()-C)/1e3}if(!(a=zb(a)))return null;var m=a.gl,e=m.getContextAttributes();m.isContextLost();var n=function Ab(a,b){function c(b){var c;b=b.toLowerCase();try{c=d[b]=a.getExtension(b)}catch(g){}return!!c}for(var d={},f=0;f<b.extensions.length;++f){var k=b.extensions[f];if(!c(k))return b.onDestroy(),b.onDone('"'+k+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return b.optionalExtensions.forEach(c),{extensions:d,restore:function(){Object.keys(d).forEach(function(a){if(!c(a))throw Error("(regl): error restoring extension "+a)})}}}(m,a);if(!n)return null;var D=function wb(){var a={"":0},b=[""];return{id:function(c){var d=a[c];return d||(d=a[c]=b.length,b.push(c),d)},str:function(a){return b[a]}}}(),w={bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},t=n.extensions,x=function(a,b){function d(a,b,d){var e=h.pop()||new function c(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null};e.startQueryIndex=a,e.endQueryIndex=b,e.sum=0,e.stats=d,g.push(e)}var f=b.ext_disjoint_timer_query;if(!f)return null;var k=[],p=[],h=[],g=[],r=[],v=[];return{beginQuery:function(a){var b=k.pop()||f.createQueryEXT();f.beginQueryEXT(35007,b),p.push(b),d(p.length-1,p.length,a)},endQuery:function(){f.endQueryEXT(35007)},pushScopeStats:d,update:function(){var a,b;if(0!==(a=p.length)){v.length=Math.max(v.length,a+1),r.length=Math.max(r.length,a+1),r[0]=0;var c=v[0]=0;for(b=a=0;b<p.length;++b){var e=p[b];f.getQueryObjectEXT(e,34919)?(c+=f.getQueryObjectEXT(e,34918),k.push(e)):p[a++]=e,r[b+1]=c,v[b+1]=a}for(p.length=a,b=a=0;b<g.length;++b){var d=(c=g[b]).startQueryIndex;e=c.endQueryIndex,c.sum+=r[e]-r[d],d=v[d],(e=v[e])===d?(c.stats.gpuTime+=c.sum/1e6,h.push(c)):(c.startQueryIndex=d,c.endQueryIndex=e,g[a++]=c)}g.length=a}},getNumPendingQueries:function(){return p.length},clear:function(){k.push.apply(k,p);for(var a=0;a<k.length;a++)f.deleteQueryEXT(k[a]);p.length=0,k.length=0},restore:function(){p.length=0,k.length=0}}}(0,t),C=ub(),B=m.drawingBufferWidth,J=m.drawingBufferHeight,M={tick:0,time:0,viewportWidth:B,viewportHeight:J,framebufferWidth:B,framebufferHeight:J,drawingBufferWidth:B,drawingBufferHeight:J,pixelRatio:a.pixelRatio},P=function(a,b){var c=1;b.ext_texture_filter_anisotropic&&(c=a.getParameter(34047));var d=1,f=1;return b.webgl_draw_buffers&&(d=a.getParameter(34852),f=a.getParameter(36063)),{colorBits:[a.getParameter(3410),a.getParameter(3411),a.getParameter(3412),a.getParameter(3413)],depthBits:a.getParameter(3414),stencilBits:a.getParameter(3415),subpixelBits:a.getParameter(3408),extensions:Object.keys(b).filter(function(a){return!!b[a]}),maxAnisotropic:c,maxDrawbuffers:d,maxColorAttachments:f,pointSizeDims:a.getParameter(33901),lineWidthDims:a.getParameter(33902),maxViewportDims:a.getParameter(3386),maxCombinedTextureUnits:a.getParameter(35661),maxCubeMapSize:a.getParameter(34076),maxRenderbufferSize:a.getParameter(34024),maxTextureUnits:a.getParameter(34930),maxTextureSize:a.getParameter(3379),maxAttributes:a.getParameter(34921),maxVertexUniforms:a.getParameter(36347),maxVertexTextureUnits:a.getParameter(35660),maxVaryingVectors:a.getParameter(36348),maxFragmentUniforms:a.getParameter(36349),glsl:a.getParameter(35724),renderer:a.getParameter(7937),vendor:a.getParameter(7936),version:a.getParameter(7938)}}(m,t),G=Bb(m,w,a),Q=Cb(m,t,G,w),N=(B=function Kb(a,b,c,d,f){for(a=c.maxAttributes,b=Array(a),c=0;c<a;++c)b[c]=new pb;return{Record:pb,scope:{},state:b}}(m,t,P),Lb(m,D,w,a)),z=Fb(m,t,P,function(){T.procs.poll()},M,w,a),L=Rb(m,t,0,w,a),I=Jb(m,t,P,z,L,w),T=Ob(m,D,t,P,G,Q,0,I,{},B,N,{elements:null,primitive:4,count:-1,offset:0,instances:-1},M,x,a),O=(D=Mb(m,I,T.procs.poll,M),T.next),H=m.canvas,E=[],S=[],U=[],R=[a.onDestroy],ba=null;H&&(H.addEventListener("webglcontextlost",f,!1),H.addEventListener("webglcontextrestored",k,!1));var Y=I.setFBO=p({framebuffer:ia.define.call(null,1,"framebuffer")});return l(),e=A(p,{clear:function(a){if("framebuffer"in a)if(a.framebuffer&&"framebufferCube"===a.framebuffer_reglType)for(var b=0;6>b;++b)Y(A({framebuffer:a.framebuffer.faces[b]},a),h);else Y(a,h);else h(0,a)},prop:ia.define.bind(null,1),context:ia.define.bind(null,2),this:ia.define.bind(null,3),draw:p({}),buffer:function(a){return G.create(a,34962,!1,!1)},elements:function(a){return Q.create(a,!1)},texture:z.create2D,cube:z.createCube,renderbuffer:L.create,framebuffer:I.create,framebufferCube:I.createCube,attributes:e,frame:g,on:function(a,b){var c;switch(a){case"frame":return g(b);case"lost":c=S;break;case"restore":c=U;break;case"destroy":c=R}return c.push(b),{cancel:function(){for(var a=0;a<c.length;++a)if(c[a]===b){c[a]=c[c.length-1],c.pop();break}}}},limits:P,hasExtension:function(a){return 0<=P.extensions.indexOf(a.toLowerCase())},read:D,destroy:function(){E.length=0,d(),H&&(H.removeEventListener("webglcontextlost",f),H.removeEventListener("webglcontextrestored",k)),N.clear(),I.clear(),L.clear(),z.clear(),Q.clear(),G.clear(),x&&x.clear(),R.forEach(function(a){a()})},_gl:m,_refresh:l,poll:function(){v(),x&&x.update()},now:u,stats:w}),a.onDone(null,e),e}},"object"==typeof _$regl_315.exports?_$regl_315.exports=ea():da.createREGL=ea(),_$regl_315=_$regl_315.exports;var _$gup_536={keyFun:function(d){return d.key},repeat:wrap,descend:_$identity_538,wrap:wrap,unwrap:function(d){return d[0]}},_$constants_831={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,scatter:!1,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,bar:{width:4,capturewidth:10,fillcolor:"magenta",fillopacity:1,strokecolor:"white",strokeopacity:1,strokewidth:1,handleheight:16,handleopacity:1,handleoverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}},vertexShaderSource=_$browser_238(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 p0, p1, p2, p3,\n               p4, p5, p6, p7,\n               p8, p9, pa, pb,\n               pc, pd, pe;\n\nattribute vec4 pf;\n\nuniform mat4 dim1A, dim2A, dim1B, dim2B, dim1C, dim2C, dim1D, dim2D,\n             loA, hiA, loB, hiB, loC, hiC, loD, hiD;\n\nuniform vec2 resolution,\n             viewBoxPosition,\n             viewBoxSize;\n\nuniform sampler2D palette;\n\nuniform vec2 colorClamp;\n\nuniform float scatter;\n\nvarying vec4 fragColor;\n\nvec4 zero = vec4(0, 0, 0, 0);\nvec4 unit = vec4(1, 1, 1, 1);\nvec2 xyProjection = vec2(1, 1);\n\nmat4 mclamp(mat4 m, mat4 lo, mat4 hi) {\n    return mat4(clamp(m[0], lo[0], hi[0]),\n                clamp(m[1], lo[1], hi[1]),\n                clamp(m[2], lo[2], hi[2]),\n                clamp(m[3], lo[3], hi[3]));\n}\n\nbool mshow(mat4 p, mat4 lo, mat4 hi) {\n    return mclamp(p, lo, hi) == p;\n}\n\nfloat val(mat4 p, mat4 v) {\n    return dot(matrixCompMult(p, v) * unit, unit);\n}\n\nvoid main() {\n\n    float x = 0.5 * sign(pf[3]) + 0.5;\n    float prominence = abs(pf[3]);\n    float depth = 1.0 - prominence;\n\n    mat4 pA = mat4(p0, p1, p2, p3);\n    mat4 pB = mat4(p4, p5, p6, p7);\n    mat4 pC = mat4(p8, p9, pa, pb);\n    mat4 pD = mat4(pc, pd, pe, abs(pf));\n\n    float show = float(mshow(pA, loA, hiA) &&\n                       mshow(pB, loB, hiB) &&\n                       mshow(pC, loC, hiC) &&\n                       mshow(pD, loD, hiD));\n\n    vec2 yy = show * vec2(val(pA, dim2A) + val(pB, dim2B) + val(pC, dim2C) + val(pD, dim2D),\n                          val(pA, dim1A) + val(pB, dim1B) + val(pC, dim1C) + val(pD, dim1D));\n\n    vec2 dimensionToggle = vec2(x, 1.0 - x);\n\n    vec2 scatterToggle = vec2(scatter, 1.0 - scatter);\n\n    float y = dot(yy, dimensionToggle);\n    mat2 xy = mat2(viewBoxSize * yy + dimensionToggle, viewBoxSize * vec2(x, y));\n\n    vec2 viewBoxXY = viewBoxPosition + xy * scatterToggle;\n\n    float depthOrHide = depth + 2.0 * (1.0 - show);\n\n    gl_Position = vec4(\n        xyProjection * (2.0 * viewBoxXY / resolution - 1.0),\n        depthOrHide,\n        1.0\n    );\n\n    // visible coloring\n    float clampedColorIndex = clamp((prominence - colorClamp[0]) / (colorClamp[1] - colorClamp[0]), 0.0, 1.0);\n    fragColor = texture2D(palette, vec2((clampedColorIndex * 255.0 + 0.5) / 256.0, 0.5));\n}\n"]),pickVertexShaderSource=_$browser_238(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 p0, p1, p2, p3,\n               p4, p5, p6, p7,\n               p8, p9, pa, pb,\n               pc, pd, pe;\n\nattribute vec4 pf;\n\nuniform mat4 dim1A, dim2A, dim1B, dim2B, dim1C, dim2C, dim1D, dim2D,\n             loA, hiA, loB, hiB, loC, hiC, loD, hiD;\n\nuniform vec2 resolution,\n             viewBoxPosition,\n             viewBoxSize;\n\nuniform sampler2D palette;\n\nuniform vec2 colorClamp;\n\nuniform float scatter;\n\nvarying vec4 fragColor;\n\nvec4 zero = vec4(0, 0, 0, 0);\nvec4 unit = vec4(1, 1, 1, 1);\nvec2 xyProjection = vec2(1, 1);\n\nmat4 mclamp(mat4 m, mat4 lo, mat4 hi) {\n    return mat4(clamp(m[0], lo[0], hi[0]),\n                clamp(m[1], lo[1], hi[1]),\n                clamp(m[2], lo[2], hi[2]),\n                clamp(m[3], lo[3], hi[3]));\n}\n\nbool mshow(mat4 p, mat4 lo, mat4 hi) {\n    return mclamp(p, lo, hi) == p;\n}\n\nfloat val(mat4 p, mat4 v) {\n    return dot(matrixCompMult(p, v) * unit, unit);\n}\n\nvoid main() {\n\n    float x = 0.5 * sign(pf[3]) + 0.5;\n    float prominence = abs(pf[3]);\n    float depth = 1.0 - prominence;\n\n    mat4 pA = mat4(p0, p1, p2, p3);\n    mat4 pB = mat4(p4, p5, p6, p7);\n    mat4 pC = mat4(p8, p9, pa, pb);\n    mat4 pD = mat4(pc, pd, pe, abs(pf));\n\n    float show = float(mshow(pA, loA, hiA) &&\n                       mshow(pB, loB, hiB) &&\n                       mshow(pC, loC, hiC) &&\n                       mshow(pD, loD, hiD));\n\n    vec2 yy = show * vec2(val(pA, dim2A) + val(pB, dim2B) + val(pC, dim2C) + val(pD, dim2D),\n                          val(pA, dim1A) + val(pB, dim1B) + val(pC, dim1C) + val(pD, dim1D));\n\n    vec2 dimensionToggle = vec2(x, 1.0 - x);\n\n    vec2 scatterToggle = vec2(scatter, 1.0 - scatter);\n\n    float y = dot(yy, dimensionToggle);\n    mat2 xy = mat2(viewBoxSize * yy + dimensionToggle, viewBoxSize * vec2(x, y));\n\n    vec2 viewBoxXY = viewBoxPosition + xy * scatterToggle;\n\n    float depthOrHide = depth + 2.0 * (1.0 - show);\n\n    gl_Position = vec4(\n        xyProjection * (2.0 * viewBoxXY / resolution - 1.0),\n        depthOrHide,\n        1.0\n    );\n\n    // pick coloring\n    fragColor = vec4(pf.rgb, 1.0);\n}\n"]),fragmentShaderSource=_$browser_238(["precision lowp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n    gl_FragColor = fragColor;\n}\n"]),depthLimitEpsilon=1e-6,gpuDimensionCount=64,sectionVertexCount=2,vec4NumberCount=4,contextColor=[119,119,119],dummyPixel=new Uint8Array(4),pickPixel=new Uint8Array(4);function clear(regl,x,y,width,height){var gl=regl._gl;gl.enable(gl.SCISSOR_TEST),gl.scissor(x,y,width,height),regl.clear({color:[0,0,0,0],depth:1})}function renderBlock(regl,glAes,renderState,blockLineCount,sampleCount,item){var rafKey=item.key;renderState.drawCompleted||(!function ensureDraw(regl){regl.read({x:0,y:0,width:1,height:1,data:dummyPixel})}(regl),renderState.drawCompleted=!0),function render(blockNumber){var count;count=Math.min(blockLineCount,sampleCount-blockNumber*blockLineCount),item.offset=sectionVertexCount*blockNumber*blockLineCount,item.count=sectionVertexCount*count,0===blockNumber&&(window.cancelAnimationFrame(renderState.currentRafs[rafKey]),delete renderState.currentRafs[rafKey],clear(regl,item.scissorX,item.scissorY,item.scissorWidth,item.viewBoxSize[1])),renderState.clearOnly||(glAes(item),blockNumber*blockLineCount+count<sampleCount&&(renderState.currentRafs[rafKey]=window.requestAnimationFrame(function(){render(blockNumber+1)})),renderState.drawCompleted=!1)}(0)}function calcPickColor(j,rgbIndex){return(j>>>8*rgbIndex)%256/255}function makeAttributes(sampleCount,points){var attributes={};return[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15].map(function(vecIndex){return function makeVecAttr(sampleCount,points,vecIndex){var i,j,k,pointPairs=[];for(j=0;j<sampleCount;j++)for(k=0;k<sectionVertexCount;k++)for(i=0;i<vec4NumberCount;i++)pointPairs.push(points[j*gpuDimensionCount+vecIndex*vec4NumberCount+i]),vecIndex*vec4NumberCount+i===gpuDimensionCount-1&&k%2==0&&(pointPairs[pointPairs.length-1]*=-1);return pointPairs}(sampleCount,points,vecIndex)}).forEach(function(v,vecIndex){attributes["p"+vecIndex.toString(16)]=v}),attributes}function valid(i,offset,panelCount){return i+offset<=panelCount}var _$lines_834=function(canvasGL,d,scatter){var model=d.model,vm=d.viewModel,domain=model.domain,lines=model.lines,canvasWidth=model.canvasWidth,canvasHeight=model.canvasHeight,initialDimensions=vm.dimensions,initialPanels=vm.panels,unitToColor=model.unitToColor,context=d.context,pick=d.pick,renderState={currentRafs:{},drawCompleted:!0,clearOnly:!1},initialDims=initialDimensions.slice(),dimensionCount=initialDims.length,sampleCount=initialDims[0]?initialDims[0].values.length:0,focusAlphaBlending=context,color=pick?lines.color.map(function(_,i){return i/lines.color.length}):lines.color,contextOpacity=Math.max(1/255,Math.pow(1/color.length,1/3)),overdrag=lines.canvasOverdrag,panelCount=initialPanels.length,points=function makePoints(sampleCount,dimensionCount,dimensions,color){for(var d,points=[],j=0;j<sampleCount;j++)for(var i=0;i<gpuDimensionCount;i++)points.push(i<dimensionCount?dimensions[i].paddedUnitValues[j]:i===gpuDimensionCount-1?(d=color[j],Math.max(depthLimitEpsilon,Math.min(1-depthLimitEpsilon,d))):i>=gpuDimensionCount-4?calcPickColor(j,gpuDimensionCount-2-i):.5);return points}(sampleCount,dimensionCount,initialDims,color),attributes=makeAttributes(sampleCount,points),regl=d.regl,paletteTexture=regl.texture({shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest",data:function palette(unitToColor,context,opacity){for(var result=[],j=0;j<256;j++){var c=unitToColor(j/255);result.push((context?contextColor:c).concat(opacity))}return result}(unitToColor,context,Math.round(255*(context?contextOpacity:1)))}),glAes=regl({profile:!1,blend:{enable:focusAlphaBlending,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!focusAlphaBlending,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:regl.prop("scissorX"),y:regl.prop("scissorY"),width:regl.prop("scissorWidth"),height:regl.prop("scissorHeight")}},viewport:{x:regl.prop("viewportX"),y:regl.prop("viewportY"),width:regl.prop("viewportWidth"),height:regl.prop("viewportHeight")},dither:!1,vert:pick?pickVertexShaderSource:vertexShaderSource,frag:fragmentShaderSource,primitive:"lines",lineWidth:1,attributes:attributes,uniforms:{resolution:regl.prop("resolution"),viewBoxPosition:regl.prop("viewBoxPosition"),viewBoxSize:regl.prop("viewBoxSize"),dim1A:regl.prop("dim1A"),dim2A:regl.prop("dim2A"),dim1B:regl.prop("dim1B"),dim2B:regl.prop("dim2B"),dim1C:regl.prop("dim1C"),dim2C:regl.prop("dim2C"),dim1D:regl.prop("dim1D"),dim2D:regl.prop("dim2D"),loA:regl.prop("loA"),hiA:regl.prop("hiA"),loB:regl.prop("loB"),hiB:regl.prop("hiB"),loC:regl.prop("loC"),hiC:regl.prop("hiC"),loD:regl.prop("loD"),hiD:regl.prop("hiD"),palette:paletteTexture,colorClamp:regl.prop("colorClamp"),scatter:regl.prop("scatter")},offset:regl.prop("offset"),count:regl.prop("count")}),colorClamp=[0,1];var previousAxisOrder=[];function makeItem(i,ii,x,y,panelSizeX,canvasPanelSizeY,crossfilterDimensionIndex,scatter,I,leftmost,rightmost){var loHi,abcd,d,index,leftRight=[i,ii],filterEpsilon=_$constants_831.verticalPadding/canvasPanelSizeY,dims=[0,1].map(function(){return[0,1,2,3].map(function(){return new Float32Array(16)})}),lims=[0,1].map(function(){return[0,1,2,3].map(function(){return new Float32Array(16)})});for(loHi=0;loHi<2;loHi++)for(index=leftRight[loHi],abcd=0;abcd<4;abcd++)for(d=0;d<16;d++){var dimP=d+16*abcd;dims[loHi][abcd][d]=d+16*abcd===index?1:0,lims[loHi][abcd][d]=(!context&&valid(d,16*abcd,panelCount)?initialDims[0===dimP?0:1+(dimP-1)%(initialDims.length-1)].filter[loHi]:loHi)+(2*loHi-1)*filterEpsilon}return{key:crossfilterDimensionIndex,resolution:[canvasWidth,canvasHeight],viewBoxPosition:[x+overdrag,y],viewBoxSize:[panelSizeX,canvasPanelSizeY],i:i,ii:ii,dim1A:dims[0][0],dim1B:dims[0][1],dim1C:dims[0][2],dim1D:dims[0][3],dim2A:dims[1][0],dim2B:dims[1][1],dim2C:dims[1][2],dim2D:dims[1][3],loA:lims[0][0],loB:lims[0][1],loC:lims[0][2],loD:lims[0][3],hiA:lims[1][0],hiB:lims[1][1],hiC:lims[1][2],hiD:lims[1][3],colorClamp:colorClamp,scatter:scatter||0,scissorX:(I===leftmost?0:x+overdrag)+(model.pad.l-overdrag)+model.layoutWidth*domain.x[0],scissorWidth:(I===rightmost?canvasWidth-x+overdrag:panelSizeX+.5)+(I===leftmost?x+overdrag:0),scissorY:y+model.pad.b+model.layoutHeight*domain.y[0],scissorHeight:canvasPanelSizeY,viewportX:model.pad.l-overdrag+model.layoutWidth*domain.x[0],viewportY:model.pad.b+model.layoutHeight*domain.y[0],viewportWidth:canvasWidth,viewportHeight:canvasHeight}}return{setColorDomain:function setColorDomain(unitDomain){colorClamp[0]=unitDomain[0],colorClamp[1]=unitDomain[1]},render:function renderGLParcoords(panels,setChanged,clearOnly){var I,leftmost,rightmost,lowestX=1/0,highestX=-1/0;for(I=0;I<panelCount;I++)panels[I].dim2.canvasX>highestX&&(highestX=panels[I].dim2.canvasX,rightmost=I),panels[I].dim1.canvasX<lowestX&&(lowestX=panels[I].dim1.canvasX,leftmost=I);for(0===panelCount&&clear(regl,0,0,canvasWidth,canvasHeight),I=0;I<panelCount;I++){var panel=panels[I],dim1=panel.dim1,i=dim1.crossfilterDimensionIndex,x=panel.canvasX,y=panel.canvasY,ii=panel.dim2.crossfilterDimensionIndex,panelSizeX=panel.panelSizeX,panelSizeY=panel.panelSizeY,xTo=x+panelSizeX;if(setChanged||!previousAxisOrder[i]||previousAxisOrder[i][0]!==x||previousAxisOrder[i][1]!==xTo){previousAxisOrder[i]=[x,xTo];var item=makeItem(i,ii,x,y,panelSizeX,panelSizeY,dim1.crossfilterDimensionIndex,scatter||dim1.scatter?1:0,I,leftmost,rightmost);renderState.clearOnly=clearOnly,renderBlock(regl,glAes,renderState,setChanged?lines.blockLineCount:sampleCount,sampleCount,item)}}},readPixel:function readPixel(canvasX,canvasY){return regl.read({x:canvasX,y:canvasY,width:1,height:1,data:pickPixel}),pickPixel},readPixels:function readPixels(canvasX,canvasY,width,height){var pixelArray=new Uint8Array(4*width*height);return regl.read({x:canvasX,y:canvasY,width:width,height:height,data:pixelArray}),pixelArray},destroy:function destroy(){canvasGL.style["pointer-events"]="none",paletteTexture.destroy()}}},keyFun=_$gup_536.keyFun,__repeat_835=_$gup_536.repeat,unwrap=_$gup_536.unwrap;function visible(dimension){return!("visible"in dimension)||dimension.visible}function dimensionExtent(dimension){var lo=dimension.range?dimension.range[0]:_$lib_539.aggNums(Math.min,null,dimension.values,dimension._length),hi=dimension.range?dimension.range[1]:_$lib_539.aggNums(Math.max,null,dimension.values,dimension._length);return!isNaN(lo)&&isFinite(lo)||(lo=0),!isNaN(hi)&&isFinite(hi)||(hi=0),lo===hi&&(void 0===lo?(lo=0,hi=1):0===lo?(lo-=1,hi+=1):(lo*=.9,hi*=1.1)),[lo,hi]}function ordinalScaleSnap(scale,v){var i,a,prevDiff,prevValue,diff;for(i=0,prevDiff=1/0,prevValue=(a=scale.range())[0];i<a.length;i++){if((diff=Math.abs(a[i]-v))>prevDiff)return prevValue;prevDiff=diff,prevValue=a[i]}return a[a.length-1]}function domainToUnitScale(dimension){return _$d3_127.scale.linear().domain(dimensionExtent(dimension))}function model(layout,d,i){var cd0=unwrap(d),trace=cd0.trace,lineColor=cd0.lineColor,cscale=cd0.cscale,line=trace.line,domain=trace.domain,dimensions=trace.dimensions,width=layout.width,labelFont=trace.labelfont,tickFont=trace.tickfont,rangeFont=trace.rangefont,lines=_$lib_539.extendDeep({},line,{color:lineColor.map(domainToUnitScale({values:lineColor,range:[line.cmin,line.cmax],_length:trace._commonLength})),blockLineCount:_$constants_831.blockLineCount,canvasOverdrag:_$constants_831.overdrag*_$constants_831.canvasPixelRatio}),groupWidth=Math.floor(width*(domain.x[1]-domain.x[0])),groupHeight=Math.floor(layout.height*(domain.y[1]-domain.y[0])),pad=layout.margin||{l:80,r:80,t:100,b:80},rowContentWidth=groupWidth,rowHeight=groupHeight;return{key:i,colCount:dimensions.filter(visible).length,dimensions:dimensions,tickDistance:_$constants_831.tickDistance,unitToColor:function unitToColorScale(cscale){var colorStops=cscale.map(function(d){return d[0]}),colorTuples=cscale.map(function(d){return d[1]}).map(function(c){return _$d3_127.rgb(c)}),polylinearUnitScales="rgb".split("").map(function(key){return _$d3_127.scale.linear().clamp(!0).domain(colorStops).range(colorTuples.map((n=key,function(o){return o[n]})));var n});return function(d){return polylinearUnitScales.map(function(s){return s(d)})}}(cscale),lines:lines,labelFont:labelFont,tickFont:tickFont,rangeFont:rangeFont,layoutWidth:width,layoutHeight:layout.height,domain:domain,translateX:domain.x[0]*width,translateY:layout.height-domain.y[1]*layout.height,pad:pad,canvasWidth:rowContentWidth*_$constants_831.canvasPixelRatio+2*lines.canvasOverdrag,canvasHeight:rowHeight*_$constants_831.canvasPixelRatio,width:rowContentWidth,height:rowHeight,canvasPixelRatio:_$constants_831.canvasPixelRatio}}function viewModel(model){var width=model.width,height=model.height,dimensions=model.dimensions,canvasPixelRatio=model.canvasPixelRatio,xScale=function(d){return width*d/Math.max(1,model.colCount-1)},unitPad=_$constants_831.verticalPadding/(height*canvasPixelRatio),unitPadScale=1-2*unitPad,paddedUnitScale=function(d){return unitPad+unitPadScale*d},viewModel={key:model.key,xScale:xScale,model:model},uniqueKeys={};return viewModel.dimensions=dimensions.filter(visible).map(function(dimension,i){var domainToUnit=domainToUnitScale(dimension),foundKey=uniqueKeys[dimension.label];uniqueKeys[dimension.label]=(foundKey||0)+1;var key=dimension.label+(foundKey?"__"+foundKey:""),truncatedValues=dimension.values;return truncatedValues.length>dimension._length&&(truncatedValues=truncatedValues.slice(0,dimension._length)),{key:key,label:dimension.label,tickFormat:dimension.tickformat,tickvals:dimension.tickvals,ticktext:dimension.ticktext,ordinal:!!dimension.tickvals,scatter:_$constants_831.scatter||dimension.scatter,xIndex:i,crossfilterDimensionIndex:i,visibleIndex:dimension._index,height:height,values:truncatedValues,paddedUnitValues:truncatedValues.map(domainToUnit).map(paddedUnitScale),xScale:xScale,x:xScale(i),canvasX:xScale(i)*canvasPixelRatio,unitScale:function unitScale(height,padding){return _$d3_127.scale.linear().range([height-padding,padding])}(height,_$constants_831.verticalPadding),domainScale:function domainScale(height,padding,dimension){var extent=dimensionExtent(dimension),texts=dimension.ticktext;return dimension.tickvals?_$d3_127.scale.ordinal().domain(dimension.tickvals.map(function toText(formatter,texts){return function(v,i){if(texts){var text=texts[i];return null===text||void 0===text?formatter(v):text}return formatter(v)}}(_$d3_127.format(dimension.tickformat),texts))).range(dimension.tickvals.map(function(d){return(d-extent[0])/(extent[1]-extent[0])}).map(function(d){return height-padding+d*(padding-(height-padding))})):_$d3_127.scale.linear().domain(extent).range([height-padding,padding])}(height,_$constants_831.verticalPadding,dimension),ordinalScale:function ordinalScale(dimension){var extent=dimensionExtent(dimension);return dimension.tickvals&&_$d3_127.scale.ordinal().domain(dimension.tickvals).range(dimension.tickvals.map(function(d){return(d-extent[0])/(extent[1]-extent[0])}))}(dimension),domainToUnitScale:domainToUnit,filter:dimension.constraintrange?dimension.constraintrange.map(domainToUnit):[0,1],parent:viewModel,model:model}}),viewModel}function styleExtentTexts(selection){selection.classed(_$constants_831.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default").style("user-select","none")}var _$plot_836={};(function(global){"use strict";_$plot_836=function plot(gd,cdparcoords){var fullLayout=gd._fullLayout,svg=fullLayout._toppaper,container=(fullLayout._paperdiv,fullLayout._glcontainer);fullLayout._glcanvas.each(function(d){d.regl||(d.regl=_$regl_315({canvas:this,attributes:{antialias:!d.pick,preserveDrawingBuffer:!0},pixelRatio:gd._context.plotGlPixelRatio||global.devicePixelRatio}))});var gdDimensions={},gdDimensionsOriginalOrder={},size=fullLayout._size;cdparcoords.forEach(function(d,i){gdDimensions[i]=gd.data[i].dimensions,gdDimensionsOriginalOrder[i]=gd.data[i].dimensions.slice()});!function(root,svg,parcoordsLineLayers,styledData,layout,callbacks){var domainBrushing=!1,linePickActive=!0;var vm=styledData.filter(function(d){return unwrap(d).trace.visible}).map(model.bind(0,layout)).map(viewModel);parcoordsLineLayers.each(function(d,i){return _$lib_539.extendFlat(d,vm[i])});var parcoordsLineLayer=parcoordsLineLayers.selectAll(".gl-canvas").each(function(d){d.viewModel=vm[0],d.model=d.viewModel?d.viewModel.model:null}),tweakables={renderers:[],dimensions:[]},lastHovered=null;parcoordsLineLayer.filter(function(d){return d.pick}).style("pointer-events","auto").on("mousemove",function(d){if(linePickActive&&d.lineLayer&&callbacks&&callbacks.hover){var event=_$d3_127.event,cw=this.width,ch=this.height,pointer=_$d3_127.mouse(this),x=pointer[0],y=pointer[1];if(x<0||y<0||x>=cw||y>=ch)return;var pixel=d.lineLayer.readPixel(x,ch-1-y),found=0!==pixel[3],curveNumber=found?pixel[2]+256*(pixel[1]+256*pixel[0]):null,eventData={x:x,y:y,clientX:event.clientX,clientY:event.clientY,dataIndex:d.model.key,curveNumber:curveNumber};curveNumber!==lastHovered&&(found?callbacks.hover(eventData):callbacks.unhover&&callbacks.unhover(eventData),lastHovered=curveNumber)}}),parcoordsLineLayer.style("opacity",function(d){return d.pick?.01:1}),svg.style("background","rgba(255, 255, 255, 0)");var parcoordsControlOverlay=svg.selectAll("."+_$constants_831.cn.parcoords).data(vm,keyFun);parcoordsControlOverlay.exit().remove(),parcoordsControlOverlay.enter().append("g").classed(_$constants_831.cn.parcoords,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","none").call(function enterSvgDefs(root){var defs=root.selectAll("defs").data(__repeat_835,keyFun);defs.enter().append("defs");var filterBarPattern=defs.selectAll("#"+_$constants_831.id.filterBarPattern).data(__repeat_835,keyFun);filterBarPattern.enter().append("pattern").attr("id",_$constants_831.id.filterBarPattern).attr("patternUnits","userSpaceOnUse"),filterBarPattern.attr("x",-_$constants_831.bar.width).attr("width",_$constants_831.bar.capturewidth).attr("height",function(d){return d.model.height});var filterBarPatternGlyph=filterBarPattern.selectAll("rect").data(__repeat_835,keyFun);filterBarPatternGlyph.enter().append("rect").attr("shape-rendering","crispEdges"),filterBarPatternGlyph.attr("height",function(d){return d.model.height}).attr("width",_$constants_831.bar.width).attr("x",_$constants_831.bar.width/2).attr("fill",_$constants_831.bar.fillcolor).attr("fill-opacity",_$constants_831.bar.fillopacity).attr("stroke",_$constants_831.bar.strokecolor).attr("stroke-opacity",_$constants_831.bar.strokeopacity).attr("stroke-width",_$constants_831.bar.strokewidth)}),parcoordsControlOverlay.attr("width",function(d){return d.model.width+d.model.pad.l+d.model.pad.r}).attr("height",function(d){return d.model.height+d.model.pad.t+d.model.pad.b}).attr("transform",function(d){return"translate("+d.model.translateX+","+d.model.translateY+")"});var parcoordsControlView=parcoordsControlOverlay.selectAll("."+_$constants_831.cn.parcoordsControlView).data(__repeat_835,keyFun);parcoordsControlView.enter().append("g").classed(_$constants_831.cn.parcoordsControlView,!0).style("box-sizing","content-box"),parcoordsControlView.attr("transform",function(d){return"translate("+d.model.pad.l+","+d.model.pad.t+")"});var yAxis=parcoordsControlView.selectAll("."+_$constants_831.cn.yAxis).data(function(vm){return vm.dimensions},keyFun);function someFiltersActive(view){return view.dimensions.some(function(p){return 0!==p.filter[0]||1!==p.filter[1]})}function updatePanelLayout(yAxis,vm){return(_$constants_831.scatter?function updatePanelLayoutScatter(yAxis,vm){for(var panels=vm.panels||(vm.panels=[]),yAxes=yAxis.each(function(d){return d})[vm.key].map(function(e){return e.__data__}),panelCount=yAxes.length-1,rowCount=panelCount,row=0;row<panelCount;row++)for(var p=0;p<panelCount;p++){var panel=panels[p+row*panelCount]||(panels[p+row*panelCount]={}),dim1=yAxes[p],dim2=yAxes[p+1];panel.dim1=yAxes[row+1],panel.dim2=dim2,panel.canvasX=dim1.canvasX,panel.panelSizeX=dim2.canvasX-dim1.canvasX,panel.panelSizeY=vm.model.canvasHeight/rowCount,panel.y=row*panel.panelSizeY,panel.canvasY=vm.model.canvasHeight-panel.y-panel.panelSizeY}}:function updatePanelLayoutParcoords(yAxis,vm){for(var panels=vm.panels||(vm.panels=[]),yAxes=yAxis.each(function(d){return d})[vm.key].map(function(e){return e.__data__}),panelCount=yAxes.length-1,row=0;row<1;row++)for(var p=0;p<panelCount;p++){var panel=panels[p+row*panelCount]||(panels[p+row*panelCount]={}),dim1=yAxes[p],dim2=yAxes[p+1];panel.dim1=dim1,panel.dim2=dim2,panel.canvasX=dim1.canvasX,panel.panelSizeX=dim2.canvasX-dim1.canvasX,panel.panelSizeY=vm.model.canvasHeight/1,panel.y=row*panel.panelSizeY,panel.canvasY=vm.model.canvasHeight-panel.y-panel.panelSizeY}})(yAxis,vm)}yAxis.enter().append("g").classed(_$constants_831.cn.yAxis,!0).each(function(d){tweakables.dimensions.push(d)}),parcoordsControlView.each(function(vm){updatePanelLayout(yAxis,vm)}),parcoordsLineLayer.filter(function(d){return!!d.viewModel}).each(function(d){d.lineLayer=_$lines_834(this,d,_$constants_831.scatter),d.viewModel[d.key]=d.lineLayer,tweakables.renderers.push(function(){d.lineLayer.render(d.viewModel.panels,!0)}),d.lineLayer.render(d.viewModel.panels,!d.context)}),yAxis.attr("transform",function(d){return"translate("+d.xScale(d.xIndex)+", 0)"}),yAxis.call(_$d3_127.behavior.drag().origin(function(d){return d}).on("drag",function(d){var p=d.parent;linePickActive=!1,domainBrushing||(d.x=Math.max(-_$constants_831.overdrag,Math.min(d.model.width+_$constants_831.overdrag,_$d3_127.event.x)),d.canvasX=d.x*d.model.canvasPixelRatio,yAxis.sort(function(a,b){return a.x-b.x}).each(function(dd,i){dd.xIndex=i,dd.x=d===dd?dd.x:dd.xScale(dd.xIndex),dd.canvasX=dd.x*dd.model.canvasPixelRatio}),updatePanelLayout(yAxis,p),yAxis.filter(function(dd){return 0!==Math.abs(d.xIndex-dd.xIndex)}).attr("transform",function(d){return"translate("+d.xScale(d.xIndex)+", 0)"}),_$d3_127.select(this).attr("transform","translate("+d.x+", 0)"),yAxis.each(function(dd,i,ii){ii===d.parent.key&&(p.dimensions[i]=dd)}),p.contextLayer&&p.contextLayer.render(p.panels,!1,!someFiltersActive(p)),p.focusLayer.render&&p.focusLayer.render(p.panels))}).on("dragend",function(d){var p=d.parent;domainBrushing?"ending"===domainBrushing&&(domainBrushing=!1):(d.x=d.xScale(d.xIndex),d.canvasX=d.x*d.model.canvasPixelRatio,updatePanelLayout(yAxis,p),_$d3_127.select(this).attr("transform",function(d){return"translate("+d.x+", 0)"}),p.contextLayer&&p.contextLayer.render(p.panels,!1,!someFiltersActive(p)),p.focusLayer&&p.focusLayer.render(p.panels),p.pickLayer&&p.pickLayer.render(p.panels,!0),linePickActive=!0,callbacks&&callbacks.axesMoved&&callbacks.axesMoved(p.key,p.dimensions.map(function(dd){return dd.crossfilterDimensionIndex})))})),yAxis.exit().remove();var axisOverlays=yAxis.selectAll("."+_$constants_831.cn.axisOverlays).data(__repeat_835,keyFun);axisOverlays.enter().append("g").classed(_$constants_831.cn.axisOverlays,!0),axisOverlays.selectAll("."+_$constants_831.cn.axis).remove();var axis=axisOverlays.selectAll("."+_$constants_831.cn.axis).data(__repeat_835,keyFun);axis.enter().append("g").classed(_$constants_831.cn.axis,!0),axis.each(function(d){var wantedTickCount=d.model.height/d.model.tickDistance,scale=d.domainScale,sdom=scale.domain();_$d3_127.select(this).call(_$d3_127.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(wantedTickCount,d.tickFormat).tickValues(d.ordinal?sdom:null).tickFormat(d.ordinal?function(d){return d}:null).scale(scale)),_$drawing_436.font(axis.selectAll("text"),d.model.tickFont)}),axis.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),axis.selectAll("text").style("text-shadow","1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff, -1px 1px 1px #fff").style("cursor","default").style("user-select","none");var axisHeading=axisOverlays.selectAll("."+_$constants_831.cn.axisHeading).data(__repeat_835,keyFun);axisHeading.enter().append("g").classed(_$constants_831.cn.axisHeading,!0);var axisTitle=axisHeading.selectAll("."+_$constants_831.cn.axisTitle).data(__repeat_835,keyFun);axisTitle.enter().append("text").classed(_$constants_831.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("user-select","none").style("pointer-events","auto"),axisTitle.attr("transform","translate(0,"+-_$constants_831.axisTitleOffset+")").text(function(d){return d.label}).each(function(d){_$drawing_436.font(axisTitle,d.model.labelFont)});var axisExtent=axisOverlays.selectAll("."+_$constants_831.cn.axisExtent).data(__repeat_835,keyFun);axisExtent.enter().append("g").classed(_$constants_831.cn.axisExtent,!0);var axisExtentTop=axisExtent.selectAll("."+_$constants_831.cn.axisExtentTop).data(__repeat_835,keyFun);axisExtentTop.enter().append("g").classed(_$constants_831.cn.axisExtentTop,!0),axisExtentTop.attr("transform","translate(0,"+-_$constants_831.axisExtentOffset+")");var axisExtentTopText=axisExtentTop.selectAll("."+_$constants_831.cn.axisExtentTopText).data(__repeat_835,keyFun);function formatExtreme(d){return d.ordinal?function(){return""}:_$d3_127.format(d.tickFormat)}axisExtentTopText.enter().append("text").classed(_$constants_831.cn.axisExtentTopText,!0).call(styleExtentTexts),axisExtentTopText.text(function(d){return formatExtreme(d)(d.domainScale.domain().slice(-1)[0])}).each(function(d){_$drawing_436.font(axisExtentTopText,d.model.rangeFont)});var axisExtentBottom=axisExtent.selectAll("."+_$constants_831.cn.axisExtentBottom).data(__repeat_835,keyFun);axisExtentBottom.enter().append("g").classed(_$constants_831.cn.axisExtentBottom,!0),axisExtentBottom.attr("transform",function(d){return"translate(0,"+(d.model.height+_$constants_831.axisExtentOffset)+")"});var axisExtentBottomText=axisExtentBottom.selectAll("."+_$constants_831.cn.axisExtentBottomText).data(__repeat_835,keyFun);axisExtentBottomText.enter().append("text").classed(_$constants_831.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(styleExtentTexts),axisExtentBottomText.text(function(d){return formatExtreme(d)(d.domainScale.domain()[0])}).each(function(d){_$drawing_436.font(axisExtentBottomText,d.model.rangeFont)});var axisBrush=axisOverlays.selectAll("."+_$constants_831.cn.axisBrush).data(__repeat_835,keyFun),axisBrushEnter=axisBrush.enter().append("g").classed(_$constants_831.cn.axisBrush,!0);axisBrush.each(function(d){d.brush||(d.brush=_$d3_127.svg.brush().y(d.unitScale).on("brushstart",axisBrushStarted).on("brush",axisBrushMoved).on("brushend",axisBrushEnded),0===d.filter[0]&&1===d.filter[1]||d.brush.extent(d.filter),_$d3_127.select(this).call(d.brush))}),axisBrushEnter.selectAll("rect").attr("x",-_$constants_831.bar.capturewidth/2).attr("width",_$constants_831.bar.capturewidth),axisBrushEnter.selectAll("rect.extent").attr("fill","url(#"+_$constants_831.id.filterBarPattern+")").style("cursor","ns-resize").filter(function(d){return 0===d.filter[0]&&1===d.filter[1]}).attr("y",-100),axisBrushEnter.selectAll(".resize rect").attr("height",_$constants_831.bar.handleheight).attr("opacity",0).style("visibility","visible"),axisBrushEnter.selectAll(".resize.n rect").style("cursor","n-resize").attr("y",_$constants_831.bar.handleoverlap-_$constants_831.bar.handleheight),axisBrushEnter.selectAll(".resize.s rect").style("cursor","s-resize").attr("y",_$constants_831.bar.handleoverlap);var justStarted=!1,contextShown=!1;function axisBrushStarted(){justStarted=!0,domainBrushing=!0}function axisBrushMoved(dimension){linePickActive=!1;var p=dimension.parent,extent=dimension.brush.extent(),dimensions=p.dimensions,filter=dimensions[dimension.xIndex].filter,reset=justStarted&&extent[0]===extent[1];reset&&(dimension.brush.clear(),_$d3_127.select(this).select("rect.extent").attr("y",-100));var newExtent=reset?[0,1]:extent.slice();if(newExtent[0]!==filter[0]||newExtent[1]!==filter[1]){dimensions[dimension.xIndex].filter=newExtent,p.focusLayer&&p.focusLayer.render(p.panels,!0);var filtersActive=someFiltersActive(p);!contextShown&&filtersActive?(p.contextLayer&&p.contextLayer.render(p.panels,!0),contextShown=!0):contextShown&&!filtersActive&&(p.contextLayer&&p.contextLayer.render(p.panels,!0,!0),contextShown=!1)}justStarted=!1}function axisBrushEnded(dimension){var p=dimension.parent,extent=dimension.brush.extent(),empty=extent[0]===extent[1],f=p.dimensions[dimension.xIndex].filter;if(!empty&&dimension.ordinal&&(f[0]=ordinalScaleSnap(dimension.ordinalScale,f[0]),f[1]=ordinalScaleSnap(dimension.ordinalScale,f[1]),f[0]===f[1]&&(f[0]=Math.max(0,f[0]-.05),f[1]=Math.min(1,f[1]+.05)),_$d3_127.select(this).transition().duration(150).call(dimension.brush.extent(f)),p.focusLayer.render(p.panels,!0)),p.pickLayer&&p.pickLayer.render(p.panels,!0),linePickActive=!0,domainBrushing="ending",callbacks&&callbacks.filterChanged){var invScale=dimension.domainToUnitScale.invert,newRange=f.map(invScale);callbacks.filterChanged(p.key,dimension.visibleIndex,newRange)}}}(0,svg,container,cdparcoords,{width:size.w,height:size.h,margin:{t:size.t,r:size.r,b:size.b,l:size.l}},{filterChanged:function(i,originalDimensionIndex,newRange){var gdDimension=gdDimensionsOriginalOrder[i][originalDimensionIndex],gdConstraintRange=gdDimension.constraintrange;gdConstraintRange&&2===gdConstraintRange.length||(gdConstraintRange=gdDimension.constraintrange=[]),gdConstraintRange[0]=newRange[0],gdConstraintRange[1]=newRange[1],gd.emit("plotly_restyle")},hover:function(eventData){gd.emit("plotly_hover",eventData)},unhover:function(eventData){gd.emit("plotly_unhover",eventData)},axesMoved:function(i,visibleIndices){function visible(dimension){return!("visible"in dimension)||dimension.visible}function newIdx(visibleIndices,orig,dim){var origIndex=orig.indexOf(dim),currentIndex=visibleIndices.indexOf(origIndex);return-1===currentIndex&&(currentIndex+=orig.length),currentIndex}var orig=function sorter(orig){return function sorter(d1,d2){return newIdx(visibleIndices,orig,d1)-newIdx(visibleIndices,orig,d2)}}(gdDimensionsOriginalOrder[i].filter(visible));gdDimensions[i].sort(orig),gdDimensionsOriginalOrder[i].filter(function(d){return!visible(d)}).sort(function(d){return gdDimensionsOriginalOrder[i].indexOf(d)}).forEach(function(d){gdDimensions[i].splice(gdDimensions[i].indexOf(d),1),gdDimensions[i].splice(gdDimensionsOriginalOrder[i].indexOf(d),0,d)}),gd.emit("plotly_restyle")}})}}).call(this,void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var _$base_plot_828={},__getModuleCalcData_828=_$get_data_621.getModuleCalcData;_$base_plot_828.name="parcoords",_$base_plot_828.plot=function(gd){var calcData=__getModuleCalcData_828(gd.calcdata,"parcoords");calcData.length&&_$plot_836(gd,calcData)},_$base_plot_828.clean=function(newFullData,newFullLayout,oldFullData,oldFullLayout){var hadParcoords=oldFullLayout._has&&oldFullLayout._has("parcoords"),hasParcoords=newFullLayout._has&&newFullLayout._has("parcoords");hadParcoords&&!hasParcoords&&(oldFullLayout._paperdiv.selectAll(".parcoords").remove(),oldFullLayout._glimages.selectAll("*").remove())},_$base_plot_828.toSVG=function(gd){var imageRoot=gd._fullLayout._glimages,root=_$d3_127.select(gd).selectAll(".svg-container");root.filter(function(d,i){return i===root.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function canvasToImage(){var imageData=this.toDataURL("image/png");imageRoot.append("svg:image").attr({xmlns:_$xmlns_namespaces_519.svg,"xlink:href":imageData,preserveAspectRatio:"none",x:0,y:0,width:this.width,height:this.height})}),window.setTimeout(function(){_$d3_127.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)};var __wrap_829=_$gup_536.wrap;var maxDimensionCount=_$constants_831.maxDimensionCount,__handleDomainDefaults_832=_$domain_610.defaults;var Parcoords={};Parcoords.attributes=_$attributes_827,Parcoords.supplyDefaults=function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_827,attr,dflt)}var dimensions=function dimensionsDefaults(traceIn,traceOut){var dimensionIn,dimensionOut,i,dimensionsIn=traceIn.dimensions||[],dimensionsOut=traceOut.dimensions=[],commonLength=1/0;function coerce(attr,dflt){return _$lib_539.coerce(dimensionIn,dimensionOut,_$attributes_827.dimensions,attr,dflt)}for(dimensionsIn.length>maxDimensionCount&&(_$lib_539.log("parcoords traces support up to "+maxDimensionCount+" dimensions at the moment"),dimensionsIn.splice(maxDimensionCount)),i=0;i<dimensionsIn.length;i++)if(dimensionIn=dimensionsIn[i],dimensionOut={},_$lib_539.isPlainObject(dimensionIn)){var values=coerce("values"),visible=coerce("visible");values&&values.length||(visible=dimensionOut.visible=!1),visible&&(coerce("label"),coerce("tickvals"),coerce("ticktext"),coerce("tickformat"),coerce("range"),coerce("constraintrange"),commonLength=Math.min(commonLength,values.length)),dimensionOut._index=i,dimensionsOut.push(dimensionOut)}return traceOut._commonLength=commonLength,dimensionsOut}(traceIn,traceOut);!function __handleLineDefaults_832(traceIn,traceOut,defaultColor,layout,coerce){var lineColor=coerce("line.color",defaultColor);_$hasColorscale_425(traceIn,"line")&&_$lib_539.isArrayOrTypedArray(lineColor)&&(lineColor.length?(coerce("line.colorscale"),_$colorScaleDefaults_421(traceIn,traceOut,layout,coerce,{prefix:"line.",cLetter:"c"}),traceOut._commonLength=Math.min(traceOut._commonLength,lineColor.length)):traceOut.line.color=defaultColor)}(traceIn,traceOut,defaultColor,layout,coerce),__handleDomainDefaults_832(traceOut,layout,coerce),Array.isArray(dimensions)&&dimensions.length||(traceOut.visible=!1);for(var i=0;i<dimensions.length;i++)dimensions[i].visible&&(dimensions[i]._length=traceOut._commonLength);var fontDflt={family:layout.font.family,size:Math.round(layout.font.size/1.2),color:layout.font.color};_$lib_539.coerceFont(coerce,"labelfont",fontDflt),_$lib_539.coerceFont(coerce,"tickfont",fontDflt),_$lib_539.coerceFont(coerce,"rangefont",fontDflt)},Parcoords.calc=function calc(gd,trace){var cs=!!trace.line.colorscale&&_$lib_539.isArrayOrTypedArray(trace.line.color),color=cs?trace.line.color:function constHalf(len){for(var out=new Array(len),i=0;i<len;i++)out[i]=.5;return out}(trace._commonLength),cscale=cs?trace.line.colorscale:[[0,trace.line.color],[1,trace.line.color]];return _$hasColorscale_425(trace,"line")&&_$calc_418(trace,color,"line","c"),__wrap_829({lineColor:color,cscale:cscale})},Parcoords.plot=_$plot_836,Parcoords.colorbar=function colorbar(gd,cd){var trace=cd[0].trace,line=trace.line,cbId="cb"+trace.uid;if(gd._fullLayout._infolayer.selectAll("."+cbId).remove(),void 0!==line&&line.showscale){var vals=line.color,cmin=line.cmin,cmax=line.cmax;_$fastIsnumeric_139(cmin)||(cmin=_$lib_539.aggNums(Math.min,null,vals)),_$fastIsnumeric_139(cmax)||(cmax=_$lib_539.aggNums(Math.max,null,vals));var cb=cd[0].t.cb=_$draw_415(gd,cbId),sclFunc=_$colorscale_426.makeColorScaleFunc(_$colorscale_426.extractScale(line.colorscale,cmin,cmax),{noNumericCheck:!0});cb.fillcolor(sclFunc).filllevels({start:cmin,end:cmax,size:(cmax-cmin)/254}).options(line.colorbar)()}else _$plots_647.autoMargin(gd,cbId)},Parcoords.moduleType="trace",Parcoords.name="parcoords",Parcoords.basePlotModule=_$base_plot_828,Parcoords.categories=["gl","regl","noOpacity"],Parcoords.meta={};var _$parcoords_23=Parcoords,__domainAttrs_837=_$domain_610.attributes,__extendFlat_837=_$extend_528.extendFlat,__textFontAttrs_837=_$font_attributes_611({editType:"calc",colorEditType:"style"}),_$attributes_837={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:_$attributes_410.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:__extendFlat_837({},_$attributes_581.hoverinfo,{flags:["label","text","value","percent","name"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"calc"},textfont:__extendFlat_837({},__textFontAttrs_837,{}),insidetextfont:__extendFlat_837({},__textFontAttrs_837,{}),outsidetextfont:__extendFlat_837({},__textFontAttrs_837,{}),domain:__domainAttrs_837({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"number",min:-360,max:360,dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"}},_$base_plot_838={};_$base_plot_838.name="pie",_$base_plot_838.plot=function(gd){var Pie=_$registry_668.getModule("pie"),cdPie=function getCdModule(calcdata,_module){for(var cdModule=[],i=0;i<calcdata.length;i++){var cd=calcdata[i],trace=cd[0].trace;trace._module===_module&&!0===trace.visible&&cdModule.push(cd)}return cdModule}(gd.calcdata,Pie);cdPie.length&&Pie.plot(gd,cdPie)},_$base_plot_838.clean=function(newFullData,newFullLayout,oldFullData,oldFullLayout){var hadPie=oldFullLayout._has&&oldFullLayout._has("pie"),hasPie=newFullLayout._has&&newFullLayout._has("pie");hadPie&&!hasPie&&oldFullLayout._pielayer.selectAll("g.trace").remove()};var pieDefaultColors,__isArrayOrTypedArray_839=_$lib_539.isArrayOrTypedArray;function nextDefaultColor(index,pieColorWay){if(!pieDefaultColors){var mainDefaults=_$color_411.defaults;pieDefaultColors=generateDefaultColors(mainDefaults)}var pieColors=pieColorWay||pieDefaultColors;return pieColors[index%pieColors.length]}function generateDefaultColors(colorList){var i,pieColors=colorList.slice();for(i=0;i<colorList.length;i++)pieColors.push(_$tinycolor_352(colorList[i]).lighten(20).toHexString());for(i=0;i<colorList.length;i++)pieColors.push(_$tinycolor_352(colorList[i]).darken(20).toHexString());return pieColors}var __handleDomainDefaults_840=_$domain_610.defaults,_$layout_attributes_844={hiddenlabels:{valType:"data_array",editType:"calc"}},appendArrayMultiPointValues=_$helpers_450.appendArrayMultiPointValues,_$eventData_841=function eventData(pt,trace){var out={curveNumber:trace.index,pointNumbers:pt.pts,data:trace._input,fullData:trace,label:pt.label,color:pt.color,value:pt.v,v:pt.v};return 1===pt.pts.length&&(out.pointNumber=out.i=pt.pts[0]),appendArrayMultiPointValues(out,trace,pt.pts),out};function getInscribedRadiusFraction(pt,cd0){if(pt.v===cd0.vTotal&&!cd0.trace.hole)return 1;var halfAngle=Math.PI*Math.min(pt.v/cd0.vTotal,.5);return Math.min(1/(1+1/Math.sin(halfAngle)),(1-cd0.trace.hole)/2)}function transformOutsideText(textBB,pt){var x=pt.pxmid[0],y=pt.pxmid[1],dx=textBB.width/2,dy=textBB.height/2;return x<0&&(dx*=-1),y<0&&(dy*=-1),{scale:1,rCenter:1,rotate:0,x:dx+Math.abs(dy)*(dx>0?1:-1)/2,y:dy/(1+x*x/(y*y)),outside:!0}}var Pie={};Pie.attributes=_$attributes_837,Pie.supplyDefaults=function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_837,attr,dflt)}var coerceFont=_$lib_539.coerceFont,vals=coerce("values"),labels=coerce("labels");if(!Array.isArray(labels)){if(!_$lib_539.isArrayOrTypedArray(vals)||!vals.length)return void(traceOut.visible=!1);coerce("label0"),coerce("dlabel")}coerce("marker.line.width")&&coerce("marker.line.color"),coerce("marker.colors"),coerce("scalegroup");var textData=coerce("text"),textInfo=coerce("textinfo",Array.isArray(textData)?"text+percent":"percent");if(coerce("hovertext"),textInfo&&"none"!==textInfo){var textPosition=coerce("textposition"),hasBoth=Array.isArray(textPosition)||"auto"===textPosition,hasInside=hasBoth||"inside"===textPosition,hasOutside=hasBoth||"outside"===textPosition;if(hasInside||hasOutside){var dfltFont=coerceFont(coerce,"textfont",layout.font);hasInside&&coerceFont(coerce,"insidetextfont",dfltFont),hasOutside&&coerceFont(coerce,"outsidetextfont",dfltFont)}}__handleDomainDefaults_840(traceOut,layout,coerce),coerce("hole"),coerce("sort"),coerce("direction"),coerce("rotation"),coerce("pull")},Pie.supplyLayoutDefaults=function supplyLayoutDefaults(layoutIn,layoutOut){!function coerce(attr,dflt){return _$lib_539.coerce(layoutIn,layoutOut,_$layout_attributes_844,attr,dflt)}("hiddenlabels")},Pie.layoutAttributes=_$layout_attributes_844,Pie.calc=function calc(gd,trace){var i,v,label,hidden,pt,vals=trace.values,hasVals=__isArrayOrTypedArray_839(vals)&&vals.length,labels=trace.labels,colors=trace.marker.colors||[],cd=[],fullLayout=gd._fullLayout,colorWay=fullLayout.colorway,colorMap=fullLayout._piecolormap,allThisTraceLabels={},vTotal=0,hiddenLabels=fullLayout.hiddenlabels||[];if(fullLayout._piecolorway||colorWay===_$color_411.defaults||(fullLayout._piecolorway=generateDefaultColors(colorWay)),trace.dlabel)for(labels=new Array(vals.length),i=0;i<vals.length;i++)labels[i]=String(trace.label0+i*trace.dlabel);function pullColor(color,label){return!!color&&!!(color=_$tinycolor_352(color)).isValid()&&(color=_$color_411.addOpacity(color,color.getAlpha()),colorMap[label]||(colorMap[label]=color),color)}var seriesLen=(hasVals?vals:labels).length;for(i=0;i<seriesLen;i++){if(hasVals){if(v=vals[i],!_$fastIsnumeric_139(v))continue;if((v=+v)<0)continue}else v=1;void 0!==(label=labels[i])&&""!==label||(label=i);var thisLabelIndex=allThisTraceLabels[label=String(label)];void 0===thisLabelIndex?(allThisTraceLabels[label]=cd.length,(hidden=-1!==hiddenLabels.indexOf(label))||(vTotal+=v),cd.push({v:v,label:label,color:pullColor(colors[i]),i:i,pts:[i],hidden:hidden})):((pt=cd[thisLabelIndex]).v+=v,pt.pts.push(i),pt.hidden||(vTotal+=v),!1===pt.color&&colors[i]&&(pt.color=pullColor(colors[i],label)))}for(trace.sort&&cd.sort(function(a,b){return b.v-a.v}),i=0;i<cd.length;i++)!1===(pt=cd[i]).color&&(colorMap[pt.label]?pt.color=colorMap[pt.label]:(colorMap[pt.label]=pt.color=nextDefaultColor(fullLayout._piedefaultcolorcount,fullLayout._piecolorway),fullLayout._piedefaultcolorcount++));if(cd[0]&&(cd[0].vTotal=vTotal),trace.textinfo&&"none"!==trace.textinfo){var thisText,hasLabel=-1!==trace.textinfo.indexOf("label"),hasText=-1!==trace.textinfo.indexOf("text"),hasValue=-1!==trace.textinfo.indexOf("value"),hasPercent=-1!==trace.textinfo.indexOf("percent"),separators=fullLayout.separators;for(i=0;i<cd.length;i++){if(pt=cd[i],thisText=hasLabel?[pt.label]:[],hasText){var texti=_$helpers_842.getFirstFilled(trace.text,pt.pts);texti&&thisText.push(texti)}hasValue&&thisText.push(_$helpers_842.formatPieValue(pt.v,separators)),hasPercent&&thisText.push(_$helpers_842.formatPiePercent(pt.v/vTotal,separators)),pt.text=thisText.join("<br>")}}return cd},Pie.plot=function plot(gd,cdpie){var fullLayout=gd._fullLayout;!function scalePies(cdpie,plotSize){var pieBoxWidth,pieBoxHeight,i,j,cd0,trace,maxPull,scaleGroup,minPxPerValUnit,scaleGroups=[];for(i=0;i<cdpie.length;i++){if(cd0=cdpie[i][0],trace=cd0.trace,pieBoxWidth=plotSize.w*(trace.domain.x[1]-trace.domain.x[0]),pieBoxHeight=plotSize.h*(trace.domain.y[1]-trace.domain.y[0]),maxPull=trace.pull,Array.isArray(maxPull))for(maxPull=0,j=0;j<trace.pull.length;j++)trace.pull[j]>maxPull&&(maxPull=trace.pull[j]);cd0.r=Math.min(pieBoxWidth,pieBoxHeight)/(2+2*maxPull),cd0.cx=plotSize.l+plotSize.w*(trace.domain.x[1]+trace.domain.x[0])/2,cd0.cy=plotSize.t+plotSize.h*(2-trace.domain.y[1]-trace.domain.y[0])/2,trace.scalegroup&&-1===scaleGroups.indexOf(trace.scalegroup)&&scaleGroups.push(trace.scalegroup)}for(j=0;j<scaleGroups.length;j++){for(minPxPerValUnit=1/0,scaleGroup=scaleGroups[j],i=0;i<cdpie.length;i++)(cd0=cdpie[i][0]).trace.scalegroup===scaleGroup&&(minPxPerValUnit=Math.min(minPxPerValUnit,cd0.r*cd0.r/cd0.vTotal));for(i=0;i<cdpie.length;i++)(cd0=cdpie[i][0]).trace.scalegroup===scaleGroup&&(cd0.r=Math.sqrt(minPxPerValUnit*cd0.vTotal))}}(cdpie,fullLayout._size);var pieGroups=fullLayout._pielayer.selectAll("g.trace").data(cdpie);pieGroups.enter().append("g").attr({"stroke-linejoin":"round",class:"trace"}),pieGroups.exit().remove(),pieGroups.order(),pieGroups.each(function(cd){var pieGroup=_$d3_127.select(this),cd0=cd[0],trace=cd0.trace;!function setCoords(cd){var i,cdi,currentCoords,cd0=cd[0],trace=cd0.trace,currentAngle=trace.rotation*Math.PI/180,angleFactor=2*Math.PI/cd0.vTotal,firstPt="px0",lastPt="px1";if("counterclockwise"===trace.direction){for(i=0;i<cd.length&&cd[i].hidden;i++);if(i===cd.length)return;currentAngle+=angleFactor*cd[i].v,angleFactor*=-1,firstPt="px1",lastPt="px0"}function getCoords(angle){return[cd0.r*Math.sin(angle),-cd0.r*Math.cos(angle)]}for(currentCoords=getCoords(currentAngle),i=0;i<cd.length;i++)(cdi=cd[i]).hidden||(cdi[firstPt]=currentCoords,currentAngle+=angleFactor*cdi.v/2,cdi.pxmid=getCoords(currentAngle),cdi.midangle=currentAngle,currentAngle+=angleFactor*cdi.v/2,currentCoords=getCoords(currentAngle),cdi[lastPt]=currentCoords,cdi.largeArc=cdi.v>cd0.vTotal/2?1:0)}(cd),pieGroup.each(function(){var slices=_$d3_127.select(this).selectAll("g.slice").data(cd);slices.enter().append("g").classed("slice",!0),slices.exit().remove();var quadrants=[[[],[]],[[],[]]],hasOutsideText=!1;slices.each(function(pt){if(pt.hidden)_$d3_127.select(this).selectAll("path,g").remove();else{pt.pointNumber=pt.i,pt.curveNumber=trace.index,quadrants[pt.pxmid[1]<0?0:1][pt.pxmid[0]<0?0:1].push(pt);var cx=cd0.cx,cy=cd0.cy,sliceTop=_$d3_127.select(this),slicePath=sliceTop.selectAll("path.surface").data([pt]),hasHoverLabel=!1,hasHoverEvent=!1;if(slicePath.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),sliceTop.select("path.textline").remove(),sliceTop.on("mouseover",function handleMouseOver(){var fullLayout2=gd._fullLayout,trace2=gd._fullData[trace.index];if(!gd._dragging&&!1!==fullLayout2.hovermode){var hoverinfo=trace2.hoverinfo;if(Array.isArray(hoverinfo)&&(hoverinfo=_$fx_453.castHoverinfo({hoverinfo:[_$helpers_842.castOption(hoverinfo,pt.pts)],_module:trace._module},fullLayout2,0)),"all"===hoverinfo&&(hoverinfo="label+text+value+percent+name"),"none"!==hoverinfo&&"skip"!==hoverinfo&&hoverinfo){var rInscribed=getInscribedRadiusFraction(pt,cd0),hoverCenterX=cx+pt.pxmid[0]*(1-rInscribed),hoverCenterY=cy+pt.pxmid[1]*(1-rInscribed),separators=fullLayout.separators,thisText=[];if(-1!==hoverinfo.indexOf("label")&&thisText.push(pt.label),-1!==hoverinfo.indexOf("text")){var texti=_$helpers_842.castOption(trace2.hovertext||trace2.text,pt.pts);texti&&thisText.push(texti)}-1!==hoverinfo.indexOf("value")&&thisText.push(_$helpers_842.formatPieValue(pt.v,separators)),-1!==hoverinfo.indexOf("percent")&&thisText.push(_$helpers_842.formatPiePercent(pt.v/cd0.vTotal,separators));var hoverLabel=trace.hoverlabel,hoverFont=hoverLabel.font;_$fx_453.loneHover({x0:hoverCenterX-rInscribed*cd0.r,x1:hoverCenterX+rInscribed*cd0.r,y:hoverCenterY,text:thisText.join("<br>"),name:-1!==hoverinfo.indexOf("name")?trace2.name:void 0,idealAlign:pt.pxmid[0]<0?"left":"right",color:_$helpers_842.castOption(hoverLabel.bgcolor,pt.pts)||pt.color,borderColor:_$helpers_842.castOption(hoverLabel.bordercolor,pt.pts),fontFamily:_$helpers_842.castOption(hoverFont.family,pt.pts),fontSize:_$helpers_842.castOption(hoverFont.size,pt.pts),fontColor:_$helpers_842.castOption(hoverFont.color,pt.pts)},{container:fullLayout2._hoverlayer.node(),outerContainer:fullLayout2._paper.node(),gd:gd}),hasHoverLabel=!0}gd.emit("plotly_hover",{points:[_$eventData_841(pt,trace2)],event:_$d3_127.event}),hasHoverEvent=!0}}).on("mouseout",function handleMouseOut(evt){var fullLayout2=gd._fullLayout,trace2=gd._fullData[trace.index];hasHoverEvent&&(evt.originalEvent=_$d3_127.event,gd.emit("plotly_unhover",{points:[_$eventData_841(pt,trace2)],event:_$d3_127.event}),hasHoverEvent=!1),hasHoverLabel&&(_$fx_453.loneUnhover(fullLayout2._hoverlayer.node()),hasHoverLabel=!1)}).on("click",function handleClick(){var fullLayout2=gd._fullLayout,trace2=gd._fullData[trace.index];gd._dragging||!1===fullLayout2.hovermode||(gd._hoverdata=[_$eventData_841(pt,trace2)],_$fx_453.click(gd,_$d3_127.event))}),trace.pull){var pull=+_$helpers_842.castOption(trace.pull,pt.pts)||0;pull>0&&(cx+=pull*pt.pxmid[0],cy+=pull*pt.pxmid[1])}pt.cxFinal=cx,pt.cyFinal=cy;var hole=trace.hole;if(pt.v===cd0.vTotal){var outerCircle="M"+(cx+pt.px0[0])+","+(cy+pt.px0[1])+arc(pt.px0,pt.pxmid,!0,1)+arc(pt.pxmid,pt.px0,!0,1)+"Z";hole?slicePath.attr("d","M"+(cx+hole*pt.px0[0])+","+(cy+hole*pt.px0[1])+arc(pt.px0,pt.pxmid,!1,hole)+arc(pt.pxmid,pt.px0,!1,hole)+"Z"+outerCircle):slicePath.attr("d",outerCircle)}else{var outerArc=arc(pt.px0,pt.px1,!0,1);if(hole){var rim=1-hole;slicePath.attr("d","M"+(cx+hole*pt.px1[0])+","+(cy+hole*pt.px1[1])+arc(pt.px1,pt.px0,!1,hole)+"l"+rim*pt.px0[0]+","+rim*pt.px0[1]+outerArc+"Z")}else slicePath.attr("d","M"+cx+","+cy+"l"+pt.px0[0]+","+pt.px0[1]+outerArc+"Z")}var textPosition=_$helpers_842.castOption(trace.textposition,pt.pts),sliceTextGroup=sliceTop.selectAll("g.slicetext").data(pt.text&&"none"!==textPosition?[0]:[]);sliceTextGroup.enter().append("g").classed("slicetext",!0),sliceTextGroup.exit().remove(),sliceTextGroup.each(function(){var sliceText=_$d3_127.select(this).selectAll("text").data([0]);sliceText.enter().append("text").attr("data-notex",1),sliceText.exit().remove(),sliceText.text(pt.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(_$drawing_436.font,"outside"===textPosition?trace.outsidetextfont:trace.insidetextfont).call(_$svg_text_utils_562.convertToTspans,gd);var transform,textBB=_$drawing_436.bBox(sliceText.node());"outside"===textPosition?transform=transformOutsideText(textBB,pt):(transform=function transformInsideText(textBB,pt,cd0){var textDiameter=Math.sqrt(textBB.width*textBB.width+textBB.height*textBB.height),textAspect=textBB.width/textBB.height,halfAngle=Math.PI*Math.min(pt.v/cd0.vTotal,.5),ring=1-cd0.trace.hole,rInscribed=getInscribedRadiusFraction(pt,cd0),transform={scale:rInscribed*cd0.r*2/textDiameter,rCenter:1-rInscribed,rotate:0};if(transform.scale>=1)return transform;var Qr=textAspect+1/(2*Math.tan(halfAngle)),maxHalfHeightRotRadial=cd0.r*Math.min(1/(Math.sqrt(Qr*Qr+.5)+Qr),ring/(Math.sqrt(textAspect*textAspect+ring/2)+textAspect)),radialTransform={scale:2*maxHalfHeightRotRadial/textBB.height,rCenter:Math.cos(maxHalfHeightRotRadial/cd0.r)-maxHalfHeightRotRadial*textAspect/cd0.r,rotate:(180/Math.PI*pt.midangle+720)%180-90},aspectInv=1/textAspect,Qt=aspectInv+1/(2*Math.tan(halfAngle)),maxHalfWidthTangential=cd0.r*Math.min(1/(Math.sqrt(Qt*Qt+.5)+Qt),ring/(Math.sqrt(aspectInv*aspectInv+ring/2)+aspectInv)),tangentialTransform={scale:2*maxHalfWidthTangential/textBB.width,rCenter:Math.cos(maxHalfWidthTangential/cd0.r)-maxHalfWidthTangential/textAspect/cd0.r,rotate:(180/Math.PI*pt.midangle+810)%180-90},rotatedTransform=tangentialTransform.scale>radialTransform.scale?tangentialTransform:radialTransform;return transform.scale<1&&rotatedTransform.scale>transform.scale?rotatedTransform:transform}(textBB,pt,cd0),"auto"===textPosition&&transform.scale<1&&(sliceText.call(_$drawing_436.font,trace.outsidetextfont),trace.outsidetextfont.family===trace.insidetextfont.family&&trace.outsidetextfont.size===trace.insidetextfont.size||(textBB=_$drawing_436.bBox(sliceText.node())),transform=transformOutsideText(textBB,pt)));var translateX=cx+pt.pxmid[0]*transform.rCenter+(transform.x||0),translateY=cy+pt.pxmid[1]*transform.rCenter+(transform.y||0);transform.outside&&(pt.yLabelMin=translateY-textBB.height/2,pt.yLabelMid=translateY,pt.yLabelMax=translateY+textBB.height/2,pt.labelExtraX=0,pt.labelExtraY=0,hasOutsideText=!0),sliceText.attr("transform","translate("+translateX+","+translateY+")"+(transform.scale<1?"scale("+transform.scale+")":"")+(transform.rotate?"rotate("+transform.rotate+")":"")+"translate("+-(textBB.left+textBB.right)/2+","+-(textBB.top+textBB.bottom)/2+")")})}function arc(start,finish,cw,scale){return"a"+scale*cd0.r+","+scale*cd0.r+" 0 "+pt.largeArc+(cw?" 1 ":" 0 ")+scale*(finish[0]-start[0])+","+scale*(finish[1]-start[1])}}),hasOutsideText&&function scootLabels(quadrants,trace){var xHalf,yHalf,equatorFirst,farthestX,farthestY,xDiffSign,yDiffSign,thisQuad,oppositeQuad,wholeSide,i,thisQuadOutside,firstOppositeOutsidePt;function topFirst(a,b){return a.pxmid[1]-b.pxmid[1]}function bottomFirst(a,b){return b.pxmid[1]-a.pxmid[1]}function scootOneLabel(thisPt,prevPt){prevPt||(prevPt={});var xBuffer,i,otherPt,otherOuterY,otherOuterX,newExtraX,prevOuterY=prevPt.labelExtraY+(yHalf?prevPt.yLabelMax:prevPt.yLabelMin),thisInnerY=yHalf?thisPt.yLabelMin:thisPt.yLabelMax,thisOuterY=yHalf?thisPt.yLabelMax:thisPt.yLabelMin,thisSliceOuterY=thisPt.cyFinal+farthestY(thisPt.px0[1],thisPt.px1[1]),newExtraY=prevOuterY-thisInnerY;if(newExtraY*yDiffSign>0&&(thisPt.labelExtraY=newExtraY),Array.isArray(trace.pull))for(i=0;i<wholeSide.length;i++)(otherPt=wholeSide[i])===thisPt||(_$helpers_842.castOption(trace.pull,thisPt.pts)||0)>=(_$helpers_842.castOption(trace.pull,otherPt.pts)||0)||((thisPt.pxmid[1]-otherPt.pxmid[1])*yDiffSign>0?(otherOuterY=otherPt.cyFinal+farthestY(otherPt.px0[1],otherPt.px1[1]),(newExtraY=otherOuterY-thisInnerY-thisPt.labelExtraY)*yDiffSign>0&&(thisPt.labelExtraY+=newExtraY)):(thisOuterY+thisPt.labelExtraY-thisSliceOuterY)*yDiffSign>0&&(xBuffer=3*xDiffSign*Math.abs(i-wholeSide.indexOf(thisPt)),otherOuterX=otherPt.cxFinal+farthestX(otherPt.px0[0],otherPt.px1[0]),(newExtraX=otherOuterX+xBuffer-(thisPt.cxFinal+thisPt.pxmid[0])-thisPt.labelExtraX)*xDiffSign>0&&(thisPt.labelExtraX+=newExtraX)))}for(yHalf=0;yHalf<2;yHalf++)for(equatorFirst=yHalf?topFirst:bottomFirst,farthestY=yHalf?Math.max:Math.min,yDiffSign=yHalf?1:-1,xHalf=0;xHalf<2;xHalf++){for(farthestX=xHalf?Math.max:Math.min,xDiffSign=xHalf?1:-1,(thisQuad=quadrants[yHalf][xHalf]).sort(equatorFirst),oppositeQuad=quadrants[1-yHalf][xHalf],wholeSide=oppositeQuad.concat(thisQuad),thisQuadOutside=[],i=0;i<thisQuad.length;i++)void 0!==thisQuad[i].yLabelMid&&thisQuadOutside.push(thisQuad[i]);for(firstOppositeOutsidePt=!1,i=0;yHalf&&i<oppositeQuad.length;i++)if(void 0!==oppositeQuad[i].yLabelMid){firstOppositeOutsidePt=oppositeQuad[i];break}for(i=0;i<thisQuadOutside.length;i++){var prevPt=i&&thisQuadOutside[i-1];firstOppositeOutsidePt&&!i&&(prevPt=firstOppositeOutsidePt),scootOneLabel(thisQuadOutside[i],prevPt)}}}(quadrants,trace),slices.each(function(pt){if(pt.labelExtraX||pt.labelExtraY){var sliceTop=_$d3_127.select(this),sliceText=sliceTop.select("g.slicetext text");sliceText.attr("transform","translate("+pt.labelExtraX+","+pt.labelExtraY+")"+sliceText.attr("transform"));var lineStartX=pt.cxFinal+pt.pxmid[0],textLinePath="M"+lineStartX+","+(pt.cyFinal+pt.pxmid[1]),finalX=(pt.yLabelMax-pt.yLabelMin)*(pt.pxmid[0]<0?-1:1)/4;if(pt.labelExtraX){var yFromX=pt.labelExtraX*pt.pxmid[1]/pt.pxmid[0],yNet=pt.yLabelMid+pt.labelExtraY-(pt.cyFinal+pt.pxmid[1]);Math.abs(yFromX)>Math.abs(yNet)?textLinePath+="l"+yNet*pt.pxmid[0]/pt.pxmid[1]+","+yNet+"H"+(lineStartX+pt.labelExtraX+finalX):textLinePath+="l"+pt.labelExtraX+","+yFromX+"v"+(yNet-yFromX)+"h"+finalX}else textLinePath+="V"+(pt.yLabelMid+pt.labelExtraY)+"h"+finalX;sliceTop.append("path").classed("textline",!0).call(_$color_411.stroke,trace.outsidetextfont.color).attr({"stroke-width":Math.min(2,trace.outsidetextfont.size/8),d:textLinePath,fill:"none"})}})})}),setTimeout(function(){pieGroups.selectAll("tspan").each(function(){var s=_$d3_127.select(this);s.attr("dy")&&s.attr("dy",s.attr("dy"))})},0)},Pie.style=function style(gd){gd._fullLayout._pielayer.selectAll(".trace").each(function(cd){var trace=cd[0].trace,traceSelection=_$d3_127.select(this);traceSelection.style({opacity:trace.opacity}),traceSelection.selectAll("path.surface").each(function(pt){_$d3_127.select(this).call(_$styleOne_848,pt,trace)})})},Pie.styleOne=_$styleOne_848,Pie.moduleType="trace",Pie.name="pie",Pie.basePlotModule=_$base_plot_838,Pie.categories=["pie","showLegend"],Pie.meta={};var _$pie_24=Pie,_$attributes_849={x:_$attributes_862.x,y:_$attributes_862.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:_$attributes_862.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"}},_$shader_197={};_$shader_197.pointVertex=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform float pointCloud;\n\nhighp float rand(vec2 co) {\n  highp float a = 12.9898;\n  highp float b = 78.233;\n  highp float c = 43758.5453;\n  highp float d = dot(co.xy, vec2(a, b));\n  highp float e = mod(d, 3.14);\n  return fract(sin(e) * c);\n}\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n    // if we don't jitter the point size a bit, overall point cloud\n    // saturation 'jumps' on zooming, which is disturbing and confusing\n  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    // get the same square surface as circle would be\n    gl_PointSize *= 0.886;\n  }\n}"]),_$shader_197.pointFragment=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color, borderColor;\nuniform float centerFraction;\nuniform float pointCloud;\n\nvoid main() {\n  float radius;\n  vec4 baseColor;\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    if(centerFraction == 1.0) {\n      gl_FragColor = color;\n    } else {\n      gl_FragColor = mix(borderColor, color, centerFraction);\n    }\n  } else {\n    radius = length(2.0 * gl_PointCoord.xy - 1.0);\n    if(radius > 1.0) {\n      discard;\n    }\n    baseColor = mix(borderColor, color, step(radius, centerFraction));\n    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);\n  }\n}\n"]),_$shader_197.pickVertex=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform vec4 pickOffset;\n\nvarying vec4 fragId;\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n  gl_PointSize = pointSize;\n\n  vec4 id = pickId + pickOffset;\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  fragId = id;\n}\n"]),_$shader_197.pickFragment=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\n\nvoid main() {\n  float radius = length(2.0 * gl_PointCoord.xy - 1.0);\n  if(radius > 1.0) {\n    discard;\n  }\n  gl_FragColor = fragId / 255.0;\n}\n"]);var _$createPointcloud2D_198=function createPointcloud2D(plot,options){var gl=plot.gl,buffer=_$createBuffer_153(gl),pickBuffer=_$createBuffer_153(gl),shader=_$createShader_206(gl,_$shader_197.pointVertex,_$shader_197.pointFragment),pickShader=_$createShader_206(gl,_$shader_197.pickVertex,_$shader_197.pickFragment),result=new Pointcloud2D(plot,buffer,pickBuffer,shader,pickShader);return result.update(options),plot.addObject(result),result};function Pointcloud2D(plot,offsetBuffer,pickBuffer,shader,pickShader){this.plot=plot,this.offsetBuffer=offsetBuffer,this.pickBuffer=pickBuffer,this.shader=shader,this.pickShader=pickShader,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}var __proto_198=Pointcloud2D.prototype;__proto_198.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},__proto_198.update=function(options){var i;function dflt(opt,value){return opt in options?options[opt]:value}options=options||{},this.sizeMin=dflt("sizeMin",.5),this.sizeMax=dflt("sizeMax",20),this.color=dflt("color",[1,0,0,1]).slice(),this.areaRatio=dflt("areaRatio",1),this.borderColor=dflt("borderColor",[0,0,0,1]).slice(),this.blend=dflt("blend",!1);var pointCount=options.positions.length>>>1,dataStraightThrough=options.positions instanceof Float32Array,idStraightThrough=options.idToIndex instanceof Int32Array&&options.idToIndex.length>=pointCount,data=options.positions,packed=dataStraightThrough?data:_$pool_360.mallocFloat32(data.length),packedId=idStraightThrough?options.idToIndex:_$pool_360.mallocInt32(pointCount);if(dataStraightThrough||packed.set(data),!idStraightThrough)for(packed.set(data),i=0;i<pointCount;i++)packedId[i]=i;this.points=data,this.offsetBuffer.update(packed),this.pickBuffer.update(packedId),dataStraightThrough||_$pool_360.free(packed),idStraightThrough||_$pool_360.free(packedId),this.pointCount=pointCount,this.pickOffset=0},__proto_198.unifiedDraw=function(){var MATRIX=[1,0,0,0,1,0,0,0,1],PICK_VEC4=[0,0,0,0];return function(pickOffset){var pick=void 0!==pickOffset,shader=pick?this.pickShader:this.shader,gl=this.plot.gl,dataBox=this.plot.dataBox;if(0===this.pointCount)return pickOffset;var dataX=dataBox[2]-dataBox[0],dataY=dataBox[3]-dataBox[1],visiblePointCountEstimate=function __count_198(points,dataBox){var i,visiblePointCountEstimate=0,length=points.length>>>1;for(i=0;i<length;i++){var x=points[2*i],y=points[2*i+1];x>=dataBox[0]&&x<=dataBox[2]&&y>=dataBox[1]&&y<=dataBox[3]&&visiblePointCountEstimate++}return visiblePointCountEstimate}(this.points,dataBox),basicPointSize=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(visiblePointCountEstimate,.33333)));MATRIX[0]=2/dataX,MATRIX[4]=2/dataY,MATRIX[6]=-2*dataBox[0]/dataX-1,MATRIX[7]=-2*dataBox[1]/dataY-1,this.offsetBuffer.bind(),shader.bind(),shader.attributes.position.pointer(),shader.uniforms.matrix=MATRIX,shader.uniforms.color=this.color,shader.uniforms.borderColor=this.borderColor,shader.uniforms.pointCloud=basicPointSize<5,shader.uniforms.pointSize=basicPointSize,shader.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),pick&&(PICK_VEC4[0]=255&pickOffset,PICK_VEC4[1]=pickOffset>>8&255,PICK_VEC4[2]=pickOffset>>16&255,PICK_VEC4[3]=pickOffset>>24&255,this.pickBuffer.bind(),shader.attributes.pickId.pointer(gl.UNSIGNED_BYTE),shader.uniforms.pickOffset=PICK_VEC4,this.pickOffset=pickOffset);var blend=gl.getParameter(gl.BLEND),dither=gl.getParameter(gl.DITHER);return blend&&!this.blend&&gl.disable(gl.BLEND),dither&&gl.disable(gl.DITHER),gl.drawArrays(gl.POINTS,0,this.pointCount),blend&&!this.blend&&gl.enable(gl.BLEND),dither&&gl.enable(gl.DITHER),pickOffset+this.pointCount}}(),__proto_198.draw=__proto_198.unifiedDraw,__proto_198.drawPick=__proto_198.unifiedDraw,__proto_198.pick=function(x,y,value){var pickOffset=this.pickOffset,pointCount=this.pointCount;if(value<pickOffset||value>=pickOffset+pointCount)return null;var pointId=value-pickOffset,points=this.points;return{object:this,pointId:pointId,dataCoord:[points[2*pointId],points[2*pointId+1]]}};var expandAxis=_$autorange___expand;function Pointcloud(scene,uid){this.scene=scene,this.uid=uid,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=_$createPointcloud2D_198(scene.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var __proto_850=Pointcloud.prototype;__proto_850.handlePick=function(pickResult){var index=this.idToIndex[pickResult.pointId];return{trace:this,dataCoord:pickResult.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[2*index],this.pickXYData[2*index+1]]:[this.pickXData[index],this.pickYData[index]],textLabel:Array.isArray(this.textLabels)?this.textLabels[index]:this.textLabels,color:this.color,name:this.name,pointIndex:index,hoverinfo:this.hoverinfo}},__proto_850.update=function(options){this.index=options.index,this.textLabels=options.text,this.name=options.name,this.hoverinfo=options.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(options),this.color=_$getTraceColor_872(options,{})},__proto_850.updateFast=function(options){var len,idToIndex,positions,xx,yy,i,x=this.xData=this.pickXData=options.x,y=this.yData=this.pickYData=options.y,xy=this.pickXYData=options.xy,userBounds=options.xbounds&&options.ybounds,index=options.indices,bounds=this.bounds;if(xy){if(positions=xy,len=xy.length>>>1,userBounds)bounds[0]=options.xbounds[0],bounds[2]=options.xbounds[1],bounds[1]=options.ybounds[0],bounds[3]=options.ybounds[1];else for(i=0;i<len;i++)xx=positions[2*i],yy=positions[2*i+1],xx<bounds[0]&&(bounds[0]=xx),xx>bounds[2]&&(bounds[2]=xx),yy<bounds[1]&&(bounds[1]=yy),yy>bounds[3]&&(bounds[3]=yy);if(index)idToIndex=index;else for(idToIndex=new Int32Array(len),i=0;i<len;i++)idToIndex[i]=i}else for(len=x.length,positions=new Float32Array(2*len),idToIndex=new Int32Array(len),i=0;i<len;i++)xx=x[i],yy=y[i],idToIndex[i]=i,positions[2*i]=xx,positions[2*i+1]=yy,xx<bounds[0]&&(bounds[0]=xx),xx>bounds[2]&&(bounds[2]=xx),yy<bounds[1]&&(bounds[1]=yy),yy>bounds[3]&&(bounds[3]=yy);this.idToIndex=idToIndex,this.pointcloudOptions.idToIndex=idToIndex,this.pointcloudOptions.positions=positions;var markerColor=_$str2RgbaArray_561(options.marker.color),borderColor=_$str2RgbaArray_561(options.marker.border.color),opacity=options.opacity*options.marker.opacity;markerColor[3]*=opacity,this.pointcloudOptions.color=markerColor;var blend=options.marker.blend;if(null===blend){blend=x.length<100||y.length<100}this.pointcloudOptions.blend=blend,borderColor[3]*=opacity,this.pointcloudOptions.borderColor=borderColor;var markerSizeMin=options.marker.sizemin,markerSizeMax=Math.max(options.marker.sizemax,options.marker.sizemin);this.pointcloudOptions.sizeMin=markerSizeMin,this.pointcloudOptions.sizeMax=markerSizeMax,this.pointcloudOptions.areaRatio=options.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions),this.expandAxesFast(bounds,markerSizeMax/2)},__proto_850.expandAxesFast=function(bounds,markerSize){var pad=markerSize||.5;expandAxis(this.scene.xaxis,[bounds[0],bounds[2]],{ppad:pad}),expandAxis(this.scene.yaxis,[bounds[1],bounds[3]],{ppad:pad})},__proto_850.dispose=function(){this.pointcloud.dispose()};var _$createPointcloud_850=function createPointcloud(scene,data){var plot=new Pointcloud(scene,data.uid);return plot.update(data),plot},_$calc_888=function calc(gd,trace){var cd=[{x:!1,y:!1,trace:trace,t:{}}];return _$arraysToCalcdata_861(cd,trace),_$calcMarkerColorscale_867(trace),cd},pointcloud={};pointcloud.attributes=_$attributes_849,pointcloud.supplyDefaults=function supplyDefaults(traceIn,traceOut,defaultColor){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_849,attr,dflt)}coerce("x"),coerce("y"),coerce("xbounds"),coerce("ybounds"),traceIn.xy&&traceIn.xy instanceof Float32Array&&(traceOut.xy=traceIn.xy),traceIn.indices&&traceIn.indices instanceof Int32Array&&(traceOut.indices=traceIn.indices),coerce("text"),coerce("marker.color",defaultColor),coerce("marker.opacity"),coerce("marker.blend"),coerce("marker.sizemin"),coerce("marker.sizemax"),coerce("marker.border.color",defaultColor),coerce("marker.border.arearatio")},pointcloud.calc=_$calc_888,pointcloud.plot=_$createPointcloud_850,pointcloud.moduleType="trace",pointcloud.name="pointcloud",pointcloud.basePlotModule=_$gl2d_624,pointcloud.categories=["gl","gl2d","showLegend"],pointcloud.meta={};var _$pointcloud_25=pointcloud,__domainAttrs_853=_$domain_610.attributes,__extendFlat_853=_$extend_528.extendFlat,_$attributes_853=(0,_$edit_types_569.overrideAll)({hoverinfo:__extendFlat_853({},_$attributes_581.hoverinfo,{flags:["label","text","value","percent","name"]}),hoverlabel:_$attributes_445.hoverlabel,domain:__domainAttrs_853({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s"},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:_$font_attributes_611({}),node:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},line:{color:{valType:"color",dflt:_$attributes_410.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20}},link:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},line:{color:{valType:"color",dflt:_$attributes_410.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]}}},"calc","nested"),_$constants_856={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"cubic-in-out",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeCapture:"node-capture",nodeCentered:"node-entered",nodeLabelGuide:"node-label-guide",nodeLabel:"node-label",nodeLabelTextPath:"node-label-text-path"}},_$d3Array_119={exports:{}};!function(global,factory){"object"==typeof _$d3Array_119.exports?factory(_$d3Array_119.exports):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";var ascending=function(a,b){return a<b?-1:a>b?1:a>=b?0:NaN},bisector=function(compare){return 1===compare.length&&(compare=function ascendingComparator(f){return function(d,x){return ascending(f(d),x)}}(compare)),{left:function(a,x,lo,hi){for(null==lo&&(lo=0),null==hi&&(hi=a.length);lo<hi;){var mid=lo+hi>>>1;compare(a[mid],x)<0?lo=mid+1:hi=mid}return lo},right:function(a,x,lo,hi){for(null==lo&&(lo=0),null==hi&&(hi=a.length);lo<hi;){var mid=lo+hi>>>1;compare(a[mid],x)>0?hi=mid:lo=mid+1}return lo}}};var ascendingBisect=bisector(ascending),bisectRight=ascendingBisect.right,bisectLeft=ascendingBisect.left;function pair(a,b){return[a,b]}var number=function(x){return null===x?NaN:+x},variance=function(values,valueof){var value,delta,n=values.length,m=0,i=-1,mean=0,sum=0;if(null==valueof)for(;++i<n;)isNaN(value=number(values[i]))||(sum+=(delta=value-mean)*(value-(mean+=delta/++m)));else for(;++i<n;)isNaN(value=number(valueof(values[i],i,values)))||(sum+=(delta=value-mean)*(value-(mean+=delta/++m)));if(m>1)return sum/(m-1)},deviation=function(array,f){var v=variance(array,f);return v?Math.sqrt(v):v},extent=function(values,valueof){var value,min,max,n=values.length,i=-1;if(null==valueof){for(;++i<n;)if(null!=(value=values[i])&&value>=value)for(min=max=value;++i<n;)null!=(value=values[i])&&(min>value&&(min=value),max<value&&(max=value))}else for(;++i<n;)if(null!=(value=valueof(values[i],i,values))&&value>=value)for(min=max=value;++i<n;)null!=(value=valueof(values[i],i,values))&&(min>value&&(min=value),max<value&&(max=value));return[min,max]},array=Array.prototype,slice=array.slice,map=array.map,constant=function(x){return function(){return x}},identity=function(x){return x},range=function(start,stop,step){start=+start,stop=+stop,step=(n=arguments.length)<2?(stop=start,start=0,1):n<3?1:+step;for(var i=-1,n=0|Math.max(0,Math.ceil((stop-start)/step)),range=new Array(n);++i<n;)range[i]=start+i*step;return range},e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2);function tickIncrement(start,stop,count){var step=(stop-start)/Math.max(0,count),power=Math.floor(Math.log(step)/Math.LN10),error=step/Math.pow(10,power);return power>=0?(error>=e10?10:error>=e5?5:error>=e2?2:1)*Math.pow(10,power):-Math.pow(10,-power)/(error>=e10?10:error>=e5?5:error>=e2?2:1)}function tickStep(start,stop,count){var step0=Math.abs(stop-start)/Math.max(0,count),step1=Math.pow(10,Math.floor(Math.log(step0)/Math.LN10)),error=step0/step1;return error>=e10?step1*=10:error>=e5?step1*=5:error>=e2&&(step1*=2),stop<start?-step1:step1}var sturges=function(values){return Math.ceil(Math.log(values.length)/Math.LN2)+1},quantile=function(values,p,valueof){if(null==valueof&&(valueof=number),n=values.length){if((p=+p)<=0||n<2)return+valueof(values[0],0,values);if(p>=1)return+valueof(values[n-1],n-1,values);var n,i=(n-1)*p,i0=Math.floor(i),value0=+valueof(values[i0],i0,values);return value0+(+valueof(values[i0+1],i0+1,values)-value0)*(i-i0)}},min=function(values,valueof){var value,min,n=values.length,i=-1;if(null==valueof){for(;++i<n;)if(null!=(value=values[i])&&value>=value)for(min=value;++i<n;)null!=(value=values[i])&&min>value&&(min=value)}else for(;++i<n;)if(null!=(value=valueof(values[i],i,values))&&value>=value)for(min=value;++i<n;)null!=(value=valueof(values[i],i,values))&&min>value&&(min=value);return min},transpose=function(matrix){if(!(n=matrix.length))return[];for(var i=-1,m=min(matrix,length),transpose=new Array(m);++i<m;)for(var n,j=-1,row=transpose[i]=new Array(n);++j<n;)row[j]=matrix[j][i];return transpose};function length(d){return d.length}exports.bisect=bisectRight,exports.bisectRight=bisectRight,exports.bisectLeft=bisectLeft,exports.ascending=ascending,exports.bisector=bisector,exports.cross=function(values0,values1,reduce){var i0,i1,i,value0,n0=values0.length,n1=values1.length,values=new Array(n0*n1);for(null==reduce&&(reduce=pair),i0=i=0;i0<n0;++i0)for(value0=values0[i0],i1=0;i1<n1;++i1,++i)values[i]=reduce(value0,values1[i1]);return values},exports.descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN},exports.deviation=deviation,exports.extent=extent,exports.histogram=function(){var value=identity,domain=extent,threshold=sturges;function histogram(data){var i,x,n=data.length,values=new Array(n);for(i=0;i<n;++i)values[i]=value(data[i],i,data);var xz=domain(values),x0=xz[0],x1=xz[1],tz=threshold(values,x0,x1);Array.isArray(tz)||(tz=tickStep(x0,x1,tz),tz=range(Math.ceil(x0/tz)*tz,Math.floor(x1/tz)*tz,tz));for(var m=tz.length;tz[0]<=x0;)tz.shift(),--m;for(;tz[m-1]>x1;)tz.pop(),--m;var bin,bins=new Array(m+1);for(i=0;i<=m;++i)(bin=bins[i]=[]).x0=i>0?tz[i-1]:x0,bin.x1=i<m?tz[i]:x1;for(i=0;i<n;++i)x0<=(x=values[i])&&x<=x1&&bins[bisectRight(tz,x,0,m)].push(data[i]);return bins}return histogram.value=function(_){return arguments.length?(value="function"==typeof _?_:constant(_),histogram):value},histogram.domain=function(_){return arguments.length?(domain="function"==typeof _?_:constant([_[0],_[1]]),histogram):domain},histogram.thresholds=function(_){return arguments.length?(threshold="function"==typeof _?_:Array.isArray(_)?constant(slice.call(_)):constant(_),histogram):threshold},histogram},exports.thresholdFreedmanDiaconis=function(values,min,max){return values=map.call(values,number).sort(ascending),Math.ceil((max-min)/(2*(quantile(values,.75)-quantile(values,.25))*Math.pow(values.length,-1/3)))},exports.thresholdScott=function(values,min,max){return Math.ceil((max-min)/(3.5*deviation(values)*Math.pow(values.length,-1/3)))},exports.thresholdSturges=sturges,exports.max=function(values,valueof){var value,max,n=values.length,i=-1;if(null==valueof){for(;++i<n;)if(null!=(value=values[i])&&value>=value)for(max=value;++i<n;)null!=(value=values[i])&&value>max&&(max=value)}else for(;++i<n;)if(null!=(value=valueof(values[i],i,values))&&value>=value)for(max=value;++i<n;)null!=(value=valueof(values[i],i,values))&&value>max&&(max=value);return max},exports.mean=function(values,valueof){var value,n=values.length,m=n,i=-1,sum=0;if(null==valueof)for(;++i<n;)isNaN(value=number(values[i]))?--m:sum+=value;else for(;++i<n;)isNaN(value=number(valueof(values[i],i,values)))?--m:sum+=value;if(m)return sum/m},exports.median=function(values,valueof){var value,n=values.length,i=-1,numbers=[];if(null==valueof)for(;++i<n;)isNaN(value=number(values[i]))||numbers.push(value);else for(;++i<n;)isNaN(value=number(valueof(values[i],i,values)))||numbers.push(value);return quantile(numbers.sort(ascending),.5)},exports.merge=function(arrays){for(var m,merged,array,n=arrays.length,i=-1,j=0;++i<n;)j+=arrays[i].length;for(merged=new Array(j);--n>=0;)for(m=(array=arrays[n]).length;--m>=0;)merged[--j]=array[m];return merged},exports.min=min,exports.pairs=function(array,f){null==f&&(f=pair);for(var i=0,n=array.length-1,p=array[0],pairs=new Array(n<0?0:n);i<n;)pairs[i]=f(p,p=array[++i]);return pairs},exports.permute=function(array,indexes){for(var i=indexes.length,permutes=new Array(i);i--;)permutes[i]=array[indexes[i]];return permutes},exports.quantile=quantile,exports.range=range,exports.scan=function(values,compare){if(n=values.length){var n,xi,i=0,j=0,xj=values[j];for(null==compare&&(compare=ascending);++i<n;)(compare(xi=values[i],xj)<0||0!==compare(xj,xj))&&(xj=xi,j=i);return 0===compare(xj,xj)?j:void 0}},exports.shuffle=function(array,i0,i1){for(var t,i,m=(null==i1?array.length:i1)-(i0=null==i0?0:+i0);m;)i=Math.random()*m--|0,t=array[m+i0],array[m+i0]=array[i+i0],array[i+i0]=t;return array},exports.sum=function(values,valueof){var value,n=values.length,i=-1,sum=0;if(null==valueof)for(;++i<n;)(value=+values[i])&&(sum+=value);else for(;++i<n;)(value=+valueof(values[i],i,values))&&(sum+=value);return sum},exports.ticks=function(start,stop,count){var reverse,n,ticks,step,i=-1;if(count=+count,(start=+start)==(stop=+stop)&&count>0)return[start];if((reverse=stop<start)&&(n=start,start=stop,stop=n),0===(step=tickIncrement(start,stop,count))||!isFinite(step))return[];if(step>0)for(start=Math.ceil(start/step),stop=Math.floor(stop/step),ticks=new Array(n=Math.ceil(stop-start+1));++i<n;)ticks[i]=(start+i)*step;else for(start=Math.floor(start*step),stop=Math.ceil(stop*step),ticks=new Array(n=Math.ceil(start-stop+1));++i<n;)ticks[i]=(start-i)/step;return reverse&&ticks.reverse(),ticks},exports.tickIncrement=tickIncrement,exports.tickStep=tickStep,exports.transpose=transpose,exports.variance=variance,exports.zip=function(){return transpose(arguments)},Object.defineProperty(exports,"__esModule",{value:!0})}),_$d3Array_119=_$d3Array_119.exports;var _$d3Collection_120={exports:{}};!function(global,factory){"object"==typeof _$d3Collection_120.exports?factory(_$d3Collection_120.exports):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function Map(){}function map(object,f){var map=new Map;if(object instanceof Map)object.each(function(value,key){map.set(key,value)});else if(Array.isArray(object)){var o,i=-1,n=object.length;if(null==f)for(;++i<n;)map.set(i,object[i]);else for(;++i<n;)map.set(f(o=object[i],i,object),o)}else if(object)for(var key in object)map.set(key,object[key]);return map}Map.prototype=map.prototype={constructor:Map,has:function(key){return"$"+key in this},get:function(key){return this["$"+key]},set:function(key,value){return this["$"+key]=value,this},remove:function(key){var property="$"+key;return property in this&&delete this[property]},clear:function(){for(var property in this)"$"===property[0]&&delete this[property]},keys:function(){var keys=[];for(var property in this)"$"===property[0]&&keys.push(property.slice(1));return keys},values:function(){var values=[];for(var property in this)"$"===property[0]&&values.push(this[property]);return values},entries:function(){var entries=[];for(var property in this)"$"===property[0]&&entries.push({key:property.slice(1),value:this[property]});return entries},size:function(){var size=0;for(var property in this)"$"===property[0]&&++size;return size},empty:function(){for(var property in this)if("$"===property[0])return!1;return!0},each:function(f){for(var property in this)"$"===property[0]&&f(this[property],property.slice(1),this)}};function createObject(){return{}}function setObject(object,key,value){object[key]=value}function createMap(){return map()}function setMap(map$$1,key,value){map$$1.set(key,value)}function Set(){}var proto=map.prototype;function set(object,f){var set=new Set;if(object instanceof Set)object.each(function(value){set.add(value)});else if(object){var i=-1,n=object.length;if(null==f)for(;++i<n;)set.add(object[i]);else for(;++i<n;)set.add(f(object[i],i,object))}return set}Set.prototype=set.prototype={constructor:Set,has:proto.has,add:function(value){return this["$"+(value+="")]=value,this},remove:proto.remove,clear:proto.clear,values:proto.keys,size:proto.size,empty:proto.empty,each:proto.each};exports.nest=function(){var sortValues,rollup,nest,keys=[],sortKeys=[];function apply(array,depth,createResult,setResult){if(depth>=keys.length)return null!=sortValues&&array.sort(sortValues),null!=rollup?rollup(array):array;for(var keyValue,value,values,i=-1,n=array.length,key=keys[depth++],valuesByKey=map(),result=createResult();++i<n;)(values=valuesByKey.get(keyValue=key(value=array[i])+""))?values.push(value):valuesByKey.set(keyValue,[value]);return valuesByKey.each(function(values,key){setResult(result,key,apply(values,depth,createResult,setResult))}),result}return nest={object:function(array){return apply(array,0,createObject,setObject)},map:function(array){return apply(array,0,createMap,setMap)},entries:function(array){return function entries(map$$1,depth){if(++depth>keys.length)return map$$1;var array,sortKey=sortKeys[depth-1];return null!=rollup&&depth>=keys.length?array=map$$1.entries():(array=[],map$$1.each(function(v,k){array.push({key:k,values:entries(v,depth)})})),null!=sortKey?array.sort(function(a,b){return sortKey(a.key,b.key)}):array}(apply(array,0,createMap,setMap),0)},key:function(d){return keys.push(d),nest},sortKeys:function(order){return sortKeys[keys.length-1]=order,nest},sortValues:function(order){return sortValues=order,nest},rollup:function(f){return rollup=f,nest}}},exports.set=set,exports.map=map,exports.keys=function(map){var keys=[];for(var key in map)keys.push(key);return keys},exports.values=function(map){var values=[];for(var key in map)values.push(map[key]);return values},exports.entries=function(map){var entries=[];for(var key in map)entries.push({key:key,value:map[key]});return entries},Object.defineProperty(exports,"__esModule",{value:!0})}),_$d3Collection_120=_$d3Collection_120.exports;var _$d3Color_121={exports:{}};!function(global,factory){"object"==typeof _$d3Color_121.exports?factory(_$d3Color_121.exports):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";var define=function(constructor,factory,prototype){constructor.prototype=factory.prototype=prototype,prototype.constructor=constructor};function extend(parent,definition){var prototype=Object.create(parent.prototype);for(var key in definition)prototype[key]=definition[key];return prototype}function Color(){}var reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex3=/^#([0-9a-f]{3})$/,reHex6=/^#([0-9a-f]{6})$/,reRgbInteger=new RegExp("^rgb\\("+[reI,reI,reI]+"\\)$"),reRgbPercent=new RegExp("^rgb\\("+[reP,reP,reP]+"\\)$"),reRgbaInteger=new RegExp("^rgba\\("+[reI,reI,reI,reN]+"\\)$"),reRgbaPercent=new RegExp("^rgba\\("+[reP,reP,reP,reN]+"\\)$"),reHslPercent=new RegExp("^hsl\\("+[reN,reP,reP]+"\\)$"),reHslaPercent=new RegExp("^hsla\\("+[reN,reP,reP,reN]+"\\)$"),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function color(format){var m;return format=(format+"").trim().toLowerCase(),(m=reHex3.exec(format))?new Rgb((m=parseInt(m[1],16))>>8&15|m>>4&240,m>>4&15|240&m,(15&m)<<4|15&m,1):(m=reHex6.exec(format))?rgbn(parseInt(m[1],16)):(m=reRgbInteger.exec(format))?new Rgb(m[1],m[2],m[3],1):(m=reRgbPercent.exec(format))?new Rgb(255*m[1]/100,255*m[2]/100,255*m[3]/100,1):(m=reRgbaInteger.exec(format))?rgba(m[1],m[2],m[3],m[4]):(m=reRgbaPercent.exec(format))?rgba(255*m[1]/100,255*m[2]/100,255*m[3]/100,m[4]):(m=reHslPercent.exec(format))?hsla(m[1],m[2]/100,m[3]/100,1):(m=reHslaPercent.exec(format))?hsla(m[1],m[2]/100,m[3]/100,m[4]):named.hasOwnProperty(format)?rgbn(named[format]):"transparent"===format?new Rgb(NaN,NaN,NaN,0):null}function rgbn(n){return new Rgb(n>>16&255,n>>8&255,255&n,1)}function rgba(r,g,b,a){return a<=0&&(r=g=b=NaN),new Rgb(r,g,b,a)}function rgbConvert(o){return o instanceof Color||(o=color(o)),o?new Rgb((o=o.rgb()).r,o.g,o.b,o.opacity):new Rgb}function rgb(r,g,b,opacity){return 1===arguments.length?rgbConvert(r):new Rgb(r,g,b,null==opacity?1:opacity)}function Rgb(r,g,b,opacity){this.r=+r,this.g=+g,this.b=+b,this.opacity=+opacity}function hsla(h,s,l,a){return a<=0?h=s=l=NaN:l<=0||l>=1?h=s=NaN:s<=0&&(h=NaN),new Hsl(h,s,l,a)}function hsl(h,s,l,opacity){return 1===arguments.length?function hslConvert(o){if(o instanceof Hsl)return new Hsl(o.h,o.s,o.l,o.opacity);if(o instanceof Color||(o=color(o)),!o)return new Hsl;if(o instanceof Hsl)return o;var r=(o=o.rgb()).r/255,g=o.g/255,b=o.b/255,min=Math.min(r,g,b),max=Math.max(r,g,b),h=NaN,s=max-min,l=(max+min)/2;return s?(h=r===max?(g-b)/s+6*(g<b):g===max?(b-r)/s+2:(r-g)/s+4,s/=l<.5?max+min:2-max-min,h*=60):s=l>0&&l<1?0:h,new Hsl(h,s,l,o.opacity)}(h):new Hsl(h,s,l,null==opacity?1:opacity)}function Hsl(h,s,l,opacity){this.h=+h,this.s=+s,this.l=+l,this.opacity=+opacity}function hsl2rgb(h,m1,m2){return 255*(h<60?m1+(m2-m1)*h/60:h<180?m2:h<240?m1+(m2-m1)*(240-h)/60:m1)}define(Color,color,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),define(Rgb,rgb,extend(Color,{brighter:function(k){return k=null==k?1/.7:Math.pow(1/.7,k),new Rgb(this.r*k,this.g*k,this.b*k,this.opacity)},darker:function(k){return k=null==k?.7:Math.pow(.7,k),new Rgb(this.r*k,this.g*k,this.b*k,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var a=this.opacity;return(1===(a=isNaN(a)?1:Math.max(0,Math.min(1,a)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===a?")":", "+a+")")}})),define(Hsl,hsl,extend(Color,{brighter:function(k){return k=null==k?1/.7:Math.pow(1/.7,k),new Hsl(this.h,this.s,this.l*k,this.opacity)},darker:function(k){return k=null==k?.7:Math.pow(.7,k),new Hsl(this.h,this.s,this.l*k,this.opacity)},rgb:function(){var h=this.h%360+360*(this.h<0),s=isNaN(h)||isNaN(this.s)?0:this.s,l=this.l,m2=l+(l<.5?l:1-l)*s,m1=2*l-m2;return new Rgb(hsl2rgb(h>=240?h-240:h+120,m1,m2),hsl2rgb(h,m1,m2),hsl2rgb(h<120?h+240:h-120,m1,m2),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var deg2rad=Math.PI/180,rad2deg=180/Math.PI,Xn=.95047,Yn=1,Zn=1.08883,t0=4/29,t1=6/29,t2=3*t1*t1,t3=t1*t1*t1;function labConvert(o){if(o instanceof Lab)return new Lab(o.l,o.a,o.b,o.opacity);if(o instanceof Hcl){var h=o.h*deg2rad;return new Lab(o.l,Math.cos(h)*o.c,Math.sin(h)*o.c,o.opacity)}o instanceof Rgb||(o=rgbConvert(o));var b=rgb2xyz(o.r),a=rgb2xyz(o.g),l=rgb2xyz(o.b),x=xyz2lab((.4124564*b+.3575761*a+.1804375*l)/Xn),y=xyz2lab((.2126729*b+.7151522*a+.072175*l)/Yn);return new Lab(116*y-16,500*(x-y),200*(y-xyz2lab((.0193339*b+.119192*a+.9503041*l)/Zn)),o.opacity)}function lab(l,a,b,opacity){return 1===arguments.length?labConvert(l):new Lab(l,a,b,null==opacity?1:opacity)}function Lab(l,a,b,opacity){this.l=+l,this.a=+a,this.b=+b,this.opacity=+opacity}function xyz2lab(t){return t>t3?Math.pow(t,1/3):t/t2+t0}function lab2xyz(t){return t>t1?t*t*t:t2*(t-t0)}function xyz2rgb(x){return 255*(x<=.0031308?12.92*x:1.055*Math.pow(x,1/2.4)-.055)}function rgb2xyz(x){return(x/=255)<=.04045?x/12.92:Math.pow((x+.055)/1.055,2.4)}function hcl(h,c,l,opacity){return 1===arguments.length?function hclConvert(o){if(o instanceof Hcl)return new Hcl(o.h,o.c,o.l,o.opacity);o instanceof Lab||(o=labConvert(o));var h=Math.atan2(o.b,o.a)*rad2deg;return new Hcl(h<0?h+360:h,Math.sqrt(o.a*o.a+o.b*o.b),o.l,o.opacity)}(h):new Hcl(h,c,l,null==opacity?1:opacity)}function Hcl(h,c,l,opacity){this.h=+h,this.c=+c,this.l=+l,this.opacity=+opacity}define(Lab,lab,extend(Color,{brighter:function(k){return new Lab(this.l+18*(null==k?1:k),this.a,this.b,this.opacity)},darker:function(k){return new Lab(this.l-18*(null==k?1:k),this.a,this.b,this.opacity)},rgb:function(){var y=(this.l+16)/116,x=isNaN(this.a)?y:y+this.a/500,z=isNaN(this.b)?y:y-this.b/200;return y=Yn*lab2xyz(y),new Rgb(xyz2rgb(3.2404542*(x=Xn*lab2xyz(x))-1.5371385*y-.4985314*(z=Zn*lab2xyz(z))),xyz2rgb(-.969266*x+1.8760108*y+.041556*z),xyz2rgb(.0556434*x-.2040259*y+1.0572252*z),this.opacity)}})),define(Hcl,hcl,extend(Color,{brighter:function(k){return new Hcl(this.h,this.c,this.l+18*(null==k?1:k),this.opacity)},darker:function(k){return new Hcl(this.h,this.c,this.l-18*(null==k?1:k),this.opacity)},rgb:function(){return labConvert(this).rgb()}}));var A=-.14861,B=1.78277,C=-.29227,D=-.90649,E=1.97294,ED=E*D,EB=E*B,BC_DA=B*C-D*A;function cubehelix(h,s,l,opacity){return 1===arguments.length?function cubehelixConvert(o){if(o instanceof Cubehelix)return new Cubehelix(o.h,o.s,o.l,o.opacity);o instanceof Rgb||(o=rgbConvert(o));var r=o.r/255,g=o.g/255,b=o.b/255,l=(BC_DA*b+ED*r-EB*g)/(BC_DA+ED-EB),bl=b-l,k=(E*(g-l)-C*bl)/D,s=Math.sqrt(k*k+bl*bl)/(E*l*(1-l)),h=s?Math.atan2(k,bl)*rad2deg-120:NaN;return new Cubehelix(h<0?h+360:h,s,l,o.opacity)}(h):new Cubehelix(h,s,l,null==opacity?1:opacity)}function Cubehelix(h,s,l,opacity){this.h=+h,this.s=+s,this.l=+l,this.opacity=+opacity}define(Cubehelix,cubehelix,extend(Color,{brighter:function(k){return k=null==k?1/.7:Math.pow(1/.7,k),new Cubehelix(this.h,this.s,this.l*k,this.opacity)},darker:function(k){return k=null==k?.7:Math.pow(.7,k),new Cubehelix(this.h,this.s,this.l*k,this.opacity)},rgb:function(){var h=isNaN(this.h)?0:(this.h+120)*deg2rad,l=+this.l,a=isNaN(this.s)?0:this.s*l*(1-l),cosh=Math.cos(h),sinh=Math.sin(h);return new Rgb(255*(l+a*(A*cosh+B*sinh)),255*(l+a*(C*cosh+D*sinh)),255*(l+a*(E*cosh)),this.opacity)}})),exports.color=color,exports.rgb=rgb,exports.hsl=hsl,exports.lab=lab,exports.hcl=hcl,exports.cubehelix=cubehelix,Object.defineProperty(exports,"__esModule",{value:!0})}),_$d3Color_121=_$d3Color_121.exports;var _$d3Interpolate_124={exports:{}};!function(global,factory){"object"==typeof _$d3Interpolate_124.exports?factory(_$d3Interpolate_124.exports,_$d3Color_121):factory(global.d3=global.d3||{},global.d3)}(this,function(exports,d3Color){"use strict";function basis(t1,v0,v1,v2,v3){var t2=t1*t1,t3=t2*t1;return((1-3*t1+3*t2-t3)*v0+(4-6*t2+3*t3)*v1+(1+3*t1+3*t2-3*t3)*v2+t3*v3)/6}var basis$1=function(values){var n=values.length-1;return function(t){var i=t<=0?t=0:t>=1?(t=1,n-1):Math.floor(t*n),v1=values[i],v2=values[i+1],v0=i>0?values[i-1]:2*v1-v2,v3=i<n-1?values[i+2]:2*v2-v1;return basis((t-i/n)*n,v0,v1,v2,v3)}},basisClosed=function(values){var n=values.length;return function(t){var i=Math.floor(((t%=1)<0?++t:t)*n),v0=values[(i+n-1)%n],v1=values[i%n],v2=values[(i+1)%n],v3=values[(i+2)%n];return basis((t-i/n)*n,v0,v1,v2,v3)}},constant=function(x){return function(){return x}};function linear(a,d){return function(t){return a+t*d}}function hue(a,b){var d=b-a;return d?linear(a,d>180||d<-180?d-360*Math.round(d/360):d):constant(isNaN(a)?b:a)}function gamma(y){return 1==(y=+y)?nogamma:function(a,b){return b-a?function exponential(a,b,y){return a=Math.pow(a,y),b=Math.pow(b,y)-a,y=1/y,function(t){return Math.pow(a+t*b,y)}}(a,b,y):constant(isNaN(a)?b:a)}}function nogamma(a,b){var d=b-a;return d?linear(a,d):constant(isNaN(a)?b:a)}var rgb$1=function rgbGamma(y){var color$$1=gamma(y);function rgb$$1(start,end){var r=color$$1((start=d3Color.rgb(start)).r,(end=d3Color.rgb(end)).r),g=color$$1(start.g,end.g),b=color$$1(start.b,end.b),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.r=r(t),start.g=g(t),start.b=b(t),start.opacity=opacity(t),start+""}}return rgb$$1.gamma=rgbGamma,rgb$$1}(1);function rgbSpline(spline){return function(colors){var i,color$$1,n=colors.length,r=new Array(n),g=new Array(n),b=new Array(n);for(i=0;i<n;++i)color$$1=d3Color.rgb(colors[i]),r[i]=color$$1.r||0,g[i]=color$$1.g||0,b[i]=color$$1.b||0;return r=spline(r),g=spline(g),b=spline(b),color$$1.opacity=1,function(t){return color$$1.r=r(t),color$$1.g=g(t),color$$1.b=b(t),color$$1+""}}}var rgbBasis=rgbSpline(basis$1),rgbBasisClosed=rgbSpline(basisClosed),array=function(a,b){var i,nb=b?b.length:0,na=a?Math.min(nb,a.length):0,x=new Array(na),c=new Array(nb);for(i=0;i<na;++i)x[i]=value(a[i],b[i]);for(;i<nb;++i)c[i]=b[i];return function(t){for(i=0;i<na;++i)c[i]=x[i](t);return c}},date=function(a,b){var d=new Date;return b-=a=+a,function(t){return d.setTime(a+b*t),d}},number=function(a,b){return b-=a=+a,function(t){return a+b*t}},object=function(a,b){var k,i={},c={};for(k in null!==a&&"object"==typeof a||(a={}),null!==b&&"object"==typeof b||(b={}),b)k in a?i[k]=value(a[k],b[k]):c[k]=b[k];return function(t){for(k in i)c[k]=i[k](t);return c}},reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");var cssNode,cssRoot,cssView,svgNode,string=function(a,b){var am,bm,bs,bi=reA.lastIndex=reB.lastIndex=0,i=-1,s=[],q=[];for(a+="",b+="";(am=reA.exec(a))&&(bm=reB.exec(b));)(bs=bm.index)>bi&&(bs=b.slice(bi,bs),s[i]?s[i]+=bs:s[++i]=bs),(am=am[0])===(bm=bm[0])?s[i]?s[i]+=bm:s[++i]=bm:(s[++i]=null,q.push({i:i,x:number(am,bm)})),bi=reB.lastIndex;return bi<b.length&&(bs=b.slice(bi),s[i]?s[i]+=bs:s[++i]=bs),s.length<2?q[0]?function one(b){return function(t){return b(t)+""}}(q[0].x):function zero(b){return function(){return b}}(b):(b=q.length,function(t){for(var o,i=0;i<b;++i)s[(o=q[i]).i]=o.x(t);return s.join("")})},value=function(a,b){var c,t=typeof b;return null==b||"boolean"===t?constant(b):("number"===t?number:"string"===t?(c=d3Color.color(b))?(b=c,rgb$1):string:b instanceof d3Color.color?rgb$1:b instanceof Date?date:Array.isArray(b)?array:"function"!=typeof b.valueOf&&"function"!=typeof b.toString||isNaN(b)?object:number)(a,b)},degrees=180/Math.PI,identity={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},decompose=function(a,b,c,d,e,f){var scaleX,scaleY,skewX;return(scaleX=Math.sqrt(a*a+b*b))&&(a/=scaleX,b/=scaleX),(skewX=a*c+b*d)&&(c-=a*skewX,d-=b*skewX),(scaleY=Math.sqrt(c*c+d*d))&&(c/=scaleY,d/=scaleY,skewX/=scaleY),a*d<b*c&&(a=-a,b=-b,skewX=-skewX,scaleX=-scaleX),{translateX:e,translateY:f,rotate:Math.atan2(b,a)*degrees,skewX:Math.atan(skewX)*degrees,scaleX:scaleX,scaleY:scaleY}};function interpolateTransform(parse,pxComma,pxParen,degParen){function pop(s){return s.length?s.pop()+" ":""}return function(a,b){var s=[],q=[];return a=parse(a),b=parse(b),function translate(xa,ya,xb,yb,s,q){if(xa!==xb||ya!==yb){var i=s.push("translate(",null,pxComma,null,pxParen);q.push({i:i-4,x:number(xa,xb)},{i:i-2,x:number(ya,yb)})}else(xb||yb)&&s.push("translate("+xb+pxComma+yb+pxParen)}(a.translateX,a.translateY,b.translateX,b.translateY,s,q),function rotate(a,b,s,q){a!==b?(a-b>180?b+=360:b-a>180&&(a+=360),q.push({i:s.push(pop(s)+"rotate(",null,degParen)-2,x:number(a,b)})):b&&s.push(pop(s)+"rotate("+b+degParen)}(a.rotate,b.rotate,s,q),function skewX(a,b,s,q){a!==b?q.push({i:s.push(pop(s)+"skewX(",null,degParen)-2,x:number(a,b)}):b&&s.push(pop(s)+"skewX("+b+degParen)}(a.skewX,b.skewX,s,q),function scale(xa,ya,xb,yb,s,q){if(xa!==xb||ya!==yb){var i=s.push(pop(s)+"scale(",null,",",null,")");q.push({i:i-4,x:number(xa,xb)},{i:i-2,x:number(ya,yb)})}else 1===xb&&1===yb||s.push(pop(s)+"scale("+xb+","+yb+")")}(a.scaleX,a.scaleY,b.scaleX,b.scaleY,s,q),a=b=null,function(t){for(var o,i=-1,n=q.length;++i<n;)s[(o=q[i]).i]=o.x(t);return s.join("")}}}var interpolateTransformCss=interpolateTransform(function parseCss(value){return"none"===value?identity:(cssNode||(cssNode=document.createElement("DIV"),cssRoot=document.documentElement,cssView=document.defaultView),cssNode.style.transform=value,value=cssView.getComputedStyle(cssRoot.appendChild(cssNode),null).getPropertyValue("transform"),cssRoot.removeChild(cssNode),value=value.slice(7,-1).split(","),decompose(+value[0],+value[1],+value[2],+value[3],+value[4],+value[5]))},"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(function parseSvg(value){return null==value?identity:(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",value),(value=svgNode.transform.baseVal.consolidate())?(value=value.matrix,decompose(value.a,value.b,value.c,value.d,value.e,value.f)):identity)},", ",")",")"),rho=Math.SQRT2;function cosh(x){return((x=Math.exp(x))+1/x)/2}function hsl$1(hue$$1){return function(start,end){var h=hue$$1((start=d3Color.hsl(start)).h,(end=d3Color.hsl(end)).h),s=nogamma(start.s,end.s),l=nogamma(start.l,end.l),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.h=h(t),start.s=s(t),start.l=l(t),start.opacity=opacity(t),start+""}}}var hsl$2=hsl$1(hue),hslLong=hsl$1(nogamma);function hcl$1(hue$$1){return function(start,end){var h=hue$$1((start=d3Color.hcl(start)).h,(end=d3Color.hcl(end)).h),c=nogamma(start.c,end.c),l=nogamma(start.l,end.l),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.h=h(t),start.c=c(t),start.l=l(t),start.opacity=opacity(t),start+""}}}var hcl$2=hcl$1(hue),hclLong=hcl$1(nogamma);function cubehelix$1(hue$$1){return function cubehelixGamma(y){function cubehelix$$1(start,end){var h=hue$$1((start=d3Color.cubehelix(start)).h,(end=d3Color.cubehelix(end)).h),s=nogamma(start.s,end.s),l=nogamma(start.l,end.l),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.h=h(t),start.s=s(t),start.l=l(Math.pow(t,y)),start.opacity=opacity(t),start+""}}return y=+y,cubehelix$$1.gamma=cubehelixGamma,cubehelix$$1}(1)}var cubehelix$2=cubehelix$1(hue),cubehelixLong=cubehelix$1(nogamma);exports.interpolate=value,exports.interpolateArray=array,exports.interpolateBasis=basis$1,exports.interpolateBasisClosed=basisClosed,exports.interpolateDate=date,exports.interpolateNumber=number,exports.interpolateObject=object,exports.interpolateRound=function(a,b){return b-=a=+a,function(t){return Math.round(a+b*t)}},exports.interpolateString=string,exports.interpolateTransformCss=interpolateTransformCss,exports.interpolateTransformSvg=interpolateTransformSvg,exports.interpolateZoom=function(p0,p1){var i,S,ux0=p0[0],uy0=p0[1],w0=p0[2],ux1=p1[0],uy1=p1[1],w1=p1[2],dx=ux1-ux0,dy=uy1-uy0,d2=dx*dx+dy*dy;if(d2<1e-12)S=Math.log(w1/w0)/rho,i=function(t){return[ux0+t*dx,uy0+t*dy,w0*Math.exp(rho*t*S)]};else{var d1=Math.sqrt(d2),b0=(w1*w1-w0*w0+4*d2)/(2*w0*2*d1),b1=(w1*w1-w0*w0-4*d2)/(2*w1*2*d1),r0=Math.log(Math.sqrt(b0*b0+1)-b0),r1=Math.log(Math.sqrt(b1*b1+1)-b1);S=(r1-r0)/rho,i=function(t){var s=t*S,coshr0=cosh(r0),u=w0/(2*d1)*(coshr0*function tanh(x){return((x=Math.exp(2*x))-1)/(x+1)}(rho*s+r0)-function sinh(x){return((x=Math.exp(x))-1/x)/2}(r0));return[ux0+u*dx,uy0+u*dy,w0*coshr0/cosh(rho*s+r0)]}}return i.duration=1e3*S,i},exports.interpolateRgb=rgb$1,exports.interpolateRgbBasis=rgbBasis,exports.interpolateRgbBasisClosed=rgbBasisClosed,exports.interpolateHsl=hsl$2,exports.interpolateHslLong=hslLong,exports.interpolateLab=function lab$1(start,end){var l=nogamma((start=d3Color.lab(start)).l,(end=d3Color.lab(end)).l),a=nogamma(start.a,end.a),b=nogamma(start.b,end.b),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.l=l(t),start.a=a(t),start.b=b(t),start.opacity=opacity(t),start+""}},exports.interpolateHcl=hcl$2,exports.interpolateHclLong=hclLong,exports.interpolateCubehelix=cubehelix$2,exports.interpolateCubehelixLong=cubehelixLong,exports.quantize=function(interpolator,n){for(var samples=new Array(n),i=0;i<n;++i)samples[i]=interpolator(i/(n-1));return samples},Object.defineProperty(exports,"__esModule",{value:!0})}),_$d3Interpolate_124=_$d3Interpolate_124.exports;var _$d3Sankey_41={exports:{}};!function(global,factory){"object"==typeof _$d3Sankey_41.exports?factory(_$d3Sankey_41.exports,_$d3Array_119,_$d3Collection_120,_$d3Interpolate_124):factory(global.d3=global.d3||{},global.d3,global.d3,global.d3)}(this,function(exports,d3Array,d3Collection,d3Interpolate){"use strict";exports.sankey=function(){var sankey={},nodeWidth=24,nodePadding=8,size=[1,1],nodes=[],links=[];function computeLinkDepths(){function ascendingSourceDepth(a,b){return a.source.y-b.source.y||a.originalIndex-b.originalIndex}function ascendingTargetDepth(a,b){return a.target.y-b.target.y||a.originalIndex-b.originalIndex}nodes.forEach(function(node){node.sourceLinks.sort(ascendingTargetDepth),node.targetLinks.sort(ascendingSourceDepth)}),nodes.forEach(function(node){var sy=0,ty=0;node.sourceLinks.forEach(function(link){link.sy=sy,sy+=link.dy}),node.targetLinks.forEach(function(link){link.ty=ty,ty+=link.dy})})}function center(node){return node.y+node.dy/2}function value(link){return link.value}return sankey.nodeWidth=function(_){return arguments.length?(nodeWidth=+_,sankey):nodeWidth},sankey.nodePadding=function(_){return arguments.length?(nodePadding=+_,sankey):nodePadding},sankey.nodes=function(_){return arguments.length?(nodes=_,sankey):nodes},sankey.links=function(_){return arguments.length?(links=_,sankey):links},sankey.size=function(_){return arguments.length?(size=_,sankey):size},sankey.layout=function(iterations){return function computeNodeLinks(){nodes.forEach(function(node){node.sourceLinks=[],node.targetLinks=[]}),links.forEach(function(link,i){var source=link.source,target=link.target;"number"==typeof source&&(source=link.source=nodes[link.source]),"number"==typeof target&&(target=link.target=nodes[link.target]),link.originalIndex=i,source.sourceLinks.push(link),target.targetLinks.push(link)})}(),function computeNodeValues(){nodes.forEach(function(node){node.value=Math.max(d3Array.sum(node.sourceLinks,value),d3Array.sum(node.targetLinks,value))})}(),function computeNodeBreadths(){for(var nextNodes,remainingNodes=nodes,x=0;remainingNodes.length;)nextNodes=[],remainingNodes.forEach(function(node){node.x=x,node.dx=nodeWidth,node.sourceLinks.forEach(function(link){nextNodes.indexOf(link.target)<0&&nextNodes.push(link.target)})}),remainingNodes=nextNodes,++x;(function moveSinksRight(x){nodes.forEach(function(node){node.sourceLinks.length||(node.x=x-1)})})(x),function scaleNodeBreadths(kx){nodes.forEach(function(node){node.x*=kx})}((size[0]-nodeWidth)/(x-1))}(),function computeNodeDepths(iterations){var nodesByBreadth=d3Collection.nest().key(function(d){return d.x}).sortKeys(d3Array.ascending).entries(nodes).map(function(d){return d.values});(function initializeNodeDepth(){var ky=d3Array.min(nodesByBreadth,function(nodes){return(size[1]-(nodes.length-1)*nodePadding)/d3Array.sum(nodes,value)});nodesByBreadth.forEach(function(nodes){nodes.forEach(function(node,i){node.y=i,node.dy=node.value*ky})}),links.forEach(function(link){link.dy=link.value*ky})})(),resolveCollisions();for(var alpha=1;iterations>0;--iterations)relaxRightToLeft(alpha*=.99),resolveCollisions(),relaxLeftToRight(alpha),resolveCollisions();function relaxLeftToRight(alpha){function weightedSource(link){return center(link.source)*link.value}nodesByBreadth.forEach(function(nodes){nodes.forEach(function(node){if(node.targetLinks.length){var y=d3Array.sum(node.targetLinks,weightedSource)/d3Array.sum(node.targetLinks,value);node.y+=(y-center(node))*alpha}})})}function relaxRightToLeft(alpha){function weightedTarget(link){return center(link.target)*link.value}nodesByBreadth.slice().reverse().forEach(function(nodes){nodes.forEach(function(node){if(node.sourceLinks.length){var y=d3Array.sum(node.sourceLinks,weightedTarget)/d3Array.sum(node.sourceLinks,value);node.y+=(y-center(node))*alpha}})})}function resolveCollisions(){nodesByBreadth.forEach(function(nodes){var node,dy,i,y0=0,n=nodes.length;for(nodes.sort(ascendingDepth),i=0;i<n;++i)node=nodes[i],(dy=y0-node.y)>0&&(node.y+=dy),y0=node.y+node.dy+nodePadding;if((dy=y0-nodePadding-size[1])>0)for(y0=node.y-=dy,i=n-2;i>=0;--i)node=nodes[i],(dy=node.y+node.dy+nodePadding-y0)>0&&(node.y-=dy),y0=node.y})}function ascendingDepth(a,b){return a.y-b.y}}(iterations),computeLinkDepths(),sankey},sankey.relayout=function(){return computeLinkDepths(),sankey},sankey.link=function(){var curvature=.5;function link(d){var x0=d.source.x+d.source.dx,x1=d.target.x,xi=d3Interpolate.interpolateNumber(x0,x1),x2=xi(curvature),x3=xi(1-curvature),y0a=d.source.y+d.sy,y0b=y0a+d.dy,y1a=d.target.y+d.ty,y1b=y1a+d.dy;return"M"+x0+","+y0a+"C"+x2+","+y0a+" "+x3+","+y1a+" "+x1+","+y1a+"L"+x1+","+y1b+"C"+x3+","+y1b+" "+x2+","+y0b+" "+x0+","+y0b+"Z"}return link.curvature=function(_){return arguments.length?(curvature=+_,link):curvature},link},sankey},Object.defineProperty(exports,"__esModule",{value:!0})}),_$d3Sankey_41=_$d3Sankey_41.exports;var _$d3Dispatch_122={exports:{}};!function(global,factory){"object"==typeof _$d3Dispatch_122.exports?factory(_$d3Dispatch_122.exports):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";var noop={value:function(){}};function dispatch(){for(var t,i=0,n=arguments.length,_={};i<n;++i){if(!(t=arguments[i]+"")||t in _)throw new Error("illegal type: "+t);_[t]=[]}return new Dispatch(_)}function Dispatch(_){this._=_}function get(type,name){for(var c,i=0,n=type.length;i<n;++i)if((c=type[i]).name===name)return c.value}function set(type,name,callback){for(var i=0,n=type.length;i<n;++i)if(type[i].name===name){type[i]=noop,type=type.slice(0,i).concat(type.slice(i+1));break}return null!=callback&&type.push({name:name,value:callback}),type}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(typename,callback){var t,_=this._,T=function parseTypenames(typenames,types){return typenames.trim().split(/^|\s+/).map(function(t){var name="",i=t.indexOf(".");if(i>=0&&(name=t.slice(i+1),t=t.slice(0,i)),t&&!types.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:name}})}(typename+"",_),i=-1,n=T.length;if(!(arguments.length<2)){if(null!=callback&&"function"!=typeof callback)throw new Error("invalid callback: "+callback);for(;++i<n;)if(t=(typename=T[i]).type)_[t]=set(_[t],typename.name,callback);else if(null==callback)for(t in _)_[t]=set(_[t],typename.name,null);return this}for(;++i<n;)if((t=(typename=T[i]).type)&&(t=get(_[t],typename.name)))return t},copy:function(){var copy={},_=this._;for(var t in _)copy[t]=_[t].slice();return new Dispatch(copy)},call:function(type,that){if((n=arguments.length-2)>0)for(var n,t,args=new Array(n),i=0;i<n;++i)args[i]=arguments[i+2];if(!this._.hasOwnProperty(type))throw new Error("unknown type: "+type);for(i=0,n=(t=this._[type]).length;i<n;++i)t[i].value.apply(that,args)},apply:function(type,that,args){if(!this._.hasOwnProperty(type))throw new Error("unknown type: "+type);for(var t=this._[type],i=0,n=t.length;i<n;++i)t[i].value.apply(that,args)}},exports.dispatch=dispatch,Object.defineProperty(exports,"__esModule",{value:!0})}),_$d3Dispatch_122=_$d3Dispatch_122.exports;var _$d3Quadtree_125={exports:{}};!function(global,factory){"object"==typeof _$d3Quadtree_125.exports?factory(_$d3Quadtree_125.exports):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function add(tree,x,y,d){if(isNaN(x)||isNaN(y))return tree;var parent,xm,ym,xp,yp,right,bottom,i,j,node=tree._root,leaf={data:d},x0=tree._x0,y0=tree._y0,x1=tree._x1,y1=tree._y1;if(!node)return tree._root=leaf,tree;for(;node.length;)if((right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym,parent=node,!(node=node[i=bottom<<1|right]))return parent[i]=leaf,tree;if(xp=+tree._x.call(null,node.data),yp=+tree._y.call(null,node.data),x===xp&&y===yp)return leaf.next=node,parent?parent[i]=leaf:tree._root=leaf,tree;do{parent=parent?parent[i]=new Array(4):tree._root=new Array(4),(right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym}while((i=bottom<<1|right)==(j=(yp>=ym)<<1|xp>=xm));return parent[j]=node,parent[i]=leaf,tree}var Quad=function(node,x0,y0,x1,y1){this.node=node,this.x0=x0,this.y0=y0,this.x1=x1,this.y1=y1};function defaultX(d){return d[0]}function defaultY(d){return d[1]}function quadtree(nodes,x,y){var tree=new Quadtree(null==x?defaultX:x,null==y?defaultY:y,NaN,NaN,NaN,NaN);return null==nodes?tree:tree.addAll(nodes)}function Quadtree(x,y,x0,y0,x1,y1){this._x=x,this._y=y,this._x0=x0,this._y0=y0,this._x1=x1,this._y1=y1,this._root=void 0}function leaf_copy(leaf){for(var copy={data:leaf.data},next=copy;leaf=leaf.next;)next=next.next={data:leaf.data};return copy}var treeProto=quadtree.prototype=Quadtree.prototype;treeProto.copy=function(){var nodes,child,copy=new Quadtree(this._x,this._y,this._x0,this._y0,this._x1,this._y1),node=this._root;if(!node)return copy;if(!node.length)return copy._root=leaf_copy(node),copy;for(nodes=[{source:node,target:copy._root=new Array(4)}];node=nodes.pop();)for(var i=0;i<4;++i)(child=node.source[i])&&(child.length?nodes.push({source:child,target:node.target[i]=new Array(4)}):node.target[i]=leaf_copy(child));return copy},treeProto.add=function(d){var x=+this._x.call(null,d),y=+this._y.call(null,d);return add(this.cover(x,y),x,y,d)},treeProto.addAll=function addAll(data){var d,i,x,y,n=data.length,xz=new Array(n),yz=new Array(n),x0=1/0,y0=1/0,x1=-1/0,y1=-1/0;for(i=0;i<n;++i)isNaN(x=+this._x.call(null,d=data[i]))||isNaN(y=+this._y.call(null,d))||(xz[i]=x,yz[i]=y,x<x0&&(x0=x),x>x1&&(x1=x),y<y0&&(y0=y),y>y1&&(y1=y));for(x1<x0&&(x0=this._x0,x1=this._x1),y1<y0&&(y0=this._y0,y1=this._y1),this.cover(x0,y0).cover(x1,y1),i=0;i<n;++i)add(this,xz[i],yz[i],data[i]);return this},treeProto.cover=function(x,y){if(isNaN(x=+x)||isNaN(y=+y))return this;var x0=this._x0,y0=this._y0,x1=this._x1,y1=this._y1;if(isNaN(x0))x1=(x0=Math.floor(x))+1,y1=(y0=Math.floor(y))+1;else{if(!(x0>x||x>x1||y0>y||y>y1))return this;var parent,i,z=x1-x0,node=this._root;switch(i=(y<(y0+y1)/2)<<1|x<(x0+x1)/2){case 0:do{(parent=new Array(4))[i]=node,node=parent}while(y1=y0+(z*=2),x>(x1=x0+z)||y>y1);break;case 1:do{(parent=new Array(4))[i]=node,node=parent}while(y1=y0+(z*=2),(x0=x1-z)>x||y>y1);break;case 2:do{(parent=new Array(4))[i]=node,node=parent}while(y0=y1-(z*=2),x>(x1=x0+z)||y0>y);break;case 3:do{(parent=new Array(4))[i]=node,node=parent}while(y0=y1-(z*=2),(x0=x1-z)>x||y0>y)}this._root&&this._root.length&&(this._root=node)}return this._x0=x0,this._y0=y0,this._x1=x1,this._y1=y1,this},treeProto.data=function(){var data=[];return this.visit(function(node){if(!node.length)do{data.push(node.data)}while(node=node.next)}),data},treeProto.extent=function(_){return arguments.length?this.cover(+_[0][0],+_[0][1]).cover(+_[1][0],+_[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},treeProto.find=function(x,y,radius){var data,x1,y1,x2,y2,q,i,x0=this._x0,y0=this._y0,x3=this._x1,y3=this._y1,quads=[],node=this._root;for(node&&quads.push(new Quad(node,x0,y0,x3,y3)),null==radius?radius=1/0:(x0=x-radius,y0=y-radius,x3=x+radius,y3=y+radius,radius*=radius);q=quads.pop();)if(!(!(node=q.node)||(x1=q.x0)>x3||(y1=q.y0)>y3||(x2=q.x1)<x0||(y2=q.y1)<y0))if(node.length){var xm=(x1+x2)/2,ym=(y1+y2)/2;quads.push(new Quad(node[3],xm,ym,x2,y2),new Quad(node[2],x1,ym,xm,y2),new Quad(node[1],xm,y1,x2,ym),new Quad(node[0],x1,y1,xm,ym)),(i=(y>=ym)<<1|x>=xm)&&(q=quads[quads.length-1],quads[quads.length-1]=quads[quads.length-1-i],quads[quads.length-1-i]=q)}else{var dx=x-+this._x.call(null,node.data),dy=y-+this._y.call(null,node.data),d2=dx*dx+dy*dy;if(d2<radius){var d=Math.sqrt(radius=d2);x0=x-d,y0=y-d,x3=x+d,y3=y+d,data=node.data}}return data},treeProto.remove=function(d){if(isNaN(x=+this._x.call(null,d))||isNaN(y=+this._y.call(null,d)))return this;var parent,retainer,previous,next,x,y,xm,ym,right,bottom,i,j,node=this._root,x0=this._x0,y0=this._y0,x1=this._x1,y1=this._y1;if(!node)return this;if(node.length)for(;;){if((right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym,parent=node,!(node=node[i=bottom<<1|right]))return this;if(!node.length)break;(parent[i+1&3]||parent[i+2&3]||parent[i+3&3])&&(retainer=parent,j=i)}for(;node.data!==d;)if(previous=node,!(node=node.next))return this;return(next=node.next)&&delete node.next,previous?(next?previous.next=next:delete previous.next,this):parent?(next?parent[i]=next:delete parent[i],(node=parent[0]||parent[1]||parent[2]||parent[3])&&node===(parent[3]||parent[2]||parent[1]||parent[0])&&!node.length&&(retainer?retainer[j]=node:this._root=node),this):(this._root=next,this)},treeProto.removeAll=function removeAll(data){for(var i=0,n=data.length;i<n;++i)this.remove(data[i]);return this},treeProto.root=function(){return this._root},treeProto.size=function(){var size=0;return this.visit(function(node){if(!node.length)do{++size}while(node=node.next)}),size},treeProto.visit=function(callback){var q,child,x0,y0,x1,y1,quads=[],node=this._root;for(node&&quads.push(new Quad(node,this._x0,this._y0,this._x1,this._y1));q=quads.pop();)if(!callback(node=q.node,x0=q.x0,y0=q.y0,x1=q.x1,y1=q.y1)&&node.length){var xm=(x0+x1)/2,ym=(y0+y1)/2;(child=node[3])&&quads.push(new Quad(child,xm,ym,x1,y1)),(child=node[2])&&quads.push(new Quad(child,x0,ym,xm,y1)),(child=node[1])&&quads.push(new Quad(child,xm,y0,x1,ym)),(child=node[0])&&quads.push(new Quad(child,x0,y0,xm,ym))}return this},treeProto.visitAfter=function(callback){var q,quads=[],next=[];for(this._root&&quads.push(new Quad(this._root,this._x0,this._y0,this._x1,this._y1));q=quads.pop();){var node=q.node;if(node.length){var child,x0=q.x0,y0=q.y0,x1=q.x1,y1=q.y1,xm=(x0+x1)/2,ym=(y0+y1)/2;(child=node[0])&&quads.push(new Quad(child,x0,y0,xm,ym)),(child=node[1])&&quads.push(new Quad(child,xm,y0,x1,ym)),(child=node[2])&&quads.push(new Quad(child,x0,ym,xm,y1)),(child=node[3])&&quads.push(new Quad(child,xm,ym,x1,y1))}next.push(q)}for(;q=next.pop();)callback(q.node,q.x0,q.y0,q.x1,q.y1);return this},treeProto.x=function(_){return arguments.length?(this._x=_,this):this._x},treeProto.y=function(_){return arguments.length?(this._y=_,this):this._y},exports.quadtree=quadtree,Object.defineProperty(exports,"__esModule",{value:!0})}),_$d3Quadtree_125=_$d3Quadtree_125.exports;var _$d3Timer_126={exports:{}};!function(global,factory){"object"==typeof _$d3Timer_126.exports?factory(_$d3Timer_126.exports):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";var taskHead,taskTail,frame=0,timeout=0,interval=0,pokeDelay=1e3,clockLast=0,clockNow=0,clockSkew=0,clock="object"==typeof performance&&performance.now?performance:Date,setFrame="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(f){setTimeout(f,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}function timer(callback,delay,time){var t=new Timer;return t.restart(callback,delay,time),t}function timerFlush(){now(),++frame;for(var e,t=taskHead;t;)(e=clockNow-t._time)>=0&&t._call.call(null,e),t=t._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout=0;try{timerFlush()}finally{frame=0,function nap(){var t0,t2,t1=taskHead,time=1/0;for(;t1;)t1._call?(time>t1._time&&(time=t1._time),t0=t1,t1=t1._next):(t2=t1._next,t1._next=null,t1=t0?t0._next=t2:taskHead=t2);taskTail=t0,sleep(time)}(),clockNow=0}}function poke(){var now=clock.now(),delay=now-clockLast;delay>pokeDelay&&(clockSkew-=delay,clockLast=now)}function sleep(time){frame||(timeout&&(timeout=clearTimeout(timeout)),time-clockNow>24?(time<1/0&&(timeout=setTimeout(wake,time-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake)))}Timer.prototype=timer.prototype={constructor:Timer,restart:function(callback,delay,time){if("function"!=typeof callback)throw new TypeError("callback is not a function");time=(null==time?now():+time)+(null==delay?0:+delay),this._next||taskTail===this||(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=callback,this._time=time,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};exports.now=now,exports.timer=timer,exports.timerFlush=timerFlush,exports.timeout=function(callback,delay,time){var t=new Timer;return delay=null==delay?0:+delay,t.restart(function(elapsed){t.stop(),callback(elapsed+delay)},delay,time),t},exports.interval=function(callback,delay,time){var t=new Timer,total=delay;return null==delay?(t.restart(callback,delay,time),t):(delay=+delay,time=null==time?now():+time,t.restart(function tick(elapsed){elapsed+=total,t.restart(tick,total+=delay,time),callback(elapsed)},delay,time),t)},Object.defineProperty(exports,"__esModule",{value:!0})}),_$d3Timer_126=_$d3Timer_126.exports;var _$d3Force_123={exports:{}};!function(global,factory){"object"==typeof _$d3Force_123.exports?factory(_$d3Force_123.exports,_$d3Quadtree_125,_$d3Collection_120,_$d3Dispatch_122,_$d3Timer_126):factory(global.d3=global.d3||{},global.d3,global.d3,global.d3,global.d3)}(this,function(exports,d3Quadtree,d3Collection,d3Dispatch,d3Timer){"use strict";var constant=function(x){return function(){return x}},jiggle=function(){return 1e-6*(Math.random()-.5)};function x(d){return d.x+d.vx}function y(d){return d.y+d.vy}function index(d){return d.index}function find(nodeById,nodeId){var node=nodeById.get(nodeId);if(!node)throw new Error("missing: "+nodeId);return node}function x$1(d){return d.x}function y$1(d){return d.y}var initialRadius=10,initialAngle=Math.PI*(3-Math.sqrt(5));exports.forceCenter=function(x,y){var nodes;function force(){var i,node,n=nodes.length,sx=0,sy=0;for(i=0;i<n;++i)sx+=(node=nodes[i]).x,sy+=node.y;for(sx=sx/n-x,sy=sy/n-y,i=0;i<n;++i)(node=nodes[i]).x-=sx,node.y-=sy}return null==x&&(x=0),null==y&&(y=0),force.initialize=function(_){nodes=_},force.x=function(_){return arguments.length?(x=+_,force):x},force.y=function(_){return arguments.length?(y=+_,force):y},force},exports.forceCollide=function(radius){var nodes,radii,strength=1,iterations=1;function force(){for(var i,tree,node,xi,yi,ri,ri2,n=nodes.length,k=0;k<iterations;++k)for(tree=d3Quadtree.quadtree(nodes,x,y).visitAfter(prepare),i=0;i<n;++i)node=nodes[i],ri=radii[node.index],ri2=ri*ri,xi=node.x+node.vx,yi=node.y+node.vy,tree.visit(apply);function apply(quad,x0,y0,x1,y1){var data=quad.data,rj=quad.r,r=ri+rj;if(!data)return x0>xi+r||x1<xi-r||y0>yi+r||y1<yi-r;if(data.index>node.index){var x=xi-data.x-data.vx,y=yi-data.y-data.vy,l=x*x+y*y;l<r*r&&(0===x&&(l+=(x=jiggle())*x),0===y&&(l+=(y=jiggle())*y),l=(r-(l=Math.sqrt(l)))/l*strength,node.vx+=(x*=l)*(r=(rj*=rj)/(ri2+rj)),node.vy+=(y*=l)*r,data.vx-=x*(r=1-r),data.vy-=y*r)}}}function prepare(quad){if(quad.data)return quad.r=radii[quad.data.index];for(var i=quad.r=0;i<4;++i)quad[i]&&quad[i].r>quad.r&&(quad.r=quad[i].r)}function initialize(){if(nodes){var i,node,n=nodes.length;for(radii=new Array(n),i=0;i<n;++i)node=nodes[i],radii[node.index]=+radius(node,i,nodes)}}return"function"!=typeof radius&&(radius=constant(null==radius?1:+radius)),force.initialize=function(_){nodes=_,initialize()},force.iterations=function(_){return arguments.length?(iterations=+_,force):iterations},force.strength=function(_){return arguments.length?(strength=+_,force):strength},force.radius=function(_){return arguments.length?(radius="function"==typeof _?_:constant(+_),initialize(),force):radius},force},exports.forceLink=function(links){var strengths,distances,nodes,count,bias,id=index,strength=function defaultStrength(link){return 1/Math.min(count[link.source.index],count[link.target.index])},distance=constant(30),iterations=1;function force(alpha){for(var k=0,n=links.length;k<iterations;++k)for(var link,source,target,x,y,l,b,i=0;i<n;++i)source=(link=links[i]).source,x=(target=link.target).x+target.vx-source.x-source.vx||jiggle(),y=target.y+target.vy-source.y-source.vy||jiggle(),x*=l=((l=Math.sqrt(x*x+y*y))-distances[i])/l*alpha*strengths[i],y*=l,target.vx-=x*(b=bias[i]),target.vy-=y*b,source.vx+=x*(b=1-b),source.vy+=y*b}function initialize(){if(nodes){var i,link,n=nodes.length,m=links.length,nodeById=d3Collection.map(nodes,id);for(i=0,count=new Array(n);i<m;++i)(link=links[i]).index=i,"object"!=typeof link.source&&(link.source=find(nodeById,link.source)),"object"!=typeof link.target&&(link.target=find(nodeById,link.target)),count[link.source.index]=(count[link.source.index]||0)+1,count[link.target.index]=(count[link.target.index]||0)+1;for(i=0,bias=new Array(m);i<m;++i)link=links[i],bias[i]=count[link.source.index]/(count[link.source.index]+count[link.target.index]);strengths=new Array(m),initializeStrength(),distances=new Array(m),initializeDistance()}}function initializeStrength(){if(nodes)for(var i=0,n=links.length;i<n;++i)strengths[i]=+strength(links[i],i,links)}function initializeDistance(){if(nodes)for(var i=0,n=links.length;i<n;++i)distances[i]=+distance(links[i],i,links)}return null==links&&(links=[]),force.initialize=function(_){nodes=_,initialize()},force.links=function(_){return arguments.length?(links=_,initialize(),force):links},force.id=function(_){return arguments.length?(id=_,force):id},force.iterations=function(_){return arguments.length?(iterations=+_,force):iterations},force.strength=function(_){return arguments.length?(strength="function"==typeof _?_:constant(+_),initializeStrength(),force):strength},force.distance=function(_){return arguments.length?(distance="function"==typeof _?_:constant(+_),initializeDistance(),force):distance},force},exports.forceManyBody=function(){var nodes,node,alpha,strengths,strength=constant(-30),distanceMin2=1,distanceMax2=1/0,theta2=.81;function force(_){var i,n=nodes.length,tree=d3Quadtree.quadtree(nodes,x$1,y$1).visitAfter(accumulate);for(alpha=_,i=0;i<n;++i)node=nodes[i],tree.visit(apply)}function initialize(){if(nodes){var i,node,n=nodes.length;for(strengths=new Array(n),i=0;i<n;++i)node=nodes[i],strengths[node.index]=+strength(node,i,nodes)}}function accumulate(quad){var q,c,x,y,i,strength=0,weight=0;if(quad.length){for(x=y=i=0;i<4;++i)(q=quad[i])&&(c=Math.abs(q.value))&&(strength+=q.value,weight+=c,x+=c*q.x,y+=c*q.y);quad.x=x/weight,quad.y=y/weight}else{(q=quad).x=q.data.x,q.y=q.data.y;do{strength+=strengths[q.data.index]}while(q=q.next)}quad.value=strength}function apply(quad,x1,_,x2){if(!quad.value)return!0;var x=quad.x-node.x,y=quad.y-node.y,w=x2-x1,l=x*x+y*y;if(w*w/theta2<l)return l<distanceMax2&&(0===x&&(l+=(x=jiggle())*x),0===y&&(l+=(y=jiggle())*y),l<distanceMin2&&(l=Math.sqrt(distanceMin2*l)),node.vx+=x*quad.value*alpha/l,node.vy+=y*quad.value*alpha/l),!0;if(!(quad.length||l>=distanceMax2)){(quad.data!==node||quad.next)&&(0===x&&(l+=(x=jiggle())*x),0===y&&(l+=(y=jiggle())*y),l<distanceMin2&&(l=Math.sqrt(distanceMin2*l)));do{quad.data!==node&&(w=strengths[quad.data.index]*alpha/l,node.vx+=x*w,node.vy+=y*w)}while(quad=quad.next)}}return force.initialize=function(_){nodes=_,initialize()},force.strength=function(_){return arguments.length?(strength="function"==typeof _?_:constant(+_),initialize(),force):strength},force.distanceMin=function(_){return arguments.length?(distanceMin2=_*_,force):Math.sqrt(distanceMin2)},force.distanceMax=function(_){return arguments.length?(distanceMax2=_*_,force):Math.sqrt(distanceMax2)},force.theta=function(_){return arguments.length?(theta2=_*_,force):Math.sqrt(theta2)},force},exports.forceRadial=function(radius,x,y){var nodes,strengths,radiuses,strength=constant(.1);function force(alpha){for(var i=0,n=nodes.length;i<n;++i){var node=nodes[i],dx=node.x-x||1e-6,dy=node.y-y||1e-6,r=Math.sqrt(dx*dx+dy*dy),k=(radiuses[i]-r)*strengths[i]*alpha/r;node.vx+=dx*k,node.vy+=dy*k}}function initialize(){if(nodes){var i,n=nodes.length;for(strengths=new Array(n),radiuses=new Array(n),i=0;i<n;++i)radiuses[i]=+radius(nodes[i],i,nodes),strengths[i]=isNaN(radiuses[i])?0:+strength(nodes[i],i,nodes)}}return"function"!=typeof radius&&(radius=constant(+radius)),null==x&&(x=0),null==y&&(y=0),force.initialize=function(_){nodes=_,initialize()},force.strength=function(_){return arguments.length?(strength="function"==typeof _?_:constant(+_),initialize(),force):strength},force.radius=function(_){return arguments.length?(radius="function"==typeof _?_:constant(+_),initialize(),force):radius},force.x=function(_){return arguments.length?(x=+_,force):x},force.y=function(_){return arguments.length?(y=+_,force):y},force},exports.forceSimulation=function(nodes){var simulation,alpha=1,alphaMin=.001,alphaDecay=1-Math.pow(alphaMin,1/300),alphaTarget=0,velocityDecay=.6,forces=d3Collection.map(),stepper=d3Timer.timer(step),event=d3Dispatch.dispatch("tick","end");function step(){tick(),event.call("tick",simulation),alpha<alphaMin&&(stepper.stop(),event.call("end",simulation))}function tick(){var i,node,n=nodes.length;for(alpha+=(alphaTarget-alpha)*alphaDecay,forces.each(function(force){force(alpha)}),i=0;i<n;++i)null==(node=nodes[i]).fx?node.x+=node.vx*=velocityDecay:(node.x=node.fx,node.vx=0),null==node.fy?node.y+=node.vy*=velocityDecay:(node.y=node.fy,node.vy=0)}function initializeNodes(){for(var node,i=0,n=nodes.length;i<n;++i){if((node=nodes[i]).index=i,isNaN(node.x)||isNaN(node.y)){var radius=initialRadius*Math.sqrt(i),angle=i*initialAngle;node.x=radius*Math.cos(angle),node.y=radius*Math.sin(angle)}(isNaN(node.vx)||isNaN(node.vy))&&(node.vx=node.vy=0)}}function initializeForce(force){return force.initialize&&force.initialize(nodes),force}return null==nodes&&(nodes=[]),initializeNodes(),simulation={tick:tick,restart:function(){return stepper.restart(step),simulation},stop:function(){return stepper.stop(),simulation},nodes:function(_){return arguments.length?(nodes=_,initializeNodes(),forces.each(initializeForce),simulation):nodes},alpha:function(_){return arguments.length?(alpha=+_,simulation):alpha},alphaMin:function(_){return arguments.length?(alphaMin=+_,simulation):alphaMin},alphaDecay:function(_){return arguments.length?(alphaDecay=+_,simulation):+alphaDecay},alphaTarget:function(_){return arguments.length?(alphaTarget=+_,simulation):alphaTarget},velocityDecay:function(_){return arguments.length?(velocityDecay=1-_,simulation):1-velocityDecay},force:function(name,_){return arguments.length>1?(null==_?forces.remove(name):forces.set(name,initializeForce(_)),simulation):forces.get(name)},find:function(x,y,radius){var dx,dy,d2,node,closest,i=0,n=nodes.length;for(null==radius?radius=1/0:radius*=radius,i=0;i<n;++i)(d2=(dx=x-(node=nodes[i]).x)*dx+(dy=y-node.y)*dy)<radius&&(closest=node,radius=d2);return closest},on:function(name,_){return arguments.length>1?(event.on(name,_),simulation):event.on(name)}}},exports.forceX=function(x){var nodes,strengths,xz,strength=constant(.1);function force(alpha){for(var node,i=0,n=nodes.length;i<n;++i)(node=nodes[i]).vx+=(xz[i]-node.x)*strengths[i]*alpha}function initialize(){if(nodes){var i,n=nodes.length;for(strengths=new Array(n),xz=new Array(n),i=0;i<n;++i)strengths[i]=isNaN(xz[i]=+x(nodes[i],i,nodes))?0:+strength(nodes[i],i,nodes)}}return"function"!=typeof x&&(x=constant(null==x?0:+x)),force.initialize=function(_){nodes=_,initialize()},force.strength=function(_){return arguments.length?(strength="function"==typeof _?_:constant(+_),initialize(),force):strength},force.x=function(_){return arguments.length?(x="function"==typeof _?_:constant(+_),initialize(),force):x},force},exports.forceY=function(y){var nodes,strengths,yz,strength=constant(.1);function force(alpha){for(var node,i=0,n=nodes.length;i<n;++i)(node=nodes[i]).vy+=(yz[i]-node.y)*strengths[i]*alpha}function initialize(){if(nodes){var i,n=nodes.length;for(strengths=new Array(n),yz=new Array(n),i=0;i<n;++i)strengths[i]=isNaN(yz[i]=+y(nodes[i],i,nodes))?0:+strength(nodes[i],i,nodes)}}return"function"!=typeof y&&(y=constant(null==y?0:+y)),force.initialize=function(_){nodes=_,initialize()},force.strength=function(_){return arguments.length?(strength="function"==typeof _?_:constant(+_),initialize(),force):strength},force.y=function(_){return arguments.length?(y="function"==typeof _?_:constant(+_),initialize(),force):y},force},Object.defineProperty(exports,"__esModule",{value:!0})}),_$d3Force_123=_$d3Force_123.exports;var d3sankey=_$d3Sankey_41.sankey,__keyFun_860=_$gup_536.keyFun,__repeat_860=_$gup_536.repeat,__unwrap_860=_$gup_536.unwrap;function saveCurrentDragPosition(d){d.lastDraggedX=d.x,d.lastDraggedY=d.y}function sameLayer(d){return function(n){return n.node.originalX===d.node.originalX}}function switchToForceFormat(nodes){for(var i=0;i<nodes.length;i++)nodes[i].y=nodes[i].y+nodes[i].dy/2}function updateNodePositions(sankeyNode){sankeyNode.attr("transform",function(d){return"translate("+d.node.x.toFixed(3)+", "+(d.node.y-d.node.dy/2).toFixed(3)+")"})}function linkPath(d){var nodes=d.sankey.nodes();!function switchToSankeyFormat(nodes){for(var i=0;i<nodes.length;i++)nodes[i].y=nodes[i].y-nodes[i].dy/2}(nodes);var result=d.sankey.link()(d.link);return switchToForceFormat(nodes),result}function updateNodeShapes(sankeyNode){sankeyNode.call(updateNodePositions)}function updateShapes(sankeyNode,sankeyLink){sankeyNode.call(updateNodeShapes),sankeyLink.attr("d",linkPath)}function sizeNode(rect){rect.attr("width",function(d){return d.visibleWidth}).attr("height",function(d){return d.visibleHeight})}function salientEnough(d){return d.link.dy>1||d.linkLineWidth>0}function sankeyTransform(d){return"translate("+d.translateX+","+d.translateY+")"+(d.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function nodeCentering(d){return"translate("+(d.horizontal?0:d.labelY)+" "+(d.horizontal?d.labelY:0)+")"}function textGuidePath(d){return _$d3_127.svg.line()([[d.horizontal?d.left?-d.sizeAcross:d.visibleWidth+_$constants_856.nodeTextOffsetHorizontal:_$constants_856.nodeTextOffsetHorizontal,0],[d.horizontal?d.left?-_$constants_856.nodeTextOffsetHorizontal:d.sizeAcross:d.visibleHeight-_$constants_856.nodeTextOffsetHorizontal,0]])}function sankeyInverseTransform(d){return d.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)"}function textFlip(d){return d.horizontal?"scale(1 1)":"scale(-1 1)"}function nodeTextColor(d){return d.darkBackground&&!d.horizontal?"rgb(255,255,255)":"rgb(0,0,0)"}function nodeTextOffset(d){return d.horizontal&&d.left?"100%":"0%"}function attachPointerEvents(selection,sankey,eventSet){selection.on(".basic",null).on("mouseover.basic",function(d){d.interactionState.dragInProgress||(eventSet.hover(this,d,sankey),d.interactionState.hovered=[this,d])}).on("mousemove.basic",function(d){d.interactionState.dragInProgress||(eventSet.follow(this,d),d.interactionState.hovered=[this,d])}).on("mouseout.basic",function(d){d.interactionState.dragInProgress||(eventSet.unhover(this,d,sankey),d.interactionState.hovered=!1)}).on("click.basic",function(d){d.interactionState.hovered&&(eventSet.unhover(this,d,sankey),d.interactionState.hovered=!1),d.interactionState.dragInProgress||eventSet.select(this,d,sankey)})}function attachDragHandler(sankeyNode,sankeyLink,callbacks){var dragBehavior=_$d3_127.behavior.drag().origin(function(d){return d.node}).on("dragstart",function(d){if("fixed"!==d.arrangement&&(_$lib_539.raiseToTop(this),d.interactionState.dragInProgress=d.node,saveCurrentDragPosition(d.node),d.interactionState.hovered&&(callbacks.nodeEvents.unhover.apply(0,d.interactionState.hovered),d.interactionState.hovered=!1),"snap"===d.arrangement)){var forceKey=d.traceId+"|"+Math.floor(d.node.originalX);d.forceLayouts[forceKey]?d.forceLayouts[forceKey].alpha(1):function attachForce(sankeyNode,forceKey,d){var nodes=d.sankey.nodes().filter(function(n){return n.originalX===d.node.originalX});d.forceLayouts[forceKey]=_$d3Force_123.forceSimulation(nodes).alphaDecay(0).force("collide",_$d3Force_123.forceCollide().radius(function(n){return n.dy/2+d.nodePad/2}).strength(1).iterations(_$constants_856.forceIterations)).force("constrain",function snappingForce(sankeyNode,forceKey,nodes,d){return function _snappingForce(){for(var maxVelocity=0,i=0;i<nodes.length;i++){var n=nodes[i];n===d.interactionState.dragInProgress?(n.x=n.lastDraggedX,n.y=n.lastDraggedY):(n.vx=(n.originalX-n.x)/_$constants_856.forceTicksPerFrame,n.y=Math.min(d.size-n.dy/2,Math.max(n.dy/2,n.y))),maxVelocity=Math.max(maxVelocity,Math.abs(n.vx),Math.abs(n.vy))}!d.interactionState.dragInProgress&&maxVelocity<.1&&d.forceLayouts[forceKey].alpha()>0&&d.forceLayouts[forceKey].alpha(0)}}(0,forceKey,nodes,d)).stop()}(0,forceKey,d),function startForce(sankeyNode,sankeyLink,d,forceKey){window.requestAnimationFrame(function faster(){for(var i=0;i<_$constants_856.forceTicksPerFrame;i++)d.forceLayouts[forceKey].tick();d.sankey.relayout(),updateShapes(sankeyNode.filter(sameLayer(d)),sankeyLink),d.forceLayouts[forceKey].alpha()>0&&window.requestAnimationFrame(faster)})}(sankeyNode,sankeyLink,d,forceKey)}}).on("drag",function(d){if("fixed"!==d.arrangement){var x=_$d3_127.event.x,y=_$d3_127.event.y;"snap"===d.arrangement?(d.node.x=x,d.node.y=y):("freeform"===d.arrangement&&(d.node.x=x),d.node.y=Math.max(d.node.dy/2,Math.min(d.size-d.node.dy/2,y))),saveCurrentDragPosition(d.node),"snap"!==d.arrangement&&(d.sankey.relayout(),updateShapes(sankeyNode.filter(sameLayer(d)),sankeyLink))}}).on("dragend",function(d){d.interactionState.dragInProgress=!1});sankeyNode.on(".drag",null).call(dragBehavior)}var _$render_860=function(svg,styledData,layout,callbacks){var sankey=svg.selectAll("."+_$constants_856.cn.sankey).data(styledData.filter(function(d){return __unwrap_860(d).trace.visible}).map(function sankeyModel(layout,d,i){for(var node,trace=__unwrap_860(d).trace,domain=trace.domain,nodeSpec=trace.node,linkSpec=trace.link,arrangement=trace.arrangement,horizontal="h"===trace.orientation,nodePad=trace.node.pad,nodeThickness=trace.node.thickness,nodeLineColor=trace.node.line.color,nodeLineWidth=trace.node.line.width,linkLineColor=trace.link.line.color,linkLineWidth=trace.link.line.width,valueFormat=trace.valueformat,valueSuffix=trace.valuesuffix,textFont=trace.textfont,width=layout.width*(domain.x[1]-domain.x[0]),height=layout.height*(domain.y[1]-domain.y[0]),nodes=nodeSpec.label.map(function(l,i){return{pointNumber:i,label:l,color:_$lib_539.isArrayOrTypedArray(nodeSpec.color)?nodeSpec.color[i]:nodeSpec.color}}),links=linkSpec.value.map(function(d,i){return{pointNumber:i,label:linkSpec.label[i],color:_$lib_539.isArrayOrTypedArray(linkSpec.color)?linkSpec.color[i]:linkSpec.color,source:linkSpec.source[i],target:linkSpec.target[i],value:d}}),sankey=d3sankey().size(horizontal?[width,height]:[height,width]).nodeWidth(nodeThickness).nodePadding(nodePad).nodes(nodes).links(links).layout(_$constants_856.sankeyIterations),sankeyNodes=sankey.nodes(),n=0;n<sankeyNodes.length;n++)(node=sankeyNodes[n]).width=width,node.height=height;return switchToForceFormat(nodes),{key:i,trace:trace,guid:Math.floor(1e12*(1+Math.random())),horizontal:horizontal,width:width,height:height,nodePad:nodePad,nodeLineColor:nodeLineColor,nodeLineWidth:nodeLineWidth,linkLineColor:linkLineColor,linkLineWidth:linkLineWidth,valueFormat:valueFormat,valueSuffix:valueSuffix,textFont:textFont,translateX:domain.x[0]*width+layout.margin.l,translateY:layout.height-domain.y[1]*layout.height+layout.margin.t,dragParallel:horizontal?height:width,dragPerpendicular:horizontal?width:height,nodes:nodes,links:links,arrangement:arrangement,sankey:sankey,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}.bind(null,layout)),__keyFun_860);sankey.exit().remove(),sankey.enter().append("g").classed(_$constants_856.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").style("box-sizing","content-box").attr("transform",sankeyTransform),sankey.transition().ease(_$constants_856.ease).duration(_$constants_856.duration).attr("transform",sankeyTransform);var sankeyLinks=sankey.selectAll("."+_$constants_856.cn.sankeyLinks).data(__repeat_860,__keyFun_860);sankeyLinks.enter().append("g").classed(_$constants_856.cn.sankeyLinks,!0).style("fill","none");var sankeyLink=sankeyLinks.selectAll("."+_$constants_856.cn.sankeyLink).data(function(d){return d.sankey.links().filter(function(l){return l.value}).map(function linkModel(uniqueKeys,d,l){var tc=_$tinycolor_352(l.color),basicKey=l.source.label+"|"+l.target.label,foundKey=uniqueKeys[basicKey];uniqueKeys[basicKey]=(foundKey||0)+1;var key=basicKey+"__"+uniqueKeys[basicKey];return l.trace=d.trace,l.curveNumber=d.trace.index,{key:key,traceId:d.key,link:l,tinyColorHue:_$color_411.tinyRGB(tc),tinyColorAlpha:tc.getAlpha(),linkLineColor:d.linkLineColor,linkLineWidth:d.linkLineWidth,valueFormat:d.valueFormat,valueSuffix:d.valueSuffix,sankey:d.sankey,interactionState:d.interactionState}}.bind(null,{},d))},__keyFun_860);sankeyLink.enter().append("path").classed(_$constants_856.cn.sankeyLink,!0).attr("d",linkPath).call(attachPointerEvents,sankey,callbacks.linkEvents),sankeyLink.style("stroke",function(d){return salientEnough(d)?_$color_411.tinyRGB(_$tinycolor_352(d.linkLineColor)):d.tinyColorHue}).style("stroke-opacity",function(d){return salientEnough(d)?_$color_411.opacity(d.linkLineColor):d.tinyColorAlpha}).style("stroke-width",function(d){return salientEnough(d)?d.linkLineWidth:1}).style("fill",function(d){return d.tinyColorHue}).style("fill-opacity",function(d){return d.tinyColorAlpha}),sankeyLink.transition().ease(_$constants_856.ease).duration(_$constants_856.duration).attr("d",linkPath),sankeyLink.exit().transition().ease(_$constants_856.ease).duration(_$constants_856.duration).style("opacity",0).remove();var sankeyNodeSet=sankey.selectAll("."+_$constants_856.cn.sankeyNodeSet).data(__repeat_860,__keyFun_860);sankeyNodeSet.enter().append("g").classed(_$constants_856.cn.sankeyNodeSet,!0),sankeyNodeSet.style("cursor",function(d){switch(d.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var sankeyNode=sankeyNodeSet.selectAll("."+_$constants_856.cn.sankeyNode).data(function(d){var nodes=d.sankey.nodes();return function persistOriginalPlace(nodes){var i,distinctLayerPositions=[];for(i=0;i<nodes.length;i++)nodes[i].originalX=nodes[i].x,nodes[i].originalY=nodes[i].y,-1===distinctLayerPositions.indexOf(nodes[i].x)&&distinctLayerPositions.push(nodes[i].x);for(distinctLayerPositions.sort(function(a,b){return a-b}),i=0;i<nodes.length;i++)nodes[i].originalLayerIndex=distinctLayerPositions.indexOf(nodes[i].originalX),nodes[i].originalLayer=nodes[i].originalLayerIndex/(distinctLayerPositions.length-1)}(nodes),nodes.filter(function(n){return n.value}).map(function nodeModel(uniqueKeys,d,n){var tc=_$tinycolor_352(n.color),zoneThicknessPad=_$constants_856.nodePadAcross,zoneLengthPad=d.nodePad/2,visibleThickness=n.dx,visibleLength=Math.max(.5,n.dy),basicKey=n.label,foundKey=uniqueKeys[basicKey];uniqueKeys[basicKey]=(foundKey||0)+1;var key=basicKey+"__"+uniqueKeys[basicKey];return n.trace=d.trace,n.curveNumber=d.trace.index,{key:key,traceId:d.key,node:n,nodePad:d.nodePad,nodeLineColor:d.nodeLineColor,nodeLineWidth:d.nodeLineWidth,textFont:d.textFont,size:d.horizontal?d.height:d.width,visibleWidth:Math.ceil(visibleThickness),visibleHeight:visibleLength,zoneX:-zoneThicknessPad,zoneY:-zoneLengthPad,zoneWidth:visibleThickness+2*zoneThicknessPad,zoneHeight:visibleLength+2*zoneLengthPad,labelY:d.horizontal?n.dy/2+1:n.dx/2+1,left:1===n.originalLayer,sizeAcross:d.width,forceLayouts:d.forceLayouts,horizontal:d.horizontal,darkBackground:tc.getBrightness()<=128,tinyColorHue:_$color_411.tinyRGB(tc),tinyColorAlpha:tc.getAlpha(),valueFormat:d.valueFormat,valueSuffix:d.valueSuffix,sankey:d.sankey,arrangement:d.arrangement,uniqueNodeLabelPathId:[d.guid,d.key,key].join(" "),interactionState:d.interactionState}}.bind(null,{},d))},__keyFun_860);sankeyNode.enter().append("g").classed(_$constants_856.cn.sankeyNode,!0).call(updateNodePositions).call(attachPointerEvents,sankey,callbacks.nodeEvents),sankeyNode.call(attachDragHandler,sankeyLink,callbacks),sankeyNode.transition().ease(_$constants_856.ease).duration(_$constants_856.duration).call(updateNodePositions),sankeyNode.exit().transition().ease(_$constants_856.ease).duration(_$constants_856.duration).style("opacity",0).remove();var nodeRect=sankeyNode.selectAll("."+_$constants_856.cn.nodeRect).data(__repeat_860);nodeRect.enter().append("rect").classed(_$constants_856.cn.nodeRect,!0).call(sizeNode),nodeRect.style("stroke-width",function(d){return d.nodeLineWidth}).style("stroke",function(d){return _$color_411.tinyRGB(_$tinycolor_352(d.nodeLineColor))}).style("stroke-opacity",function(d){return _$color_411.opacity(d.nodeLineColor)}).style("fill",function(d){return d.tinyColorHue}).style("fill-opacity",function(d){return d.tinyColorAlpha}),nodeRect.transition().ease(_$constants_856.ease).duration(_$constants_856.duration).call(sizeNode);var nodeCapture=sankeyNode.selectAll("."+_$constants_856.cn.nodeCapture).data(__repeat_860);nodeCapture.enter().append("rect").classed(_$constants_856.cn.nodeCapture,!0).style("fill-opacity",0),nodeCapture.attr("x",function(d){return d.zoneX}).attr("y",function(d){return d.zoneY}).attr("width",function(d){return d.zoneWidth}).attr("height",function(d){return d.zoneHeight});var nodeCentered=sankeyNode.selectAll("."+_$constants_856.cn.nodeCentered).data(__repeat_860);nodeCentered.enter().append("g").classed(_$constants_856.cn.nodeCentered,!0).attr("transform",nodeCentering),nodeCentered.transition().ease(_$constants_856.ease).duration(_$constants_856.duration).attr("transform",nodeCentering);var nodeLabelGuide=nodeCentered.selectAll("."+_$constants_856.cn.nodeLabelGuide).data(__repeat_860);nodeLabelGuide.enter().append("path").classed(_$constants_856.cn.nodeLabelGuide,!0).attr("id",function(d){return d.uniqueNodeLabelPathId}).attr("d",textGuidePath).attr("transform",sankeyInverseTransform),nodeLabelGuide.transition().ease(_$constants_856.ease).duration(_$constants_856.duration).attr("d",textGuidePath).attr("transform",sankeyInverseTransform);var nodeLabel=nodeCentered.selectAll("."+_$constants_856.cn.nodeLabel).data(__repeat_860);nodeLabel.enter().append("text").classed(_$constants_856.cn.nodeLabel,!0).attr("transform",textFlip).style("user-select","none").style("cursor","default").style("fill","black"),nodeLabel.style("text-shadow",function(d){return d.horizontal?"-1px 1px 1px #fff, 1px 1px 1px #fff, 1px -1px 1px #fff, -1px -1px 1px #fff":"none"}).each(function(d){_$drawing_436.font(nodeLabel,d.textFont)}),nodeLabel.transition().ease(_$constants_856.ease).duration(_$constants_856.duration).attr("transform",textFlip);var nodeLabelTextPath=nodeLabel.selectAll("."+_$constants_856.cn.nodeLabelTextPath).data(__repeat_860);nodeLabelTextPath.enter().append("textPath").classed(_$constants_856.cn.nodeLabelTextPath,!0).attr("alignment-baseline","middle").attr("xlink:href",function(d){return"#"+d.uniqueNodeLabelPathId}).attr("startOffset",nodeTextOffset).style("fill",nodeTextColor),nodeLabelTextPath.text(function(d){return d.horizontal||d.node.dy>5?d.node.label:""}).attr("text-anchor",function(d){return d.horizontal&&d.left?"end":"start"}),nodeLabelTextPath.transition().ease(_$constants_856.ease).duration(_$constants_856.duration).attr("startOffset",nodeTextOffset).style("fill",nodeTextColor)},__cn_859=_$constants_856.cn,____859=_$lib_539._;function renderableValuePresent(d){return""!==d}function ownTrace(selection,d){return selection.filter(function(s){return s.key===d.traceId})}function makeTranslucent(element,alpha){_$d3_127.select(element).select("path").style("fill-opacity",alpha),_$d3_127.select(element).select("rect").style("fill-opacity",alpha)}function makeTextContrasty(element){_$d3_127.select(element).select("text.name").style("fill","black")}function relatedLinks(d){return function(l){return-1!==d.node.sourceLinks.indexOf(l.link)||-1!==d.node.targetLinks.indexOf(l.link)}}function relatedNodes(l){return function(d){return-1!==d.node.sourceLinks.indexOf(l.link)||-1!==d.node.targetLinks.indexOf(l.link)}}function nodeHoveredStyle(sankeyNode,d,sankey){d&&sankey&&ownTrace(sankey,d).selectAll("."+__cn_859.sankeyLink).filter(relatedLinks(d)).call(linkHoveredStyle.bind(0,d,sankey,!1))}function nodeNonHoveredStyle(sankeyNode,d,sankey){d&&sankey&&ownTrace(sankey,d).selectAll("."+__cn_859.sankeyLink).filter(relatedLinks(d)).call(linkNonHoveredStyle.bind(0,d,sankey,!1))}function linkHoveredStyle(d,sankey,visitNodes,sankeyLink){var label=sankeyLink.datum().link.label;sankeyLink.style("fill-opacity",.4),label&&ownTrace(sankey,d).selectAll("."+__cn_859.sankeyLink).filter(function(l){return l.link.label===label}).style("fill-opacity",.4),visitNodes&&ownTrace(sankey,d).selectAll("."+__cn_859.sankeyNode).filter(relatedNodes(d)).call(nodeHoveredStyle)}function linkNonHoveredStyle(d,sankey,visitNodes,sankeyLink){var label=sankeyLink.datum().link.label;sankeyLink.style("fill-opacity",function(d){return d.tinyColorAlpha}),label&&ownTrace(sankey,d).selectAll("."+__cn_859.sankeyLink).filter(function(l){return l.link.label===label}).style("fill-opacity",function(d){return d.tinyColorAlpha}),visitNodes&&ownTrace(sankey,d).selectAll(__cn_859.sankeyNode).filter(relatedNodes(d)).call(nodeNonHoveredStyle)}function __castHoverOption_859(trace,attr){var labelOpts=trace.hoverlabel||{},val=_$lib_539.nestedProperty(labelOpts,attr).get();return!Array.isArray(val)&&val}var _$plot_859=function plot(gd,calcData){var fullLayout=gd._fullLayout,svg=fullLayout._paper,size=fullLayout._size,sourceLabel=____859(gd,"source:")+" ",targetLabel=____859(gd,"target:")+" ",incomingLabel=____859(gd,"incoming flow count:")+" ",outgoingLabel=____859(gd,"outgoing flow count:")+" ";_$render_860(svg,calcData,{width:size.w,height:size.h,margin:{t:size.t,r:size.r,b:size.b,l:size.l}},{linkEvents:{hover:function(element,d,sankey){_$d3_127.select(element).call(linkHoveredStyle.bind(0,d,sankey,!0)),gd.emit("plotly_hover",{event:_$d3_127.event,points:[d.link]})},follow:function(element,d){var trace=d.link.trace,rootBBox=gd._fullLayout._paperdiv.node().getBoundingClientRect(),boundingBox=element.getBoundingClientRect(),hoverCenterX=boundingBox.left+boundingBox.width/2,hoverCenterY=boundingBox.top+boundingBox.height/2,tooltip=_$fx_453.loneHover({x:hoverCenterX-rootBBox.left,y:hoverCenterY-rootBBox.top,name:_$d3_127.format(d.valueFormat)(d.link.value)+d.valueSuffix,text:[d.link.label||"",sourceLabel+d.link.source.label,targetLabel+d.link.target.label].filter(renderableValuePresent).join("<br>"),color:__castHoverOption_859(trace,"bgcolor")||_$color_411.addOpacity(d.tinyColorHue,1),borderColor:__castHoverOption_859(trace,"bordercolor"),fontFamily:__castHoverOption_859(trace,"font.family"),fontSize:__castHoverOption_859(trace,"font.size"),fontColor:__castHoverOption_859(trace,"font.color"),idealAlign:_$d3_127.event.x<hoverCenterX?"right":"left"},{container:fullLayout._hoverlayer.node(),outerContainer:fullLayout._paper.node(),gd:gd});makeTranslucent(tooltip,.65),makeTextContrasty(tooltip)},unhover:function(element,d,sankey){_$d3_127.select(element).call(linkNonHoveredStyle.bind(0,d,sankey,!0)),gd.emit("plotly_unhover",{event:_$d3_127.event,points:[d.link]}),_$fx_453.loneUnhover(fullLayout._hoverlayer.node())},select:function(element,d){var evt=d.link;evt.originalEvent=_$d3_127.event,gd._hoverdata=[evt],_$fx_453.click(gd,{target:!0})}},nodeEvents:{hover:function(element,d,sankey){_$d3_127.select(element).call(nodeHoveredStyle,d,sankey),gd.emit("plotly_hover",{event:_$d3_127.event,points:[d.node]})},follow:function(element,d){var trace=d.node.trace,nodeRect=_$d3_127.select(element).select("."+__cn_859.nodeRect),rootBBox=gd._fullLayout._paperdiv.node().getBoundingClientRect(),boundingBox=nodeRect.node().getBoundingClientRect(),hoverCenterX0=boundingBox.left-2-rootBBox.left,hoverCenterX1=boundingBox.right+2-rootBBox.left,hoverCenterY=boundingBox.top+boundingBox.height/4-rootBBox.top,tooltip=_$fx_453.loneHover({x0:hoverCenterX0,x1:hoverCenterX1,y:hoverCenterY,name:_$d3_127.format(d.valueFormat)(d.node.value)+d.valueSuffix,text:[d.node.label,incomingLabel+d.node.targetLinks.length,outgoingLabel+d.node.sourceLinks.length].filter(renderableValuePresent).join("<br>"),color:__castHoverOption_859(trace,"bgcolor")||d.tinyColorHue,borderColor:__castHoverOption_859(trace,"bordercolor"),fontFamily:__castHoverOption_859(trace,"font.family"),fontSize:__castHoverOption_859(trace,"font.size"),fontColor:__castHoverOption_859(trace,"font.color"),idealAlign:"left"},{container:fullLayout._hoverlayer.node(),outerContainer:fullLayout._paper.node(),gd:gd});makeTranslucent(tooltip,.85),makeTextContrasty(tooltip)},unhover:function(element,d,sankey){_$d3_127.select(element).call(nodeNonHoveredStyle,d,sankey),gd.emit("plotly_unhover",{event:_$d3_127.event,points:[d.node]}),_$fx_453.loneUnhover(fullLayout._hoverlayer.node())},select:function(element,d,sankey){var evt=d.node;evt.originalEvent=_$d3_127.event,gd._hoverdata=[evt],_$d3_127.select(element).call(nodeNonHoveredStyle,d,sankey),_$fx_453.click(gd,{target:!0})}}})},_$base_plot_854={},__overrideAll_854=_$edit_types_569.overrideAll,__getModuleCalcData_854=_$get_data_621.getModuleCalcData;_$base_plot_854.name="sankey",_$base_plot_854.baseLayoutAttrOverrides=__overrideAll_854({hoverlabel:_$layout_attributes_454.hoverlabel},"plot","nested"),_$base_plot_854.plot=function(gd){var calcData=__getModuleCalcData_854(gd.calcdata,"sankey");_$plot_859(gd,calcData)},_$base_plot_854.clean=function(newFullData,newFullLayout,oldFullData,oldFullLayout){var hadPlot=oldFullLayout._has&&oldFullLayout._has("sankey"),hasPlot=newFullLayout._has&&newFullLayout._has("sankey");hadPlot&&!hasPlot&&oldFullLayout._paperdiv.selectAll(".sankey").remove()};var _$stronglyConnectedComponents_344=function stronglyConnectedComponents(adjList){for(var numVertices=adjList.length,index=new Array(numVertices),lowValue=new Array(numVertices),active=new Array(numVertices),child=new Array(numVertices),scc=new Array(numVertices),sccLinks=new Array(numVertices),i=0;i<numVertices;++i)index[i]=-1,lowValue[i]=0,active[i]=!1,child[i]=0,scc[i]=-1,sccLinks[i]=[];var newE,count=0,components=[],sccAdjList=[];function strongConnect(v){var S=[v],T=[v];for(index[v]=lowValue[v]=count,active[v]=!0,count+=1;T.length>0;){v=T[T.length-1];var e=adjList[v];if(child[v]<e.length){for(var i=child[v];i<e.length;++i){var u=e[i];if(index[u]<0){index[u]=lowValue[u]=count,active[u]=!0,count+=1,S.push(u),T.push(u);break}active[u]&&(lowValue[v]=0|Math.min(lowValue[v],lowValue[u])),scc[u]>=0&&sccLinks[v].push(scc[u])}child[v]=i}else{if(lowValue[v]===index[v]){for(var component=[],links=[],linkCount=0,i=S.length-1;i>=0;--i){var w=S[i];if(active[w]=!1,component.push(w),links.push(sccLinks[w]),linkCount+=sccLinks[w].length,scc[w]=components.length,w===v){S.length=i;break}}components.push(component);for(var allLinks=new Array(linkCount),i=0;i<links.length;i++)for(var j=0;j<links[i].length;j++)allLinks[--linkCount]=links[i][j];sccAdjList.push(allLinks)}T.pop()}}}for(var i=0;i<numVertices;++i)index[i]<0&&strongConnect(i);for(var i=0;i<sccAdjList.length;i++){var e=sccAdjList[i];if(0!==e.length){e.sort(function(a,b){return a-b}),newE=[e[0]];for(var j=1;j<e.length;j++)e[j]!==e[j-1]&&newE.push(e[j]);sccAdjList[i]=newE}}return{components:components,adjacencyList:sccAdjList}};var __wrap_855=_$gup_536.wrap;var __handleDomainDefaults_857=_$domain_610.defaults,Plot={};Plot.attributes=_$attributes_853,Plot.supplyDefaults=function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_853,attr,dflt)}coerce("node.label"),coerce("node.pad"),coerce("node.thickness"),coerce("node.line.color"),coerce("node.line.width");var colors=layout.colorway;coerce("node.color",traceOut.node.label.map(function(d,i){return _$color_411.addOpacity(function(i){return colors[i%colors.length]}(i),.8)})),coerce("link.label"),coerce("link.source"),coerce("link.target"),coerce("link.value"),coerce("link.line.color"),coerce("link.line.width"),coerce("link.color",traceOut.link.value.map(function(){return _$tinycolor_352(layout.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)"})),__handleDomainDefaults_857(traceOut,layout,coerce),coerce("orientation"),coerce("valueformat"),coerce("valuesuffix"),coerce("arrangement"),_$lib_539.coerceFont(coerce,"textfont",_$lib_539.extendFlat({},layout.font));traceOut.node.label.some(function(n,i){return-1===traceOut.link.source.indexOf(i)&&-1===traceOut.link.target.indexOf(i)})&&_$lib_539.warn("Some of the nodes are neither sources nor targets, they will not be displayed.")},Plot.calc=function calc(gd,trace){return function circularityPresent(nodeList,sources,targets){for(var nodes=nodeList.map(function(){return[]}),i=0;i<Math.min(sources.length,targets.length);i++){if(sources[i]===targets[i])return!0;nodes[sources[i]].push(targets[i])}return _$stronglyConnectedComponents_344(nodes).components.some(function(c){return c.length>1})}(trace.node.label,trace.link.source,trace.link.target)&&(_$lib_539.error("Circularity is present in the Sankey data. Removing all nodes and links."),trace.link.label=[],trace.link.source=[],trace.link.target=[],trace.link.value=[],trace.link.color=[],trace.node.label=[],trace.node.color=[]),__wrap_855({link:trace.link,node:trace.node})},Plot.plot=_$plot_859,Plot.moduleType="trace",Plot.name="sankey",Plot.basePlotModule=_$base_plot_854,Plot.categories=["noOpacity"],Plot.meta={};var _$sankey_26=Plot,_$gl3d_markers_515={circle:"●","circle-open":"○",square:"■","square-open":"□",diamond:"◆","diamond-open":"◇",cross:"+",x:"❌"},_$gl3d_dashes_514={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]},_$attributes_887={},__extendFlat_887=_$extend_528.extendFlat,__overrideAll_887=_$edit_types_569.overrideAll,__scatterLineAttrs_887=_$attributes_862.line,__scatterMarkerAttrs_887=_$attributes_862.marker,__scatterMarkerLineAttrs_887=__scatterMarkerAttrs_887.line;var __attrs_887=_$attributes_887=__overrideAll_887({x:_$attributes_862.x,y:_$attributes_862.y,z:{valType:"data_array"},text:__extendFlat_887({},_$attributes_862.text,{}),hovertext:__extendFlat_887({},_$attributes_862.hovertext,{}),mode:__extendFlat_887({},_$attributes_862.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},y:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},z:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}},connectgaps:_$attributes_862.connectgaps,line:__extendFlat_887({width:__scatterLineAttrs_887.width,dash:{valType:"enumerated",values:Object.keys(_$gl3d_dashes_514),dflt:"solid"},showscale:{valType:"boolean",dflt:!1}},_$makeColorScaleAttributes_419()),marker:__extendFlat_887({symbol:{valType:"enumerated",values:Object.keys(_$gl3d_markers_515),dflt:"circle",arrayOk:!0},size:__extendFlat_887({},__scatterMarkerAttrs_887.size,{dflt:8}),sizeref:__scatterMarkerAttrs_887.sizeref,sizemin:__scatterMarkerAttrs_887.sizemin,sizemode:__scatterMarkerAttrs_887.sizemode,opacity:__extendFlat_887({},__scatterMarkerAttrs_887.opacity,{arrayOk:!1}),showscale:__scatterMarkerAttrs_887.showscale,colorbar:__scatterMarkerAttrs_887.colorbar,line:__extendFlat_887({width:__extendFlat_887({},__scatterMarkerLineAttrs_887.width,{arrayOk:!1})},_$makeColorScaleAttributes_419())},_$makeColorScaleAttributes_419()),textposition:__extendFlat_887({},_$attributes_862.textposition,{dflt:"top center"}),textfont:_$attributes_862.textfont,hoverinfo:__extendFlat_887({},_$attributes_581.hoverinfo)},"calc","nested");__attrs_887.x.editType=__attrs_887.y.editType=__attrs_887.z.editType="calc+clearAxisTypes";var __vertSrc_157=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, offset;\nattribute vec4 color;\nuniform mat4 model, view, projection;\nuniform float capSize;\nvarying vec4 fragColor;\nvarying vec3 fragPosition;\n\nvoid main() {\n  vec4 worldPosition  = model * vec4(position, 1.0);\n  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);\n  gl_Position         = projection * view * worldPosition;\n  fragColor           = color;\n  fragPosition        = position;\n}"]),__fragSrc_157=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\nuniform vec3 clipBounds[2];\nuniform float opacity;\nvarying vec3 fragPosition;\nvarying vec4 fragColor;\n\nvoid main() {\n  if(any(lessThan(fragPosition, clipBounds[0])) || any(greaterThan(fragPosition, clipBounds[1]))) {\n    discard;\n  }\n  gl_FragColor = opacity * fragColor;\n}"]),_$shaders_157=function(gl){return _$createShader_206(gl,__vertSrc_157,__fragSrc_157,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])},_$createErrorBars_156=function createErrorBars(options){var gl=options.gl,buffer=_$createBuffer_153(gl),vao=_$createVAO_222(gl,[{buffer:buffer,type:gl.FLOAT,size:3,offset:0,stride:40},{buffer:buffer,type:gl.FLOAT,size:4,offset:12,stride:40},{buffer:buffer,type:gl.FLOAT,size:3,offset:28,stride:40}]),shader=_$shaders_157(gl);shader.attributes.position.location=0,shader.attributes.color.location=1,shader.attributes.offset.location=2;var result=new ErrorBars(gl,buffer,vao,shader);return result.update(options),result},IDENTITY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function ErrorBars(gl,buffer,vao,shader){this.gl=gl,this.shader=shader,this.buffer=buffer,this.vao=vao,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1}var __proto_156=ErrorBars.prototype;function updateBounds(bounds,point){for(var i=0;i<3;++i)bounds[0][i]=Math.min(bounds[0][i],point[i]),bounds[1][i]=Math.max(bounds[1][i],point[i])}__proto_156.isOpaque=function(){return this.opacity>=1},__proto_156.isTransparent=function(){return this.opacity<1},__proto_156.drawTransparent=__proto_156.draw=function(cameraParams){var gl=this.gl,uniforms=this.shader.uniforms;this.shader.bind();var view=uniforms.view=cameraParams.view||IDENTITY,projection=uniforms.projection=cameraParams.projection||IDENTITY;uniforms.model=cameraParams.model||IDENTITY,uniforms.clipBounds=this.clipBounds,uniforms.opacity=this.opacity;var cx=view[12],cy=view[13],cz=view[14],cw=view[15],pixelScaleF=this.pixelRatio*(projection[3]*cx+projection[7]*cy+projection[11]*cz+projection[15]*cw)/gl.drawingBufferHeight;this.vao.bind();for(var i=0;i<3;++i)gl.lineWidth(this.lineWidth[i]),uniforms.capSize=this.capSize[i]*pixelScaleF,this.lineCount[i]&&gl.drawArrays(gl.LINES,this.lineOffset[i],this.lineCount[i]);this.vao.unbind()};var FACE_TABLE=function(){for(var table=new Array(3),d=0;d<3;++d){for(var row=[],j=1;j<=2;++j)for(var s=-1;s<=1;s+=2){var y=[0,0,0];y[(j+d)%3]=s,row.push(y)}table[d]=row}return table}();function emitFace(verts,x,c,d){for(var offsets=FACE_TABLE[d],i=0;i<offsets.length;++i){var o=offsets[i];verts.push(x[0],x[1],x[2],c[0],c[1],c[2],c[3],o[0],o[1],o[2])}return offsets.length}__proto_156.update=function(options){"lineWidth"in(options=options||{})&&(this.lineWidth=options.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in options&&(this.capSize=options.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),"opacity"in options&&(this.opacity=options.opacity);var color=options.color||[[0,0,0],[0,0,0],[0,0,0]],position=options.position,error=options.error;if(Array.isArray(color[0])||(color=[color,color,color]),position&&error){var verts=[],n=position.length,vertexCount=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var j=0;j<3;++j){this.lineOffset[j]=vertexCount;i_loop:for(var i=0;i<n;++i){for(var p=position[i],k=0;k<3;++k)if(isNaN(p[k])||!isFinite(p[k]))continue i_loop;var e=error[i],c=color[j];if(Array.isArray(c[0])&&(c=color[i]),3===c.length&&(c=[c[0],c[1],c[2],1]),!isNaN(e[0][j])&&!isNaN(e[1][j])){var x;if(e[0][j]<0)(x=p.slice())[j]+=e[0][j],verts.push(p[0],p[1],p[2],c[0],c[1],c[2],c[3],0,0,0,x[0],x[1],x[2],c[0],c[1],c[2],c[3],0,0,0),updateBounds(this.bounds,x),vertexCount+=2+emitFace(verts,x,c,j);if(e[1][j]>0)(x=p.slice())[j]+=e[1][j],verts.push(p[0],p[1],p[2],c[0],c[1],c[2],c[3],0,0,0,x[0],x[1],x[2],c[0],c[1],c[2],c[3],0,0,0),updateBounds(this.bounds,x),vertexCount+=2+emitFace(verts,x,c,j)}}this.lineCount[j]=vertexCount-this.lineOffset[j]}this.buffer.update(verts)}},__proto_156.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()};var _$shaders_163={},__vertSrc_163=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, nextPosition;\nattribute float arcLength, lineWidth;\nattribute vec4 color;\n\nuniform vec2 screenShape;\nuniform float pixelRatio;\nuniform mat4 model, view, projection;\n\nvarying vec4 fragColor;\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\n\nvoid main() {\n  vec4 projected = projection * view * model * vec4(position, 1.0);\n  vec4 tangentClip = projection * view * model * vec4(nextPosition - position, 0.0);\n  vec2 tangent = normalize(screenShape * tangentClip.xy);\n  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(tangent.y, -tangent.x) / screenShape;\n\n  gl_Position = vec4(projected.xy + projected.w * offset, projected.zw);\n\n  worldPosition = position;\n  pixelArcLength = arcLength;\n  fragColor = color;\n}\n"]),forwardFrag=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3      clipBounds[2];\nuniform sampler2D dashTexture;\nuniform float     dashScale;\nuniform float     opacity;\n\nvarying vec3    worldPosition;\nvarying float   pixelArcLength;\nvarying vec4    fragColor;\n\nvoid main() {\n  if(any(lessThan(worldPosition, clipBounds[0])) || any(greaterThan(worldPosition, clipBounds[1]))) {\n    discard;\n  }\n  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;\n  if(dashWeight < 0.5) {\n    discard;\n  }\n  gl_FragColor = fragColor * opacity;\n}\n"]),pickFrag=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\n#define FLOAT_MAX  1.70141184e38\n#define FLOAT_MIN  1.17549435e-38\n\nlowp vec4 encode_float_1540259130(highp float v) {\n  highp float av = abs(v);\n\n  //Handle special cases\n  if(av < FLOAT_MIN) {\n    return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n  }\n\n  highp vec4 c = vec4(0,0,0,0);\n\n  //Compute exponent and mantissa\n  highp float e = floor(log2(av));\n  highp float m = av * pow(2.0, -e) - 1.0;\n  \n  //Unpack mantissa\n  c[1] = floor(128.0 * m);\n  m -= c[1] / 128.0;\n  c[2] = floor(32768.0 * m);\n  m -= c[2] / 32768.0;\n  c[3] = floor(8388608.0 * m);\n  \n  //Unpack exponent\n  highp float ebias = e + 127.0;\n  c[0] = floor(ebias / 2.0);\n  ebias -= c[0] * 2.0;\n  c[1] += floor(ebias) * 128.0; \n\n  //Unpack sign bit\n  c[0] += 128.0 * step(0.0, -v);\n\n  //Scale back to range\n  return c / 255.0;\n}\n\nuniform float pickId;\nuniform vec3 clipBounds[2];\n\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\nvarying vec4 fragColor;\n\nvoid main() {\n  if(any(lessThan(worldPosition, clipBounds[0])) || any(greaterThan(worldPosition, clipBounds[1]))) {\n    discard;\n  }\n  gl_FragColor = vec4(pickId/255.0, encode_float_1540259130(pixelArcLength).xyz);\n}"]),ATTRIBUTES=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];_$shaders_163.createShader=function(gl){return _$createShader_206(gl,__vertSrc_163,forwardFrag,null,ATTRIBUTES)},_$shaders_163.createPickShader=function(gl){return _$createShader_206(gl,__vertSrc_163,pickFrag,null,ATTRIBUTES)};var _$decodeFloat_229=function decodeFloat(x,y,z,w){return UINT8_VIEW[0]=w,UINT8_VIEW[1]=z,UINT8_VIEW[2]=y,UINT8_VIEW[3]=x,FLOAT_VIEW[0]},UINT8_VIEW=new Uint8Array(4),FLOAT_VIEW=new Float32Array(UINT8_VIEW.buffer);var _$createLinePlot_164=function createLinePlot(options){var gl=options.gl||options.scene&&options.scene.gl,shader=__createShader_164(gl);shader.attributes.position.location=0,shader.attributes.nextPosition.location=1,shader.attributes.arcLength.location=2,shader.attributes.lineWidth.location=3,shader.attributes.color.location=4;var pickShader=__createPickShader_164(gl);pickShader.attributes.position.location=0,pickShader.attributes.nextPosition.location=1,pickShader.attributes.arcLength.location=2,pickShader.attributes.lineWidth.location=3,pickShader.attributes.color.location=4;for(var buffer=_$createBuffer_153(gl),vao=_$createVAO_222(gl,[{buffer:buffer,size:3,offset:0,stride:48},{buffer:buffer,size:3,offset:12,stride:48},{buffer:buffer,size:1,offset:24,stride:48},{buffer:buffer,size:1,offset:28,stride:48},{buffer:buffer,size:4,offset:32,stride:48}]),defaultTexture=_$wrappedNDArrayCtor_277(new Array(1024),[256,1,4]),i=0;i<1024;++i)defaultTexture.data[i]=255;var texture=_$createTexture2D_218(gl,defaultTexture);texture.wrap=gl.REPEAT;var linePlot=new LinePlot(gl,shader,pickShader,buffer,vao,texture);return linePlot.update(options),linePlot},__createShader_164=_$shaders_163.createShader,__createPickShader_164=_$shaders_163.createPickShader,__identity_164=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function distance(a,b){for(var s=0,i=0;i<3;++i){var d=a[i]-b[i];s+=d*d}return Math.sqrt(s)}function filterClipBounds(bounds){for(var result=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],i=0;i<3;++i)result[0][i]=Math.max(bounds[0][i],result[0][i]),result[1][i]=Math.min(bounds[1][i],result[1][i]);return result}function PickResult(tau,position,index,dataCoordinate){this.arcLength=tau,this.position=position,this.index=index,this.dataCoordinate=dataCoordinate}function LinePlot(gl,shader,pickShader,buffer,vao,texture){this.gl=gl,this.shader=shader,this.pickShader=pickShader,this.buffer=buffer,this.vao=vao,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=texture,this.dashScale=1,this.opacity=1,this.dirty=!0,this.pixelRatio=1}var __proto_164=LinePlot.prototype;__proto_164.isTransparent=function(){return this.opacity<1},__proto_164.isOpaque=function(){return this.opacity>=1},__proto_164.pickSlots=1,__proto_164.setPickBase=function(id){this.pickId=id},__proto_164.drawTransparent=__proto_164.draw=function(camera){var gl=this.gl,shader=this.shader,vao=this.vao;shader.bind(),shader.uniforms={model:camera.model||__identity_164,view:camera.view||__identity_164,projection:camera.projection||__identity_164,clipBounds:filterClipBounds(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[gl.drawingBufferWidth,gl.drawingBufferHeight],pixelRatio:this.pixelRatio},vao.bind(),vao.draw(gl.TRIANGLE_STRIP,this.vertexCount),vao.unbind()},__proto_164.drawPick=function(camera){var gl=this.gl,shader=this.pickShader,vao=this.vao;shader.bind(),shader.uniforms={model:camera.model||__identity_164,view:camera.view||__identity_164,projection:camera.projection||__identity_164,pickId:this.pickId,clipBounds:filterClipBounds(this.clipBounds),screenShape:[gl.drawingBufferWidth,gl.drawingBufferHeight],pixelRatio:this.pixelRatio},vao.bind(),vao.draw(gl.TRIANGLE_STRIP,this.vertexCount),vao.unbind()},__proto_164.update=function(options){var i,j;this.dirty=!0;var connectGaps=!!options.connectGaps;"dashScale"in options&&(this.dashScale=options.dashScale),"opacity"in options&&(this.opacity=+options.opacity);var positions=options.position||options.positions;if(positions){var colors=options.color||options.colors||[0,0,0,1],lineWidth=options.lineWidth||1,buffer=[],arcLengthArray=[],pointArray=[],arcLength=0,vertexCount=0,bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],hadGap=!1;fill_loop:for(i=1;i<positions.length;++i){var acolor,bcolor,w0,a=positions[i-1],b=positions[i];for(arcLengthArray.push(arcLength),pointArray.push(a.slice()),j=0;j<3;++j){if(isNaN(a[j])||isNaN(b[j])||!isFinite(a[j])||!isFinite(b[j])){if(!connectGaps&&buffer.length>0){for(var k=0;k<24;++k)buffer.push(buffer[buffer.length-12]);vertexCount+=2,hadGap=!0}continue fill_loop}bounds[0][j]=Math.min(bounds[0][j],a[j],b[j]),bounds[1][j]=Math.max(bounds[1][j],a[j],b[j])}Array.isArray(colors[0])?(acolor=colors[i-1],bcolor=colors[i]):acolor=bcolor=colors,3===acolor.length&&(acolor=[acolor[0],acolor[1],acolor[2],1]),3===bcolor.length&&(bcolor=[bcolor[0],bcolor[1],bcolor[2],1]),w0=Array.isArray(lineWidth)?lineWidth[i-1]:lineWidth;var t0=arcLength;if(arcLength+=distance(a,b),hadGap){for(j=0;j<2;++j)buffer.push(a[0],a[1],a[2],b[0],b[1],b[2],t0,w0,acolor[0],acolor[1],acolor[2],acolor[3]);vertexCount+=2,hadGap=!1}buffer.push(a[0],a[1],a[2],b[0],b[1],b[2],t0,w0,acolor[0],acolor[1],acolor[2],acolor[3],a[0],a[1],a[2],b[0],b[1],b[2],t0,-w0,acolor[0],acolor[1],acolor[2],acolor[3],b[0],b[1],b[2],a[0],a[1],a[2],arcLength,-w0,bcolor[0],bcolor[1],bcolor[2],bcolor[3],b[0],b[1],b[2],a[0],a[1],a[2],arcLength,w0,bcolor[0],bcolor[1],bcolor[2],bcolor[3]),vertexCount+=4}if(this.buffer.update(buffer),arcLengthArray.push(arcLength),pointArray.push(positions[positions.length-1].slice()),this.bounds=bounds,this.vertexCount=vertexCount,this.points=pointArray,this.arcLength=arcLengthArray,"dashes"in options){var prefixSum=options.dashes.slice();for(prefixSum.unshift(0),i=1;i<prefixSum.length;++i)prefixSum[i]=prefixSum[i-1]+prefixSum[i];var dashTexture=_$wrappedNDArrayCtor_277(new Array(1024),[256,1,4]);for(i=0;i<256;++i){for(j=0;j<4;++j)dashTexture.set(i,0,j,0);1&_$searchBounds_71.le(prefixSum,prefixSum[prefixSum.length-1]*i/255)?dashTexture.set(i,0,0,0):dashTexture.set(i,0,0,255)}this.texture.setPixels(dashTexture)}}},__proto_164.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},__proto_164.pick=function(selection){if(!selection)return null;if(selection.id!==this.pickId)return null;var tau=_$decodeFloat_229(selection.value[0],selection.value[1],selection.value[2],0),index=_$searchBounds_71.le(this.arcLength,tau);if(index<0)return null;if(index===this.arcLength.length-1)return new PickResult(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),index);for(var a=this.points[index],b=this.points[Math.min(index+1,this.points.length-1)],t=(tau-this.arcLength[index])/(this.arcLength[index+1]-this.arcLength[index]),ti=1-t,x=[0,0,0],i=0;i<3;++i)x[i]=ti*a[i]+t*b[i];var dataIndex=Math.min(t<.5?index:index+1,this.points.length-1);return new PickResult(tau,x,dataIndex,this.points[dataIndex])};var _$getGlyph_200=function getGlyph(symbol,font){var fontCache=GLYPH_CACHE[font];fontCache||(fontCache=GLYPH_CACHE[font]={});if(symbol in fontCache)return fontCache[symbol];for(var lineSymbol=_$createText_367(symbol,{textAlign:"center",textBaseline:"middle",lineHeight:1,font:font}),triSymbol=_$createText_367(symbol,{triangles:!0,textAlign:"center",textBaseline:"middle",lineHeight:1,font:font}),bounds=[[1/0,1/0],[-1/0,-1/0]],i=0;i<lineSymbol.positions.length;++i)for(var p=lineSymbol.positions[i],j=0;j<2;++j)bounds[0][j]=Math.min(bounds[0][j],p[j]),bounds[1][j]=Math.max(bounds[1][j],p[j]);return fontCache[symbol]=[triSymbol,lineSymbol,bounds]},GLYPH_CACHE={};var _$shaders_201={},perspectiveVertSrc=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform vec4 highlightId;\nuniform float highlightScale;\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if(any(lessThan(position, clipBounds[0]))   || \n     any(greaterThan(position, clipBounds[1])) ) {\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = 1.0;\n    if(distance(highlightId, id) < 0.0001) {\n      scale = highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1);\n    vec4 viewPosition = view * worldPosition;\n    viewPosition = viewPosition / viewPosition.w;\n    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));\n    \n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),orthographicVertSrc=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float highlightScale, pixelRatio;\nuniform vec4 highlightId;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if(any(lessThan(position, clipBounds[0])) || any(greaterThan(position, clipBounds[1]))) {\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = pixelRatio;\n    if(distance(highlightId.bgr, id.bgr) < 0.001) {\n      scale *= highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1.0);\n    vec4 viewPosition = view * worldPosition;\n    vec4 clipPosition = projection * viewPosition;\n    clipPosition /= clipPosition.w;\n    \n    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),projectionVertSrc=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform float highlightScale;\nuniform vec4 highlightId;\nuniform vec3 axes[2];\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float scale, pixelRatio;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if(any(lessThan(position, clipBounds[0]))   ||\n     any(greaterThan(position, clipBounds[1])) ) {\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float lscale = pixelRatio * scale;\n    if(distance(highlightId, id) < 0.0001) {\n      lscale *= highlightScale;\n    }\n\n    vec4 clipCenter   = projection * view * model * vec4(position, 1);\n    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;\n    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = dataPosition;\n  }\n}\n"]),drawFragSrc=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3 fragClipBounds[2];\nuniform float opacity;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if(any(lessThan(dataCoordinate, fragClipBounds[0]))   ||\n     any(greaterThan(dataCoordinate, fragClipBounds[1])) ) {\n    discard;\n  } else {\n    gl_FragColor = interpColor * opacity;\n  }\n}\n"]),__pickFragSrc_201=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3 fragClipBounds[2];\nuniform float pickGroup;\n\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if(any(lessThan(dataCoordinate, fragClipBounds[0]))   || \n     any(greaterThan(dataCoordinate, fragClipBounds[1])) ) {\n    discard;\n  } else {\n    gl_FragColor = vec4(pickGroup, pickId.bgr);\n  }\n}"]),__ATTRIBUTES_201=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],__perspective_201={vertex:perspectiveVertSrc,fragment:drawFragSrc,attributes:__ATTRIBUTES_201},ortho={vertex:orthographicVertSrc,fragment:drawFragSrc,attributes:__ATTRIBUTES_201},__project_201={vertex:projectionVertSrc,fragment:drawFragSrc,attributes:__ATTRIBUTES_201},pickPerspective={vertex:perspectiveVertSrc,fragment:__pickFragSrc_201,attributes:__ATTRIBUTES_201},pickOrtho={vertex:orthographicVertSrc,fragment:__pickFragSrc_201,attributes:__ATTRIBUTES_201},pickProject={vertex:projectionVertSrc,fragment:__pickFragSrc_201,attributes:__ATTRIBUTES_201};function __createShader_201(gl,src){var shader=_$createShader_206(gl,src),attr=shader.attributes;return attr.position.location=0,attr.color.location=1,attr.glyph.location=2,attr.id.location=3,shader}_$shaders_201.createPerspective=function(gl){return __createShader_201(gl,__perspective_201)},_$shaders_201.createOrtho=function(gl){return __createShader_201(gl,ortho)},_$shaders_201.createProject=function(gl){return __createShader_201(gl,__project_201)},_$shaders_201.createPickPerspective=function(gl){return __createShader_201(gl,pickPerspective)},_$shaders_201.createPickOrtho=function(gl){return __createShader_201(gl,pickOrtho)},_$shaders_201.createPickProject=function(gl){return __createShader_201(gl,pickProject)};var __IDENTITY_202=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],_$createPointCloud_202=function createPointCloud(options){var gl=options.gl,shader=_$shaders_201.createPerspective(gl),orthoShader=_$shaders_201.createOrtho(gl),projectShader=_$shaders_201.createProject(gl),pickPerspectiveShader=_$shaders_201.createPickPerspective(gl),pickOrthoShader=_$shaders_201.createPickOrtho(gl),pickProjectShader=_$shaders_201.createPickProject(gl),pointBuffer=_$createBuffer_153(gl),colorBuffer=_$createBuffer_153(gl),glyphBuffer=_$createBuffer_153(gl),idBuffer=_$createBuffer_153(gl),vao=_$createVAO_222(gl,[{buffer:pointBuffer,size:3,type:gl.FLOAT},{buffer:colorBuffer,size:4,type:gl.FLOAT},{buffer:glyphBuffer,size:2,type:gl.FLOAT},{buffer:idBuffer,size:4,type:gl.UNSIGNED_BYTE,normalized:!0}]),pointCloud=new PointCloud(gl,shader,orthoShader,projectShader,pointBuffer,colorBuffer,glyphBuffer,idBuffer,vao,pickPerspectiveShader,pickOrthoShader,pickProjectShader);return pointCloud.update(options),pointCloud};function __transformMat4_202(x,m){var x0=x[0],x1=x[1],x2=x[2],x3=x[3];return x[0]=m[0]*x0+m[4]*x1+m[8]*x2+m[12]*x3,x[1]=m[1]*x0+m[5]*x1+m[9]*x2+m[13]*x3,x[2]=m[2]*x0+m[6]*x1+m[10]*x2+m[14]*x3,x[3]=m[3]*x0+m[7]*x1+m[11]*x2+m[15]*x3,x}function __project_202(p,v,m,x){return __transformMat4_202(x,x),__transformMat4_202(x,x),__transformMat4_202(x,x)}function PointCloud(gl,shader,orthoShader,projectShader,pointBuffer,colorBuffer,glyphBuffer,idBuffer,vao,pickPerspectiveShader,pickOrthoShader,pickProjectShader){this.gl=gl,this.pixelRatio=1,this.shader=shader,this.orthoShader=orthoShader,this.projectShader=projectShader,this.pointBuffer=pointBuffer,this.colorBuffer=colorBuffer,this.glyphBuffer=glyphBuffer,this.idBuffer=idBuffer,this.vao=vao,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.pickId=0,this.pickPerspectiveShader=pickPerspectiveShader,this.pickOrthoShader=pickOrthoShader,this.pickProjectShader=pickProjectShader,this.points=[],this._selectResult=new function ScatterPlotPickResult(index,position){this.index=index,this.dataCoordinate=this.position=position}(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}var __proto_202=PointCloud.prototype;__proto_202.pickSlots=1,__proto_202.setPickBase=function(pickBase){this.pickId=pickBase},__proto_202.isTransparent=function(){if(this.opacity<1)return!0;for(var i=0;i<3;++i)if(this.axesProject[i]&&this.projectOpacity[i]<1)return!0;return!1},__proto_202.isOpaque=function(){if(this.opacity>=1)return!0;for(var i=0;i<3;++i)if(this.axesProject[i]&&this.projectOpacity[i]>=1)return!0;return!1};var VIEW_SHAPE=[0,0],U_VEC=[0,0,0],V_VEC=[0,0,0],MU_VEC=[0,0,0,1],MV_VEC=[0,0,0,1],SCRATCH_MATRIX=__IDENTITY_202.slice(),SCRATCH_VEC=[0,0,0],CLIP_BOUNDS=[[0,0,0],[0,0,0]];function __zeroVec_202(a){return a[0]=a[1]=a[2]=0,a}function augment(hg,af){return hg[0]=af[0],hg[1]=af[1],hg[2]=af[2],hg[3]=1,hg}function setComponent(out,v,i,x){return out[0]=v[0],out[1]=v[1],out[2]=v[2],out[i]=x,out}function drawProject(shader,points,camera,transparent,forceDraw){var cubeAxis,axesProject=points.axesProject,gl=points.gl,uniforms=shader.uniforms,model=camera.model||__IDENTITY_202,view=camera.view||__IDENTITY_202,projection=camera.projection||__IDENTITY_202,bounds=points.axesBounds,clipBounds=function getClipBounds(bounds){for(var result=CLIP_BOUNDS,i=0;i<2;++i)for(var j=0;j<3;++j)result[i][j]=Math.max(Math.min(bounds[i][j],1e8),-1e8);return result}(points.clipBounds);cubeAxis=points.axes&&points.axes.lastCubeProps?points.axes.lastCubeProps.axis:[1,1,1],VIEW_SHAPE[0]=2/gl.drawingBufferWidth,VIEW_SHAPE[1]=2/gl.drawingBufferHeight,shader.bind(),uniforms.view=view,uniforms.projection=projection,uniforms.screenSize=VIEW_SHAPE,uniforms.highlightId=points.highlightId,uniforms.highlightScale=points.highlightScale,uniforms.clipBounds=clipBounds,uniforms.pickGroup=points.pickId/255,uniforms.pixelRatio=points.pixelRatio;for(var i=0;i<3;++i)if(axesProject[i]&&points.projectOpacity[i]<1===transparent){uniforms.scale=points.projectScale[i],uniforms.opacity=points.projectOpacity[i];for(var pmodel=SCRATCH_MATRIX,j=0;j<16;++j)pmodel[j]=0;for(j=0;j<4;++j)pmodel[5*j]=1;pmodel[5*i]=0,cubeAxis[i]<0?pmodel[12+i]=bounds[0][i]:pmodel[12+i]=bounds[1][i],_$multiply_175(pmodel,model,pmodel),uniforms.model=pmodel;var u=(i+1)%3,v=(i+2)%3,du=__zeroVec_202(U_VEC),dv=__zeroVec_202(V_VEC);du[u]=1,dv[v]=1;var mdu=__project_202(0,0,0,augment(MU_VEC,du)),mdv=__project_202(0,0,0,augment(MV_VEC,dv));if(Math.abs(mdu[1])>Math.abs(mdv[1])){var tmp=mdu;mdu=mdv,mdv=tmp,tmp=du,du=dv,dv=tmp;var t=u;u=v,v=t}mdu[0]<0&&(du[u]=-1),mdv[1]>0&&(dv[v]=-1);var su=0,sv=0;for(j=0;j<4;++j)su+=Math.pow(model[4*u+j],2),sv+=Math.pow(model[4*v+j],2);du[u]/=Math.sqrt(su),dv[v]/=Math.sqrt(sv),uniforms.axes[0]=du,uniforms.axes[1]=dv,uniforms.fragClipBounds[0]=setComponent(SCRATCH_VEC,clipBounds[0],i,-1e8),uniforms.fragClipBounds[1]=setComponent(SCRATCH_VEC,clipBounds[1],i,1e8),points.vao.draw(gl.TRIANGLES,points.vertexCount),points.lineWidth>0&&(gl.lineWidth(points.lineWidth),points.vao.draw(gl.LINES,points.lineVertexCount,points.vertexCount))}}var CLIP_GROUP=[[-1e8,-1e8,-1e8],[1e8,1e8,1e8]];function drawFull(shader,pshader,points,camera,transparent,forceDraw){var gl=points.gl;if(points.vao.bind(),transparent===points.opacity<1||forceDraw){shader.bind();var uniforms=shader.uniforms;uniforms.model=camera.model||__IDENTITY_202,uniforms.view=camera.view||__IDENTITY_202,uniforms.projection=camera.projection||__IDENTITY_202,VIEW_SHAPE[0]=2/gl.drawingBufferWidth,VIEW_SHAPE[1]=2/gl.drawingBufferHeight,uniforms.screenSize=VIEW_SHAPE,uniforms.highlightId=points.highlightId,uniforms.highlightScale=points.highlightScale,uniforms.fragClipBounds=CLIP_GROUP,uniforms.clipBounds=points.axes.bounds,uniforms.opacity=points.opacity,uniforms.pickGroup=points.pickId/255,uniforms.pixelRatio=points.pixelRatio,points.vao.draw(gl.TRIANGLES,points.vertexCount),points.lineWidth>0&&(gl.lineWidth(points.lineWidth),points.vao.draw(gl.LINES,points.lineVertexCount,points.vertexCount))}drawProject(pshader,points,camera,transparent),points.vao.unbind()}__proto_202.draw=function(camera){drawFull(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,camera,!1,!1)},__proto_202.drawTransparent=function(camera){drawFull(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,camera,!0,!1)},__proto_202.drawPick=function(camera){drawFull(this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader,this.pickProjectShader,this,camera,!1,!0)},__proto_202.pick=function(selected){if(!selected)return null;if(selected.id!==this.pickId)return null;var x=selected.value[2]+(selected.value[1]<<8)+(selected.value[0]<<16);if(x>=this.pointCount||x<0)return null;var coord=this.points[x],result=this._selectResult;result.index=x;for(var i=0;i<3;++i)result.position[i]=result.dataCoordinate[i]=coord[i];return result},__proto_202.highlight=function(selection){if(selection){var pointId=selection.index,a0=255&pointId,a1=pointId>>8&255,a2=pointId>>16&255;this.highlightId=[a0/255,a1/255,a2/255,0]}else this.highlightId=[1,1,1,1]},__proto_202.update=function(options){if("perspective"in(options=options||{})&&(this.useOrtho=!options.perspective),"orthographic"in options&&(this.useOrtho=!!options.orthographic),"lineWidth"in options&&(this.lineWidth=options.lineWidth),"project"in options)if(Array.isArray(options.project))this.axesProject=options.project;else{var v=!!options.project;this.axesProject=[v,v,v]}if("projectScale"in options)if(Array.isArray(options.projectScale))this.projectScale=options.projectScale.slice();else{var s=+options.projectScale;this.projectScale=[s,s,s]}if("projectOpacity"in options)if(Array.isArray(options.projectOpacity))this.projectOpacity=options.projectOpacity.slice();else{s=+options.projectOpacity;this.projectOpacity=[s,s,s]}"opacity"in options&&(this.opacity=options.opacity),this.dirty=!0;var points=options.position;if(points){var font=options.font||"normal",alignment=options.alignment||[0,0],lowerBound=[1/0,1/0,1/0],upperBound=[-1/0,-1/0,-1/0],glyphs=options.glyph,colors=options.color,sizes=options.size,angles=options.angle,lineColors=options.lineColor,pickCounter=0,triVertexCount=0,lineVertexCount=0,numPoints=points.length;count_loop:for(var i=0;i<numPoints;++i){for(var x=points[i],j=0;j<3;++j)if(isNaN(x[j])||!isFinite(x[j]))continue count_loop;var glyphMesh=(glyphData=Array.isArray(glyphs)?_$getGlyph_200(glyphs[i],font):_$getGlyph_200(glyphs||"●",font))[0],glyphLines=glyphData[1],glyphBounds=glyphData[2];triVertexCount+=3*glyphMesh.cells.length,lineVertexCount+=2*glyphLines.edges.length}var vertexCount=triVertexCount+lineVertexCount,positionArray=_$pool_360.mallocFloat(3*vertexCount),colorArray=_$pool_360.mallocFloat(4*vertexCount),glyphArray=_$pool_360.mallocFloat(2*vertexCount),idArray=_$pool_360.mallocUint32(vertexCount),textOffset=[0,alignment[1]],triOffset=0,lineOffset=triVertexCount,color=[0,0,0,1],lineColor=[0,0,0,1],isColorArray=Array.isArray(colors)&&Array.isArray(colors[0]),isLineColorArray=Array.isArray(lineColors)&&Array.isArray(lineColors[0]);fill_loop:for(i=0;i<numPoints;++i){var glyphData;for(x=points[i],j=0;j<3;++j){if(isNaN(x[j])||!isFinite(x[j])){pickCounter+=1;continue fill_loop}upperBound[j]=Math.max(upperBound[j],x[j]),lowerBound[j]=Math.min(lowerBound[j],x[j])}var c;glyphMesh=(glyphData=Array.isArray(glyphs)?_$getGlyph_200(glyphs[i],font):_$getGlyph_200(glyphs||"●",font))[0],glyphLines=glyphData[1],glyphBounds=glyphData[2];if(Array.isArray(colors)){if(3===(c=isColorArray?colors[i]:colors).length){for(j=0;j<3;++j)color[j]=c[j];color[3]=1}else if(4===c.length)for(j=0;j<4;++j)color[j]=c[j]}else color[0]=color[1]=color[2]=0,color[3]=1;if(Array.isArray(lineColors)){if(3===(c=isLineColorArray?lineColors[i]:lineColors).length){for(j=0;j<3;++j)lineColor[j]=c[j];lineColor[j]=1}else if(4===c.length)for(j=0;j<4;++j)lineColor[j]=c[j]}else lineColor[0]=lineColor[1]=lineColor[2]=0,lineColor[3]=1;var size=.5;Array.isArray(sizes)?size=+sizes[i]:sizes?size=+sizes:this.useOrtho&&(size=12);var angle=0;Array.isArray(angles)?angle=+angles[i]:angles&&(angle=+angles);var cos=Math.cos(angle),sin=Math.sin(angle);for(x=points[i],j=0;j<3;++j)upperBound[j]=Math.max(upperBound[j],x[j]),lowerBound[j]=Math.min(lowerBound[j],x[j]);alignment[0]<0?textOffset[0]=alignment[0]*(1+glyphBounds[1][0]):alignment[0]>0&&(textOffset[0]=-alignment[0]*(1+glyphBounds[0][0]));var cells=glyphMesh.cells,verts=glyphMesh.positions;for(j=0;j<cells.length;++j)for(var cell=cells[j],k=0;k<3;++k){for(var l=0;l<3;++l)positionArray[3*triOffset+l]=x[l];for(l=0;l<4;++l)colorArray[4*triOffset+l]=color[l];idArray[triOffset]=pickCounter;var p=verts[cell[k]];glyphArray[2*triOffset]=size*(cos*p[0]-sin*p[1]+textOffset[0]),glyphArray[2*triOffset+1]=size*(sin*p[0]+cos*p[1]+textOffset[1]),triOffset+=1}for(cells=glyphLines.edges,verts=glyphLines.positions,j=0;j<cells.length;++j)for(cell=cells[j],k=0;k<2;++k){for(l=0;l<3;++l)positionArray[3*lineOffset+l]=x[l];for(l=0;l<4;++l)colorArray[4*lineOffset+l]=lineColor[l];idArray[lineOffset]=pickCounter;p=verts[cell[k]];glyphArray[2*lineOffset]=size*(cos*p[0]-sin*p[1]+textOffset[0]),glyphArray[2*lineOffset+1]=size*(sin*p[0]+cos*p[1]+textOffset[1]),lineOffset+=1}pickCounter+=1}this.vertexCount=triVertexCount,this.lineVertexCount=lineVertexCount,this.pointBuffer.update(positionArray),this.colorBuffer.update(colorArray),this.glyphBuffer.update(glyphArray),this.idBuffer.update(new Uint32Array(idArray)),_$pool_360.free(positionArray),_$pool_360.free(colorArray),_$pool_360.free(glyphArray),_$pool_360.free(idArray),this.bounds=[lowerBound,upperBound],this.points=points,this.pointCount=points.length}},__proto_202.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()};var colorDflt=_$attributes_410.defaultLine,colorDfltRgba=_$normalize_99(colorDflt),opacityDflt=1;function calculateColor(colorIn,opacityIn){var colorOut=colorIn;return colorOut[3]*=opacityIn,colorOut}function validateColor(colorIn){if(_$fastIsnumeric_139(colorIn))return colorDfltRgba;var colorOut=_$normalize_99(colorIn);return colorOut.length?colorOut:colorDfltRgba}function validateOpacity(opacityIn){return _$fastIsnumeric_139(opacityIn)?opacityIn:opacityDflt}var _$formatColor_535=function formatColor(containerIn,opacityIn,len){var sclFunc,getColor,getOpacity,colori,opacityi,colorIn=containerIn.color,isArrayColorIn=Array.isArray(colorIn),isArrayOpacityIn=Array.isArray(opacityIn),colorOut=[];if(sclFunc=void 0!==containerIn.colorscale?_$colorscale_426.makeColorScaleFunc(_$colorscale_426.extractScale(containerIn.colorscale,containerIn.cmin,containerIn.cmax)):validateColor,getColor=isArrayColorIn?function(c,i){return void 0===c[i]?colorDfltRgba:_$normalize_99(sclFunc(c[i]))}:validateColor,getOpacity=isArrayOpacityIn?function(o,i){return void 0===o[i]?opacityDflt:validateOpacity(o[i])}:validateOpacity,isArrayColorIn||isArrayOpacityIn)for(var i=0;i<len;i++)colori=getColor(colorIn,i),opacityi=getOpacity(opacityIn,i),colorOut[i]=calculateColor(colori,opacityi);else colorOut=calculateColor(_$normalize_99(colorIn),opacityIn);return colorOut};function calculateAxisErrors(data,params,scaleFactor){if(!params||!params.visible)return null;for(var computeError=_$makeComputeError_440(params),result=new Array(data.length),i=0;i<data.length;i++){var errors=computeError(+data[i],i);result[i]=[-errors[0]*scaleFactor,errors[1]*scaleFactor]}return result}var _$calculateErrors_889=function calculateErrors(data,scaleFactor){var errors=[calculateAxisErrors(data.x,data.error_x,scaleFactor[0]),calculateAxisErrors(data.y,data.error_y,scaleFactor[1]),calculateAxisErrors(data.z,data.error_z,scaleFactor[2])],n=function dataLength(array){for(var i=0;i<array.length;i++)if(array[i])return array[i].length;return 0}(errors);if(0===n)return null;for(var errorBounds=new Array(n),i=0;i<n;i++){for(var bound=[[0,0,0],[0,0,0]],j=0;j<3;j++)if(errors[j])for(var k=0;k<2;k++)bound[k][j]=errors[j][i][k];errorBounds[i]=bound}return errorBounds};function LineWithMarkers(scene,uid){this.scene=scene,this.uid=uid,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}var __proto_890=LineWithMarkers.prototype;function calculateSize(sizeIn,sizeFn){return sizeFn(4*sizeIn)}function calculateSymbol(symbolIn){return _$gl3d_markers_515[symbolIn]}function formatParam(paramIn,len,calculate,dflt,extraFn){var paramOut=null;if(_$lib_539.isArrayOrTypedArray(paramIn)){paramOut=[];for(var i=0;i<len;i++)void 0===paramIn[i]?paramOut[i]=dflt:paramOut[i]=calculate(paramIn[i],extraFn)}else paramOut=calculate(paramIn,_$lib_539.identity);return paramOut}function convertPlotlyOptions(scene,data){var params,i,xc,yc,zc,text,points=[],sceneLayout=scene.fullSceneLayout,scaleFactor=scene.dataScale,xaxis=sceneLayout.xaxis,yaxis=sceneLayout.yaxis,zaxis=sceneLayout.zaxis,marker=data.marker,line=data.line,x=data.x||[],y=data.y||[],z=data.z||[],len=x.length,xcalendar=data.xcalendar,ycalendar=data.ycalendar,zcalendar=data.zcalendar;for(i=0;i<len;i++)xc=xaxis.d2l(x[i],0,xcalendar)*scaleFactor[0],yc=yaxis.d2l(y[i],0,ycalendar)*scaleFactor[1],zc=zaxis.d2l(z[i],0,zcalendar)*scaleFactor[2],points[i]=[xc,yc,zc];if(Array.isArray(data.text))text=data.text;else if(void 0!==data.text)for(text=new Array(len),i=0;i<len;i++)text[i]=data.text;if(params={position:points,mode:data.mode,text:text},"line"in data&&(params.lineColor=_$formatColor_535(line,1,len),params.lineWidth=line.width,params.lineDashes=line.dash),"marker"in data){var sizeFn=_$makeBubbleSizeFn_879(data);params.scatterColor=_$formatColor_535(marker,1,len),params.scatterSize=formatParam(marker.size,len,calculateSize,20,sizeFn),params.scatterMarker=formatParam(marker.symbol,len,calculateSymbol,"●"),params.scatterLineWidth=marker.line.width,params.scatterLineColor=_$formatColor_535(marker.line,1,len),params.scatterAngle=0}"textposition"in data&&(params.textOffset=function calculateTextOffset(tp){var textOffset=[0,0];return Array.isArray(tp)?[0,-1]:(tp.indexOf("bottom")>=0&&(textOffset[1]+=1),tp.indexOf("top")>=0&&(textOffset[1]-=1),tp.indexOf("left")>=0&&(textOffset[0]-=1),tp.indexOf("right")>=0&&(textOffset[0]+=1),textOffset)}(data.textposition),params.textColor=_$formatColor_535(data.textfont,1,len),params.textSize=formatParam(data.textfont.size,len,_$lib_539.identity,12),params.textFont=data.textfont.family,params.textAngle=0);var dims=["x","y","z"];for(params.project=[!1,!1,!1],params.projectScale=[1,1,1],params.projectOpacity=[1,1,1],i=0;i<3;++i){var projection=data.projection[dims[i]];(params.project[i]=projection.show)&&(params.projectOpacity[i]=projection.opacity,params.projectScale[i]=projection.scale)}params.errorBounds=_$calculateErrors_889(data,scaleFactor);var errorParams=function calculateErrorParams(errors){for(var capSize=[0,0,0],color=[[0,0,0],[0,0,0],[0,0,0]],lineWidth=[0,0,0],i=0;i<3;i++){var e=errors[i];e&&!1!==e.copy_zstyle&&(e=errors[2]),e&&(capSize[i]=e.width/2,color[i]=_$str2RgbaArray_561(e.color),lineWidth=e.thickness)}return{capSize:capSize,color:color,lineWidth:lineWidth}}([data.error_x,data.error_y,data.error_z]);return params.errorColor=errorParams.color,params.errorLineWidth=errorParams.lineWidth,params.errorCapSize=errorParams.capSize,params.delaunayAxis=data.surfaceaxis,params.delaunayColor=_$str2RgbaArray_561(data.surfacecolor),params}function arrayToColor(color){if(Array.isArray(color)){var c=color[0];return Array.isArray(c)&&(color=c),"rgb("+color.slice(0,3).map(function(x){return Math.round(255*x)})+")"}return null}__proto_890.handlePick=function(selection){if(selection.object&&(selection.object===this.linePlot||selection.object===this.delaunayMesh||selection.object===this.textMarkers||selection.object===this.scatterPlot)){selection.object.highlight&&selection.object.highlight(null),this.scatterPlot&&(selection.object=this.scatterPlot,this.scatterPlot.highlight(selection.data)),this.textLabels?void 0!==this.textLabels[selection.data.index]?selection.textLabel=this.textLabels[selection.data.index]:selection.textLabel=this.textLabels:selection.textLabel="";var selectIndex=selection.index=selection.data.index;return selection.traceCoordinate=[this.data.x[selectIndex],this.data.y[selectIndex],this.data.z[selectIndex]],!0}},__proto_890.update=function(data){var lineOptions,scatterOptions,errorOptions,textOptions,gl=this.scene.glplot.gl,dashPattern=_$gl3d_dashes_514.solid;this.data=data;var options=convertPlotlyOptions(this.scene,data);"mode"in options&&(this.mode=options.mode),"lineDashes"in options&&options.lineDashes in _$gl3d_dashes_514&&(dashPattern=_$gl3d_dashes_514[options.lineDashes]),this.color=arrayToColor(options.scatterColor)||arrayToColor(options.lineColor),this.dataPoints=options.position,lineOptions={gl:gl,position:options.position,color:options.lineColor,lineWidth:options.lineWidth||1,dashes:dashPattern[0],dashScale:dashPattern[1],opacity:data.opacity,connectGaps:data.connectgaps},-1!==this.mode.indexOf("lines")?this.linePlot?this.linePlot.update(lineOptions):(this.linePlot=_$createLinePlot_164(lineOptions),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var scatterOpacity=data.opacity;if(data.marker&&data.marker.opacity&&(scatterOpacity*=data.marker.opacity),scatterOptions={gl:gl,position:options.position,color:options.scatterColor,size:options.scatterSize,glyph:options.scatterMarker,opacity:scatterOpacity,orthographic:!0,lineWidth:options.scatterLineWidth,lineColor:options.scatterLineColor,project:options.project,projectScale:options.projectScale,projectOpacity:options.projectOpacity},-1!==this.mode.indexOf("markers")?this.scatterPlot?this.scatterPlot.update(scatterOptions):(this.scatterPlot=_$createPointCloud_202(scatterOptions),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),textOptions={gl:gl,position:options.position,glyph:options.text,color:options.textColor,size:options.textSize,angle:options.textAngle,alignment:options.textOffset,font:options.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:data.opacity},this.textLabels=data.hovertext||data.text,-1!==this.mode.indexOf("text")?this.textMarkers?this.textMarkers.update(textOptions):(this.textMarkers=_$createPointCloud_202(textOptions),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),errorOptions={gl:gl,position:options.position,color:options.errorColor,error:options.errorBounds,lineWidth:options.errorLineWidth,capSize:options.errorCapSize,opacity:data.opacity},this.errorBars?options.errorBounds?this.errorBars.update(errorOptions):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):options.errorBounds&&(this.errorBars=_$createErrorBars_156(errorOptions),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),options.delaunayAxis>=0){var delaunayOptions=function constructDelaunay(points,color,axis){var i,u=(axis+1)%3,v=(axis+2)%3,filteredPoints=[],filteredIds=[];for(i=0;i<points.length;++i){var p=points[i];!isNaN(p[u])&&isFinite(p[u])&&!isNaN(p[v])&&isFinite(p[v])&&(filteredPoints.push([p[u],p[v]]),filteredIds.push(i))}var cells=_$triangulate_129(filteredPoints);for(i=0;i<cells.length;++i)for(var c=cells[i],j=0;j<c.length;++j)c[j]=filteredIds[c[j]];return{positions:points,cells:cells,meshColor:color}}(options.position,options.delaunayColor,options.delaunayAxis);delaunayOptions.opacity=data.opacity,this.delaunayMesh?this.delaunayMesh.update(delaunayOptions):(delaunayOptions.gl=gl,this.delaunayMesh=_$createSimplicialMesh_187(delaunayOptions),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},__proto_890.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())};var _$createLineWithMarkers_890=function createLineWithMarkers(scene,data){var plot=new LineWithMarkers(scene,data.uid);return plot.update(data),plot};var Scatter3D={};Scatter3D.plot=_$createLineWithMarkers_890,Scatter3D.attributes=_$attributes_887,Scatter3D.markerSymbols=_$gl3d_markers_515,Scatter3D.supplyDefaults=function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_887,attr,dflt)}if(function __handleXYZDefaults_891(traceIn,traceOut,coerce,layout){var len=0,x=coerce("x"),y=coerce("y"),z=coerce("z");return _$registry_668.getComponentMethod("calendars","handleTraceDefaults")(traceIn,traceOut,["x","y","z"],layout),x&&y&&z&&(len=Math.min(x.length,y.length,z.length),traceOut._xlength=traceOut._ylength=traceOut._zlength=len),len}(traceIn,traceOut,coerce,layout)){coerce("text"),coerce("hovertext"),coerce("mode"),_$subtypes_884.hasLines(traceOut)&&(coerce("connectgaps"),_$lineDefaults_875(traceIn,traceOut,defaultColor,layout,coerce)),_$subtypes_884.hasMarkers(traceOut)&&_$markerDefaults_880(traceIn,traceOut,defaultColor,layout,coerce,{noSelect:!0}),_$subtypes_884.hasText(traceOut)&&_$text_defaults_885(0,0,layout,coerce,{noSelect:!0});var lineColor=(traceOut.line||{}).color,markerColor=(traceOut.marker||{}).color;coerce("surfaceaxis")>=0&&coerce("surfacecolor",lineColor||markerColor);for(var dims=["x","y","z"],i=0;i<3;++i){var projection="projection."+dims[i];coerce(projection+".show")&&(coerce(projection+".opacity"),coerce(projection+".scale"))}var errorBarsSupplyDefaults=_$registry_668.getComponentMethod("errorbars","supplyDefaults");errorBarsSupplyDefaults(traceIn,traceOut,defaultColor,{axis:"z"}),errorBarsSupplyDefaults(traceIn,traceOut,defaultColor,{axis:"y",inherit:"z"}),errorBarsSupplyDefaults(traceIn,traceOut,defaultColor,{axis:"x",inherit:"z"})}else traceOut.visible=!1},Scatter3D.colorbar=_$colorbar_866,Scatter3D.calc=_$calc_888,Scatter3D.moduleType="trace",Scatter3D.name="scatter3d",Scatter3D.basePlotModule=_$gl3d_627,Scatter3D.categories=["gl3d","symbols","markerColorscale","showLegend"],Scatter3D.meta={};var _$scatter3d_27=Scatter3D,__extendFlat_893=_$extend_528.extendFlat,__scatterMarkerAttrs_893=_$attributes_862.marker,__scatterLineAttrs_893=_$attributes_862.line,__scatterMarkerLineAttrs_893=__scatterMarkerAttrs_893.line,_$attributes_893={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:__extendFlat_893({},_$attributes_862.mode,{dflt:"markers"}),text:__extendFlat_893({},_$attributes_862.text,{}),line:{color:__scatterLineAttrs_893.color,width:__scatterLineAttrs_893.width,dash:__scatterLineAttrs_893.dash,shape:__extendFlat_893({},__scatterLineAttrs_893.shape,{values:["linear","spline"]}),smoothing:__scatterLineAttrs_893.smoothing,editType:"calc"},connectgaps:_$attributes_862.connectgaps,fill:__extendFlat_893({},_$attributes_862.fill,{values:["none","toself","tonext"]}),fillcolor:_$attributes_862.fillcolor,marker:__extendFlat_893({symbol:__scatterMarkerAttrs_893.symbol,opacity:__scatterMarkerAttrs_893.opacity,maxdisplayed:__scatterMarkerAttrs_893.maxdisplayed,size:__scatterMarkerAttrs_893.size,sizeref:__scatterMarkerAttrs_893.sizeref,sizemin:__scatterMarkerAttrs_893.sizemin,sizemode:__scatterMarkerAttrs_893.sizemode,line:__extendFlat_893({width:__scatterMarkerLineAttrs_893.width,editType:"calc"},_$makeColorScaleAttributes_419()),gradient:__scatterMarkerAttrs_893.gradient,editType:"calc"},_$makeColorScaleAttributes_419(),{showscale:__scatterMarkerAttrs_893.showscale,colorbar:_$attributes_412}),textfont:_$attributes_862.textfont,textposition:_$attributes_862.textposition,selected:_$attributes_862.selected,unselected:_$attributes_862.unselected,hoverinfo:__extendFlat_893({},_$attributes_581.hoverinfo,{flags:["a","b","text","name"]}),hoveron:_$attributes_862.hoveron},__calcMarkerSize_894=_$calc___calcMarkerSize,ScatterCarpet={};ScatterCarpet.attributes=_$attributes_893,ScatterCarpet.supplyDefaults=function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_893,attr,dflt)}coerce("carpet"),traceOut.xaxis="x",traceOut.yaxis="y";var len,a=coerce("a"),b=coerce("b");if(len=Math.min(a.length,b.length)){a&&len<a.length&&(traceOut.a=a.slice(0,len)),b&&len<b.length&&(traceOut.b=b.slice(0,len)),coerce("text"),coerce("mode",len<_$constants_868.PTS_LINESONLY?"lines+markers":"lines"),_$subtypes_884.hasLines(traceOut)&&(_$lineDefaults_875(traceIn,traceOut,defaultColor,layout,coerce),_$handleLineShapeDefaults_877(0,0,coerce),coerce("connectgaps")),_$subtypes_884.hasMarkers(traceOut)&&_$markerDefaults_880(traceIn,traceOut,defaultColor,layout,coerce,{gradient:!0}),_$subtypes_884.hasText(traceOut)&&_$text_defaults_885(0,0,layout,coerce);var dfltHoverOn=[];(_$subtypes_884.hasMarkers(traceOut)||_$subtypes_884.hasText(traceOut))&&(coerce("marker.maxdisplayed"),dfltHoverOn.push("points")),coerce("fill"),"none"!==traceOut.fill&&(_$fillColorDefaults_871(0,traceOut,defaultColor,coerce),_$subtypes_884.hasLines(traceOut)||_$handleLineShapeDefaults_877(0,0,coerce)),"tonext"!==traceOut.fill&&"toself"!==traceOut.fill||dfltHoverOn.push("fills"),coerce("hoveron",dfltHoverOn.join("+")||"points"),_$lib_539.coerceSelectionMarkerOpacity(traceOut,coerce)}else traceOut.visible=!1},ScatterCarpet.colorbar=_$colorbar_866,ScatterCarpet.calc=function calc(gd,trace){var carpet=trace.carpetTrace=_$lookup_carpetid_726(gd,trace);if(carpet&&carpet.visible&&"legendonly"!==carpet.visible){var i;trace.xaxis=carpet.xaxis,trace.yaxis=carpet.yaxis;var a,b,serieslen=trace.a.length,cd=new Array(serieslen),needsCull=!1;for(i=0;i<serieslen;i++)if(a=trace.a[i],b=trace.b[i],_$fastIsnumeric_139(a)&&_$fastIsnumeric_139(b)){var xy=carpet.ab2xy(+a,+b,!0),visible=carpet.isVisible(+a,+b);visible||(needsCull=!0),cd[i]={x:xy[0],y:xy[1],a:a,b:b,vis:visible}}else cd[i]={x:!1,y:!1};return trace._needsCull=needsCull,cd[0].carpet=carpet,cd[0].trace=trace,__calcMarkerSize_894(trace,serieslen),_$calcMarkerColorscale_867(trace),_$arraysToCalcdata_861(cd,trace),_$calcSelection_864(cd,trace),cd}},ScatterCarpet.plot=function plot(gd,plotinfoproxy,data){var i,trace,node,carpet=data[0][0].carpet,plotinfo={xaxis:_$axes_584.getFromId(gd,carpet.xaxis||"x"),yaxis:_$axes_584.getFromId(gd,carpet.yaxis||"y"),plot:plotinfoproxy.plot};for(_$plot_881(gd,plotinfo,data),i=0;i<data.length;i++)trace=data[i][0].trace,node=plotinfo.plot.selectAll("g.trace"+trace.uid+" .js-line"),_$drawing_436.setClipUrl(node,carpet._clipPathId)},ScatterCarpet.style=_$style_883.style,ScatterCarpet.hoverPoints=function hoverPoints(pointData,xval,yval,hovermode){var scatterPointData=_$hoverPoints_873(pointData,xval,yval,hovermode);if(scatterPointData&&!1!==scatterPointData[0].index){var newPointData=scatterPointData[0];if(void 0===newPointData.index){var yFracUp=1-newPointData.y0/pointData.ya._length,xLen=pointData.xa._length,xMin=xLen*yFracUp/2,xMax=xLen-xMin;return newPointData.x0=Math.max(Math.min(newPointData.x0,xMax),xMin),newPointData.x1=Math.max(Math.min(newPointData.x1,xMax),xMin),scatterPointData}var cdi=newPointData.cd[newPointData.index];newPointData.a=cdi.a,newPointData.b=cdi.b,newPointData.xLabelVal=void 0,newPointData.yLabelVal=void 0;var trace=newPointData.trace,carpet=trace._carpet,parts=(cdi.hi||trace.hoverinfo).split("+"),text=[];-1!==parts.indexOf("all")&&(parts=["a","b"]),-1!==parts.indexOf("a")&&textPart(carpet.aaxis,cdi.a),-1!==parts.indexOf("b")&&textPart(carpet.baxis,cdi.b);var ij=carpet.ab2ij([cdi.a,cdi.b]),i0=Math.floor(ij[0]),ti=ij[0]-i0,j0=Math.floor(ij[1]),tj=ij[1]-j0,xy=carpet.evalxy([],i0,j0,ti,tj);return text.push("y: "+xy[1].toFixed(3)),newPointData.extraText=text.join("<br>"),scatterPointData}function textPart(ax,val){var prefix;prefix=ax.labelprefix&&ax.labelprefix.length>0?ax.labelprefix.replace(/ = $/,""):ax._hovertitle,text.push(prefix+": "+val.toFixed(3)+ax.labelsuffix)}},ScatterCarpet.selectPoints=_$selectPoints_882,ScatterCarpet.eventData=function eventData(out,pt,trace,cd,pointNumber){var cdi=cd[pointNumber];return out.a=cdi.a,out.b=cdi.b,out},ScatterCarpet.moduleType="trace",ScatterCarpet.name="scattercarpet",ScatterCarpet.basePlotModule=_$cartesian_595,ScatterCarpet.categories=["carpet","symbols","markerColorscale","showLegend","carpetDependent"],ScatterCarpet.meta={};var _$scattercarpet_28=ScatterCarpet,__BADNUM_901=_$numerical_517.BADNUM,____901=_$lib_539._,_$calc_901=function calc(gd,trace){for(var hasLocationData=Array.isArray(trace.locations),len=hasLocationData?trace.locations.length:trace._length,calcTrace=new Array(len),i=0;i<len;i++){var calcPt=calcTrace[i]={};if(hasLocationData){var loc=trace.locations[i];calcPt.loc="string"==typeof loc?loc:null}else{var lon=trace.lon[i],lat=trace.lat[i];_$fastIsnumeric_139(lon)&&_$fastIsnumeric_139(lat)?calcPt.lonlat=[+lon,+lat]:calcPt.lonlat=[__BADNUM_901,__BADNUM_901]}}return _$arraysToCalcdata_861(calcTrace,trace),_$calcMarkerColorscale_867(trace),_$calcSelection_864(calcTrace,trace),len&&(calcTrace[0].t={labels:{lat:____901(gd,"lat:")+" ",lon:____901(gd,"lon:")+" "}}),calcTrace};var __BADNUM_904=_$numerical_517.BADNUM;var _$geojson_utils_532={},__BADNUM_532=_$numerical_517.BADNUM;_$geojson_utils_532.calcTraceToLineCoords=function(calcTrace){for(var connectgaps=calcTrace[0].trace.connectgaps,coords=[],lineString=[],i=0;i<calcTrace.length;i++){var lonlat=calcTrace[i].lonlat;lonlat[0]!==__BADNUM_532?lineString.push(lonlat):!connectgaps&&lineString.length>0&&(coords.push(lineString),lineString=[])}return lineString.length>0&&coords.push(lineString),coords},_$geojson_utils_532.makeLine=function(coords){return 1===coords.length?{type:"LineString",coordinates:coords[0]}:{type:"MultiLineString",coordinates:coords}},_$geojson_utils_532.makePolygon=function(coords){if(1===coords.length)return{type:"Polygon",coordinates:coords};for(var _coords=new Array(coords.length),i=0;i<coords.length;i++)_coords[i]=[coords[i]];return{type:"MultiPolygon",coordinates:_coords}},_$geojson_utils_532.makeBlank=function(){return{type:"Point",coordinates:[]}};var __stylePoints_908=_$style_883.stylePoints,_$style_908=function style(gd,calcTrace){calcTrace&&function __styleTrace_908(gd,calcTrace){var trace=calcTrace[0].trace,s=calcTrace[0].node3;s.style("opacity",calcTrace[0].trace.opacity),__stylePoints_908(s,trace,gd),s.selectAll("path.js-line").style("fill","none").each(function(d){var path=_$d3_127.select(this),trace=d.trace,line=trace.line||{};path.call(_$color_411.stroke,line.color).call(_$drawing_436.dashLine,line.dash||"",line.width||0),"none"!==trace.fill&&path.call(_$color_411.fill,trace.fillcolor)})}(gd,calcTrace)};var __BADNUM_906=_$numerical_517.BADNUM,__getTopojsonFeatures_906=_$topojson_utils_565.getTopojsonFeatures,__locationToFeature_906=_$geo_location_utils_531.locationToFeature;function __calcGeoJSON_906(calcTrace,topojson){var trace=calcTrace[0].trace;if(Array.isArray(trace.locations))for(var features=__getTopojsonFeatures_906(trace,topojson),locationmode=trace.locationmode,i=0;i<calcTrace.length;i++){var calcPt=calcTrace[i],feature=__locationToFeature_906(locationmode,calcPt.loc,features);calcPt.lonlat=feature?feature.properties.ct:[__BADNUM_906,__BADNUM_906]}}var ScatterGeo={};ScatterGeo.attributes=_$attributes_900,ScatterGeo.supplyDefaults=function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_900,attr,dflt)}!function handleLonLatLocDefaults(traceIn,traceOut,coerce){var lon,lat,len=0,locations=coerce("locations");return locations?(coerce("locationmode"),len=locations.length):(lon=coerce("lon")||[],lat=coerce("lat")||[],len=Math.min(lon.length,lat.length),traceOut._length=len,len)}(0,traceOut,coerce)?traceOut.visible=!1:(coerce("text"),coerce("hovertext"),coerce("mode"),_$subtypes_884.hasLines(traceOut)&&(_$lineDefaults_875(traceIn,traceOut,defaultColor,layout,coerce),coerce("connectgaps")),_$subtypes_884.hasMarkers(traceOut)&&_$markerDefaults_880(traceIn,traceOut,defaultColor,layout,coerce,{gradient:!0}),_$subtypes_884.hasText(traceOut)&&_$text_defaults_885(0,0,layout,coerce),coerce("fill"),"none"!==traceOut.fill&&_$fillColorDefaults_871(0,traceOut,defaultColor,coerce))},ScatterGeo.colorbar=_$colorbar_866,ScatterGeo.calc=_$calc_901,ScatterGeo.plot=function plot(gd,geo,calcData){for(var i=0;i<calcData.length;i++)__calcGeoJSON_906(calcData[i],geo.topojson);function removeBADNUM(d,node){d.lonlat[0]===__BADNUM_906&&_$d3_127.select(node).remove()}var gTraces=geo.layers.frontplot.select(".scatterlayer").selectAll("g.trace.scattergeo").data(calcData,function keyFunc(d){return d[0].trace.uid});gTraces.enter().append("g").attr("class","trace scattergeo"),gTraces.exit().remove(),gTraces.selectAll("*").remove(),gTraces.each(function(calcTrace){var s=calcTrace[0].node3=_$d3_127.select(this),trace=calcTrace[0].trace;if(_$subtypes_884.hasLines(trace)||"none"!==trace.fill){var lineCoords=_$geojson_utils_532.calcTraceToLineCoords(calcTrace),lineData="none"!==trace.fill?_$geojson_utils_532.makePolygon(lineCoords):_$geojson_utils_532.makeLine(lineCoords);s.selectAll("path.js-line").data([{geojson:lineData,trace:trace}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}_$subtypes_884.hasMarkers(trace)&&s.selectAll("path.point").data(_$lib_539.identity).enter().append("path").classed("point",!0).each(function(calcPt){removeBADNUM(calcPt,this)}),_$subtypes_884.hasText(trace)&&s.selectAll("g").data(_$lib_539.identity).enter().append("g").append("text").each(function(calcPt){removeBADNUM(calcPt,this)}),_$style_908(gd,calcTrace)})},ScatterGeo.style=_$style_908,ScatterGeo.hoverPoints=function hoverPoints(pointData,xval,yval){var cd=pointData.cd,trace=cd[0].trace,xa=pointData.xa,ya=pointData.ya,geo=pointData.subplot,isLonLatOverEdges=geo.projection.isLonLatOverEdges,project=geo.project;if(_$fx_453.getClosest(cd,function distFn(d){var lonlat=d.lonlat;if(lonlat[0]===__BADNUM_904)return 1/0;if(isLonLatOverEdges(lonlat))return 1/0;var pt=project(lonlat),px=project([xval,yval]),dx=Math.abs(pt[0]-px[0]),dy=Math.abs(pt[1]-px[1]),rad=Math.max(3,d.mrc||0);return Math.max(Math.sqrt(dx*dx+dy*dy)-rad,1-3/rad)},pointData),!1!==pointData.index){var di=cd[pointData.index],lonlat=di.lonlat,pos=[xa.c2p(lonlat),ya.c2p(lonlat)],rad=di.mrc||1;return pointData.x0=pos[0]-rad,pointData.x1=pos[0]+rad,pointData.y0=pos[1]-rad,pointData.y1=pos[1]+rad,pointData.loc=di.loc,pointData.lon=lonlat[0],pointData.lat=lonlat[1],pointData.color=_$getTraceColor_872(trace,di),pointData.extraText=function getExtraText(trace,pt,axis,labels){var hoverinfo=pt.hi||trace.hoverinfo,parts="all"===hoverinfo?_$attributes_900.hoverinfo.flags:hoverinfo.split("+"),hasLocation=-1!==parts.indexOf("location")&&Array.isArray(trace.locations),hasLon=-1!==parts.indexOf("lon"),hasLat=-1!==parts.indexOf("lat"),hasText=-1!==parts.indexOf("text"),text=[];function format(val){return _$axes_584.tickText(axis,axis.c2l(val),"hover").text+"°"}return hasLocation?text.push(pt.loc):hasLon&&hasLat?text.push("("+format(pt.lonlat[0])+", "+format(pt.lonlat[1])+")"):hasLon?text.push(labels.lon+format(pt.lonlat[0])):hasLat&&text.push(labels.lat+format(pt.lonlat[1])),hasText&&_$fillHoverText_870(pt,trace,text),text.join("<br>")}(trace,di,geo.mockAxis,cd[0].t.labels),[pointData]}},ScatterGeo.eventData=function eventData(out,pt){return out.lon=pt.lon,out.lat=pt.lat,out.location=pt.loc?pt.loc:null,out},ScatterGeo.selectPoints=function selectPoints(searchInfo,polygon){var di,lonlat,x,y,i,cd=searchInfo.cd,xa=searchInfo.xaxis,ya=searchInfo.yaxis,selection=[],trace=cd[0].trace;if(!_$subtypes_884.hasMarkers(trace)&&!_$subtypes_884.hasText(trace))return[];if(!1===polygon)for(i=0;i<cd.length;i++)cd[i].selected=0;else for(i=0;i<cd.length;i++)lonlat=(di=cd[i]).lonlat,x=xa.c2p(lonlat),y=ya.c2p(lonlat),polygon.contains([x,y])?(selection.push({pointNumber:i,lon:lonlat[0],lat:lonlat[1]}),di.selected=1):di.selected=0;return selection},ScatterGeo.moduleType="trace",ScatterGeo.name="scattergeo",ScatterGeo.basePlotModule=_$geo_615,ScatterGeo.categories=["geo","symbols","markerColorscale","showLegend","scatter-like"],ScatterGeo.meta={};var _$scattergeo_29=ScatterGeo,_$newArray_50=function newArray(start,end){var n0="number"==typeof start,n1="number"==typeof end;n0&&!n1?(end=start,start=0):n0||n1||(start=0,end=0);var len=(end|=0)-(start|=0);if(len<0)throw new Error("array length must be positive");for(var a=new Array(len),i=0,c=start;i<len;i++,c++)a[i]=c;return a},_$KDTree_252=KDTree;function KDTree(points,nodeSize){if(!(this instanceof KDTree))return new KDTree(points,nodeSize);this.nodeSize=nodeSize||64,this.coords=points.slice();var l=Math.floor(points.length/2);this.ids=Array(l);for(var i=0;i<l;i++)this.ids[i]=i;!function sortKD(ids,coords,nodeSize,left,right,depth){if(right-left<=nodeSize)return;var m=Math.floor((left+right)/2);!function __select_252(ids,coords,k,left,right,inc){for(;right>left;){if(right-left>600){var n=right-left+1,m=k-left+1,z=Math.log(n),s=.5*Math.exp(2*z/3),sd=.5*Math.sqrt(z*s*(n-s)/n)*(m-n/2<0?-1:1),newLeft=Math.max(left,Math.floor(k-m*s/n+sd)),newRight=Math.min(right,Math.floor(k+(n-m)*s/n+sd));__select_252(ids,coords,k,newLeft,newRight,inc)}var t=coords[2*k+inc],i=left,j=right;for(swapItem(ids,coords,left,k),coords[2*right+inc]>t&&swapItem(ids,coords,left,right);i<j;){for(swapItem(ids,coords,i,j),i++,j--;coords[2*i+inc]<t;)i++;for(;coords[2*j+inc]>t;)j--}coords[2*left+inc]===t?swapItem(ids,coords,left,j):swapItem(ids,coords,++j,right),j<=k&&(left=j+1),k<=j&&(right=j-1)}}(ids,coords,m,left,right,depth%2);sortKD(ids,coords,nodeSize,left,m-1,depth+1);sortKD(ids,coords,nodeSize,m+1,right,depth+1)}(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function sqDist(ax,ay,bx,by){var dx=ax-bx,dy=ay-by;return dx*dx+dy*dy}function swapItem(ids,coords,i,j){__swap_252(ids,i,j),__swap_252(coords,2*i,2*j),__swap_252(coords,2*i+1,2*j+1)}function __swap_252(arr,i,j){var tmp=arr[i];arr[i]=arr[j],arr[j]=tmp}KDTree.prototype.range=function range(minX,minY,maxX,maxY){for(var x,y,ids=this.ids,coords=this.coords,nodeSize=this.nodeSize,stack=[0,ids.length-1,0],result=[];stack.length;){var axis=stack.pop(),right=stack.pop(),left=stack.pop();if(right-left<=nodeSize)for(var i=left;i<=right;i++)x=coords[2*i],y=coords[2*i+1],x>=minX&&x<=maxX&&y>=minY&&y<=maxY&&result.push(ids[i]);else{var m=Math.floor((left+right)/2);x=coords[2*m],y=coords[2*m+1],x>=minX&&x<=maxX&&y>=minY&&y<=maxY&&result.push(ids[m]);var nextAxis=(axis+1)%2;(0===axis?minX<=x:minY<=y)&&(stack.push(left),stack.push(m-1),stack.push(nextAxis)),(0===axis?maxX>=x:maxY>=y)&&(stack.push(m+1),stack.push(right),stack.push(nextAxis))}}return result},KDTree.prototype.within=function within(qx,qy,r){for(var ids=this.ids,coords=this.coords,nodeSize=this.nodeSize,stack=[0,ids.length-1,0],result=[],r2=r*r;stack.length;){var axis=stack.pop(),right=stack.pop(),left=stack.pop();if(right-left<=nodeSize)for(var i=left;i<=right;i++)sqDist(coords[2*i],coords[2*i+1],qx,qy)<=r2&&result.push(ids[i]);else{var m=Math.floor((left+right)/2),x=coords[2*m],y=coords[2*m+1];sqDist(x,y,qx,qy)<=r2&&result.push(ids[m]);var nextAxis=(axis+1)%2;(0===axis?qx-r<=x:qy-r<=y)&&(stack.push(left),stack.push(m-1),stack.push(nextAxis)),(0===axis?qx+r>=x:qy+r>=y)&&(stack.push(m+1),stack.push(right),stack.push(nextAxis))}}return result};var _$normalize_48=function __normalize_48(arr,dim){if(!arr||null==arr.length)throw Error("Argument should be an array");dim=null==dim?1:Math.floor(dim);for(var bounds=Array(2*dim),offset=0;offset<dim;offset++){for(var max=-1/0,min=1/0,i=offset,l=arr.length;i<l;i+=dim)arr[i]>max&&(max=arr[i]),arr[i]<min&&(min=arr[i]);bounds[offset]=min,bounds[dim+offset]=max}return bounds};var _$flattenVertexData_141=function flattenVertexData(data,output,offset){if(!data)throw new TypeError("must specify data as first parameter");if(offset=0|+(offset||0),Array.isArray(data)&&Array.isArray(data[0])){var dim=data[0].length,length=data.length*dim;output&&"string"!=typeof output||(output=new(_$dtype_132(output||"float32"))(length+offset));var dstLength=output.length-offset;if(length!==dstLength)throw new Error("source length "+length+" ("+dim+"x"+data.length+") does not match destination length "+dstLength);for(var i=0,k=offset;i<data.length;i++)for(var j=0;j<dim;j++)output[k++]=data[i][j]}else if(output&&"string"!=typeof output)output.set(data,offset);else{var Ctor=_$dtype_132(output||"float32");0===offset?output=new Ctor(data):(output=new Ctor(data.length+offset)).set(data,offset)}return output};var _$pick_290=function pick(src,props,keepRest){var prop,i,result={};if("string"==typeof props&&(props=toList(props)),Array.isArray(props)){var res={};for(i=0;i<props.length;i++)res[props[i]]=!0;props=res}for(prop in props)props[prop]=toList(props[prop]);var occupied={};for(prop in props){var aliases=props[prop];if(Array.isArray(aliases))for(i=0;i<aliases.length;i++){var alias=aliases[i];if(keepRest&&(occupied[alias]=!0),alias in src){if(result[prop]=src[alias],keepRest)for(var j=i;j<aliases.length;j++)occupied[aliases[j]]=!0;break}}else prop in src&&(props[prop]&&(result[prop]=src[prop]),keepRest&&(occupied[prop]=!0))}if(keepRest)for(prop in src)occupied[prop]||(result[prop]=src[prop]);return result},__CACHE_290={};function toList(arg){return __CACHE_290[arg]?__CACHE_290[arg]:("string"==typeof arg&&(arg=__CACHE_290[arg]=arg.split(/\s*,\s*|\s+/)),arg)}var _$toFloat32_353={};function float32(arr){if(arr instanceof Float32Array)return arr;if("number"==typeof arr)return new Float32Array([arr])[0];var float=new Float32Array(arr);return float.set(arr),float}(_$toFloat32_353=float32).float32=_$toFloat32_353.float=float32,_$toFloat32_353.fract32=_$toFloat32_353.fract=function fract32(arr){if("number"==typeof arr)return float32(arr-float32(arr));for(var fract=float32(arr),i=0,l=fract.length;i<l;i++)fract[i]=arr[i]-fract[i];return fract};var _$updateDiff_363=function updateDiff(obj,diff,mappers){Array.isArray(mappers)||(mappers=[].slice.call(arguments,2));for(var i=0,l=mappers.length;i<l;i++){var dict=mappers[i];for(var prop in dict)if((void 0===diff[prop]||Array.isArray(diff[prop])||obj[prop]!==diff[prop])&&prop in diff){var result;if(!0===dict[prop])result=diff[prop];else{if(!1===dict[prop])continue;if("function"==typeof dict[prop]&&void 0===(result=dict[prop](diff[prop],obj,diff)))continue}obj[prop]=result}}return obj},__float32_311=_$toFloat32_353.float32,__fract32_311=_$toFloat32_353.fract32,_$Error2D_311=function Error2D(regl,options){"function"==typeof regl?(options||(options={}),options.regl=regl):options=regl;options.length&&(options.positions=options);if(!(regl=options.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var drawErrors,positionBuffer,positionFractBuffer,colorBuffer,errorBuffer,meshBuffer,gl=regl._gl,defaults={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},groups=[];return colorBuffer=regl.buffer({usage:"dynamic",type:"uint8",data:null}),positionBuffer=regl.buffer({usage:"dynamic",type:"float",data:null}),positionFractBuffer=regl.buffer({usage:"dynamic",type:"float",data:null}),errorBuffer=regl.buffer({usage:"dynamic",type:"float",data:null}),meshBuffer=regl.buffer({usage:"static",type:"float",data:__WEIGHTS_311}),update(options),drawErrors=regl({vert:"\n\t\tprecision highp float;\n\n\t\tattribute vec2 position, positionFract;\n\t\tattribute vec4 error;\n\t\tattribute vec4 color;\n\n\t\tattribute vec2 direction, lineOffset, capOffset;\n\n\t\tuniform vec4 viewport;\n\t\tuniform float lineWidth, capSize;\n\t\tuniform vec2 scale, scaleFract, translate, translateFract;\n\n\t\tvarying vec4 fragColor;\n\n\t\tvoid main() {\n\t\t\tfragColor = color / 255.;\n\n\t\t\tvec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;\n\n\t\t\tvec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;\n\n\t\t\tvec2 position = position + dxy;\n\n\t\t\tvec2 pos = (position + translate) * scale\n\t\t\t\t+ (positionFract + translateFract) * scale\n\t\t\t\t+ (position + translate) * scaleFract\n\t\t\t\t+ (positionFract + translateFract) * scaleFract;\n\n\t\t\tpos += pixelOffset / viewport.zw;\n\n\t\t\tgl_Position = vec4(pos * 2. - 1., 0, 1);\n\t\t}\n\t\t",frag:"\n\t\tprecision mediump float;\n\n\t\tvarying vec4 fragColor;\n\n\t\tuniform float opacity;\n\n\t\tvoid main() {\n\t\t\tgl_FragColor = fragColor;\n\t\t\tgl_FragColor.a *= opacity;\n\t\t}\n\t\t",uniforms:{range:regl.prop("range"),lineWidth:regl.prop("lineWidth"),capSize:regl.prop("capSize"),opacity:regl.prop("opacity"),scale:regl.prop("scale"),translate:regl.prop("translate"),scaleFract:regl.prop("scaleFract"),translateFract:regl.prop("translateFract"),viewport:function(ctx,prop){return[prop.viewport.x,prop.viewport.y,ctx.viewportWidth,ctx.viewportHeight]}},attributes:{color:{buffer:colorBuffer,offset:function(ctx,prop){return 4*prop.offset},divisor:1},position:{buffer:positionBuffer,offset:function(ctx,prop){return 8*prop.offset},divisor:1},positionFract:{buffer:positionFractBuffer,offset:function(ctx,prop){return 8*prop.offset},divisor:1},error:{buffer:errorBuffer,offset:function(ctx,prop){return 16*prop.offset},divisor:1},direction:{buffer:meshBuffer,stride:24,offset:0},lineOffset:{buffer:meshBuffer,stride:24,offset:8},capOffset:{buffer:meshBuffer,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:regl.prop("viewport")},viewport:regl.prop("viewport"),stencil:!1,instances:regl.prop("count"),count:__WEIGHTS_311.length}),_$objectAssign_281(error2d,{update:update,draw:draw,destroy:destroy,regl:regl,gl:gl,canvas:gl.canvas,groups:groups}),error2d;function error2d(opts){opts?update(opts):null===opts&&destroy(),draw()}function draw(options){if("number"==typeof options)return drawGroup(options);options&&!Array.isArray(options)&&(options=[options]),regl._refresh(),groups.forEach(function(s,i){s&&(options&&(options[i]?s.draw=!0:s.draw=!1),s.draw?drawGroup(i):s.draw=!0)})}function drawGroup(s){"number"==typeof s&&(s=groups[s]),null!=s&&s&&s.count&&s.color&&s.opacity&&s.positions&&s.positions.length>1&&(s.scaleRatio=[s.scale[0]*s.viewport.width,s.scale[1]*s.viewport.height],drawErrors(s),s.after&&s.after(s))}function update(options){if(options){null!=options.length?"number"==typeof options[0]&&(options=[{positions:options}]):Array.isArray(options)||(options=[options]);var pointCount=0,errorCount=0;if(groups=options.map(function(options,i){var group=groups[i];return options?("function"==typeof options?options={after:options}:"number"==typeof options[0]&&(options={positions:options}),options=_$pick_290(options,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),group||(groups[i]=group={id:i,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},options=_$objectAssign_281({},defaults,options)),_$updateDiff_363(group,options,[{lineWidth:function(v){return.5*+v},capSize:function(v){return.5*+v},opacity:parseFloat,errors:function(errors){return errors=_$flattenVertexData_141(errors),errorCount+=errors.length,errors},positions:function(positions,state){return positions=_$flattenVertexData_141(positions,"float64"),state.count=Math.floor(positions.length/2),state.bounds=_$normalize_48(positions,2),state.offset=pointCount,pointCount+=state.count,positions}},{color:function(colors,state){var count=state.count;if(colors||(colors="transparent"),!Array.isArray(colors)||"number"==typeof colors[0]){var color=colors;colors=Array(count);for(var i=0;i<count;i++)colors[i]=color}if(colors.length<count)throw Error("Not enough colors");for(var colorData=new Uint8Array(4*count),i$1=0;i$1<count;i$1++){var c=_$normalize_99(colors[i$1],"uint8");colorData.set(c,4*i$1)}return colorData},range:function(range,state,options){var bounds=state.bounds;return range||(range=bounds),state.scale=[1/(range[2]-range[0]),1/(range[3]-range[1])],state.translate=[-range[0],-range[1]],state.scaleFract=__fract32_311(state.scale),state.translateFract=__fract32_311(state.translate),range},viewport:function(vp){var viewport;return Array.isArray(vp)?viewport={x:vp[0],y:vp[1],width:vp[2]-vp[0],height:vp[3]-vp[1]}:vp?(viewport={x:vp.x||vp.left||0,y:vp.y||vp.top||0},vp.right?viewport.width=vp.right-viewport.x:viewport.width=vp.w||vp.width||0,vp.bottom?viewport.height=vp.bottom-viewport.y:viewport.height=vp.h||vp.height||0):viewport={x:0,y:0,width:gl.drawingBufferWidth,height:gl.drawingBufferHeight},viewport}}]),group):group}),pointCount||errorCount){var len=groups.reduce(function(acc,group,i){return acc+(group?group.count:0)},0),positionData=new Float64Array(2*len),colorData=new Uint8Array(4*len),errorData=new Float32Array(4*len);groups.forEach(function(group,i){if(group){var positions=group.positions,count=group.count,offset=group.offset,color=group.color,errors=group.errors;count&&(colorData.set(color,4*offset),errorData.set(errors,4*offset),positionData.set(positions,2*offset))}}),positionBuffer(__float32_311(positionData)),positionFractBuffer(__fract32_311(positionData)),colorBuffer(colorData),errorBuffer(errorData)}}}function destroy(){positionBuffer.destroy(),positionFractBuffer.destroy(),colorBuffer.destroy(),errorBuffer.destroy(),meshBuffer.destroy()}},__WEIGHTS_311=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]];var _$normalize_49=function __normalize_49(arr,dim,bounds){if(!arr||null==arr.length)throw Error("Argument should be an array");null==dim&&(dim=1);null==bounds&&(bounds=_$normalize_48(arr,dim));for(var offset=0;offset<dim;offset++){var max=bounds[dim+offset],min=bounds[offset],i=offset,l=arr.length;if(max===1/0&&min===-1/0)for(i=offset;i<l;i+=dim)arr[i]=arr[i]===max?1:arr[i]===min?0:.5;else if(max===1/0)for(i=offset;i<l;i+=dim)arr[i]=arr[i]===max?1:0;else if(min===-1/0)for(i=offset;i<l;i+=dim)arr[i]=arr[i]===min?0:1;else{var range=max-min;for(i=offset;i<l;i+=dim)arr[i]=0===range?.5:(arr[i]-min)/range}}return arr};var _$earcut_134={};function earcut(data,holeIndices,dim){dim=dim||2;var minX,minY,maxX,maxY,x,y,invSize,hasHoles=holeIndices&&holeIndices.length,outerLen=hasHoles?holeIndices[0]*dim:data.length,outerNode=linkedList(data,0,outerLen,dim,!0),triangles=[];if(!outerNode)return triangles;if(hasHoles&&(outerNode=function eliminateHoles(data,holeIndices,outerNode,dim){var i,len,start,end,list,queue=[];for(i=0,len=holeIndices.length;i<len;i++)start=holeIndices[i]*dim,end=i<len-1?holeIndices[i+1]*dim:data.length,(list=linkedList(data,start,end,dim,!1))===list.next&&(list.steiner=!0),queue.push(getLeftmost(list));for(queue.sort(compareX),i=0;i<queue.length;i++)eliminateHole(queue[i],outerNode),outerNode=filterPoints(outerNode,outerNode.next);return outerNode}(data,holeIndices,outerNode,dim)),data.length>80*dim){minX=maxX=data[0],minY=maxY=data[1];for(var i=dim;i<outerLen;i+=dim)x=data[i],y=data[i+1],x<minX&&(minX=x),y<minY&&(minY=y),x>maxX&&(maxX=x),y>maxY&&(maxY=y);invSize=0!==(invSize=Math.max(maxX-minX,maxY-minY))?1/invSize:0}return earcutLinked(outerNode,triangles,dim,minX,minY,invSize),triangles}function linkedList(data,start,end,dim,clockwise){var i,last;if(clockwise===signedArea(data,start,end,dim)>0)for(i=start;i<end;i+=dim)last=insertNode(i,data[i],data[i+1],last);else for(i=end-dim;i>=start;i-=dim)last=insertNode(i,data[i],data[i+1],last);return last&&equals(last,last.next)&&(removeNode(last),last=last.next),last}function filterPoints(start,end){if(!start)return start;end||(end=start);var again,p=start;do{if(again=!1,p.steiner||!equals(p,p.next)&&0!==area(p.prev,p,p.next))p=p.next;else{if(removeNode(p),(p=end=p.prev)===p.next)break;again=!0}}while(again||p!==end);return end}function earcutLinked(ear,triangles,dim,minX,minY,invSize,pass){if(ear){!pass&&invSize&&function indexCurve(start,minX,minY,invSize){var p=start;do{null===p.z&&(p.z=zOrder(p.x,p.y,minX,minY,invSize)),p.prevZ=p.prev,p.nextZ=p.next,p=p.next}while(p!==start);p.prevZ.nextZ=null,p.prevZ=null,function sortLinked(list){var i,p,q,e,tail,numMerges,pSize,qSize,inSize=1;do{for(p=list,list=null,tail=null,numMerges=0;p;){for(numMerges++,q=p,pSize=0,i=0;i<inSize&&(pSize++,q=q.nextZ);i++);for(qSize=inSize;pSize>0||qSize>0&&q;)0!==pSize&&(0===qSize||!q||p.z<=q.z)?(e=p,p=p.nextZ,pSize--):(e=q,q=q.nextZ,qSize--),tail?tail.nextZ=e:list=e,e.prevZ=tail,tail=e;p=q}tail.nextZ=null,inSize*=2}while(numMerges>1);return list}(p)}(ear,minX,minY,invSize);for(var prev,next,stop=ear;ear.prev!==ear.next;)if(prev=ear.prev,next=ear.next,invSize?isEarHashed(ear,minX,minY,invSize):isEar(ear))triangles.push(prev.i/dim),triangles.push(ear.i/dim),triangles.push(next.i/dim),removeNode(ear),ear=next.next,stop=next.next;else if((ear=next)===stop){pass?1===pass?earcutLinked(ear=cureLocalIntersections(ear,triangles,dim),triangles,dim,minX,minY,invSize,2):2===pass&&splitEarcut(ear,triangles,dim,minX,minY,invSize):earcutLinked(filterPoints(ear),triangles,dim,minX,minY,invSize,1);break}}}function isEar(ear){var a=ear.prev,b=ear,c=ear.next;if(area(a,b,c)>=0)return!1;for(var p=ear.next.next;p!==ear.prev;){if(pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function isEarHashed(ear,minX,minY,invSize){var a=ear.prev,b=ear,c=ear.next;if(area(a,b,c)>=0)return!1;for(var minTX=a.x<b.x?a.x<c.x?a.x:c.x:b.x<c.x?b.x:c.x,minTY=a.y<b.y?a.y<c.y?a.y:c.y:b.y<c.y?b.y:c.y,maxTX=a.x>b.x?a.x>c.x?a.x:c.x:b.x>c.x?b.x:c.x,maxTY=a.y>b.y?a.y>c.y?a.y:c.y:b.y>c.y?b.y:c.y,minZ=zOrder(minTX,minTY,minX,minY,invSize),maxZ=zOrder(maxTX,maxTY,minX,minY,invSize),p=ear.prevZ,n=ear.nextZ;p&&p.z>=minZ&&n&&n.z<=maxZ;){if(p!==ear.prev&&p!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,n!==ear.prev&&n!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,n.x,n.y)&&area(n.prev,n,n.next)>=0)return!1;n=n.nextZ}for(;p&&p.z>=minZ;){if(p!==ear.prev&&p!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;n&&n.z<=maxZ;){if(n!==ear.prev&&n!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,n.x,n.y)&&area(n.prev,n,n.next)>=0)return!1;n=n.nextZ}return!0}function cureLocalIntersections(start,triangles,dim){var p=start;do{var a=p.prev,b=p.next.next;!equals(a,b)&&intersects(a,p,p.next,b)&&locallyInside(a,b)&&locallyInside(b,a)&&(triangles.push(a.i/dim),triangles.push(p.i/dim),triangles.push(b.i/dim),removeNode(p),removeNode(p.next),p=start=b),p=p.next}while(p!==start);return p}function splitEarcut(start,triangles,dim,minX,minY,invSize){var a=start;do{for(var b=a.next.next;b!==a.prev;){if(a.i!==b.i&&isValidDiagonal(a,b)){var c=__splitPolygon_134(a,b);return a=filterPoints(a,a.next),c=filterPoints(c,c.next),earcutLinked(a,triangles,dim,minX,minY,invSize),void earcutLinked(c,triangles,dim,minX,minY,invSize)}b=b.next}a=a.next}while(a!==start)}function compareX(a,b){return a.x-b.x}function eliminateHole(hole,outerNode){if(outerNode=function findHoleBridge(hole,outerNode){var m,p=outerNode,hx=hole.x,hy=hole.y,qx=-1/0;do{if(hy<=p.y&&hy>=p.next.y&&p.next.y!==p.y){var x=p.x+(hy-p.y)*(p.next.x-p.x)/(p.next.y-p.y);if(x<=hx&&x>qx){if(qx=x,x===hx){if(hy===p.y)return p;if(hy===p.next.y)return p.next}m=p.x<p.next.x?p:p.next}}p=p.next}while(p!==outerNode);if(!m)return null;if(hx===qx)return m.prev;var tan,stop=m,mx=m.x,my=m.y,tanMin=1/0;p=m.next;for(;p!==stop;)hx>=p.x&&p.x>=mx&&hx!==p.x&&pointInTriangle(hy<my?hx:qx,hy,mx,my,hy<my?qx:hx,hy,p.x,p.y)&&((tan=Math.abs(hy-p.y)/(hx-p.x))<tanMin||tan===tanMin&&p.x>m.x)&&locallyInside(p,hole)&&(m=p,tanMin=tan),p=p.next;return m}(hole,outerNode)){var b=__splitPolygon_134(outerNode,hole);filterPoints(b,b.next)}}function zOrder(x,y,minX,minY,invSize){return(x=1431655765&((x=858993459&((x=252645135&((x=16711935&((x=32767*(x-minX)*invSize)|x<<8))|x<<4))|x<<2))|x<<1))|(y=1431655765&((y=858993459&((y=252645135&((y=16711935&((y=32767*(y-minY)*invSize)|y<<8))|y<<4))|y<<2))|y<<1))<<1}function getLeftmost(start){var p=start,leftmost=start;do{p.x<leftmost.x&&(leftmost=p),p=p.next}while(p!==start);return leftmost}function pointInTriangle(ax,ay,bx,by,cx,cy,px,py){return(cx-px)*(ay-py)-(ax-px)*(cy-py)>=0&&(ax-px)*(by-py)-(bx-px)*(ay-py)>=0&&(bx-px)*(cy-py)-(cx-px)*(by-py)>=0}function isValidDiagonal(a,b){return a.next.i!==b.i&&a.prev.i!==b.i&&!function intersectsPolygon(a,b){var p=a;do{if(p.i!==a.i&&p.next.i!==a.i&&p.i!==b.i&&p.next.i!==b.i&&intersects(p,p.next,a,b))return!0;p=p.next}while(p!==a);return!1}(a,b)&&locallyInside(a,b)&&locallyInside(b,a)&&function middleInside(a,b){var p=a,inside=!1,px=(a.x+b.x)/2,py=(a.y+b.y)/2;do{p.y>py!=p.next.y>py&&p.next.y!==p.y&&px<(p.next.x-p.x)*(py-p.y)/(p.next.y-p.y)+p.x&&(inside=!inside),p=p.next}while(p!==a);return inside}(a,b)}function area(p,q,r){return(q.y-p.y)*(r.x-q.x)-(q.x-p.x)*(r.y-q.y)}function equals(p1,p2){return p1.x===p2.x&&p1.y===p2.y}function intersects(p1,q1,p2,q2){return!!(equals(p1,q1)&&equals(p2,q2)||equals(p1,q2)&&equals(p2,q1))||area(p1,q1,p2)>0!=area(p1,q1,q2)>0&&area(p2,q2,p1)>0!=area(p2,q2,q1)>0}function locallyInside(a,b){return area(a.prev,a,a.next)<0?area(a,b,a.next)>=0&&area(a,a.prev,b)>=0:area(a,b,a.prev)<0||area(a,a.next,b)<0}function __splitPolygon_134(a,b){var a2=new Node(a.i,a.x,a.y),b2=new Node(b.i,b.x,b.y),an=a.next,bp=b.prev;return a.next=b,b.prev=a,a2.next=an,an.prev=a2,b2.next=a2,a2.prev=b2,bp.next=b2,b2.prev=bp,b2}function insertNode(i,x,y,last){var p=new Node(i,x,y);return last?(p.next=last.next,p.prev=last,last.next.prev=p,last.next=p):(p.prev=p,p.next=p),p}function removeNode(p){p.next.prev=p.prev,p.prev.next=p.next,p.prevZ&&(p.prevZ.nextZ=p.nextZ),p.nextZ&&(p.nextZ.prevZ=p.prevZ)}function Node(i,x,y){this.i=i,this.x=x,this.y=y,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(data,start,end,dim){for(var sum=0,i=start,j=end-dim;i<end;i+=dim)sum+=(data[j]-data[i])*(data[i+1]+data[j+1]),j=i;return sum}(_$earcut_134=earcut).default=earcut,earcut.deviation=function(data,holeIndices,dim,triangles){var hasHoles=holeIndices&&holeIndices.length,outerLen=hasHoles?holeIndices[0]*dim:data.length,polygonArea=Math.abs(signedArea(data,0,outerLen,dim));if(hasHoles)for(var i=0,len=holeIndices.length;i<len;i++){var start=holeIndices[i]*dim,end=i<len-1?holeIndices[i+1]*dim:data.length;polygonArea-=Math.abs(signedArea(data,start,end,dim))}var trianglesArea=0;for(i=0;i<triangles.length;i+=3){var a=triangles[i]*dim,b=triangles[i+1]*dim,c=triangles[i+2]*dim;trianglesArea+=Math.abs((data[a]-data[c])*(data[b+1]-data[a+1])-(data[a]-data[b])*(data[c+1]-data[a+1]))}return 0===polygonArea&&0===trianglesArea?0:Math.abs((trianglesArea-polygonArea)/polygonArea)},earcut.flatten=function(data){for(var dim=data[0][0].length,result={vertices:[],holes:[],dimensions:dim},holeIndex=0,i=0;i<data.length;i++){for(var j=0;j<data[i].length;j++)for(var d=0;d<dim;d++)result.vertices.push(data[i][j][d]);i>0&&(holeIndex+=data[i-1].length,result.holes.push(holeIndex))}return result};var _$createLine_312=function __createLine_312(regl,options){"function"==typeof regl?(options||(options={}),options.regl=regl):options=regl;options.length&&(options.positions=options);if(!(regl=options.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var drawMiterLine,drawRectLine,drawFill,colorBuffer,offsetBuffer,positionBuffer,positionFractBuffer,dashTexture,gl=regl._gl,defaults={positions:[],dashes:null,join:null,miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:null,fill:null},lines=[],dashMult=2,precisionThreshold=3e6,maxPoints=1e4;colorBuffer=regl.buffer({usage:"dynamic",type:"uint8",data:null}),offsetBuffer=regl.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),positionBuffer=regl.buffer({usage:"dynamic",type:"float",data:null}),positionFractBuffer=regl.buffer({usage:"dynamic",type:"float",data:null}),dashTexture=regl.texture({channels:1,data:new Uint8Array(524288),width:256,height:2048,mag:"linear",min:"linear"}),update(options);var shaderOptions={primitive:"triangle strip",instances:regl.prop("count"),count:4,offset:0,uniforms:{miterMode:function(ctx,prop){return"round"===prop.join?2:1},miterLimit:regl.prop("miterLimit"),scale:regl.prop("scale"),scaleFract:regl.prop("scaleFract"),translateFract:regl.prop("translateFract"),translate:regl.prop("translate"),thickness:regl.prop("thickness"),dashPattern:dashTexture,dashLength:regl.prop("dashLength"),dashShape:[256,2048],opacity:regl.prop("opacity"),pixelRatio:regl.context("pixelRatio"),id:regl.prop("id"),scaleRatio:regl.prop("scaleRatio"),viewport:function(ctx,prop){return[prop.viewport.x,prop.viewport.y,ctx.viewportWidth,ctx.viewportHeight]}},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(ctx,prop){return!prop.overlay}},scissor:{enable:!0,box:regl.prop("viewport")},stencil:!1,viewport:regl.prop("viewport")};function line2d(opts){opts?update(opts):null===opts&&destroy(),draw()}function draw(options){if("number"==typeof options)return drawLine(options);options&&!Array.isArray(options)&&(options=[options]),lines.forEach(function(s,i){drawLine(i)})}function drawLine(s){"number"==typeof s&&(s=lines[s]),s&&s.count&&s.opacity&&s.positions&&s.positions.length>2&&(regl._refresh(),s.fill&&s.triangles&&s.triangles.length>2&&drawFill(s),s.thickness&&s.color&&(s.scaleRatio=[s.scale[0]*s.viewport.width,s.scale[1]*s.viewport.height],s.scaleRatio[0]>precisionThreshold||s.scaleRatio[1]>precisionThreshold?drawRectLine(s):"rect"===s.join||!s.join&&(s.thickness<=2||s.positions.length>=maxPoints)?drawRectLine(s):drawMiterLine(s),s.after&&s.after(s)))}function update(options){if(options){null!=options.length?"number"==typeof options[0]&&(options=[{positions:options}]):Array.isArray(options)||(options=[options]);var pointCount=0;if(line2d.lines=lines=options.map(function(options,i){var state=lines[i];return void 0===options?state:(null===options?options={positions:null}:"function"==typeof options?options={after:options}:"number"==typeof options[0]&&(options={positions:options}),null===(options=_$pick_290(options,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color stroke colors stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow",after:"after callback done pass"})).positions&&(options.positions=[]),state||(lines[i]=state={id:i,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,offset:0,dashLength:0,hole:!0},options=_$objectAssign_281({},defaults,options)),_$updateDiff_363(state,options,[{thickness:parseFloat,opacity:parseFloat,miterLimit:parseFloat,overlay:Boolean,join:function(j){return j},after:function(fn){return fn},hole:function(h){return h||[]},positions:function(positions,state,options){positions=_$flattenVertexData_141(positions,"float64");var count=Math.floor(positions.length/2),bounds=_$normalize_48(positions,2);return state.range||options.range||(options.range=bounds),state.count=count,state.bounds=bounds,pointCount+=count,positions},fill:function(c){return c?_$normalize_99(c,"uint8"):null},dashes:function(dashes,state,options){var dashData,dashLength=state.dashLength;if(!dashes||dashes.length<2)dashLength=1,dashData=new Uint8Array([255,255,255,255,255,255,255,255]);else{dashLength=0;for(var i=0;i<dashes.length;++i)dashLength+=dashes[i];dashData=new Uint8Array(dashLength*dashMult);for(var ptr=0,fillColor=255,k=0;k<2;k++)for(var i$1=0;i$1<dashes.length;++i$1){for(var j=0,l=dashes[i$1]*dashMult*.5;j<l;++j)dashData[ptr++]=fillColor;fillColor^=255}}return dashTexture.subimage({data:dashData,width:dashData.length,height:1},0,state.id),state.dashLength=dashLength,dashData}},{close:function(close,state,options){return null!=close?close:state.positions.length>=4&&state.positions[0]===state.positions[state.positions.length-2]&&state.positions[1]===state.positions[state.positions.length-1]},positions:function(p,state,options){if(state.fill&&p.length){for(var pos=[],ids={},lastId=0,i=0,ptr=0,l=state.count;i<l;i++){var x=state.positions[2*i],y=state.positions[2*i+1];Number.isNaN(x)||Number.isNaN(y)?(x=state.positions[2*lastId],y=state.positions[2*lastId+1],ids[i]=lastId):lastId=i,pos[ptr++]=x,pos[ptr++]=y}for(var triangles=_$earcut_134(pos,state.hole),i$1=0,l$1=triangles.length;i$1<l$1;i$1++)null!=ids[triangles[i$1]]&&(triangles[i$1]=ids[triangles[i$1]]);state.triangles=triangles}return state.positions},color:function(colors,state,options){var count=state.count;if(colors||(colors="transparent"),!Array.isArray(colors)||"number"==typeof colors[0]){var color=colors;colors=Array(count);for(var i=0;i<count;i++)colors[i]=color}if(colors.length<count)throw Error("Not enough colors");for(var colorData=new Uint8Array(4*count+4),i$1=0;i$1<count;i$1++){var c=_$normalize_99(colors[i$1],"uint8");colorData.set(c,4*i$1)}return colorData},range:function(range,state,options){if(!state.count)return null;var bounds=state.bounds;range||(range=bounds);var boundsW=bounds[2]-bounds[0],boundsH=bounds[3]-bounds[1],rangeW=range[2]-range[0],rangeH=range[3]-range[1];return state.scale=[boundsW/rangeW,boundsH/rangeH],state.translate=[-range[0]/rangeW+bounds[0]/rangeW||0,-range[1]/rangeH+bounds[1]/rangeH||0],state.scaleFract=__fract32_312(state.scale),state.translateFract=__fract32_312(state.translate),range},viewport:function(vp){var viewport;return Array.isArray(vp)?viewport={x:vp[0],y:vp[1],width:vp[2]-vp[0],height:vp[3]-vp[1]}:vp?(viewport={x:vp.x||vp.left||0,y:vp.y||vp.top||0},vp.right?viewport.width=vp.right-viewport.x:viewport.width=vp.w||vp.width||0,vp.bottom?viewport.height=vp.bottom-viewport.y:viewport.height=vp.h||vp.height||0):viewport={x:0,y:0,width:gl.drawingBufferWidth,height:gl.drawingBufferHeight},viewport}}]),state)}),pointCount){var len=2*pointCount+6*lines.length,positionData=new Float64Array(len),offset=0,colorData=new Uint8Array(2*len);lines.forEach(function(state,i){if(state){var positions=state.positions,count=state.count,color=state.color;if(state.offset=offset,count){var npos=new Float64Array(positions.length);npos.set(positions),_$normalize_49(npos,2,state.bounds),state.close?positions[0]===positions[2*count-2]&&positions[1]===positions[2*count-1]?(positionData[2*offset+0]=npos[2*count-4],positionData[2*offset+1]=npos[2*count-3]):(positionData[2*offset+0]=npos[2*count-2],positionData[2*offset+1]=npos[2*count-1]):(positionData[2*offset+0]=npos[0],positionData[2*offset+1]=npos[1]),colorData[4*offset+0]=color[0],colorData[4*offset+1]=color[1],colorData[4*offset+2]=color[2],colorData[4*offset+3]=color[3],positionData.set(npos,2*offset+2),colorData.set(color,4*offset+4),state.close?positions[0]===positions[2*count-2]&&positions[1]===positions[2*count-1]?(positionData[2*offset+2*count+2]=npos[2],positionData[2*offset+2*count+3]=npos[3],offset+=count+2,state.count-=1):(positionData[2*offset+2*count+2]=npos[0],positionData[2*offset+2*count+3]=npos[1],positionData[2*offset+2*count+4]=npos[2],positionData[2*offset+2*count+5]=npos[3],offset+=count+3):(positionData[2*offset+2*count+2]=npos[2*count-2],positionData[2*offset+2*count+3]=npos[2*count-1],positionData[2*offset+2*count+4]=npos[2*count-2],positionData[2*offset+2*count+5]=npos[2*count-1],offset+=count+3)}}}),colorBuffer(colorData),positionBuffer(function __float32_312(arr){if(arr instanceof Float32Array)return arr;var float=new Float32Array(arr);return float.set(arr),float}(positionData)),positionFractBuffer(__fract32_312(positionData))}return line2d}}function destroy(){lines.length=0,colorBuffer.destroy(),offsetBuffer.destroy(),positionBuffer.destroy(),dashTexture.destroy()}return drawMiterLine=regl(_$objectAssign_281({cull:{enable:!0,face:"back"},vert:_$browser_238(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, nextCoord, prevCoord;\nattribute vec4 aColor, bColor;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, translate, scaleRatio;\nuniform float thickness, pixelRatio, id;\nuniform vec4 viewport;\nuniform float miterLimit, dashLength, miterMode;\n\nvarying vec4 fragColor;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 tangent;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nconst float MAX_LINES = 256.;\nconst float REVERSE_THRESHOLD = -.875;\nconst float MIN_DIST = 1.;\n\n//TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead\n//TODO: precalculate dot products, normalize things beforehead etc.\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nbool isNaN( float val ){\n  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;\n}\n\nvoid main() {\n\tvec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;\n\tvec2 normalWidth = thickness / scaleRatio;\n\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineBot = 1. - lineTop;\n\tfloat depth = (MAX_LINES - 1. - id) / MAX_LINES;\n\n\tfragColor = (lineStart * aColor + lineEnd * bColor) / 255.;\n\n\tif (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;\n\n\tif (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);\n\tif (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);\n\n\tvec2 prevDiff = aCoord - prevCoord;\n\tvec2 currDiff = bCoord - aCoord;\n\tvec2 nextDiff = nextCoord - bCoord;\n\n\tvec2 prevDirection = normalize(prevDiff);\n\tvec2 currDirection = normalize(currDiff);\n\tvec2 nextDirection = normalize(nextDiff);\n\n\tvec2 prevTangent = normalize(prevDiff * scaleRatio);\n\tvec2 currTangent = normalize(currDiff * scaleRatio);\n\tvec2 nextTangent = normalize(nextDiff * scaleRatio);\n\n\tvec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);\n\tvec2 currNormal = vec2(-currTangent.y, currTangent.x);\n\tvec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);\n\n\tvec2 startJoinDirection = normalize(prevTangent - currTangent);\n\tvec2 endJoinDirection = normalize(currTangent - nextTangent);\n\n\t//collapsed/unidirectional segment cases\n\tif (prevDirection == currDirection) {\n\t\tstartJoinDirection = currNormal;\n\t}\n\tif (nextDirection == currDirection) {\n\t\tendJoinDirection = currNormal;\n\t}\n\tif (aCoord == bCoord) {\n\t\tendJoinDirection = startJoinDirection;\n\t\tcurrNormal = prevNormal;\n\t\tcurrTangent = prevTangent;\n\t}\n\n\ttangent = currTangent;\n\n\t//calculate join shifts relative to normals\n\tfloat startJoinShift = dot(currNormal, startJoinDirection);\n\tfloat endJoinShift = dot(currNormal, endJoinDirection);\n\n\tfloat startMiterRatio = abs(1. / startJoinShift);\n\tfloat endMiterRatio = abs(1. / endJoinShift);\n\n\tvec2 startJoin = startJoinDirection * startMiterRatio;\n\tvec2 endJoin = endJoinDirection * endMiterRatio;\n\n\tvec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;\n\tstartTopJoin = sign(startJoinShift) * startJoin * .5;\n\tstartBotJoin = -startTopJoin;\n\n\tendTopJoin = sign(endJoinShift) * endJoin * .5;\n\tendBotJoin = -endTopJoin;\n\n\tvec2 aTopCoord = aCoord + normalWidth * startTopJoin;\n\tvec2 bTopCoord = bCoord + normalWidth * endTopJoin;\n\tvec2 aBotCoord = aCoord + normalWidth * startBotJoin;\n\tvec2 bBotCoord = bCoord + normalWidth * endBotJoin;\n\n\t//miter anti-clipping\n\tfloat baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));\n\tfloat abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));\n\n\t//prevent close to reverse direction switch\n\tbool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\tbool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\n\tif (prevReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);\n\t\taBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\taTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {\n\t\t//handle miter clipping\n\t\tbTopCoord -= normalWidth * endTopJoin;\n\t\tbTopCoord += normalize(endTopJoin * normalWidth) * baClipping;\n\t}\n\n\tif (nextReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);\n\t\tbBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\tbTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {\n\t\t//handle miter clipping\n\t\taBotCoord -= normalWidth * startBotJoin;\n\t\taBotCoord += normalize(startBotJoin * normalWidth) * abClipping;\n\t}\n\n\tvec2 aTopPosition = (aTopCoord) * scale + translate;\n\tvec2 aBotPosition = (aBotCoord) * scale + translate;\n\n\tvec2 bTopPosition = (bTopCoord) * scale + translate;\n\tvec2 bBotPosition = (bBotCoord) * scale + translate;\n\n\t//position is normalized 0..1 coord on the screen\n\tvec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;\n\n\tstartCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\tendCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\n\tgl_Position = vec4(position  * 2.0 - 1.0, depth, 1);\n\n\tenableStartMiter = step(dot(currTangent, prevTangent), .5);\n\tenableEndMiter = step(dot(currTangent, nextTangent), .5);\n\n\t//bevel miter cutoffs\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n\n\t//round miter cutoffs\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n}\n"]),frag:_$browser_238(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D dashPattern;\nuniform vec2 dashShape;\nuniform float dashLength, pixelRatio, thickness, opacity, id, miterMode;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nvoid main() {\n\tfloat alpha = 1., distToStart, distToEnd;\n\tfloat cutoff = thickness * .5;\n\n\t//bevel miter\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToStart + 1., 0.), 1.);\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToEnd + 1., 0.), 1.);\n\t\t}\n\t}\n\n\t// round miter\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - startCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - endCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\t}\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;\n\tfloat dash = texture2D(dashPattern, vec2(t * dashLength * 2. / dashShape.x, (id + .5) / dashShape.y)).r;\n\n\tgl_FragColor = fragColor * dash;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:offsetBuffer,divisor:0,stride:8,offset:0},lineTop:{buffer:offsetBuffer,divisor:0,stride:8,offset:4},aColor:{buffer:colorBuffer,stride:4,offset:function(ctx,prop){return 4*prop.offset},divisor:1},bColor:{buffer:colorBuffer,stride:4,offset:function(ctx,prop){return 4*prop.offset+4},divisor:1},prevCoord:{buffer:positionBuffer,stride:8,offset:function(ctx,prop){return 8*prop.offset},divisor:1},aCoord:{buffer:positionBuffer,stride:8,offset:function(ctx,prop){return 8+8*prop.offset},divisor:1},bCoord:{buffer:positionBuffer,stride:8,offset:function(ctx,prop){return 16+8*prop.offset},divisor:1},nextCoord:{buffer:positionBuffer,stride:8,offset:function(ctx,prop){return 24+8*prop.offset},divisor:1}}},shaderOptions)),drawRectLine=regl(_$objectAssign_281({vert:_$browser_238(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;\nattribute vec4 color;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, scaleFract, translate, translateFract, scaleRatio;\nuniform float thickness, pixelRatio, id;\nuniform vec4 viewport;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nconst float MAX_LINES = 256.;\n\nvec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {\n\t// the order is important\n\treturn position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n}\n\nvoid main() {\n\t// vec2 scaleRatio = scale * viewport.zw;\n\tvec2 normalWidth = thickness / scaleRatio;\n\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineOffset = lineTop * 2. - 1.;\n\tfloat depth = (MAX_LINES - 1. - id) / (MAX_LINES);\n\n\tvec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);\n\ttangent = normalize(diff * scaleRatio);\n\tvec2 normal = vec2(-tangent.y, tangent.x);\n\n\tvec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart\n\t\t+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd\n\n\t\t+ thickness * normal * .5 * lineOffset / viewport.zw;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n}\n"]),frag:_$browser_238(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D dashPattern;\nuniform vec2 dashShape;\nuniform float dashLength, pixelRatio, thickness, opacity, id;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvoid main() {\n\tfloat alpha = 1.;\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;\n\tfloat dash = texture2D(dashPattern, vec2(t * dashLength * 2. / dashShape.x, (id + .5) / dashShape.y)).r;\n\n\tgl_FragColor = fragColor * dash;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:offsetBuffer,divisor:0,stride:8,offset:0},lineTop:{buffer:offsetBuffer,divisor:0,stride:8,offset:4},aCoord:{buffer:positionBuffer,stride:8,offset:function(ctx,prop){return 8+8*prop.offset},divisor:1},bCoord:{buffer:positionBuffer,stride:8,offset:function(ctx,prop){return 16+8*prop.offset},divisor:1},aCoordFract:{buffer:positionFractBuffer,stride:8,offset:function(ctx,prop){return 8+8*prop.offset},divisor:1},bCoordFract:{buffer:positionFractBuffer,stride:8,offset:function(ctx,prop){return 16+8*prop.offset},divisor:1},color:{buffer:colorBuffer,stride:4,offset:function(ctx,prop){return 4*prop.offset},divisor:1}}},shaderOptions)),drawFill=regl({primitive:"triangle",elements:function(ctx,prop){return prop.triangles},offset:0,vert:_$browser_238(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position, positionFract;\n\nuniform vec4 color;\nuniform vec2 scale, scaleFract, translate, translateFract, scaleRatio;\nuniform float pixelRatio, id;\nuniform vec4 viewport;\n\nvarying vec4 fragColor;\n\nconst float MAX_LINES = 256.;\n\nvoid main() {\n\tfloat depth = (MAX_LINES - 4. - id) / (MAX_LINES);\n\n\tvec2 position = position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n}\n"]),frag:_$browser_238(["precision highp float;\n#define GLSLIFY 1\n\nuniform float opacity;\n\nvarying vec4 fragColor;\n\nvoid main() {\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= opacity;\n}\n"]),uniforms:{scale:regl.prop("scale"),color:regl.prop("fill"),scaleFract:regl.prop("scaleFract"),translateFract:regl.prop("translateFract"),translate:regl.prop("translate"),opacity:regl.prop("opacity"),pixelRatio:regl.context("pixelRatio"),id:regl.prop("id"),viewport:function(ctx,prop){return[prop.viewport.x,prop.viewport.y,ctx.viewportWidth,ctx.viewportHeight]}},attributes:{position:{buffer:positionBuffer,stride:8,offset:function(ctx,prop){return 8+8*prop.offset}},positionFract:{buffer:positionFractBuffer,stride:8,offset:function(ctx,prop){return 8+8*prop.offset}}},blend:shaderOptions.blend,depth:{enable:!1},scissor:shaderOptions.scissor,stencil:shaderOptions.stencil,viewport:shaderOptions.viewport}),_$objectAssign_281(line2d,{update:update,draw:draw,destroy:destroy,regl:regl,gl:gl,canvas:gl.canvas,lines:lines}),line2d};function __fract32_312(arr){var fract=new Float32Array(arr.length);fract.set(arr);for(var i=0,l=fract.length;i<l;i++)fract[i]=arr[i]-fract[i];return fract}var _$colorId_97={};function toNumber(rgba,normalized){null==normalized&&(normalized=!0);var r=rgba[0],g=rgba[1],b=rgba[2],a=rgba[3];return null==a&&(a=normalized?1:255),normalized&&(r*=255,g*=255,b*=255,a*=255),16777216*(r=255&_$clamp_94(r,0,255))+((g=255&_$clamp_94(g,0,255))<<16)+((b=255&_$clamp_94(b,0,255))<<8)+(a=255&_$clamp_94(a,0,255))}(_$colorId_97=toNumber).to=toNumber,_$colorId_97.from=function fromNumber(n,normalized){var r=(n=+n)>>>24,g=(16711680&n)>>>16,b=(65280&n)>>>8,a=255&n;return!1===normalized?[r,g,b,a]:[r/255,g/255,b/255,a/255]};var _$isIexplorer_248="undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)),_$parseRect_285=function parseRect(arg){var rect;arguments.length>1&&(arg=arguments);"string"==typeof arg&&(arg=arg.split(/\s/).map(parseFloat));arg.length&&"number"==typeof arg[0]?rect=2===arg.length?{width:arg[0],height:arg[1],x:0,y:0}:{x:arg[0],y:arg[1],width:arg[2]-arg[0]||0,height:arg[3]-arg[1]||0}:arg&&(arg=_$pick_290(arg,{left:"x l left Left",top:"y t top Top",width:"w width",height:"h height",bottom:"b bottom",right:"r right"}),rect={x:arg.left||0,y:arg.top||0},null==arg.width?arg.right?rect.width=arg.right-rect.x:rect.width=0:rect.width=arg.width,null==arg.height?arg.bottom?rect.height=arg.bottom-rect.y:rect.height=0:rect.height=arg.height);return rect};function __compileSearch_314(funcName,predicate,reversed,extraArgs,earlyOut){var code=["function ",funcName,"(a,l,h,",extraArgs.join(","),"){",earlyOut?"":"var i=",reversed?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a[m]"];return earlyOut?predicate.indexOf("c")<0?code.push(";if(x===y){return m}else if(x<=y){"):code.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):code.push(";if(",predicate,"){i=m;"),reversed?code.push("l=m+1}else{h=m-1}"):code.push("h=m-1}else{l=m+1}"),code.push("}"),earlyOut?code.push("return -1};"):code.push("return i};"),code.join("")}function __compileBoundsSearch_314(predicate,reversed,suffix,earlyOut){return new Function([__compileSearch_314("A","x"+predicate+"y",reversed,["y"],earlyOut),__compileSearch_314("P","c(x,y)"+predicate+"0",reversed,["y","c"],earlyOut),"function dispatchBsearch",suffix,"(a,y,c,l,h){if(typeof(c)==='function'){return P(a,(l===void 0)?0:l|0,(h===void 0)?a.length-1:h|0,y,c)}else{return A(a,(c===void 0)?0:c|0,(l===void 0)?a.length-1:l|0,y)}}return dispatchBsearch",suffix].join(""))()}var _$searchBounds_314={ge:__compileBoundsSearch_314(">=",!1,"GE"),gt:__compileBoundsSearch_314(">",!1,"GT"),lt:__compileBoundsSearch_314("<",!0,"LT"),le:__compileBoundsSearch_314("<=",!0,"LE"),eq:__compileBoundsSearch_314("-",!0,"EQ",!0)},_$sortLevels_340=function sortLevels(data_levels,data_points,data_ids,data_weights,n0){n0<=4*__INSERT_SORT_CUTOFF_340?__insertionSort_340(0,n0-1,data_levels,data_points,data_ids,data_weights):function __quickSort_340(left,right,data_levels,data_points,data_ids,data_weights){var sixth=(right-left+1)/6|0,index1=left+sixth,index5=right-sixth,index3=left+right>>1,index2=index3-sixth,index4=index3+sixth,el1=index1,el2=index2,el3=index3,el4=index4,el5=index5,less=left+1,great=right-1,tmp=0;__compare_340(el1,el2,data_levels,data_points,data_ids)&&(tmp=el1,el1=el2,el2=tmp);__compare_340(el4,el5,data_levels,data_points,data_ids)&&(tmp=el4,el4=el5,el5=tmp);__compare_340(el1,el3,data_levels,data_points,data_ids)&&(tmp=el1,el1=el3,el3=tmp);__compare_340(el2,el3,data_levels,data_points,data_ids)&&(tmp=el2,el2=el3,el3=tmp);__compare_340(el1,el4,data_levels,data_points,data_ids)&&(tmp=el1,el1=el4,el4=tmp);__compare_340(el3,el4,data_levels,data_points,data_ids)&&(tmp=el3,el3=el4,el4=tmp);__compare_340(el2,el5,data_levels,data_points,data_ids)&&(tmp=el2,el2=el5,el5=tmp);__compare_340(el2,el3,data_levels,data_points,data_ids)&&(tmp=el2,el2=el3,el3=tmp);__compare_340(el4,el5,data_levels,data_points,data_ids)&&(tmp=el4,el4=el5,el5=tmp);var pivot1_level=data_levels[el2];var pivot1_x=data_points[2*el2];var pivot1_y=data_points[2*el2+1];var pivot1_id=data_ids[el2];var pivot1_weight=data_weights[el2];var pivot2_level=data_levels[el4];var pivot2_x=data_points[2*el4];var pivot2_y=data_points[2*el4+1];var pivot2_id=data_ids[el4];var pivot2_weight=data_weights[el4];var ptr0=el1;var ptr2=el3;var ptr4=el5;var ptr5=index1;var ptr6=index3;var ptr7=index5;var level_x=data_levels[ptr0];var level_y=data_levels[ptr2];var level_z=data_levels[ptr4];data_levels[ptr5]=level_x;data_levels[ptr6]=level_y;data_levels[ptr7]=level_z;for(var i1=0;i1<2;++i1){var x=data_points[2*ptr0+i1],y=data_points[2*ptr2+i1],z=data_points[2*ptr4+i1];data_points[2*ptr5+i1]=x,data_points[2*ptr6+i1]=y,data_points[2*ptr7+i1]=z}var id_x=data_ids[ptr0];var id_y=data_ids[ptr2];var id_z=data_ids[ptr4];data_ids[ptr5]=id_x;data_ids[ptr6]=id_y;data_ids[ptr7]=id_z;var weight_x=data_weights[ptr0];var weight_y=data_weights[ptr2];var weight_z=data_weights[ptr4];data_weights[ptr5]=weight_x;data_weights[ptr6]=weight_y;data_weights[ptr7]=weight_z;__move_340(index2,left,data_levels,data_points,data_ids,data_weights);__move_340(index4,right,data_levels,data_points,data_ids,data_weights);for(var k=less;k<=great;++k)if(__comparePivot_340(k,pivot1_level,pivot1_x,pivot1_y,pivot1_id,data_levels,data_points,data_ids))k!==less&&__swap_340(k,less,data_levels,data_points,data_ids,data_weights),++less;else if(!__comparePivot_340(k,pivot2_level,pivot2_x,pivot2_y,pivot2_id,data_levels,data_points,data_ids))for(;;){if(__comparePivot_340(great,pivot2_level,pivot2_x,pivot2_y,pivot2_id,data_levels,data_points,data_ids)){__comparePivot_340(great,pivot1_level,pivot1_x,pivot1_y,pivot1_id,data_levels,data_points,data_ids)?(__rotate_340(k,less,great,data_levels,data_points,data_ids,data_weights),++less,--great):(__swap_340(k,great,data_levels,data_points,data_ids,data_weights),--great);break}if(--great<k)break}__shufflePivot_340(left,less-1,pivot1_level,pivot1_x,pivot1_y,pivot1_id,pivot1_weight,data_levels,data_points,data_ids,data_weights);__shufflePivot_340(right,great+1,pivot2_level,pivot2_x,pivot2_y,pivot2_id,pivot2_weight,data_levels,data_points,data_ids,data_weights);less-2-left<=__INSERT_SORT_CUTOFF_340?__insertionSort_340(left,less-2,data_levels,data_points,data_ids,data_weights):__quickSort_340(left,less-2,data_levels,data_points,data_ids,data_weights);right-(great+2)<=__INSERT_SORT_CUTOFF_340?__insertionSort_340(great+2,right,data_levels,data_points,data_ids,data_weights):__quickSort_340(great+2,right,data_levels,data_points,data_ids,data_weights);great-less<=__INSERT_SORT_CUTOFF_340?__insertionSort_340(less,great,data_levels,data_points,data_ids,data_weights):__quickSort_340(less,great,data_levels,data_points,data_ids,data_weights)}(0,n0-1,data_levels,data_points,data_ids,data_weights)},__INSERT_SORT_CUTOFF_340=32;function __insertionSort_340(left,right,data_levels,data_points,data_ids,data_weights){for(var i=left+1;i<=right;++i){for(var a_level=data_levels[i],a_x=data_points[2*i],a_y=data_points[2*i+1],a_id=data_ids[i],a_weight=data_weights[i],j=i;j>left;){var b_level=data_levels[j-1],b_x=data_points[2*(j-1)];if((b_level-a_level||a_x-b_x)>=0)break;data_levels[j]=b_level,data_points[2*j]=b_x,data_points[2*j+1]=data_points[2*j-1],data_ids[j]=data_ids[j-1],data_weights[j]=data_weights[j-1],j-=1}data_levels[j]=a_level,data_points[2*j]=a_x,data_points[2*j+1]=a_y,data_ids[j]=a_id,data_weights[j]=a_weight}}function __swap_340(i,j,data_levels,data_points,data_ids,data_weights){var a_level=data_levels[i],a_x=data_points[2*i],a_y=data_points[2*i+1],a_id=data_ids[i],a_weight=data_weights[i];data_levels[i]=data_levels[j],data_points[2*i]=data_points[2*j],data_points[2*i+1]=data_points[2*j+1],data_ids[i]=data_ids[j],data_weights[i]=data_weights[j],data_levels[j]=a_level,data_points[2*j]=a_x,data_points[2*j+1]=a_y,data_ids[j]=a_id,data_weights[j]=a_weight}function __move_340(i,j,data_levels,data_points,data_ids,data_weights){data_levels[i]=data_levels[j],data_points[2*i]=data_points[2*j],data_points[2*i+1]=data_points[2*j+1],data_ids[i]=data_ids[j],data_weights[i]=data_weights[j]}function __rotate_340(i,j,k,data_levels,data_points,data_ids,data_weights){var a_level=data_levels[i],a_x=data_points[2*i],a_y=data_points[2*i+1],a_id=data_ids[i],a_weight=data_weights[i];data_levels[i]=data_levels[j],data_points[2*i]=data_points[2*j],data_points[2*i+1]=data_points[2*j+1],data_ids[i]=data_ids[j],data_weights[i]=data_weights[j],data_levels[j]=data_levels[k],data_points[2*j]=data_points[2*k],data_points[2*j+1]=data_points[2*k+1],data_ids[j]=data_ids[k],data_weights[j]=data_weights[k],data_levels[k]=a_level,data_points[2*k]=a_x,data_points[2*k+1]=a_y,data_ids[k]=a_id,data_weights[k]=a_weight}function __shufflePivot_340(i,j,a_level,a_x,a_y,a_id,a_weight,data_levels,data_points,data_ids,data_weights){data_levels[i]=data_levels[j],data_points[2*i]=data_points[2*j],data_points[2*i+1]=data_points[2*j+1],data_ids[i]=data_ids[j],data_weights[i]=data_weights[j],data_levels[j]=a_level,data_points[2*j]=a_x,data_points[2*j+1]=a_y,data_ids[j]=a_id,data_weights[j]=a_weight}function __compare_340(i,j,data_levels,data_points,data_ids){return(data_levels[i]-data_levels[j]||data_points[2*j]-data_points[2*i]||data_ids[i]-data_ids[j])<0}function __comparePivot_340(i,level,x,y,id,data_levels,data_points,data_ids){return(level-data_levels[i]||data_points[2*i]-x||id-data_ids[i])<0}var _$snapPoints_341=function snapPoints(points,ids,weights,bounds){var n=points.length>>>1;if(n<1)return[];ids||(ids=Array(n));weights||(weights=Array(n));bounds||(bounds=[]);for(var i=0;i<n;++i)ids[i]=i;if(!bounds.length||bounds.length<4||bounds[0]>=bounds[2]||bounds[1]>=bounds[3]){var b=_$normalize_48(points,2);b[0]===b[2]&&(b[2]+=1),b[1]===b[3]&&(b[3]+=1),bounds[0]=b[0],bounds[1]=b[1],bounds[2]=b[2],bounds[3]=b[3]}var lox=bounds[0],loy=bounds[1],hix=bounds[2],hiy=bounds[3],scaleX=1/(hix-lox),scaleY=1/(hiy-loy),diam=Math.max(hix-lox,hiy-loy),levels=new Int32Array(n),ptr=0;(function snapRec(x,y,diam,start,end,level){var diam_2=.5*diam;var offset=start+1;var count=end-start;weights[ptr]=count;levels[ptr++]=level;for(var i=0;i<2;++i)for(var j=0;j<2;++j){var nx=x+i*diam_2,ny=y+j*diam_2,nextOffset=partition(points,ids,offset,end,nx,ny,nx+diam_2,ny+diam_2);if(nextOffset!==offset){if(nextOffset-offset>=Math.max(.9*count,32)){var mid=end+start>>>1;snapRec(nx,ny,diam_2,offset,mid,level+1),offset=mid}snapRec(nx,ny,diam_2,offset,nextOffset,level+1),offset=nextOffset}}})(lox,loy,diam,0,n,0),_$sortLevels_340(levels,points,ids,weights,n);for(var lod=[],lastLevel=0,prevOffset=n,ptr=n-1;ptr>=0;--ptr){points[2*ptr]=(points[2*ptr]-lox)*scaleX,points[2*ptr+1]=(points[2*ptr+1]-loy)*scaleY;var level=levels[ptr];level!==lastLevel&&(lod.push(new SnapInterval(diam*Math.pow(.5,level),ptr+1,prevOffset-(ptr+1))),prevOffset=ptr+1,lastLevel=level)}return lod.push(new SnapInterval(diam*Math.pow(.5,level+1),0,prevOffset)),lod};function partition(points,ids,start,end,lox,loy,hix,hiy){for(var mid=start,i=start;i<end;++i){var x=points[2*i],y=points[2*i+1],s=ids[i];lox<=x&&x<=hix&&loy<=y&&y<=hiy&&(i===mid?mid+=1:(points[2*i]=points[2*mid],points[2*i+1]=points[2*mid+1],ids[i]=ids[mid],points[2*mid]=x,points[2*mid+1]=y,ids[mid]=s,mid+=1))}return mid}function SnapInterval(pixelSize,offset,count){this.pixelSize=pixelSize,this.offset=offset,this.count=count}var __float32_313=_$toFloat32_353.float32,__fract32_313=_$toFloat32_353.fract32,_$Scatter_313=function __Scatter_313(regl,options){"function"==typeof regl?(options||(options={}),options.regl=regl):(options=regl,regl=null);options&&options.length&&(options.positions=options);var drawMarker,drawCircle,sizeBuffer,positionBuffer,positionFractBuffer,colorBuffer,paletteTexture,gl=(regl=options.regl)._gl,palette=[],paletteIds={},defaults={color:"black",borderColor:"transparent",borderSize:1,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,offset:0,count:0,bounds:null,positions:[],snap:1e4},groups=[],markerTextures=[null],markerCache=[null],maxColors=4096,maxSize=100;paletteTexture=regl.texture({data:new Uint8Array(4*maxColors),width:maxColors,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),sizeBuffer=regl.buffer({usage:"dynamic",type:"float",data:null}),colorBuffer=regl.buffer({usage:"dynamic",type:"uint16",data:null}),positionBuffer=regl.buffer({usage:"dynamic",type:"float",data:null}),positionFractBuffer=regl.buffer({usage:"dynamic",type:"float",data:null}),options.clone?(groups=options.clone.groups.map(function(group){return(group=_$objectAssign_281({},group)).markerIds&&(group.markerIds=group.markerIds.map(function(ids){var newIds=ids.slice();return newIds.lod=ids.lod,newIds.snap=ids.snap,newIds.data=ids.data,newIds.id=ids.id,newIds.x=ids.x,newIds.w=ids.w,newIds.elements=regl.elements({primitive:"points",type:"uint32",data:ids.data}),newIds})),group}),options.clone.markers.forEach(function(markers){addMarker(markers)}),updatePalette(options.clone.palette),updateBuffers({point:!0,color:!0,size:!0})):update(options);var shaderOptions={uniforms:{pixelRatio:regl.context("pixelRatio"),palette:paletteTexture,paletteSize:function(ctx,prop){return[maxColors,paletteTexture.height]},scale:regl.prop("scale"),scaleFract:regl.prop("scaleFract"),translate:regl.prop("translate"),translateFract:regl.prop("translateFract"),opacity:regl.prop("opacity"),marker:regl.prop("marker")},attributes:{position:positionBuffer,positionFract:positionFractBuffer,size:function(ctx,prop){return prop.size.length?{buffer:sizeBuffer,stride:2,offset:0}:{constant:[Math.round(255*prop.size/maxSize)]}},borderSize:function(ctx,prop){return prop.borderSize.length?{buffer:sizeBuffer,stride:2,offset:1}:{constant:[Math.round(255*prop.borderSize/maxSize)]}},colorId:function(ctx,prop){return prop.color.length?{buffer:colorBuffer,stride:8,offset:0}:{constant:[prop.color]}},borderColorId:function(ctx,prop){return prop.borderColor.length?{buffer:colorBuffer,stride:8,offset:4}:{constant:[prop.borderColor]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:regl.prop("viewport")},viewport:regl.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:regl.prop("elements"),count:regl.prop("count"),offset:regl.prop("offset"),primitive:"points"};if(_$isIexplorer_248)drawCircle=regl(_$objectAssign_281({},shaderOptions,{frag:_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color, borderColor;\nuniform float opacity;\nvarying float fragBorderRadius, fragWidth, fragBorderSize, fragSize;\n\nfloat smoothStep(float x, float y) {\n  return 1.0 / (1.0 + exp(50.0*(x - y)));\n}\n\nvoid main() {\n  float radius = length(2.0*gl_PointCoord.xy-1.0);\n  if(radius > 1.0) {\n    discard;\n  }\n\n  float centerFraction = fragBorderSize == 0. ? 2. : fragSize / (fragSize + fragBorderSize + 1.25);\n\n  vec4 baseColor = mix(borderColor, color, smoothStep(radius, centerFraction));\n  float alpha = 1.0 - pow(1.0 - baseColor.a, 1.);\n  gl_FragColor = vec4(baseColor.rgb * alpha, alpha);\n}\n"]),vert:_$browser_238(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position, positionFract;\nattribute float size, borderSize;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio;\n\nconst float maxSize = 100.;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragBorderRadius, fragWidth, fragBorderSize, fragSize;\n\nvoid main() {\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n  fragBorderSize = borderSize;\n  fragSize = size;\n\n  gl_PointSize = (size + borderSize) * pixelRatio;\n\n  vec2 pos = (position + translate) * scale\n\t\t\t+ (positionFract + translateFract) * scale\n\t\t\t+ (position + translate) * scaleFract\n\t\t\t+ (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0, 1);\n\n  fragBorderRadius = borderSize == 0. ? 2. : 1. - 2. * borderSize / (size + borderSize);\n  fragWidth = 1. / gl_PointSize;\n}\n"]),uniforms:{color:function(ctx,p){var id=p.color.length?p.color[0]:p.color;return palette.slice(4*id,4*id+4).map(function(v){return v/255})},borderColor:function(ctx,p){var id=p.borderColor.length?p.borderColor[0]:p.borderColor;return palette.slice(4*id,4*id+4).map(function(v){return v/255})},pixelRatio:regl.context("pixelRatio"),palette:paletteTexture,paletteSize:function(ctx,prop){return[maxColors,paletteTexture.height]},scale:regl.prop("scale"),scaleFract:regl.prop("scaleFract"),translate:regl.prop("translate"),translateFract:regl.prop("translateFract"),opacity:regl.prop("opacity"),marker:regl.prop("marker")},attributes:{position:positionBuffer,positionFract:positionFractBuffer,size:shaderOptions.attributes.size,borderSize:shaderOptions.attributes.borderSize}}));else{var markerOptions=_$objectAssign_281({},shaderOptions);markerOptions.frag=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragWidth, fragBorderColorLevel, fragColorLevel;\n\nuniform sampler2D marker;\nuniform float pixelRatio, opacity;\n\nfloat smoothStep(float x, float y) {\n  return 1.0 / (1.0 + exp(50.0*(x - y)));\n}\n\nvoid main() {\n  float dist = texture2D(marker, gl_PointCoord).r, delta = fragWidth;\n\n  //max-distance alpha\n  if (dist < 0.003) discard;\n\n  //null-border case\n  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {\n    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);\n    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a);\n    return;\n  }\n\n  float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);\n  float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);\n\n  vec4 color = fragBorderColor;\n  color.a *= borderColorAmt;\n  color = mix(color, fragColor, colorAmt);\n  color.a *= opacity;\n\n  gl_FragColor = color;\n}\n"]),markerOptions.vert=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position, positionFract;\nattribute float size, borderSize;\nattribute vec2 colorId, borderColorId;\n\nuniform vec2 scale, scaleFract, translate, translateFract, paletteSize;\nuniform float pixelRatio;\nuniform sampler2D palette;\n\nconst float maxSize = 100.;\nconst float borderLevel = .5;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragPointSize, fragBorderRadius,\n\t\tfragWidth, fragBorderColorLevel, fragColorLevel;\n\nvec2 paletteCoord(float id) {\n  return vec2(\n    (mod(id, paletteSize.x) + .5) / paletteSize.x,\n    (floor(id / paletteSize.x) + .5) / paletteSize.y\n  );\n}\nvec2 paletteCoord(vec2 id) {\n  return vec2(\n    (id.x + .5) / paletteSize.x,\n    (id.y + .5) / paletteSize.y\n  );\n}\n\nvoid main() {\n  vec4 color = texture2D(palette, paletteCoord(colorId));\n  vec4 borderColor = texture2D(palette, paletteCoord(borderColorId));\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = 2. * size * pixelRatio;\n  fragPointSize = size * pixelRatio;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0, 1);\n\n  fragColor = color;\n  fragBorderColor = borderColor;\n  fragWidth = 1. / gl_PointSize;\n\n  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);\n  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);\n}\n"]),drawMarker=regl(markerOptions);var circleOptions=_$objectAssign_281({},shaderOptions);circleOptions.frag=_$browser_238(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\n\nuniform float opacity;\nvarying float fragBorderRadius, fragWidth;\n\nvoid main() {\n\tfloat radius, alpha = 1.0, delta = fragWidth;\n\n\tradius = length(2.0 * gl_PointCoord.xy - 1.0);\n\n\tif(radius > 1.0 + delta) {\n\t\tdiscard;\n\t\treturn;\n\t}\n\n\talpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);\n\n\tfloat borderRadius = fragBorderRadius;\n\tfloat ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);\n\tvec4 color = mix(fragColor, fragBorderColor, ratio);\n\tcolor.a *= alpha * opacity;\n\tgl_FragColor = color;\n}\n"]),circleOptions.vert=_$browser_238(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position, positionFract;\nattribute float size, borderSize;\nattribute vec2 colorId, borderColorId;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio;\nuniform sampler2D palette;\nuniform vec2 paletteSize;\n\nconst float maxSize = 100.;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragBorderRadius, fragWidth;\n\nvec2 paletteCoord(float id) {\n  return vec2(\n    (mod(id, paletteSize.x) + .5) / paletteSize.x,\n    (floor(id / paletteSize.x) + .5) / paletteSize.y\n  );\n}\nvec2 paletteCoord(vec2 id) {\n  return vec2(\n    (id.x + .5) / paletteSize.x,\n    (id.y + .5) / paletteSize.y\n  );\n}\n\nvoid main() {\n  vec4 color = texture2D(palette, paletteCoord(colorId));\n  vec4 borderColor = texture2D(palette, paletteCoord(borderColorId));\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = (size + borderSize) * pixelRatio;\n\n  vec2 pos = (position + translate) * scale\n\t\t\t+ (positionFract + translateFract) * scale\n\t\t\t+ (position + translate) * scaleFract\n\t\t\t+ (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0, 1);\n\n  fragBorderRadius = borderSize == 0. ? 2. : 1. - 2. * borderSize / (size + borderSize);\n  fragColor = color;\n  fragBorderColor = borderColor;\n  fragWidth = 1. / gl_PointSize;\n}\n"]),drawCircle=regl(circleOptions)}function scatter2d(opts){opts?update(opts):null===opts&&destroy(),draw()}function draw(opts){if("number"==typeof opts)return drawGroup(opts);Array.isArray(opts)?opts.forEach(function(els,i){if(null!=els)return els.length?drawGroup(els,i):drawGroup(els)}):groups.forEach(function(group,i){group&&drawGroup(i)})}function drawGroup(group,id){var els;if("number"==typeof group&&(group=groups[group]),Array.isArray(group)&&(els=group,group=groups[id]),group&&group.count&&group.opacity){var whitelist;if(els){whitelist=Array(group.count);for(var i=0;i<els.length;i++)whitelist[els[i]]=!0}if(group.markerIds[0]){regl._refresh();var opts=getMarkerDrawOptions(group.markerIds[0],group,whitelist);drawCircle(opts)}for(var batch=[],i$1=1;i$1<group.markerIds.length;i$1++){var ids=group.markerIds[i$1];ids&&ids.length&&[].push.apply(batch,getMarkerDrawOptions(ids,group,whitelist))}batch.length&&(regl._refresh(),drawMarker(batch))}}function getMarkerDrawOptions(ids,group,whitelist){var range=group.range,offset=group.offset;if(!ids.snap){var elements=whitelist?filter(ids.data,whitelist):ids.elements;return[_$objectAssign_281({},group,{elements:elements,offset:0,count:whitelist?elements.length:ids.length,marker:markerTextures[ids.id]})]}for(var batch=[],lod=ids.lod,x=ids.x,id=ids.id,pixelSize=Math.min((range[2]-range[0])/group.viewport.width,(range[3]-range[1])/group.viewport.height),scaleNum=lod.length;scaleNum--;){var level=lod[scaleNum];if(!(level.pixelSize&&level.pixelSize<pixelSize&&scaleNum>1)){var intervalStart=level.offset,intervalEnd=level.count+intervalStart,startOffset=_$searchBounds_314.ge(x,range[0],intervalStart,intervalEnd-1),endOffset=_$searchBounds_314.lt(x,range[2],startOffset,intervalEnd-1)+1;if(!(endOffset<=startOffset))if(whitelist){var elements$1=filter(ids.data.subarray(startOffset,endOffset),whitelist);batch.push(_$objectAssign_281({},group,{elements:elements$1,marker:markerTextures[id],offset:0,count:elements$1.length}))}else batch.push(_$objectAssign_281({},group,{elements:ids.elements,marker:markerTextures[id],offset:startOffset,count:endOffset-startOffset}))}}function filter(offsets,whitelist){for(var subEls=[],i=0,l=offsets.length;i<l;i++){var el=offsets[i],id=el-offset;whitelist[id]&&subEls.push(el)}return subEls}return batch}function update(options){if(options){null!=options.length?"number"==typeof options[0]&&(options=[{positions:options}]):Array.isArray(options)||(options=[options]);var pointCount=0,sizeCount=0,colorCount=0;scatter2d.groups=groups=options.map(function(options,i){var group=groups[i];return void 0===options?group:(null===options?options={positions:null}:"function"==typeof options?options={after:options}:"number"==typeof options[0]&&(options={positions:options}),null===(options=_$pick_290(options,{positions:"positions data points",snap:"snap cluster",size:"sizes size radius",borderSize:"borderSizes borderSize stroke-width strokeWidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",palette:"palette swatch",marker:"markers marker shape",range:"range dataBox",viewport:"viewport viewBox",opacity:"opacity alpha"})).positions&&(options.positions=[]),group||(groups[i]=group={id:i,scale:null,translate:null,scaleFract:null,translateFract:null,markerIds:[]},options=_$objectAssign_281({},defaults,options)),!options.positions||"marker"in options||(options.marker=group.marker,delete group.marker),!options.marker||"positions"in options||(options.positions=group.positions,delete group.positions),_$updateDiff_363(group,options,[{snap:!0,size:function(s){return sizeCount+=s.length?1:0,s},borderSize:function(s){return sizeCount+=s.length?1:0,s},opacity:parseFloat,color:function(c){return c=updateColor(c),colorCount++,c},borderColor:function(c){return c=updateColor(c),colorCount++,c},positions:function(positions,group,options){positions=_$flattenVertexData_141(positions,"float64");var count=group.count=Math.floor(positions.length/2),bounds=group.bounds=count?_$normalize_48(positions,2):null;return options.range||group.range||(delete group.range,options.range=bounds),group.offset=pointCount,pointCount+=count,options.marker||group.marker||(delete group.marker,options.marker=null),positions}},{marker:function(markers,group,options){if(group.markerIds.length=0,markers&&"number"!=typeof markers[0])for(var i=0,l=markers.length;i<l;i++){var id$1=addMarker(markers[i]);group.markerIds[id$1]||(group.markerIds[id$1]=[]),group.markerIds[id$1].push(i)}else{var id=addMarker(markers),elements=_$newArray_50(group.count);group.markerIds[id]=elements}return markers}},{positions:function(positions,group){for(var markerIds=group.markerIds,snap=group.snap,bounds=group.bounds,offset=group.offset,i=0;i<markerIds.length;i++){var ids=markerIds[i];if(ids&&ids.length){var l=ids.length,els=void 0;if(ids.id=i,snap&&(!0===snap||l>snap)){ids.snap=!0;var x=ids.x=Array(l),w=ids.w=Array(l),markerPoints=void 0;if(markerIds.length>1){markerPoints=Array(2*l);for(var i$1=0;i$1<l;i$1++){var id=ids[i$1];markerPoints[2*i$1]=positions[2*id],markerPoints[2*i$1+1]=positions[2*id+1]}}else(markerPoints=new Float64Array(positions.length)).set(positions);var i2id=new Uint32Array(l);ids.lod=_$snapPoints_341(markerPoints,i2id,w,bounds),els=new Uint32Array(l);for(var i$2=0;i$2<l;i$2++){var id$1=i2id[i$2],iid=ids[id$1];els[i$2]=iid+offset,x[i$2]=positions[2*iid]}}else{els=new Uint32Array(l);for(var i$3=0;i$3<l;i$3++)els[i$3]=ids[i$3]+offset}ids.data=els,ids.elements=regl.elements({primitive:"points",type:"uint32",data:els})}}},range:function(range,group,options){var bounds=group.bounds;if(bounds)return range||(range=bounds),group.scale=[1/(range[2]-range[0]),1/(range[3]-range[1])],group.translate=[-range[0],-range[1]],group.scaleFract=__fract32_313(group.scale),group.translateFract=__fract32_313(group.translate),range},viewport:function(vp){return _$parseRect_285(vp||[gl.drawingBufferWidth,gl.drawingBufferHeight])}}]),group)}),updateBuffers({point:pointCount,size:sizeCount,color:colorCount})}}function updateBuffers(ref){var point=ref.point,size=ref.size,color=ref.color,len=groups.reduce(function(acc,group,i){return acc+(group?group.count:0)},0);if(point){var positionData=new Float32Array(2*len),positionFractData=new Float32Array(2*len);groups.forEach(function(group,i){if(group){var positions=group.positions,count=group.count,offset=group.offset;count&&(positionData.set(__float32_313(positions),2*offset),positionFractData.set(__fract32_313(positions),2*offset))}}),positionBuffer(positionData),positionFractBuffer(positionFractData)}if(size){var sizeData=new Uint8Array(2*len);groups.forEach(function(group,i){if(group){var count=group.count,offset=group.offset,size=group.size,borderSize=group.borderSize;if(count&&(size.length||borderSize.length)){for(var sizes=new Uint8Array(2*count),i$1=0;i$1<count;i$1++)sizes[2*i$1]=Math.round(255*(null==size[i$1]?size:size[i$1])/maxSize),sizes[2*i$1+1]=Math.round(255*(null==borderSize[i$1]?borderSize:borderSize[i$1])/maxSize);sizeData.set(sizes,2*offset)}}}),sizeBuffer(sizeData)}if(color){var colorData=new Uint16Array(4*len);groups.forEach(function(group,i){if(group){var count=group.count,offset=group.offset,color=group.color,borderColor=group.borderColor;if(count&&(color.length||borderColor.length)){for(var colorIds=new Uint16Array(4*count),i$1=0;i$1<count;i$1++)null!=color[i$1]&&(colorIds[4*i$1]=color[i$1]%maxColors,colorIds[4*i$1+1]=Math.floor(color[i$1]/maxColors)),null!=borderColor[i$1]&&(colorIds[4*i$1+2]=borderColor[i$1]%maxColors,colorIds[4*i$1+3]=Math.floor(borderColor[i$1]/maxColors));colorData.set(colorIds,4*offset)}}}),colorBuffer(colorData)}}function addMarker(sdf){var distArr,pos=null==sdf?0:markerCache.indexOf(sdf);if(pos>=0)return pos;if(sdf instanceof Uint8Array||sdf instanceof Uint8ClampedArray)distArr=sdf;else{distArr=new Uint8Array(sdf.length);for(var i=0,l=sdf.length;i<l;i++)distArr[i]=255*sdf[i]}var radius=Math.floor(Math.sqrt(distArr.length));return pos=markerTextures.length,markerCache.push(sdf),markerTextures.push(regl.texture({channels:1,data:distArr,radius:radius,mag:"linear",min:"linear"})),pos}function updateColor(colors){Array.isArray(colors)||(colors=[colors]);for(var idx=[],i=0;i<colors.length;i++){var color=colors[i];if("number"!=typeof color){color=_$normalize_99(color,"uint8");var id=_$colorId_97(color,!1);if(null==paletteIds[id]){var pos=palette.length;paletteIds[id]=Math.floor(pos/4),palette[pos]=color[0],palette[pos+1]=color[1],palette[pos+2]=color[2],palette[pos+3]=color[3]}idx[i]=paletteIds[id]}else idx[i]=color}return updatePalette(palette),1===idx.length?idx[0]:idx}function updatePalette(palette){var requiredHeight=Math.ceil(.25*palette.length/maxColors);if(requiredHeight>1)for(var i=.25*(palette=palette.slice()).length%maxColors;i<requiredHeight*maxColors;i++)palette.push(0,0,0,0);paletteTexture.height<requiredHeight&&paletteTexture.resize(maxColors,requiredHeight),paletteTexture.subimage({width:Math.min(.25*palette.length,maxColors),height:requiredHeight,data:palette},0,0)}function destroy(){groups.length=0,sizeBuffer.destroy(),positionBuffer.destroy(),positionFractBuffer.destroy(),colorBuffer.destroy(),paletteTexture.destroy()}return _$objectAssign_281(scatter2d,{update:update,draw:draw,destroy:destroy,regl:regl,gl:gl,canvas:gl.canvas,groups:groups,markers:markerCache,palette:palette}),scatter2d};var _$calcSDF_73=function calcSDF(src,options){options||(options={});var w,h,size,data,intData,stride,ctx,canvas,imgData,i,l,cutoff=null==options.cutoff?.25:options.cutoff,radius=null==options.radius?8:options.radius,channel=options.channel||0;if(ArrayBuffer.isView(src)||Array.isArray(src)){if(!options.width||!options.height)throw Error("For raw data width and height should be provided by options");w=options.width,h=options.height,data=src,stride=options.stride?options.stride:Math.floor(src.length/w/h)}else window.HTMLCanvasElement&&src instanceof window.HTMLCanvasElement?(ctx=(canvas=src).getContext("2d"),w=canvas.width,h=canvas.height,imgData=ctx.getImageData(0,0,w,h),data=imgData.data,stride=4):window.CanvasRenderingContext2D&&src instanceof window.CanvasRenderingContext2D?(canvas=src.canvas,ctx=src,w=canvas.width,h=canvas.height,imgData=ctx.getImageData(0,0,w,h),data=imgData.data,stride=4):window.ImageData&&src instanceof window.ImageData&&(imgData=src,w=src.width,h=src.height,data=imgData.data,stride=4);if(size=Math.max(w,h),window.Uint8ClampedArray&&data instanceof window.Uint8ClampedArray||window.Uint8Array&&data instanceof window.Uint8Array)for(intData=data,data=Array(w*h),i=0,l=intData.length;i<l;i++)data[i]=intData[i*stride+channel]/255;else if(1!==stride)throw Error("Raw data can have only 1 value per pixel");var gridOuter=Array(w*h),gridInner=Array(w*h),f=Array(size),d=Array(size),z=Array(size+1),v=Array(size);for(i=0,l=w*h;i<l;i++){var a=data[i];gridOuter[i]=1===a?0:0===a?INF:Math.pow(Math.max(0,.5-a),2),gridInner[i]=1===a?INF:0===a?0:Math.pow(Math.max(0,a-.5),2)}edt(gridOuter,w,h,f,d,v,z),edt(gridInner,w,h,f,d,v,z);var dist=window.Float32Array?new Float32Array(w*h):new Array(w*h);for(i=0,l=w*h;i<l;i++)dist[i]=_$clamp_94(1-((gridOuter[i]-gridInner[i])/radius+cutoff),0,1);return dist},INF=1e20;function edt(data,width,height,f,d,v,z){for(var x=0;x<width;x++){for(var y=0;y<height;y++)f[y]=data[y*width+x];for(edt1d(f,d,v,z,height),y=0;y<height;y++)data[y*width+x]=d[y]}for(y=0;y<height;y++){for(x=0;x<width;x++)f[x]=data[y*width+x];for(edt1d(f,d,v,z,width),x=0;x<width;x++)data[y*width+x]=Math.sqrt(d[x])}}function edt1d(f,d,v,z,n){v[0]=0,z[0]=-INF,z[1]=+INF;for(var q=1,k=0;q<n;q++){for(var s=(f[q]+q*q-(f[v[k]]+v[k]*v[k]))/(2*q-2*v[k]);s<=z[k];)k--,s=(f[q]+q*q-(f[v[k]]+v[k]*v[k]))/(2*q-2*v[k]);v[++k]=q,z[k]=s,z[k+1]=+INF}for(q=0,k=0;q<n;q++){for(;z[k+1]<q;)k++;d[q]=(q-v[k])*(q-v[k])+f[v[k]]}}var _$absolutize_43=function absolutize(path){var startX=0,startY=0,x=0,y=0;return path.map(function(seg){var type=(seg=seg.slice())[0],command=type.toUpperCase();if(type!=command)switch(seg[0]=command,type){case"a":seg[6]+=x,seg[7]+=y;break;case"v":seg[1]+=y;break;case"h":seg[1]+=x;break;default:for(var i=1;i<seg.length;)seg[i++]+=x,seg[i++]+=y}switch(command){case"Z":x=startX,y=startY;break;case"H":x=seg[1];break;case"V":y=seg[1];break;case"M":x=startX=seg[1],y=startY=seg[2];break;default:x=seg[seg.length-2],y=seg[seg.length-1]}return seg})};var π=Math.PI,_120=__radians_279(120),_$normalize_279=function __normalize_279(path){for(var prev,result=[],bezierX=0,bezierY=0,startX=0,startY=0,quadX=null,quadY=null,x=0,y=0,i=0,len=path.length;i<len;i++){var seg=path[i],command=seg[0];switch(command){case"M":startX=seg[1],startY=seg[2];break;case"A":(seg=arc(x,y,seg[1],seg[2],__radians_279(seg[3]),seg[4],seg[5],seg[6],seg[7])).unshift("C"),seg.length>7&&(result.push(seg.splice(0,7)),seg.unshift("C"));break;case"S":var cx=x,cy=y;"C"!=prev&&"S"!=prev||(cx+=cx-bezierX,cy+=cy-bezierY),seg=["C",cx,cy,seg[1],seg[2],seg[3],seg[4]];break;case"T":"Q"==prev||"T"==prev?(quadX=2*x-quadX,quadY=2*y-quadY):(quadX=x,quadY=y),seg=quadratic(x,y,quadX,quadY,seg[1],seg[2]);break;case"Q":quadX=seg[1],quadY=seg[2],seg=quadratic(x,y,seg[1],seg[2],seg[3],seg[4]);break;case"L":seg=line(x,y,seg[1],seg[2]);break;case"H":seg=line(x,y,seg[1],y);break;case"V":seg=line(x,y,x,seg[1]);break;case"Z":seg=line(x,y,startX,startY)}prev=command,x=seg[seg.length-2],y=seg[seg.length-1],seg.length>4?(bezierX=seg[seg.length-4],bezierY=seg[seg.length-3]):(bezierX=x,bezierY=y),result.push(seg)}return result};function line(x1,y1,x2,y2){return["C",x1,y1,x2,y2,x2,y2]}function quadratic(x1,y1,cx,cy,x2,y2){return["C",x1/3+2/3*cx,y1/3+2/3*cy,x2/3+2/3*cx,y2/3+2/3*cy,x2,y2]}function arc(x1,y1,rx,ry,angle,large_arc_flag,sweep_flag,x2,y2,recursive){if(recursive)f1=recursive[0],f2=recursive[1],cx=recursive[2],cy=recursive[3];else{var xy=__rotate_279(x1,y1,-angle);x1=xy.x,y1=xy.y;var x=(x1-(x2=(xy=__rotate_279(x2,y2,-angle)).x))/2,y=(y1-(y2=xy.y))/2,h=x*x/(rx*rx)+y*y/(ry*ry);h>1&&(rx*=h=Math.sqrt(h),ry*=h);var rx2=rx*rx,ry2=ry*ry,k=(large_arc_flag==sweep_flag?-1:1)*Math.sqrt(Math.abs((rx2*ry2-rx2*y*y-ry2*x*x)/(rx2*y*y+ry2*x*x)));k==1/0&&(k=1);var cx=k*rx*y/ry+(x1+x2)/2,cy=k*-ry*x/rx+(y1+y2)/2,f1=Math.asin(((y1-cy)/ry).toFixed(9)),f2=Math.asin(((y2-cy)/ry).toFixed(9));f1=x1<cx?π-f1:f1,f2=x2<cx?π-f2:f2,f1<0&&(f1=2*π+f1),f2<0&&(f2=2*π+f2),sweep_flag&&f1>f2&&(f1-=2*π),!sweep_flag&&f2>f1&&(f2-=2*π)}if(Math.abs(f2-f1)>_120){var f2old=f2,x2old=x2,y2old=y2;f2=f1+_120*(sweep_flag&&f2>f1?1:-1);var res=arc(x2=cx+rx*Math.cos(f2),y2=cy+ry*Math.sin(f2),rx,ry,angle,0,sweep_flag,x2old,y2old,[f2,f2old,cx,cy])}var t=Math.tan((f2-f1)/4),hx=4/3*rx*t,hy=4/3*ry*t,curve=[2*x1-(x1+hx*Math.sin(f1)),2*y1-(y1-hy*Math.cos(f1)),x2+hx*Math.sin(f2),y2-hy*Math.cos(f2),x2,y2];if(recursive)return curve;res&&(curve=curve.concat(res));for(var i=0;i<curve.length;){var rot=__rotate_279(curve[i],curve[i+1],angle);curve[i++]=rot.x,curve[i++]=rot.y}return curve}function __rotate_279(x,y,rad){return{x:x*Math.cos(rad)-y*Math.sin(rad),y:x*Math.sin(rad)+y*Math.cos(rad)}}function __radians_279(degress){return degress*(π/180)}var methods={M:"moveTo",C:"bezierCurveTo"},_$drawSvgPath_131=function(context,segments){context.beginPath(),_$normalize_279(_$absolutize_43(segments)).forEach(function(segment){var command=segment[0],args=segment.slice(1);context[methods[command]].apply(context,args)}),context.closePath()},_$isPath_251=function isPath(str){return"string"==typeof str&&(str=str.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(str)&&/[\dz]$/i.test(str)&&str.length>4))},_$parse_286=function __parse_286(path){var data=[];return path.replace(segment,function(_,command,args){var type=command.toLowerCase();for(args=function parseValues(args){var numbers=args.match(number);return numbers?numbers.map(Number):[]}(args),"m"==type&&args.length>2&&(data.push([command].concat(args.splice(0,2))),type="l",command="m"==command?"l":"L");;){if(args.length==__length_286[type])return args.unshift(command),data.push(args);if(args.length<__length_286[type])throw new Error("malformed path data");data.push([command].concat(args.splice(0,__length_286[type])))}}),data},__length_286={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},segment=/([astvzqmhlc])([^astvzqmhlc]*)/gi;var number=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;var _$inherits_browser_364={};_$inherits_browser_364="function"==typeof Object.create?function inherits(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor};var _$isBuffer_365=function isBuffer(arg){return arg&&"object"==typeof arg&&"function"==typeof arg.copy&&"function"==typeof arg.fill&&"function"==typeof arg.readUInt8},_$util_366={};(function(process,global){var formatRegExp=/%[sdj%]/g;_$util_366.format=function(f){if(!isString(f)){for(var objects=[],i=0;i<arguments.length;i++)objects.push(inspect(arguments[i]));return objects.join(" ")}i=1;for(var args=arguments,len=args.length,str=String(f).replace(formatRegExp,function(x){if("%%"===x)return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}}),x=args[i];i<len;x=args[++i])isNull(x)||!isObject(x)?str+=" "+x:str+=" "+inspect(x);return str},_$util_366.deprecate=function(fn,msg){if(isUndefined(global.process))return function(){return _$util_366.deprecate(fn,msg).apply(this,arguments)};if(!0===process.noDeprecation)return fn;var warned=!1;return function deprecated(){if(!warned){if(process.throwDeprecation)throw new Error(msg);process.traceDeprecation?console.trace(msg):console.error(msg),warned=!0}return fn.apply(this,arguments)}};var debugEnviron,debugs={};function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(ctx.depth=arguments[2]),arguments.length>=4&&(ctx.colors=arguments[3]),isBoolean(opts)?ctx.showHidden=opts:opts&&_$util_366._extend(ctx,opts),isUndefined(ctx.showHidden)&&(ctx.showHidden=!1),isUndefined(ctx.depth)&&(ctx.depth=2),isUndefined(ctx.colors)&&(ctx.colors=!1),isUndefined(ctx.customInspect)&&(ctx.customInspect=!0),ctx.colors&&(ctx.stylize=stylizeWithColor),formatValue(ctx,obj,ctx.depth)}function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];return style?"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m":str}function stylizeNoColor(str,styleType){return str}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==_$util_366.inspect&&(!value.constructor||value.constructor.prototype!==value)){var ret=value.inspect(recurseTimes,ctx);return isString(ret)||(ret=formatValue(ctx,ret,recurseTimes)),ret}var primitive=function formatPrimitive(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}if(isNumber(value))return ctx.stylize(""+value,"number");if(isBoolean(value))return ctx.stylize(""+value,"boolean");if(isNull(value))return ctx.stylize("null","null")}(ctx,value);if(primitive)return primitive;var keys=Object.keys(value),visibleKeys=function arrayToHash(array){var hash={};return array.forEach(function(val,idx){hash[val]=!0}),hash}(keys);if(ctx.showHidden&&(keys=Object.getOwnPropertyNames(value)),isError(value)&&(keys.indexOf("message")>=0||keys.indexOf("description")>=0))return formatError(value);if(0===keys.length){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value))return ctx.stylize(RegExp.prototype.toString.call(value),"regexp");if(isDate(value))return ctx.stylize(Date.prototype.toString.call(value),"date");if(isError(value))return formatError(value)}var output,base="",array=!1,braces=["{","}"];(isArray(value)&&(array=!0,braces=["[","]"]),isFunction(value))&&(base=" [Function"+(value.name?": "+value.name:"")+"]");return isRegExp(value)&&(base=" "+RegExp.prototype.toString.call(value)),isDate(value)&&(base=" "+Date.prototype.toUTCString.call(value)),isError(value)&&(base=" "+formatError(value)),0!==keys.length||array&&0!=value.length?recurseTimes<0?isRegExp(value)?ctx.stylize(RegExp.prototype.toString.call(value),"regexp"):ctx.stylize("[Object]","special"):(ctx.seen.push(value),output=array?function formatArray(ctx,value,recurseTimes,visibleKeys,keys){for(var output=[],i=0,l=value.length;i<l;++i)hasOwnProperty(value,String(i))?output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),!0)):output.push("");return keys.forEach(function(key){key.match(/^\d+$/)||output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,!0))}),output}(ctx,value,recurseTimes,visibleKeys,keys):keys.map(function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)}),ctx.seen.pop(),function reduceToSingleString(output,base,braces){if(output.reduce(function(prev,cur){return 0,cur.indexOf("\n")>=0&&0,prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return braces[0]+(""===base?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1];return braces[0]+base+" "+output.join(", ")+" "+braces[1]}(output,base,braces)):braces[0]+base+braces[1]}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;if((desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]}).get?str=desc.set?ctx.stylize("[Getter/Setter]","special"):ctx.stylize("[Getter]","special"):desc.set&&(str=ctx.stylize("[Setter]","special")),hasOwnProperty(visibleKeys,key)||(name="["+key+"]"),str||(ctx.seen.indexOf(desc.value)<0?(str=isNull(recurseTimes)?formatValue(ctx,desc.value,null):formatValue(ctx,desc.value,recurseTimes-1)).indexOf("\n")>-1&&(str=array?str.split("\n").map(function(line){return"  "+line}).join("\n").substr(2):"\n"+str.split("\n").map(function(line){return"   "+line}).join("\n")):str=ctx.stylize("[Circular]","special")),isUndefined(name)){if(array&&key.match(/^\d+$/))return str;(name=JSON.stringify(""+key)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(name=name.substr(1,name.length-2),name=ctx.stylize(name,"name")):(name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),name=ctx.stylize(name,"string"))}return name+": "+str}function isArray(ar){return Array.isArray(ar)}function isBoolean(arg){return"boolean"==typeof arg}function isNull(arg){return null===arg}function isNumber(arg){return"number"==typeof arg}function isString(arg){return"string"==typeof arg}function isUndefined(arg){return void 0===arg}function isRegExp(re){return isObject(re)&&"[object RegExp]"===objectToString(re)}function isObject(arg){return"object"==typeof arg&&null!==arg}function isDate(d){return isObject(d)&&"[object Date]"===objectToString(d)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(arg){return"function"==typeof arg}function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}_$util_366.debuglog=function(set){if(isUndefined(debugEnviron)&&(debugEnviron=process.env.NODE_DEBUG||""),set=set.toUpperCase(),!debugs[set])if(new RegExp("\\b"+set+"\\b","i").test(debugEnviron)){var pid=process.pid;debugs[set]=function(){var msg=_$util_366.format.apply(_$util_366,arguments);console.error("%s %d: %s",set,pid,msg)}}else debugs[set]=function(){};return debugs[set]},_$util_366.inspect=inspect,inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},_$util_366.isArray=isArray,_$util_366.isBoolean=isBoolean,_$util_366.isNull=isNull,_$util_366.isNullOrUndefined=function isNullOrUndefined(arg){return null==arg},_$util_366.isNumber=isNumber,_$util_366.isString=isString,_$util_366.isSymbol=function isSymbol(arg){return"symbol"==typeof arg},_$util_366.isUndefined=isUndefined,_$util_366.isRegExp=isRegExp,_$util_366.isObject=isObject,_$util_366.isDate=isDate,_$util_366.isError=isError,_$util_366.isFunction=isFunction,_$util_366.isPrimitive=function isPrimitive(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||void 0===arg},_$util_366.isBuffer=_$isBuffer_365;var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}_$util_366.log=function(){console.log("%s - %s",function timestamp(){var d=new Date,time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}(),_$util_366.format.apply(_$util_366,arguments))},_$util_366.inherits=_$inherits_browser_364,_$util_366._extend=function(origin,add){if(!add||!isObject(add))return origin;for(var keys=Object.keys(add),i=keys.length;i--;)origin[keys[i]]=add[keys[i]];return origin}}).call(this,_$browser_304,void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var _$assert_51={};(function(global){"use strict";function compare(a,b){if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0}function isBuffer(b){return global.Buffer&&"function"==typeof global.Buffer.isBuffer?global.Buffer.isBuffer(b):!(null==b||!b._isBuffer)}var hasOwn=Object.prototype.hasOwnProperty,pSlice=Array.prototype.slice,functionsHaveNames="foo"===function foo(){}.name;function pToString(obj){return Object.prototype.toString.call(obj)}function isView(arrbuf){return!isBuffer(arrbuf)&&("function"==typeof global.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(arrbuf):!!arrbuf&&(arrbuf instanceof DataView||!!(arrbuf.buffer&&arrbuf.buffer instanceof ArrayBuffer))))}var assert=_$assert_51=ok,regex=/\s*function\s+([^\(\s]*)\s*/;function getName(func){if(_$util_366.isFunction(func)){if(functionsHaveNames)return func.name;var match=func.toString().match(regex);return match&&match[1]}}function truncate(s,n){return"string"==typeof s?s.length<n?s:s.slice(0,n):s}function inspect(something){if(functionsHaveNames||!_$util_366.isFunction(something))return _$util_366.inspect(something);var rawname=getName(something);return"[Function"+(rawname?": "+rawname:"")+"]"}function fail(actual,expected,message,operator,stackStartFunction){throw new assert.AssertionError({message:message,actual:actual,expected:expected,operator:operator,stackStartFunction:stackStartFunction})}function ok(value,message){value||fail(value,!0,message,"==",assert.ok)}function _deepEqual(actual,expected,strict,memos){if(actual===expected)return!0;if(isBuffer(actual)&&isBuffer(expected))return 0===compare(actual,expected);if(_$util_366.isDate(actual)&&_$util_366.isDate(expected))return actual.getTime()===expected.getTime();if(_$util_366.isRegExp(actual)&&_$util_366.isRegExp(expected))return actual.source===expected.source&&actual.global===expected.global&&actual.multiline===expected.multiline&&actual.lastIndex===expected.lastIndex&&actual.ignoreCase===expected.ignoreCase;if(null!==actual&&"object"==typeof actual||null!==expected&&"object"==typeof expected){if(isView(actual)&&isView(expected)&&pToString(actual)===pToString(expected)&&!(actual instanceof Float32Array||actual instanceof Float64Array))return 0===compare(new Uint8Array(actual.buffer),new Uint8Array(expected.buffer));if(isBuffer(actual)!==isBuffer(expected))return!1;var actualIndex=(memos=memos||{actual:[],expected:[]}).actual.indexOf(actual);return-1!==actualIndex&&actualIndex===memos.expected.indexOf(expected)||(memos.actual.push(actual),memos.expected.push(expected),function objEquiv(a,b,strict,actualVisitedObjects){if(null===a||void 0===a||null===b||void 0===b)return!1;if(_$util_366.isPrimitive(a)||_$util_366.isPrimitive(b))return a===b;if(strict&&Object.getPrototypeOf(a)!==Object.getPrototypeOf(b))return!1;var aIsArgs=isArguments(a),bIsArgs=isArguments(b);if(aIsArgs&&!bIsArgs||!aIsArgs&&bIsArgs)return!1;if(aIsArgs)return a=pSlice.call(a),b=pSlice.call(b),_deepEqual(a,b,strict);var key,i,ka=objectKeys(a),kb=objectKeys(b);if(ka.length!==kb.length)return!1;for(ka.sort(),kb.sort(),i=ka.length-1;i>=0;i--)if(ka[i]!==kb[i])return!1;for(i=ka.length-1;i>=0;i--)if(key=ka[i],!_deepEqual(a[key],b[key],strict,actualVisitedObjects))return!1;return!0}(actual,expected,strict,memos))}return strict?actual===expected:actual==expected}function isArguments(object){return"[object Arguments]"==Object.prototype.toString.call(object)}function expectedException(actual,expected){if(!actual||!expected)return!1;if("[object RegExp]"==Object.prototype.toString.call(expected))return expected.test(actual);try{if(actual instanceof expected)return!0}catch(e){}return!Error.isPrototypeOf(expected)&&!0===expected.call({},actual)}function _throws(shouldThrow,block,expected,message){var actual;if("function"!=typeof block)throw new TypeError('"block" argument must be a function');"string"==typeof expected&&(message=expected,expected=null),actual=function _tryBlock(block){var error;try{block()}catch(e){error=e}return error}(block),message=(expected&&expected.name?" ("+expected.name+").":".")+(message?" "+message:"."),shouldThrow&&!actual&&fail(actual,expected,"Missing expected exception"+message);var userProvidedMessage="string"==typeof message,isUnwantedException=!shouldThrow&&_$util_366.isError(actual),isUnexpectedException=!shouldThrow&&actual&&!expected;if((isUnwantedException&&userProvidedMessage&&expectedException(actual,expected)||isUnexpectedException)&&fail(actual,expected,"Got unwanted exception"+message),shouldThrow&&actual&&expected&&!expectedException(actual,expected)||!shouldThrow&&actual)throw actual}assert.AssertionError=function AssertionError(options){this.name="AssertionError",this.actual=options.actual,this.expected=options.expected,this.operator=options.operator,options.message?(this.message=options.message,this.generatedMessage=!1):(this.message=function getMessage(self){return truncate(inspect(self.actual),128)+" "+self.operator+" "+truncate(inspect(self.expected),128)}(this),this.generatedMessage=!0);var stackStartFunction=options.stackStartFunction||fail;if(Error.captureStackTrace)Error.captureStackTrace(this,stackStartFunction);else{var err=new Error;if(err.stack){var out=err.stack,fn_name=getName(stackStartFunction),idx=out.indexOf("\n"+fn_name);if(idx>=0){var next_line=out.indexOf("\n",idx+1);out=out.substring(next_line+1)}this.stack=out}}},_$util_366.inherits(assert.AssertionError,Error),assert.fail=fail,assert.ok=ok,assert.equal=function equal(actual,expected,message){actual!=expected&&fail(actual,expected,message,"==",assert.equal)},assert.notEqual=function notEqual(actual,expected,message){actual==expected&&fail(actual,expected,message,"!=",assert.notEqual)},assert.deepEqual=function deepEqual(actual,expected,message){_deepEqual(actual,expected,!1)||fail(actual,expected,message,"deepEqual",assert.deepEqual)},assert.deepStrictEqual=function deepStrictEqual(actual,expected,message){_deepEqual(actual,expected,!0)||fail(actual,expected,message,"deepStrictEqual",assert.deepStrictEqual)},assert.notDeepEqual=function notDeepEqual(actual,expected,message){_deepEqual(actual,expected,!1)&&fail(actual,expected,message,"notDeepEqual",assert.notDeepEqual)},assert.notDeepStrictEqual=function notDeepStrictEqual(actual,expected,message){_deepEqual(actual,expected,!0)&&fail(actual,expected,message,"notDeepStrictEqual",notDeepStrictEqual)},assert.strictEqual=function strictEqual(actual,expected,message){actual!==expected&&fail(actual,expected,message,"===",assert.strictEqual)},assert.notStrictEqual=function notStrictEqual(actual,expected,message){actual===expected&&fail(actual,expected,message,"!==",assert.notStrictEqual)},assert.throws=function(block,error,message){_throws(!0,block,error,message)},assert.doesNotThrow=function(block,error,message){_throws(!1,block,error,message)},assert.ifError=function(err){if(err)throw err};var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj)hasOwn.call(obj,key)&&keys.push(key);return keys}}).call(this,void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var _$cjs_347={};Object.defineProperty(_$cjs_347,"__esModule",{value:!0});var _slicedToArray=function(){return function(arr,i){if(Array.isArray(arr))return arr;if(Symbol.iterator in Object(arr))return function sliceIterator(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{!_n&&_i.return&&_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),TAU=2*Math.PI,mapToEllipse=function mapToEllipse(_ref,rx,ry,cosphi,sinphi,centerx,centery){var x=_ref.x,y=_ref.y;return{x:cosphi*(x*=rx)-sinphi*(y*=ry)+centerx,y:sinphi*x+cosphi*y+centery}},approxUnitArc=function approxUnitArc(ang1,ang2){var a=4/3*Math.tan(ang2/4),x1=Math.cos(ang1),y1=Math.sin(ang1),x2=Math.cos(ang1+ang2),y2=Math.sin(ang1+ang2);return[{x:x1-y1*a,y:y1+x1*a},{x:x2+y2*a,y:y2-x2*a},{x:x2,y:y2}]},vectorAngle=function vectorAngle(ux,uy,vx,vy){var sign=ux*vy-uy*vx<0?-1:1,div=(ux*vx+uy*vy)/(Math.sqrt(ux*ux+uy*uy)*Math.sqrt(ux*ux+uy*uy));return div>1&&(div=1),div<-1&&(div=-1),sign*Math.acos(div)};_$cjs_347.default=function arcToBezier(_ref2){var px=_ref2.px,py=_ref2.py,cx=_ref2.cx,cy=_ref2.cy,rx=_ref2.rx,ry=_ref2.ry,_ref2$xAxisRotation=_ref2.xAxisRotation,xAxisRotation=void 0===_ref2$xAxisRotation?0:_ref2$xAxisRotation,_ref2$largeArcFlag=_ref2.largeArcFlag,largeArcFlag=void 0===_ref2$largeArcFlag?0:_ref2$largeArcFlag,_ref2$sweepFlag=_ref2.sweepFlag,sweepFlag=void 0===_ref2$sweepFlag?0:_ref2$sweepFlag,curves=[];if(0===rx||0===ry)return[];var sinphi=Math.sin(xAxisRotation*TAU/360),cosphi=Math.cos(xAxisRotation*TAU/360),pxp=cosphi*(px-cx)/2+sinphi*(py-cy)/2,pyp=-sinphi*(px-cx)/2+cosphi*(py-cy)/2;if(0===pxp&&0===pyp)return[];rx=Math.abs(rx),ry=Math.abs(ry);var lambda=Math.pow(pxp,2)/Math.pow(rx,2)+Math.pow(pyp,2)/Math.pow(ry,2);lambda>1&&(rx*=Math.sqrt(lambda),ry*=Math.sqrt(lambda));var _getArcCenter=function getArcCenter(px,py,cx,cy,rx,ry,largeArcFlag,sweepFlag,sinphi,cosphi,pxp,pyp){var rxsq=Math.pow(rx,2),rysq=Math.pow(ry,2),pxpsq=Math.pow(pxp,2),pypsq=Math.pow(pyp,2),radicant=rxsq*rysq-rxsq*pypsq-rysq*pxpsq;radicant<0&&(radicant=0),radicant/=rxsq*pypsq+rysq*pxpsq;var centerxp=(radicant=Math.sqrt(radicant)*(largeArcFlag===sweepFlag?-1:1))*rx/ry*pyp,centeryp=radicant*-ry/rx*pxp,centerx=cosphi*centerxp-sinphi*centeryp+(px+cx)/2,centery=sinphi*centerxp+cosphi*centeryp+(py+cy)/2,vx1=(pxp-centerxp)/rx,vy1=(pyp-centeryp)/ry,vx2=(-pxp-centerxp)/rx,vy2=(-pyp-centeryp)/ry,ang1=vectorAngle(1,0,vx1,vy1),ang2=vectorAngle(vx1,vy1,vx2,vy2);return 0===sweepFlag&&ang2>0&&(ang2-=TAU),1===sweepFlag&&ang2<0&&(ang2+=TAU),[centerx,centery,ang1,ang2]}(px,py,cx,cy,rx,ry,largeArcFlag,sweepFlag,sinphi,cosphi,pxp,pyp),_getArcCenter2=_slicedToArray(_getArcCenter,4),centerx=_getArcCenter2[0],centery=_getArcCenter2[1],ang1=_getArcCenter2[2],ang2=_getArcCenter2[3],segments=Math.max(Math.ceil(Math.abs(ang2)/(TAU/4)),1);ang2/=segments;for(var i=0;i<segments;i++)curves.push(approxUnitArc(ang1,ang2)),ang1+=ang2;return curves.map(function(curve){var _mapToEllipse=mapToEllipse(curve[0],rx,ry,cosphi,sinphi,centerx,centery),x1=_mapToEllipse.x,y1=_mapToEllipse.y,_mapToEllipse2=mapToEllipse(curve[1],rx,ry,cosphi,sinphi,centerx,centery),x2=_mapToEllipse2.x,y2=_mapToEllipse2.y,_mapToEllipse3=mapToEllipse(curve[2],rx,ry,cosphi,sinphi,centerx,centery);return{x1:x1,y1:y1,x2:x2,y2:y2,x:_mapToEllipse3.x,y:_mapToEllipse3.y}})},_$cjs_347=_$cjs_347.default;var _$normalize_349=function __normalize_349(path){for(var prev,result=[],bezierX=0,bezierY=0,startX=0,startY=0,quadX=null,quadY=null,x=0,y=0,i=0,len=path.length;i<len;i++){var seg=path[i],command=seg[0];switch(command){case"M":startX=seg[1],startY=seg[2];break;case"A":var curves=_$cjs_347({px:x,py:y,cx:seg[6],cy:seg[7],rx:seg[1],ry:seg[2],xAxisRotation:seg[3],largeArcFlag:seg[4],sweepFlag:seg[5]});if(!curves.length)continue;for(var c,j=0;j<curves.length;j++)c=curves[j],seg=["C",c.x1,c.y1,c.x2,c.y2,c.x,c.y],j<curves.length-1&&result.push(seg);break;case"S":var cx=x,cy=y;"C"!=prev&&"S"!=prev||(cx+=cx-bezierX,cy+=cy-bezierY),seg=["C",cx,cy,seg[1],seg[2],seg[3],seg[4]];break;case"T":"Q"==prev||"T"==prev?(quadX=2*x-quadX,quadY=2*y-quadY):(quadX=x,quadY=y),seg=__quadratic_349(x,y,quadX,quadY,seg[1],seg[2]);break;case"Q":quadX=seg[1],quadY=seg[2],seg=__quadratic_349(x,y,seg[1],seg[2],seg[3],seg[4]);break;case"L":seg=__line_349(x,y,seg[1],seg[2]);break;case"H":seg=__line_349(x,y,seg[1],y);break;case"V":seg=__line_349(x,y,x,seg[1]);break;case"Z":seg=__line_349(x,y,startX,startY)}prev=command,x=seg[seg.length-2],y=seg[seg.length-1],seg.length>4?(bezierX=seg[seg.length-4],bezierY=seg[seg.length-3]):(bezierX=x,bezierY=y),result.push(seg)}return result};function __line_349(x1,y1,x2,y2){return["C",x1,y1,x2,y2,x2,y2]}function __quadratic_349(x1,y1,cx,cy,x2,y2){return["C",x1/3+2/3*cx,y1/3+2/3*cy,x2/3+2/3*cx,y2/3+2/3*cy,x2,y2]}var _$pathBounds_348=function pathBounds(path){Array.isArray(path)&&1===path.length&&"string"==typeof path[0]&&(path=path[0]);"string"==typeof path&&(_$assert_51(_$isPath_251(path),"String is not an SVG path."),path=_$parse_286(path));if(_$assert_51(Array.isArray(path),"Argument should be a string or an array of path segments."),path=_$absolutize_43(path),!(path=_$normalize_349(path)).length)return[0,0,0,0];for(var bounds=[1/0,1/0,-1/0,-1/0],i=0,l=path.length;i<l;i++)for(var points=path[i].slice(1),j=0;j<points.length;j+=2)points[j+0]<bounds[0]&&(bounds[0]=points[j+0]),points[j+1]<bounds[1]&&(bounds[1]=points[j+1]),points[j+0]>bounds[2]&&(bounds[2]=points[j+0]),points[j+1]>bounds[3]&&(bounds[3]=points[j+1]);return bounds};var _$pathSdf_350={};(function(global){"use strict";var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");_$pathSdf_350=function pathSdf(path,options){if(!_$isPath_251(path))throw Error("Argument should be valid svg path string");options||(options={});var w,h;options.shape?(w=options.shape[0],h=options.shape[1]):(w=canvas.width=options.w||options.width||200,h=canvas.height=options.h||options.height||200);var size=Math.min(w,h),stroke=options.stroke||0,viewbox=options.viewbox||options.viewBox||_$pathBounds_348(path),scale=[w/(viewbox[2]-viewbox[0]),h/(viewbox[3]-viewbox[1])],maxScale=Math.min(scale[0]||0,scale[1]||0)/2;ctx.fillStyle="black",ctx.fillRect(0,0,w,h),ctx.fillStyle="white",stroke&&("number"!=typeof stroke&&(stroke=1),ctx.strokeStyle=stroke>0?"white":"black",ctx.lineWidth=Math.abs(stroke));if(ctx.translate(.5*w,.5*h),ctx.scale(maxScale,maxScale),global.Path2D){var path2d=new Path2D(path);ctx.fill(path2d),stroke&&ctx.stroke(path2d)}else{var segments=_$parse_286(path);_$drawSvgPath_131(ctx,segments),ctx.fill(),stroke&&ctx.stroke()}return ctx.setTransform(1,0,0,1,0,0),_$calcSDF_73(ctx,{cutoff:null!=options.cutoff?options.cutoff:.5,radius:null!=options.radius?options.radius:.5*size})}}).call(this,void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var _$gl2d_dashes_513={solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]},_$attributes_909={},__extendFlat_909=_$extend_528.extendFlat,__overrideAll_909=_$edit_types_569.overrideAll,__scatterLineAttrs_909=_$attributes_862.line,__scatterMarkerAttrs_909=_$attributes_862.marker,__scatterMarkerLineAttrs_909=__scatterMarkerAttrs_909.line,__attrs_909=_$attributes_909=__overrideAll_909({x:_$attributes_862.x,x0:_$attributes_862.x0,dx:_$attributes_862.dx,y:_$attributes_862.y,y0:_$attributes_862.y0,dy:_$attributes_862.dy,text:__extendFlat_909({},_$attributes_862.text,{}),mode:{valType:"flaglist",flags:["lines","markers"],extras:["none"]},line:{color:__scatterLineAttrs_909.color,width:__scatterLineAttrs_909.width,dash:{valType:"enumerated",values:Object.keys(_$gl2d_dashes_513),dflt:"solid"}},marker:__extendFlat_909({},_$makeColorScaleAttributes_419(),{symbol:__scatterMarkerAttrs_909.symbol,size:__scatterMarkerAttrs_909.size,sizeref:__scatterMarkerAttrs_909.sizeref,sizemin:__scatterMarkerAttrs_909.sizemin,sizemode:__scatterMarkerAttrs_909.sizemode,opacity:__scatterMarkerAttrs_909.opacity,showscale:__scatterMarkerAttrs_909.showscale,colorbar:__scatterMarkerAttrs_909.colorbar,line:__extendFlat_909({},_$makeColorScaleAttributes_419(),{width:__scatterMarkerLineAttrs_909.width})}),connectgaps:_$attributes_862.connectgaps,fill:_$attributes_862.fill,fillcolor:_$attributes_862.fillcolor,hoveron:_$attributes_862.hoveron,selected:{marker:_$attributes_862.selected.marker},unselected:{marker:_$attributes_862.unselected.marker},opacity:_$attributes_581.opacity},"calc","nested");__attrs_909.x.editType=__attrs_909.y.editType=__attrs_909.x0.editType=__attrs_909.y0.editType="calc+clearAxisTypes";var _$supplyDefaults_910=function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_909,attr,dflt)}var isOpen=!!traceIn.marker&&/-open/.test(traceIn.marker.symbol),isBubble=_$subtypes_884.isBubble(traceIn),len=_$handleXYDefaults_886(traceIn,traceOut,layout,coerce);if(len){coerce("text"),coerce("mode",len<_$constants_868.PTS_LINESONLY?"lines+markers":"lines"),_$subtypes_884.hasLines(traceOut)&&(coerce("connectgaps"),_$lineDefaults_875(traceIn,traceOut,defaultColor,layout,coerce));var dfltHoverOn=[];_$subtypes_884.hasMarkers(traceOut)&&(_$markerDefaults_880(traceIn,traceOut,defaultColor,layout,coerce),coerce("marker.line.width",isOpen||isBubble?1:0),dfltHoverOn.push("points")),coerce("fill"),"none"!==traceOut.fill&&_$fillColorDefaults_871(0,traceOut,defaultColor,coerce),"tonext"!==traceOut.fill&&"toself"!==traceOut.fill||dfltHoverOn.push("fills"),coerce("hoveron",dfltHoverOn.join("+")||"points");var errorBarsSupplyDefaults=_$registry_668.getComponentMethod("errorbars","supplyDefaults");errorBarsSupplyDefaults(traceIn,traceOut,defaultColor,{axis:"y"}),errorBarsSupplyDefaults(traceIn,traceOut,defaultColor,{axis:"x",inherit:"y"}),_$lib_539.coerceSelectionMarkerOpacity(traceOut,coerce)}else traceOut.visible=!1},_$scattergl_911={};(function(global){"use strict";var calcMarkerSize=_$calc___calcMarkerSize,calcAxisExpansion=_$calc___calcAxisExpansion,BADNUM=_$numerical_517.BADNUM,SYMBOL_SDF_SIZE=200,SYMBOL_SIZE=20,SYMBOL_STROKE=SYMBOL_SIZE/20,SYMBOL_SDF={},SYMBOL_SVG_CIRCLE=_$drawing_436.symbolFuncs[0](.05*SYMBOL_SIZE),TOO_MANY_POINTS=1e5,DOT_RE=/-dot/,OPEN_RE=/-open/;function sceneOptions(gd,subplot,trace,positions){var i,hasLines,hasErrorX,hasErrorY,hasMarkers,hasFill,lineOptions,markerOptions,fillOptions,errorXOptions,errorYOptions,selectedOptions,unselectedOptions,linePositions,fullLayout=gd._fullLayout,count=positions.length/2,markerOpts=trace.marker;if(!0!==trace.visible?(hasLines=!1,hasErrorX=!1,hasErrorY=!1,hasMarkers=!1,hasFill=!1):(hasLines=_$subtypes_884.hasLines(trace)&&positions.length>1,hasErrorX=trace.error_x&&!0===trace.error_x.visible,hasErrorY=trace.error_y&&!0===trace.error_y.visible,hasMarkers=_$subtypes_884.hasMarkers(trace),hasFill=!!trace.fill&&"none"!==trace.fill),hasErrorX||hasErrorY){var errorVals=_$registry_668.getComponentMethod("errorbars","calcFromTrace")(trace,fullLayout);hasErrorX&&(errorXOptions=makeErrorOptions("x",trace.error_x,errorVals)),hasErrorY&&(errorYOptions=makeErrorOptions("y",trace.error_y,errorVals))}if(hasLines){(lineOptions={}).thickness=trace.line.width,lineOptions.color=trace.line.color,lineOptions.opacity=trace.opacity,lineOptions.overlay=!0;var dashes=(_$gl2d_dashes_513[trace.line.dash]||[1]).slice();for(i=0;i<dashes.length;++i)dashes[i]*=lineOptions.thickness;if(lineOptions.dashes=dashes,"hv"===trace.line.shape){for(linePositions=[],i=0;i<Math.floor(positions.length/2)-1;i++)isNaN(positions[2*i])||isNaN(positions[2*i+1])?(linePositions.push(NaN),linePositions.push(NaN),linePositions.push(NaN),linePositions.push(NaN)):(linePositions.push(positions[2*i]),linePositions.push(positions[2*i+1]),linePositions.push(positions[2*i+2]),linePositions.push(positions[2*i+1]));linePositions.push(positions[positions.length-2]),linePositions.push(positions[positions.length-1])}else if("vh"===trace.line.shape){for(linePositions=[],i=0;i<Math.floor(positions.length/2)-1;i++)isNaN(positions[2*i])||isNaN(positions[2*i+1])?(linePositions.push(NaN),linePositions.push(NaN),linePositions.push(NaN),linePositions.push(NaN)):(linePositions.push(positions[2*i]),linePositions.push(positions[2*i+1]),linePositions.push(positions[2*i]),linePositions.push(positions[2*i+3]));linePositions.push(positions[positions.length-2]),linePositions.push(positions[positions.length-1])}else linePositions=positions;var hasNaN=!1;for(i=0;i<linePositions.length;i++)if(isNaN(linePositions[i])){hasNaN=!0;break}if(lineOptions.join=hasNaN||linePositions.length>TOO_MANY_POINTS?"rect":hasMarkers?"rect":"round",hasNaN&&trace.connectgaps){var lastX=linePositions[0],lastY=linePositions[1];for(i=0;i<linePositions.length;i+=2)isNaN(linePositions[i])||isNaN(linePositions[i+1])?(linePositions[i]=lastX,linePositions[i+1]=lastY):(lastX=linePositions[i],lastY=linePositions[i+1])}lineOptions.positions=linePositions}function makeErrorOptions(axLetter,errorOpts,vals){var options={};options.positions=positions;for(var ax=_$axis_ids_587.getFromId(gd,trace[axLetter+"axis"]),errors=options.errors=new Float64Array(4*count),pOffset={x:0,y:1}[axLetter],eOffset={x:[0,1,2,3],y:[2,3,0,1]}[axLetter],i=0,p=0;i<count;i++,p+=4)errors[p+eOffset[0]]=positions[2*i+pOffset]-ax.d2l(vals[i][axLetter+"s"])||0,errors[p+eOffset[1]]=ax.d2l(vals[i][axLetter+"h"])-positions[2*i+pOffset]||0,errors[p+eOffset[2]]=0,errors[p+eOffset[3]]=0;return errorOpts.copy_ystyle&&(errorOpts=trace.error_y),options.capSize=2*errorOpts.width,options.lineWidth=errorOpts.thickness,options.color=errorOpts.color,options}function makeSelectedOptions(selected,markerOpts){var options={};return selected?(selected.marker&&selected.marker.symbol?options=makeMarkerOptions(_$lib_539.extendFlat({},markerOpts,selected.marker)):(options={},selected.marker.size&&(options.sizes=selected.marker.size),selected.marker.color&&(options.colors=selected.marker.color),void 0!==selected.marker.opacity&&(options.opacity=selected.marker.opacity)),options):options}function makeMarkerOptions(markerOpts){var i,isOpen,markerOptions={},multiSymbol=Array.isArray(markerOpts.symbol),multiColor=_$lib_539.isArrayOrTypedArray(markerOpts.color),multiLineColor=_$lib_539.isArrayOrTypedArray(markerOpts.line.color),multiOpacity=_$lib_539.isArrayOrTypedArray(markerOpts.opacity),multiSize=_$lib_539.isArrayOrTypedArray(markerOpts.size),multiLineWidth=_$lib_539.isArrayOrTypedArray(markerOpts.line.width);if(multiSymbol||(isOpen=OPEN_RE.test(markerOpts.symbol)),multiSymbol||multiColor||multiLineColor||multiOpacity){markerOptions.colors=new Array(count),markerOptions.borderColors=new Array(count);var colors=_$formatColor_535(markerOpts,markerOpts.opacity,count),borderColors=_$formatColor_535(markerOpts.line,markerOpts.opacity,count);if(!Array.isArray(borderColors[0])){var borderColor=borderColors;for(borderColors=Array(count),i=0;i<count;i++)borderColors[i]=borderColor}if(!Array.isArray(colors[0])){var color=colors;for(colors=Array(count),i=0;i<count;i++)colors[i]=color}for(markerOptions.colors=colors,markerOptions.borderColors=borderColors,i=0;i<count;i++){if(multiSymbol){var symbol=markerOpts.symbol[i];isOpen=OPEN_RE.test(symbol)}isOpen&&(borderColors[i]=colors[i].slice(),colors[i]=colors[i].slice(),colors[i][3]=0)}markerOptions.opacity=trace.opacity}else isOpen?(markerOptions.color=_$normalize_99(markerOpts.color,"uint8"),markerOptions.color[3]=0,markerOptions.borderColor=_$normalize_99(markerOpts.color,"uint8")):(markerOptions.color=_$normalize_99(markerOpts.color,"uint8"),markerOptions.borderColor=_$normalize_99(markerOpts.line.color,"uint8")),markerOptions.opacity=trace.opacity*markerOpts.opacity;if(multiSymbol)for(markerOptions.markers=new Array(count),i=0;i<count;i++)markerOptions.markers[i]=getSymbolSdf(markerOpts.symbol[i]);else markerOptions.marker=getSymbolSdf(markerOpts.symbol);var s,markerSizeFunc=_$makeBubbleSizeFn_879(trace);if(multiSize||multiLineWidth){var sizeAvg,sizes=markerOptions.sizes=new Array(count),borderSizes=markerOptions.borderSizes=new Array(count),sizeTotal=0;if(multiSize){for(i=0;i<count;i++)sizes[i]=markerSizeFunc(markerOpts.size[i]),sizeTotal+=sizes[i];sizeAvg=sizeTotal/count}else for(s=markerSizeFunc(markerOpts.size),i=0;i<count;i++)sizes[i]=s;if(multiLineWidth)for(i=0;i<count;i++)borderSizes[i]=markerSizeFunc(markerOpts.line.width[i]);else for(s=markerSizeFunc(markerOpts.line.width),i=0;i<count;i++)borderSizes[i]=s;markerOptions.sizeAvg=sizeAvg}else markerOptions.size=markerSizeFunc(markerOpts&&markerOpts.size||10),markerOptions.borderSizes=markerSizeFunc(markerOpts.line.width);return markerOptions}return hasFill&&((fillOptions={}).fill=trace.fillcolor,fillOptions.thickness=0,fillOptions.closed=!0),hasMarkers&&(markerOptions=makeMarkerOptions(markerOpts),selectedOptions=makeSelectedOptions(trace.selected,markerOpts),unselectedOptions=makeSelectedOptions(trace.unselected,markerOpts),markerOptions.positions=positions),{line:lineOptions,marker:markerOptions,errorX:errorXOptions,errorY:errorYOptions,fill:fillOptions,selected:selectedOptions,unselected:unselectedOptions}}function sceneUpdate(gd,subplot){var scene=subplot._scene,fullLayout=gd._fullLayout,reset={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],selectedOptions:[],unselectedOptions:[],errorXOptions:[],errorYOptions:[]};return subplot._scene||((scene=subplot._scene=_$lib_539.extendFlat({},reset,{selectBatch:null,unselectBatch:null,fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,select2d:null})).update=function update(opt){for(var opts=new Array(scene.count),i=0;i<scene.count;i++)opts[i]=opt;scene.fill2d&&scene.fill2d.update(opts),scene.scatter2d&&scene.scatter2d.update(opts),scene.line2d&&scene.line2d.update(opts),scene.error2d&&scene.error2d.update(opts.concat(opts)),scene.select2d&&scene.select2d.update(opts),scene.draw()},scene.draw=function draw(){var i;for(i=0;i<scene.count;i++)scene.fill2d&&scene.fillOptions[i]&&scene.fill2d.draw(i);for(i=0;i<scene.count;i++)scene.line2d&&scene.lineOptions[i]&&scene.line2d.draw(i),scene.error2d&&scene.errorXOptions[i]&&scene.error2d.draw(i),scene.error2d&&scene.errorYOptions[i]&&scene.error2d.draw(i+scene.count),!scene.scatter2d||!scene.markerOptions[i]||scene.selectBatch&&scene.selectBatch[i]||scene.scatter2d.draw(i);scene.scatter2d&&scene.select2d&&scene.selectBatch&&(scene.select2d.draw(scene.selectBatch),scene.scatter2d.draw(scene.unselectBatch)),scene.dirty=!1},scene.clear=function clear(){var vp,gl,vpSize=fullLayout._size,width=fullLayout.width,height=fullLayout.height,xaxis=subplot.xaxis,yaxis=subplot.yaxis;vp=xaxis&&xaxis.domain&&yaxis&&yaxis.domain?[vpSize.l+xaxis.domain[0]*vpSize.w,vpSize.b+yaxis.domain[0]*vpSize.h,width-vpSize.r-(1-xaxis.domain[1])*vpSize.w,height-vpSize.t-(1-yaxis.domain[1])*vpSize.h]:[vpSize.l,vpSize.b,width-vpSize.r,height-vpSize.t],scene.select2d&&((gl=scene.select2d.regl._gl).enable(gl.SCISSOR_TEST),gl.scissor(vp[0],vp[1],vp[2]-vp[0],vp[3]-vp[1]),gl.clearColor(0,0,0,0),gl.clear(gl.COLOR_BUFFER_BIT)),scene.scatter2d&&((gl=scene.scatter2d.regl._gl).enable(gl.SCISSOR_TEST),gl.scissor(vp[0],vp[1],vp[2]-vp[0],vp[3]-vp[1]),gl.clearColor(0,0,0,0),gl.clear(gl.COLOR_BUFFER_BIT))},scene.clearSelect=function clearSelect(){scene.selectBatch&&(scene.selectBatch=null,scene.unselectBatch=null,scene.scatter2d.update(scene.markerOptions),scene.clear(),scene.draw())},scene.destroy=function destroy(){scene.fill2d&&scene.fill2d.destroy(),scene.scatter2d&&scene.scatter2d.destroy(),scene.error2d&&scene.error2d.destroy(),scene.line2d&&scene.line2d.destroy(),scene.select2d&&scene.select2d.destroy(),scene.lineOptions=null,scene.fillOptions=null,scene.markerOptions=null,scene.selectedOptions=null,scene.unselectedOptions=null,scene.errorXOptions=null,scene.errorYOptions=null,scene.selectBatch=null,scene.unselectBatch=null,subplot._scene=null}),scene.dirty||_$lib_539.extendFlat(scene,reset),scene}function getSymbolSdf(symbol){if("circle"===symbol)return null;var symbolPath,symbolSdf,symbolNumber=_$drawing_436.symbolNumber(symbol),symbolFunc=_$drawing_436.symbolFuncs[symbolNumber%100],symbolNoDot=!!_$drawing_436.symbolNoDot[symbolNumber%100],symbolNoFill=!!_$drawing_436.symbolNoFill[symbolNumber%100],isDot=DOT_RE.test(symbol);return SYMBOL_SDF[symbol]?SYMBOL_SDF[symbol]:(symbolPath=isDot&&!symbolNoDot?symbolFunc(1.1*SYMBOL_SIZE)+SYMBOL_SVG_CIRCLE:symbolFunc(SYMBOL_SIZE),symbolSdf=_$pathSdf_350(symbolPath,{w:SYMBOL_SDF_SIZE,h:SYMBOL_SDF_SIZE,viewBox:[-SYMBOL_SIZE,-SYMBOL_SIZE,SYMBOL_SIZE,SYMBOL_SIZE],stroke:symbolNoFill?SYMBOL_STROKE:-SYMBOL_STROKE}),SYMBOL_SDF[symbol]=symbolSdf,symbolSdf||null)}_$scattergl_911={moduleType:"trace",name:"scattergl",basePlotModule:_$cartesian_595,categories:["gl","regl","cartesian","symbols","errorBarsOK","markerColorscale","showLegend","scatter-like"],attributes:_$attributes_909,supplyDefaults:_$supplyDefaults_910,cleanData:_$cleanData_865,colorbar:_$colorbar_866,calc:function calc(gd,trace){var i,xx,yy,fullLayout=gd._fullLayout,xa=_$axis_ids_587.getFromId(gd,trace.xaxis),ya=_$axis_ids_587.getFromId(gd,trace.yaxis),subplot=fullLayout._plots[trace.xaxis+trace.yaxis],count=trace._length,count2=2*count,stash={},x=xa.makeCalcdata(trace,"x"),y=ya.makeCalcdata(trace,"y"),positions=new Array(count2);for(i=0;i<count;i++)xx=x[i],yy=y[i],positions[2*i]=xx===BADNUM?NaN:xx,positions[2*i+1]=yy===BADNUM?NaN:yy;if("log"===xa.type)for(i=0;i<count2;i+=2)positions[i]=xa.c2l(positions[i]);if("log"===ya.type)for(i=1;i<count2;i+=2)positions[i]=ya.c2l(positions[i]);if("log"!==xa.type&&"log"!==ya.type)stash.tree=_$KDTree_252(positions,512);else{var ids=stash.ids=new Array(count);for(i=0;i<count;i++)ids[i]=i}_$calcMarkerColorscale_867(trace);var ppad,options=sceneOptions(gd,0,trace,positions),markerOptions=options.marker,scene=sceneUpdate(gd,subplot);return count<TOO_MANY_POINTS?ppad=calcMarkerSize(trace,count):markerOptions&&(ppad=2*(markerOptions.sizeAvg||Math.max(markerOptions.size,3))),calcAxisExpansion(gd,trace,xa,ya,x,y,ppad),options.fill&&!scene.fill2d&&(scene.fill2d=!0),options.marker&&!scene.scatter2d&&(scene.scatter2d=!0),options.line&&!scene.line2d&&(scene.line2d=!0),!options.errorX&&!options.errorY||scene.error2d||(scene.error2d=!0),scene.lineOptions.push(options.line),scene.errorXOptions.push(options.errorX),scene.errorYOptions.push(options.errorY),scene.fillOptions.push(options.fill),scene.markerOptions.push(options.marker),scene.selectedOptions.push(options.selected),scene.unselectedOptions.push(options.unselected),scene.count++,stash.scene=scene,stash.index=scene.count-1,stash.x=x,stash.y=y,stash.positions=positions,stash.count=count,gd.firstscatter=!1,[{x:!1,y:!1,t:stash,trace:trace}]},plot:function plot(gd,subplot,cdata){if(cdata.length){var fullLayout=gd._fullLayout,scene=cdata[0][0].t.scene,dragmode=fullLayout.dragmode;if(scene){var vpSize=fullLayout._size,width=fullLayout.width,height=fullLayout.height;fullLayout._glcanvas.each(function(d){d.regl||d.pick||(d.regl=_$regl_315({canvas:this,attributes:{antialias:!d.pick,preserveDrawingBuffer:!0},extensions:["ANGLE_instanced_arrays","OES_element_index_uint"],pixelRatio:gd._context.plotGlPixelRatio||global.devicePixelRatio}))});var regl=fullLayout._glcanvas.data()[0].regl;if(_$linkTraces_878(gd,subplot,cdata),scene.dirty){if(!0===scene.error2d&&(scene.error2d=_$Error2D_311(regl)),!0===scene.line2d&&(scene.line2d=_$createLine_312(regl)),!0===scene.scatter2d&&(scene.scatter2d=_$Scatter_313(regl)),!0===scene.fill2d&&(scene.fill2d=_$createLine_312(regl)),scene.line2d&&scene.line2d.update(scene.lineOptions),scene.error2d){var errorBatch=(scene.errorXOptions||[]).concat(scene.errorYOptions||[]);scene.error2d.update(errorBatch)}scene.scatter2d&&scene.scatter2d.update(scene.markerOptions),scene.fill2d&&(scene.fillOptions=scene.fillOptions.map(function(fillOptions,i){var cdscatter=cdata[i];if(!(fillOptions&&cdscatter&&cdscatter[0]&&cdscatter[0].trace))return null;var last,j,cd=cdscatter[0],trace=cd.trace,stash=cd.t,lineOptions=scene.lineOptions[i],pos=[],srcPos=lineOptions&&lineOptions.positions||stash.positions;if("tozeroy"===trace.fill)(pos=(pos=[srcPos[0],0]).concat(srcPos)).push(srcPos[srcPos.length-2]),pos.push(0);else if("tozerox"===trace.fill)(pos=(pos=[0,srcPos[1]]).concat(srcPos)).push(0),pos.push(srcPos[srcPos.length-1]);else if("toself"===trace.fill||"tonext"===trace.fill){for(pos=[],last=0,j=0;j<srcPos.length;j+=2)(isNaN(srcPos[j])||isNaN(srcPos[j+1]))&&((pos=pos.concat(srcPos.slice(last,j))).push(srcPos[last],srcPos[last+1]),last=j+2);pos=pos.concat(srcPos.slice(last)),last&&pos.push(srcPos[last],srcPos[last+1])}else{var nextTrace=trace._nexttrace;if(nextTrace){var nextOptions=scene.lineOptions[i+1];if(nextOptions){var nextPos=nextOptions.positions;if("tonexty"===trace.fill){for(pos=srcPos.slice(),i=Math.floor(nextPos.length/2);i--;){var xx=nextPos[2*i],yy=nextPos[2*i+1];isNaN(xx)||isNaN(yy)||(pos.push(xx),pos.push(yy))}fillOptions.fill=nextTrace.fillcolor}}}}if(trace._prevtrace&&"tonext"===trace._prevtrace.fill){var prevLinePos=scene.lineOptions[i-1].positions,offset=pos.length/2,hole=[last=offset];for(j=0;j<prevLinePos.length;j+=2)(isNaN(prevLinePos[j])||isNaN(prevLinePos[j+1]))&&(hole.push(j/2+offset+1),last=j+2);pos=pos.concat(prevLinePos),fillOptions.hole=hole}return fillOptions.opacity=trace.opacity,fillOptions.positions=pos,fillOptions}),scene.fill2d.update(scene.fillOptions))}var selectMode="lasso"===dragmode||"select"===dragmode,vpRange=cdata.map(function(cdscatter){if(cdscatter&&cdscatter[0]&&cdscatter[0].trace){var i,cd=cdscatter[0],trace=cd.trace,stash=cd.t,id=stash.index,x=stash.x,y=stash.y,xaxis=subplot.xaxis||_$axis_ids_587.getFromId(gd,trace.xaxis||"x"),yaxis=subplot.yaxis||_$axis_ids_587.getFromId(gd,trace.yaxis||"y"),range=[(xaxis._rl||xaxis.range)[0],(yaxis._rl||yaxis.range)[0],(xaxis._rl||xaxis.range)[1],(yaxis._rl||yaxis.range)[1]],viewport=[vpSize.l+xaxis.domain[0]*vpSize.w,vpSize.b+yaxis.domain[0]*vpSize.h,width-vpSize.r-(1-xaxis.domain[1])*vpSize.w,height-vpSize.t-(1-yaxis.domain[1])*vpSize.h];if(trace.selectedpoints||selectMode){if(selectMode||(selectMode=!0),scene.selectBatch||(scene.selectBatch=[]),scene.unselectBatch||(scene.unselectBatch=[]),trace.selectedpoints){scene.selectBatch[id]=trace.selectedpoints;var selPts=trace.selectedpoints,selDict={};for(i=0;i<selPts.length;i++)selDict[selPts[i]]=!0;var unselPts=[];for(i=0;i<stash.count;i++)selDict[i]||unselPts.push(i);scene.unselectBatch[id]=unselPts}var xpx=new Array(stash.count),ypx=new Array(stash.count);for(i=0;i<stash.count;i++)xpx[i]=xaxis.c2p(x[i]),ypx[i]=yaxis.c2p(y[i]);stash.xpx=xpx,stash.ypx=ypx}else stash.xpx=stash.ypx=null;return trace.visible?{viewport:viewport,range:range}:null}});selectMode&&(scene.select2d||(scene.select2d=_$Scatter_313(fullLayout._glcanvas.data()[1].regl,{clone:scene.scatter2d})),scene.scatter2d&&scene.selectBatch&&scene.selectBatch.length&&scene.scatter2d.update(scene.unselectedOptions.map(function(opts,i){return scene.selectBatch[i]?opts:null})),scene.select2d&&(scene.select2d.update(scene.markerOptions),scene.select2d.update(scene.selectedOptions))),scene.fill2d&&scene.fill2d.update(vpRange),scene.line2d&&scene.line2d.update(vpRange),scene.error2d&&scene.error2d.update(vpRange.concat(vpRange)),scene.scatter2d&&scene.scatter2d.update(vpRange),scene.select2d&&scene.select2d.update(vpRange),scene.draw()}}},hoverPoints:function hoverPoints(pointData,xval,yval,hovermode){var ids,cd=pointData.cd,stash=cd[0].t,trace=cd[0].trace,xa=pointData.xa,ya=pointData.ya,x=stash.x,y=stash.y,xpx=xa.c2p(xval),ypx=ya.c2p(yval),maxDistance=pointData.distance;if(stash.tree){var xl=xa.p2c(xpx-maxDistance),xr=xa.p2c(xpx+maxDistance),yl=ya.p2c(ypx-maxDistance),yr=ya.p2c(ypx+maxDistance);ids="x"===hovermode?stash.tree.range(Math.min(xl,xr),Math.min(ya._rl[0],ya._rl[1]),Math.max(xl,xr),Math.max(ya._rl[0],ya._rl[1])):stash.tree.range(Math.min(xl,xr),Math.min(yl,yr),Math.max(xl,xr),Math.max(yl,yr))}else{if(!stash.ids)return[pointData];ids=stash.ids}var id,ptx,pty,i,dx,dy,dist,dxy,minDist=maxDistance;if("x"===hovermode)for(i=0;i<ids.length;i++)ptx=x[ids[i]],(dx=Math.abs(xa.c2p(ptx)-xpx))<minDist&&(minDist=dx,dy=ya.c2p(y[ids[i]])-ypx,dxy=Math.sqrt(dx*dx+dy*dy),id=ids[i]);else for(i=0;i<ids.length;i++)ptx=x[ids[i]],pty=y[ids[i]],dx=xa.c2p(ptx)-xpx,dy=ya.c2p(pty)-ypx,(dist=Math.sqrt(dx*dx+dy*dy))<minDist&&(minDist=dxy=dist,id=ids[i]);if(pointData.index=id,void 0===id)return[pointData];var di={pointNumber:id,x:x[id],y:y[id]};di.tx=Array.isArray(trace.text)?trace.text[id]:trace.text,di.htx=Array.isArray(trace.hovertext)?trace.hovertext[id]:trace.hovertext,di.data=Array.isArray(trace.customdata)?trace.customdata[id]:trace.customdata,di.tp=Array.isArray(trace.textposition)?trace.textposition[id]:trace.textposition;var font=trace.textfont;font&&(di.ts=Array.isArray(font.size)?font.size[id]:font.size,di.tc=Array.isArray(font.color)?font.color[id]:font.color,di.tf=Array.isArray(font.family)?font.family[id]:font.family);var marker=trace.marker;marker&&(di.ms=_$lib_539.isArrayOrTypedArray(marker.size)?marker.size[id]:marker.size,di.mo=_$lib_539.isArrayOrTypedArray(marker.opacity)?marker.opacity[id]:marker.opacity,di.mx=Array.isArray(marker.symbol)?marker.symbol[id]:marker.symbol,di.mc=_$lib_539.isArrayOrTypedArray(marker.color)?marker.color[id]:marker.color);var line=marker&&marker.line;line&&(di.mlc=Array.isArray(line.color)?line.color[id]:line.color,di.mlw=_$lib_539.isArrayOrTypedArray(line.width)?line.width[id]:line.width);var grad=marker&&marker.gradient;grad&&"none"!==grad.type&&(di.mgt=Array.isArray(grad.type)?grad.type[id]:grad.type,di.mgc=Array.isArray(grad.color)?grad.color[id]:grad.color);var xp=xa.c2p(di.x,!0),yp=ya.c2p(di.y,!0),rad=di.mrc||1,hoverlabel=trace.hoverlabel;hoverlabel&&(di.hbg=Array.isArray(hoverlabel.bgcolor)?hoverlabel.bgcolor[id]:hoverlabel.bgcolor,di.hbc=Array.isArray(hoverlabel.bordercolor)?hoverlabel.bordercolor[id]:hoverlabel.bordercolor,di.hts=Array.isArray(hoverlabel.font.size)?hoverlabel.font.size[id]:hoverlabel.font.size,di.htc=Array.isArray(hoverlabel.font.color)?hoverlabel.font.color[id]:hoverlabel.font.color,di.htf=Array.isArray(hoverlabel.font.family)?hoverlabel.font.family[id]:hoverlabel.font.family,di.hnl=Array.isArray(hoverlabel.namelength)?hoverlabel.namelength[id]:hoverlabel.namelength);var hoverinfo=trace.hoverinfo;hoverinfo&&(di.hi=Array.isArray(hoverinfo)?hoverinfo[id]:hoverinfo);var fakeCd={};return fakeCd[pointData.index]=di,_$lib_539.extendFlat(pointData,{color:_$getTraceColor_872(trace,di),x0:xp-rad,x1:xp+rad,xLabelVal:di.x,y0:yp-rad,y1:yp+rad,yLabelVal:di.y,cd:fakeCd,distance:minDist,spikeDistance:dxy}),di.htx?pointData.text=di.htx:di.tx?pointData.text=di.tx:trace.text&&(pointData.text=trace.text),_$fillHoverText_870(di,trace,pointData),_$registry_668.getComponentMethod("errorbars","hoverInfo")(di,trace,pointData),[pointData]},style:function style(gd,cd){if(cd){var scene=cd[0].t.scene;scene.clear(),scene.draw()}},selectPoints:function selectPoints(searchInfo,polygon){var cd=searchInfo.cd,selection=[],trace=cd[0].trace,stash=cd[0].t,x=stash.x,y=stash.y,scene=stash.scene;if(!scene)return selection;var hasOnlyLines=!_$subtypes_884.hasMarkers(trace)&&!_$subtypes_884.hasText(trace);if(!0!==trace.visible||hasOnlyLines)return selection;var i,els=null,unels=null;if(!1===polygon||polygon.degenerate)unels=_$newArray_50(stash.count);else for(els=[],unels=[],i=0;i<stash.count;i++)polygon.contains([stash.xpx[i],stash.ypx[i]])?(els.push(i),selection.push({pointNumber:i,x:x[i],y:y[i]})):unels.push(i);if(scene.selectBatch||(scene.selectBatch=[],scene.unselectBatch=[]),!scene.selectBatch[stash.index]){for(i=0;i<scene.count;i++)scene.selectBatch[i]=[],scene.unselectBatch[i]=[];scene.scatter2d.update(scene.unselectedOptions)}return scene.selectBatch[stash.index]=els,scene.unselectBatch[stash.index]=unels,selection},sceneOptions:sceneOptions,sceneUpdate:sceneUpdate,meta:{}}}).call(this,void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var _$scattergl_30=_$scattergl_911,_$mapboxGl_254={exports:{}};(function(global){"use strict";!function(f){"object"==typeof _$mapboxGl_254.exports?_$mapboxGl_254.exports=f():("undefined"!=typeof window?window:void 0!==global?global:"undefined"!=typeof self?self:this).mapboxgl=f()}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){if(!u&&("function"==typeof require&&require))return require(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n||e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){function polygonArea(e){var r=0;if(e&&e.length>0){r+=Math.abs(ringArea(e[0]));for(var t=1;t<e.length;t++)r-=Math.abs(ringArea(e[t]))}return r}function ringArea(e){var r,t,o,a,i,g,s=0,l=e.length;if(l>2){for(g=0;g<l;g++)g===l-2?(o=l-2,a=l-1,i=0):g===l-1?(o=l-1,a=0,i=1):(o=g,a=g+1,i=g+2),r=e[o],t=e[a],s+=(rad(e[i][0])-rad(r[0]))*Math.sin(rad(t[1]));s=s*wgs84.RADIUS*wgs84.RADIUS/2}return s}function rad(e){return e*Math.PI/180}var wgs84=_dereq_("wgs84");module.exports.geometry=function geometry(e){var r,t=0;switch(e.type){case"Polygon":return polygonArea(e.coordinates);case"MultiPolygon":for(r=0;r<e.coordinates.length;r++)t+=polygonArea(e.coordinates[r]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(r=0;r<e.geometries.length;r++)t+=geometry(e.geometries[r]);return t}},module.exports.ring=ringArea},{wgs84:37}],2:[function(_dereq_,module,exports){var t,n;t=this,n=function(){return function(){var t=new Float32Array(3);t[0]=0,t[1]=0,t[2]=0}(),function(){var t=new Float32Array(4);t[0]=0,t[1]=0,t[2]=0,t[3]=0}(),{vec3:{transformMat3:function t(t,n,r){var e=n[0],a=n[1],o=n[2];return t[0]=e*r[0]+a*r[3]+o*r[6],t[1]=e*r[1]+a*r[4]+o*r[7],t[2]=e*r[2]+a*r[5]+o*r[8],t}},vec4:{transformMat4:function n(t,n,r){var e=n[0],a=n[1],o=n[2],u=n[3];return t[0]=r[0]*e+r[4]*a+r[8]*o+r[12]*u,t[1]=r[1]*e+r[5]*a+r[9]*o+r[13]*u,t[2]=r[2]*e+r[6]*a+r[10]*o+r[14]*u,t[3]=r[3]*e+r[7]*a+r[11]*o+r[15]*u,t}},mat2:{create:function r(){var t=new Float32Array(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},rotate:function e(t,n,r){var e=n[0],a=n[1],o=n[2],u=n[3],i=Math.sin(r),c=Math.cos(r);return t[0]=e*c+o*i,t[1]=a*c+u*i,t[2]=e*-i+o*c,t[3]=a*-i+u*c,t},scale:function a(t,n,r){var e=n[0],a=n[1],o=n[2],u=n[3],i=r[0],c=r[1];return t[0]=e*i,t[1]=a*i,t[2]=o*c,t[3]=u*c,t}},mat3:{create:function o(){var t=new Float32Array(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromRotation:function u(t,n){var r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=r,t[2]=0,t[3]=-r,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}},mat4:{create:function i(){var t=new Float32Array(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},identity:function c(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},translate:function s(t,n,r){var e,a,o,u,i,c,f,v,s,l,M,h,m=r[0],y=r[1],d=r[2];return n===t?(t[12]=n[0]*m+n[4]*y+n[8]*d+n[12],t[13]=n[1]*m+n[5]*y+n[9]*d+n[13],t[14]=n[2]*m+n[6]*y+n[10]*d+n[14],t[15]=n[3]*m+n[7]*y+n[11]*d+n[15]):(e=n[0],a=n[1],o=n[2],u=n[3],i=n[4],c=n[5],f=n[6],v=n[7],s=n[8],l=n[9],M=n[10],h=n[11],t[0]=e,t[1]=a,t[2]=o,t[3]=u,t[4]=i,t[5]=c,t[6]=f,t[7]=v,t[8]=s,t[9]=l,t[10]=M,t[11]=h,t[12]=e*m+i*y+s*d+n[12],t[13]=a*m+c*y+l*d+n[13],t[14]=o*m+f*y+M*d+n[14],t[15]=u*m+v*y+h*d+n[15]),t},scale:function l(t,n,r){var e=r[0],a=r[1],o=r[2];return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=n[7]*a,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=n[11]*o,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},multiply:function v(t,n,r){var e=n[0],a=n[1],o=n[2],u=n[3],i=n[4],c=n[5],f=n[6],v=n[7],s=n[8],l=n[9],M=n[10],h=n[11],m=n[12],y=n[13],d=n[14],p=n[15],w=r[0],A=r[1],F=r[2],x=r[3];return t[0]=w*e+A*i+F*s+x*m,t[1]=w*a+A*c+F*l+x*y,t[2]=w*o+A*f+F*M+x*d,t[3]=w*u+A*v+F*h+x*p,w=r[4],A=r[5],F=r[6],x=r[7],t[4]=w*e+A*i+F*s+x*m,t[5]=w*a+A*c+F*l+x*y,t[6]=w*o+A*f+F*M+x*d,t[7]=w*u+A*v+F*h+x*p,w=r[8],A=r[9],F=r[10],x=r[11],t[8]=w*e+A*i+F*s+x*m,t[9]=w*a+A*c+F*l+x*y,t[10]=w*o+A*f+F*M+x*d,t[11]=w*u+A*v+F*h+x*p,w=r[12],A=r[13],F=r[14],x=r[15],t[12]=w*e+A*i+F*s+x*m,t[13]=w*a+A*c+F*l+x*y,t[14]=w*o+A*f+F*M+x*d,t[15]=w*u+A*v+F*h+x*p,t},perspective:function m(t,n,r,e,a){var o=1/Math.tan(n/2),u=1/(e-a);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(a+e)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*a*e*u,t[15]=0,t},rotateX:function M(t,n,r){var e=Math.sin(r),a=Math.cos(r),o=n[4],u=n[5],i=n[6],c=n[7],f=n[8],v=n[9],s=n[10],l=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=o*a+f*e,t[5]=u*a+v*e,t[6]=i*a+s*e,t[7]=c*a+l*e,t[8]=f*a-o*e,t[9]=v*a-u*e,t[10]=s*a-i*e,t[11]=l*a-c*e,t},rotateZ:function h(t,n,r){var e=Math.sin(r),a=Math.cos(r),o=n[0],u=n[1],i=n[2],c=n[3],f=n[4],v=n[5],s=n[6],l=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=o*a+f*e,t[1]=u*a+v*e,t[2]=i*a+s*e,t[3]=c*a+l*e,t[4]=f*a-o*e,t[5]=v*a-u*e,t[6]=s*a-i*e,t[7]=l*a-c*e,t},invert:function f(t,n){var r=n[0],e=n[1],a=n[2],o=n[3],u=n[4],i=n[5],c=n[6],f=n[7],v=n[8],s=n[9],l=n[10],M=n[11],h=n[12],m=n[13],y=n[14],d=n[15],p=r*i-e*u,w=r*c-a*u,A=r*f-o*u,F=e*c-a*i,x=e*f-o*i,b=a*f-o*c,g=v*m-s*h,j=v*y-l*h,R=v*d-M*h,X=s*y-l*m,Z=s*d-M*m,k=l*d-M*y,q=p*k-w*Z+A*X+F*R-x*j+b*g;return q?(q=1/q,t[0]=(i*k-c*Z+f*X)*q,t[1]=(a*Z-e*k-o*X)*q,t[2]=(m*b-y*x+d*F)*q,t[3]=(l*x-s*b-M*F)*q,t[4]=(c*R-u*k-f*j)*q,t[5]=(r*k-a*R+o*j)*q,t[6]=(y*A-h*b-d*w)*q,t[7]=(v*b-l*A+M*w)*q,t[8]=(u*Z-i*R+f*g)*q,t[9]=(e*R-r*Z-o*g)*q,t[10]=(h*x-m*A+d*p)*q,t[11]=(s*A-v*x-M*p)*q,t[12]=(i*j-u*X-c*g)*q,t[13]=(r*X-e*j+a*g)*q,t[14]=(m*w-h*F-y*p)*q,t[15]=(v*F-s*w+l*p)*q,t):null},ortho:function y(t,n,r,e,a,o,u){var i=1/(n-r),c=1/(e-a),f=1/(o-u);return t[0]=-2*i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*f,t[11]=0,t[12]=(n+r)*i,t[13]=(a+e)*c,t[14]=(u+o)*f,t[15]=1,t}}}},"object"==typeof exports&&void 0!==module?module.exports=n():t.glMatrix=n()},{}],3:[function(_dereq_,module,exports){function isSupported(e){return!!(function isBrowser(){return"undefined"!=typeof window&&"undefined"!=typeof document}()&&function isArraySupported(){return Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray}()&&function isFunctionSupported(){return Function.prototype&&Function.prototype.bind}()&&function isObjectSupported(){return Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions}()&&function isJSONSupported(){return"JSON"in window&&"parse"in JSON&&"stringify"in JSON}()&&function isWorkerSupported(){if(!("Worker"in window&&"Blob"in window))return!1;var e,t,r=new Blob([""],{type:"text/javascript"}),o=URL.createObjectURL(r);try{t=new Worker(o),e=!0}catch(t){e=!1}return t&&t.terminate(),URL.revokeObjectURL(o),e}()&&function isUint8ClampedArraySupported(){return"Uint8ClampedArray"in window}()&&function isWebGLSupportedCached(e){return void 0===isWebGLSupportedCache[e]&&(isWebGLSupportedCache[e]=function isWebGLSupported(e){var t=document.createElement("canvas"),r=Object.create(isSupported.webGLContextAttributes);return r.failIfMajorPerformanceCaveat=e,t.probablySupportsContext?t.probablySupportsContext("webgl",r)||t.probablySupportsContext("experimental-webgl",r):t.supportsContext?t.supportsContext("webgl",r)||t.supportsContext("experimental-webgl",r):t.getContext("webgl",r)||t.getContext("experimental-webgl",r)}(e)),isWebGLSupportedCache[e]}(e&&e.failIfMajorPerformanceCaveat))}void 0!==module&&module.exports?module.exports=isSupported:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=isSupported);var isWebGLSupportedCache={};isSupported.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}},{}],4:[function(_dereq_,module,exports){function Point(t,n){this.x=t,this.y=n}module.exports=Point,Point.prototype={clone:function(){return new Point(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,n){return this.clone()._rotateAround(t,n)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var n=t.x-this.x,i=t.y-this.y;return n*n+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,n){return Math.atan2(this.x*n-this.y*t,this.x*t+this.y*n)},_matMult:function(t){var n=t[0]*this.x+t[1]*this.y,i=t[2]*this.x+t[3]*this.y;return this.x=n,this.y=i,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var n=Math.cos(t),i=Math.sin(t),s=n*this.x-i*this.y,r=i*this.x+n*this.y;return this.x=s,this.y=r,this},_rotateAround:function(t,n){var i=Math.cos(t),s=Math.sin(t),r=n.x+i*(this.x-n.x)-s*(this.y-n.y),h=n.y+s*(this.x-n.x)+i*(this.y-n.y);return this.x=r,this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Point.convert=function(t){return t instanceof Point?t:Array.isArray(t)?new Point(t[0],t[1]):t}},{}],5:[function(_dereq_,module,exports){var t,e;t=this,e=function(){function t(t,e,i){i=i||{},this.w=t||64,this.h=e||64,this.autoResize=!!i.autoResize,this.shelves=[],this.freebins=[],this.stats={},this.bins={},this.maxId=0}function e(t,e,i){this.x=0,this.y=t,this.w=this.free=e,this.h=i}return t.prototype.pack=function(t,e){t=[].concat(t),e=e||{};for(var i,s,h,n,r=[],f=0;f<t.length;f++)if(i=t[f].w||t[f].width,s=t[f].h||t[f].height,h=t[f].id,i&&s){if(!(n=this.packOne(i,s,h)))continue;e.inPlace&&(t[f].x=n.x,t[f].y=n.y,t[f].id=n.id),r.push(n)}return this.shrink(),r},t.prototype.packOne=function(t,i,s){var h,n,r,f,u,l,c,p,o={freebin:-1,shelf:-1,waste:1/0},a=0;if("string"==typeof s||"number"==typeof s){if(h=this.getBin(s))return this.ref(h),h;"number"==typeof s&&(this.maxId=Math.max(s,this.maxId))}else s=++this.maxId;for(f=0;f<this.freebins.length;f++){if(i===(h=this.freebins[f]).maxh&&t===h.maxw)return this.allocFreebin(f,t,i,s);i>h.maxh||t>h.maxw||i<=h.maxh&&t<=h.maxw&&(r=h.maxw*h.maxh-t*i)<o.waste&&(o.waste=r,o.freebin=f)}for(f=0;f<this.shelves.length;f++)if(a+=(n=this.shelves[f]).h,!(t>n.free)){if(i===n.h)return this.allocShelf(f,t,i,s);i>n.h||i<n.h&&(r=(n.h-i)*t)<o.waste&&(o.freebin=-1,o.waste=r,o.shelf=f)}return-1!==o.freebin?this.allocFreebin(o.freebin,t,i,s):-1!==o.shelf?this.allocShelf(o.shelf,t,i,s):i<=this.h-a&&t<=this.w?(n=new e(a,this.w,i),this.allocShelf(this.shelves.push(n)-1,t,i,s)):this.autoResize?(u=l=this.h,((c=p=this.w)<=u||t>c)&&(p=2*Math.max(t,c)),(u<c||i>u)&&(l=2*Math.max(i,u)),this.resize(p,l),this.packOne(t,i,s)):null},t.prototype.allocFreebin=function(t,e,i,s){var h=this.freebins.splice(t,1)[0];return h.id=s,h.w=e,h.h=i,h.refcount=0,this.bins[s]=h,this.ref(h),h},t.prototype.allocShelf=function(t,e,i,s){var n=this.shelves[t].alloc(e,i,s);return this.bins[s]=n,this.ref(n),n},t.prototype.shrink=function(){if(this.shelves.length>0){for(var t=0,e=0,i=0;i<this.shelves.length;i++){var s=this.shelves[i];e+=s.h,t=Math.max(s.w-s.free,t)}this.resize(t,e)}},t.prototype.getBin=function(t){return this.bins[t]},t.prototype.ref=function(t){if(1==++t.refcount){var e=t.h;this.stats[e]=1+(0|this.stats[e])}return t.refcount},t.prototype.unref=function(t){return 0===t.refcount?0:(0==--t.refcount&&(this.stats[t.h]--,delete this.bins[t.id],this.freebins.push(t)),t.refcount)},t.prototype.clear=function(){this.shelves=[],this.freebins=[],this.stats={},this.bins={},this.maxId=0},t.prototype.resize=function(t,e){this.w=t,this.h=e;for(var i=0;i<this.shelves.length;i++)this.shelves[i].resize(t);return!0},e.prototype.alloc=function(t,e,s){if(t>this.free||e>this.h)return null;var h=this.x;return this.x+=t,this.free-=t,new function i(t,e,i,s,h,n,r){this.id=t,this.x=e,this.y=i,this.w=s,this.h=h,this.maxw=n||s,this.maxh=r||h,this.refcount=0}(s,h,this.y,t,e,t,this.h)},e.prototype.resize=function(t){return this.free+=t-this.w,this.w=t,!0},t},"object"==typeof exports&&void 0!==module?module.exports=e():t.ShelfPack=e()},{}],6:[function(_dereq_,module,exports){function TinySDF(t,i,s,e,h,r){this.fontSize=t||24,this.buffer=void 0===i?3:i,this.cutoff=e||.25,this.fontFamily=h||"sans-serif",this.fontWeight=r||"normal",this.radius=s||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function edt(t,i,s,e,h,r,a){for(var n=0;n<i;n++){for(var o=0;o<s;o++)e[o]=t[o*i+n];for(edt1d(e,h,r,a,s),o=0;o<s;o++)t[o*i+n]=h[o]}for(o=0;o<s;o++){for(n=0;n<i;n++)e[n]=t[o*i+n];for(edt1d(e,h,r,a,i),n=0;n<i;n++)t[o*i+n]=Math.sqrt(h[n])}}function edt1d(t,i,s,e,h){s[0]=0,e[0]=-INF,e[1]=+INF;for(var r=1,a=0;r<h;r++){for(var n=(t[r]+r*r-(t[s[a]]+s[a]*s[a]))/(2*r-2*s[a]);n<=e[a];)a--,n=(t[r]+r*r-(t[s[a]]+s[a]*s[a]))/(2*r-2*s[a]);s[++a]=r,e[a]=n,e[a+1]=+INF}for(r=0,a=0;r<h;r++){for(;e[a+1]<r;)a++;i[r]=(r-s[a])*(r-s[a])+t[s[a]]}}module.exports=TinySDF;var INF=1e20;TinySDF.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var i=this.ctx.getImageData(0,0,this.size,this.size),s=new Uint8ClampedArray(this.size*this.size),e=0;e<this.size*this.size;e++){var h=i.data[4*e+3]/255;this.gridOuter[e]=1===h?0:0===h?INF:Math.pow(Math.max(0,.5-h),2),this.gridInner[e]=1===h?INF:0===h?0:Math.pow(Math.max(0,h-.5),2)}for(edt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),edt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),e=0;e<this.size*this.size;e++){var r=this.gridOuter[e]-this.gridInner[e];s[e]=Math.max(0,Math.min(255,Math.round(255-255*(r/this.radius+this.cutoff))))}return s}},{}],7:[function(_dereq_,module,exports){function UnitBezier(t,i,e,r){this.cx=3*t,this.bx=3*(e-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(r-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=e,this.p2y=r}module.exports=UnitBezier,UnitBezier.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},UnitBezier.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},UnitBezier.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},UnitBezier.prototype.solveCurveX=function(t,i){var e,r,s,h,n;for(void 0===i&&(i=1e-6),s=t,n=0;n<8;n++){if(h=this.sampleCurveX(s)-t,Math.abs(h)<i)return s;var u=this.sampleCurveDerivativeX(s);if(Math.abs(u)<1e-6)break;s-=h/u}if(r=1,(s=t)<(e=0))return e;if(s>r)return r;for(;e<r;){if(h=this.sampleCurveX(s),Math.abs(h-t)<i)return s;t>h?e=s:r=s,s=.5*(r-e)+e}return s},UnitBezier.prototype.solve=function(t,i){return this.sampleCurveY(this.solveCurveX(t,i))}},{}],8:[function(_dereq_,module,exports){module.exports.VectorTile=_dereq_("./lib/vectortile.js"),module.exports.VectorTileFeature=_dereq_("./lib/vectortilefeature.js"),module.exports.VectorTileLayer=_dereq_("./lib/vectortilelayer.js")},{"./lib/vectortile.js":9,"./lib/vectortilefeature.js":10,"./lib/vectortilelayer.js":11}],9:[function(_dereq_,module,exports){function readTile(e,r,i){if(3===e){var t=new VectorTileLayer(i,i.readVarint()+i.pos);t.length&&(r[t.name]=t)}}var VectorTileLayer=_dereq_("./vectortilelayer");module.exports=function VectorTile(e,r){this.layers=e.readFields(readTile,{},r)}},{"./vectortilelayer":11}],10:[function(_dereq_,module,exports){function VectorTileFeature(e,t,r,a,i){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=a,this._values=i,e.readFields(readFeature,this,t)}function readFeature(e,t,r){1==e?t.id=r.readVarint():2==e?function readTag(e,t){for(var r=e.readVarint()+e.pos;e.pos<r;){var a=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[a]=i}}(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}function signedArea(e){for(var t,r,a=0,i=0,o=e.length,n=o-1;i<o;n=i++)t=e[i],a+=((r=e[n]).x-t.x)*(t.y+r.y);return a}var Point=_dereq_("@mapbox/point-geometry");module.exports=VectorTileFeature,VectorTileFeature.types=["Unknown","Point","LineString","Polygon"],VectorTileFeature.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,a=1,i=0,o=0,n=0,s=[];e.pos<r;){if(!i){var p=e.readVarint();a=7&p,i=p>>3}if(i--,1===a||2===a)o+=e.readSVarint(),n+=e.readSVarint(),1===a&&(t&&s.push(t),t=[]),t.push(new Point(o,n));else{if(7!==a)throw new Error("unknown command "+a);t&&t.push(t[0].clone())}}return t&&s.push(t),s},VectorTileFeature.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,a=0,i=0,o=0,n=1/0,s=-1/0,p=1/0,h=-1/0;e.pos<t;){if(!a){var u=e.readVarint();r=7&u,a=u>>3}if(a--,1===r||2===r)i+=e.readSVarint(),o+=e.readSVarint(),i<n&&(n=i),i>s&&(s=i),o<p&&(p=o),o>h&&(h=o);else if(7!==r)throw new Error("unknown command "+r)}return[n,p,s,h]},VectorTileFeature.prototype.toGeoJSON=function(e,t,r){function a(e){for(var t=0;t<e.length;t++){var r=e[t],a=180-360*(r.y+p)/n;e[t]=[360*(r.x+s)/n-180,360/Math.PI*Math.atan(Math.exp(a*Math.PI/180))-90]}}var i,o,n=this.extent*Math.pow(2,r),s=this.extent*e,p=this.extent*t,h=this.loadGeometry(),u=VectorTileFeature.types[this.type];switch(this.type){case 1:var d=[];for(i=0;i<h.length;i++)d[i]=h[i][0];a(h=d);break;case 2:for(i=0;i<h.length;i++)a(h[i]);break;case 3:for(h=function classifyRings(e){var t=e.length;if(t<=1)return[e];for(var r,a,i=[],o=0;o<t;o++){var n=signedArea(e[o]);0!==n&&(void 0===a&&(a=n<0),a===n<0?(r&&i.push(r),r=[e[o]]):r.push(e[o]))}return r&&i.push(r),i}(h),i=0;i<h.length;i++)for(o=0;o<h[i].length;o++)a(h[i][o])}1===h.length?h=h[0]:u="Multi"+u;var f={type:"Feature",geometry:{type:u,coordinates:h},properties:this.properties};return"id"in this&&(f.id=this.id),f}},{"@mapbox/point-geometry":4}],11:[function(_dereq_,module,exports){function VectorTileLayer(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(readLayer,this,t),this.length=this._features.length}function readLayer(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function readValueMessage(e){for(var t=null,r=e.readVarint()+e.pos;e.pos<r;){var a=e.readVarint()>>3;t=1===a?e.readString():2===a?e.readFloat():3===a?e.readDouble():4===a?e.readVarint64():5===a?e.readVarint():6===a?e.readSVarint():7===a?e.readBoolean():null}return t}(r))}var VectorTileFeature=_dereq_("./vectortilefeature.js");module.exports=VectorTileLayer,VectorTileLayer.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new VectorTileFeature(this._pbf,t,this.extent,this._keys,this._values)}},{"./vectortilefeature.js":10}],12:[function(_dereq_,module,exports){var e;e=this,function(e){function o(e,t,o){var n=r(256*e,256*(t=Math.pow(2,o)-t-1),o),i=r(256*(e+1),256*(t+1),o);return n[0]+","+n[1]+","+i[0]+","+i[1]}function r(e,t,o){var r=2*Math.PI*6378137/256/Math.pow(2,o);return[e*r-2*Math.PI*6378137/2,t*r-2*Math.PI*6378137/2]}e.getURL=function t(e,t,r,n,i,s){return s=s||{},e+"?"+["bbox="+o(r,n,i),"format="+(s.format||"image/png"),"service="+(s.service||"WMS"),"version="+(s.version||"1.1.1"),"request="+(s.request||"GetMap"),"srs="+(s.srs||"EPSG:3857"),"width="+(s.width||256),"height="+(s.height||256),"layers="+t].join("&")},e.getTileBBox=o,e.getMercCoords=r,Object.defineProperty(e,"__esModule",{value:!0})}("object"==typeof exports&&void 0!==module?exports:e.WhooTS=e.WhooTS||{})},{}],13:[function(_dereq_,module,exports){function clamp_css_byte(e){return(e=Math.round(e))<0?0:e>255?255:e}function parse_css_int(e){return clamp_css_byte("%"===e[e.length-1]?parseFloat(e)/100*255:parseInt(e))}function parse_css_float(e){return function clamp_css_float(e){return e<0?0:e>1?1:e}("%"===e[e.length-1]?parseFloat(e)/100:parseFloat(e))}function css_hue_to_rgb(e,r,l){return l<0?l+=1:l>1&&(l-=1),6*l<1?e+(r-e)*l*6:2*l<1?r:3*l<2?e+(r-e)*(2/3-l)*6:e}var kCSSColorTable={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};try{exports.parseCSSColor=function parseCSSColor(e){var l,r=e.replace(/ /g,"").toLowerCase();if(r in kCSSColorTable)return kCSSColorTable[r].slice();if("#"===r[0])return 4===r.length?(l=parseInt(r.substr(1),16))>=0&&l<=4095?[(3840&l)>>4|(3840&l)>>8,240&l|(240&l)>>4,15&l|(15&l)<<4,1]:null:7===r.length&&(l=parseInt(r.substr(1),16))>=0&&l<=16777215?[(16711680&l)>>16,(65280&l)>>8,255&l,1]:null;var a=r.indexOf("("),t=r.indexOf(")");if(-1!==a&&t+1===r.length){var n=r.substr(0,a),s=r.substr(a+1,t-(a+1)).split(","),o=1;switch(n){case"rgba":if(4!==s.length)return null;o=parse_css_float(s.pop());case"rgb":return 3!==s.length?null:[parse_css_int(s[0]),parse_css_int(s[1]),parse_css_int(s[2]),o];case"hsla":if(4!==s.length)return null;o=parse_css_float(s.pop());case"hsl":if(3!==s.length)return null;var i=(parseFloat(s[0])%360+360)%360/360,u=parse_css_float(s[1]),g=parse_css_float(s[2]),d=g<=.5?g*(u+1):g+u-g*u,c=2*g-d;return[clamp_css_byte(255*css_hue_to_rgb(c,d,i+1/3)),clamp_css_byte(255*css_hue_to_rgb(c,d,i)),clamp_css_byte(255*css_hue_to_rgb(c,d,i-1/3)),o];default:return null}}return null}}catch(e){}},{}],14:[function(_dereq_,module,exports){function earcut(e,n,r){r=r||2;var o,l,u,s,v,f,y,t=n&&n.length,i=t?n[0]*r:e.length,x=linkedList(e,0,i,r,!0),a=[];if(!x)return a;if(t&&(x=function eliminateHoles(e,n,r,t){var i,x,a,o,l,u=[];for(i=0,x=n.length;i<x;i++)a=n[i]*t,o=i<x-1?n[i+1]*t:e.length,(l=linkedList(e,a,o,t,!1))===l.next&&(l.steiner=!0),u.push(getLeftmost(l));for(u.sort(compareX),i=0;i<u.length;i++)eliminateHole(u[i],r),r=filterPoints(r,r.next);return r}(e,n,x,r)),e.length>80*r){o=u=e[0],l=s=e[1];for(var p=r;p<i;p+=r)v=e[p],f=e[p+1],v<o&&(o=v),f<l&&(l=f),v>u&&(u=v),f>s&&(s=f);y=0!==(y=Math.max(u-o,s-l))?1/y:0}return earcutLinked(x,a,r,o,l,y),a}function linkedList(e,n,r,t,i){var x,a;if(i===signedArea(e,n,r,t)>0)for(x=n;x<r;x+=t)a=insertNode(x,e[x],e[x+1],a);else for(x=r-t;x>=n;x-=t)a=insertNode(x,e[x],e[x+1],a);return a&&equals(a,a.next)&&(removeNode(a),a=a.next),a}function filterPoints(e,n){if(!e)return e;n||(n=e);var r,t=e;do{if(r=!1,t.steiner||!equals(t,t.next)&&0!==area(t.prev,t,t.next))t=t.next;else{if(removeNode(t),(t=n=t.prev)===t.next)break;r=!0}}while(r||t!==n);return n}function earcutLinked(e,n,r,t,i,x,a){if(e){!a&&x&&function indexCurve(e,n,r,t){var i=e;do{null===i.z&&(i.z=zOrder(i.x,i.y,n,r,t)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function sortLinked(e){var n,r,t,i,x,a,o,l,u=1;do{for(r=e,e=null,x=null,a=0;r;){for(a++,t=r,o=0,n=0;n<u&&(o++,t=t.nextZ);n++);for(l=u;o>0||l>0&&t;)0!==o&&(0===l||!t||r.z<=t.z)?(i=r,r=r.nextZ,o--):(i=t,t=t.nextZ,l--),x?x.nextZ=i:e=i,i.prevZ=x,x=i;r=t}x.nextZ=null,u*=2}while(a>1);return e}(i)}(e,t,i,x);for(var o,l,u=e;e.prev!==e.next;)if(o=e.prev,l=e.next,x?isEarHashed(e,t,i,x):isEar(e))n.push(o.i/r),n.push(e.i/r),n.push(l.i/r),removeNode(e),e=l.next,u=l.next;else if((e=l)===u){a?1===a?earcutLinked(e=cureLocalIntersections(e,n,r),n,r,t,i,x,2):2===a&&splitEarcut(e,n,r,t,i,x):earcutLinked(filterPoints(e),n,r,t,i,x,1);break}}}function isEar(e){var n=e.prev,r=e,t=e.next;if(area(n,r,t)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(pointInTriangle(n.x,n.y,r.x,r.y,t.x,t.y,i.x,i.y)&&area(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function isEarHashed(e,n,r,t){var i=e.prev,x=e,a=e.next;if(area(i,x,a)>=0)return!1;for(var o=i.x<x.x?i.x<a.x?i.x:a.x:x.x<a.x?x.x:a.x,l=i.y<x.y?i.y<a.y?i.y:a.y:x.y<a.y?x.y:a.y,u=i.x>x.x?i.x>a.x?i.x:a.x:x.x>a.x?x.x:a.x,s=i.y>x.y?i.y>a.y?i.y:a.y:x.y>a.y?x.y:a.y,v=zOrder(o,l,n,r,t),f=zOrder(u,s,n,r,t),y=e.prevZ,p=e.nextZ;y&&y.z>=v&&p&&p.z<=f;){if(y!==e.prev&&y!==e.next&&pointInTriangle(i.x,i.y,x.x,x.y,a.x,a.y,y.x,y.y)&&area(y.prev,y,y.next)>=0)return!1;if(y=y.prevZ,p!==e.prev&&p!==e.next&&pointInTriangle(i.x,i.y,x.x,x.y,a.x,a.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;y&&y.z>=v;){if(y!==e.prev&&y!==e.next&&pointInTriangle(i.x,i.y,x.x,x.y,a.x,a.y,y.x,y.y)&&area(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;p&&p.z<=f;){if(p!==e.prev&&p!==e.next&&pointInTriangle(i.x,i.y,x.x,x.y,a.x,a.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function cureLocalIntersections(e,n,r){var t=e;do{var i=t.prev,x=t.next.next;!equals(i,x)&&intersects(i,t,t.next,x)&&locallyInside(i,x)&&locallyInside(x,i)&&(n.push(i.i/r),n.push(t.i/r),n.push(x.i/r),removeNode(t),removeNode(t.next),t=e=x),t=t.next}while(t!==e);return t}function splitEarcut(e,n,r,t,i,x){var a=e;do{for(var o=a.next.next;o!==a.prev;){if(a.i!==o.i&&isValidDiagonal(a,o)){var l=splitPolygon(a,o);return a=filterPoints(a,a.next),l=filterPoints(l,l.next),earcutLinked(a,n,r,t,i,x),void earcutLinked(l,n,r,t,i,x)}o=o.next}a=a.next}while(a!==e)}function compareX(e,n){return e.x-n.x}function eliminateHole(e,n){if(n=function findHoleBridge(e,n){var r,t=n,i=e.x,x=e.y,a=-1/0;do{if(x<=t.y&&x>=t.next.y&&t.next.y!==t.y){var o=t.x+(x-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(o<=i&&o>a){if(a=o,o===i){if(x===t.y)return t;if(x===t.next.y)return t.next}r=t.x<t.next.x?t:t.next}}t=t.next}while(t!==n);if(!r)return null;if(i===a)return r.prev;var l,u=r,s=r.x,v=r.y,f=1/0;for(t=r.next;t!==u;)i>=t.x&&t.x>=s&&i!==t.x&&pointInTriangle(x<v?i:a,x,s,v,x<v?a:i,x,t.x,t.y)&&((l=Math.abs(x-t.y)/(i-t.x))<f||l===f&&t.x>r.x)&&locallyInside(t,e)&&(r=t,f=l),t=t.next;return r}(e,n)){var r=splitPolygon(n,e);filterPoints(r,r.next)}}function zOrder(e,n,r,t,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-t)*i)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function getLeftmost(e){var n=e,r=e;do{n.x<r.x&&(r=n),n=n.next}while(n!==e);return r}function pointInTriangle(e,n,r,t,i,x,a,o){return(i-a)*(n-o)-(e-a)*(x-o)>=0&&(e-a)*(t-o)-(r-a)*(n-o)>=0&&(r-a)*(x-o)-(i-a)*(t-o)>=0}function isValidDiagonal(e,n){return e.next.i!==n.i&&e.prev.i!==n.i&&!function intersectsPolygon(e,n){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==n.i&&r.next.i!==n.i&&intersects(r,r.next,e,n))return!0;r=r.next}while(r!==e);return!1}(e,n)&&locallyInside(e,n)&&locallyInside(n,e)&&function middleInside(e,n){var r=e,t=!1,i=(e.x+n.x)/2,x=(e.y+n.y)/2;do{r.y>x!=r.next.y>x&&r.next.y!==r.y&&i<(r.next.x-r.x)*(x-r.y)/(r.next.y-r.y)+r.x&&(t=!t),r=r.next}while(r!==e);return t}(e,n)}function area(e,n,r){return(n.y-e.y)*(r.x-n.x)-(n.x-e.x)*(r.y-n.y)}function equals(e,n){return e.x===n.x&&e.y===n.y}function intersects(e,n,r,t){return!!(equals(e,n)&&equals(r,t)||equals(e,t)&&equals(r,n))||area(e,n,r)>0!=area(e,n,t)>0&&area(r,t,e)>0!=area(r,t,n)>0}function locallyInside(e,n){return area(e.prev,e,e.next)<0?area(e,n,e.next)>=0&&area(e,e.prev,n)>=0:area(e,n,e.prev)<0||area(e,e.next,n)<0}function splitPolygon(e,n){var r=new Node(e.i,e.x,e.y),t=new Node(n.i,n.x,n.y),i=e.next,x=n.prev;return e.next=n,n.prev=e,r.next=i,i.prev=r,t.next=r,r.prev=t,x.next=t,t.prev=x,t}function insertNode(e,n,r,t){var i=new Node(e,n,r);return t?(i.next=t.next,i.prev=t,t.next.prev=i,t.next=i):(i.prev=i,i.next=i),i}function removeNode(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Node(e,n,r){this.i=e,this.x=n,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(e,n,r,t){for(var i=0,x=n,a=r-t;x<r;x+=t)i+=(e[a]-e[x])*(e[x+1]+e[a+1]),a=x;return i}module.exports=earcut,module.exports.default=earcut,earcut.deviation=function(e,n,r,t){var i=n&&n.length,x=i?n[0]*r:e.length,a=Math.abs(signedArea(e,0,x,r));if(i)for(var o=0,l=n.length;o<l;o++){var u=n[o]*r,s=o<l-1?n[o+1]*r:e.length;a-=Math.abs(signedArea(e,u,s,r))}var v=0;for(o=0;o<t.length;o+=3){var f=t[o]*r,y=t[o+1]*r,p=t[o+2]*r;v+=Math.abs((e[f]-e[p])*(e[y+1]-e[f+1])-(e[f]-e[y])*(e[p+1]-e[f+1]))}return 0===a&&0===v?0:Math.abs((v-a)/a)},earcut.flatten=function(e){for(var n=e[0][0].length,r={vertices:[],holes:[],dimensions:n},t=0,i=0;i<e.length;i++){for(var x=0;x<e[i].length;x++)for(var a=0;a<n;a++)r.vertices.push(e[i][x][a]);i>0&&(t+=e[i-1].length,r.holes.push(t))}return r}},{}],15:[function(_dereq_,module,exports){function curryOuter(r,e){return function(n){return r(n,e)}}function correctRings(r,e){e=!!e,r[0]=wind(r[0],e);for(var n=1;n<r.length;n++)r[n]=wind(r[n],!e);return r}function wind(r,e){return function cw(r){return geojsonArea.ring(r)>=0}(r)===e?r:r.reverse()}var geojsonArea=_dereq_("@mapbox/geojson-area");module.exports=function rewind(r,e){switch(r&&r.type||null){case"FeatureCollection":return r.features=r.features.map(curryOuter(rewind,e)),r;case"Feature":return r.geometry=rewind(r.geometry,e),r;case"Polygon":case"MultiPolygon":return function correct(r,e){return"Polygon"===r.type?r.coordinates=correctRings(r.coordinates,e):"MultiPolygon"===r.type&&(r.coordinates=r.coordinates.map(curryOuter(correctRings,e))),r}(r,e);default:return r}}},{"@mapbox/geojson-area":1}],16:[function(_dereq_,module,exports){function clipPoints(i,n,e,t,l){for(var r=0;r<i.length;r+=3){var u=i[r+l];u>=e&&u<=t&&(n.push(i[r]),n.push(i[r+1]),n.push(i[r+2]))}}function clipLine(i,n,e,t,l,r){for(var u=[],s=0===l?intersectX:intersectY,o=0;o<i.length-3;o+=3){var h=i[o],p=i[o+1],c=i[o+2],a=i[o+3],g=i[o+4],f=0===l?h:p,P=0===l?a:g,L=!1;f<e?P>=e&&s(u,h,p,a,g,e):f>t?P<=t&&s(u,h,p,a,g,t):addPoint(u,h,p,c),P<e&&f>=e&&(s(u,h,p,a,g,e),L=!0),P>t&&f<=t&&(s(u,h,p,a,g,t),L=!0),!r&&L&&(u.size=i.size,n.push(u),u=[])}var v=i.length-3;h=i[v],p=i[v+1],c=i[v+2],(f=0===l?h:p)>=e&&f<=t&&addPoint(u,h,p,c),v=u.length-3,r&&v>=3&&(u[v]!==u[0]||u[v+1]!==u[1])&&addPoint(u,u[0],u[1],u[2]),u.length&&(u.size=i.size,n.push(u))}function clipLines(i,n,e,t,l,r){for(var u=0;u<i.length;u++)clipLine(i[u],n,e,t,l,r)}function addPoint(i,n,e,t){i.push(n),i.push(e),i.push(t)}function intersectX(i,n,e,t,l,r){i.push(r),i.push(e+(r-n)*(l-e)/(t-n)),i.push(1)}function intersectY(i,n,e,t,l,r){i.push(n+(r-e)*(t-n)/(l-e)),i.push(r),i.push(1)}module.exports=function clip(i,n,e,t,l,r,u){if(t/=n,r>=(e/=n)&&u<=t)return i;if(r>t||u<e)return null;for(var s=[],o=0;o<i.length;o++){var h=i[o],p=h.geometry,c=h.type,a=0===l?h.minX:h.minY,g=0===l?h.maxX:h.maxY;if(a>=e&&g<=t)s.push(h);else if(!(a>t||g<e)){var f=[];if("Point"===c||"MultiPoint"===c)clipPoints(p,f,e,t,l);else if("LineString"===c)clipLine(p,f,e,t,l,!1);else if("MultiLineString"===c)clipLines(p,f,e,t,l,!1);else if("Polygon"===c)clipLines(p,f,e,t,l,!0);else if("MultiPolygon"===c)for(var P=0;P<p.length;P++){var L=[];clipLines(p[P],L,e,t,l,!0),L.length&&f.push(L)}f.length&&("LineString"!==c&&"MultiLineString"!==c||(1===f.length?(c="LineString",f=f[0]):c="MultiLineString"),"Point"!==c&&"MultiPoint"!==c||(c=3===f.length?"Point":"MultiPoint"),s.push(createFeature(h.id,c,f,h.tags)))}}return s.length?s:null};var createFeature=_dereq_("./feature")},{"./feature":18}],17:[function(_dereq_,module,exports){function convertFeature(e,t,r){if(t.geometry){var o=t.geometry.coordinates,n=t.geometry.type,i=r*r,a=[];if("Point"===n)convertPoint(o,a);else if("MultiPoint"===n)for(var u=0;u<o.length;u++)convertPoint(o[u],a);else if("LineString"===n)convertLine(o,a,i,!1);else if("MultiLineString"===n)convertLines(o,a,i,!1);else if("Polygon"===n)convertLines(o,a,i,!0);else{if("MultiPolygon"!==n){if("GeometryCollection"===n){for(u=0;u<t.geometry.geometries.length;u++)convertFeature(e,{geometry:t.geometry.geometries[u],properties:t.properties},r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(u=0;u<o.length;u++){var s=[];convertLines(o[u],s,i,!0),a.push(s)}}e.push(createFeature(t.id,n,a,t.properties))}}function convertPoint(e,t){t.push(projectX(e[0])),t.push(projectY(e[1])),t.push(0)}function convertLine(e,t,r,o){for(var n,i,a=0,u=0;u<e.length;u++){var s=projectX(e[u][0]),c=projectY(e[u][1]);t.push(s),t.push(c),t.push(0),u>0&&(a+=o?(n*c-s*i)/2:Math.sqrt(Math.pow(s-n,2)+Math.pow(c-i,2))),n=s,i=c}var p=t.length-3;t[2]=1,simplify(t,0,p,r),t[p+2]=1,t.size=Math.abs(a)}function convertLines(e,t,r,o){for(var n=0;n<e.length;n++){var i=[];convertLine(e[n],i,r,o),t.push(i)}}function projectX(e){return e/360+.5}function projectY(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}module.exports=function convert(e,t){var r=[];if("FeatureCollection"===e.type)for(var o=0;o<e.features.length;o++)convertFeature(r,e.features[o],t);else"Feature"===e.type?convertFeature(r,e,t):convertFeature(r,{geometry:e},t);return r};var simplify=_dereq_("./simplify"),createFeature=_dereq_("./feature")},{"./feature":18,"./simplify":20}],18:[function(_dereq_,module,exports){function calcLineBBox(e,n){for(var t=0;t<n.length;t+=3)e.minX=Math.min(e.minX,n[t]),e.minY=Math.min(e.minY,n[t+1]),e.maxX=Math.max(e.maxX,n[t]),e.maxY=Math.max(e.maxY,n[t+1])}module.exports=function createFeature(e,n,t,i){var a={id:e||null,type:n,geometry:t,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function calcBBox(e){var n=e.geometry,t=e.type;if("Point"===t||"MultiPoint"===t||"LineString"===t)calcLineBBox(e,n);else if("Polygon"===t||"MultiLineString"===t)for(var i=0;i<n.length;i++)calcLineBBox(e,n[i]);else if("MultiPolygon"===t)for(i=0;i<n.length;i++)for(var a=0;a<n[i].length;a++)calcLineBBox(e,n[i][a])}(a),a}},{}],19:[function(_dereq_,module,exports){function GeoJSONVT(e,t){var o=(t=this.options=function extend(e,t){for(var o in t)e[o]=t[o];return e}(Object.create(this.options),t)).debug;if(o&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");var i=1<<t.maxZoom,n=convert(e,t.tolerance/(i*t.extent));this.tiles={},this.tileCoords=[],o&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(n=wrap(n,t.buffer/t.extent)).length&&this.splitTile(n,0,0,0),o&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function toID(e,t,o){return 32*((1<<e)*o+t)+e}module.exports=function geojsonvt(e,t){return new GeoJSONVT(e,t)};var convert=_dereq_("./convert"),transform=_dereq_("./transform"),clip=_dereq_("./clip"),wrap=_dereq_("./wrap"),createTile=_dereq_("./tile");GeoJSONVT.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,debug:0},GeoJSONVT.prototype.splitTile=function(e,t,o,i,n,s,l){for(var r=[e,t,o,i],a=this.options,u=a.debug;r.length;){i=r.pop(),o=r.pop(),t=r.pop(),e=r.pop();var m=1<<t,c=toID(t,o,i),p=this.tiles[c],d=t===a.maxZoom?0:a.tolerance/(m*a.extent);if(!p&&(u>1&&console.time("creation"),p=this.tiles[c]=createTile(e,m,o,i,d,t===a.maxZoom),this.tileCoords.push({z:t,x:o,y:i}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,o,i,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));var h="z"+t;this.stats[h]=(this.stats[h]||0)+1,this.total++}if(p.source=e,n){if(t===a.maxZoom||t===n)continue;var x=1<<n-t;if(o!==Math.floor(s/x)||i!==Math.floor(l/x))continue}else if(t===a.indexMaxZoom||p.numPoints<=a.indexMaxPoints)continue;if(p.source=null,0!==e.length){u>1&&console.time("clipping");var f,g,v,Z,T,M,b=.5*a.buffer/a.extent,w=.5-b,Y=.5+b,O=1+b;f=g=v=Z=null,T=clip(e,m,o-b,o+Y,0,p.minX,p.maxX),M=clip(e,m,o+w,o+O,0,p.minX,p.maxX),e=null,T&&(f=clip(T,m,i-b,i+Y,1,p.minY,p.maxY),g=clip(T,m,i+w,i+O,1,p.minY,p.maxY),T=null),M&&(v=clip(M,m,i-b,i+Y,1,p.minY,p.maxY),Z=clip(M,m,i+w,i+O,1,p.minY,p.maxY),M=null),u>1&&console.timeEnd("clipping"),r.push(f||[],t+1,2*o,2*i),r.push(g||[],t+1,2*o,2*i+1),r.push(v||[],t+1,2*o+1,2*i),r.push(Z||[],t+1,2*o+1,2*i+1)}}},GeoJSONVT.prototype.getTile=function(e,t,o){var i=this.options,n=i.extent,s=i.debug;if(e<0||e>24)return null;var l=1<<e,r=toID(e,t=(t%l+l)%l,o);if(this.tiles[r])return transform.tile(this.tiles[r],n);s>1&&console.log("drilling down to z%d-%d-%d",e,t,o);for(var a,u=e,m=t,c=o;!a&&u>0;)u--,m=Math.floor(m/2),c=Math.floor(c/2),a=this.tiles[toID(u,m,c)];return a&&a.source?(s>1&&console.log("found parent tile z%d-%d-%d",u,m,c),s>1&&console.time("drilling down"),this.splitTile(a.source,u,m,c,e,t,o),s>1&&console.timeEnd("drilling down"),this.tiles[r]?transform.tile(this.tiles[r],n):null):null}},{"./clip":16,"./convert":17,"./tile":21,"./transform":22,"./wrap":23}],20:[function(_dereq_,module,exports){function getSqSegDist(i,t,r,s,e,f){var l=e-r,m=f-s;if(0!==l||0!==m){var n=((i-r)*l+(t-s)*m)/(l*l+m*m);n>1?(r=e,s=f):n>0&&(r+=l*n,s+=m*n)}return(l=i-r)*l+(m=t-s)*m}module.exports=function simplify(i,t,r,s){for(var e,f=s,l=i[t],m=i[t+1],n=i[r],o=i[r+1],p=t+3;p<r;p+=3){var u=getSqSegDist(i[p],i[p+1],l,m,n,o);u>f&&(e=p,f=u)}f>s&&(e-t>3&&simplify(i,t,e,s),i[e+2]=f,r-e>3&&simplify(i,e,r,s))}},{}],21:[function(_dereq_,module,exports){function addFeature(n,e,i,t){var r=e.geometry,u=e.type,a=[];if("Point"===u||"MultiPoint"===u)for(var l=0;l<r.length;l+=3)a.push(r[l]),a.push(r[l+1]),n.numPoints++,n.numSimplified++;else if("LineString"===u)addLine(a,r,n,i,t,!1,!1);else if("MultiLineString"===u||"Polygon"===u)for(l=0;l<r.length;l++)addLine(a,r[l],n,i,t,"Polygon"===u,0===l);else if("MultiPolygon"===u)for(var o=0;o<r.length;o++){var m=r[o];for(l=0;l<m.length;l++)addLine(a,m[l],n,i,t,!0,0===l)}if(a.length){var f={geometry:a,type:"Polygon"===u||"MultiPolygon"===u?3:"LineString"===u||"MultiLineString"===u?2:1,tags:e.tags||null};null!==e.id&&(f.id=e.id),n.features.push(f)}}function addLine(n,e,i,t,r,u,a){var l=t*t;if(!r&&e.size<(u?l:t))i.numPoints+=e.length/3;else{for(var o=[],m=0;m<e.length;m+=3)(r||e[m+2]>l)&&(i.numSimplified++,o.push(e[m]),o.push(e[m+1])),i.numPoints++;u&&function rewind(n,e){for(var i=0,t=0,r=n.length,u=r-2;t<r;u=t,t+=2)i+=(n[t]-n[u])*(n[t+1]+n[u+1]);if(i>0===e)for(t=0,r=n.length;t<r/2;t+=2){var a=n[t],l=n[t+1];n[t]=n[r-2-t],n[t+1]=n[r-1-t],n[r-2-t]=a,n[r-1-t]=l}}(o,a),n.push(o)}}module.exports=function createTile(n,e,i,t,r,u){for(var a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:i,y:t,z2:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},l=0;l<n.length;l++){a.numFeatures++,addFeature(a,n[l],r,u);var o=n[l].minX,m=n[l].minY,f=n[l].maxX,s=n[l].maxY;o<a.minX&&(a.minX=o),m<a.minY&&(a.minY=m),f>a.maxX&&(a.maxX=f),s>a.maxY&&(a.maxY=s)}return a}},{}],22:[function(_dereq_,module,exports){function transformPoint(r,t,e,o,n,f){return[Math.round(e*(r*o-n)),Math.round(e*(t*o-f))]}exports.tile=function transformTile(r,t){if(r.transformed)return r;var e,o,n,f=r.z2,s=r.x,a=r.y;for(e=0;e<r.features.length;e++){var i=r.features[e],u=i.geometry,m=i.type;if(i.geometry=[],1===m)for(o=0;o<u.length;o+=2)i.geometry.push(transformPoint(u[o],u[o+1],t,f,s,a));else for(o=0;o<u.length;o++){var h=[];for(n=0;n<u[o].length;n+=2)h.push(transformPoint(u[o][n],u[o][n+1],t,f,s,a));i.geometry.push(h)}}return r.transformed=!0,r},exports.point=transformPoint},{}],23:[function(_dereq_,module,exports){function shiftFeatureCoords(e,r){for(var t=[],o=0;o<e.length;o++){var i,s=e[o],n=s.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)i=shiftCoords(s.geometry,r);else if("MultiLineString"===n||"Polygon"===n){i=[];for(var u=0;u<s.geometry.length;u++)i.push(shiftCoords(s.geometry[u],r))}else if("MultiPolygon"===n)for(i=[],u=0;u<s.geometry.length;u++){for(var a=[],f=0;f<s.geometry[u].length;f++)a.push(shiftCoords(s.geometry[u][f],r));i.push(a)}t.push(createFeature(s.id,n,i,s.tags))}return t}function shiftCoords(e,r){var t=[];t.size=e.size;for(var o=0;o<e.length;o+=3)t.push(e[o]+r,e[o+1],e[o+2]);return t}var clip=_dereq_("./clip"),createFeature=_dereq_("./feature");module.exports=function wrap(e,r){var t=e,o=clip(e,1,-1-r,r,0,-1,2),i=clip(e,1,1-r,2+r,0,-1,2);return(o||i)&&(t=clip(e,1,-r,1+r,0,-1,2)||[],o&&(t=shiftFeatureCoords(o,1).concat(t)),i&&(t=t.concat(shiftFeatureCoords(i,-1)))),t}},{"./clip":16,"./feature":18}],24:[function(_dereq_,module,exports){function GridIndex(t,r,e){var s=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var i=new Int32Array(this.arrayBuffer);t=i[0],r=i[1],e=i[2],this.d=r+2*e;for(var h=0;h<this.d*this.d;h++){var n=i[NUM_PARAMS+h],o=i[NUM_PARAMS+h+1];s.push(n===o?null:i.subarray(n,o))}var l=i[NUM_PARAMS+s.length],a=i[NUM_PARAMS+s.length+1];this.keys=i.subarray(l,a),this.bboxes=i.subarray(a),this.insert=this._insertReadonly}else{this.d=r+2*e;for(var d=0;d<this.d*this.d;d++)s.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=t,this.padding=e,this.scale=r/t,this.uid=0;var f=e/r*t;this.min=-f,this.max=t+f}module.exports=GridIndex;var NUM_PARAMS=3;GridIndex.prototype.insert=function(t,r,e,s,i){this._forEachCell(r,e,s,i,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(r),this.bboxes.push(e),this.bboxes.push(s),this.bboxes.push(i)},GridIndex.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},GridIndex.prototype._insertCell=function(t,r,e,s,i,h){this.cells[i].push(h)},GridIndex.prototype.query=function(t,r,e,s){var i=this.min,h=this.max;if(t<=i&&r<=i&&h<=e&&h<=s)return Array.prototype.slice.call(this.keys);var n=[];return this._forEachCell(t,r,e,s,this._queryCell,n,{}),n},GridIndex.prototype._queryCell=function(t,r,e,s,i,h,n){var o=this.cells[i];if(null!==o)for(var l=this.keys,a=this.bboxes,d=0;d<o.length;d++){var f=o[d];if(void 0===n[f]){var u=4*f;t<=a[u+2]&&r<=a[u+3]&&e>=a[u+0]&&s>=a[u+1]?(n[f]=!0,h.push(l[f])):n[f]=!1}}},GridIndex.prototype._forEachCell=function(t,r,e,s,i,h,n){for(var o=this._convertToCellCoord(t),l=this._convertToCellCoord(r),a=this._convertToCellCoord(e),d=this._convertToCellCoord(s),f=o;f<=a;f++)for(var u=l;u<=d;u++){var y=this.d*u+f;if(i.call(this,t,r,e,s,y,h,n))return}},GridIndex.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},GridIndex.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,r=NUM_PARAMS+this.cells.length+1+1,e=0,s=0;s<this.cells.length;s++)e+=this.cells[s].length;var i=new Int32Array(r+e+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;for(var h=r,n=0;n<t.length;n++){var o=t[n];i[NUM_PARAMS+n]=h,i.set(o,h),h+=o.length}return i[NUM_PARAMS+t.length]=h,i.set(this.keys,h),h+=this.keys.length,i[NUM_PARAMS+t.length+1]=h,i.set(this.bboxes,h),h+=this.bboxes.length,i.buffer}},{}],25:[function(_dereq_,module,exports){exports.read=function(a,o,t,r,h){var M,p,w=8*h-r-1,f=(1<<w)-1,e=f>>1,i=-7,N=t?h-1:0,n=t?-1:1,s=a[o+N];for(N+=n,M=s&(1<<-i)-1,s>>=-i,i+=w;i>0;M=256*M+a[o+N],N+=n,i-=8);for(p=M&(1<<-i)-1,M>>=-i,i+=r;i>0;p=256*p+a[o+N],N+=n,i-=8);if(0===M)M=1-e;else{if(M===f)return p?NaN:1/0*(s?-1:1);p+=Math.pow(2,r),M-=e}return(s?-1:1)*p*Math.pow(2,M-r)},exports.write=function(a,o,t,r,h,M){var p,w,f,e=8*M-h-1,i=(1<<e)-1,N=i>>1,n=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,s=r?0:M-1,u=r?1:-1,l=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(w=isNaN(o)?1:0,p=i):(p=Math.floor(Math.log(o)/Math.LN2),o*(f=Math.pow(2,-p))<1&&(p--,f*=2),(o+=p+N>=1?n/f:n*Math.pow(2,1-N))*f>=2&&(p++,f/=2),p+N>=i?(w=0,p=i):p+N>=1?(w=(o*f-1)*Math.pow(2,h),p+=N):(w=o*Math.pow(2,N-1)*Math.pow(2,h),p=0));h>=8;a[t+s]=255&w,s+=u,w/=256,h-=8);for(p=p<<h|w,e+=h;e>0;a[t+s]=255&p,s+=u,p/=256,e-=8);a[t+s-u]|=128*l}},{}],26:[function(_dereq_,module,exports){function KDBush(t,i,e,s,n){i=i||defaultGetX,e=e||defaultGetY,n=n||Array,this.nodeSize=s||64,this.points=t,this.ids=new n(t.length),this.coords=new n(2*t.length);for(var r=0;r<t.length;r++)this.ids[r]=r,this.coords[2*r]=i(t[r]),this.coords[2*r+1]=e(t[r]);sort(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function defaultGetX(t){return t[0]}function defaultGetY(t){return t[1]}var sort=_dereq_("./sort"),range=_dereq_("./range"),within=_dereq_("./within");module.exports=function kdbush(t,i,e,s,n){return new KDBush(t,i,e,s,n)},KDBush.prototype={range:function(t,i,e,s){return range(this.ids,this.coords,t,i,e,s,this.nodeSize)},within:function(t,i,e){return within(this.ids,this.coords,t,i,e,this.nodeSize)}}},{"./range":27,"./sort":28,"./within":29}],27:[function(_dereq_,module,exports){module.exports=function range(p,r,s,u,h,e,o){for(var a,t,n=[0,p.length-1,0],f=[];n.length;){var l=n.pop(),v=n.pop(),g=n.pop();if(v-g<=o)for(var i=g;i<=v;i++)a=r[2*i],t=r[2*i+1],a>=s&&a<=h&&t>=u&&t<=e&&f.push(p[i]);else{var c=Math.floor((g+v)/2);a=r[2*c],t=r[2*c+1],a>=s&&a<=h&&t>=u&&t<=e&&f.push(p[c]);var d=(l+1)%2;(0===l?s<=a:u<=t)&&(n.push(g),n.push(c-1),n.push(d)),(0===l?h>=a:e>=t)&&(n.push(c+1),n.push(v),n.push(d))}}return f}},{}],28:[function(_dereq_,module,exports){function swapItem(t,a,o,s){swap(t,o,s),swap(a,2*o,2*s),swap(a,2*o+1,2*s+1)}function swap(t,a,o){var s=t[a];t[a]=t[o],t[o]=s}module.exports=function sortKD(t,a,o,s,r,e){if(!(r-s<=o)){var f=Math.floor((s+r)/2);(function select(t,a,o,s,r,e){for(;r>s;){if(r-s>600){var f=r-s+1,p=o-s+1,w=Math.log(f),m=.5*Math.exp(2*w/3),n=.5*Math.sqrt(w*m*(f-m)/f)*(p-f/2<0?-1:1);select(t,a,o,Math.max(s,Math.floor(o-p*m/f+n)),Math.min(r,Math.floor(o+(f-p)*m/f+n)),e)}var c=a[2*o+e],h=s,i=r;for(swapItem(t,a,s,o),a[2*r+e]>c&&swapItem(t,a,s,r);h<i;){for(swapItem(t,a,h,i),h++,i--;a[2*h+e]<c;)h++;for(;a[2*i+e]>c;)i--}a[2*s+e]===c?swapItem(t,a,s,i):swapItem(t,a,++i,r),i<=o&&(s=i+1),o<=i&&(r=i-1)}})(t,a,f,s,r,e%2),sortKD(t,a,o,s,f-1,e+1),sortKD(t,a,o,f+1,r,e+1)}}},{}],29:[function(_dereq_,module,exports){function sqDist(s,p,r,t){var u=s-r,h=p-t;return u*u+h*h}module.exports=function within(s,p,r,t,u,h){for(var i=[0,s.length-1,0],o=[],n=u*u;i.length;){var e=i.pop(),a=i.pop(),f=i.pop();if(a-f<=h)for(var v=f;v<=a;v++)sqDist(p[2*v],p[2*v+1],r,t)<=n&&o.push(s[v]);else{var l=Math.floor((f+a)/2),c=p[2*l],q=p[2*l+1];sqDist(c,q,r,t)<=n&&o.push(s[l]);var D=(e+1)%2;(0===e?r-u<=c:t-u<=q)&&(i.push(f),i.push(l-1),i.push(D)),(0===e?r+u>=c:t+u>=q)&&(i.push(l+1),i.push(a),i.push(D))}}return o}},{}],30:[function(_dereq_,module,exports){function Pbf(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}function readPackedEnd(t){return t.type===Pbf.Bytes?t.readVarint()+t.pos:t.pos+1}function toNum(t,i,e){return e?4294967296*i+(t>>>0):4294967296*(i>>>0)+(t>>>0)}function makeRoomForExtraLength(t,i,e){var r=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.ceil(Math.log(i)/(7*Math.LN2));e.realloc(r);for(var s=e.pos-1;s>=t;s--)e.buf[s+r]=e.buf[s]}function writePackedVarint(t,i){for(var e=0;e<t.length;e++)i.writeVarint(t[e])}function writePackedSVarint(t,i){for(var e=0;e<t.length;e++)i.writeSVarint(t[e])}function writePackedFloat(t,i){for(var e=0;e<t.length;e++)i.writeFloat(t[e])}function writePackedDouble(t,i){for(var e=0;e<t.length;e++)i.writeDouble(t[e])}function writePackedBoolean(t,i){for(var e=0;e<t.length;e++)i.writeBoolean(t[e])}function writePackedFixed32(t,i){for(var e=0;e<t.length;e++)i.writeFixed32(t[e])}function writePackedSFixed32(t,i){for(var e=0;e<t.length;e++)i.writeSFixed32(t[e])}function writePackedFixed64(t,i){for(var e=0;e<t.length;e++)i.writeFixed64(t[e])}function writePackedSFixed64(t,i){for(var e=0;e<t.length;e++)i.writeSFixed64(t[e])}function readUInt32(t,i){return(t[i]|t[i+1]<<8|t[i+2]<<16)+16777216*t[i+3]}function writeInt32(t,i,e){t[e]=i,t[e+1]=i>>>8,t[e+2]=i>>>16,t[e+3]=i>>>24}function readInt32(t,i){return(t[i]|t[i+1]<<8|t[i+2]<<16)+(t[i+3]<<24)}module.exports=Pbf;var ieee754=_dereq_("ieee754");Pbf.Varint=0,Pbf.Fixed64=1,Pbf.Bytes=2,Pbf.Fixed32=5;Pbf.prototype={destroy:function(){this.buf=null},readFields:function(t,i,e){for(e=e||this.length;this.pos<e;){var r=this.readVarint(),s=r>>3,n=this.pos;this.type=7&r,t(s,i,this),this.pos===n&&this.skip(r)}return i},readMessage:function(t,i){return this.readFields(t,i,this.readVarint()+this.pos)},readFixed32:function(){var t=readUInt32(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=readInt32(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=readUInt32(this.buf,this.pos)+4294967296*readUInt32(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=readUInt32(this.buf,this.pos)+4294967296*readInt32(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=ieee754.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=ieee754.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var i,e,r=this.buf;return i=127&(e=r[this.pos++]),e<128?i:(i|=(127&(e=r[this.pos++]))<<7,e<128?i:(i|=(127&(e=r[this.pos++]))<<14,e<128?i:(i|=(127&(e=r[this.pos++]))<<21,e<128?i:function readVarintRemainder(t,i,e){var r,s,n=e.buf;if(r=(112&(s=n[e.pos++]))>>4,s<128)return toNum(t,r,i);if(r|=(127&(s=n[e.pos++]))<<3,s<128)return toNum(t,r,i);if(r|=(127&(s=n[e.pos++]))<<10,s<128)return toNum(t,r,i);if(r|=(127&(s=n[e.pos++]))<<17,s<128)return toNum(t,r,i);if(r|=(127&(s=n[e.pos++]))<<24,s<128)return toNum(t,r,i);if(r|=(1&(s=n[e.pos++]))<<31,s<128)return toNum(t,r,i);throw new Error("Expected varint not more than 10 bytes")}(i|=(15&(e=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,i=function readUtf8(t,i,e){for(var r="",s=i;s<e;){var h,u,f,n=t[s],o=null,a=n>239?4:n>223?3:n>191?2:1;if(s+a>e)break;1===a?n<128&&(o=n):2===a?128==(192&(h=t[s+1]))&&(o=(31&n)<<6|63&h)<=127&&(o=null):3===a?(h=t[s+1],u=t[s+2],128==(192&h)&&128==(192&u)&&((o=(15&n)<<12|(63&h)<<6|63&u)<=2047||o>=55296&&o<=57343)&&(o=null)):4===a&&(h=t[s+1],u=t[s+2],f=t[s+3],128==(192&h)&&128==(192&u)&&128==(192&f)&&((o=(15&n)<<18|(63&h)<<12|(63&u)<<6|63&f)<=65535||o>=1114112)&&(o=null)),null===o?(o=65533,a=1):o>65535&&(o-=65536,r+=String.fromCharCode(o>>>10&1023|55296),o=56320|1023&o),r+=String.fromCharCode(o),s+=a}return r}(this.buf,this.pos,t);return this.pos=t,i},readBytes:function(){var t=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,t);return this.pos=t,i},readPackedVarint:function(t,i){var e=readPackedEnd(this);for(t=t||[];this.pos<e;)t.push(this.readVarint(i));return t},readPackedSVarint:function(t){var i=readPackedEnd(this);for(t=t||[];this.pos<i;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){var i=readPackedEnd(this);for(t=t||[];this.pos<i;)t.push(this.readBoolean());return t},readPackedFloat:function(t){var i=readPackedEnd(this);for(t=t||[];this.pos<i;)t.push(this.readFloat());return t},readPackedDouble:function(t){var i=readPackedEnd(this);for(t=t||[];this.pos<i;)t.push(this.readDouble());return t},readPackedFixed32:function(t){var i=readPackedEnd(this);for(t=t||[];this.pos<i;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){var i=readPackedEnd(this);for(t=t||[];this.pos<i;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){var i=readPackedEnd(this);for(t=t||[];this.pos<i;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){var i=readPackedEnd(this);for(t=t||[];this.pos<i;)t.push(this.readSFixed64());return t},skip:function(t){var i=7&t;if(i===Pbf.Varint)for(;this.buf[this.pos++]>127;);else if(i===Pbf.Bytes)this.pos=this.readVarint()+this.pos;else if(i===Pbf.Fixed32)this.pos+=4;else{if(i!==Pbf.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(t,i){this.writeVarint(t<<3|i)},realloc:function(t){for(var i=this.length||16;i<this.pos+t;)i*=2;if(i!==this.length){var e=new Uint8Array(i);e.set(this.buf),this.buf=e,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),writeInt32(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),writeInt32(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),writeInt32(this.buf,-1&t,this.pos),writeInt32(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),writeInt32(this.buf,-1&t,this.pos),writeInt32(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function writeBigVarint(t,i){var e,r;if(t>=0?(e=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(e=~(-t%4294967296))?e=e+1|0:(e=0,r=r+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function writeBigVarintLow(t,i,e){e.buf[e.pos++]=127&t|128,t>>>=7,e.buf[e.pos++]=127&t|128,t>>>=7,e.buf[e.pos++]=127&t|128,t>>>=7,e.buf[e.pos++]=127&t|128,t>>>=7,e.buf[e.pos]=127&t}(e,0,i),function writeBigVarintHigh(t,i){var e=(7&t)<<4;i.buf[i.pos++]|=e|((t>>>=3)?128:0),t&&(i.buf[i.pos++]=127&t|((t>>>=7)?128:0),t&&(i.buf[i.pos++]=127&t|((t>>>=7)?128:0),t&&(i.buf[i.pos++]=127&t|((t>>>=7)?128:0),t&&(i.buf[i.pos++]=127&t|((t>>>=7)?128:0),t&&(i.buf[i.pos++]=127&t)))))}(r,i)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var i=this.pos;this.pos=function writeUtf8(t,i,e){for(var r,s,n=0;n<i.length;n++){if((r=i.charCodeAt(n))>55295&&r<57344){if(!s){r>56319||n+1===i.length?(t[e++]=239,t[e++]=191,t[e++]=189):s=r;continue}if(r<56320){t[e++]=239,t[e++]=191,t[e++]=189,s=r;continue}r=s-55296<<10|r-56320|65536,s=null}else s&&(t[e++]=239,t[e++]=191,t[e++]=189,s=null);r<128?t[e++]=r:(r<2048?t[e++]=r>>6|192:(r<65536?t[e++]=r>>12|224:(t[e++]=r>>18|240,t[e++]=r>>12&63|128),t[e++]=r>>6&63|128),t[e++]=63&r|128)}return e}(this.buf,t,this.pos);var e=this.pos-i;e>=128&&makeRoomForExtraLength(i,e,this),this.pos=i-1,this.writeVarint(e),this.pos+=e},writeFloat:function(t){this.realloc(4),ieee754.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),ieee754.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var i=t.length;this.writeVarint(i),this.realloc(i);for(var e=0;e<i;e++)this.buf[this.pos++]=t[e]},writeRawMessage:function(t,i){this.pos++;var e=this.pos;t(i,this);var r=this.pos-e;r>=128&&makeRoomForExtraLength(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,i,e){this.writeTag(t,Pbf.Bytes),this.writeRawMessage(i,e)},writePackedVarint:function(t,i){this.writeMessage(t,writePackedVarint,i)},writePackedSVarint:function(t,i){this.writeMessage(t,writePackedSVarint,i)},writePackedBoolean:function(t,i){this.writeMessage(t,writePackedBoolean,i)},writePackedFloat:function(t,i){this.writeMessage(t,writePackedFloat,i)},writePackedDouble:function(t,i){this.writeMessage(t,writePackedDouble,i)},writePackedFixed32:function(t,i){this.writeMessage(t,writePackedFixed32,i)},writePackedSFixed32:function(t,i){this.writeMessage(t,writePackedSFixed32,i)},writePackedFixed64:function(t,i){this.writeMessage(t,writePackedFixed64,i)},writePackedSFixed64:function(t,i){this.writeMessage(t,writePackedSFixed64,i)},writeBytesField:function(t,i){this.writeTag(t,Pbf.Bytes),this.writeBytes(i)},writeFixed32Field:function(t,i){this.writeTag(t,Pbf.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(t,i){this.writeTag(t,Pbf.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(t,i){this.writeTag(t,Pbf.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(t,i){this.writeTag(t,Pbf.Fixed64),this.writeSFixed64(i)},writeVarintField:function(t,i){this.writeTag(t,Pbf.Varint),this.writeVarint(i)},writeSVarintField:function(t,i){this.writeTag(t,Pbf.Varint),this.writeSVarint(i)},writeStringField:function(t,i){this.writeTag(t,Pbf.Bytes),this.writeString(i)},writeFloatField:function(t,i){this.writeTag(t,Pbf.Fixed32),this.writeFloat(i)},writeDoubleField:function(t,i){this.writeTag(t,Pbf.Fixed64),this.writeDouble(i)},writeBooleanField:function(t,i){this.writeVarintField(t,Boolean(i))}}},{ieee754:25}],31:[function(_dereq_,module,exports){function swap(a,t,r){var o=a[t];a[t]=a[r],a[r]=o}function defaultCompare(a,t){return a<t?-1:a>t?1:0}module.exports=function partialSort(a,t,r,o,p){for(r=r||0,o=o||a.length-1,p=p||defaultCompare;o>r;){if(o-r>600){var f=o-r+1,e=t-r+1,l=Math.log(f),s=.5*Math.exp(2*l/3),i=.5*Math.sqrt(l*s*(f-s)/f)*(e-f/2<0?-1:1);partialSort(a,t,Math.max(r,Math.floor(t-e*s/f+i)),Math.min(o,Math.floor(t+(f-e)*s/f+i)),p)}var n=a[t],h=r,u=o;for(swap(a,r,t),p(a[o],n)>0&&swap(a,r,o);h<u;){for(swap(a,h,u),h++,u--;p(a[h],n)<0;)h++;for(;p(a[u],n)>0;)u--}0===p(a[r],n)?swap(a,r,u):swap(a,++u,o),u<=t&&(r=u+1),t<=u&&(o=u-1)}}},{}],32:[function(_dereq_,module,exports){function SuperCluster(t){this.options=extend(Object.create(this.options),t),this.trees=new Array(this.options.maxZoom+1)}function createCluster(t,e,n,o,i){return{x:t,y:e,zoom:1/0,id:o,properties:i,parentId:-1,numPoints:n}}function createPointCluster(t,e){var n=t.geometry.coordinates;return{x:lngX(n[0]),y:latY(n[1]),zoom:1/0,id:e,parentId:-1}}function getClusterJSON(t){return{type:"Feature",properties:getClusterProperties(t),geometry:{type:"Point",coordinates:[function xLng(t){return 360*(t-.5)}(t.x),function yLat(t){var e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}(t.y)]}}}function getClusterProperties(t){var e=t.numPoints,n=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return extend(extend({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function lngX(t){return t/360+.5}function latY(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function extend(t,e){for(var n in e)t[n]=e[n];return t}function getX(t){return t.x}function getY(t){return t.y}var kdbush=_dereq_("kdbush");module.exports=function supercluster(t){return new SuperCluster(t)},SuperCluster.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,initial:function(){return{}},map:function(t){return t}},load:function(t){var e=this.options.log;e&&console.time("total time");var n="prepare "+t.length+" points";e&&console.time(n),this.points=t;var o=t.map(createPointCluster);e&&console.timeEnd(n);for(var i=this.options.maxZoom;i>=this.options.minZoom;i--){var r=+Date.now();this.trees[i+1]=kdbush(o,getX,getY,this.options.nodeSize,Float32Array),o=this._cluster(o,i),e&&console.log("z%d: %d clusters in %dms",i,o.length,+Date.now()-r)}return this.trees[this.options.minZoom]=kdbush(o,getX,getY,this.options.nodeSize,Float32Array),e&&console.timeEnd("total time"),this},getClusters:function(t,e){for(var n=this.trees[this._limitZoom(e)],o=n.range(lngX(t[0]),latY(t[3]),lngX(t[2]),latY(t[1])),i=[],r=0;r<o.length;r++){var s=n.points[o[r]];i.push(s.numPoints?getClusterJSON(s):this.points[s.id])}return i},getChildren:function(t,e){for(var n=this.trees[e+1].points[t],o=this.options.radius/(this.options.extent*Math.pow(2,e)),i=this.trees[e+1].within(n.x,n.y,o),r=[],s=0;s<i.length;s++){var u=this.trees[e+1].points[i[s]];u.parentId===t&&r.push(u.numPoints?getClusterJSON(u):this.points[u.id])}return r},getLeaves:function(t,e,n,o){n=n||10,o=o||0;var i=[];return this._appendLeaves(i,t,e,n,o,0),i},getTile:function(t,e,n){var o=this.trees[this._limitZoom(t)],i=Math.pow(2,t),r=this.options.extent,u=this.options.radius/r,a=(n-u)/i,p=(n+1+u)/i,h={features:[]};return this._addTileFeatures(o.range((e-u)/i,a,(e+1+u)/i,p),o.points,e,n,i,h),0===e&&this._addTileFeatures(o.range(1-u/i,a,1,p),o.points,i,n,i,h),e===i-1&&this._addTileFeatures(o.range(0,a,u/i,p),o.points,-1,n,i,h),h.features.length?h:null},getClusterExpansionZoom:function(t,e){for(;e<this.options.maxZoom;){var n=this.getChildren(t,e);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e},_appendLeaves:function(t,e,n,o,i,r){for(var s=this.getChildren(e,n),u=0;u<s.length;u++){var a=s[u].properties;if(a.cluster?r+a.point_count<=i?r+=a.point_count:r=this._appendLeaves(t,a.cluster_id,n+1,o,i,r):r<i?r++:t.push(s[u]),t.length===o)break}return r},_addTileFeatures:function(t,e,n,o,i,r){for(var s=0;s<t.length;s++){var u=e[t[s]];r.features.push({type:1,geometry:[[Math.round(this.options.extent*(u.x*i-n)),Math.round(this.options.extent*(u.y*i-o))]],tags:u.numPoints?getClusterProperties(u):this.points[u.id].properties})}},_limitZoom:function(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))},_cluster:function(t,e){for(var n=[],o=this.options.radius/(this.options.extent*Math.pow(2,e)),i=0;i<t.length;i++){var r=t[i];if(!(r.zoom<=e)){r.zoom=e;var s=this.trees[e+1],u=s.within(r.x,r.y,o),a=r.numPoints||1,p=r.x*a,h=r.y*a,l=null;this.options.reduce&&(l=this.options.initial(),this._accumulate(l,r));for(var c=0;c<u.length;c++){var d=s.points[u[c]];if(e<d.zoom){var m=d.numPoints||1;d.zoom=e,p+=d.x*m,h+=d.y*m,a+=m,d.parentId=i,this.options.reduce&&this._accumulate(l,d)}}1===a?n.push(r):(r.parentId=i,n.push(createCluster(p/a,h/a,a,i,l)))}}return n},_accumulate:function(t,e){var n=e.numPoints?e.properties:this.options.map(this.points[e.id].properties);this.options.reduce(t,n)}}},{kdbush:26}],33:[function(_dereq_,module,exports){function TinyQueue(t,i){if(!(this instanceof TinyQueue))return new TinyQueue(t,i);if(this.data=t||[],this.length=this.data.length,this.compare=i||defaultCompare,this.length>0)for(var e=this.length>>1;e>=0;e--)this._down(e)}function defaultCompare(t,i){return t<i?-1:t>i?1:0}module.exports=TinyQueue,TinyQueue.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var i=this.data,e=this.compare,h=i[t];t>0;){var n=t-1>>1,a=i[n];if(e(h,a)>=0)break;i[t]=a,t=n}i[t]=h},_down:function(t){for(var i=this.data,e=this.compare,h=this.length,n=h>>1,a=i[t];t<n;){var s=1+(t<<1),u=s+1,r=i[s];if(u<h&&e(i[u],r)<0&&(s=u,r=i[u]),e(r,a)>=0)break;i[t]=r,t=s}i[t]=a}}},{}],34:[function(_dereq_,module,exports){function fromVectorTileJs(e){var r=new Pbf;return function writeTile(e,r){for(var t in e.layers)r.writeMessage(3,writeLayer,e.layers[t])}(e,r),r.finish()}function writeLayer(e,r){r.writeVarintField(15,e.version||1),r.writeStringField(1,e.name||""),r.writeVarintField(5,e.extent||4096);var t,i={keys:[],values:[],keycache:{},valuecache:{}};for(t=0;t<e.length;t++)i.feature=e.feature(t),r.writeMessage(2,writeFeature,i);var a=i.keys;for(t=0;t<a.length;t++)r.writeStringField(3,a[t]);var o=i.values;for(t=0;t<o.length;t++)r.writeMessage(4,writeValue,o[t])}function writeFeature(e,r){var t=e.feature;void 0!==t.id&&r.writeVarintField(1,t.id),r.writeMessage(2,writeProperties,e),r.writeVarintField(3,t.type),r.writeMessage(4,writeGeometry,t)}function writeProperties(e,r){var t=e.feature,i=e.keys,a=e.values,o=e.keycache,n=e.valuecache;for(var l in t.properties){var s=o[l];void 0===s&&(i.push(l),s=i.length-1,o[l]=s),r.writeVarint(s);var u=t.properties[l],f=typeof u;"string"!==f&&"boolean"!==f&&"number"!==f&&(u=JSON.stringify(u));var w=f+":"+u,v=n[w];void 0===v&&(a.push(u),v=a.length-1,n[w]=v),r.writeVarint(v)}}function command(e,r){return(r<<3)+(7&e)}function zigzag(e){return e<<1^e>>31}function writeGeometry(e,r){for(var t=e.loadGeometry(),i=e.type,a=0,o=0,n=t.length,l=0;l<n;l++){var s=t[l],u=1;1===i&&(u=s.length),r.writeVarint(command(1,u));for(var f=0;f<s.length;f++){1===f&&1!==i&&r.writeVarint(command(2,s.length-1));var w=s[f].x-a,v=s[f].y-o;r.writeVarint(zigzag(w)),r.writeVarint(zigzag(v)),a+=w,o+=v}}}function writeValue(e,r){var t=typeof e;"string"===t?r.writeStringField(1,e):"boolean"===t?r.writeBooleanField(7,e):"number"===t&&(e%1!=0?r.writeDoubleField(3,e):e<0?r.writeSVarintField(6,e):r.writeVarintField(5,e))}var Pbf=_dereq_("pbf"),GeoJSONWrapper=_dereq_("./lib/geojson_wrapper");module.exports=fromVectorTileJs,module.exports.fromVectorTileJs=fromVectorTileJs,module.exports.fromGeojsonVt=function fromGeojsonVt(e){var r={};for(var t in e)r[t]=new GeoJSONWrapper(e[t].features),r[t].name=t;return fromVectorTileJs({layers:r})},module.exports.GeoJSONWrapper=GeoJSONWrapper},{"./lib/geojson_wrapper":35,pbf:30}],35:[function(_dereq_,module,exports){function GeoJSONWrapper(e){this.features=e,this.length=e.length}function FeatureWrapper(e){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=4096}var Point=_dereq_("@mapbox/point-geometry"),VectorTileFeature=_dereq_("@mapbox/vector-tile").VectorTileFeature;module.exports=GeoJSONWrapper,GeoJSONWrapper.prototype.feature=function(e){return new FeatureWrapper(this.features[e])},FeatureWrapper.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var t=0;t<e.length;t++){for(var r=e[t],o=[],a=0;a<r.length;a++)o.push(new Point(r[a][0],r[a][1]));this.geometry.push(o)}return this.geometry},FeatureWrapper.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,r=-1/0,o=1/0,a=-1/0,p=0;p<e.length;p++)for(var i=e[p],n=0;n<i.length;n++){var h=i[n];t=Math.min(t,h.x),r=Math.max(r,h.x),o=Math.min(o,h.y),a=Math.max(a,h.y)}return[t,o,r,a]},FeatureWrapper.prototype.toGeoJSON=VectorTileFeature.prototype.toGeoJSON},{"@mapbox/point-geometry":4,"@mapbox/vector-tile":8}],36:[function(_dereq_,module,exports){var bundleFn=arguments[3],sources=arguments[4],cache=arguments[5],stringify=JSON.stringify;module.exports=function(r,e){for(var o,n=Object.keys(cache),a=0,i=n.length;a<i;a++){var s=n[a],u=cache[s].exports;if(u===r||u&&u.default===r){o=s;break}}if(!o){o=Math.floor(Math.pow(16,8)*Math.random()).toString(16);var f={};for(a=0,i=n.length;a<i;a++){f[s=n[a]]=s}sources[o]=["function(require,module,exports){"+r+"(self); }",f]}var c=Math.floor(Math.pow(16,8)*Math.random()).toString(16),l={};l[o]=o,sources[c]=["function(require,module,exports){var f = require("+stringify(o)+");(f.default ? f.default : f)(self);}",l];var d={};!function t(r){for(var e in d[r]=!0,sources[r][1]){var o=sources[r][1][e];d[o]||t(o)}}(c);var g="("+bundleFn+")({"+Object.keys(d).map(function(r){return stringify(r)+":["+sources[r][0]+","+stringify(sources[r][1])+"]"}).join(",")+"},{},["+stringify(c)+"])",v=window.URL||window.webkitURL||window.mozURL||window.msURL,w=new Blob([g],{type:"text/javascript"});if(e&&e.bare)return w;var h=v.createObjectURL(w),m=new Worker(h);return m.objectURL=h,m}},{}],37:[function(_dereq_,module,exports){module.exports.RADIUS=6378137,module.exports.FLATTENING=1/298.257223563,module.exports.POLAR_RADIUS=6356752.3142},{}],38:[function(_dereq_,module,exports){module.exports={version:"0.44.1"}},{}],39:[function(_dereq_,module,exports){var StructArray=_dereq_("../util/struct_array").StructArray,Struct=_dereq_("../util/struct_array").Struct,register=_dereq_("../util/web_worker_transfer").register,Point=_dereq_("@mapbox/point-geometry"),StructArrayLayout2i4=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(t,r){var i=this.length;this.resize(i+1);var e=2*i;return this.int16[e+0]=t,this.int16[e+1]=r,i},r}(StructArray);StructArrayLayout2i4.prototype.bytesPerElement=4,register("StructArrayLayout2i4",StructArrayLayout2i4);var StructArrayLayout4i8=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(t,r,i,e){var o=this.length;this.resize(o+1);var u=4*o;return this.int16[u+0]=t,this.int16[u+1]=r,this.int16[u+2]=i,this.int16[u+3]=e,o},r}(StructArray);StructArrayLayout4i8.prototype.bytesPerElement=8,register("StructArrayLayout4i8",StructArrayLayout4i8);var StructArrayLayout2i4i12=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(t,r,i,e,o,u){var n=this.length;this.resize(n+1);var a=6*n;return this.int16[a+0]=t,this.int16[a+1]=r,this.int16[a+2]=i,this.int16[a+3]=e,this.int16[a+4]=o,this.int16[a+5]=u,n},r}(StructArray);StructArrayLayout2i4i12.prototype.bytesPerElement=12,register("StructArrayLayout2i4i12",StructArrayLayout2i4i12);var StructArrayLayout4i4ub12=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(t,r,i,e,o,u,n,a){var y=this.length;this.resize(y+1);var s=6*y,c=12*y;return this.int16[s+0]=t,this.int16[s+1]=r,this.int16[s+2]=i,this.int16[s+3]=e,this.uint8[c+8]=o,this.uint8[c+9]=u,this.uint8[c+10]=n,this.uint8[c+11]=a,y},r}(StructArray);StructArrayLayout4i4ub12.prototype.bytesPerElement=12,register("StructArrayLayout4i4ub12",StructArrayLayout4i4ub12);var StructArrayLayout4i4ui16=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(t,r,i,e,o,u,n,a){var y=this.length;this.resize(y+1);var s=8*y;return this.int16[s+0]=t,this.int16[s+1]=r,this.int16[s+2]=i,this.int16[s+3]=e,this.uint16[s+4]=o,this.uint16[s+5]=u,this.uint16[s+6]=n,this.uint16[s+7]=a,y},r}(StructArray);StructArrayLayout4i4ui16.prototype.bytesPerElement=16,register("StructArrayLayout4i4ui16",StructArrayLayout4i4ui16);var StructArrayLayout3f12=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(t,r,i){var e=this.length;this.resize(e+1);var o=3*e;return this.float32[o+0]=t,this.float32[o+1]=r,this.float32[o+2]=i,e},r}(StructArray);StructArrayLayout3f12.prototype.bytesPerElement=12,register("StructArrayLayout3f12",StructArrayLayout3f12);var StructArrayLayout1ul4=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(t){var r=this.length;this.resize(r+1);var i=1*r;return this.uint32[i+0]=t,r},r}(StructArray);StructArrayLayout1ul4.prototype.bytesPerElement=4,register("StructArrayLayout1ul4",StructArrayLayout1ul4);var StructArrayLayout6i1ul2ui2i24=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(t,r,i,e,o,u,n,a,y,s,c){var p=this.length;this.resize(p+1);var h=12*p,f=6*p;return this.int16[h+0]=t,this.int16[h+1]=r,this.int16[h+2]=i,this.int16[h+3]=e,this.int16[h+4]=o,this.int16[h+5]=u,this.uint32[f+3]=n,this.uint16[h+8]=a,this.uint16[h+9]=y,this.int16[h+10]=s,this.int16[h+11]=c,p},r}(StructArray);StructArrayLayout6i1ul2ui2i24.prototype.bytesPerElement=24,register("StructArrayLayout6i1ul2ui2i24",StructArrayLayout6i1ul2ui2i24);var StructArrayLayout2i2i2i12=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(t,r,i,e,o,u){var n=this.length;this.resize(n+1);var a=6*n;return this.int16[a+0]=t,this.int16[a+1]=r,this.int16[a+2]=i,this.int16[a+3]=e,this.int16[a+4]=o,this.int16[a+5]=u,n},r}(StructArray);StructArrayLayout2i2i2i12.prototype.bytesPerElement=12,register("StructArrayLayout2i2i2i12",StructArrayLayout2i2i2i12);var StructArrayLayout2ub4=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer)},r.prototype.emplaceBack=function(t,r){var i=this.length;this.resize(i+1);var e=4*i;return this.uint8[e+0]=t,this.uint8[e+1]=r,i},r}(StructArray);StructArrayLayout2ub4.prototype.bytesPerElement=4,register("StructArrayLayout2ub4",StructArrayLayout2ub4);var StructArrayLayout2i2ui3ul3ui2f2ub40=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(t,r,i,e,o,u,n,a,y,s,c,p,h,f){var A=this.length;this.resize(A+1);var _=20*A,l=10*A,S=40*A;return this.int16[_+0]=t,this.int16[_+1]=r,this.uint16[_+2]=i,this.uint16[_+3]=e,this.uint32[l+2]=o,this.uint32[l+3]=u,this.uint32[l+4]=n,this.uint16[_+10]=a,this.uint16[_+11]=y,this.uint16[_+12]=s,this.float32[l+7]=c,this.float32[l+8]=p,this.uint8[S+36]=h,this.uint8[S+37]=f,A},r}(StructArray);StructArrayLayout2i2ui3ul3ui2f2ub40.prototype.bytesPerElement=40,register("StructArrayLayout2i2ui3ul3ui2f2ub40",StructArrayLayout2i2ui3ul3ui2f2ub40);var StructArrayLayout1f4=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(t){var r=this.length;this.resize(r+1);var i=1*r;return this.float32[i+0]=t,r},r}(StructArray);StructArrayLayout1f4.prototype.bytesPerElement=4,register("StructArrayLayout1f4",StructArrayLayout1f4);var StructArrayLayout3i6=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(t,r,i){var e=this.length;this.resize(e+1);var o=3*e;return this.int16[o+0]=t,this.int16[o+1]=r,this.int16[o+2]=i,e},r}(StructArray);StructArrayLayout3i6.prototype.bytesPerElement=6,register("StructArrayLayout3i6",StructArrayLayout3i6);var StructArrayLayout1ul2ui8=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(t,r,i){var e=this.length;this.resize(e+1);var o=2*e,u=4*e;return this.uint32[o+0]=t,this.uint16[u+2]=r,this.uint16[u+3]=i,e},r}(StructArray);StructArrayLayout1ul2ui8.prototype.bytesPerElement=8,register("StructArrayLayout1ul2ui8",StructArrayLayout1ul2ui8);var StructArrayLayout3ui6=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(t,r,i){var e=this.length;this.resize(e+1);var o=3*e;return this.uint16[o+0]=t,this.uint16[o+1]=r,this.uint16[o+2]=i,e},r}(StructArray);StructArrayLayout3ui6.prototype.bytesPerElement=6,register("StructArrayLayout3ui6",StructArrayLayout3ui6);var StructArrayLayout2ui4=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(t,r){var i=this.length;this.resize(i+1);var e=2*i;return this.uint16[e+0]=t,this.uint16[e+1]=r,i},r}(StructArray);StructArrayLayout2ui4.prototype.bytesPerElement=4,register("StructArrayLayout2ui4",StructArrayLayout2ui4);var StructArrayLayout2f8=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(t,r){var i=this.length;this.resize(i+1);var e=2*i;return this.float32[e+0]=t,this.float32[e+1]=r,i},r}(StructArray);StructArrayLayout2f8.prototype.bytesPerElement=8,register("StructArrayLayout2f8",StructArrayLayout2f8);var StructArrayLayout4f16=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(t,r,i,e){var o=this.length;this.resize(o+1);var u=4*o;return this.float32[u+0]=t,this.float32[u+1]=r,this.float32[u+2]=i,this.float32[u+3]=e,o},r}(StructArray);StructArrayLayout4f16.prototype.bytesPerElement=16,register("StructArrayLayout4f16",StructArrayLayout4f16);var CollisionBoxStruct=function(t){function r(){t.apply(this,arguments)}t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r;var i={anchorPointX:{},anchorPointY:{},x1:{},y1:{},x2:{},y2:{},featureIndex:{},sourceLayerIndex:{},bucketIndex:{},radius:{},signedDistanceFromAnchor:{},anchorPoint:{}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointX.set=function(t){this._structArray.int16[this._pos2+0]=t},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.anchorPointY.set=function(t){this._structArray.int16[this._pos2+1]=t},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.x1.set=function(t){this._structArray.int16[this._pos2+2]=t},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.y1.set=function(t){this._structArray.int16[this._pos2+3]=t},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.x2.set=function(t){this._structArray.int16[this._pos2+4]=t},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.y2.set=function(t){this._structArray.int16[this._pos2+5]=t},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.featureIndex.set=function(t){this._structArray.uint32[this._pos4+3]=t},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.sourceLayerIndex.set=function(t){this._structArray.uint16[this._pos2+8]=t},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.bucketIndex.set=function(t){this._structArray.uint16[this._pos2+9]=t},i.radius.get=function(){return this._structArray.int16[this._pos2+10]},i.radius.set=function(t){this._structArray.int16[this._pos2+10]=t},i.signedDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+11]},i.signedDistanceFromAnchor.set=function(t){this._structArray.int16[this._pos2+11]=t},i.anchorPoint.get=function(){return new Point(this.anchorPointX,this.anchorPointY)},Object.defineProperties(r.prototype,i),r}(Struct);CollisionBoxStruct.prototype.size=24;var CollisionBoxArray=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.get=function(t){return new CollisionBoxStruct(this,t)},r}(StructArrayLayout6i1ul2ui2i24);register("CollisionBoxArray",CollisionBoxArray);var PlacedSymbolStruct=function(t){function r(){t.apply(this,arguments)}t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r;var i={anchorX:{},anchorY:{},glyphStartIndex:{},numGlyphs:{},vertexStartIndex:{},lineStartIndex:{},lineLength:{},segment:{},lowerSize:{},upperSize:{},lineOffsetX:{},lineOffsetY:{},writingMode:{},hidden:{}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorX.set=function(t){this._structArray.int16[this._pos2+0]=t},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.anchorY.set=function(t){this._structArray.int16[this._pos2+1]=t},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.glyphStartIndex.set=function(t){this._structArray.uint16[this._pos2+2]=t},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.numGlyphs.set=function(t){this._structArray.uint16[this._pos2+3]=t},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.vertexStartIndex.set=function(t){this._structArray.uint32[this._pos4+2]=t},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineStartIndex.set=function(t){this._structArray.uint32[this._pos4+3]=t},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.lineLength.set=function(t){this._structArray.uint32[this._pos4+4]=t},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.segment.set=function(t){this._structArray.uint16[this._pos2+10]=t},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.lowerSize.set=function(t){this._structArray.uint16[this._pos2+11]=t},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.upperSize.set=function(t){this._structArray.uint16[this._pos2+12]=t},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetX.set=function(t){this._structArray.float32[this._pos4+7]=t},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.lineOffsetY.set=function(t){this._structArray.float32[this._pos4+8]=t},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.writingMode.set=function(t){this._structArray.uint8[this._pos1+36]=t},i.hidden.get=function(){return this._structArray.uint8[this._pos1+37]},i.hidden.set=function(t){this._structArray.uint8[this._pos1+37]=t},Object.defineProperties(r.prototype,i),r}(Struct);PlacedSymbolStruct.prototype.size=40;var PlacedSymbolArray=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.get=function(t){return new PlacedSymbolStruct(this,t)},r}(StructArrayLayout2i2ui3ul3ui2f2ub40);register("PlacedSymbolArray",PlacedSymbolArray);var GlyphOffsetStruct=function(t){function r(){t.apply(this,arguments)}t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r;var i={offsetX:{}};return i.offsetX.get=function(){return this._structArray.float32[this._pos4+0]},i.offsetX.set=function(t){this._structArray.float32[this._pos4+0]=t},Object.defineProperties(r.prototype,i),r}(Struct);GlyphOffsetStruct.prototype.size=4;var GlyphOffsetArray=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.getoffsetX=function(t){return this.float32[1*t+0]},r.prototype.get=function(t){return new GlyphOffsetStruct(this,t)},r}(StructArrayLayout1f4);register("GlyphOffsetArray",GlyphOffsetArray);var SymbolLineVertexStruct=function(t){function r(){t.apply(this,arguments)}t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r;var i={x:{},y:{},tileUnitDistanceFromAnchor:{}};return i.x.get=function(){return this._structArray.int16[this._pos2+0]},i.x.set=function(t){this._structArray.int16[this._pos2+0]=t},i.y.get=function(){return this._structArray.int16[this._pos2+1]},i.y.set=function(t){this._structArray.int16[this._pos2+1]=t},i.tileUnitDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+2]},i.tileUnitDistanceFromAnchor.set=function(t){this._structArray.int16[this._pos2+2]=t},Object.defineProperties(r.prototype,i),r}(Struct);SymbolLineVertexStruct.prototype.size=6;var SymbolLineVertexArray=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.getx=function(t){return this.int16[3*t+0]},r.prototype.gety=function(t){return this.int16[3*t+1]},r.prototype.gettileUnitDistanceFromAnchor=function(t){return this.int16[3*t+2]},r.prototype.get=function(t){return new SymbolLineVertexStruct(this,t)},r}(StructArrayLayout3i6);register("SymbolLineVertexArray",SymbolLineVertexArray);var FeatureIndexStruct=function(t){function r(){t.apply(this,arguments)}t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r;var i={featureIndex:{},sourceLayerIndex:{},bucketIndex:{}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.featureIndex.set=function(t){this._structArray.uint32[this._pos4+0]=t},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.sourceLayerIndex.set=function(t){this._structArray.uint16[this._pos2+2]=t},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},i.bucketIndex.set=function(t){this._structArray.uint16[this._pos2+3]=t},Object.defineProperties(r.prototype,i),r}(Struct);FeatureIndexStruct.prototype.size=8;var FeatureIndexArray=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.get=function(t){return new FeatureIndexStruct(this,t)},r}(StructArrayLayout1ul2ui8);register("FeatureIndexArray",FeatureIndexArray),module.exports={StructArrayLayout2i4:StructArrayLayout2i4,StructArrayLayout4i8:StructArrayLayout4i8,StructArrayLayout2i4i12:StructArrayLayout2i4i12,StructArrayLayout4i4ub12:StructArrayLayout4i4ub12,StructArrayLayout4i4ui16:StructArrayLayout4i4ui16,StructArrayLayout3f12:StructArrayLayout3f12,StructArrayLayout1ul4:StructArrayLayout1ul4,StructArrayLayout6i1ul2ui2i24:StructArrayLayout6i1ul2ui2i24,StructArrayLayout2i2i2i12:StructArrayLayout2i2i2i12,StructArrayLayout2ub4:StructArrayLayout2ub4,StructArrayLayout2i2ui3ul3ui2f2ub40:StructArrayLayout2i2ui3ul3ui2f2ub40,StructArrayLayout1f4:StructArrayLayout1f4,StructArrayLayout3i6:StructArrayLayout3i6,StructArrayLayout1ul2ui8:StructArrayLayout1ul2ui8,StructArrayLayout3ui6:StructArrayLayout3ui6,StructArrayLayout2ui4:StructArrayLayout2ui4,StructArrayLayout2f8:StructArrayLayout2f8,StructArrayLayout4f16:StructArrayLayout4f16,PosArray:StructArrayLayout2i4,RasterBoundsArray:StructArrayLayout4i8,CircleLayoutArray:StructArrayLayout2i4,FillLayoutArray:StructArrayLayout2i4,FillExtrusionLayoutArray:StructArrayLayout2i4i12,HeatmapLayoutArray:StructArrayLayout2i4,LineLayoutArray:StructArrayLayout4i4ub12,SymbolLayoutArray:StructArrayLayout4i4ui16,SymbolDynamicLayoutArray:StructArrayLayout3f12,SymbolOpacityArray:StructArrayLayout1ul4,CollisionBoxLayoutArray:StructArrayLayout2i2i2i12,CollisionCircleLayoutArray:StructArrayLayout2i2i2i12,CollisionVertexArray:StructArrayLayout2ub4,TriangleIndexArray:StructArrayLayout3ui6,LineIndexArray:StructArrayLayout2ui4,CollisionBoxArray:CollisionBoxArray,PlacedSymbolArray:PlacedSymbolArray,GlyphOffsetArray:GlyphOffsetArray,SymbolLineVertexArray:SymbolLineVertexArray,FeatureIndexArray:FeatureIndexArray}},{"../util/struct_array":271,"../util/web_worker_transfer":278,"@mapbox/point-geometry":4}],40:[function(_dereq_,module,exports){module.exports={deserialize:function(r,e){var t={};if(!e)return t;for(var n=0,a=r;n<a.length;n+=1){var i=a[n],l=i.layerIds.map(function(r){return e.getLayer(r)}).filter(Boolean);if(0!==l.length){i.layers=l;for(var o=0,f=l;o<f.length;o+=1)t[f[o].id]=i}}return t}}},{}],41:[function(_dereq_,module,exports){var createLayout=_dereq_("../../util/struct_array").createLayout;module.exports=createLayout([{name:"a_pos",components:2,type:"Int16"}],4)},{"../../util/struct_array":271}],42:[function(_dereq_,module,exports){function addCircleVertex(e,r,t,a,i){e.emplaceBack(2*r+(a+1)/2,2*t+(i+1)/2)}var CircleLayoutArray=_dereq_("../array_types").CircleLayoutArray,layoutAttributes=_dereq_("./circle_attributes").members,SegmentVector=_dereq_("../segment").SegmentVector,ProgramConfigurationSet=_dereq_("../program_configuration").ProgramConfigurationSet,TriangleIndexArray=_dereq_("../index_array_type").TriangleIndexArray,loadGeometry=_dereq_("../load_geometry"),EXTENT=_dereq_("../extent"),register=_dereq_("../../util/web_worker_transfer").register,CircleBucket=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.layoutVertexArray=new CircleLayoutArray,this.indexArray=new TriangleIndexArray,this.segments=new SegmentVector,this.programConfigurations=new ProgramConfigurationSet(layoutAttributes,e.layers,e.zoom)};CircleBucket.prototype.populate=function(e,r){for(var t=this,a=0,i=e;a<i.length;a+=1){var o=i[a],n=o.feature,u=o.index,s=o.sourceLayerIndex;if(t.layers[0]._featureFilter({zoom:t.zoom},n)){var y=loadGeometry(n);t.addFeature(n,y),r.featureIndex.insert(n,y,u,s,t.index)}}},CircleBucket.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},CircleBucket.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.programConfigurations.upload(e)},CircleBucket.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},CircleBucket.prototype.addFeature=function(e,r){for(var t=this,a=0,i=r;a<i.length;a+=1)for(var n=0,u=i[a];n<u.length;n+=1){var s=u[n],y=s.x,l=s.y;if(!(y<0||y>=EXTENT||l<0||l>=EXTENT)){var c=t.segments.prepareSegment(4,t.layoutVertexArray,t.indexArray),f=c.vertexLength;addCircleVertex(t.layoutVertexArray,y,l,-1,-1),addCircleVertex(t.layoutVertexArray,y,l,1,-1),addCircleVertex(t.layoutVertexArray,y,l,1,1),addCircleVertex(t.layoutVertexArray,y,l,-1,1),t.indexArray.emplaceBack(f,f+1,f+2),t.indexArray.emplaceBack(f,f+3,f+2),c.vertexLength+=4,c.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e)},register("CircleBucket",CircleBucket,{omit:["layers"]}),module.exports=CircleBucket},{"../../util/web_worker_transfer":278,"../array_types":39,"../extent":53,"../index_array_type":55,"../load_geometry":56,"../program_configuration":58,"../segment":60,"./circle_attributes":41}],43:[function(_dereq_,module,exports){arguments[4][41][0].apply(exports,arguments)},{"../../util/struct_array":271,dup:41}],44:[function(_dereq_,module,exports){var FillLayoutArray=_dereq_("../array_types").FillLayoutArray,layoutAttributes=_dereq_("./fill_attributes").members,SegmentVector=_dereq_("../segment").SegmentVector,ProgramConfigurationSet=_dereq_("../program_configuration").ProgramConfigurationSet,ref$3=_dereq_("../index_array_type"),LineIndexArray=ref$3.LineIndexArray,TriangleIndexArray=ref$3.TriangleIndexArray,loadGeometry=_dereq_("../load_geometry"),earcut=_dereq_("earcut"),classifyRings=_dereq_("../../util/classify_rings"),register=_dereq_("../../util/web_worker_transfer").register,FillBucket=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.layoutVertexArray=new FillLayoutArray,this.indexArray=new TriangleIndexArray,this.indexArray2=new LineIndexArray,this.programConfigurations=new ProgramConfigurationSet(layoutAttributes,e.layers,e.zoom),this.segments=new SegmentVector,this.segments2=new SegmentVector};FillBucket.prototype.populate=function(e,r){for(var t=this,i=0,a=e;i<a.length;i+=1){var n=a[i],o=n.feature,s=n.index,u=n.sourceLayerIndex;if(t.layers[0]._featureFilter({zoom:t.zoom},o)){var l=loadGeometry(o);t.addFeature(o,l),r.featureIndex.insert(o,l,s,u,t.index)}}},FillBucket.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},FillBucket.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2),this.programConfigurations.upload(e)},FillBucket.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},FillBucket.prototype.addFeature=function(e,r){for(var t=this,i=0,a=classifyRings(r,500);i<a.length;i+=1){for(var n=a[i],o=0,s=0,u=n;s<u.length;s+=1)o+=u[s].length;for(var l=t.segments.prepareSegment(o,t.layoutVertexArray,t.indexArray),y=l.vertexLength,g=[],f=[],h=0,x=n;h<x.length;h+=1){var d=x[h];if(0!==d.length){d!==n[0]&&f.push(g.length/2);var c=t.segments2.prepareSegment(d.length,t.layoutVertexArray,t.indexArray2),m=c.vertexLength;t.layoutVertexArray.emplaceBack(d[0].x,d[0].y),t.indexArray2.emplaceBack(m+d.length-1,m),g.push(d[0].x),g.push(d[0].y);for(var p=1;p<d.length;p++)t.layoutVertexArray.emplaceBack(d[p].x,d[p].y),t.indexArray2.emplaceBack(m+p-1,m+p),g.push(d[p].x),g.push(d[p].y);c.vertexLength+=d.length,c.primitiveLength+=d.length}}for(var A=earcut(g,f),B=0;B<A.length;B+=3)t.indexArray.emplaceBack(y+A[B],y+A[B+1],y+A[B+2]);l.vertexLength+=o,l.primitiveLength+=A.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e)},register("FillBucket",FillBucket,{omit:["layers"]}),module.exports=FillBucket},{"../../util/classify_rings":255,"../../util/web_worker_transfer":278,"../array_types":39,"../index_array_type":55,"../load_geometry":56,"../program_configuration":58,"../segment":60,"./fill_attributes":43,earcut:14}],45:[function(_dereq_,module,exports){var createLayout=_dereq_("../../util/struct_array").createLayout;module.exports=createLayout([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4)},{"../../util/struct_array":271}],46:[function(_dereq_,module,exports){function addVertex(e,r,t,i,a,n,o,u){e.emplaceBack(r,t,2*Math.floor(i*FACTOR)+o,a*FACTOR*2,n*FACTOR*2,Math.round(u))}function isBoundaryEdge(e,r){return e.x===r.x&&(e.x<0||e.x>EXTENT)||e.y===r.y&&(e.y<0||e.y>EXTENT)}function isEntirelyOutside(e){return e.every(function(e){return e.x<0})||e.every(function(e){return e.x>EXTENT})||e.every(function(e){return e.y<0})||e.every(function(e){return e.y>EXTENT})}var FillExtrusionLayoutArray=_dereq_("../array_types").FillExtrusionLayoutArray,layoutAttributes=_dereq_("./fill_extrusion_attributes").members,ref$1=_dereq_("../segment"),SegmentVector=ref$1.SegmentVector,MAX_VERTEX_ARRAY_LENGTH=ref$1.MAX_VERTEX_ARRAY_LENGTH,ProgramConfigurationSet=_dereq_("../program_configuration").ProgramConfigurationSet,TriangleIndexArray=_dereq_("../index_array_type").TriangleIndexArray,loadGeometry=_dereq_("../load_geometry"),EXTENT=_dereq_("../extent"),earcut=_dereq_("earcut"),classifyRings=_dereq_("../../util/classify_rings"),register=_dereq_("../../util/web_worker_transfer").register,FACTOR=Math.pow(2,13),FillExtrusionBucket=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.layoutVertexArray=new FillExtrusionLayoutArray,this.indexArray=new TriangleIndexArray,this.programConfigurations=new ProgramConfigurationSet(layoutAttributes,e.layers,e.zoom),this.segments=new SegmentVector};FillExtrusionBucket.prototype.populate=function(e,r){for(var t=this,i=0,a=e;i<a.length;i+=1){var n=a[i],o=n.feature,u=n.index,s=n.sourceLayerIndex;if(t.layers[0]._featureFilter({zoom:t.zoom},o)){var y=loadGeometry(o);t.addFeature(o,y),r.featureIndex.insert(o,y,u,s,t.index)}}},FillExtrusionBucket.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},FillExtrusionBucket.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.programConfigurations.upload(e)},FillExtrusionBucket.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},FillExtrusionBucket.prototype.addFeature=function(e,r){for(var t=this,i=0,a=classifyRings(r,500);i<a.length;i+=1){for(var n=a[i],o=0,u=0,s=n;u<s.length;u+=1)o+=s[u].length;for(var y=t.segments.prepareSegment(4,t.layoutVertexArray,t.indexArray),l=0,x=n;l<x.length;l+=1){var f=x[l];if(0!==f.length&&!isEntirelyOutside(f))for(var g=0,d=0;d<f.length;d++){var h=f[d];if(d>=1){var A=f[d-1];if(!isBoundaryEdge(h,A)){y.vertexLength+4>MAX_VERTEX_ARRAY_LENGTH&&(y=t.segments.prepareSegment(4,t.layoutVertexArray,t.indexArray));var c=h.sub(A)._perp()._unit(),p=A.dist(h);g+p>32768&&(g=0),addVertex(t.layoutVertexArray,h.x,h.y,c.x,c.y,0,0,g),addVertex(t.layoutVertexArray,h.x,h.y,c.x,c.y,0,1,g),g+=p,addVertex(t.layoutVertexArray,A.x,A.y,c.x,c.y,0,0,g),addVertex(t.layoutVertexArray,A.x,A.y,c.x,c.y,0,1,g);var E=y.vertexLength;t.indexArray.emplaceBack(E,E+1,E+2),t.indexArray.emplaceBack(E+1,E+2,E+3),y.vertexLength+=4,y.primitiveLength+=2}}}}y.vertexLength+o>MAX_VERTEX_ARRAY_LENGTH&&(y=t.segments.prepareSegment(o,t.layoutVertexArray,t.indexArray));for(var m=[],v=[],V=y.vertexLength,_=0,T=n;_<T.length;_+=1){var B=T[_];if(0!==B.length){B!==n[0]&&v.push(m.length/2);for(var R=0;R<B.length;R++){var F=B[R];addVertex(t.layoutVertexArray,F.x,F.y,0,0,1,1,0),m.push(F.x),m.push(F.y)}}}for(var L=earcut(m,v),X=0;X<L.length;X+=3)t.indexArray.emplaceBack(V+L[X],V+L[X+1],V+L[X+2]);y.primitiveLength+=L.length/3,y.vertexLength+=o}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e)},register("FillExtrusionBucket",FillExtrusionBucket,{omit:["layers"]}),module.exports=FillExtrusionBucket},{"../../util/classify_rings":255,"../../util/web_worker_transfer":278,"../array_types":39,"../extent":53,"../index_array_type":55,"../load_geometry":56,"../program_configuration":58,"../segment":60,"./fill_extrusion_attributes":45,earcut:14}],47:[function(_dereq_,module,exports){var CircleBucket=_dereq_("./circle_bucket"),register=_dereq_("../../util/web_worker_transfer").register,HeatmapBucket=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(CircleBucket);register("HeatmapBucket",HeatmapBucket,{omit:["layers"]}),module.exports=HeatmapBucket},{"../../util/web_worker_transfer":278,"./circle_bucket":42}],48:[function(_dereq_,module,exports){var createLayout=_dereq_("../../util/struct_array").createLayout;module.exports=createLayout([{name:"a_pos_normal",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4)},{"../../util/struct_array":271}],49:[function(_dereq_,module,exports){function addLineVertex(e,t,r,i,a,n,s){e.emplaceBack(t.x,t.y,i?1:0,a?1:-1,Math.round(EXTRUDE_SCALE*r.x)+128,Math.round(EXTRUDE_SCALE*r.y)+128,1+(0===n?0:n<0?-1:1)|(s*LINE_DISTANCE_SCALE&63)<<2,s*LINE_DISTANCE_SCALE>>6)}var LineLayoutArray=_dereq_("../array_types").LineLayoutArray,layoutAttributes=_dereq_("./line_attributes").members,SegmentVector=_dereq_("../segment").SegmentVector,ProgramConfigurationSet=_dereq_("../program_configuration").ProgramConfigurationSet,TriangleIndexArray=_dereq_("../index_array_type").TriangleIndexArray,loadGeometry=_dereq_("../load_geometry"),EXTENT=_dereq_("../extent"),vectorTileFeatureTypes=_dereq_("@mapbox/vector-tile").VectorTileFeature.types,register=_dereq_("../../util/web_worker_transfer").register,EXTRUDE_SCALE=63,COS_HALF_SHARP_CORNER=Math.cos(Math.PI/180*37.5),LINE_DISTANCE_SCALE=.5,MAX_LINE_DISTANCE=Math.pow(2,14)/LINE_DISTANCE_SCALE,LineBucket=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.layoutVertexArray=new LineLayoutArray,this.indexArray=new TriangleIndexArray,this.programConfigurations=new ProgramConfigurationSet(layoutAttributes,e.layers,e.zoom),this.segments=new SegmentVector};LineBucket.prototype.populate=function(e,t){for(var r=this,i=0,a=e;i<a.length;i+=1){var n=a[i],s=n.feature,u=n.index,d=n.sourceLayerIndex;if(r.layers[0]._featureFilter({zoom:r.zoom},s)){var o=loadGeometry(s);r.addFeature(s,o),t.featureIndex.insert(s,o,u,d,r.index)}}},LineBucket.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},LineBucket.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.programConfigurations.upload(e)},LineBucket.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},LineBucket.prototype.addFeature=function(e,t){for(var i=this.layers[0].layout,a=i.get("line-join").evaluate(e),n=i.get("line-cap"),s=i.get("line-miter-limit"),u=i.get("line-round-limit"),d=0,o=t;d<o.length;d+=1){var l=o[d];this.addLine(l,e,a,n,s,u)}},LineBucket.prototype.addLine=function(e,t,r,i,a,n){for(var s=this,u="Polygon"===vectorTileFeatureTypes[t.type],d=e.length;d>=2&&e[d-1].equals(e[d-2]);)d--;for(var o=0;o<d-1&&e[o].equals(e[o+1]);)o++;if(!(d<(u?3:2))){"bevel"===r&&(a=1.05);var l=EXTENT/(512*this.overscaling)*15,h=e[o],y=this.segments.prepareSegment(10*d,this.layoutVertexArray,this.indexArray);this.distance=0;var c,f,x,m=i,p=u?"butt":i,_=!0,g=void 0,v=void 0,L=void 0,A=void 0;this.e1=this.e2=this.e3=-1,u&&(c=e[d-2],A=h.sub(c)._unit()._perp());for(var C=o;C<d;C++)if(!(v=u&&C===d-1?e[o+1]:e[C+1])||!e[C].equals(v)){A&&(L=A),c&&(g=c),c=e[C],A=v?v.sub(c)._unit()._perp():L;var E=(L=L||A).add(A);0===E.x&&0===E.y||E._unit();var V=E.x*A.x+E.y*A.y,S=0!==V?1/V:1/0,B=V<COS_HALF_SHARP_CORNER&&g&&v;if(B&&C>o){var T=c.dist(g);if(T>2*l){var I=c.sub(c.sub(g)._mult(l/T)._round());s.distance+=I.dist(g),s.addCurrentVertex(I,s.distance,L.mult(1),0,0,!1,y),g=I}}var b=g&&v,N=b?r:v?m:p;if(b&&"round"===N&&(S<n?N="miter":S<=2&&(N="fakeround")),"miter"===N&&S>a&&(N="bevel"),"bevel"===N&&(S>2&&(N="flipbevel"),S<a&&(N="miter")),g&&(s.distance+=c.dist(g)),"miter"===N)E._mult(S),s.addCurrentVertex(c,s.distance,E,0,0,!1,y);else if("flipbevel"===N){if(S>100)E=A.clone().mult(-1);else{var k=L.x*A.y-L.y*A.x>0?-1:1,R=S*L.add(A).mag()/L.sub(A).mag();E._perp()._mult(R*k)}s.addCurrentVertex(c,s.distance,E,0,0,!1,y),s.addCurrentVertex(c,s.distance,E.mult(-1),0,0,!1,y)}else if("bevel"===N||"fakeround"===N){var F=L.x*A.y-L.y*A.x>0,q=-Math.sqrt(S*S-1);if(F?(x=0,f=q):(f=0,x=q),_||s.addCurrentVertex(c,s.distance,L,f,x,!1,y),"fakeround"===N){for(var P=Math.floor(8*(.5-(V-.5))),D=void 0,M=0;M<P;M++)D=A.mult((M+1)/(P+1))._add(L)._unit(),s.addPieSliceVertex(c,s.distance,D,F,y);s.addPieSliceVertex(c,s.distance,E,F,y);for(var O=P-1;O>=0;O--)D=L.mult((O+1)/(P+1))._add(A)._unit(),s.addPieSliceVertex(c,s.distance,D,F,y)}v&&s.addCurrentVertex(c,s.distance,A,-f,-x,!1,y)}else"butt"===N?(_||s.addCurrentVertex(c,s.distance,L,0,0,!1,y),v&&s.addCurrentVertex(c,s.distance,A,0,0,!1,y)):"square"===N?(_||(s.addCurrentVertex(c,s.distance,L,1,1,!1,y),s.e1=s.e2=-1),v&&s.addCurrentVertex(c,s.distance,A,-1,-1,!1,y)):"round"===N&&(_||(s.addCurrentVertex(c,s.distance,L,0,0,!1,y),s.addCurrentVertex(c,s.distance,L,1,1,!0,y),s.e1=s.e2=-1),v&&(s.addCurrentVertex(c,s.distance,A,-1,-1,!0,y),s.addCurrentVertex(c,s.distance,A,0,0,!1,y)));if(B&&C<d-1){var $=c.dist(v);if($>2*l){var w=c.add(v.sub(c)._mult(l/$)._round());s.distance+=w.dist(c),s.addCurrentVertex(w,s.distance,A.mult(1),0,0,!1,y),c=w}}_=!1}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t)}},LineBucket.prototype.addCurrentVertex=function(e,t,r,i,a,n,s){var u,d=this.layoutVertexArray,o=this.indexArray;u=r.clone(),i&&u._sub(r.perp()._mult(i)),addLineVertex(d,e,u,n,!1,i,t),this.e3=s.vertexLength++,this.e1>=0&&this.e2>=0&&(o.emplaceBack(this.e1,this.e2,this.e3),s.primitiveLength++),this.e1=this.e2,this.e2=this.e3,u=r.mult(-1),a&&u._sub(r.perp()._mult(a)),addLineVertex(d,e,u,n,!0,-a,t),this.e3=s.vertexLength++,this.e1>=0&&this.e2>=0&&(o.emplaceBack(this.e1,this.e2,this.e3),s.primitiveLength++),this.e1=this.e2,this.e2=this.e3,t>MAX_LINE_DISTANCE/2&&(this.distance=0,this.addCurrentVertex(e,this.distance,r,i,a,n,s))},LineBucket.prototype.addPieSliceVertex=function(e,t,r,i,a){r=r.mult(i?-1:1);var n=this.layoutVertexArray,s=this.indexArray;addLineVertex(n,e,r,!1,i,0,t),this.e3=a.vertexLength++,this.e1>=0&&this.e2>=0&&(s.emplaceBack(this.e1,this.e2,this.e3),a.primitiveLength++),i?this.e2=this.e3:this.e1=this.e3},register("LineBucket",LineBucket,{omit:["layers"]}),module.exports=LineBucket},{"../../util/web_worker_transfer":278,"../array_types":39,"../extent":53,"../index_array_type":55,"../load_geometry":56,"../program_configuration":58,"../segment":60,"./line_attributes":48,"@mapbox/vector-tile":8}],50:[function(_dereq_,module,exports){var createLayout=_dereq_("../../util/struct_array").createLayout,symbolAttributes={symbolLayoutAttributes:createLayout([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}]),dynamicLayoutAttributes:createLayout([{name:"a_projected_pos",components:3,type:"Float32"}],4),placementOpacityAttributes:createLayout([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),collisionVertexAttributes:createLayout([{name:"a_placed",components:2,type:"Uint8"}],4),collisionBox:createLayout([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"radius"},{type:"Int16",name:"signedDistanceFromAnchor"}]),collisionBoxLayout:createLayout([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),collisionCircleLayout:createLayout([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),placement:createLayout([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"hidden"}]),glyphOffset:createLayout([{type:"Float32",name:"offsetX"}]),lineVertex:createLayout([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}])};module.exports=symbolAttributes},{"../../util/struct_array":271}],51:[function(_dereq_,module,exports){function addVertex(e,t,r,o,i,a,n,s){e.emplaceBack(t,r,Math.round(64*o),Math.round(64*i),a,n,s?s[0]:0,s?s[1]:0)}function addDynamicAttributes(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}var ref=_dereq_("./symbol_attributes"),symbolLayoutAttributes=ref.symbolLayoutAttributes,collisionVertexAttributes=ref.collisionVertexAttributes,collisionBoxLayout=ref.collisionBoxLayout,collisionCircleLayout=ref.collisionCircleLayout,dynamicLayoutAttributes=ref.dynamicLayoutAttributes,ref$1=_dereq_("../array_types"),SymbolLayoutArray=ref$1.SymbolLayoutArray,SymbolDynamicLayoutArray=ref$1.SymbolDynamicLayoutArray,SymbolOpacityArray=ref$1.SymbolOpacityArray,CollisionBoxLayoutArray=ref$1.CollisionBoxLayoutArray,CollisionCircleLayoutArray=ref$1.CollisionCircleLayoutArray,CollisionVertexArray=ref$1.CollisionVertexArray,PlacedSymbolArray=ref$1.PlacedSymbolArray,GlyphOffsetArray=ref$1.GlyphOffsetArray,SymbolLineVertexArray=ref$1.SymbolLineVertexArray,Point=_dereq_("@mapbox/point-geometry"),SegmentVector=_dereq_("../segment").SegmentVector,ProgramConfigurationSet=_dereq_("../program_configuration").ProgramConfigurationSet,ref$4=_dereq_("../index_array_type"),TriangleIndexArray=ref$4.TriangleIndexArray,LineIndexArray=ref$4.LineIndexArray,transformText=_dereq_("../../symbol/transform_text"),mergeLines=_dereq_("../../symbol/mergelines"),scriptDetection=_dereq_("../../util/script_detection"),loadGeometry=_dereq_("../load_geometry"),vectorTileFeatureTypes=_dereq_("@mapbox/vector-tile").VectorTileFeature.types,verticalizePunctuation=_dereq_("../../util/verticalize_punctuation"),getSizeData=(_dereq_("../../symbol/anchor"),_dereq_("../../symbol/symbol_size").getSizeData),register=_dereq_("../../util/web_worker_transfer").register,shaderOpacityAttributes=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}],SymbolBuffers=function(e){this.layoutVertexArray=new SymbolLayoutArray,this.indexArray=new TriangleIndexArray,this.programConfigurations=e,this.segments=new SegmentVector,this.dynamicLayoutVertexArray=new SymbolDynamicLayoutArray,this.opacityVertexArray=new SymbolOpacityArray,this.placedSymbolArray=new PlacedSymbolArray};SymbolBuffers.prototype.upload=function(e,t){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,symbolLayoutAttributes.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.programConfigurations.upload(e),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,dynamicLayoutAttributes.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,shaderOpacityAttributes,!0),this.opacityVertexBuffer.itemSize=1},SymbolBuffers.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},register("SymbolBuffers",SymbolBuffers);var CollisionBuffers=function(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new SegmentVector,this.collisionVertexArray=new CollisionVertexArray};CollisionBuffers.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,collisionVertexAttributes.members,!0)},CollisionBuffers.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},register("CollisionBuffers",CollisionBuffers);var SymbolBucket=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.pixelRatio=e.pixelRatio;var r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=getSizeData(this.zoom,r["text-size"]),this.iconSizeData=getSizeData(this.zoom,r["icon-size"]);var o=this.layers[0].layout;this.sortFeaturesByY=o.get("text-allow-overlap")||o.get("icon-allow-overlap")||o.get("text-ignore-placement")||o.get("icon-ignore-placement")};SymbolBucket.prototype.createArrays=function(){this.text=new SymbolBuffers(new ProgramConfigurationSet(symbolLayoutAttributes.members,this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new SymbolBuffers(new ProgramConfigurationSet(symbolLayoutAttributes.members,this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.collisionBox=new CollisionBuffers(CollisionBoxLayoutArray,collisionBoxLayout.members,LineIndexArray),this.collisionCircle=new CollisionBuffers(CollisionCircleLayoutArray,collisionCircleLayout.members,TriangleIndexArray),this.glyphOffsetArray=new GlyphOffsetArray,this.lineVertexArray=new SymbolLineVertexArray},SymbolBucket.prototype.populate=function(e,t){var o=this.layers[0],i=o.layout,a=i.get("text-font"),n=i.get("text-field"),s=i.get("icon-image"),l=("constant"!==n.value.kind||n.value.value.length>0)&&("constant"!==a.value.kind||a.value.value.length>0),y="constant"!==s.value.kind||s.value.value&&s.value.value.length>0;if(this.features=[],l||y){for(var c=t.iconDependencies,u=t.glyphDependencies,x={zoom:this.zoom},f=0,h=e;f<h.length;f+=1){var m=h[f],d=m.feature,p=m.index,g=m.sourceLayerIndex;if(o._featureFilter(x,d)){var A=void 0;l&&(A=o.getValueAndResolveTokens("text-field",d),A=transformText(A,o,d));var b=void 0;if(y&&(b=o.getValueAndResolveTokens("icon-image",d)),A||b){var B={text:A,icon:b,index:p,sourceLayerIndex:g,geometry:loadGeometry(d),properties:d.properties,type:vectorTileFeatureTypes[d.type]};if(void 0!==d.id&&(B.id=d.id),this.features.push(B),b&&(c[b]=!0),A)for(var v=a.evaluate(d).join(","),S=u[v]=u[v]||{},V="map"===i.get("text-rotation-alignment")&&"line"===i.get("symbol-placement"),C=scriptDetection.allowsVerticalWritingMode(A),k=0;k<A.length;k++)if(S[A.charCodeAt(k)]=!0,V&&C){var L=verticalizePunctuation.lookup[A.charAt(k)];L&&(S[L.charCodeAt(0)]=!0)}}}}"line"===i.get("symbol-placement")&&(this.features=mergeLines(this.features))}},SymbolBucket.prototype.isEmpty=function(){return 0===this.symbolInstances.length},SymbolBucket.prototype.upload=function(e){this.text.upload(e,this.sortFeaturesByY),this.icon.upload(e,this.sortFeaturesByY),this.collisionBox.upload(e),this.collisionCircle.upload(e)},SymbolBucket.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.collisionBox.destroy(),this.collisionCircle.destroy()},SymbolBucket.prototype.addToLineVertexArray=function(e,t){var o=this.lineVertexArray.length;if(void 0!==e.segment){for(var i=e.dist(t[e.segment+1]),a=e.dist(t[e.segment]),n={},s=e.segment+1;s<t.length;s++)n[s]={x:t[s].x,y:t[s].y,tileUnitDistanceFromAnchor:i},s<t.length-1&&(i+=t[s+1].dist(t[s]));for(var l=e.segment||0;l>=0;l--)n[l]={x:t[l].x,y:t[l].y,tileUnitDistanceFromAnchor:a},l>0&&(a+=t[l-1].dist(t[l]));for(var y=0;y<t.length;y++){var c=n[y];this.lineVertexArray.emplaceBack(c.x,c.y,c.tileUnitDistanceFromAnchor)}}return{lineStartIndex:o,lineLength:this.lineVertexArray.length-o}},SymbolBucket.prototype.addSymbols=function(e,t,r,o,i,a,n,s,l,y){for(var u=e.indexArray,x=e.layoutVertexArray,f=e.dynamicLayoutVertexArray,h=e.segments.prepareSegment(4*t.length,e.layoutVertexArray,e.indexArray),m=this.glyphOffsetArray.length,d=h.vertexLength,p=0,g=t;p<g.length;p+=1){var A=g[p],b=A.tl,B=A.tr,v=A.bl,S=A.br,V=A.tex,C=h.vertexLength,k=A.glyphOffset[1];addVertex(x,s.x,s.y,b.x,k+b.y,V.x,V.y,r),addVertex(x,s.x,s.y,B.x,k+B.y,V.x+V.w,V.y,r),addVertex(x,s.x,s.y,v.x,k+v.y,V.x,V.y+V.h,r),addVertex(x,s.x,s.y,S.x,k+S.y,V.x+V.w,V.y+V.h,r),addDynamicAttributes(f,s,0),u.emplaceBack(C,C+1,C+2),u.emplaceBack(C+1,C+2,C+3),h.vertexLength+=4,h.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(A.glyphOffset[0])}e.placedSymbolArray.emplaceBack(s.x,s.y,m,this.glyphOffsetArray.length-m,d,l,y,s.segment,r?r[0]:0,r?r[1]:0,o[0],o[1],n,!1),e.programConfigurations.populatePaintArrays(e.layoutVertexArray.length,a)},SymbolBucket.prototype._addCollisionDebugVertex=function(e,t,r,o,i){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,o.x,o.y,Math.round(i.x),Math.round(i.y))},SymbolBucket.prototype.addCollisionDebugVertices=function(e,t,r,o,i,a,n,s){var l=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),y=l.vertexLength,c=i.layoutVertexArray,u=i.collisionVertexArray;if(this._addCollisionDebugVertex(c,u,a,n.anchor,new Point(e,t)),this._addCollisionDebugVertex(c,u,a,n.anchor,new Point(r,t)),this._addCollisionDebugVertex(c,u,a,n.anchor,new Point(r,o)),this._addCollisionDebugVertex(c,u,a,n.anchor,new Point(e,o)),l.vertexLength+=4,s){var x=i.indexArray;x.emplaceBack(y,y+1,y+2),x.emplaceBack(y,y+2,y+3),l.primitiveLength+=2}else{var f=i.indexArray;f.emplaceBack(y,y+1),f.emplaceBack(y+1,y+2),f.emplaceBack(y+2,y+3),f.emplaceBack(y+3,y),l.primitiveLength+=4}},SymbolBucket.prototype.generateCollisionDebugBuffers=function(){for(var e=this,t=0,r=e.symbolInstances;t<r.length;t+=1){var o=r[t];o.textCollisionFeature={boxStartIndex:o.textBoxStartIndex,boxEndIndex:o.textBoxEndIndex},o.iconCollisionFeature={boxStartIndex:o.iconBoxStartIndex,boxEndIndex:o.iconBoxEndIndex};for(var i=0;i<2;i++){var a=o[0===i?"textCollisionFeature":"iconCollisionFeature"];if(a)for(var n=a.boxStartIndex;n<a.boxEndIndex;n++){var s=e.collisionBoxArray.get(n),l=s.x1,y=s.y1,c=s.x2,u=s.y2,x=s.radius>0;e.addCollisionDebugVertices(l,y,c,u,x?e.collisionCircle:e.collisionBox,s.anchorPoint,o,x)}}}},SymbolBucket.prototype.deserializeCollisionBoxes=function(e,t,r,o,i){for(var a={},n=t;n<r;n++){var s=e.get(n);if(0===s.radius){a.textBox={x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2,anchorPointX:s.anchorPointX,anchorPointY:s.anchorPointY};break}a.textCircles||(a.textCircles=[]),a.textCircles.push(s.anchorPointX,s.anchorPointY,s.radius,s.signedDistanceFromAnchor,1)}for(var l=o;l<i;l++){var y=e.get(l);if(0===y.radius){a.iconBox={x1:y.x1,y1:y.y1,x2:y.x2,y2:y.y2,anchorPointX:y.anchorPointX,anchorPointY:y.anchorPointY};break}}return a},SymbolBucket.prototype.hasTextData=function(){return this.text.segments.get().length>0},SymbolBucket.prototype.hasIconData=function(){return this.icon.segments.get().length>0},SymbolBucket.prototype.hasCollisionBoxData=function(){return this.collisionBox.segments.get().length>0},SymbolBucket.prototype.hasCollisionCircleData=function(){return this.collisionCircle.segments.get().length>0},SymbolBucket.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&(this.sortedAngle=e,!(this.text.segments.get().length>1||this.icon.segments.get().length>1))){for(var r=[],o=0;o<this.symbolInstances.length;o++)r.push(o);var i=Math.sin(e),a=Math.cos(e);r.sort(function(e,r){var o=t.symbolInstances[e],n=t.symbolInstances[r];return(i*o.anchor.x+a*o.anchor.y|0)-(i*n.anchor.x+a*n.anchor.y|0)||n.featureIndex-o.featureIndex}),this.text.indexArray.clear(),this.icon.indexArray.clear();for(var n=0,s=r;n<s.length;n+=1){for(var l=s[n],c=0,u=t.symbolInstances[l].placedTextSymbolIndices;c<u.length;c+=1)for(var x=u[c],f=t.text.placedSymbolArray.get(x),h=f.vertexStartIndex+4*f.numGlyphs,m=f.vertexStartIndex;m<h;m+=4)t.text.indexArray.emplaceBack(m,m+1,m+2),t.text.indexArray.emplaceBack(m+1,m+2,m+3);var d=t.icon.placedSymbolArray.get(l);if(d.numGlyphs){var p=d.vertexStartIndex;t.icon.indexArray.emplaceBack(p,p+1,p+2),t.icon.indexArray.emplaceBack(p+1,p+2,p+3)}}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},register("SymbolBucket",SymbolBucket,{omit:["layers","collisionBoxArray","features","compareText"],shallow:["symbolInstances"]}),SymbolBucket.MAX_GLYPHS=65535,SymbolBucket.addDynamicAttributes=addDynamicAttributes,module.exports=SymbolBucket},{"../../symbol/anchor":213,"../../symbol/mergelines":221,"../../symbol/symbol_size":228,"../../symbol/transform_text":229,"../../util/script_detection":269,"../../util/verticalize_punctuation":277,"../../util/web_worker_transfer":278,"../array_types":39,"../index_array_type":55,"../load_geometry":56,"../program_configuration":58,"../segment":60,"./symbol_attributes":50,"@mapbox/point-geometry":4,"@mapbox/vector-tile":8}],52:[function(_dereq_,module,exports){var RGBAImage=_dereq_("../util/image").RGBAImage,util=_dereq_("../util/util"),register=_dereq_("../util/web_worker_transfer").register,Level=function(e,t,i){if(e<=0)throw new RangeError("Level must have positive dimension");this.dim=e,this.border=t,this.stride=this.dim+2*this.border,this.data=i||new Int32Array((this.dim+2*this.border)*(this.dim+2*this.border))};Level.prototype.set=function(e,t,i){this.data[this._idx(e,t)]=i+65536},Level.prototype.get=function(e,t){return this.data[this._idx(e,t)]-65536},Level.prototype._idx=function(e,t){if(e<-this.border||e>=this.dim+this.border||t<-this.border||t>=this.dim+this.border)throw new RangeError("out of range source coordinates for DEM data");return(t+this.border)*this.stride+(e+this.border)},register("Level",Level);var DEMData=function(e,t,i){this.uid=e,this.scale=t||1,this.level=i||new Level(256,512),this.loaded=!!i};DEMData.prototype.loadFromImage=function(e){if(e.height!==e.width)throw new RangeError("DEM tiles must be square");for(var i=this.level=new Level(e.width,e.width/2),r=e.data,d=0;d<i.dim;d++)for(var s=0;s<i.dim;s++){var o=4*(d*i.dim+s);i.set(s,d,this.scale*((256*r[o]*256+256*r[o+1]+r[o+2])/10-1e4))}for(var m=0;m<i.dim;m++)i.set(-1,m,i.get(0,m)),i.set(i.dim,m,i.get(i.dim-1,m)),i.set(m,-1,i.get(m,0)),i.set(m,i.dim,i.get(m,i.dim-1));i.set(-1,-1,i.get(0,0)),i.set(i.dim,-1,i.get(i.dim-1,0)),i.set(-1,i.dim,i.get(0,i.dim-1)),i.set(i.dim,i.dim,i.get(i.dim-1,i.dim-1)),this.loaded=!0},DEMData.prototype.getPixels=function(){return new RGBAImage({width:this.level.dim+2*this.level.border,height:this.level.dim+2*this.level.border},new Uint8Array(this.level.data.buffer))},DEMData.prototype.backfillBorder=function(e,t,i){var r=this.level,d=e.level;if(r.dim!==d.dim)throw new Error("level mismatch (dem dimension)");var s=t*r.dim,a=t*r.dim+r.dim,o=i*r.dim,m=i*r.dim+r.dim;switch(t){case-1:s=a-1;break;case 1:a=s+1}switch(i){case-1:o=m-1;break;case 1:m=o+1}for(var l=util.clamp(s,-r.border,r.dim+r.border),h=util.clamp(a,-r.border,r.dim+r.border),n=util.clamp(o,-r.border,r.dim+r.border),v=util.clamp(m,-r.border,r.dim+r.border),u=-t*r.dim,f=-i*r.dim,b=n;b<v;b++)for(var g=l;g<h;g++)r.set(g,b,d.get(g+u,b+f))},register("DEMData",DEMData),module.exports={DEMData:DEMData,Level:Level}},{"../util/image":263,"../util/util":275,"../util/web_worker_transfer":278}],53:[function(_dereq_,module,exports){module.exports=8192},{}],54:[function(_dereq_,module,exports){function topDownFeatureComparator(e,r){return r-e}_dereq_("@mapbox/point-geometry");var loadGeometry=_dereq_("./load_geometry"),EXTENT=_dereq_("./extent"),featureFilter=_dereq_("../style-spec/feature_filter"),Grid=_dereq_("grid-index"),DictionaryCoder=_dereq_("../util/dictionary_coder"),vt=_dereq_("@mapbox/vector-tile"),Protobuf=_dereq_("pbf"),GeoJSONFeature=_dereq_("../util/vectortile_to_geojson"),arraysIntersect=_dereq_("../util/util").arraysIntersect,register=(_dereq_("../source/tile_id").OverscaledTileID,_dereq_("../util/web_worker_transfer").register),FeatureIndexArray=_dereq_("./array_types").FeatureIndexArray,FeatureIndex=function(e,r,t,a){this.tileID=e,this.overscaling=r,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=t||new Grid(EXTENT,16,0),this.featureIndexArray=a||new FeatureIndexArray};FeatureIndex.prototype.insert=function(e,r,t,a,i){var n=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(t,a,i);for(var s=0;s<r.length;s++){for(var u=r[s],l=[1/0,1/0,-1/0,-1/0],y=0;y<u.length;y++){var d=u[y];l[0]=Math.min(l[0],d.x),l[1]=Math.min(l[1],d.y),l[2]=Math.max(l[2],d.x),l[3]=Math.max(l[3],d.y)}this.grid.insert(n,l[0],l[1],l[2],l[3])}},FeatureIndex.prototype.query=function(e,r){this.vtLayers||(this.vtLayers=new vt.VectorTile(new Protobuf(this.rawTileData)).layers,this.sourceLayerCoder=new DictionaryCoder(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]));for(var t={},a=e.params||{},i=EXTENT/e.tileSize/e.scale,o=featureFilter(a.filter),n=e.queryGeometry,s=e.additionalRadius*i,u=1/0,l=1/0,y=-1/0,d=-1/0,c=0;c<n.length;c++)for(var f=n[c],h=0;h<f.length;h++){var x=f[h];u=Math.min(u,x.x),l=Math.min(l,x.y),y=Math.max(y,x.x),d=Math.max(d,x.y)}var v=this.grid.query(u-s,l-s,y+s,d+s);v.sort(topDownFeatureComparator),this.filterMatching(t,v,this.featureIndexArray,n,o,a.layers,r,e.bearing,i);var I=e.collisionIndex?e.collisionIndex.queryRenderedSymbols(n,this.tileID,EXTENT/e.tileSize,e.collisionBoxArray,e.sourceID,e.bucketInstanceIds):[];return I.sort(),this.filterMatching(t,I,e.collisionBoxArray,n,o,a.layers,r,e.bearing,i),t},FeatureIndex.prototype.filterMatching=function(e,r,t,a,i,o,n,s,u){for(var l,y=this,d=0;d<r.length;d++){var c=r[d];if(c!==l){l=c;var f=t.get(c),h=y.bucketLayerIDs[f.bucketIndex];if(!o||arraysIntersect(o,h)){var x=y.sourceLayerCoder.decode(f.sourceLayerIndex),I=y.vtLayers[x].feature(f.featureIndex);if(i({zoom:y.tileID.overscaledZ},I))for(var g=null,m=0;m<h.length;m++){var p=h[m];if(!(o&&o.indexOf(p)<0)){var q=n[p];if(q&&("symbol"===q.type||(g||(g=loadGeometry(I)),q.queryIntersectsFeature(a,I,g,y.z,s,u)))){var F=new GeoJSONFeature(I,y.z,y.x,y.y);F.layer=q.serialize();var b=e[p];void 0===b&&(b=e[p]=[]),b.push({featureIndex:c,feature:F})}}}}}}},FeatureIndex.prototype.hasLayer=function(e){for(var t=0,a=this.bucketLayerIDs;t<a.length;t+=1)for(var o=0,n=a[t];o<n.length;o+=1){if(e===n[o])return!0}return!1},register("FeatureIndex",FeatureIndex,{omit:["rawTileData","sourceLayerCoder"]}),module.exports=FeatureIndex},{"../source/tile_id":114,"../style-spec/feature_filter":148,"../util/dictionary_coder":257,"../util/util":275,"../util/vectortile_to_geojson":276,"../util/web_worker_transfer":278,"./array_types":39,"./extent":53,"./load_geometry":56,"@mapbox/point-geometry":4,"@mapbox/vector-tile":8,"grid-index":24,pbf:30}],55:[function(_dereq_,module,exports){module.exports={LineIndexArray:_dereq_("./array_types").LineIndexArray,TriangleIndexArray:_dereq_("./array_types").TriangleIndexArray}},{"./array_types":39}],56:[function(_dereq_,module,exports){var util=_dereq_("../util/util"),EXTENT=_dereq_("./extent"),bounds=function createBounds(e){return{min:-1*Math.pow(2,e-1),max:Math.pow(2,e-1)-1}}(16);module.exports=function(e){for(var t=EXTENT/e.extent,r=e.loadGeometry(),n=0;n<r.length;n++)for(var u=r[n],o=0;o<u.length;o++){var a=u[o];a.x=Math.round(a.x*t),a.y=Math.round(a.y*t),(a.x<bounds.min||a.x>bounds.max||a.y<bounds.min||a.y>bounds.max)&&util.warnOnce("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}},{"../util/util":275,"./extent":53}],57:[function(_dereq_,module,exports){var createLayout=_dereq_("../util/struct_array").createLayout;module.exports=createLayout([{name:"a_pos",type:"Int16",components:2}])},{"../util/struct_array":271}],58:[function(_dereq_,module,exports){function packColor(r){return[packUint8ToFloat(255*r.r,255*r.g),packUint8ToFloat(255*r.b,255*r.a)]}function paintAttributeName(r,t){return{"text-opacity":"opacity","icon-opacity":"opacity","text-color":"fill_color","icon-color":"fill_color","text-halo-color":"halo_color","icon-halo-color":"halo_color","text-halo-blur":"halo_blur","icon-halo-blur":"halo_blur","text-halo-width":"halo_width","icon-halo-width":"halo_width","line-gap-width":"gapwidth"}[r]||r.replace(t+"-","").replace(/-/g,"_")}var packUint8ToFloat=_dereq_("../shaders/encode_attribute").packUint8ToFloat,register=(_dereq_("../style-spec/util/color"),_dereq_("../util/web_worker_transfer").register),PossiblyEvaluatedPropertyValue=_dereq_("../style/properties").PossiblyEvaluatedPropertyValue,ref$2=_dereq_("./array_types"),StructArrayLayout1f4=ref$2.StructArrayLayout1f4,StructArrayLayout2f8=ref$2.StructArrayLayout2f8,StructArrayLayout4f16=ref$2.StructArrayLayout4f16,ConstantBinder=function(r,t,o){this.value=r,this.name=t,this.type=o,this.statistics={max:-1/0}};ConstantBinder.prototype.defines=function(){return["#define HAS_UNIFORM_u_"+this.name]},ConstantBinder.prototype.populatePaintArray=function(){},ConstantBinder.prototype.upload=function(){},ConstantBinder.prototype.destroy=function(){},ConstantBinder.prototype.setUniforms=function(r,t,o,e){var i=e.constantOr(this.value),n=r.gl;"color"===this.type?n.uniform4f(t.uniforms["u_"+this.name],i.r,i.g,i.b,i.a):n.uniform1f(t.uniforms["u_"+this.name],i)};var SourceExpressionBinder=function(r,t,o){this.expression=r,this.name=t,this.type=o,this.statistics={max:-1/0};var e="color"===o?StructArrayLayout2f8:StructArrayLayout1f4;this.paintVertexAttributes=[{name:"a_"+t,type:"Float32",components:"color"===o?2:1,offset:0}],this.paintVertexArray=new e};SourceExpressionBinder.prototype.defines=function(){return[]},SourceExpressionBinder.prototype.populatePaintArray=function(r,t){var o=this.paintVertexArray,e=o.length;o.reserve(r);var i=this.expression.evaluate({zoom:0},t);if("color"===this.type)for(var n=packColor(i),a=e;a<r;a++)o.emplaceBack(n[0],n[1]);else{for(var s=e;s<r;s++)o.emplaceBack(i);this.statistics.max=Math.max(this.statistics.max,i)}},SourceExpressionBinder.prototype.upload=function(r){this.paintVertexArray&&(this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes))},SourceExpressionBinder.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},SourceExpressionBinder.prototype.setUniforms=function(r,t){r.gl.uniform1f(t.uniforms["a_"+this.name+"_t"],0)};var CompositeExpressionBinder=function(r,t,o,e,i){this.expression=r,this.name=t,this.type=o,this.useIntegerZoom=e,this.zoom=i,this.statistics={max:-1/0};var n="color"===o?StructArrayLayout4f16:StructArrayLayout2f8;this.paintVertexAttributes=[{name:"a_"+t,type:"Float32",components:"color"===o?4:2,offset:0}],this.paintVertexArray=new n};CompositeExpressionBinder.prototype.defines=function(){return[]},CompositeExpressionBinder.prototype.populatePaintArray=function(r,t){var o=this.paintVertexArray,e=o.length;o.reserve(r);var i=this.expression.evaluate({zoom:this.zoom},t),n=this.expression.evaluate({zoom:this.zoom+1},t);if("color"===this.type)for(var a=packColor(i),s=packColor(n),p=e;p<r;p++)o.emplaceBack(a[0],a[1],s[0],s[1]);else{for(var u=e;u<r;u++)o.emplaceBack(i,n);this.statistics.max=Math.max(this.statistics.max,i,n)}},CompositeExpressionBinder.prototype.upload=function(r){this.paintVertexArray&&(this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes))},CompositeExpressionBinder.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},CompositeExpressionBinder.prototype.interpolationFactor=function(r){return this.useIntegerZoom?this.expression.interpolationFactor(Math.floor(r),this.zoom,this.zoom+1):this.expression.interpolationFactor(r,this.zoom,this.zoom+1)},CompositeExpressionBinder.prototype.setUniforms=function(r,t,o){r.gl.uniform1f(t.uniforms["a_"+this.name+"_t"],this.interpolationFactor(o.zoom))};var ProgramConfiguration=function(){this.binders={},this.cacheKey="",this._buffers=[]};ProgramConfiguration.createDynamic=function(r,t,o){var e=new ProgramConfiguration,i=[];for(var n in r.paint._values)if(o(n)){var a=r.paint.get(n);if(a instanceof PossiblyEvaluatedPropertyValue&&a.property.specification["property-function"]){var s=paintAttributeName(n,r.type),p=a.property.specification.type,u=a.property.useIntegerZoom;"constant"===a.value.kind?(e.binders[n]=new ConstantBinder(a.value,s,p),i.push("/u_"+s)):"source"===a.value.kind?(e.binders[n]=new SourceExpressionBinder(a.value,s,p),i.push("/a_"+s)):(e.binders[n]=new CompositeExpressionBinder(a.value,s,p,u,t),i.push("/z_"+s))}}return e.cacheKey=i.sort().join(""),e},ProgramConfiguration.prototype.populatePaintArrays=function(r,t){for(var e in this.binders)this.binders[e].populatePaintArray(r,t)},ProgramConfiguration.prototype.defines=function(){var t=[];for(var o in this.binders)t.push.apply(t,this.binders[o].defines());return t},ProgramConfiguration.prototype.setUniforms=function(r,t,o,e){for(var n in this.binders)this.binders[n].setUniforms(r,t,e,o.get(n))},ProgramConfiguration.prototype.getPaintVertexBuffers=function(){return this._buffers},ProgramConfiguration.prototype.upload=function(r){var t=this;for(var o in t.binders)t.binders[o].upload(r);var e=[];for(var i in t.binders){var n=t.binders[i];(n instanceof SourceExpressionBinder||n instanceof CompositeExpressionBinder)&&n.paintVertexBuffer&&e.push(n.paintVertexBuffer)}this._buffers=e},ProgramConfiguration.prototype.destroy=function(){for(var t in this.binders)this.binders[t].destroy()};var ProgramConfigurationSet=function(r,t,o,e){void 0===e&&(e=function(){return!0}),this.programConfigurations={};for(var n=0,a=t;n<a.length;n+=1){var s=a[n];this.programConfigurations[s.id]=ProgramConfiguration.createDynamic(s,o,e),this.programConfigurations[s.id].layoutAttributes=r}};ProgramConfigurationSet.prototype.populatePaintArrays=function(r,t){for(var e in this.programConfigurations)this.programConfigurations[e].populatePaintArrays(r,t)},ProgramConfigurationSet.prototype.get=function(r){return this.programConfigurations[r]},ProgramConfigurationSet.prototype.upload=function(r){for(var o in this.programConfigurations)this.programConfigurations[o].upload(r)},ProgramConfigurationSet.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},register("ConstantBinder",ConstantBinder),register("SourceExpressionBinder",SourceExpressionBinder),register("CompositeExpressionBinder",CompositeExpressionBinder),register("ProgramConfiguration",ProgramConfiguration,{omit:["_buffers"]}),register("ProgramConfigurationSet",ProgramConfigurationSet),module.exports={ProgramConfiguration:ProgramConfiguration,ProgramConfigurationSet:ProgramConfigurationSet}},{"../shaders/encode_attribute":96,"../style-spec/util/color":153,"../style/properties":188,"../util/web_worker_transfer":278,"./array_types":39}],59:[function(_dereq_,module,exports){var createLayout=_dereq_("../util/struct_array").createLayout;module.exports=createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}])},{"../util/struct_array":271}],60:[function(_dereq_,module,exports){var warnOnce=_dereq_("../util/util").warnOnce,register=_dereq_("../util/web_worker_transfer").register,MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,SegmentVector=function(e){void 0===e&&(e=[]),this.segments=e};SegmentVector.prototype.prepareSegment=function(e,t,r){var n=this.segments[this.segments.length-1];return e>MAX_VERTEX_ARRAY_LENGTH&&warnOnce("Max vertices per segment is "+MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!n||n.vertexLength+e>module.exports.MAX_VERTEX_ARRAY_LENGTH)&&(n={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},this.segments.push(n)),n},SegmentVector.prototype.get=function(){return this.segments},SegmentVector.prototype.destroy=function(){for(var t=0,r=this.segments;t<r.length;t+=1){var n=r[t];for(var s in n.vaos)n.vaos[s].destroy()}},register("SegmentVector",SegmentVector),module.exports={SegmentVector:SegmentVector,MAX_VERTEX_ARRAY_LENGTH:MAX_VERTEX_ARRAY_LENGTH}},{"../util/util":275,"../util/web_worker_transfer":278}],61:[function(_dereq_,module,exports){var Coordinate=function(o,t,n){this.column=o,this.row=t,this.zoom=n};Coordinate.prototype.clone=function(){return new Coordinate(this.column,this.row,this.zoom)},Coordinate.prototype.zoomTo=function(o){return this.clone()._zoomTo(o)},Coordinate.prototype.sub=function(o){return this.clone()._sub(o)},Coordinate.prototype._zoomTo=function(o){var t=Math.pow(2,o-this.zoom);return this.column*=t,this.row*=t,this.zoom=o,this},Coordinate.prototype._sub=function(o){return o=o.zoomTo(this.zoom),this.column-=o.column,this.row-=o.row,this},module.exports=Coordinate},{}],62:[function(_dereq_,module,exports){var wrap=_dereq_("../util/util").wrap,LngLat=function(t,n){if(isNaN(t)||isNaN(n))throw new Error("Invalid LngLat object: ("+t+", "+n+")");if(this.lng=+t,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};LngLat.prototype.wrap=function(){return new LngLat(wrap(this.lng,-180,180),this.lat)},LngLat.prototype.toArray=function(){return[this.lng,this.lat]},LngLat.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},LngLat.prototype.toBounds=function(t){var n=360*t/40075017,r=n/Math.cos(Math.PI/180*this.lat);return new(_dereq_("./lng_lat_bounds"))(new LngLat(this.lng-r,this.lat-n),new LngLat(this.lng+r,this.lat+n))},LngLat.convert=function(t){if(t instanceof LngLat)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new LngLat(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new LngLat(Number(t.lng),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")},module.exports=LngLat},{"../util/util":275,"./lng_lat_bounds":63}],63:[function(_dereq_,module,exports){var LngLat=_dereq_("./lng_lat"),LngLatBounds=function(t,n){t&&(n?this.setSouthWest(t).setNorthEast(n):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};LngLatBounds.prototype.setNorthEast=function(t){return this._ne=t instanceof LngLat?new LngLat(t.lng,t.lat):LngLat.convert(t),this},LngLatBounds.prototype.setSouthWest=function(t){return this._sw=t instanceof LngLat?new LngLat(t.lng,t.lat):LngLat.convert(t),this},LngLatBounds.prototype.extend=function(t){var n,e,s=this._sw,o=this._ne;if(t instanceof LngLat)n=t,e=t;else{if(!(t instanceof LngLatBounds))return Array.isArray(t)?t.every(Array.isArray)?this.extend(LngLatBounds.convert(t)):this.extend(LngLat.convert(t)):this;if(n=t._sw,e=t._ne,!n||!e)return this}return s||o?(s.lng=Math.min(n.lng,s.lng),s.lat=Math.min(n.lat,s.lat),o.lng=Math.max(e.lng,o.lng),o.lat=Math.max(e.lat,o.lat)):(this._sw=new LngLat(n.lng,n.lat),this._ne=new LngLat(e.lng,e.lat)),this},LngLatBounds.prototype.getCenter=function(){return new LngLat((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},LngLatBounds.prototype.getSouthWest=function(){return this._sw},LngLatBounds.prototype.getNorthEast=function(){return this._ne},LngLatBounds.prototype.getNorthWest=function(){return new LngLat(this.getWest(),this.getNorth())},LngLatBounds.prototype.getSouthEast=function(){return new LngLat(this.getEast(),this.getSouth())},LngLatBounds.prototype.getWest=function(){return this._sw.lng},LngLatBounds.prototype.getSouth=function(){return this._sw.lat},LngLatBounds.prototype.getEast=function(){return this._ne.lng},LngLatBounds.prototype.getNorth=function(){return this._ne.lat},LngLatBounds.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},LngLatBounds.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},LngLatBounds.prototype.isEmpty=function(){return!(this._sw&&this._ne)},LngLatBounds.convert=function(t){return!t||t instanceof LngLatBounds?t:new LngLatBounds(t)},module.exports=LngLatBounds},{"./lng_lat":62}],64:[function(_dereq_,module,exports){var LngLat=_dereq_("./lng_lat"),Point=_dereq_("@mapbox/point-geometry"),Coordinate=_dereq_("./coordinate"),util=_dereq_("../util/util"),interp=_dereq_("../style-spec/util/interpolate").number,tileCover=_dereq_("../util/tile_cover"),ref=_dereq_("../source/tile_id"),UnwrappedTileID=(ref.CanonicalTileID,ref.UnwrappedTileID),EXTENT=_dereq_("../data/extent"),glmatrix=_dereq_("@mapbox/gl-matrix"),vec4=glmatrix.vec4,mat4=glmatrix.mat4,mat2=glmatrix.mat2,Transform=function(t,i,o){this.tileSize=512,this._renderWorldCopies=void 0===o||o,this._minZoom=t||0,this._maxZoom=i||22,this.latRange=[-85.05113,85.05113],this.width=0,this.height=0,this._center=new LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._posMatrixCache={},this._alignedPosMatrixCache={}},prototypeAccessors={minZoom:{},maxZoom:{},renderWorldCopies:{},worldSize:{},centerPoint:{},size:{},bearing:{},pitch:{},fov:{},zoom:{},center:{},unmodified:{},x:{},y:{},point:{}};Transform.prototype.clone=function(){var t=new Transform(this._minZoom,this._maxZoom,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._calcMatrices(),t},prototypeAccessors.minZoom.get=function(){return this._minZoom},prototypeAccessors.minZoom.set=function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))},prototypeAccessors.maxZoom.get=function(){return this._maxZoom},prototypeAccessors.maxZoom.set=function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))},prototypeAccessors.renderWorldCopies.get=function(){return this._renderWorldCopies},prototypeAccessors.worldSize.get=function(){return this.tileSize*this.scale},prototypeAccessors.centerPoint.get=function(){return this.size._div(2)},prototypeAccessors.size.get=function(){return new Point(this.width,this.height)},prototypeAccessors.bearing.get=function(){return-this.angle/Math.PI*180},prototypeAccessors.bearing.set=function(t){var i=-util.wrap(t,-180,180)*Math.PI/180;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=mat2.create(),mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},prototypeAccessors.pitch.get=function(){return this._pitch/Math.PI*180},prototypeAccessors.pitch.set=function(t){var i=util.clamp(t,0,60)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())},prototypeAccessors.fov.get=function(){return this._fov/Math.PI*180},prototypeAccessors.fov.set=function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())},prototypeAccessors.zoom.get=function(){return this._zoom},prototypeAccessors.zoom.set=function(t){var i=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==i&&(this._unmodified=!1,this._zoom=i,this.scale=this.zoomScale(i),this.tileZoom=Math.floor(i),this.zoomFraction=i-this.tileZoom,this._constrain(),this._calcMatrices())},prototypeAccessors.center.get=function(){return this._center},prototypeAccessors.center.set=function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())},Transform.prototype.coveringZoomLevel=function(t){return(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize))},Transform.prototype.getVisibleUnwrappedCoordinates=function(t){var i=this.pointCoordinate(new Point(0,0),0),o=this.pointCoordinate(new Point(this.width,0),0),e=Math.floor(i.column),r=Math.floor(o.column),n=[new UnwrappedTileID(0,t)];if(this._renderWorldCopies)for(var s=e;s<=r;s++)0!==s&&n.push(new UnwrappedTileID(s,t));return n},Transform.prototype.coveringTiles=function(t){var i=this.coveringZoomLevel(t),o=i;if(void 0!==t.minzoom&&i<t.minzoom)return[];void 0!==t.maxzoom&&i>t.maxzoom&&(i=t.maxzoom);var e=this.pointCoordinate(this.centerPoint,i),r=new Point(e.column-.5,e.row-.5),n=[this.pointCoordinate(new Point(0,0),i),this.pointCoordinate(new Point(this.width,0),i),this.pointCoordinate(new Point(this.width,this.height),i),this.pointCoordinate(new Point(0,this.height),i)];return tileCover(i,n,t.reparseOverscaled?o:i,this._renderWorldCopies).sort(function(t,i){return r.dist(t.canonical)-r.dist(i.canonical)})},Transform.prototype.resize=function(t,i){this.width=t,this.height=i,this.pixelsToGLUnits=[2/t,-2/i],this._constrain(),this._calcMatrices()},prototypeAccessors.unmodified.get=function(){return this._unmodified},Transform.prototype.zoomScale=function(t){return Math.pow(2,t)},Transform.prototype.scaleZoom=function(t){return Math.log(t)/Math.LN2},Transform.prototype.project=function(t){return new Point(this.lngX(t.lng),this.latY(t.lat))},Transform.prototype.unproject=function(t){return new LngLat(this.xLng(t.x),this.yLat(t.y))},prototypeAccessors.x.get=function(){return this.lngX(this.center.lng)},prototypeAccessors.y.get=function(){return this.latY(this.center.lat)},prototypeAccessors.point.get=function(){return new Point(this.x,this.y)},Transform.prototype.lngX=function(t){return(180+t)*this.worldSize/360},Transform.prototype.latY=function(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))*this.worldSize/360},Transform.prototype.xLng=function(t){return 360*t/this.worldSize-180},Transform.prototype.yLat=function(t){var i=180-360*t/this.worldSize;return 360/Math.PI*Math.atan(Math.exp(i*Math.PI/180))-90},Transform.prototype.setLocationAtPoint=function(t,i){var o=this.pointCoordinate(i)._sub(this.pointCoordinate(this.centerPoint));this.center=this.coordinateLocation(this.locationCoordinate(t)._sub(o)),this._renderWorldCopies&&(this.center=this.center.wrap())},Transform.prototype.locationPoint=function(t){return this.coordinatePoint(this.locationCoordinate(t))},Transform.prototype.pointLocation=function(t){return this.coordinateLocation(this.pointCoordinate(t))},Transform.prototype.locationCoordinate=function(t){return new Coordinate(this.lngX(t.lng)/this.tileSize,this.latY(t.lat)/this.tileSize,this.zoom).zoomTo(this.tileZoom)},Transform.prototype.coordinateLocation=function(t){var i=t.zoomTo(this.zoom);return new LngLat(this.xLng(i.column*this.tileSize),this.yLat(i.row*this.tileSize))},Transform.prototype.pointCoordinate=function(t,i){void 0===i&&(i=this.tileZoom);var o=[t.x,t.y,0,1],e=[t.x,t.y,1,1];vec4.transformMat4(o,o,this.pixelMatrixInverse),vec4.transformMat4(e,e,this.pixelMatrixInverse);var r=o[3],n=e[3],h=o[1]/r,c=e[1]/n,l=o[2]/r,m=e[2]/n,p=l===m?0:(0-l)/(m-l);return new Coordinate(interp(o[0]/r,e[0]/n,p)/this.tileSize,interp(h,c,p)/this.tileSize,this.zoom)._zoomTo(i)},Transform.prototype.coordinatePoint=function(t){var i=t.zoomTo(this.zoom),o=[i.column*this.tileSize,i.row*this.tileSize,0,1];return vec4.transformMat4(o,o,this.pixelMatrix),new Point(o[0]/o[3],o[1]/o[3])},Transform.prototype.calculatePosMatrix=function(t,i){void 0===i&&(i=!1);var o=t.key,e=i?this._alignedPosMatrixCache:this._posMatrixCache;if(e[o])return e[o];var r=t.canonical,n=this.worldSize/this.zoomScale(r.z),s=r.x+Math.pow(2,r.z)*t.wrap,a=mat4.identity(new Float64Array(16));return mat4.translate(a,a,[s*n,r.y*n,0]),mat4.scale(a,a,[n/EXTENT,n/EXTENT,1]),mat4.multiply(a,i?this.alignedProjMatrix:this.projMatrix,a),e[o]=new Float32Array(a),e[o]},Transform.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var t,i,o,e,r=-90,n=90,s=-180,a=180,h=this.size,c=this._unmodified;if(this.latRange){var l=this.latRange;r=this.latY(l[1]),t=(n=this.latY(l[0]))-r<h.y?h.y/(n-r):0}if(this.lngRange){var m=this.lngRange;s=this.lngX(m[0]),i=(a=this.lngX(m[1]))-s<h.x?h.x/(a-s):0}var p=Math.max(i||0,t||0);if(p)return this.center=this.unproject(new Point(i?(a+s)/2:this.x,t?(n+r)/2:this.y)),this.zoom+=this.scaleZoom(p),this._unmodified=c,void(this._constraining=!1);if(this.latRange){var u=this.y,f=h.y/2;u-f<r&&(e=r+f),u+f>n&&(e=n-f)}if(this.lngRange){var d=this.x,g=h.x/2;d-g<s&&(o=s+g),d+g>a&&(o=a-g)}void 0===o&&void 0===e||(this.center=this.unproject(new Point(void 0!==o?o:this.x,void 0!==e?e:this.y))),this._unmodified=c,this._constraining=!1}},Transform.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var t=this._fov/2,i=Math.PI/2+this._pitch,o=Math.sin(t)*this.cameraToCenterDistance/Math.sin(Math.PI-i-t),e=this.x,r=this.y,s=1.01*(Math.cos(Math.PI/2-this._pitch)*o+this.cameraToCenterDistance),a=new Float64Array(16);mat4.perspective(a,this._fov,this.width/this.height,1,s),mat4.scale(a,a,[1,-1,1]),mat4.translate(a,a,[0,0,-this.cameraToCenterDistance]),mat4.rotateX(a,a,this._pitch),mat4.rotateZ(a,a,this.angle),mat4.translate(a,a,[-e,-r,0]);var h=this.worldSize/(2*Math.PI*6378137*Math.abs(Math.cos(this.center.lat*(Math.PI/180))));mat4.scale(a,a,[1,1,h,1]),this.projMatrix=a;var c=this.width%2/2,l=this.height%2/2,m=Math.cos(this.angle),p=Math.sin(this.angle),u=e-Math.round(e)+m*c+p*l,f=r-Math.round(r)+m*l+p*c,d=new Float64Array(a);if(mat4.translate(d,d,[u>.5?u-1:u,f>.5?f-1:f,0]),this.alignedProjMatrix=d,a=mat4.create(),mat4.scale(a,a,[this.width/2,-this.height/2,1]),mat4.translate(a,a,[1,-1,0]),this.pixelMatrix=mat4.multiply(new Float64Array(16),a,this.projMatrix),!(a=mat4.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=a,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Object.defineProperties(Transform.prototype,prototypeAccessors),module.exports=Transform},{"../data/extent":53,"../source/tile_id":114,"../style-spec/util/interpolate":158,"../util/tile_cover":273,"../util/util":275,"./coordinate":61,"./lng_lat":62,"@mapbox/gl-matrix":2,"@mapbox/point-geometry":4}],65:[function(_dereq_,module,exports){var Color=_dereq_("../style-spec/util/color"),ColorMode=function(o,e,l){this.blendFunction=o,this.blendColor=e,this.mask=l};ColorMode.disabled=new ColorMode(ColorMode.Replace=[1,0],Color.transparent,[!1,!1,!1,!1]),ColorMode.unblended=new ColorMode(ColorMode.Replace,Color.transparent,[!0,!0,!0,!0]),ColorMode.alphaBlended=new ColorMode([1,771],Color.transparent,[!0,!0,!0,!0]),module.exports=ColorMode},{"../style-spec/util/color":153}],66:[function(_dereq_,module,exports){var IndexBuffer=_dereq_("./index_buffer"),VertexBuffer=_dereq_("./vertex_buffer"),Framebuffer=_dereq_("./framebuffer"),ColorMode=(_dereq_("./depth_mode"),_dereq_("./stencil_mode"),_dereq_("./color_mode")),util=_dereq_("../util/util"),ref=_dereq_("./value"),ClearColor=ref.ClearColor,ClearDepth=ref.ClearDepth,ClearStencil=ref.ClearStencil,ColorMask=ref.ColorMask,DepthMask=ref.DepthMask,StencilMask=ref.StencilMask,StencilFunc=ref.StencilFunc,StencilOp=ref.StencilOp,StencilTest=ref.StencilTest,DepthRange=ref.DepthRange,DepthTest=ref.DepthTest,DepthFunc=ref.DepthFunc,Blend=ref.Blend,BlendFunc=ref.BlendFunc,BlendColor=ref.BlendColor,Program=ref.Program,LineWidth=ref.LineWidth,ActiveTextureUnit=ref.ActiveTextureUnit,Viewport=ref.Viewport,BindFramebuffer=ref.BindFramebuffer,BindRenderbuffer=ref.BindRenderbuffer,BindTexture=ref.BindTexture,BindVertexBuffer=ref.BindVertexBuffer,BindElementBuffer=ref.BindElementBuffer,BindVertexArrayOES=ref.BindVertexArrayOES,PixelStoreUnpack=ref.PixelStoreUnpack,PixelStoreUnpackPremultiplyAlpha=ref.PixelStoreUnpackPremultiplyAlpha,Context=function(e){this.gl=e,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.lineWidthRange=e.getParameter(e.ALIASED_LINE_WIDTH_RANGE),this.clearColor=new ClearColor(this),this.clearDepth=new ClearDepth(this),this.clearStencil=new ClearStencil(this),this.colorMask=new ColorMask(this),this.depthMask=new DepthMask(this),this.stencilMask=new StencilMask(this),this.stencilFunc=new StencilFunc(this),this.stencilOp=new StencilOp(this),this.stencilTest=new StencilTest(this),this.depthRange=new DepthRange(this),this.depthTest=new DepthTest(this),this.depthFunc=new DepthFunc(this),this.blend=new Blend(this),this.blendFunc=new BlendFunc(this),this.blendColor=new BlendColor(this),this.program=new Program(this),this.lineWidth=new LineWidth(this),this.activeTexture=new ActiveTextureUnit(this),this.viewport=new Viewport(this),this.bindFramebuffer=new BindFramebuffer(this),this.bindRenderbuffer=new BindRenderbuffer(this),this.bindTexture=new BindTexture(this),this.bindVertexBuffer=new BindVertexBuffer(this),this.bindElementBuffer=new BindElementBuffer(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new BindVertexArrayOES(this),this.pixelStoreUnpack=new PixelStoreUnpack(this),this.pixelStoreUnpackPremultiplyAlpha=new PixelStoreUnpackPremultiplyAlpha(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=e.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&e.getExtension("OES_texture_half_float_linear")};Context.prototype.createIndexBuffer=function(e,t){return new IndexBuffer(this,e,t)},Context.prototype.createVertexBuffer=function(e,t,r){return new VertexBuffer(this,e,t,r)},Context.prototype.createRenderbuffer=function(e,t,r){var i=this.gl,n=i.createRenderbuffer();return this.bindRenderbuffer.set(n),i.renderbufferStorage(i.RENDERBUFFER,e,t,r),this.bindRenderbuffer.set(null),n},Context.prototype.createFramebuffer=function(e,t){return new Framebuffer(this,e,t)},Context.prototype.clear=function(e){var t=e.color,r=e.depth,i=this.gl,n=0;t&&(n|=i.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==r&&(n|=i.DEPTH_BUFFER_BIT,this.clearDepth.set(r),this.depthMask.set(!0)),i.clear(n)},Context.prototype.setDepthMode=function(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)},Context.prototype.setStencilMode=function(e){e.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)},Context.prototype.setColorMode=function(e){util.deepEqual(e.blendFunction,ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)},module.exports=Context},{"../util/util":275,"./color_mode":65,"./depth_mode":67,"./framebuffer":68,"./index_buffer":69,"./stencil_mode":70,"./value":71,"./vertex_buffer":72}],67:[function(_dereq_,module,exports){var DepthMode=function(e,t,d){this.func=e,this.mask=t,this.range=d};DepthMode.ReadOnly=!1,DepthMode.ReadWrite=!0,DepthMode.disabled=new DepthMode(519,DepthMode.ReadOnly,[0,1]),module.exports=DepthMode},{}],68:[function(_dereq_,module,exports){var ref=_dereq_("./value"),ColorAttachment=ref.ColorAttachment,DepthAttachment=ref.DepthAttachment,Framebuffer=function(t,e,r){this.context=t,this.width=e,this.height=r;var h=t.gl,a=this.framebuffer=h.createFramebuffer();this.colorAttachment=new ColorAttachment(t,a),this.depthAttachment=new DepthAttachment(t,a)};Framebuffer.prototype.destroy=function(){var t=this.context.gl,e=this.colorAttachment.get();e&&t.deleteTexture(e);var r=this.depthAttachment.get();r&&t.deleteRenderbuffer(r),t.deleteFramebuffer(this.framebuffer)},module.exports=Framebuffer},{"./value":71}],69:[function(_dereq_,module,exports){var IndexBuffer=function(e,t,r){this.context=e;var f=e.gl;this.buffer=f.createBuffer(),this.dynamicDraw=Boolean(r),this.unbindVAO(),e.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer};IndexBuffer.prototype.unbindVAO=function(){this.context.extVertexArrayObject&&this.context.bindVertexArrayOES.set(null)},IndexBuffer.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},IndexBuffer.prototype.updateData=function(e){var t=this.context.gl;this.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)},IndexBuffer.prototype.destroy=function(){var e=this.context.gl;this.buffer&&(e.deleteBuffer(this.buffer),delete this.buffer)},module.exports=IndexBuffer},{}],70:[function(_dereq_,module,exports){var StencilMode=function(t,e,i,s,d,l){this.test=t,this.ref=e,this.mask=i,this.fail=s,this.depthFail=d,this.pass=l};StencilMode.disabled=new StencilMode({func:519,mask:0},0,0,7680,7680,7680),module.exports=StencilMode},{}],71:[function(_dereq_,module,exports){var Color=_dereq_("../style-spec/util/color"),util=_dereq_("../util/util"),ClearColor=function(t){this.context=t,this.current=Color.transparent};ClearColor.prototype.get=function(){return this.current},ClearColor.prototype.set=function(t){var e=this.current;t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a||(this.context.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t)};var ClearDepth=function(t){this.context=t,this.current=1};ClearDepth.prototype.get=function(){return this.current},ClearDepth.prototype.set=function(t){this.current!==t&&(this.context.gl.clearDepth(t),this.current=t)};var ClearStencil=function(t){this.context=t,this.current=0};ClearStencil.prototype.get=function(){return this.current},ClearStencil.prototype.set=function(t){this.current!==t&&(this.context.gl.clearStencil(t),this.current=t)};var ColorMask=function(t){this.context=t,this.current=[!0,!0,!0,!0]};ColorMask.prototype.get=function(){return this.current},ColorMask.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]||(this.context.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t)};var DepthMask=function(t){this.context=t,this.current=!0};DepthMask.prototype.get=function(){return this.current},DepthMask.prototype.set=function(t){this.current!==t&&(this.context.gl.depthMask(t),this.current=t)};var StencilMask=function(t){this.context=t,this.current=255};StencilMask.prototype.get=function(){return this.current},StencilMask.prototype.set=function(t){this.current!==t&&(this.context.gl.stencilMask(t),this.current=t)};var StencilFunc=function(t){this.context=t,this.current={func:t.gl.ALWAYS,ref:0,mask:255}};StencilFunc.prototype.get=function(){return this.current},StencilFunc.prototype.set=function(t){var e=this.current;t.func===e.func&&t.ref===e.ref&&t.mask===e.mask||(this.context.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t)};var StencilOp=function(t){this.context=t;var e=this.context.gl;this.current=[e.KEEP,e.KEEP,e.KEEP]};StencilOp.prototype.get=function(){return this.current},StencilOp.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]||(this.context.gl.stencilOp(t[0],t[1],t[2]),this.current=t)};var StencilTest=function(t){this.context=t,this.current=!1};StencilTest.prototype.get=function(){return this.current},StencilTest.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t}};var DepthRange=function(t){this.context=t,this.current=[0,1]};DepthRange.prototype.get=function(){return this.current},DepthRange.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]||(this.context.gl.depthRange(t[0],t[1]),this.current=t)};var DepthTest=function(t){this.context=t,this.current=!1};DepthTest.prototype.get=function(){return this.current},DepthTest.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t}};var DepthFunc=function(t){this.context=t,this.current=t.gl.LESS};DepthFunc.prototype.get=function(){return this.current},DepthFunc.prototype.set=function(t){this.current!==t&&(this.context.gl.depthFunc(t),this.current=t)};var Blend=function(t){this.context=t,this.current=!1};Blend.prototype.get=function(){return this.current},Blend.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t}};var BlendFunc=function(t){this.context=t;var e=this.context.gl;this.current=[e.ONE,e.ZERO]};BlendFunc.prototype.get=function(){return this.current},BlendFunc.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]||(this.context.gl.blendFunc(t[0],t[1]),this.current=t)};var BlendColor=function(t){this.context=t,this.current=Color.transparent};BlendColor.prototype.get=function(){return this.current},BlendColor.prototype.set=function(t){var e=this.current;t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a||(this.context.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t)};var Program=function(t){this.context=t,this.current=null};Program.prototype.get=function(){return this.current},Program.prototype.set=function(t){this.current!==t&&(this.context.gl.useProgram(t),this.current=t)};var LineWidth=function(t){this.context=t,this.current=1};LineWidth.prototype.get=function(){return this.current},LineWidth.prototype.set=function(t){var e=this.context.lineWidthRange,r=util.clamp(t,e[0],e[1]);this.current!==r&&(this.context.gl.lineWidth(r),this.current=t)};var ActiveTextureUnit=function(t){this.context=t,this.current=t.gl.TEXTURE0};ActiveTextureUnit.prototype.get=function(){return this.current},ActiveTextureUnit.prototype.set=function(t){this.current!==t&&(this.context.gl.activeTexture(t),this.current=t)};var Viewport=function(t){this.context=t;var e=this.context.gl;this.current=[0,0,e.drawingBufferWidth,e.drawingBufferHeight]};Viewport.prototype.get=function(){return this.current},Viewport.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]||(this.context.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t)};var BindFramebuffer=function(t){this.context=t,this.current=null};BindFramebuffer.prototype.get=function(){return this.current},BindFramebuffer.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t}};var BindRenderbuffer=function(t){this.context=t,this.current=null};BindRenderbuffer.prototype.get=function(){return this.current},BindRenderbuffer.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t}};var BindTexture=function(t){this.context=t,this.current=null};BindTexture.prototype.get=function(){return this.current},BindTexture.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t}};var BindVertexBuffer=function(t){this.context=t,this.current=null};BindVertexBuffer.prototype.get=function(){return this.current},BindVertexBuffer.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t}};var BindElementBuffer=function(t){this.context=t,this.current=null};BindElementBuffer.prototype.get=function(){return this.current},BindElementBuffer.prototype.set=function(t){var e=this.context.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t};var BindVertexArrayOES=function(t){this.context=t,this.current=null};BindVertexArrayOES.prototype.get=function(){return this.current},BindVertexArrayOES.prototype.set=function(t){this.current!==t&&this.context.extVertexArrayObject&&(this.context.extVertexArrayObject.bindVertexArrayOES(t),this.current=t)};var PixelStoreUnpack=function(t){this.context=t,this.current=4};PixelStoreUnpack.prototype.get=function(){return this.current},PixelStoreUnpack.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t}};var PixelStoreUnpackPremultiplyAlpha=function(t){this.context=t,this.current=!1};PixelStoreUnpackPremultiplyAlpha.prototype.get=function(){return this.current},PixelStoreUnpackPremultiplyAlpha.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t}};var FramebufferValue=function(t,e){this.context=t,this.current=null,this.parent=e};FramebufferValue.prototype.get=function(){return this.current};var ColorAttachment=function(t){function e(e,r){t.call(this,e,r),this.dirty=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){if(this.dirty||this.current!==t){var e=this.context.gl;this.context.bindFramebuffer.set(this.parent),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}},e.prototype.setDirty=function(){this.dirty=!0},e}(FramebufferValue),DepthAttachment=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){if(this.current!==t){var e=this.context.gl;this.context.bindFramebuffer.set(this.parent),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t}},e}(FramebufferValue);module.exports={ClearColor:ClearColor,ClearDepth:ClearDepth,ClearStencil:ClearStencil,ColorMask:ColorMask,DepthMask:DepthMask,StencilMask:StencilMask,StencilFunc:StencilFunc,StencilOp:StencilOp,StencilTest:StencilTest,DepthRange:DepthRange,DepthTest:DepthTest,DepthFunc:DepthFunc,Blend:Blend,BlendFunc:BlendFunc,BlendColor:BlendColor,Program:Program,LineWidth:LineWidth,ActiveTextureUnit:ActiveTextureUnit,Viewport:Viewport,BindFramebuffer:BindFramebuffer,BindRenderbuffer:BindRenderbuffer,BindTexture:BindTexture,BindVertexBuffer:BindVertexBuffer,BindElementBuffer:BindElementBuffer,BindVertexArrayOES:BindVertexArrayOES,PixelStoreUnpack:PixelStoreUnpack,PixelStoreUnpackPremultiplyAlpha:PixelStoreUnpackPremultiplyAlpha,ColorAttachment:ColorAttachment,DepthAttachment:DepthAttachment}},{"../style-spec/util/color":153,"../util/util":275}],72:[function(_dereq_,module,exports){var AttributeType={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},VertexBuffer=function(t,e,r,i){this.length=e.length,this.attributes=r,this.itemSize=e.bytesPerElement,this.dynamicDraw=i,this.context=t;var f=t.gl;this.buffer=f.createBuffer(),t.bindVertexBuffer.set(this.buffer),f.bufferData(f.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};VertexBuffer.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},VertexBuffer.prototype.updateData=function(t){var e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)},VertexBuffer.prototype.enableAttributes=function(t,e){for(var i=0;i<this.attributes.length;i++){var f=this.attributes[i],n=e.attributes[f.name];void 0!==n&&t.enableVertexAttribArray(n)}},VertexBuffer.prototype.setVertexAttribPointers=function(t,e,r){for(var i=this,f=0;f<this.attributes.length;f++){var n=i.attributes[f],u=e.attributes[n.name];void 0!==u&&t.vertexAttribPointer(u,n.components,t[AttributeType[n.type]],!1,i.itemSize,n.offset+i.itemSize*(r||0))}},VertexBuffer.prototype.destroy=function(){var t=this.context.gl;this.buffer&&(t.deleteBuffer(this.buffer),delete this.buffer)},module.exports=VertexBuffer},{}],73:[function(_dereq_,module,exports){var supported=_dereq_("@mapbox/mapbox-gl-supported"),browser=_dereq_("./util/browser"),version=_dereq_("../package.json").version,Map=_dereq_("./ui/map"),NavigationControl=_dereq_("./ui/control/navigation_control"),GeolocateControl=_dereq_("./ui/control/geolocate_control"),AttributionControl=_dereq_("./ui/control/attribution_control"),ScaleControl=_dereq_("./ui/control/scale_control"),FullscreenControl=_dereq_("./ui/control/fullscreen_control"),Popup=_dereq_("./ui/popup"),Marker=_dereq_("./ui/marker"),Style=_dereq_("./style/style"),LngLat=_dereq_("./geo/lng_lat"),LngLatBounds=_dereq_("./geo/lng_lat_bounds"),Point=_dereq_("@mapbox/point-geometry"),Evented=_dereq_("./util/evented"),config=_dereq_("./util/config"),rtlTextPlugin=_dereq_("./source/rtl_text_plugin");module.exports={version:version,supported:supported,workerCount:Math.max(Math.floor(browser.hardwareConcurrency/2),1),setRTLTextPlugin:rtlTextPlugin.setRTLTextPlugin,Map:Map,NavigationControl:NavigationControl,GeolocateControl:GeolocateControl,AttributionControl:AttributionControl,ScaleControl:ScaleControl,FullscreenControl:FullscreenControl,Popup:Popup,Marker:Marker,Style:Style,LngLat:LngLat,LngLatBounds:LngLatBounds,Point:Point,Evented:Evented,config:config,get accessToken(){return config.ACCESS_TOKEN},set accessToken(o){config.ACCESS_TOKEN=o}}},{"../package.json":38,"./geo/lng_lat":62,"./geo/lng_lat_bounds":63,"./source/rtl_text_plugin":109,"./style/style":190,"./ui/control/attribution_control":232,"./ui/control/fullscreen_control":233,"./ui/control/geolocate_control":234,"./ui/control/navigation_control":236,"./ui/control/scale_control":237,"./ui/map":247,"./ui/marker":248,"./ui/popup":249,"./util/browser":252,"./util/config":256,"./util/evented":260,"@mapbox/mapbox-gl-supported":3,"@mapbox/point-geometry":4}],74:[function(_dereq_,module,exports){var pattern=_dereq_("./pattern"),StencilMode=_dereq_("../gl/stencil_mode"),DepthMode=_dereq_("../gl/depth_mode");module.exports=function drawBackground(e,t,r){var a=r.paint.get("background-color"),n=r.paint.get("background-opacity");if(0!==n){var o=e.context,i=o.gl,d=e.transform,u=d.tileSize,l=r.paint.get("background-pattern"),s=l||1!==a.a||1!==n?"translucent":"opaque";if(e.renderPass===s){var p;if(o.setStencilMode(StencilMode.disabled),o.setDepthMode(e.depthModeForSublayer(0,"opaque"===s?DepthMode.ReadWrite:DepthMode.ReadOnly)),o.setColorMode(e.colorModeForRenderPass()),l){if(pattern.isPatternMissing(l,e))return;p=e.useProgram("backgroundPattern"),pattern.prepare(l,e,p),e.tileExtentPatternVAO.bind(o,p,e.tileExtentBuffer,[])}else p=e.useProgram("background"),i.uniform4fv(p.uniforms.u_color,[a.r,a.g,a.b,a.a]),e.tileExtentVAO.bind(o,p,e.tileExtentBuffer,[]);i.uniform1f(p.uniforms.u_opacity,n);for(var f=0,g=d.coveringTiles({tileSize:u});f<g.length;f+=1){var m=g[f];l&&pattern.setTile({tileID:m,tileSize:u},e,p),i.uniformMatrix4fv(p.uniforms.u_matrix,!1,e.transform.calculatePosMatrix(m.toUnwrapped())),i.drawArrays(i.TRIANGLE_STRIP,0,e.tileExtentBuffer.length)}}}}},{"../gl/depth_mode":67,"../gl/stencil_mode":70,"./pattern":91}],75:[function(_dereq_,module,exports){var pixelsToTileUnits=_dereq_("../source/pixels_to_tile_units"),StencilMode=_dereq_("../gl/stencil_mode"),DepthMode=_dereq_("../gl/depth_mode");module.exports=function drawCircles(e,t,r,i){if("translucent"===e.renderPass){var o=r.paint.get("circle-opacity"),a=r.paint.get("circle-stroke-width"),n=r.paint.get("circle-stroke-opacity");if(0!==o.constantOr(1)||0!==a.constantOr(1)&&0!==n.constantOr(1)){var s=e.context,c=s.gl;s.setDepthMode(e.depthModeForSublayer(0,DepthMode.ReadOnly)),s.setStencilMode(StencilMode.disabled),s.setColorMode(e.colorModeForRenderPass());for(var l=!0,m=0;m<i.length;m++){var u=i[m],f=t.getTile(u),p=f.getBucket(r);if(p){var d=e.context.program.get(),_=p.programConfigurations.get(r.id),g=e.useProgram("circle",_);if((l||g.program!==d)&&(_.setUniforms(s,g,r.paint,{zoom:e.transform.zoom}),l=!1),c.uniform1f(g.uniforms.u_camera_to_center_distance,e.transform.cameraToCenterDistance),c.uniform1i(g.uniforms.u_scale_with_map,"map"===r.paint.get("circle-pitch-scale")?1:0),"map"===r.paint.get("circle-pitch-alignment")){c.uniform1i(g.uniforms.u_pitch_with_map,1);var h=pixelsToTileUnits(f,1,e.transform.zoom);c.uniform2f(g.uniforms.u_extrude_scale,h,h)}else c.uniform1i(g.uniforms.u_pitch_with_map,0),c.uniform2fv(g.uniforms.u_extrude_scale,e.transform.pixelsToGLUnits);c.uniformMatrix4fv(g.uniforms.u_matrix,!1,e.translatePosMatrix(u.posMatrix,f,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor"))),g.draw(s,c.TRIANGLES,r.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,_)}}}}}},{"../gl/depth_mode":67,"../gl/stencil_mode":70,"../source/pixels_to_tile_units":104}],76:[function(_dereq_,module,exports){function drawCollisionDebugGeometry(e,o,i,r,t){var l=e.context,s=l.gl,n=t?e.useProgram("collisionCircle"):e.useProgram("collisionBox");l.setDepthMode(DepthMode.disabled),l.setStencilMode(StencilMode.disabled),l.setColorMode(e.colorModeForRenderPass());for(var u=0;u<r.length;u++){var a=r[u],d=o.getTile(a),f=d.getBucket(i);if(f){var m=t?f.collisionCircle:f.collisionBox;if(m){s.uniformMatrix4fv(n.uniforms.u_matrix,!1,a.posMatrix),t||l.lineWidth.set(1),s.uniform1f(n.uniforms.u_camera_to_center_distance,e.transform.cameraToCenterDistance);var c=pixelsToTileUnits(d,1,e.transform.zoom),x=Math.pow(2,e.transform.zoom-d.tileID.overscaledZ);s.uniform1f(n.uniforms.u_pixels_to_tile_units,c),s.uniform2f(n.uniforms.u_extrude_scale,e.transform.pixelsToGLUnits[0]/(c*x),e.transform.pixelsToGLUnits[1]/(c*x)),n.draw(l,t?s.TRIANGLES:s.LINES,i.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,null,m.collisionVertexBuffer,null)}}}}var pixelsToTileUnits=_dereq_("../source/pixels_to_tile_units"),DepthMode=_dereq_("../gl/depth_mode"),StencilMode=_dereq_("../gl/stencil_mode");module.exports=function drawCollisionDebug(e,o,i,r){drawCollisionDebugGeometry(e,o,i,r,!1),drawCollisionDebugGeometry(e,o,i,r,!0)}},{"../gl/depth_mode":67,"../gl/stencil_mode":70,"../source/pixels_to_tile_units":104}],77:[function(_dereq_,module,exports){function drawDebugTile(e,r,t){var o=e.context,a=o.gl;o.lineWidth.set(1*browser.devicePixelRatio);var i=t.posMatrix,u=e.useProgram("debug");o.setDepthMode(DepthMode.disabled),o.setStencilMode(StencilMode.disabled),o.setColorMode(e.colorModeForRenderPass()),a.uniformMatrix4fv(u.uniforms.u_matrix,!1,i),a.uniform4f(u.uniforms.u_color,1,0,0,1),e.debugVAO.bind(o,u,e.debugBuffer,[]),a.drawArrays(a.LINE_STRIP,0,e.debugBuffer.length);for(var n=function createTextVerticies(e,r,t,o){o=o||1;var a,i,u,n,s,l,d,f,m=[];for(a=0,i=e.length;a<i;a++)if(s=simplexFont[e[a]]){for(f=null,u=0,n=s[1].length;u<n;u+=2)-1===s[1][u]&&-1===s[1][u+1]?f=null:(l=r+s[1][u]*o,d=t-s[1][u+1]*o,f&&m.push(f.x,f.y,l,d),f={x:l,y:d});r+=s[0]*o}return m}(t.toString(),50,200,5),s=new PosArray,l=0;l<n.length;l+=2)s.emplaceBack(n[l],n[l+1]);var d=o.createVertexBuffer(s,posAttributes.members);(new VertexArrayObject).bind(o,u,d,[]),a.uniform4f(u.uniforms.u_color,1,1,1,1);for(var f=r.getTile(t).tileSize,m=EXTENT/(Math.pow(2,e.transform.zoom-t.overscaledZ)*f),c=[[-1,-1],[-1,1],[1,-1],[1,1]],b=0;b<c.length;b++){var g=c[b];a.uniformMatrix4fv(u.uniforms.u_matrix,!1,mat4.translate([],i,[m*g[0],m*g[1],0])),a.drawArrays(a.LINES,0,d.length)}a.uniform4f(u.uniforms.u_color,0,0,0,1),a.uniformMatrix4fv(u.uniforms.u_matrix,!1,i),a.drawArrays(a.LINES,0,d.length)}var browser=_dereq_("../util/browser"),mat4=_dereq_("@mapbox/gl-matrix").mat4,EXTENT=_dereq_("../data/extent"),VertexArrayObject=_dereq_("./vertex_array_object"),PosArray=_dereq_("../data/array_types").PosArray,posAttributes=_dereq_("../data/pos_attributes"),DepthMode=_dereq_("../gl/depth_mode"),StencilMode=_dereq_("../gl/stencil_mode");module.exports=function drawDebug(e,r,t){for(var o=0;o<t.length;o++)drawDebugTile(e,r,t[o])};var simplexFont={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]}},{"../data/array_types":39,"../data/extent":53,"../data/pos_attributes":57,"../gl/depth_mode":67,"../gl/stencil_mode":70,"../util/browser":252,"./vertex_array_object":95,"@mapbox/gl-matrix":2}],78:[function(_dereq_,module,exports){function drawFillTiles(t,e,r,o,a){if(!pattern.isPatternMissing(r.paint.get("fill-pattern"),t))for(var i=!0,n=0,l=o;n<l.length;n+=1){var s=l[n],p=e.getTile(s),d=p.getBucket(r);d&&(t.context.setStencilMode(t.stencilModeForClipping(s)),a(t,e,r,p,s,d,i),i=!1)}}function drawFillTile(t,e,r,o,a,i,n){var l=t.context.gl,s=i.programConfigurations.get(r.id);setFillProgram("fill",r.paint.get("fill-pattern"),t,s,r,o,a,n).draw(t.context,l.TRIANGLES,r.id,i.layoutVertexBuffer,i.indexBuffer,i.segments,s)}function drawStrokeTile(t,e,r,o,a,i,n){var l=t.context.gl,s=i.programConfigurations.get(r.id),d=setFillProgram("fillOutline",r.getPaintProperty("fill-outline-color")?null:r.paint.get("fill-pattern"),t,s,r,o,a,n);l.uniform2f(d.uniforms.u_world,l.drawingBufferWidth,l.drawingBufferHeight),d.draw(t.context,l.LINES,r.id,i.layoutVertexBuffer,i.indexBuffer2,i.segments2,s)}function setFillProgram(t,e,r,o,a,i,n,l){var s,p=r.context.program.get();return e?(s=r.useProgram(t+"Pattern",o),(l||s.program!==p)&&(o.setUniforms(r.context,s,a.paint,{zoom:r.transform.zoom}),pattern.prepare(e,r,s)),pattern.setTile(i,r,s)):(s=r.useProgram(t,o),(l||s.program!==p)&&o.setUniforms(r.context,s,a.paint,{zoom:r.transform.zoom})),r.context.gl.uniformMatrix4fv(s.uniforms.u_matrix,!1,r.translatePosMatrix(n.posMatrix,i,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"))),s}var pattern=_dereq_("./pattern"),Color=_dereq_("../style-spec/util/color"),DepthMode=_dereq_("../gl/depth_mode");module.exports=function drawFill(t,e,r,o){var a=r.paint.get("fill-color"),i=r.paint.get("fill-opacity");if(0!==i.constantOr(1)){var n=t.context;n.setColorMode(t.colorModeForRenderPass());var l=r.paint.get("fill-pattern")||1!==a.constantOr(Color.transparent).a||1!==i.constantOr(0)?"translucent":"opaque";t.renderPass===l&&(n.setDepthMode(t.depthModeForSublayer(1,"opaque"===t.renderPass?DepthMode.ReadWrite:DepthMode.ReadOnly)),drawFillTiles(t,e,r,o,drawFillTile)),"translucent"===t.renderPass&&r.paint.get("fill-antialias")&&(n.lineWidth.set(2),n.setDepthMode(t.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,DepthMode.ReadOnly)),drawFillTiles(t,e,r,o,drawStrokeTile))}}},{"../gl/depth_mode":67,"../style-spec/util/color":153,"./pattern":91}],79:[function(_dereq_,module,exports){function drawExtrusion(e,t,r,i,o,a,n){var s=e.context,u=s.gl,f=r.paint.get("fill-extrusion-pattern"),l=e.context.program.get(),d=a.programConfigurations.get(r.id),m=e.useProgram(f?"fillExtrusionPattern":"fillExtrusion",d);if((n||m.program!==l)&&d.setUniforms(s,m,r.paint,{zoom:e.transform.zoom}),f){if(pattern.isPatternMissing(f,e))return;pattern.prepare(f,e,m),pattern.setTile(i,e,m),u.uniform1f(m.uniforms.u_height_factor,-Math.pow(2,o.overscaledZ)/i.tileSize/8)}e.context.gl.uniformMatrix4fv(m.uniforms.u_matrix,!1,e.translatePosMatrix(o.posMatrix,i,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor"))),function setLight(e,t){var r=t.context.gl,i=t.style.light,o=i.properties.get("position"),a=[o.x,o.y,o.z],n=mat3.create();"viewport"===i.properties.get("anchor")&&mat3.fromRotation(n,-t.transform.angle),vec3.transformMat3(a,a,n);var s=i.properties.get("color");r.uniform3fv(e.uniforms.u_lightpos,a),r.uniform1f(e.uniforms.u_lightintensity,i.properties.get("intensity")),r.uniform3f(e.uniforms.u_lightcolor,s.r,s.g,s.b)}(m,e),m.draw(s,u.TRIANGLES,r.id,a.layoutVertexBuffer,a.indexBuffer,a.segments,d)}var glMatrix=_dereq_("@mapbox/gl-matrix"),pattern=_dereq_("./pattern"),Texture=_dereq_("./texture"),Color=_dereq_("../style-spec/util/color"),DepthMode=_dereq_("../gl/depth_mode"),mat3=glMatrix.mat3,mat4=glMatrix.mat4,vec3=glMatrix.vec3,StencilMode=_dereq_("../gl/stencil_mode");module.exports=function draw(e,t,r,i){if(0!==r.paint.get("fill-extrusion-opacity"))if("offscreen"===e.renderPass){!function drawToExtrusionFramebuffer(e,t){var r=e.context,i=r.gl,o=t.viewportFrame;if(e.depthRboNeedsClear&&e.setupOffscreenDepthRenderbuffer(),!o){var a=new Texture(r,{width:e.width,height:e.height,data:null},i.RGBA);a.bind(i.LINEAR,i.CLAMP_TO_EDGE),(o=t.viewportFrame=r.createFramebuffer(e.width,e.height)).colorAttachment.set(a.texture)}r.bindFramebuffer.set(o.framebuffer),o.depthAttachment.set(e.depthRbo),e.depthRboNeedsClear&&(r.clear({depth:1}),e.depthRboNeedsClear=!1),r.clear({color:Color.transparent}),r.setStencilMode(StencilMode.disabled),r.setDepthMode(new DepthMode(i.LEQUAL,DepthMode.ReadWrite,[0,1])),r.setColorMode(e.colorModeForRenderPass())}(e,r);for(var o=!0,a=0,n=i;a<n.length;a+=1){var s=n[a],u=t.getTile(s),f=u.getBucket(r);f&&(drawExtrusion(e,0,r,u,s,f,o),o=!1)}}else"translucent"===e.renderPass&&function drawExtrusionTexture(e,t){var r=t.viewportFrame;if(r){var i=e.context,o=i.gl,a=e.useProgram("extrusionTexture");i.setStencilMode(StencilMode.disabled),i.setDepthMode(DepthMode.disabled),i.setColorMode(e.colorModeForRenderPass()),i.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,r.colorAttachment.get()),o.uniform1f(a.uniforms.u_opacity,t.paint.get("fill-extrusion-opacity")),o.uniform1i(a.uniforms.u_image,0);var n=mat4.create();mat4.ortho(n,0,e.width,e.height,0,0,1),o.uniformMatrix4fv(a.uniforms.u_matrix,!1,n),o.uniform2f(a.uniforms.u_world,o.drawingBufferWidth,o.drawingBufferHeight),e.viewportVAO.bind(i,a,e.viewportBuffer,[]),o.drawArrays(o.TRIANGLE_STRIP,0,4)}}(e,r)}},{"../gl/depth_mode":67,"../gl/stencil_mode":70,"../style-spec/util/color":153,"./pattern":91,"./texture":93,"@mapbox/gl-matrix":2}],80:[function(_dereq_,module,exports){var mat4=_dereq_("@mapbox/gl-matrix").mat4,Texture=_dereq_("./texture"),pixelsToTileUnits=_dereq_("../source/pixels_to_tile_units"),Color=_dereq_("../style-spec/util/color"),DepthMode=_dereq_("../gl/depth_mode"),StencilMode=_dereq_("../gl/stencil_mode"),ColorMode=_dereq_("../gl/color_mode");module.exports=function drawHeatmap(e,t,r,o){if(0!==r.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){var a=e.context,i=a.gl;a.setDepthMode(e.depthModeForSublayer(0,DepthMode.ReadOnly)),a.setStencilMode(StencilMode.disabled),function bindFramebuffer(e,t,r){var o=e.gl;e.activeTexture.set(o.TEXTURE1),e.viewport.set([0,0,t.width/4,t.height/4]);var a=r.heatmapFbo;if(a)o.bindTexture(o.TEXTURE_2D,a.colorAttachment.get()),e.bindFramebuffer.set(a.framebuffer);else{var i=o.createTexture();o.bindTexture(o.TEXTURE_2D,i),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),a=r.heatmapFbo=e.createFramebuffer(t.width/4,t.height/4),function bindTextureToFramebuffer(e,t,r,o){var a=e.gl;a.texImage2D(a.TEXTURE_2D,0,a.RGBA,t.width/4,t.height/4,0,a.RGBA,e.extTextureHalfFloat?e.extTextureHalfFloat.HALF_FLOAT_OES:a.UNSIGNED_BYTE,null),o.colorAttachment.set(r),e.extTextureHalfFloat&&a.checkFramebufferStatus(a.FRAMEBUFFER)!==a.FRAMEBUFFER_COMPLETE&&(e.extTextureHalfFloat=null,o.colorAttachment.setDirty(),bindTextureToFramebuffer(e,t,r,o))}(e,t,i,a)}}(a,e,r),a.clear({color:Color.transparent}),a.setColorMode(new ColorMode([i.ONE,i.ONE],Color.transparent,[!0,!0,!0,!0]));for(var n=!0,u=0;u<o.length;u++){var T=o[u];if(!t.hasRenderableParent(T)){var f=t.getTile(T),m=f.getBucket(r);if(m){var l=e.context.program.get(),s=m.programConfigurations.get(r.id),d=e.useProgram("heatmap",s),x=e.transform.zoom;(n||d.program!==l)&&(s.setUniforms(e.context,d,r.paint,{zoom:x}),n=!1),i.uniform1f(d.uniforms.u_extrude_scale,pixelsToTileUnits(f,1,x)),i.uniform1f(d.uniforms.u_intensity,r.paint.get("heatmap-intensity")),i.uniformMatrix4fv(d.uniforms.u_matrix,!1,T.posMatrix),d.draw(a,i.TRIANGLES,r.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,s)}}}a.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function renderTextureToMap(e,t){var r=e.context,o=r.gl,a=t.heatmapFbo;if(a){r.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,a.colorAttachment.get()),r.activeTexture.set(o.TEXTURE1);var i=t.colorRampTexture;i||(i=t.colorRampTexture=new Texture(r,t.colorRamp,o.RGBA)),i.bind(o.LINEAR,o.CLAMP_TO_EDGE),r.setDepthMode(DepthMode.disabled);var n=e.useProgram("heatmapTexture"),u=t.paint.get("heatmap-opacity");o.uniform1f(n.uniforms.u_opacity,u),o.uniform1i(n.uniforms.u_image,0),o.uniform1i(n.uniforms.u_color_ramp,1);var T=mat4.create();mat4.ortho(T,0,e.width,e.height,0,0,1),o.uniformMatrix4fv(n.uniforms.u_matrix,!1,T),o.uniform2f(n.uniforms.u_world,o.drawingBufferWidth,o.drawingBufferHeight),e.viewportVAO.bind(e.context,n,e.viewportBuffer,[]),o.drawArrays(o.TRIANGLE_STRIP,0,4)}}(e,r))}},{"../gl/color_mode":65,"../gl/depth_mode":67,"../gl/stencil_mode":70,"../source/pixels_to_tile_units":104,"../style-spec/util/color":153,"./texture":93,"@mapbox/gl-matrix":2}],81:[function(_dereq_,module,exports){function renderHillshade(e,r,t){var a=e.context,i=a.gl,n=r.fbo;if(n){var o=e.useProgram("hillshade"),s=e.transform.calculatePosMatrix(r.tileID.toUnwrapped());!function setLight(e,r,t){var a=t.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===t.paint.get("hillshade-illumination-anchor")&&(a-=r.transform.angle),r.context.gl.uniform2f(e.uniforms.u_light,t.paint.get("hillshade-exaggeration"),a)}(o,e,t);var d=function getTileLatRange(e,r){var t=r.toCoordinate(),a=new Coordinate(t.column,t.row+1,t.zoom);return[e.transform.coordinateLocation(t).lat,e.transform.coordinateLocation(a).lat]}(e,r.tileID);a.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,n.colorAttachment.get()),i.uniformMatrix4fv(o.uniforms.u_matrix,!1,s),i.uniform2fv(o.uniforms.u_latrange,d),i.uniform1i(o.uniforms.u_image,0);var l=t.paint.get("hillshade-shadow-color");i.uniform4f(o.uniforms.u_shadow,l.r,l.g,l.b,l.a);var u=t.paint.get("hillshade-highlight-color");i.uniform4f(o.uniforms.u_highlight,u.r,u.g,u.b,u.a);var f=t.paint.get("hillshade-accent-color");if(i.uniform4f(o.uniforms.u_accent,f.r,f.g,f.b,f.a),r.maskedBoundsBuffer&&r.maskedIndexBuffer&&r.segments)o.draw(a,i.TRIANGLES,t.id,r.maskedBoundsBuffer,r.maskedIndexBuffer,r.segments);else{var m=e.rasterBoundsBuffer;e.rasterBoundsVAO.bind(a,o,m,[]),i.drawArrays(i.TRIANGLE_STRIP,0,m.length)}}}function prepareHillshade(e,r){var t=e.context,a=t.gl;if(r.dem&&r.dem.level){var i=r.dem.level.dim,n=r.dem.getPixels();if(t.activeTexture.set(a.TEXTURE1),t.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||e.getTileTexture(r.tileSize),r.demTexture){var o=r.demTexture;o.update(n,!1),o.bind(a.NEAREST,a.CLAMP_TO_EDGE)}else r.demTexture=new Texture(t,n,a.RGBA,!1),r.demTexture.bind(a.NEAREST,a.CLAMP_TO_EDGE);t.activeTexture.set(a.TEXTURE0);var s=r.fbo;if(!s){var d=new Texture(t,{width:i,height:i,data:null},a.RGBA);d.bind(a.LINEAR,a.CLAMP_TO_EDGE),(s=r.fbo=t.createFramebuffer(i,i)).colorAttachment.set(d.texture)}t.bindFramebuffer.set(s.framebuffer),t.viewport.set([0,0,i,i]);var l=mat4.create();mat4.ortho(l,0,EXTENT,-EXTENT,0,0,1),mat4.translate(l,l,[0,-EXTENT,0]);var u=e.useProgram("hillshadePrepare");a.uniformMatrix4fv(u.uniforms.u_matrix,!1,l),a.uniform1f(u.uniforms.u_zoom,r.tileID.overscaledZ),a.uniform2fv(u.uniforms.u_dimension,[2*i,2*i]),a.uniform1i(u.uniforms.u_image,1);var f=e.rasterBoundsBuffer;e.rasterBoundsVAO.bind(t,u,f,[]),a.drawArrays(a.TRIANGLE_STRIP,0,f.length),r.needsHillshadePrepare=!1}}var Coordinate=_dereq_("../geo/coordinate"),Texture=_dereq_("./texture"),EXTENT=_dereq_("../data/extent"),mat4=_dereq_("@mapbox/gl-matrix").mat4,StencilMode=_dereq_("../gl/stencil_mode"),DepthMode=_dereq_("../gl/depth_mode");module.exports=function drawHillshade(e,r,t,a){if("offscreen"===e.renderPass||"translucent"===e.renderPass){var i=e.context;i.setDepthMode(e.depthModeForSublayer(0,DepthMode.ReadOnly)),i.setStencilMode(StencilMode.disabled),i.setColorMode(e.colorModeForRenderPass());for(var n=0,o=a;n<o.length;n+=1){var s=o[n],d=r.getTile(s);d.needsHillshadePrepare&&"offscreen"===e.renderPass?prepareHillshade(e,d):"translucent"===e.renderPass&&renderHillshade(e,d,t)}i.viewport.set([0,0,e.width,e.height])}}},{"../data/extent":53,"../geo/coordinate":61,"../gl/depth_mode":67,"../gl/stencil_mode":70,"./texture":93,"@mapbox/gl-matrix":2}],82:[function(_dereq_,module,exports){function drawLineTile(e,i,t,r,n,a,o,s,u){var f,l,m,p,_=i.context,g=_.gl,d=n.paint.get("line-dasharray"),c=n.paint.get("line-pattern");if(s||u){var x=1/pixelsToTileUnits(t,1,i.transform.tileZoom);if(d){f=i.lineAtlas.getDash(d.from,"round"===n.layout.get("line-cap")),l=i.lineAtlas.getDash(d.to,"round"===n.layout.get("line-cap"));var h=f.width*d.fromScale,v=l.width*d.toScale;g.uniform2f(e.uniforms.u_patternscale_a,x/h,-f.height/2),g.uniform2f(e.uniforms.u_patternscale_b,x/v,-l.height/2),g.uniform1f(e.uniforms.u_sdfgamma,i.lineAtlas.width/(256*Math.min(h,v)*browser.devicePixelRatio)/2)}else if(c){if(m=i.imageManager.getPattern(c.from),p=i.imageManager.getPattern(c.to),!m||!p)return;g.uniform2f(e.uniforms.u_pattern_size_a,m.displaySize[0]*c.fromScale/x,p.displaySize[1]),g.uniform2f(e.uniforms.u_pattern_size_b,p.displaySize[0]*c.toScale/x,p.displaySize[1]);var T=i.imageManager.getPixelSize(),y=T.width,M=T.height;g.uniform2fv(e.uniforms.u_texsize,[y,M])}g.uniform2f(e.uniforms.u_gl_units_to_pixels,1/i.transform.pixelsToGLUnits[0],1/i.transform.pixelsToGLUnits[1])}s&&(d?(g.uniform1i(e.uniforms.u_image,0),_.activeTexture.set(g.TEXTURE0),i.lineAtlas.bind(_),g.uniform1f(e.uniforms.u_tex_y_a,f.y),g.uniform1f(e.uniforms.u_tex_y_b,l.y),g.uniform1f(e.uniforms.u_mix,d.t)):c&&(g.uniform1i(e.uniforms.u_image,0),_.activeTexture.set(g.TEXTURE0),i.imageManager.bind(_),g.uniform2fv(e.uniforms.u_pattern_tl_a,m.tl),g.uniform2fv(e.uniforms.u_pattern_br_a,m.br),g.uniform2fv(e.uniforms.u_pattern_tl_b,p.tl),g.uniform2fv(e.uniforms.u_pattern_br_b,p.br),g.uniform1f(e.uniforms.u_fade,c.t))),_.setStencilMode(i.stencilModeForClipping(a));var b=i.translatePosMatrix(a.posMatrix,t,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"));g.uniformMatrix4fv(e.uniforms.u_matrix,!1,b),g.uniform1f(e.uniforms.u_ratio,1/pixelsToTileUnits(t,1,i.transform.zoom)),e.draw(_,g.TRIANGLES,n.id,r.layoutVertexBuffer,r.indexBuffer,r.segments,o)}var browser=_dereq_("../util/browser"),pixelsToTileUnits=_dereq_("../source/pixels_to_tile_units"),DepthMode=_dereq_("../gl/depth_mode");module.exports=function(e,i,t,r){if("translucent"===e.renderPass&&0!==t.paint.get("line-opacity").constantOr(1)){var n=e.context;n.setDepthMode(e.depthModeForSublayer(0,DepthMode.ReadOnly)),n.setColorMode(e.colorModeForRenderPass());for(var a,o=t.paint.get("line-dasharray")?"lineSDF":t.paint.get("line-pattern")?"linePattern":"line",s=!0,u=0,f=r;u<f.length;u+=1){var l=f[u],m=i.getTile(l),p=m.getBucket(t);if(p){var _=p.programConfigurations.get(t.id),g=e.context.program.get(),d=e.useProgram(o,_),c=s||d.program!==g,x=a!==m.tileID.overscaledZ;c&&_.setUniforms(e.context,d,t.paint,{zoom:e.transform.zoom}),drawLineTile(d,e,m,p,t,l,_,c,x),a=m.tileID.overscaledZ,s=!1}}}}},{"../gl/depth_mode":67,"../source/pixels_to_tile_units":104,"../util/browser":252}],83:[function(_dereq_,module,exports){function getFadeValues(e,r,t,a,i){var o=a.paint.get("raster-fade-duration");if(o>0){var n=browser.now(),s=(n-e.timeAdded)/o,u=r?(n-r.timeAdded)/o:-1,d=t.getSource(),f=i.coveringZoomLevel({tileSize:d.tileSize,roundZoom:d.roundZoom}),c=!r||Math.abs(r.tileID.overscaledZ-f)>Math.abs(e.tileID.overscaledZ-f),m=c&&e.refreshedUponExpiration?1:util.clamp(c?s:1-u,0,1);return e.refreshedUponExpiration&&s>=1&&(e.refreshedUponExpiration=!1),r?{opacity:1,mix:1-m}:{opacity:m,mix:0}}return{opacity:1,mix:0}}var util=_dereq_("../util/util"),ImageSource=_dereq_("../source/image_source"),browser=_dereq_("../util/browser"),StencilMode=_dereq_("../gl/stencil_mode"),DepthMode=_dereq_("../gl/depth_mode");module.exports=function drawRaster(e,r,t,a){if("translucent"===e.renderPass&&0!==t.paint.get("raster-opacity")){var i=e.context,o=i.gl,n=r.getSource(),s=e.useProgram("raster");i.setStencilMode(StencilMode.disabled),i.setColorMode(e.colorModeForRenderPass()),o.uniform1f(s.uniforms.u_brightness_low,t.paint.get("raster-brightness-min")),o.uniform1f(s.uniforms.u_brightness_high,t.paint.get("raster-brightness-max")),o.uniform1f(s.uniforms.u_saturation_factor,function saturationFactor(e){return e>0?1-1/(1.001-e):-e}(t.paint.get("raster-saturation"))),o.uniform1f(s.uniforms.u_contrast_factor,function contrastFactor(e){return e>0?1/(1-e):1+e}(t.paint.get("raster-contrast"))),o.uniform3fv(s.uniforms.u_spin_weights,function spinWeights(e){e*=Math.PI/180;var r=Math.sin(e),t=Math.cos(e);return[(2*t+1)/3,(-Math.sqrt(3)*r-t+1)/3,(Math.sqrt(3)*r-t+1)/3]}(t.paint.get("raster-hue-rotate"))),o.uniform1f(s.uniforms.u_buffer_scale,1),o.uniform1i(s.uniforms.u_image0,0),o.uniform1i(s.uniforms.u_image1,1);for(var u=a.length&&a[0].overscaledZ,d=0,f=a;d<f.length;d+=1){var c=f[d];i.setDepthMode(e.depthModeForSublayer(c.overscaledZ-u,1===t.paint.get("raster-opacity")?DepthMode.ReadWrite:DepthMode.ReadOnly,o.LESS));var m=r.getTile(c),l=e.transform.calculatePosMatrix(c.toUnwrapped(),!0);m.registerFadeDuration(t.paint.get("raster-fade-duration")),o.uniformMatrix4fv(s.uniforms.u_matrix,!1,l);var g=r.findLoadedParent(c,0,{}),p=getFadeValues(m,g,r,t,e.transform),_=void 0,h=void 0;if(i.activeTexture.set(o.TEXTURE0),m.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),i.activeTexture.set(o.TEXTURE1),g?(g.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),_=Math.pow(2,g.tileID.overscaledZ-m.tileID.overscaledZ),h=[m.tileID.canonical.x*_%1,m.tileID.canonical.y*_%1]):m.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),o.uniform2fv(s.uniforms.u_tl_parent,h||[0,0]),o.uniform1f(s.uniforms.u_scale_parent,_||1),o.uniform1f(s.uniforms.u_fade_t,p.mix),o.uniform1f(s.uniforms.u_opacity,p.opacity*t.paint.get("raster-opacity")),n instanceof ImageSource){var E=n.boundsBuffer;n.boundsVAO.bind(i,s,E,[]),o.drawArrays(o.TRIANGLE_STRIP,0,E.length)}else if(m.maskedBoundsBuffer&&m.maskedIndexBuffer&&m.segments)s.draw(i,o.TRIANGLES,t.id,m.maskedBoundsBuffer,m.maskedIndexBuffer,m.segments);else{var M=e.rasterBoundsBuffer;e.rasterBoundsVAO.bind(i,s,M,[]),o.drawArrays(o.TRIANGLE_STRIP,0,M.length)}}}}},{"../gl/depth_mode":67,"../gl/stencil_mode":70,"../source/image_source":102,"../util/browser":252,"../util/util":275}],84:[function(_dereq_,module,exports){function drawLayerSymbols(t,e,o,i,r,n,a,s,u,l){var m=t.context,f=m.gl,c=t.transform,y="map"===s,p="map"===u,_=y&&"line"===o.layout.get("symbol-placement"),d=y&&!p&&!_,g=p;m.setDepthMode(g?t.depthModeForSublayer(0,DepthMode.ReadOnly):DepthMode.disabled);for(var x,b=0,h=i;b<h.length;b+=1){var S=h[b],M=e.getTile(S),z=M.getBucket(o);if(z){var T=r?z.text:z.icon;if(T&&T.segments.get().length){var v=T.programConfigurations.get(o.id),w=r||z.sdfIcons,D=r?z.textSizeData:z.iconSizeData;if(x||(x=t.useProgram(w?"symbolSDF":"symbolIcon",v),v.setUniforms(t.context,x,o.paint,{zoom:t.transform.zoom}),setSymbolDrawState(x,t,o,r,d,p,D)),m.activeTexture.set(f.TEXTURE0),f.uniform1i(x.uniforms.u_texture,0),r)M.glyphAtlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE),f.uniform2fv(x.uniforms.u_texsize,M.glyphAtlasTexture.size);else{var L=1!==o.layout.get("icon-size").constantOr(0)||z.iconsNeedLinear,P=p||0!==c.pitch;M.iconAtlasTexture.bind(w||t.options.rotating||t.options.zooming||L||P?f.LINEAR:f.NEAREST,f.CLAMP_TO_EDGE),f.uniform2fv(x.uniforms.u_texsize,M.iconAtlasTexture.size)}f.uniformMatrix4fv(x.uniforms.u_matrix,!1,t.translatePosMatrix(S.posMatrix,M,n,a));var E=pixelsToTileUnits(M,1,t.transform.zoom),C=symbolProjection.getLabelPlaneMatrix(S.posMatrix,p,y,t.transform,E),A=symbolProjection.getGlCoordMatrix(S.posMatrix,p,y,t.transform,E);f.uniformMatrix4fv(x.uniforms.u_gl_coord_matrix,!1,t.translatePosMatrix(A,M,n,a,!0)),_?(f.uniformMatrix4fv(x.uniforms.u_label_plane_matrix,!1,identityMat4),symbolProjection.updateLineLabels(z,S.posMatrix,t,r,C,A,p,l)):f.uniformMatrix4fv(x.uniforms.u_label_plane_matrix,!1,C),f.uniform1f(x.uniforms.u_fade_change,t.options.fadeDuration?t.symbolFadeChange:1),drawTileSymbols(x,v,t,o,M,T,r,w,p)}}}}function setSymbolDrawState(t,e,o,i,r,n,a){var s=e.context.gl,u=e.transform;s.uniform1i(t.uniforms.u_pitch_with_map,n?1:0),s.uniform1f(t.uniforms.u_is_text,i?1:0),s.uniform1f(t.uniforms.u_pitch,u.pitch/360*2*Math.PI);var l="constant"===a.functionType||"source"===a.functionType,m="constant"===a.functionType||"camera"===a.functionType;s.uniform1i(t.uniforms.u_is_size_zoom_constant,l?1:0),s.uniform1i(t.uniforms.u_is_size_feature_constant,m?1:0),s.uniform1f(t.uniforms.u_camera_to_center_distance,u.cameraToCenterDistance);var f=symbolSize.evaluateSizeForZoom(a,u.zoom,symbolLayoutProperties.properties[i?"text-size":"icon-size"]);void 0!==f.uSizeT&&s.uniform1f(t.uniforms.u_size_t,f.uSizeT),void 0!==f.uSize&&s.uniform1f(t.uniforms.u_size,f.uSize),s.uniform1f(t.uniforms.u_aspect_ratio,u.width/u.height),s.uniform1i(t.uniforms.u_rotate_symbol,r?1:0)}function drawTileSymbols(t,e,o,i,r,n,a,s,u){var l=o.context,m=l.gl,f=o.transform;if(s){var c=0!==i.paint.get(a?"text-halo-width":"icon-halo-width").constantOr(1),y=u?Math.cos(f._pitch)*f.cameraToCenterDistance:1;m.uniform1f(t.uniforms.u_gamma_scale,y),c&&(m.uniform1f(t.uniforms.u_is_halo,1),drawSymbolElements(n,i,l,t)),m.uniform1f(t.uniforms.u_is_halo,0)}drawSymbolElements(n,i,l,t)}function drawSymbolElements(t,e,o,i){i.draw(o,o.gl.TRIANGLES,e.id,t.layoutVertexBuffer,t.indexBuffer,t.segments,t.programConfigurations.get(e.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}var drawCollisionDebug=_dereq_("./draw_collision_debug"),pixelsToTileUnits=_dereq_("../source/pixels_to_tile_units"),symbolProjection=_dereq_("../symbol/projection"),symbolSize=_dereq_("../symbol/symbol_size"),identityMat4=_dereq_("@mapbox/gl-matrix").mat4.identity(new Float32Array(16)),symbolLayoutProperties=_dereq_("../style/style_layer/symbol_style_layer_properties").layout,StencilMode=_dereq_("../gl/stencil_mode"),DepthMode=_dereq_("../gl/depth_mode");module.exports=function drawSymbols(t,e,o,i){if("translucent"===t.renderPass){var r=t.context;r.setStencilMode(StencilMode.disabled),r.setColorMode(t.colorModeForRenderPass()),0!==o.paint.get("icon-opacity").constantOr(1)&&drawLayerSymbols(t,e,o,i,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright")),0!==o.paint.get("text-opacity").constantOr(1)&&drawLayerSymbols(t,e,o,i,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright")),e.map.showCollisionBoxes&&drawCollisionDebug(t,e,o,i)}}},{"../gl/depth_mode":67,"../gl/stencil_mode":70,"../source/pixels_to_tile_units":104,"../style/style_layer/symbol_style_layer_properties":209,"../symbol/projection":224,"../symbol/symbol_size":228,"./draw_collision_debug":76,"@mapbox/gl-matrix":2}],85:[function(_dereq_,module,exports){var ShelfPack=_dereq_("@mapbox/shelf-pack"),AlphaImage=_dereq_("../util/image").AlphaImage,padding=1;module.exports={makeGlyphAtlas:function makeGlyphAtlas(a){var e=new AlphaImage({width:0,height:0}),i={},t=new ShelfPack(0,0,{autoResize:!0});for(var h in a){var r=a[h],p=i[h]={};for(var m in r){var d=r[+m];if(d&&0!==d.bitmap.width&&0!==d.bitmap.height){var g=t.packOne(d.bitmap.width+2*padding,d.bitmap.height+2*padding);e.resize({width:t.w,height:t.h}),AlphaImage.copy(d.bitmap,e,{x:0,y:0},{x:g.x+padding,y:g.y+padding},d.bitmap),p[m]={rect:g,metrics:d.metrics}}}}return t.shrink(),e.resize({width:t.w,height:t.h}),{image:e,positions:i}}}},{"../util/image":263,"@mapbox/shelf-pack":5}],86:[function(_dereq_,module,exports){var loadGlyphRange=_dereq_("../style/load_glyph_range"),TinySDF=_dereq_("@mapbox/tiny-sdf"),isChar=_dereq_("../util/is_char_in_unicode_block"),asyncAll=_dereq_("../util/util").asyncAll,AlphaImage=_dereq_("../util/image").AlphaImage,GlyphManager=function(e,r){this.requestTransform=e,this.localIdeographFontFamily=r,this.entries={}};GlyphManager.prototype.setURL=function(e){this.url=e},GlyphManager.prototype.getGlyphs=function(e,r){var i=this,t=[];for(var a in e)for(var l=0,n=e[a];l<n.length;l+=1){var s=n[l];t.push({stack:a,id:s})}asyncAll(t,function(e,r){var t=e.stack,a=e.id,l=i.entries[t];l||(l=i.entries[t]={glyphs:{},requests:{}});var n=l.glyphs[a];if(void 0===n)if(n=i._tinySDF(l,t,a))r(null,{stack:t,id:a,glyph:n});else{var s=Math.floor(a/256);if(256*s>65535)r(new Error("glyphs > 65535 not supported"));else{var o=l.requests[s];o||(o=l.requests[s]=[],loadGlyphRange(t,s,i.url,i.requestTransform,function(e,r){if(r)for(var i in r)l.glyphs[+i]=r[+i];for(var t=0,a=o;t<a.length;t+=1)(0,a[t])(e,r);delete l.requests[s]})),o.push(function(e,i){e?r(e):i&&r(null,{stack:t,id:a,glyph:i[a]||null})})}}else r(null,{stack:t,id:a,glyph:n})},function(e,i){if(e)r(e);else if(i){for(var t={},a=0,l=i;a<l.length;a+=1){var n=l[a],s=n.stack,o=n.id,h=n.glyph;(t[s]||(t[s]={}))[o]=h&&{id:h.id,bitmap:h.bitmap.clone(),metrics:h.metrics}}r(null,t)}})},GlyphManager.prototype._tinySDF=function(e,r,i){var t=this.localIdeographFontFamily;if(t&&(isChar["CJK Unified Ideographs"](i)||isChar["Hangul Syllables"](i))){var a=e.tinySDF;if(!a){var l="400";/bold/i.test(r)?l="900":/medium/i.test(r)?l="500":/light/i.test(r)&&(l="200"),a=e.tinySDF=new TinySDF(24,3,8,.25,t,l)}return{id:i,bitmap:new AlphaImage({width:30,height:30},a.draw(String.fromCharCode(i))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},module.exports=GlyphManager},{"../style/load_glyph_range":184,"../util/image":263,"../util/is_char_in_unicode_block":265,"../util/util":275,"@mapbox/tiny-sdf":6}],87:[function(_dereq_,module,exports){function imagePosition(a,i){var e=i.pixelRatio,t={x:a.x+padding,y:a.y+padding,w:a.w-2*padding,h:a.h-2*padding};return{pixelRatio:e,textureRect:t,tl:[t.x,t.y],br:[t.x+t.w,t.y+t.h],displaySize:[t.w/e,t.h/e]}}var ShelfPack=_dereq_("@mapbox/shelf-pack"),RGBAImage=_dereq_("../util/image").RGBAImage,padding=1;module.exports={imagePosition:imagePosition,makeImageAtlas:function makeImageAtlas(a){var i=new RGBAImage({width:0,height:0}),e={},t=new ShelfPack(0,0,{autoResize:!0});for(var d in a){var g=a[d],n=t.packOne(g.data.width+2*padding,g.data.height+2*padding);i.resize({width:t.w,height:t.h}),RGBAImage.copy(g.data,i,{x:0,y:0},{x:n.x+padding,y:n.y+padding},g.data),e[d]=imagePosition(n,g)}return t.shrink(),i.resize({width:t.w,height:t.h}),{image:i,positions:e}}}},{"../util/image":263,"@mapbox/shelf-pack":5}],88:[function(_dereq_,module,exports){var ShelfPack=_dereq_("@mapbox/shelf-pack"),RGBAImage=_dereq_("../util/image").RGBAImage,imagePosition=_dereq_("./image_atlas").imagePosition,Texture=_dereq_("./texture"),ImageManager=function(){this.images={},this.loaded=!1,this.requestors=[],this.shelfPack=new ShelfPack(64,64,{autoResize:!0}),this.patterns={},this.atlasImage=new RGBAImage({width:64,height:64}),this.dirty=!0};ImageManager.prototype.isLoaded=function(){return this.loaded},ImageManager.prototype.setLoaded=function(e){if(this.loaded!==e&&(this.loaded=e,e)){for(var a=0,i=this.requestors;a<i.length;a+=1){var r=i[a],s=r.ids,h=r.callback;this._notify(s,h)}this.requestors=[]}},ImageManager.prototype.getImage=function(e){return this.images[e]},ImageManager.prototype.addImage=function(e,t){this.images[e]=t},ImageManager.prototype.removeImage=function(e){delete this.images[e];var t=this.patterns[e];t&&(this.shelfPack.unref(t.bin),delete this.patterns[e])},ImageManager.prototype.getImages=function(e,t){var i=!0;if(!this.isLoaded())for(var r=0,s=e;r<s.length;r+=1){var h=s[r];this.images[h]||(i=!1)}this.isLoaded()||i?this._notify(e,t):this.requestors.push({ids:e,callback:t})},ImageManager.prototype._notify=function(e,t){for(var i={},r=0,s=e;r<s.length;r+=1){var h=s[r],g=this.images[h];g&&(i[h]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf})}t(null,i)},ImageManager.prototype.getPixelSize=function(){return{width:this.shelfPack.w,height:this.shelfPack.h}},ImageManager.prototype.getPattern=function(e){var t=this.patterns[e];if(t)return t.position;var a=this.getImage(e);if(!a)return null;var i=a.data.width+2,r=a.data.height+2,s=this.shelfPack.packOne(i,r);if(!s)return null;this.atlasImage.resize(this.getPixelSize());var h=a.data,g=this.atlasImage,n=s.x+1,o=s.y+1,d=h.width,l=h.height;RGBAImage.copy(h,g,{x:0,y:0},{x:n,y:o},{width:d,height:l}),RGBAImage.copy(h,g,{x:0,y:l-1},{x:n,y:o-1},{width:d,height:1}),RGBAImage.copy(h,g,{x:0,y:0},{x:n,y:o+l},{width:d,height:1}),RGBAImage.copy(h,g,{x:d-1,y:0},{x:n-1,y:o},{width:1,height:l}),RGBAImage.copy(h,g,{x:0,y:0},{x:n+d,y:o},{width:1,height:l}),this.dirty=!0;var p=imagePosition(s,a);return this.patterns[e]={bin:s,position:p},p},ImageManager.prototype.bind=function(e){var t=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Texture(e,this.atlasImage,t.RGBA),this.atlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE)},module.exports=ImageManager},{"../util/image":263,"./image_atlas":87,"./texture":93,"@mapbox/shelf-pack":5}],89:[function(_dereq_,module,exports){var util=_dereq_("../util/util"),LineAtlas=function(t,i){this.width=t,this.height=i,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}};LineAtlas.prototype.getDash=function(t,i){var e=t.join(",")+String(i);return this.positions[e]||(this.positions[e]=this.addDash(t,i)),this.positions[e]},LineAtlas.prototype.addDash=function(t,i){var e=this,h=i?7:0,s=2*h+1;if(this.nextRow+s>this.height)return util.warnOnce("LineAtlas out of space"),null;for(var a=0,r=0;r<t.length;r++)a+=t[r];for(var n=this.width/a,E=n/2,T=t.length%2==1,o=-h;o<=h;o++)for(var R=e.nextRow+h+o,d=e.width*R,u=T?-t[t.length-1]:0,l=t[0],x=1,_=0;_<this.width;_++){for(;l<_/n;)u=l,l+=t[x],T&&x===t.length-1&&(l+=t[0]),x++;var g=Math.abs(_-u*n),A=Math.abs(_-l*n),w=Math.min(g,A),D=x%2==1,U=void 0;if(i){var f=h?o/h*(E+1):0;if(D){var p=E-Math.abs(f);U=Math.sqrt(w*w+p*p)}else U=E-Math.sqrt(w*w+f*f)}else U=(D?1:-1)*w;e.data[3+4*(d+_)]=Math.max(0,Math.min(255,U+128))}var v={y:(this.nextRow+h+.5)/this.height,height:2*h/this.height,width:a};return this.nextRow+=s,this.dirty=!0,v},LineAtlas.prototype.bind=function(t){var i=t.gl;this.texture?(i.bindTexture(i.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,i.texSubImage2D(i.TEXTURE_2D,0,0,0,this.width,this.height,i.RGBA,i.UNSIGNED_BYTE,this.data))):(this.texture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,this.width,this.height,0,i.RGBA,i.UNSIGNED_BYTE,this.data))},module.exports=LineAtlas},{"../util/util":275}],90:[function(_dereq_,module,exports){var browser=_dereq_("../util/browser"),mat4=_dereq_("@mapbox/gl-matrix").mat4,SourceCache=_dereq_("../source/source_cache"),EXTENT=_dereq_("../data/extent"),pixelsToTileUnits=_dereq_("../source/pixels_to_tile_units"),util=_dereq_("../util/util"),VertexArrayObject=_dereq_("./vertex_array_object"),ref=_dereq_("../data/array_types"),RasterBoundsArray=ref.RasterBoundsArray,PosArray=ref.PosArray,rasterBoundsAttributes=_dereq_("../data/raster_bounds_attributes"),posAttributes=_dereq_("../data/pos_attributes"),ProgramConfiguration=_dereq_("../data/program_configuration").ProgramConfiguration,CrossTileSymbolIndex=_dereq_("../symbol/cross_tile_symbol_index"),shaders=_dereq_("../shaders"),Program=_dereq_("./program"),Context=_dereq_("../gl/context"),DepthMode=_dereq_("../gl/depth_mode"),StencilMode=_dereq_("../gl/stencil_mode"),ColorMode=_dereq_("../gl/color_mode"),updateTileMasks=(_dereq_("./texture"),_dereq_("./tile_mask")),Color=_dereq_("../style-spec/util/color"),draw={symbol:_dereq_("./draw_symbol"),circle:_dereq_("./draw_circle"),heatmap:_dereq_("./draw_heatmap"),line:_dereq_("./draw_line"),fill:_dereq_("./draw_fill"),"fill-extrusion":_dereq_("./draw_fill_extrusion"),hillshade:_dereq_("./draw_hillshade"),raster:_dereq_("./draw_raster"),background:_dereq_("./draw_background"),debug:_dereq_("./draw_debug")},Painter=function(e,r){this.context=new Context(e),this.transform=r,this._tileTextures={},this.setup(),this.numSublayers=SourceCache.maxUnderzooming+SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.depthRboNeedsClear=!0,this.emptyProgramConfiguration=new ProgramConfiguration,this.crossTileSymbolIndex=new CrossTileSymbolIndex};Painter.prototype.resize=function(e,r){var i=this.context.gl;if(this.width=e*browser.devicePixelRatio,this.height=r*browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var s=0,a=this.style._order;s<a.length;s+=1){var o=a[s];this.style._layers[o].resize()}this.depthRbo&&(i.deleteRenderbuffer(this.depthRbo),this.depthRbo=null)},Painter.prototype.setup=function(){var e=this.context,r=new PosArray;r.emplaceBack(0,0),r.emplaceBack(EXTENT,0),r.emplaceBack(0,EXTENT),r.emplaceBack(EXTENT,EXTENT),this.tileExtentBuffer=e.createVertexBuffer(r,posAttributes.members),this.tileExtentVAO=new VertexArrayObject,this.tileExtentPatternVAO=new VertexArrayObject;var t=new PosArray;t.emplaceBack(0,0),t.emplaceBack(EXTENT,0),t.emplaceBack(EXTENT,EXTENT),t.emplaceBack(0,EXTENT),t.emplaceBack(0,0),this.debugBuffer=e.createVertexBuffer(t,posAttributes.members),this.debugVAO=new VertexArrayObject;var i=new RasterBoundsArray;i.emplaceBack(0,0,0,0),i.emplaceBack(EXTENT,0,EXTENT,0),i.emplaceBack(0,EXTENT,0,EXTENT),i.emplaceBack(EXTENT,EXTENT,EXTENT,EXTENT),this.rasterBoundsBuffer=e.createVertexBuffer(i,rasterBoundsAttributes.members),this.rasterBoundsVAO=new VertexArrayObject;var s=new PosArray;s.emplaceBack(0,0),s.emplaceBack(1,0),s.emplaceBack(0,1),s.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(s,posAttributes.members),this.viewportVAO=new VertexArrayObject},Painter.prototype.clearStencil=function(){var e=this.context,r=e.gl;e.setColorMode(ColorMode.disabled),e.setDepthMode(DepthMode.disabled),e.setStencilMode(new StencilMode({func:r.ALWAYS,mask:0},0,255,r.ZERO,r.ZERO,r.ZERO));var t=mat4.create();mat4.ortho(t,0,this.width,this.height,0,0,1),mat4.scale(t,t,[r.drawingBufferWidth,r.drawingBufferHeight,0]);var i=this.useProgram("clippingMask");r.uniformMatrix4fv(i.uniforms.u_matrix,!1,t),this.viewportVAO.bind(e,i,this.viewportBuffer,[]),r.drawArrays(r.TRIANGLE_STRIP,0,4)},Painter.prototype._renderTileClippingMasks=function(e){var r=this,t=this.context,i=t.gl;t.setColorMode(ColorMode.disabled),t.setDepthMode(DepthMode.disabled);var s=1;this._tileClippingMaskIDs={};for(var a=0,o=e;a<o.length;a+=1){var n=o[a],l=r._tileClippingMaskIDs[n.key]=s++;t.setStencilMode(new StencilMode({func:i.ALWAYS,mask:0},l,255,i.KEEP,i.KEEP,i.REPLACE));var c=r.useProgram("clippingMask");i.uniformMatrix4fv(c.uniforms.u_matrix,!1,n.posMatrix),r.tileExtentVAO.bind(r.context,c,r.tileExtentBuffer,[]),i.drawArrays(i.TRIANGLE_STRIP,0,r.tileExtentBuffer.length)}},Painter.prototype.stencilModeForClipping=function(e){var r=this.context.gl;return new StencilMode({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,r.KEEP,r.KEEP,r.REPLACE)},Painter.prototype.colorModeForRenderPass=function(){var e=this.context.gl;return this._showOverdrawInspector?new ColorMode([e.CONSTANT_COLOR,e.ONE],new Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?ColorMode.unblended:ColorMode.alphaBlended},Painter.prototype.depthModeForSublayer=function(e,r,t){var i=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon,s=i-1+this.depthRange;return new DepthMode(t||this.context.gl.LEQUAL,r,[s,i])},Painter.prototype.render=function(e,r){var t=this;for(var i in this.style=e,this.options=r,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(browser.now()),e.sourceCaches){var s=t.style.sourceCaches[i];s.used&&s.prepare(t.context)}var a=this.style._order,o=util.filterObject(this.style.sourceCaches,function(e){return"raster"===e.getSource().type||"raster-dem"===e.getSource().type});for(var n in o)!function(e){var r=o[n],s=r.getVisibleCoordinates().map(function(e){return r.getTile(e)});updateTileMasks(s,t.context)}();this.renderPass="offscreen";var l,c=[];this.depthRboNeedsClear=!0;for(var h=0;h<a.length;h++){var u=t.style._layers[a[h]];u.hasOffscreenPass()&&!u.isHidden(t.transform.zoom)&&(u.source!==(l&&l.id)&&(c=[],(l=t.style.sourceCaches[u.source])&&(c=l.getVisibleCoordinates()).reverse()),c.length&&t.renderLayer(t,l,u,c))}this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?Color.black:Color.transparent,depth:1}),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRange=(e._order.length+2)*this.numSublayers*this.depthEpsilon,this.renderPass="opaque";var d,p=[];for(this.currentLayer=a.length-1,this.currentLayer;this.currentLayer>=0;this.currentLayer--){var f=t.style._layers[a[t.currentLayer]];f.source!==(d&&d.id)&&(p=[],(d=t.style.sourceCaches[f.source])&&(t.clearStencil(),p=d.getVisibleCoordinates(),d.getSource().isTileClipped&&t._renderTileClippingMasks(p))),t.renderLayer(t,d,f,p)}this.renderPass="translucent";var m,g=[];for(this.currentLayer=0,this.currentLayer;this.currentLayer<a.length;this.currentLayer++){var y=t.style._layers[a[t.currentLayer]];y.source!==(m&&m.id)&&(g=[],(m=t.style.sourceCaches[y.source])&&(t.clearStencil(),g=m.getVisibleCoordinates(),m.getSource().isTileClipped&&t._renderTileClippingMasks(g)),g.reverse()),t.renderLayer(t,m,y,g)}if(this.options.showTileBoundaries){var b=this.style.sourceCaches[Object.keys(this.style.sourceCaches)[0]];b&&draw.debug(this,b,b.getVisibleCoordinates())}},Painter.prototype.setupOffscreenDepthRenderbuffer=function(){var e=this.context;this.depthRbo||(this.depthRbo=e.createRenderbuffer(e.gl.DEPTH_COMPONENT16,this.width,this.height))},Painter.prototype.renderLayer=function(e,r,t,i){t.isHidden(this.transform.zoom)||("background"===t.type||i.length)&&(this.id=t.id,draw[t.type](e,r,t,i))},Painter.prototype.translatePosMatrix=function(e,r,t,i,s){if(!t[0]&&!t[1])return e;var a=s?"map"===i?this.transform.angle:0:"viewport"===i?-this.transform.angle:0;if(a){var o=Math.sin(a),n=Math.cos(a);t=[t[0]*n-t[1]*o,t[0]*o+t[1]*n]}var l=[s?t[0]:pixelsToTileUnits(r,t[0],this.transform.zoom),s?t[1]:pixelsToTileUnits(r,t[1],this.transform.zoom),0],c=new Float32Array(16);return mat4.translate(c,e,l),c},Painter.prototype.saveTileTexture=function(e){var r=this._tileTextures[e.size[0]];r?r.push(e):this._tileTextures[e.size[0]]=[e]},Painter.prototype.getTileTexture=function(e){var r=this._tileTextures[e];return r&&r.length>0?r.pop():null},Painter.prototype._createProgramCached=function(e,r){this.cache=this.cache||{};var t=""+e+(r.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[t]||(this.cache[t]=new Program(this.context,shaders[e],r,this._showOverdrawInspector)),this.cache[t]},Painter.prototype.useProgram=function(e,r){var t=this._createProgramCached(e,r||this.emptyProgramConfiguration);return this.context.program.set(t.program),t},module.exports=Painter},{"../data/array_types":39,"../data/extent":53,"../data/pos_attributes":57,"../data/program_configuration":58,"../data/raster_bounds_attributes":59,"../gl/color_mode":65,"../gl/context":66,"../gl/depth_mode":67,"../gl/stencil_mode":70,"../shaders":97,"../source/pixels_to_tile_units":104,"../source/source_cache":111,"../style-spec/util/color":153,"../symbol/cross_tile_symbol_index":218,"../util/browser":252,"../util/util":275,"./draw_background":74,"./draw_circle":75,"./draw_debug":77,"./draw_fill":78,"./draw_fill_extrusion":79,"./draw_heatmap":80,"./draw_hillshade":81,"./draw_line":82,"./draw_raster":83,"./draw_symbol":84,"./program":92,"./texture":93,"./tile_mask":94,"./vertex_array_object":95,"@mapbox/gl-matrix":2}],91:[function(_dereq_,module,exports){var pixelsToTileUnits=_dereq_("../source/pixels_to_tile_units");exports.isPatternMissing=function(e,i){if(!e)return!1;var r=i.imageManager.getPattern(e.from),t=i.imageManager.getPattern(e.to);return!r||!t},exports.prepare=function(e,i,r){var t=i.context,n=t.gl,o=i.imageManager.getPattern(e.from),a=i.imageManager.getPattern(e.to);n.uniform1i(r.uniforms.u_image,0),n.uniform2fv(r.uniforms.u_pattern_tl_a,o.tl),n.uniform2fv(r.uniforms.u_pattern_br_a,o.br),n.uniform2fv(r.uniforms.u_pattern_tl_b,a.tl),n.uniform2fv(r.uniforms.u_pattern_br_b,a.br);var u=i.imageManager.getPixelSize(),f=u.width,m=u.height;n.uniform2fv(r.uniforms.u_texsize,[f,m]),n.uniform1f(r.uniforms.u_mix,e.t),n.uniform2fv(r.uniforms.u_pattern_size_a,o.displaySize),n.uniform2fv(r.uniforms.u_pattern_size_b,a.displaySize),n.uniform1f(r.uniforms.u_scale_a,e.fromScale),n.uniform1f(r.uniforms.u_scale_b,e.toScale),t.activeTexture.set(n.TEXTURE0),i.imageManager.bind(i.context)},exports.setTile=function(e,i,r){var t=i.context.gl;t.uniform1f(r.uniforms.u_tile_units_to_pixels,1/pixelsToTileUnits(e,1,i.transform.tileZoom));var n=Math.pow(2,e.tileID.overscaledZ),o=e.tileSize*Math.pow(2,i.transform.tileZoom)/n,a=o*(e.tileID.canonical.x+e.tileID.wrap*n),u=o*e.tileID.canonical.y;t.uniform2f(r.uniforms.u_pixel_coord_upper,a>>16,u>>16),t.uniform2f(r.uniforms.u_pixel_coord_lower,65535&a,65535&u)}},{"../source/pixels_to_tile_units":104}],92:[function(_dereq_,module,exports){var browser=_dereq_("../util/browser"),shaders=_dereq_("../shaders"),VertexArrayObject=(_dereq_("../data/program_configuration").ProgramConfiguration,_dereq_("./vertex_array_object")),Program=(_dereq_("../gl/context"),function(r,e,t,a){var o=this,i=r.gl;this.program=i.createProgram();var n=t.defines().concat("#define DEVICE_PIXEL_RATIO "+browser.devicePixelRatio.toFixed(1));a&&n.push("#define OVERDRAW_INSPECTOR;");var s=n.concat(shaders.prelude.fragmentSource,e.fragmentSource).join("\n"),m=n.concat(shaders.prelude.vertexSource,e.vertexSource).join("\n"),g=i.createShader(i.FRAGMENT_SHADER);i.shaderSource(g,s),i.compileShader(g),i.attachShader(this.program,g);var c=i.createShader(i.VERTEX_SHADER);i.shaderSource(c,m),i.compileShader(c),i.attachShader(this.program,c);for(var u=t.layoutAttributes||[],h=0;h<u.length;h++)i.bindAttribLocation(o.program,h,u[h].name);i.linkProgram(this.program),this.numAttributes=i.getProgramParameter(this.program,i.ACTIVE_ATTRIBUTES),this.attributes={},this.uniforms={};for(var f=0;f<this.numAttributes;f++){var d=i.getActiveAttrib(o.program,f);d&&(o.attributes[d.name]=i.getAttribLocation(o.program,d.name))}for(var v=i.getProgramParameter(this.program,i.ACTIVE_UNIFORMS),p=0;p<v;p++){var S=i.getActiveUniform(o.program,p);S&&(o.uniforms[S.name]=i.getUniformLocation(o.program,S.name))}});Program.prototype.draw=function(r,e,t,a,o,i,n,s,m){for(var g,u=r.gl,h=(g={},g[u.LINES]=2,g[u.TRIANGLES]=3,g)[e],f=0,d=i.get();f<d.length;f+=1){var v=d[f],p=v.vaos||(v.vaos={});(p[t]||(p[t]=new VertexArrayObject)).bind(r,this,a,n?n.getPaintVertexBuffers():[],o,v.vertexOffset,s,m),u.drawElements(e,v.primitiveLength*h,u.UNSIGNED_SHORT,v.primitiveOffset*h*2)}},module.exports=Program},{"../data/program_configuration":58,"../gl/context":66,"../shaders":97,"../util/browser":252,"./vertex_array_object":95}],93:[function(_dereq_,module,exports){var ref=_dereq_("../util/window"),HTMLImageElement=ref.HTMLImageElement,HTMLCanvasElement=ref.HTMLCanvasElement,HTMLVideoElement=ref.HTMLVideoElement,ImageData=ref.ImageData,Texture=function(e,t,i,r){this.context=e;var a=t.width,T=t.height;this.size=[a,T],this.format=i,this.texture=e.gl.createTexture(),this.update(t,r)};Texture.prototype.update=function(e,t){var i=e.width,r=e.height;this.size=[i,r];var T=this.context,n=T.gl;n.bindTexture(n.TEXTURE_2D,this.texture),T.pixelStoreUnpack.set(1),this.format===n.RGBA&&!1!==t&&T.pixelStoreUnpackPremultiplyAlpha.set(!0),e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData?n.texImage2D(n.TEXTURE_2D,0,this.format,this.format,n.UNSIGNED_BYTE,e):n.texImage2D(n.TEXTURE_2D,0,this.format,i,r,0,this.format,n.UNSIGNED_BYTE,e.data)},Texture.prototype.bind=function(e,t,i){var T=this.context.gl;T.bindTexture(T.TEXTURE_2D,this.texture),e!==this.filter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,e),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,i||e),this.filter=e),t!==this.wrap&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,t),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,t),this.wrap=t)},Texture.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null},module.exports=Texture},{"../util/window":254}],94:[function(_dereq_,module,exports){function computeTileMasks(e,i,l,a,r){for(var n=0;n<l.length;n++){var s=l[n];if(a.isLessThan(s.tileID))break;if(i.key===s.tileID.key)return;if(s.tileID.isChildOf(i)){for(var t=i.children(1/0),c=0;c<t.length;c++)computeTileMasks(e,t[c],l.slice(n),a,r);return}}var o=i.overscaledZ-e.overscaledZ,D=new CanonicalTileID(o,i.canonical.x-(e.canonical.x<<o),i.canonical.y-(e.canonical.y<<o));r[D.key]=r[D.key]||D}var ref=_dereq_("../source/tile_id"),OverscaledTileID=ref.OverscaledTileID,CanonicalTileID=ref.CanonicalTileID;module.exports=function(e,i){for(var l=e.sort(function(e,i){return e.tileID.isLessThan(i.tileID)?-1:i.tileID.isLessThan(e.tileID)?1:0}),a=0;a<l.length;a++){var r={},n=l[a],s=l.slice(a+1);computeTileMasks(n.tileID.wrapped(),n.tileID,s,new OverscaledTileID(0,n.tileID.wrap+1,0,0,0),r),n.setMask(r,i)}}},{"../source/tile_id":114}],95:[function(_dereq_,module,exports){var VertexArrayObject=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};VertexArrayObject.prototype.bind=function(t,e,r,i,n,s,u,o){this.context=t;for(var a=this.boundPaintVertexBuffers.length!==i.length,f=0;!a&&f<i.length;f++)this.boundPaintVertexBuffers[f]!==i[f]&&(a=!0);var x=!this.vao||this.boundProgram!==e||this.boundLayoutVertexBuffer!==r||a||this.boundIndexBuffer!==n||this.boundVertexOffset!==s||this.boundDynamicVertexBuffer!==u||this.boundDynamicVertexBuffer2!==o;!t.extVertexArrayObject||x?this.freshBind(e,r,i,n,s,u,o):(t.bindVertexArrayOES.set(this.vao),u&&u.bind(),n&&n.dynamicDraw&&n.bind(),o&&o.bind())},VertexArrayObject.prototype.freshBind=function(t,e,r,i,n,s,u){var o,b=t.numAttributes,a=this.context,f=a.gl;if(a.extVertexArrayObject)this.vao&&this.destroy(),this.vao=a.extVertexArrayObject.createVertexArrayOES(),a.bindVertexArrayOES.set(this.vao),o=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=i,this.boundVertexOffset=n,this.boundDynamicVertexBuffer=s,this.boundDynamicVertexBuffer2=u;else{o=a.currentNumAttributes||0;for(var x=b;x<o;x++)f.disableVertexAttribArray(x)}e.enableAttributes(f,t);for(var d=0,h=r;d<h.length;d+=1)h[d].enableAttributes(f,t);s&&s.enableAttributes(f,t),u&&u.enableAttributes(f,t),e.bind(),e.setVertexAttribPointers(f,t,n);for(var V=0,l=r;V<l.length;V+=1){var y=l[V];y.bind(),y.setVertexAttribPointers(f,t,n)}s&&(s.bind(),s.setVertexAttribPointers(f,t,n)),i&&i.bind(),u&&(u.bind(),u.setVertexAttribPointers(f,t,n)),a.currentNumAttributes=b},VertexArrayObject.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)},module.exports=VertexArrayObject},{}],96:[function(_dereq_,module,exports){var util=_dereq_("../util/util");exports.packUint8ToFloat=function(t,l){return 256*(t=util.clamp(Math.floor(t),0,255))+(l=util.clamp(Math.floor(l),0,255))}},{"../util/util":275}],97:[function(_dereq_,module,exports){var shaders={prelude:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\n// Unpack a pair of values that have been packed into a single float.\n// The packed values are assumed to be 8-bit unsigned integers, and are\n// packed like so:\n// packedValue = floor(input[0]) * 256 + input[1],\nvec2 unpack_float(const float packedValue) {\n    int packedIntValue = int(packedValue);\n    int v0 = packedIntValue / 256;\n    return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec2 unpack_opacity(const float packedOpacity) {\n    int intOpacity = int(packedOpacity) / 2;\n    return vec2(float(intOpacity) / 127.0, mod(packedOpacity, 2.0));\n}\n\n// To minimize the number of attributes needed, we encode a 4-component\n// color into a pair of floats (i.e. a vec2) as follows:\n// [ floor(color.r * 255) * 256 + color.g * 255,\n//   floor(color.b * 255) * 256 + color.g * 255 ]\nvec4 decode_color(const vec2 encodedColor) {\n    return vec4(\n        unpack_float(encodedColor[0]) / 255.0,\n        unpack_float(encodedColor[1]) / 255.0\n    );\n}\n\n// Unpack a pair of paint values and interpolate between them.\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\n    return mix(packedValue[0], packedValue[1], t);\n}\n\n// Unpack a pair of paint values and interpolate between them.\nvec4 unpack_mix_vec4(const vec4 packedColors, const float t) {\n    vec4 minColor = decode_color(vec2(packedColors[0], packedColors[1]));\n    vec4 maxColor = decode_color(vec2(packedColors[2], packedColors[3]));\n    return mix(minColor, maxColor, t);\n}\n\n// The offset depends on how many pixels are between the world origin and the edge of the tile:\n// vec2 offset = mod(pixel_coord, size)\n//\n// At high zoom levels there are a ton of pixels between the world origin and the edge of the tile.\n// The glsl spec only guarantees 16 bits of precision for highp floats. We need more than that.\n//\n// The pixel_coord is passed in as two 16 bit values:\n// pixel_coord_upper = floor(pixel_coord / 2^16)\n// pixel_coord_lower = mod(pixel_coord, 2^16)\n//\n// The offset is calculated in a series of steps that should preserve this precision:\nvec2 get_pattern_pos(const vec2 pixel_coord_upper, const vec2 pixel_coord_lower,\n    const vec2 pattern_size, const float tile_units_to_pixels, const vec2 pos) {\n\n    vec2 offset = mod(mod(mod(pixel_coord_upper, pattern_size) * 256.0, pattern_size) * 256.0 + pixel_coord_lower, pattern_size);\n    return (tile_units_to_pixels * pos + offset) / pattern_size;\n}\n"},background:{fragmentSource:"uniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main() {\n    gl_FragColor = u_color * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},backgroundPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\nuniform float u_opacity;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n}\n"},circle:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    vec2 extrude = v_data.xy;\n    float extrude_length = length(extrude);\n\n    lowp float antialiasblur = v_data.z;\n    float antialiased_blur = -max(blur, antialiasblur);\n\n    float opacity_t = smoothstep(0.0, antialiased_blur, extrude_length - 1.0);\n\n    float color_t = stroke_width < 0.01 ? 0.0 : smoothstep(\n        antialiased_blur,\n        0.0,\n        extrude_length - radius / (radius + stroke_width)\n    );\n\n    gl_FragColor = opacity_t * mix(color * opacity, stroke_color * stroke_opacity, color_t);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform bool u_scale_with_map;\nuniform bool u_pitch_with_map;\nuniform vec2 u_extrude_scale;\nuniform highp float u_camera_to_center_distance;\n\nattribute vec2 a_pos;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main(void) {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec2 circle_center = floor(a_pos * 0.5);\n    if (u_pitch_with_map) {\n        vec2 corner_position = circle_center;\n        if (u_scale_with_map) {\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale;\n        } else {\n            // Pitching the circle with the map effectively scales it with the map\n            // To counteract the effect for pitch-scale: viewport, we rescale the\n            // whole circle based on the pitch scaling effect at its central point\n            vec4 projected_center = u_matrix * vec4(circle_center, 0, 1);\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale * (projected_center.w / u_camera_to_center_distance);\n        }\n\n        gl_Position = u_matrix * vec4(corner_position, 0, 1);\n    } else {\n        gl_Position = u_matrix * vec4(circle_center, 0, 1);\n\n        if (u_scale_with_map) {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * u_camera_to_center_distance;\n        } else {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * gl_Position.w;\n        }\n    }\n\n    // This is a minimum blur distance that serves as a faux-antialiasing for\n    // the circle. since blur is a ratio of the circle's size and the intent is\n    // to keep the blur at roughly 1px, the two are inversely related.\n    lowp float antialiasblur = 1.0 / DEVICE_PIXEL_RATIO / (radius + stroke_width);\n\n    v_data = vec3(extrude.x, extrude.y, antialiasblur);\n}\n"},clippingMask:{fragmentSource:"void main() {\n    gl_FragColor = vec4(1.0);\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},heatmap:{fragmentSource:"#pragma mapbox: define highp float weight\n\nuniform highp float u_intensity;\nvarying vec2 v_extrude;\n\n// Gaussian kernel coefficient: 1 / sqrt(2 * PI)\n#define GAUSS_COEF 0.3989422804014327\n\nvoid main() {\n    #pragma mapbox: initialize highp float weight\n\n    // Kernel density estimation with a Gaussian kernel of size 5x5\n    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);\n    float val = weight * u_intensity * GAUSS_COEF * exp(d);\n\n    gl_FragColor = vec4(val, 1.0, 1.0, 1.0);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\n\nuniform mat4 u_matrix;\nuniform float u_extrude_scale;\nuniform float u_opacity;\nuniform float u_intensity;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_extrude;\n\n// Effective \"0\" in the kernel density texture to adjust the kernel size to;\n// this empirically chosen number minimizes artifacts on overlapping kernels\n// for typical heatmap cases (assuming clustered source)\nconst highp float ZERO = 1.0 / 255.0 / 16.0;\n\n// Gaussian kernel coefficient: 1 / sqrt(2 * PI)\n#define GAUSS_COEF 0.3989422804014327\n\nvoid main(void) {\n    #pragma mapbox: initialize highp float weight\n    #pragma mapbox: initialize mediump float radius\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 unscaled_extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // This 'extrude' comes in ranging from [-1, -1], to [1, 1].  We'll use\n    // it to produce the vertices of a square mesh framing the point feature\n    // we're adding to the kernel density texture.  We'll also pass it as\n    // a varying, so that the fragment shader can determine the distance of\n    // each fragment from the point feature.\n    // Before we do so, we need to scale it up sufficiently so that the\n    // kernel falls effectively to zero at the edge of the mesh.\n    // That is, we want to know S such that\n    // weight * u_intensity * GAUSS_COEF * exp(-0.5 * 3.0^2 * S^2) == ZERO\n    // Which solves to:\n    // S = sqrt(-2.0 * log(ZERO / (weight * u_intensity * GAUSS_COEF))) / 3.0\n    float S = sqrt(-2.0 * log(ZERO / weight / u_intensity / GAUSS_COEF)) / 3.0;\n\n    // Pass the varying in units of radius\n    v_extrude = S * unscaled_extrude;\n\n    // Scale by radius and the zoom-based scale factor to produce actual\n    // mesh position\n    vec2 extrude = v_extrude * radius * u_extrude_scale;\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec4 pos = vec4(floor(a_pos * 0.5) + extrude, 0, 1);\n\n    gl_Position = u_matrix * pos;\n}\n"},heatmapTexture:{fragmentSource:"uniform sampler2D u_image;\nuniform sampler2D u_color_ramp;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    float t = texture2D(u_image, v_pos).r;\n    vec4 color = texture2D(u_color_ramp, vec2(t, 0.5));\n    gl_FragColor = color * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n"},collisionBox:{fragmentSource:"\nvarying float v_placed;\nvarying float v_notUsed;\n\nvoid main() {\n\n    float alpha = 0.5;\n\n    // Red = collision, hide label\n    gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n\n    // Blue = no collision, label is showing\n    if (v_placed > 0.5) {\n        gl_FragColor = vec4(0.0, 0.0, 1.0, 0.5) * alpha;\n    }\n\n    if (v_notUsed > 0.5) {\n        // This box not used, fade it out\n        gl_FragColor *= .1;\n    }\n}",vertexSource:"attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_placed;\n\nuniform mat4 u_matrix;\nuniform vec2 u_extrude_scale;\nuniform float u_camera_to_center_distance;\n\nvarying float v_placed;\nvarying float v_notUsed;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = 0.5 + 0.5 * (u_camera_to_center_distance / camera_to_anchor_distance);\n\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n    gl_Position.xy += a_extrude * u_extrude_scale * gl_Position.w * collision_perspective_ratio;\n\n    v_placed = a_placed.x;\n    v_notUsed = a_placed.y;\n}\n"},collisionCircle:{fragmentSource:"\nvarying float v_placed;\nvarying float v_notUsed;\nvarying float v_radius;\nvarying vec2 v_extrude;\nvarying vec2 v_extrude_scale;\n\nvoid main() {\n    float alpha = 0.5;\n\n    // Red = collision, hide label\n    vec4 color = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n\n    // Blue = no collision, label is showing\n    if (v_placed > 0.5) {\n        color = vec4(0.0, 0.0, 1.0, 0.5) * alpha;\n    }\n\n    if (v_notUsed > 0.5) {\n        // This box not used, fade it out\n        color *= .2;\n    }\n\n    float extrude_scale_length = length(v_extrude_scale);\n    float extrude_length = length(v_extrude) * extrude_scale_length;\n    float stroke_width = 15.0 * extrude_scale_length;\n    float radius = v_radius * extrude_scale_length;\n\n    float distance_to_edge = abs(extrude_length - radius);\n    float opacity_t = smoothstep(-stroke_width, 0.0, -distance_to_edge);\n\n    gl_FragColor = opacity_t * color;\n}\n",vertexSource:"attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_placed;\n\nuniform mat4 u_matrix;\nuniform vec2 u_extrude_scale;\nuniform float u_camera_to_center_distance;\n\nvarying float v_placed;\nvarying float v_notUsed;\nvarying float v_radius;\n\nvarying vec2 v_extrude;\nvarying vec2 v_extrude_scale;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = 0.5 + 0.5 * (u_camera_to_center_distance / camera_to_anchor_distance);\n\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n\n    highp float padding_factor = 1.2; // Pad the vertices slightly to make room for anti-alias blur\n    gl_Position.xy += a_extrude * u_extrude_scale * padding_factor * gl_Position.w * collision_perspective_ratio;\n\n    v_placed = a_placed.x;\n    v_notUsed = a_placed.y;\n    v_radius = abs(a_extrude.y); // We don't pitch the circles, so both units of the extrusion vector are equal in magnitude to the radius\n\n    v_extrude = a_extrude * padding_factor;\n    v_extrude_scale = u_extrude_scale * u_camera_to_center_distance * collision_perspective_ratio;\n}\n"},debug:{fragmentSource:"uniform highp vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},fill:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_FragColor = color * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},fillOutline:{fragmentSource:"#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_pos;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n    gl_FragColor = outline_color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\nuniform vec2 u_world;\n\nvarying vec2 v_pos;\n\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillOutlinePattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    // find distance to outline for alpha interpolation\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n\n\n    gl_FragColor = mix(color1, color2, u_mix) * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n}\n"},fillExtrusion:{fragmentSource:"varying vec4 v_color;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    gl_FragColor = v_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec4 a_normal_ed;\n\nvarying vec4 v_color;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    vec3 normal = a_normal_ed.xyz;\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(normal.x, 2.0);\n\n    gl_Position = u_matrix * vec4(a_pos, t > 0.0 ? height : base, 1);\n\n    // Relative luminance (how dark/bright is the surface color?)\n    float colorvalue = color.r * 0.2126 + color.g * 0.7152 + color.b * 0.0722;\n\n    v_color = vec4(0.0, 0.0, 0.0, 1.0);\n\n    // Add slight ambient lighting so no extrusions are totally black\n    vec4 ambientlight = vec4(0.03, 0.03, 0.03, 1.0);\n    color += ambientlight;\n\n    // Calculate cos(theta), where theta is the angle between surface normal and diffuse light ray\n    float directional = clamp(dot(normal / 16384.0, u_lightpos), 0.0, 1.0);\n\n    // Adjust directional so that\n    // the range of values for highlight/shading is narrower\n    // with lower light intensity\n    // and with lighter/brighter surface colors\n    directional = mix((1.0 - u_lightintensity), max((1.0 - colorvalue + u_lightintensity), 1.0), directional);\n\n    // Add gradient along z axis of side surfaces\n    if (normal.y != 0.0) {\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\n    }\n\n    // Assign final color based on surface + ambient light color, diffuse light directional, and light color\n    // with lower bounds adjusted to hue of light\n    // so that shading is tinted with the complementary (opposite) color to the light color\n    v_color.r += clamp(color.r * directional * u_lightcolor.r, mix(0.0, 0.3, 1.0 - u_lightcolor.r), 1.0);\n    v_color.g += clamp(color.g * directional * u_lightcolor.g, mix(0.0, 0.3, 1.0 - u_lightcolor.g), 1.0);\n    v_color.b += clamp(color.b * directional * u_lightcolor.b, mix(0.0, 0.3, 1.0 - u_lightcolor.b), 1.0);\n}\n"},fillExtrusionPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    vec4 mixedColor = mix(color1, color2, u_mix);\n\n    gl_FragColor = mixedColor * v_lighting;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\nuniform float u_height_factor;\n\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec4 a_normal_ed;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\nvarying float v_directional;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n\n    vec3 normal = a_normal_ed.xyz;\n    float edgedistance = a_normal_ed.w;\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(normal.x, 2.0);\n    float z = t > 0.0 ? height : base;\n\n    gl_Position = u_matrix * vec4(a_pos, z, 1);\n\n    vec2 pos = normal.x == 1.0 && normal.y == 0.0 && normal.z == 16384.0\n        ? a_pos // extrusion top\n        : vec2(edgedistance, z * u_height_factor); // extrusion side\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, pos);\n\n    v_lighting = vec4(0.0, 0.0, 0.0, 1.0);\n    float directional = clamp(dot(normal / 16383.0, u_lightpos), 0.0, 1.0);\n    directional = mix((1.0 - u_lightintensity), max((0.5 + u_lightintensity), 1.0), directional);\n\n    if (normal.y != 0.0) {\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\n    }\n\n    v_lighting.rgb += clamp(directional * u_lightcolor, mix(vec3(0.0), vec3(0.3), 1.0 - u_lightcolor), vec3(1.0));\n}\n"},extrusionTexture:{fragmentSource:"uniform sampler2D u_image;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_FragColor = texture2D(u_image, v_pos) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n"},hillshadePrepare:{fragmentSource:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D u_image;\nvarying vec2 v_pos;\nuniform vec2 u_dimension;\nuniform float u_zoom;\n\nfloat getElevation(vec2 coord, float bias) {\n    // Convert encoded elevation value to meters\n    vec4 data = texture2D(u_image, coord) * 255.0;\n    return (data.r + data.g * 256.0 + data.b * 256.0 * 256.0) / 4.0;\n}\n\nvoid main() {\n    vec2 epsilon = 1.0 / u_dimension;\n\n    // queried pixels:\n    // +-----------+\n    // |   |   |   |\n    // | a | b | c |\n    // |   |   |   |\n    // +-----------+\n    // |   |   |   |\n    // | d | e | f |\n    // |   |   |   |\n    // +-----------+\n    // |   |   |   |\n    // | g | h | i |\n    // |   |   |   |\n    // +-----------+\n\n    float a = getElevation(v_pos + vec2(-epsilon.x, -epsilon.y), 0.0);\n    float b = getElevation(v_pos + vec2(0, -epsilon.y), 0.0);\n    float c = getElevation(v_pos + vec2(epsilon.x, -epsilon.y), 0.0);\n    float d = getElevation(v_pos + vec2(-epsilon.x, 0), 0.0);\n    float e = getElevation(v_pos, 0.0);\n    float f = getElevation(v_pos + vec2(epsilon.x, 0), 0.0);\n    float g = getElevation(v_pos + vec2(-epsilon.x, epsilon.y), 0.0);\n    float h = getElevation(v_pos + vec2(0, epsilon.y), 0.0);\n    float i = getElevation(v_pos + vec2(epsilon.x, epsilon.y), 0.0);\n\n    // here we divide the x and y slopes by 8 * pixel size\n    // where pixel size (aka meters/pixel) is:\n    // circumference of the world / (pixels per tile * number of tiles)\n    // which is equivalent to: 8 * 40075016.6855785 / (512 * pow(2, u_zoom))\n    // which can be reduced to: pow(2, 19.25619978527 - u_zoom)\n    // we want to vertically exaggerate the hillshading though, because otherwise\n    // it is barely noticeable at low zooms. to do this, we multiply this by some\n    // scale factor pow(2, (u_zoom - 14) * a) where a is an arbitrary value and 14 is the\n    // maxzoom of the tile source. here we use a=0.3 which works out to the\n    // expression below. see nickidlugash's awesome breakdown for more info\n    // https://github.com/mapbox/mapbox-gl-js/pull/5286#discussion_r148419556\n    float exaggeration = u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;\n\n    vec2 deriv = vec2(\n        (c + f + f + i) - (a + d + d + g),\n        (g + h + h + i) - (a + b + b + c)\n    ) /  pow(2.0, (u_zoom - 14.0) * exaggeration + 19.2562 - u_zoom);\n\n    gl_FragColor = clamp(vec4(\n        deriv.x / 2.0 + 0.5,\n        deriv.y / 2.0 + 0.5,\n        1.0,\n        1.0), 0.0, 1.0);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (a_texture_pos / 8192.0) / 2.0 + 0.25;\n}\n"},hillshade:{fragmentSource:"uniform sampler2D u_image;\nvarying vec2 v_pos;\n\nuniform vec2 u_latrange;\nuniform vec2 u_light;\nuniform vec4 u_shadow;\nuniform vec4 u_highlight;\nuniform vec4 u_accent;\n\n#define PI 3.141592653589793\n\nvoid main() {\n    vec4 pixel = texture2D(u_image, v_pos);\n\n    vec2 deriv = ((pixel.rg * 2.0) - 1.0);\n\n    // We divide the slope by a scale factor based on the cosin of the pixel's approximate latitude\n    // to account for mercator projection distortion. see #4807 for details\n    float scaleFactor = cos(radians((u_latrange[0] - u_latrange[1]) * (1.0 - v_pos.y) + u_latrange[1]));\n    // We also multiply the slope by an arbitrary z-factor of 1.25\n    float slope = atan(1.25 * length(deriv) / scaleFactor);\n    float aspect = deriv.x != 0.0 ? atan(deriv.y, -deriv.x) : PI / 2.0 * (deriv.y > 0.0 ? 1.0 : -1.0);\n\n    float intensity = u_light.x;\n    // We add PI to make this property match the global light object, which adds PI/2 to the light's azimuthal\n    // position property to account for 0deg corresponding to north/the top of the viewport in the style spec\n    // and the original shader was written to accept (-illuminationDirection - 90) as the azimuthal.\n    float azimuth = u_light.y + PI;\n\n    // We scale the slope exponentially based on intensity, using a calculation similar to\n    // the exponential interpolation function in the style spec:\n    // https://github.com/mapbox/mapbox-gl-js/blob/master/src/style-spec/expression/definitions/interpolate.js#L217-L228\n    // so that higher intensity values create more opaque hillshading.\n    float base = 1.875 - intensity * 1.75;\n    float maxValue = 0.5 * PI;\n    float scaledSlope = intensity != 0.5 ? ((pow(base, slope) - 1.0) / (pow(base, maxValue) - 1.0)) * maxValue : slope;\n\n    // The accent color is calculated with the cosine of the slope while the shade color is calculated with the sine\n    // so that the accent color's rate of change eases in while the shade color's eases out.\n    float accent = cos(scaledSlope);\n    // We multiply both the accent and shade color by a clamped intensity value\n    // so that intensities >= 0.5 do not additionally affect the color values\n    // while intensity values < 0.5 make the overall color more transparent.\n    vec4 accent_color = (1.0 - accent) * u_accent * clamp(intensity * 2.0, 0.0, 1.0);\n    float shade = abs(mod((aspect + azimuth) / PI + 0.5, 2.0) - 1.0);\n    vec4 shade_color = mix(u_shadow, u_highlight, shade) * sin(scaledSlope) * clamp(intensity * 2.0, 0.0, 1.0);\n    gl_FragColor = accent_color * (1.0 - shade_color.a) + shade_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = a_texture_pos / 8192.0;\n}\n"},line:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n"},linePattern:{fragmentSource:"uniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_fade;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float x_a = mod(v_linesofar / u_pattern_size_a.x, 1.0);\n    float x_b = mod(v_linesofar / u_pattern_size_b.x, 1.0);\n    float y_a = 0.5 + (v_normal.y * v_width2.s / u_pattern_size_a.y);\n    float y_b = 0.5 + (v_normal.y * v_width2.s / u_pattern_size_b.y);\n    vec2 pos_a = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, vec2(x_a, y_a));\n    vec2 pos_b = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, vec2(x_b, y_b));\n\n    vec4 color = mix(texture2D(u_image, pos_a), texture2D(u_image, pos_b), u_fade);\n\n    gl_FragColor = color * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_linesofar = a_linesofar;\n    v_width2 = vec2(outset, inset);\n}\n"},lineSDF:{fragmentSource:"\nuniform sampler2D u_image;\nuniform float u_sdfgamma;\nuniform float u_mix;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float sdfdist_a = texture2D(u_image, v_tex_a).a;\n    float sdfdist_b = texture2D(u_image, v_tex_b).a;\n    float sdfdist = mix(sdfdist_a, sdfdist_b, u_mix);\n    alpha *= smoothstep(0.5 - u_sdfgamma / floorwidth, 0.5 + u_sdfgamma / floorwidth, sdfdist);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_patternscale_a;\nuniform float u_tex_y_a;\nuniform vec2 u_patternscale_b;\nuniform float u_tex_y_b;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist =outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_tex_a = vec2(a_linesofar * u_patternscale_a.x / floorwidth, normal.y * u_patternscale_a.y + u_tex_y_a);\n    v_tex_b = vec2(a_linesofar * u_patternscale_b.x / floorwidth, normal.y * u_patternscale_b.y + u_tex_y_b);\n\n    v_width2 = vec2(outset, inset);\n}\n"},raster:{fragmentSource:"uniform float u_fade_t;\nuniform float u_opacity;\nuniform sampler2D u_image0;\nuniform sampler2D u_image1;\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nuniform float u_brightness_low;\nuniform float u_brightness_high;\n\nuniform float u_saturation_factor;\nuniform float u_contrast_factor;\nuniform vec3 u_spin_weights;\n\nvoid main() {\n\n    // read and cross-fade colors from the main and parent tiles\n    vec4 color0 = texture2D(u_image0, v_pos0);\n    vec4 color1 = texture2D(u_image1, v_pos1);\n    if (color0.a > 0.0) {\n        color0.rgb = color0.rgb / color0.a;\n    }\n    if (color1.a > 0.0) {\n        color1.rgb = color1.rgb / color1.a;\n    }\n    vec4 color = mix(color0, color1, u_fade_t);\n    color.a *= u_opacity;\n    vec3 rgb = color.rgb;\n\n    // spin\n    rgb = vec3(\n        dot(rgb, u_spin_weights.xyz),\n        dot(rgb, u_spin_weights.zxy),\n        dot(rgb, u_spin_weights.yzx));\n\n    // saturation\n    float average = (color.r + color.g + color.b) / 3.0;\n    rgb += (average - rgb) * u_saturation_factor;\n\n    // contrast\n    rgb = (rgb - 0.5) * u_contrast_factor + 0.5;\n\n    // brightness\n    vec3 u_high_vec = vec3(u_brightness_low, u_brightness_low, u_brightness_low);\n    vec3 u_low_vec = vec3(u_brightness_high, u_brightness_high, u_brightness_high);\n\n    gl_FragColor = vec4(mix(u_high_vec, u_low_vec, rgb) * color.a, color.a);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_tl_parent;\nuniform float u_scale_parent;\nuniform float u_buffer_scale;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    // We are using Int16 for texture position coordinates to give us enough precision for\n    // fractional coordinates. We use 8192 to scale the texture coordinates in the buffer\n    // as an arbitrarily high number to preserve adequate precision when rendering.\n    // This is also the same value as the EXTENT we are using for our tile buffer pos coordinates,\n    // so math for modifying either is consistent.\n    v_pos0 = (((a_texture_pos / 8192.0) - 0.5) / u_buffer_scale ) + 0.5;\n    v_pos1 = (v_pos0 * u_scale_parent) + u_tl_parent;\n}\n"},symbolIcon:{fragmentSource:"uniform sampler2D u_texture;\n\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    lowp float alpha = opacity * v_fade_opacity;\n    gl_FragColor = texture2D(u_texture, v_tex) * alpha;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\nuniform highp float u_camera_to_center_distance;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform float u_fade_change;\n\n#pragma mapbox: define lowp float opacity\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp float segment_angle = -a_projected_pos[2];\n\n    float size;\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 10.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // See comments in symbol_sdf.vertex\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = 0.5 + 0.5 * distance_ratio;\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // See comments in symbol_sdf.vertex\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 64.0 * fontScale), 0.0, 1.0);\n\n    v_tex = a_tex / u_texsize;\n    vec2 fade_opacity = unpack_opacity(a_fade_opacity);\n    float fade_change = fade_opacity[1] > 0.5 ? u_fade_change : -u_fade_change;\n    v_fade_opacity = max(0.0, min(1.0, fade_opacity[0] + fade_change));\n}\n"},symbolSDF:{fragmentSource:"#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105/DEVICE_PIXEL_RATIO\n\nuniform bool u_is_halo;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform sampler2D u_texture;\nuniform highp float u_gamma_scale;\nuniform bool u_is_text;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 tex = v_data0.xy;\n    float gamma_scale = v_data1.x;\n    float size = v_data1.y;\n    float fade_opacity = v_data1[2];\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    lowp vec4 color = fill_color;\n    highp float gamma = EDGE_GAMMA / (fontScale * u_gamma_scale);\n    lowp float buff = (256.0 - 64.0) / 256.0;\n    if (u_is_halo) {\n        color = halo_color;\n        gamma = (halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (fontScale * u_gamma_scale);\n        buff = (6.0 - halo_width / fontScale) / SDF_PX;\n    }\n\n    lowp float dist = texture2D(u_texture, tex).a;\n    highp float gamma_scaled = gamma * gamma_scale;\n    highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n\n    gl_FragColor = color * (alpha * opacity * fade_opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\n// contents of a_size vary based on the type of property value\n// used for {text,icon}-size.\n// For constants, a_size is disabled.\n// For source functions, we bind only one value per vertex: the value of {text,icon}-size evaluated for the current feature.\n// For composite functions:\n// [ text-size(lowerZoomStop, feature),\n//   text-size(upperZoomStop, feature) ]\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\n\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform highp float u_camera_to_center_distance;\nuniform float u_fade_change;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp float segment_angle = -a_projected_pos[2];\n    float size;\n\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 10.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // If the label is pitched with the map, layout is done in pitched space,\n    // which makes labels in the distance smaller relative to viewport space.\n    // We counteract part of that effect by multiplying by the perspective ratio.\n    // If the label isn't pitched with the map, we do layout in viewport space,\n    // which makes labels in the distance larger relative to the features around\n    // them. We counteract part of that effect by dividing by the perspective ratio.\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = 0.5 + 0.5 * distance_ratio;\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // Point labels with 'rotation-alignment: map' are horizontal with respect to tile units\n        // To figure out that angle in projected space, we draw a short horizontal line in tile\n        // space, project it, and measure its angle in projected space.\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 64.0 * fontScale), 0.0, 1.0);\n    float gamma_scale = gl_Position.w;\n\n    vec2 tex = a_tex / u_texsize;\n    vec2 fade_opacity = unpack_opacity(a_fade_opacity);\n    float fade_change = fade_opacity[1] > 0.5 ? u_fade_change : -u_fade_change;\n    float interpolated_fade_opacity = max(0.0, min(1.0, fade_opacity[0] + fade_change));\n\n    v_data0 = vec2(tex.x, tex.y);\n    v_data1 = vec3(gamma_scale, size, interpolated_fade_opacity);\n}\n"}},re=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,loop=function(e){var n=shaders[e],a={};n.fragmentSource=n.fragmentSource.replace(re,function(e,n,t,o,i){return a[i]=!0,"define"===n?"\n#ifndef HAS_UNIFORM_u_"+i+"\nvarying "+t+" "+o+" "+i+";\n#else\nuniform "+t+" "+o+" u_"+i+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+i+"\n    "+t+" "+o+" "+i+" = u_"+i+";\n#endif\n"}),n.vertexSource=n.vertexSource.replace(re,function(e,n,t,o,i){var r="float"===o?"vec2":"vec4";return a[i]?"define"===n?"\n#ifndef HAS_UNIFORM_u_"+i+"\nuniform lowp float a_"+i+"_t;\nattribute "+t+" "+r+" a_"+i+";\nvarying "+t+" "+o+" "+i+";\n#else\nuniform "+t+" "+o+" u_"+i+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+i+"\n    "+i+" = unpack_mix_"+r+"(a_"+i+", a_"+i+"_t);\n#else\n    "+t+" "+o+" "+i+" = u_"+i+";\n#endif\n":"define"===n?"\n#ifndef HAS_UNIFORM_u_"+i+"\nuniform lowp float a_"+i+"_t;\nattribute "+t+" "+r+" a_"+i+";\n#else\nuniform "+t+" "+o+" u_"+i+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+i+"\n    "+t+" "+o+" "+i+" = unpack_mix_"+r+"(a_"+i+", a_"+i+"_t);\n#else\n    "+t+" "+o+" "+i+" = u_"+i+";\n#endif\n"})};for(var programName in shaders)loop(programName);module.exports=shaders},{}],98:[function(_dereq_,module,exports){var ImageSource=_dereq_("./image_source"),window=_dereq_("../util/window"),rasterBoundsAttributes=_dereq_("../data/raster_bounds_attributes"),VertexArrayObject=_dereq_("../render/vertex_array_object"),Texture=_dereq_("../render/texture"),CanvasSource=function(t){function e(e,i,s,a){t.call(this,e,i,s,a),this.options=i,this.animate=void 0===i.animate||i.animate}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){this.canvas=this.canvas||window.document.getElementById(this.options.canvas),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire("error",new Error("Canvas dimensions cannot be less than or equal to zero.")):(this.play=function(){this._playing=!0,this.map._rerender()},this.pause=function(){this._playing=!1},this._finishLoading())},e.prototype.getCanvas=function(){return this.canvas},e.prototype.onAdd=function(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()},e.prototype.onRemove=function(){this.pause()},e.prototype.prepare=function(){var t=this,e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var i=this.map.painter.context,s=i.gl;for(var a in this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,rasterBoundsAttributes.members)),this.boundsVAO||(this.boundsVAO=new VertexArrayObject),this.texture?e?this.texture.update(this.canvas):this._playing&&(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.canvas)):(this.texture=new Texture(i,this.canvas,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE)),t.tiles){var r=t.tiles[a];"loaded"!==r.state&&(r.state="loaded",r.texture=t.texture)}}},e.prototype.serialize=function(){return{type:"canvas",canvas:this.canvas,coordinates:this.coordinates}},e.prototype.hasTransition=function(){return this._playing},e.prototype._hasInvalidDimensions=function(){for(var e=0,i=[this.canvas.width,this.canvas.height];e<i.length;e+=1){var s=i[e];if(isNaN(s)||s<=0)return!0}return!1},e}(ImageSource);module.exports=CanvasSource},{"../data/raster_bounds_attributes":59,"../render/texture":93,"../render/vertex_array_object":95,"../util/window":254,"./image_source":102}],99:[function(_dereq_,module,exports){var Evented=_dereq_("../util/evented"),util=_dereq_("../util/util"),window=_dereq_("../util/window"),EXTENT=_dereq_("../data/extent"),ResourceType=_dereq_("../util/ajax").ResourceType,browser=_dereq_("../util/browser"),GeoJSONSource=function(e){function t(t,i,o,r){e.call(this),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this.dispatcher=o,this.setEventedParent(r),this._data=i.data,this._options=util.extend({},i),this._collectResourceTiming=i.collectResourceTiming,this._resourceTiming=[],void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type);var s=EXTENT/this.tileSize;this.workerOptions=util.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*s,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*s,extent:EXTENT,maxZoom:this.maxzoom},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?Math.min(i.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:EXTENT,radius:(i.clusterRadius||50)*s,log:!1}},i.workerOptions)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.load=function(){var e=this;this.fire("dataloading",{dataType:"source"}),this._updateWorkerData(function(t){if(t)e.fire("error",{error:t});else{var i={dataType:"source",sourceDataType:"metadata"};e._collectResourceTiming&&e._resourceTiming&&e._resourceTiming.length>0&&(i.resourceTiming=e._resourceTiming,e._resourceTiming=[]),e.fire("data",i)}})},t.prototype.onAdd=function(e){this.map=e,this.load()},t.prototype.setData=function(e){var t=this;return this._data=e,this.fire("dataloading",{dataType:"source"}),this._updateWorkerData(function(e){if(e)return t.fire("error",{error:e});var i={dataType:"source",sourceDataType:"content"};t._collectResourceTiming&&t._resourceTiming&&t._resourceTiming.length>0&&(i.resourceTiming=t._resourceTiming,t._resourceTiming=[]),t.fire("data",i)}),this},t.prototype._updateWorkerData=function(e){var t=this,i=util.extend({},this.workerOptions),o=this._data;"string"==typeof o?(i.request=this.map._transformRequest(function resolveURL(e){var t=window.document.createElement("a");return t.href=e,t.href}(o),ResourceType.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(o),this.workerID=this.dispatcher.send(this.type+".loadData",i,function(i,o){t._loaded=!0,o&&o.resourceTiming&&o.resourceTiming[t.id]&&(t._resourceTiming=o.resourceTiming[t.id].slice(0)),e(i)},this.workerID)},t.prototype.loadTile=function(e,t){var i=this,o=void 0===e.workerID||"expired"===e.state?"loadTile":"reloadTile",r={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:browser.devicePixelRatio,overscaling:e.tileID.overscaleFactor(),showCollisionBoxes:this.map.showCollisionBoxes};e.workerID=this.dispatcher.send(o,r,function(r,s){return e.unloadVectorData(),e.aborted?t(null):r?t(r):(e.loadVectorData(s,i.map.painter,"reloadTile"===o),t(null))},this.workerID)},t.prototype.abortTile=function(e){e.aborted=!0},t.prototype.unloadTile=function(e){e.unloadVectorData(),this.dispatcher.send("removeTile",{uid:e.uid,type:this.type,source:this.id},null,e.workerID)},t.prototype.onRemove=function(){this.dispatcher.broadcast("removeSource",{type:this.type,source:this.id})},t.prototype.serialize=function(){return util.extend({},this._options,{type:this.type,data:this._data})},t.prototype.hasTransition=function(){return!1},t}(Evented);module.exports=GeoJSONSource},{"../data/extent":53,"../util/ajax":251,"../util/browser":252,"../util/evented":260,"../util/util":275,"../util/window":254}],100:[function(_dereq_,module,exports){function loadGeoJSONTile(e,r){var t=e.source,o=e.tileID.canonical;if(!this._geoJSONIndexes[t])return r(null,null);var u=this._geoJSONIndexes[t].getTile(o.z,o.x,o.y);if(!u)return r(null,null);var n=new GeoJSONWrapper(u.features),i=vtpbf(n);0===i.byteOffset&&i.byteLength===i.buffer.byteLength||(i=new Uint8Array(i)),r(null,{vectorTile:n,rawData:i.buffer})}var ajax=_dereq_("../util/ajax"),perf=_dereq_("../util/performance"),rewind=_dereq_("geojson-rewind"),GeoJSONWrapper=_dereq_("./geojson_wrapper"),vtpbf=_dereq_("vt-pbf"),supercluster=_dereq_("supercluster"),geojsonvt=_dereq_("geojson-vt"),GeoJSONWorkerSource=function(e){function r(r,t,o){e.call(this,r,t,loadGeoJSONTile),o&&(this.loadGeoJSON=o),this._geoJSONIndexes={}}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.loadData=function(e,r){var t=this;this.loadGeoJSON(e,function(o,u){if(o||!u)return r(o);if("object"!=typeof u)return r(new Error("Input data is not a valid GeoJSON object."));rewind(u,!0);try{t._geoJSONIndexes[e.source]=e.cluster?supercluster(e.superclusterOptions).load(u.features):geojsonvt(u,e.geojsonVtOptions)}catch(o){return r(o)}t.loaded[e.source]={};var n={};if(e.request&&e.request.collectResourceTiming){var i=perf.getEntriesByName(e.request.url);i&&(n.resourceTiming={},n.resourceTiming[e.source]=JSON.parse(JSON.stringify(i)))}r(null,n)})},r.prototype.reloadTile=function(r,t){var o=this.loaded[r.source],u=r.uid;return o&&o[u]?e.prototype.reloadTile.call(this,r,t):this.loadTile(r,t)},r.prototype.loadGeoJSON=function(e,r){if(e.request)ajax.getJSON(e.request,r);else{if("string"!=typeof e.data)return r(new Error("Input data is not a valid GeoJSON object."));try{return r(null,JSON.parse(e.data))}catch(e){return r(new Error("Input data is not a valid GeoJSON object."))}}},r.prototype.removeSource=function(e,r){this._geoJSONIndexes[e.source]&&delete this._geoJSONIndexes[e.source],r()},r}(_dereq_("./vector_tile_worker_source"));module.exports=GeoJSONWorkerSource},{"../util/ajax":251,"../util/performance":268,"./geojson_wrapper":101,"./vector_tile_worker_source":116,"geojson-rewind":15,"geojson-vt":19,supercluster:32,"vt-pbf":34}],101:[function(_dereq_,module,exports){var Point=_dereq_("@mapbox/point-geometry"),toGeoJSON=_dereq_("@mapbox/vector-tile").VectorTileFeature.prototype.toGeoJSON,EXTENT=_dereq_("../data/extent"),FeatureWrapper=function(e){this._feature=e,this.extent=EXTENT,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))};FeatureWrapper.prototype.loadGeometry=function(){if(1===this._feature.type){for(var t=[],r=0,o=this._feature.geometry;r<o.length;r+=1){var a=o[r];t.push([new Point(a[0],a[1])])}return t}for(var i=[],p=0,n=this._feature.geometry;p<n.length;p+=1){for(var u=[],h=0,f=n[p];h<f.length;h+=1){var l=f[h];u.push(new Point(l[0],l[1]))}i.push(u)}return i},FeatureWrapper.prototype.toGeoJSON=function(e,t,r){return toGeoJSON.call(this,e,t,r)};var GeoJSONWrapper=function(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=EXTENT,this.length=e.length,this._features=e};GeoJSONWrapper.prototype.feature=function(e){return new FeatureWrapper(this._features[e])},module.exports=GeoJSONWrapper},{"../data/extent":53,"@mapbox/point-geometry":4,"@mapbox/vector-tile":8}],102:[function(_dereq_,module,exports){var util=_dereq_("../util/util"),CanonicalTileID=_dereq_("./tile_id").CanonicalTileID,LngLat=_dereq_("../geo/lng_lat"),Point=_dereq_("@mapbox/point-geometry"),Evented=_dereq_("../util/evented"),ajax=_dereq_("../util/ajax"),browser=_dereq_("../util/browser"),EXTENT=_dereq_("../data/extent"),RasterBoundsArray=_dereq_("../data/array_types").RasterBoundsArray,rasterBoundsAttributes=_dereq_("../data/raster_bounds_attributes"),VertexArrayObject=_dereq_("../render/vertex_array_object"),Texture=_dereq_("../render/texture"),ImageSource=function(t){function e(e,r,o,i){t.call(this),this.id=e,this.dispatcher=o,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this.setEventedParent(i),this.options=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;this.fire("dataloading",{dataType:"source"}),this.url=this.options.url,ajax.getImage(this.map._transformRequest(this.url,ajax.ResourceType.Image),function(e,r){e?t.fire("error",{error:e}):r&&(t.image=browser.getImageData(r),t._finishLoading())})},e.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire("data",{dataType:"source",sourceDataType:"metadata"}))},e.prototype.onAdd=function(t){this.map=t,this.load()},e.prototype.setCoordinates=function(t){this.coordinates=t;var e=this.map,r=t.map(function(t){return e.transform.locationCoordinate(LngLat.convert(t)).zoomTo(0)}),o=this.centerCoord=util.getCoordinatesCenter(r);o.column=Math.floor(o.column),o.row=Math.floor(o.row),this.tileID=new CanonicalTileID(o.zoom,o.column,o.row),this.minzoom=this.maxzoom=o.zoom;var i=r.map(function(t){var e=t.zoomTo(o.zoom);return new Point(Math.round((e.column-o.column)*EXTENT),Math.round((e.row-o.row)*EXTENT))});return this._boundsArray=new RasterBoundsArray,this._boundsArray.emplaceBack(i[0].x,i[0].y,0,0),this._boundsArray.emplaceBack(i[1].x,i[1].y,EXTENT,0),this._boundsArray.emplaceBack(i[3].x,i[3].y,0,EXTENT),this._boundsArray.emplaceBack(i[2].x,i[2].y,EXTENT,EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire("data",{dataType:"source",sourceDataType:"content"}),this},e.prototype.prepare=function(){var t=this;if(0!==Object.keys(this.tiles).length&&this.image){var e=this.map.painter.context,r=e.gl;for(var o in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,rasterBoundsAttributes.members)),this.boundsVAO||(this.boundsVAO=new VertexArrayObject),this.texture||(this.texture=new Texture(e,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),t.tiles){var i=t.tiles[o];"loaded"!==i.state&&(i.state="loaded",i.texture=t.texture)}}},e.prototype.loadTile=function(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))},e.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},e.prototype.hasTransition=function(){return!1},e}(Evented);module.exports=ImageSource},{"../data/array_types":39,"../data/extent":53,"../data/raster_bounds_attributes":59,"../geo/lng_lat":62,"../render/texture":93,"../render/vertex_array_object":95,"../util/ajax":251,"../util/browser":252,"../util/evented":260,"../util/util":275,"./tile_id":114,"@mapbox/point-geometry":4}],103:[function(_dereq_,module,exports){var util=_dereq_("../util/util"),ajax=_dereq_("../util/ajax"),browser=_dereq_("../util/browser"),normalizeURL=_dereq_("../util/mapbox").normalizeSourceURL;module.exports=function(r,e,o){var u=function(r,e){if(r)return o(r);if(e){var u=util.pick(e,["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds"]);e.vector_layers&&(u.vectorLayers=e.vector_layers,u.vectorLayerIds=u.vectorLayers.map(function(r){return r.id})),o(null,u)}};r.url?ajax.getJSON(e(normalizeURL(r.url),ajax.ResourceType.Source),u):browser.frame(function(){return u(null,r)})}},{"../util/ajax":251,"../util/browser":252,"../util/mapbox":267,"../util/util":275}],104:[function(_dereq_,module,exports){var EXTENT=_dereq_("../data/extent");module.exports=function(e,t,r){return t*(EXTENT/(e.tileSize*Math.pow(2,r-e.tileID.overscaledZ)))}},{"../data/extent":53}],105:[function(_dereq_,module,exports){function sortTilesIn(e,r){var a=e.tileID,n=r.tileID;return a.overscaledZ-n.overscaledZ||a.canonical.y-n.canonical.y||a.wrap-n.wrap||a.canonical.x-n.canonical.x}exports.rendered=function(e,r,a,n,t,u,l){var o=e.tilesIn(a);o.sort(sortTilesIn);for(var s=[],i=0,c=o;i<c.length;i+=1){var d=c[i];s.push({wrappedTileID:d.tileID.wrapped().key,queryResults:d.tile.queryRenderedFeatures(r,d.queryGeometry,d.scale,n,u,e.id,l)})}return function mergeRenderedFeatureLayers(e){for(var r={},a={},n=0,t=e;n<t.length;n+=1){var u=t[n],l=u.queryResults,o=u.wrappedTileID,s=a[o]=a[o]||{};for(var i in l)for(var c=l[i],d=s[i]=s[i]||{},f=r[i]=r[i]||[],p=0,v=c;p<v.length;p+=1){var y=v[p];d[y.featureIndex]||(d[y.featureIndex]=!0,f.push(y.feature))}}return r}(s)},exports.source=function(e,r){for(var a=e.getRenderableIds().map(function(r){return e.getTileByID(r)}),n=[],t={},u=0;u<a.length;u++){var l=a[u],o=l.tileID.canonical.key;t[o]||(t[o]=!0,l.querySourceFeatures(n,r))}return n}},{}],106:[function(_dereq_,module,exports){var ajax=_dereq_("../util/ajax"),util=_dereq_("../util/util"),normalizeURL=(_dereq_("../util/evented"),_dereq_("../util/mapbox").normalizeTileURL),browser=_dereq_("../util/browser"),OverscaledTileID=_dereq_("./tile_id").OverscaledTileID,RasterDEMTileSource=function(e){function r(r,i,t,l){e.call(this,r,i,t,l),this.type="raster-dem",this.maxzoom=22,this._options=util.extend({},i)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds}},r.prototype.loadTile=function(e,r){var l=normalizeURL(e.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);e.request=ajax.getImage(this.map._transformRequest(l,ajax.ResourceType.Tile),function i(i,l){if(delete e.request,e.aborted)e.state="unloaded",r(null);else if(i)e.state="errored",r(i);else if(l){this.map._refreshExpiredTiles&&e.setExpiryData(l),delete l.cacheControl,delete l.expires;var a=browser.getImageData(l),s={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:a};e.workerID&&"expired"!==e.state||(e.workerID=this.dispatcher.send("loadDEMTile",s,function t(i,t){i&&(e.state="errored",r(i)),t&&(e.dem=t,e.needsHillshadePrepare=!0,e.state="loaded",r(null))}.bind(this)))}}.bind(this)),e.neighboringTiles=this._getNeighboringTiles(e.tileID)},r.prototype._getNeighboringTiles=function(e){var r=e.canonical,i=Math.pow(2,r.z),t=(r.x-1+i)%i,l=0===r.x?e.wrap-1:e.wrap,a=(r.x+1+i)%i,s=r.x+1===i?e.wrap+1:e.wrap,o={};return o[new OverscaledTileID(e.overscaledZ,l,r.z,t,r.y).key]={backfilled:!1},o[new OverscaledTileID(e.overscaledZ,s,r.z,a,r.y).key]={backfilled:!1},r.y>0&&(o[new OverscaledTileID(e.overscaledZ,l,r.z,t,r.y-1).key]={backfilled:!1},o[new OverscaledTileID(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},o[new OverscaledTileID(e.overscaledZ,s,r.z,a,r.y-1).key]={backfilled:!1}),r.y+1<i&&(o[new OverscaledTileID(e.overscaledZ,l,r.z,t,r.y+1).key]={backfilled:!1},o[new OverscaledTileID(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},o[new OverscaledTileID(e.overscaledZ,s,r.z,a,r.y+1).key]={backfilled:!1}),o},r.prototype.unloadTile=function(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",this.dispatcher.send("removeDEMTile",{uid:e.uid,source:this.id},void 0,e.workerID)},r}(_dereq_("./raster_tile_source"));module.exports=RasterDEMTileSource},{"../util/ajax":251,"../util/browser":252,"../util/evented":260,"../util/mapbox":267,"../util/util":275,"./raster_tile_source":108,"./tile_id":114}],107:[function(_dereq_,module,exports){var DEMData=_dereq_("../data/dem_data").DEMData,RasterDEMTileWorkerSource=function(){this.loading={},this.loaded={}};RasterDEMTileWorkerSource.prototype.loadTile=function(e,a){var o=e.source,r=e.uid;this.loading[o]||(this.loading[o]={});var t=new DEMData(r);this.loading[o][r]=t,t.loadFromImage(e.rawImageData),delete this.loading[o][r],this.loaded[o]=this.loaded[o]||{},this.loaded[o][r]=t,a(null,t)},RasterDEMTileWorkerSource.prototype.removeTile=function(e){var a=this.loaded[e.source],o=e.uid;a&&a[o]&&delete a[o]},module.exports=RasterDEMTileWorkerSource},{"../data/dem_data":52}],108:[function(_dereq_,module,exports){var util=_dereq_("../util/util"),ajax=_dereq_("../util/ajax"),Evented=_dereq_("../util/evented"),loadTileJSON=_dereq_("./load_tilejson"),normalizeURL=_dereq_("../util/mapbox").normalizeTileURL,TileBounds=_dereq_("./tile_bounds"),Texture=_dereq_("../render/texture"),RasterTileSource=function(e){function t(t,i,r,o){e.call(this),this.id=t,this.dispatcher=r,this.setEventedParent(o),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=util.extend({},i),util.extend(this,util.pick(i,["url","scheme","tileSize"]))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.load=function(){var e=this;this.fire("dataloading",{dataType:"source"}),loadTileJSON(this._options,this.map._transformRequest,function(t,i){t?e.fire("error",t):i&&(util.extend(e,i),i.bounds&&(e.tileBounds=new TileBounds(i.bounds,e.minzoom,e.maxzoom)),e.fire("data",{dataType:"source",sourceDataType:"metadata"}),e.fire("data",{dataType:"source",sourceDataType:"content"}))})},t.prototype.onAdd=function(e){this.map=e,this.load()},t.prototype.serialize=function(){return util.extend({},this._options)},t.prototype.hasTile=function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)},t.prototype.loadTile=function(e,t){var i=this,r=normalizeURL(e.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);e.request=ajax.getImage(this.map._transformRequest(r,ajax.ResourceType.Tile),function(r,o){if(delete e.request,e.aborted)e.state="unloaded",t(null);else if(r)e.state="errored",t(r);else if(o){i.map._refreshExpiredTiles&&e.setExpiryData(o),delete o.cacheControl,delete o.expires;var a=i.map.painter.context,n=a.gl;e.texture=i.map.painter.getTileTexture(o.width),e.texture?(e.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE,n.LINEAR_MIPMAP_NEAREST),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,o)):(e.texture=new Texture(a,o,n.RGBA),e.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE,n.LINEAR_MIPMAP_NEAREST),a.extTextureFilterAnisotropic&&n.texParameterf(n.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax)),n.generateMipmap(n.TEXTURE_2D),e.state="loaded",t(null)}})},t.prototype.abortTile=function(e,t){e.request&&(e.request.abort(),delete e.request),t()},t.prototype.unloadTile=function(e,t){e.texture&&this.map.painter.saveTileTexture(e.texture),t()},t.prototype.hasTransition=function(){return!1},t}(Evented);module.exports=RasterTileSource},{"../render/texture":93,"../util/ajax":251,"../util/evented":260,"../util/mapbox":267,"../util/util":275,"./load_tilejson":103,"./tile_bounds":113}],109:[function(_dereq_,module,exports){var ajax=_dereq_("../util/ajax"),Evented=_dereq_("../util/evented"),window=_dereq_("../util/window"),pluginRequested=!1,pluginBlobURL=null;module.exports.evented=new Evented,module.exports.registerForPluginAvailability=function(e){return pluginBlobURL?e({pluginBlobURL:pluginBlobURL,errorCallback:module.exports.errorCallback}):module.exports.evented.once("pluginAvailable",e),e},module.exports.createBlobURL=function(e){return window.URL.createObjectURL(new window.Blob([e.data],{type:"text/javascript"}))},module.exports.clearRTLTextPlugin=function(){pluginRequested=!1,pluginBlobURL=null},module.exports.setRTLTextPlugin=function(e,l){if(pluginRequested)throw new Error("setRTLTextPlugin cannot be called multiple times.");pluginRequested=!0,module.exports.errorCallback=l,ajax.getArrayBuffer({url:e},function(e,t){e?l(e):t&&(pluginBlobURL=module.exports.createBlobURL(t),module.exports.evented.fire("pluginAvailable",{pluginBlobURL:pluginBlobURL,errorCallback:l}))})},module.exports.applyArabicShaping=null,module.exports.processBidirectionalText=null},{"../util/ajax":251,"../util/evented":260,"../util/window":254}],110:[function(_dereq_,module,exports){var util=_dereq_("../util/util"),sourceTypes={vector:_dereq_("../source/vector_tile_source"),raster:_dereq_("../source/raster_tile_source"),"raster-dem":_dereq_("../source/raster_dem_tile_source"),geojson:_dereq_("../source/geojson_source"),video:_dereq_("../source/video_source"),image:_dereq_("../source/image_source"),canvas:_dereq_("../source/canvas_source")};exports.create=function(e,r,o,s){var u=new sourceTypes[r.type](e,r,o,s);if(u.id!==e)throw new Error("Expected Source id to be "+e+" instead of "+u.id);return util.bindAll(["load","abort","unload","serialize","prepare"],u),u},exports.getType=function(e){return sourceTypes[e]},exports.setType=function(e,r){sourceTypes[e]=r}},{"../source/canvas_source":98,"../source/geojson_source":99,"../source/image_source":102,"../source/raster_dem_tile_source":106,"../source/raster_tile_source":108,"../source/vector_tile_source":115,"../source/video_source":117,"../util/util":275}],111:[function(_dereq_,module,exports){function coordinateToTilePoint(e,t){var i=t.zoomTo(e.canonical.z);return new Point((i.column-(e.canonical.x+e.wrap*Math.pow(2,e.canonical.z)))*EXTENT,(i.row-e.canonical.y)*EXTENT)}function isRasterType(e){return"raster"===e||"image"===e||"video"===e}var createSource=_dereq_("./source").create,Tile=_dereq_("./tile"),Evented=_dereq_("../util/evented"),Cache=_dereq_("../util/lru_cache"),Coordinate=_dereq_("../geo/coordinate"),util=_dereq_("../util/util"),EXTENT=_dereq_("../data/extent"),Point=(_dereq_("../gl/context"),_dereq_("@mapbox/point-geometry")),browser=_dereq_("../util/browser"),OverscaledTileID=_dereq_("./tile_id").OverscaledTileID,SourceCache=function(e){function t(t,i,r){var o=this;e.call(this),this.id=t,this.dispatcher=r,this.on("data",function(e){"source"===e.dataType&&"metadata"===e.sourceDataType&&(o._sourceLoaded=!0),o._sourceLoaded&&!o._paused&&"source"===e.dataType&&"content"===e.sourceDataType&&(o.reload(),o.transform&&o.update(o.transform))}),this.on("error",function(){o._sourceErrored=!0}),this._source=createSource(t,i,r,this),this._tiles={},this._cache=new Cache(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._isIdRenderable=this._isIdRenderable.bind(this),this._coveredTiles={}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.onAdd=function(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(e)},t.prototype.onRemove=function(e){this._source&&this._source.onRemove&&this._source.onRemove(e)},t.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;for(var t in this._tiles){var i=this._tiles[t];if("loaded"!==i.state&&"errored"!==i.state)return!1}return!0},t.prototype.getSource=function(){return this._source},t.prototype.pause=function(){this._paused=!0},t.prototype.resume=function(){if(this._paused){var e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}},t.prototype._loadTile=function(e,t){return this._source.loadTile(e,t)},t.prototype._unloadTile=function(e){if(this._source.unloadTile)return this._source.unloadTile(e,function(){})},t.prototype._abortTile=function(e){if(this._source.abortTile)return this._source.abortTile(e,function(){})},t.prototype.serialize=function(){return this._source.serialize()},t.prototype.prepare=function(e){for(var i in this._source.prepare&&this._source.prepare(),this._tiles)this._tiles[i].upload(e)},t.prototype.getIds=function(){var e=this;return Object.keys(this._tiles).map(Number).sort(function(t,i){var r=e._tiles[t].tileID,o=e._tiles[i].tileID,a=new Point(r.canonical.x,r.canonical.y).rotate(e.transform.angle),s=new Point(o.canonical.x,o.canonical.y).rotate(e.transform.angle);return r.overscaledZ-o.overscaledZ||s.y-a.y||s.x-a.x})},t.prototype.getRenderableIds=function(){return this.getIds().filter(this._isIdRenderable)},t.prototype.hasRenderableParent=function(e){var t=this.findLoadedParent(e,0,{});return!!t&&this._isIdRenderable(t.tileID.key)},t.prototype._isIdRenderable=function(e){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]},t.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var t in this._resetCache(),this._tiles)this._reloadTile(t,"reloading")},t.prototype._reloadTile=function(e,t){var i=this._tiles[e];i&&("loading"!==i.state&&(i.state=t),this._loadTile(i,this._tileLoaded.bind(this,i,e,t)))},t.prototype._tileLoaded=function(e,t,i,r){if(r)return e.state="errored",void(404!==r.status?this._source.fire("error",{tile:e,error:r}):this.update(this.transform));e.timeAdded=browser.now(),"expired"===i&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(t,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._source.fire("data",{dataType:"source",tile:e,coord:e.tileID}),this.map&&(this.map.painter.tileExtentVAO.vao=null)},t.prototype._backfillDEM=function(e){function t(e,t){e.needsHillshadePrepare=!0;var i=t.tileID.canonical.x-e.tileID.canonical.x,r=t.tileID.canonical.y-e.tileID.canonical.y,o=Math.pow(2,e.tileID.canonical.z),a=t.tileID.key;0===i&&0===r||Math.abs(r)>1||(Math.abs(i)>1&&(1===Math.abs(i+o)?i+=o:1===Math.abs(i-o)&&(i-=o)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,i,r),e.neighboringTiles&&e.neighboringTiles[a]&&(e.neighboringTiles[a].backfilled=!0)))}for(var r=this.getRenderableIds(),o=0;o<r.length;o++){var a=r[o];if(e.neighboringTiles&&e.neighboringTiles[a]){var s=this.getTileByID(a);t(e,s),t(s,e)}}},t.prototype.getTile=function(e){return this.getTileByID(e.key)},t.prototype.getTileByID=function(e){return this._tiles[e]},t.prototype.getZoom=function(e){return e.zoom+e.scaleZoom(e.tileSize/this._source.tileSize)},t.prototype._findLoadedChildren=function(e,t,i){var r=this,o=!1;for(var a in r._tiles){var s=r._tiles[a];if(!(i[a]||!s.hasData()||s.tileID.overscaledZ<=e.overscaledZ||s.tileID.overscaledZ>t)){var n=Math.pow(2,s.tileID.canonical.z-e.canonical.z);if(Math.floor(s.tileID.canonical.x/n)===e.canonical.x&&Math.floor(s.tileID.canonical.y/n)===e.canonical.y)for(i[a]=s.tileID,o=!0;s&&s.tileID.overscaledZ-1>e.overscaledZ;){var l=s.tileID.scaledTo(s.tileID.overscaledZ-1);if(!l)break;(s=r._tiles[l.key])&&s.hasData()&&(delete i[a],i[l.key]=l)}}}return o},t.prototype.findLoadedParent=function(e,t,i){for(var r=this,o=e.overscaledZ-1;o>=t;o--){var a=e.scaledTo(o);if(!a)return;var s=String(a.key),n=r._tiles[s];if(n&&n.hasData())return i[s]=a,n;if(r._cache.has(s))return i[s]=a,r._cache.get(s)}},t.prototype.updateCacheSize=function(e){var r=(Math.ceil(e.width/this._source.tileSize)+1)*(Math.ceil(e.height/this._source.tileSize)+1),o=Math.floor(5*r),a="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,o):o;this._cache.setMaxSize(a)},t.prototype.update=function(e){var i=this;if(this.transform=e,this._sourceLoaded&&!this._paused){var r;this.updateCacheSize(e),this._coveredTiles={},this.used?this._source.tileID?r=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(e){return new OverscaledTileID(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)}):(r=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(r=r.filter(function(e){return i._source.hasTile(e)}))):r=[];var m,o=(this._source.roundZoom?Math.round:Math.floor)(this.getZoom(e)),a=Math.max(o-t.maxOverzooming,this._source.minzoom),s=Math.max(o+t.maxUnderzooming,this._source.minzoom),n=this._updateRetainedTiles(r,o),l={};if(isRasterType(this._source.type))for(var c=Object.keys(n),h=0;h<c.length;h++){var d=c[h],u=n[d],_=i._tiles[d];if(_&&(void 0===_.fadeEndTime||_.fadeEndTime>=browser.now())){i._findLoadedChildren(u,s,n)&&(n[d]=u);var p=i.findLoadedParent(u,a,l);p&&i._addTile(p.tileID)}}for(m in l)n[m]||(i._coveredTiles[m]=!0);for(m in l)n[m]=l[m];for(var f=util.keysDifference(this._tiles,n),T=0;T<f.length;T++)i._removeTile(f[T])}},t.prototype._updateRetainedTiles=function(e,i){for(var r=this,o={},a={},s=Math.max(i-t.maxOverzooming,this._source.minzoom),n=Math.max(i+t.maxUnderzooming,this._source.minzoom),l=0;l<e.length;l++){var c=e[l],h=r._addTile(c),d=!1;if(h.hasData())o[c.key]=c;else{d=h.wasRequested(),o[c.key]=c;var u=!0;if(i+1>r._source.maxzoom){var _=c.children(r._source.maxzoom)[0],p=r.getTile(_);p&&p.hasData()?o[_.key]=_:u=!1}else{r._findLoadedChildren(c,n,o);for(var m=c.children(r._source.maxzoom),f=0;f<m.length;f++)if(!o[m[f].key]){u=!1;break}}if(!u)for(var T=c.overscaledZ-1;T>=s;--T){var v=c.scaledTo(T);if(a[v.key])break;if(a[v.key]=!0,!(h=r.getTile(v))&&d&&(h=r._addTile(v)),h&&(o[v.key]=v,d=h.wasRequested(),h.hasData()))break}}}return o},t.prototype._addTile=function(e){var t=this._tiles[e.key];if(t)return t;(t=this._cache.getAndRemove(e.key))&&this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,t));var i=Boolean(t);return i||(t=new Tile(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(t,this._tileLoaded.bind(this,t,e.key,t.state))),t?(t.uses++,this._tiles[e.key]=t,i||this._source.fire("dataloading",{tile:t,coord:t.tileID,dataType:"source"}),t):null},t.prototype._setTileReloadTimer=function(e,t){var i=this;e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);var r=t.getExpiryTimeout();r&&(this._timers[e]=setTimeout(function(){i._reloadTile(e,"expired"),delete i._timers[e]},r))},t.prototype._setCacheInvalidationTimer=function(e,t){var i=this;e in this._cacheTimers&&(clearTimeout(this._cacheTimers[e]),delete this._cacheTimers[e]);var r=t.getExpiryTimeout();r&&(this._cacheTimers[e]=setTimeout(function(){i._cache.remove(e),delete i._cacheTimers[e]},r))},t.prototype._removeTile=function(e){var t=this._tiles[e];if(t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),!(t.uses>0)))if(t.hasData()){t.tileID=t.tileID.wrapped();var i=t.tileID.key;this._cache.add(i,t),this._setCacheInvalidationTimer(i,t)}else t.aborted=!0,this._abortTile(t),this._unloadTile(t)},t.prototype.clearTiles=function(){for(var t in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(t);this._resetCache()},t.prototype._resetCache=function(){for(var t in this._cacheTimers)clearTimeout(this._cacheTimers[t]);this._cacheTimers={},this._cache.reset()},t.prototype.tilesIn=function(e){for(var i=[],r=this.getIds(),o=1/0,a=1/0,s=-1/0,n=-1/0,l=e[0].zoom,c=0;c<e.length;c++){var h=e[c];o=Math.min(o,h.column),a=Math.min(a,h.row),s=Math.max(s,h.column),n=Math.max(n,h.row)}for(var d=0;d<r.length;d++){var u=this._tiles[r[d]],_=u.tileID,p=[coordinateToTilePoint(_,new Coordinate(o,a,l)),coordinateToTilePoint(_,new Coordinate(s,n,l))];if(p[0].x<EXTENT&&p[0].y<EXTENT&&p[1].x>=0&&p[1].y>=0){for(var m=[],f=0;f<e.length;f++)m.push(coordinateToTilePoint(_,e[f]));i.push({tile:u,tileID:_,queryGeometry:[m],scale:Math.pow(2,this.transform.zoom-u.tileID.overscaledZ)})}}return i},t.prototype.getVisibleCoordinates=function(){for(var e=this,t=this.getRenderableIds().map(function(t){return e._tiles[t].tileID}),i=0,r=t;i<r.length;i+=1){var o=r[i];o.posMatrix=e.transform.calculatePosMatrix(o.toUnwrapped())}return t},t.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(isRasterType(this._source.type))for(var t in this._tiles){var i=this._tiles[t];if(void 0!==i.fadeEndTime&&i.fadeEndTime>=browser.now())return!0}return!1},t}(Evented);SourceCache.maxOverzooming=10,SourceCache.maxUnderzooming=3,module.exports=SourceCache},{"../data/extent":53,"../geo/coordinate":61,"../gl/context":66,"../util/browser":252,"../util/evented":260,"../util/lru_cache":266,"../util/util":275,"./source":110,"./tile":112,"./tile_id":114,"@mapbox/point-geometry":4}],112:[function(_dereq_,module,exports){var util=_dereq_("../util/util"),deserializeBucket=_dereq_("../data/bucket").deserialize,vt=(_dereq_("../data/feature_index"),_dereq_("@mapbox/vector-tile")),Protobuf=_dereq_("pbf"),GeoJSONFeature=_dereq_("../util/vectortile_to_geojson"),featureFilter=_dereq_("../style-spec/feature_filter"),SymbolBucket=(_dereq_("../symbol/collision_index"),_dereq_("../data/bucket/symbol_bucket")),ref=_dereq_("../data/array_types"),RasterBoundsArray=ref.RasterBoundsArray,CollisionBoxArray=ref.CollisionBoxArray,rasterBoundsAttributes=_dereq_("../data/raster_bounds_attributes"),EXTENT=_dereq_("../data/extent"),Point=_dereq_("@mapbox/point-geometry"),Texture=_dereq_("../render/texture"),SegmentVector=_dereq_("../data/segment").SegmentVector,TriangleIndexArray=_dereq_("../data/index_array_type").TriangleIndexArray,browser=_dereq_("../util/browser"),Tile=function(e,t){this.tileID=e,this.uid=util.uniqueId(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.expiredRequestCount=0,this.state="loading"};Tile.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<browser.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},Tile.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},Tile.prototype.loadVectorData=function(e,t,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){if(e.rawTileData&&(this.rawTileData=e.rawTileData),this.collisionBoxArray=e.collisionBoxArray,this.featureIndex=e.featureIndex,this.featureIndex.rawTileData=this.rawTileData,this.buckets=deserializeBucket(e.buckets,t.style),i)for(var a in this.buckets){var s=this.buckets[a];s instanceof SymbolBucket&&(s.justReloaded=!0)}e.iconAtlasImage&&(this.iconAtlasImage=e.iconAtlasImage),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new CollisionBoxArray},Tile.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.iconAtlasTexture&&this.iconAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.collisionBoxArray=null,this.featureIndex=null,this.state="unloaded"},Tile.prototype.unloadDEMData=function(){this.dem=null,this.neighboringTiles=null,this.state="unloaded"},Tile.prototype.getBucket=function(e){return this.buckets[e.id]},Tile.prototype.upload=function(e){for(var i in this.buckets){var r=this.buckets[i];r.uploaded||(r.upload(e),r.uploaded=!0)}var a=e.gl;this.iconAtlasImage&&(this.iconAtlasTexture=new Texture(e,this.iconAtlasImage,a.RGBA),this.iconAtlasImage=null),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Texture(e,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)},Tile.prototype.queryRenderedFeatures=function(e,t,i,r,a,s,o){if(!this.featureIndex||!this.collisionBoxArray)return{};var l=0,u={};for(var h in e){var d=this.getBucket(e[h]);d&&(l=Math.max(l,e[h].queryRadius(d)),d instanceof SymbolBucket&&void 0!==d.bucketInstanceId&&(u[d.bucketInstanceId]=!0))}return this.featureIndex.query({queryGeometry:t,scale:i,tileSize:this.tileSize,bearing:a,params:r,additionalRadius:l,collisionBoxArray:this.collisionBoxArray,sourceID:s,collisionIndex:o,bucketInstanceIds:u},e)},Tile.prototype.querySourceFeatures=function(e,t){if(this.rawTileData){this.vtLayers||(this.vtLayers=new vt.VectorTile(new Protobuf(this.rawTileData)).layers);var r=t?t.sourceLayer:"",a=this.vtLayers._geojsonTileLayer||this.vtLayers[r];if(a)for(var s=featureFilter(t&&t.filter),o={z:this.tileID.overscaledZ,x:this.tileID.canonical.x,y:this.tileID.canonical.y},n=0;n<a.length;n++){var l=a.feature(n);if(s({zoom:this.tileID.overscaledZ},l)){var u=new GeoJSONFeature(l,o.z,o.x,o.y);u.tile=o,e.push(u)}}}},Tile.prototype.clearMask=function(){this.segments&&(this.segments.destroy(),delete this.segments),this.maskedBoundsBuffer&&(this.maskedBoundsBuffer.destroy(),delete this.maskedBoundsBuffer),this.maskedIndexBuffer&&(this.maskedIndexBuffer.destroy(),delete this.maskedIndexBuffer)},Tile.prototype.setMask=function(e,t){if(!util.deepEqual(this.mask,e)&&(this.mask=e,this.clearMask(),!util.deepEqual(e,{0:!0}))){var r=new RasterBoundsArray,a=new TriangleIndexArray;this.segments=new SegmentVector,this.segments.prepareSegment(0,r,a);for(var s=Object.keys(e),o=0;o<s.length;o++){var n=e[s[o]],l=EXTENT>>n.z,u=new Point(n.x*l,n.y*l),h=new Point(u.x+l,u.y+l),d=this.segments.prepareSegment(4,r,a);r.emplaceBack(u.x,u.y,u.x,u.y),r.emplaceBack(h.x,u.y,h.x,u.y),r.emplaceBack(u.x,h.y,u.x,h.y),r.emplaceBack(h.x,h.y,h.x,h.y);var c=d.vertexLength;a.emplaceBack(c,c+1,c+2),a.emplaceBack(c+1,c+2,c+3),d.vertexLength+=4,d.primitiveLength+=2}this.maskedBoundsBuffer=t.createVertexBuffer(r,rasterBoundsAttributes.members),this.maskedIndexBuffer=t.createIndexBuffer(a)}},Tile.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},Tile.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var i=util.parseCacheControl(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var r=Date.now(),a=!1;if(this.expirationTime>r)a=!1;else if(t)if(this.expirationTime<t)a=!0;else{var s=this.expirationTime-t;s?this.expirationTime=r+Math.max(s,3e4):a=!0}else a=!0;a?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Tile.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},module.exports=Tile},{"../data/array_types":39,"../data/bucket":40,"../data/bucket/symbol_bucket":51,"../data/extent":53,"../data/feature_index":54,"../data/index_array_type":55,"../data/raster_bounds_attributes":59,"../data/segment":60,"../render/texture":93,"../style-spec/feature_filter":148,"../symbol/collision_index":217,"../util/browser":252,"../util/util":275,"../util/vectortile_to_geojson":276,"@mapbox/point-geometry":4,"@mapbox/vector-tile":8,pbf:30}],113:[function(_dereq_,module,exports){var LngLatBounds=_dereq_("../geo/lng_lat_bounds"),clamp=_dereq_("../util/util").clamp,TileBounds=function(t,n,o){this.bounds=LngLatBounds.convert(this.validateBounds(t)),this.minzoom=n||0,this.maxzoom=o||24};TileBounds.prototype.validateBounds=function(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]},TileBounds.prototype.contains=function(t){var n_minX=Math.floor(this.lngX(this.bounds.getWest(),t.z)),n_minY=Math.floor(this.latY(this.bounds.getNorth(),t.z)),n_maxX=Math.ceil(this.lngX(this.bounds.getEast(),t.z)),n_maxY=Math.ceil(this.latY(this.bounds.getSouth(),t.z));return t.x>=n_minX&&t.x<n_maxX&&t.y>=n_minY&&t.y<n_maxY},TileBounds.prototype.lngX=function(t,n){return(t+180)*(Math.pow(2,n)/360)},TileBounds.prototype.latY=function(t,n){var o=clamp(Math.sin(Math.PI/180*t),-.9999,.9999),a=Math.pow(2,n)/(2*Math.PI);return Math.pow(2,n-1)+.5*Math.log((1+o)/(1-o))*-a},module.exports=TileBounds},{"../geo/lng_lat_bounds":63,"../util/util":275}],114:[function(_dereq_,module,exports){function calculateKey(e,i,a,t){(e*=2)<0&&(e=-1*e-1);var n=1<<i;return 32*(n*n*e+n*t+a)+i}var WhooTS=_dereq_("@mapbox/whoots-js"),register=_dereq_("../util/web_worker_transfer").register,Coordinate=_dereq_("../geo/coordinate"),CanonicalTileID=function(e,i,a){this.z=e,this.x=i,this.y=a,this.key=calculateKey(0,e,i,a)};CanonicalTileID.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},CanonicalTileID.prototype.url=function(e,i){var a=WhooTS.getTileBBox(this.x,this.y,this.z),t=function getQuadkey(e,i,a){for(var t,n="",c=e;c>0;c--)n+=(i&(t=1<<c-1)?1:0)+(a&t?2:0);return n}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===i?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",t).replace("{bbox-epsg-3857}",a)};var UnwrappedTileID=function(e,i){this.wrap=e,this.canonical=i,this.key=calculateKey(e,i.z,i.x,i.y)},OverscaledTileID=function(e,i,a,t,n){this.overscaledZ=e,this.wrap=i,this.canonical=new CanonicalTileID(a,+t,+n),this.key=calculateKey(i,e,t,n)};OverscaledTileID.prototype.scaledTo=function(e){var i=this.canonical.z-e;return e>this.canonical.z?new OverscaledTileID(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new OverscaledTileID(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)},OverscaledTileID.prototype.isChildOf=function(e){var i=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i},OverscaledTileID.prototype.children=function(e){if(this.overscaledZ>=e)return[new OverscaledTileID(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var i=this.canonical.z+1,a=2*this.canonical.x,t=2*this.canonical.y;return[new OverscaledTileID(i,this.wrap,i,a,t),new OverscaledTileID(i,this.wrap,i,a+1,t),new OverscaledTileID(i,this.wrap,i,a,t+1),new OverscaledTileID(i,this.wrap,i,a+1,t+1)]},OverscaledTileID.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},OverscaledTileID.prototype.wrapped=function(){return new OverscaledTileID(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},OverscaledTileID.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},OverscaledTileID.prototype.toUnwrapped=function(){return new UnwrappedTileID(this.wrap,this.canonical)},OverscaledTileID.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},OverscaledTileID.prototype.toCoordinate=function(){return new Coordinate(this.canonical.x+Math.pow(2,this.wrap),this.canonical.y,this.canonical.z)},register("CanonicalTileID",CanonicalTileID),register("OverscaledTileID",OverscaledTileID,{omit:["posMatrix"]}),module.exports={CanonicalTileID:CanonicalTileID,OverscaledTileID:OverscaledTileID,UnwrappedTileID:UnwrappedTileID}},{"../geo/coordinate":61,"../util/web_worker_transfer":278,"@mapbox/whoots-js":12}],115:[function(_dereq_,module,exports){var Evented=_dereq_("../util/evented"),util=_dereq_("../util/util"),loadTileJSON=_dereq_("./load_tilejson"),normalizeURL=_dereq_("../util/mapbox").normalizeTileURL,TileBounds=_dereq_("./tile_bounds"),ResourceType=_dereq_("../util/ajax").ResourceType,browser=_dereq_("../util/browser"),VectorTileSource=function(e){function t(t,i,o,r){if(e.call(this),this.id=t,this.dispatcher=o,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,util.extend(this,util.pick(i,["url","scheme","tileSize"])),this._options=util.extend({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.load=function(){var e=this;this.fire("dataloading",{dataType:"source"}),loadTileJSON(this._options,this.map._transformRequest,function(t,i){t?e.fire("error",t):i&&(util.extend(e,i),i.bounds&&(e.tileBounds=new TileBounds(i.bounds,e.minzoom,e.maxzoom)),e.fire("data",{dataType:"source",sourceDataType:"metadata"}),e.fire("data",{dataType:"source",sourceDataType:"content"}))})},t.prototype.hasTile=function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)},t.prototype.onAdd=function(e){this.map=e,this.load()},t.prototype.serialize=function(){return util.extend({},this._options)},t.prototype.loadTile=function(e,t){function i(i,o){return e.aborted?t(null):i?t(i):(o&&o.resourceTiming&&(e.resourceTiming=o.resourceTiming),this.map._refreshExpiredTiles&&e.setExpiryData(o),e.loadVectorData(o,this.map.painter),t(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}var o=e.tileID.overscaleFactor(),r=normalizeURL(e.tileID.canonical.url(this.tiles,this.scheme),this.url),s={request:this.map._transformRequest(r,ResourceType.Tile),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*o,type:this.type,source:this.id,pixelRatio:browser.devicePixelRatio,overscaling:o,showCollisionBoxes:this.map.showCollisionBoxes};s.request.collectResourceTiming=this._collectResourceTiming,void 0===e.workerID||"expired"===e.state?e.workerID=this.dispatcher.send("loadTile",s,i.bind(this)):"loading"===e.state?e.reloadCallback=t:this.dispatcher.send("reloadTile",s,i.bind(this),e.workerID)},t.prototype.abortTile=function(e){this.dispatcher.send("abortTile",{uid:e.uid,type:this.type,source:this.id},void 0,e.workerID)},t.prototype.unloadTile=function(e){e.unloadVectorData(),this.dispatcher.send("removeTile",{uid:e.uid,type:this.type,source:this.id},void 0,e.workerID)},t.prototype.hasTransition=function(){return!1},t}(Evented);module.exports=VectorTileSource},{"../util/ajax":251,"../util/browser":252,"../util/evented":260,"../util/mapbox":267,"../util/util":275,"./load_tilejson":103,"./tile_bounds":113}],116:[function(_dereq_,module,exports){function loadVectorTile(e,r){var o=ajax.getArrayBuffer(e.request,function(e,o){e?r(e):o&&r(null,{vectorTile:new vt.VectorTile(new Protobuf(o.data)),rawData:o.data,cacheControl:o.cacheControl,expires:o.expires})});return function(){o.abort(),r()}}var ajax=_dereq_("../util/ajax"),vt=_dereq_("@mapbox/vector-tile"),Protobuf=_dereq_("pbf"),WorkerTile=_dereq_("./worker_tile"),util=_dereq_("../util/util"),perf=_dereq_("../util/performance"),VectorTileWorkerSource=function(e,r,o){this.actor=e,this.layerIndex=r,this.loadVectorData=o||loadVectorTile,this.loading={},this.loaded={}};VectorTileWorkerSource.prototype.loadTile=function(e,r){var o=this,t=e.source,i=e.uid;this.loading[t]||(this.loading[t]={});var a=this.loading[t][i]=new WorkerTile(e);a.abort=this.loadVectorData(e,function(l,c){if(delete o.loading[t][i],l||!c)return r(l);var s=c.rawData,n={};c.expires&&(n.expires=c.expires),c.cacheControl&&(n.cacheControl=c.cacheControl);var u={};if(e.request&&e.request.collectResourceTiming){var d=perf.getEntriesByName(e.request.url);d&&(u.resourceTiming=JSON.parse(JSON.stringify(d)))}a.vectorTile=c.vectorTile,a.parse(c.vectorTile,o.layerIndex,o.actor,function(e,o){if(e||!o)return r(e);r(null,util.extend({rawTileData:s.slice(0)},o,n,u))}),o.loaded[t]=o.loaded[t]||{},o.loaded[t][i]=a})},VectorTileWorkerSource.prototype.reloadTile=function(e,r){var t=this.loaded[e.source],i=e.uid,a=this;if(t&&t[i]){var l=t[i];l.showCollisionBoxes=e.showCollisionBoxes,"parsing"===l.status?l.reloadCallback=r:"done"===l.status&&l.parse(l.vectorTile,this.layerIndex,this.actor,function o(e,o){if(this.reloadCallback){var t=this.reloadCallback;delete this.reloadCallback,this.parse(this.vectorTile,a.layerIndex,a.actor,t)}r(e,o)}.bind(l))}},VectorTileWorkerSource.prototype.abortTile=function(e,r){var o=this.loading[e.source],t=e.uid;o&&o[t]&&o[t].abort&&(o[t].abort(),delete o[t]),r()},VectorTileWorkerSource.prototype.removeTile=function(e,r){var o=this.loaded[e.source],t=e.uid;o&&o[t]&&delete o[t],r()},module.exports=VectorTileWorkerSource},{"../util/ajax":251,"../util/performance":268,"../util/util":275,"./worker_tile":119,"@mapbox/vector-tile":8,pbf:30}],117:[function(_dereq_,module,exports){var ajax=_dereq_("../util/ajax"),ImageSource=_dereq_("./image_source"),rasterBoundsAttributes=_dereq_("../data/raster_bounds_attributes"),VertexArrayObject=_dereq_("../render/vertex_array_object"),Texture=_dereq_("../render/texture"),VideoSource=function(e){function t(t,r,i,o){e.call(this,t,r,i,o),this.roundZoom=!0,this.type="video",this.options=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.load=function(){var e=this,t=this.options;this.urls=t.urls,ajax.getVideo(t.urls,function(t,r){t?e.fire("error",{error:t}):r&&(e.video=r,e.video.loop=!0,e.video.addEventListener("playing",function(){e.map._rerender()}),e.map&&e.video.play(),e._finishLoading())})},t.prototype.getVideo=function(){return this.video},t.prototype.onAdd=function(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},t.prototype.prepare=function(){var e=this;if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var t=this.map.painter.context,r=t.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,rasterBoundsAttributes.members)),this.boundsVAO||(this.boundsVAO=new VertexArrayObject),this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new Texture(t,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),e.tiles){var o=e.tiles[i];"loaded"!==o.state&&(o.state="loaded",o.texture=e.texture)}}},t.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},t.prototype.hasTransition=function(){return this.video&&!this.video.paused},t}(ImageSource);module.exports=VideoSource},{"../data/raster_bounds_attributes":59,"../render/texture":93,"../render/vertex_array_object":95,"../util/ajax":251,"./image_source":102}],118:[function(_dereq_,module,exports){var Actor=_dereq_("../util/actor"),StyleLayerIndex=_dereq_("../style/style_layer_index"),VectorTileWorkerSource=_dereq_("./vector_tile_worker_source"),RasterDEMTileWorkerSource=_dereq_("./raster_dem_tile_worker_source"),GeoJSONWorkerSource=_dereq_("./geojson_worker_source"),globalRTLTextPlugin=_dereq_("./rtl_text_plugin"),Worker=function(e){var r=this;this.self=e,this.actor=new Actor(e,this),this.layerIndexes={},this.workerSourceTypes={vector:VectorTileWorkerSource,geojson:GeoJSONWorkerSource},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(e,o){if(r.workerSourceTypes[e])throw new Error('Worker source with name "'+e+'" already registered.');r.workerSourceTypes[e]=o},this.self.registerRTLTextPlugin=function(e){if(globalRTLTextPlugin.applyArabicShaping||globalRTLTextPlugin.processBidirectionalText)throw new Error("RTL text plugin already registered.");globalRTLTextPlugin.applyArabicShaping=e.applyArabicShaping,globalRTLTextPlugin.processBidirectionalText=e.processBidirectionalText}};Worker.prototype.setLayers=function(e,r,o){this.getLayerIndex(e).replace(r),o()},Worker.prototype.updateLayers=function(e,r,o){this.getLayerIndex(e).update(r.layers,r.removedIds),o()},Worker.prototype.loadTile=function(e,r,o){this.getWorkerSource(e,r.type).loadTile(r,o)},Worker.prototype.loadDEMTile=function(e,r,o){this.getDEMWorkerSource(e).loadTile(r,o)},Worker.prototype.reloadTile=function(e,r,o){this.getWorkerSource(e,r.type).reloadTile(r,o)},Worker.prototype.abortTile=function(e,r,o){this.getWorkerSource(e,r.type).abortTile(r,o)},Worker.prototype.removeTile=function(e,r,o){this.getWorkerSource(e,r.type).removeTile(r,o)},Worker.prototype.removeDEMTile=function(e,r){this.getDEMWorkerSource(e).removeTile(r)},Worker.prototype.removeSource=function(e,r,o){var t=this.getWorkerSource(e,r.type);void 0!==t.removeSource?t.removeSource(r,o):o()},Worker.prototype.loadWorkerSource=function(e,r,o){try{this.self.importScripts(r.url),o()}catch(e){o(e)}},Worker.prototype.loadRTLTextPlugin=function(e,r,o){try{globalRTLTextPlugin.applyArabicShaping||globalRTLTextPlugin.processBidirectionalText||(this.self.importScripts(r),globalRTLTextPlugin.applyArabicShaping&&globalRTLTextPlugin.processBidirectionalText||o(new Error("RTL Text Plugin failed to import scripts from "+r)))}catch(e){o(e)}},Worker.prototype.getLayerIndex=function(e){var r=this.layerIndexes[e];return r||(r=this.layerIndexes[e]=new StyleLayerIndex),r},Worker.prototype.getWorkerSource=function(e,r){var o=this;if(this.workerSources[e]||(this.workerSources[e]={}),!this.workerSources[e][r]){var t={send:function(r,t,i){o.actor.send(r,t,i,e)}};this.workerSources[e][r]=new this.workerSourceTypes[r](t,this.getLayerIndex(e))}return this.workerSources[e][r]},Worker.prototype.getDEMWorkerSource=function(e){return this.demWorkerSources[e]||(this.demWorkerSources[e]=new RasterDEMTileWorkerSource),this.demWorkerSources[e]},module.exports=function(e){return new Worker(e)}},{"../style/style_layer_index":210,"../util/actor":250,"./geojson_worker_source":100,"./raster_dem_tile_worker_source":107,"./rtl_text_plugin":109,"./vector_tile_worker_source":116}],119:[function(_dereq_,module,exports){function recalculateLayers(e,r){for(var i=new EvaluationParameters(r),o=0,a=e;o<a.length;o+=1)a[o].recalculate(i)}var FeatureIndex=_dereq_("../data/feature_index"),performSymbolLayout=_dereq_("../symbol/symbol_layout").performSymbolLayout,CollisionBoxArray=_dereq_("../data/array_types").CollisionBoxArray,DictionaryCoder=_dereq_("../util/dictionary_coder"),SymbolBucket=_dereq_("../data/bucket/symbol_bucket"),util=_dereq_("../util/util"),makeImageAtlas=_dereq_("../render/image_atlas").makeImageAtlas,makeGlyphAtlas=_dereq_("../render/glyph_atlas").makeGlyphAtlas,EvaluationParameters=_dereq_("../style/evaluation_parameters"),OverscaledTileID=_dereq_("./tile_id").OverscaledTileID,WorkerTile=function(e){this.tileID=new OverscaledTileID(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=e.overscaling,this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming};WorkerTile.prototype.parse=function(e,r,i,o){function a(){if(k)return o(k);if(b&&D){var r=makeGlyphAtlas(b),i=makeImageAtlas(D);for(var a in n){var t=n[a];t instanceof SymbolBucket&&(recalculateLayers(t.layers,this.zoom),performSymbolLayout(t,b,r.positions,D,i.positions,this.showCollisionBoxes))}this.status="done",o(null,{buckets:util.values(n).filter(function(e){return!e.isEmpty()}),featureIndex:s,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:r.image,iconAtlasImage:i.image})}}var t=this;this.status="parsing",this.data=e,this.collisionBoxArray=new CollisionBoxArray;var l=new DictionaryCoder(Object.keys(e.layers).sort()),s=new FeatureIndex(this.tileID,this.overscaling);s.bucketLayerIDs=[];var n={},c={featureIndex:s,iconDependencies:{},glyphDependencies:{}},u=r.familiesBySource[this.source];for(var m in u){var y=e.layers[m];if(y){1===y.version&&util.warnOnce('Vector tile source "'+t.source+'" layer "'+m+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var h=l.encode(m),d=[],f=0;f<y.length;f++){var p=y.feature(f);d.push({feature:p,index:f,sourceLayerIndex:h})}for(var v=0,g=u[m];v<g.length;v+=1){var x=g[v],I=x[0];I.minzoom&&t.zoom<Math.floor(I.minzoom)||I.maxzoom&&t.zoom>=I.maxzoom||"none"===I.visibility||(recalculateLayers(x,t.zoom),(n[I.id]=I.createBucket({index:s.bucketLayerIDs.length,layers:x,zoom:t.zoom,pixelRatio:t.pixelRatio,overscaling:t.overscaling,collisionBoxArray:t.collisionBoxArray})).populate(d,c),s.bucketLayerIDs.push(x.map(function(e){return e.id})))}}}var k,b,D,A=util.mapObject(c.glyphDependencies,function(e){return Object.keys(e).map(Number)});Object.keys(A).length?i.send("getGlyphs",{uid:this.uid,stacks:A},function(e,r){k||(k=e,b=r,a.call(t))}):b={};var z=Object.keys(c.iconDependencies);z.length?i.send("getImages",{icons:z},function(e,r){k||(k=e,D=r,a.call(t))}):D={},a.call(this)},module.exports=WorkerTile},{"../data/array_types":39,"../data/bucket/symbol_bucket":51,"../data/feature_index":54,"../render/glyph_atlas":85,"../render/image_atlas":87,"../style/evaluation_parameters":182,"../symbol/symbol_layout":227,"../util/dictionary_coder":257,"../util/util":275,"./tile_id":114}],120:[function(_dereq_,module,exports){function deref(r,e){var f={};for(var t in r)"ref"!==t&&(f[t]=r[t]);return refProperties.forEach(function(r){r in e&&(f[r]=e[r])}),f}var refProperties=_dereq_("./util/ref_properties");module.exports=function derefLayers(r){r=r.slice();for(var e=Object.create(null),f=0;f<r.length;f++)e[r[f].id]=r[f];for(var t=0;t<r.length;t++)"ref"in r[t]&&(r[t]=deref(r[t],e[r[t].ref]));return r}},{"./util/ref_properties":159}],121:[function(_dereq_,module,exports){function addSource(e,r,o){o.push({command:operations.addSource,args:[e,r[e]]})}function removeSource(e,r,o){r.push({command:operations.removeSource,args:[e]}),o[e]=!0}function updateSource(e,r,o,a){removeSource(e,o,a),addSource(e,r,o)}function canUpdateGeoJSON(e,r,o){var a;for(a in e[o])if(e[o].hasOwnProperty(a)&&"data"!==a&&!isEqual(e[o][a],r[o][a]))return!1;for(a in r[o])if(r[o].hasOwnProperty(a)&&"data"!==a&&!isEqual(e[o][a],r[o][a]))return!1;return!0}function diffLayerPropertyChanges(e,r,o,a,t,s){var n;for(n in e=e||{},r=r||{},e)e.hasOwnProperty(n)&&(isEqual(e[n],r[n])||o.push({command:s,args:[a,n,r[n],t]}));for(n in r)r.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(isEqual(e[n],r[n])||o.push({command:s,args:[a,n,r[n],t]}))}function pluckId(e){return e.id}function indexById(e,r){return e[r.id]=r,e}var isEqual=_dereq_("./util/deep_equal"),operations={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};module.exports=function diffStyles(e,r){if(!e)return[{command:operations.setStyle,args:[r]}];var o=[];try{if(!isEqual(e.version,r.version))return[{command:operations.setStyle,args:[r]}];isEqual(e.center,r.center)||o.push({command:operations.setCenter,args:[r.center]}),isEqual(e.zoom,r.zoom)||o.push({command:operations.setZoom,args:[r.zoom]}),isEqual(e.bearing,r.bearing)||o.push({command:operations.setBearing,args:[r.bearing]}),isEqual(e.pitch,r.pitch)||o.push({command:operations.setPitch,args:[r.pitch]}),isEqual(e.sprite,r.sprite)||o.push({command:operations.setSprite,args:[r.sprite]}),isEqual(e.glyphs,r.glyphs)||o.push({command:operations.setGlyphs,args:[r.glyphs]}),isEqual(e.transition,r.transition)||o.push({command:operations.setTransition,args:[r.transition]}),isEqual(e.light,r.light)||o.push({command:operations.setLight,args:[r.light]});var a={},t=[];!function diffSources(e,r,o,a){var t;for(t in e=e||{},r=r||{},e)e.hasOwnProperty(t)&&(r.hasOwnProperty(t)||removeSource(t,o,a));for(t in r)r.hasOwnProperty(t)&&(e.hasOwnProperty(t)?isEqual(e[t],r[t])||("geojson"===e[t].type&&"geojson"===r[t].type&&canUpdateGeoJSON(e,r,t)?o.push({command:operations.setGeoJSONSourceData,args:[t,r[t].data]}):updateSource(t,r,o,a)):addSource(t,r,o))}(e.sources,r.sources,t,a);var s=[];e.layers&&e.layers.forEach(function(e){a[e.source]?o.push({command:operations.removeLayer,args:[e.id]}):s.push(e)}),o=o.concat(t),function diffLayers(e,r,o){e=e||[],r=r||[];var a,t,s,n,i,p,u,m=e.map(pluckId),c=r.map(pluckId),l=e.reduce(indexById,{}),d=r.reduce(indexById,{}),y=m.slice(),h=Object.create(null);for(a=0,t=0;a<m.length;a++)s=m[a],d.hasOwnProperty(s)?t++:(o.push({command:operations.removeLayer,args:[s]}),y.splice(y.indexOf(s,t),1));for(a=0,t=0;a<c.length;a++)s=c[c.length-1-a],y[y.length-1-a]!==s&&(l.hasOwnProperty(s)?(o.push({command:operations.removeLayer,args:[s]}),y.splice(y.lastIndexOf(s,y.length-t),1)):t++,p=y[y.length-a],o.push({command:operations.addLayer,args:[d[s],p]}),y.splice(y.length-a,0,s),h[s]=!0);for(a=0;a<c.length;a++)if(n=l[s=c[a]],i=d[s],!h[s]&&!isEqual(n,i))if(isEqual(n.source,i.source)&&isEqual(n["source-layer"],i["source-layer"])&&isEqual(n.type,i.type)){for(u in diffLayerPropertyChanges(n.layout,i.layout,o,s,null,operations.setLayoutProperty),diffLayerPropertyChanges(n.paint,i.paint,o,s,null,operations.setPaintProperty),isEqual(n.filter,i.filter)||o.push({command:operations.setFilter,args:[s,i.filter]}),isEqual(n.minzoom,i.minzoom)&&isEqual(n.maxzoom,i.maxzoom)||o.push({command:operations.setLayerZoomRange,args:[s,i.minzoom,i.maxzoom]}),n)n.hasOwnProperty(u)&&"layout"!==u&&"paint"!==u&&"filter"!==u&&"metadata"!==u&&"minzoom"!==u&&"maxzoom"!==u&&(0===u.indexOf("paint.")?diffLayerPropertyChanges(n[u],i[u],o,s,u.slice(6),operations.setPaintProperty):isEqual(n[u],i[u])||o.push({command:operations.setLayerProperty,args:[s,u,i[u]]}));for(u in i)i.hasOwnProperty(u)&&!n.hasOwnProperty(u)&&"layout"!==u&&"paint"!==u&&"filter"!==u&&"metadata"!==u&&"minzoom"!==u&&"maxzoom"!==u&&(0===u.indexOf("paint.")?diffLayerPropertyChanges(n[u],i[u],o,s,u.slice(6),operations.setPaintProperty):isEqual(n[u],i[u])||o.push({command:operations.setLayerProperty,args:[s,u,i[u]]}))}else o.push({command:operations.removeLayer,args:[s]}),p=y[y.lastIndexOf(s)+1],o.push({command:operations.addLayer,args:[i,p]})}(s,r.layers,o)}catch(e){console.warn("Unable to compute style diff:",e),o=[{command:operations.setStyle,args:[r]}]}return o},module.exports.operations=operations},{"./util/deep_equal":155}],122:[function(_dereq_,module,exports){module.exports=function ValidationError(i,e,l){this.message=(i?i+": ":"")+l,null!==e&&void 0!==e&&e.__line__&&(this.line=e.__line__)}},{}],123:[function(_dereq_,module,exports){var toString=_dereq_("./types").toString,ParsingContext=_dereq_("./parsing_context"),CompoundExpression=(_dereq_("./evaluation_context"),function(r,e,n,t){this.name=r,this.type=e,this._evaluate=n,this.args=t});CompoundExpression.prototype.evaluate=function(r){return this._evaluate(r,this.args)},CompoundExpression.prototype.eachChild=function(r){this.args.forEach(r)},CompoundExpression.prototype.possibleOutputs=function(){return[void 0]},CompoundExpression.parse=function(r,e){var n=r[0],t=CompoundExpression.definitions[n];if(!t)return e.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0);for(var o=Array.isArray(t)?t[0]:t.type,i=Array.isArray(t)?[[t[1],t[2]]]:t.overloads,s=i.filter(function(e){var n=e[0];return!Array.isArray(n)||n.length===r.length-1}),a=[],u=1;u<r.length;u++){var p=r[u],l=void 0;if(1===s.length){var g=s[0][0];l=Array.isArray(g)?g[u-1]:g.type}var y=e.parse(p,1+a.length,l);if(!y)return null;a.push(y)}for(var f=null,h=0,d=s;h<d.length;h+=1){var v=d[h],c=v[0],x=v[1];if(f=new ParsingContext(e.registry,e.path,null,e.scope),Array.isArray(c)&&c.length!==a.length)f.error("Expected "+c.length+" arguments, but found "+a.length+" instead.");else{for(var m=0;m<a.length;m++){var C=Array.isArray(c)?c[m]:c.type,E=a[m];f.concat(m+1).checkSubtype(C,E.type)}if(0===f.errors.length)return new CompoundExpression(n,o,x,a)}}if(1===s.length)e.errors.push.apply(e.errors,f.errors);else{var S=(s.length?s:i).map(function(r){return function stringifySignature(r){return Array.isArray(r)?"("+r.map(toString).join(", ")+")":"("+toString(r.type)+"...)"}(r[0])}).join(" | "),b=a.map(function(r){return toString(r.type)}).join(", ");e.error("Expected arguments of type "+S+", but found ("+b+") instead.")}return null},CompoundExpression.register=function(r,e){for(var n in CompoundExpression.definitions=e,e)r[n]=CompoundExpression},module.exports={CompoundExpression:CompoundExpression,varargs:function varargs(r){return{type:r}}}},{"./evaluation_context":138,"./parsing_context":141,"./types":146}],124:[function(_dereq_,module,exports){var ref=_dereq_("../types"),toString=ref.toString,array=ref.array,ValueType=ref.ValueType,StringType=ref.StringType,NumberType=ref.NumberType,BooleanType=ref.BooleanType,checkSubtype=ref.checkSubtype,typeOf=_dereq_("../values").typeOf,RuntimeError=_dereq_("../runtime_error"),types={string:StringType,number:NumberType,boolean:BooleanType},ArrayAssertion=function(e,r){this.type=e,this.input=r};ArrayAssertion.parse=function(e,r){if(e.length<2||e.length>4)return r.error("Expected 1, 2, or 3 arguments, but found "+(e.length-1)+" instead.");var t,n;if(e.length>2){var i=e[1];if("string"!=typeof i||!(i in types))return r.error('The item type argument of "array" must be one of string, number, boolean',1);t=types[i]}else t=ValueType;if(e.length>3){if("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2]))return r.error('The length argument to "array" must be a positive integer literal',2);n=e[2]}var o=array(t,n),u=r.parse(e[e.length-1],e.length-1,ValueType);return u?new ArrayAssertion(o,u):null},ArrayAssertion.prototype.evaluate=function(e){var r=this.input.evaluate(e);if(checkSubtype(this.type,typeOf(r)))throw new RuntimeError("Expected value to be of type "+toString(this.type)+", but found "+toString(typeOf(r))+" instead.");return r},ArrayAssertion.prototype.eachChild=function(e){e(this.input)},ArrayAssertion.prototype.possibleOutputs=function(){return this.input.possibleOutputs()},module.exports=ArrayAssertion},{"../runtime_error":143,"../types":146,"../values":147}],125:[function(_dereq_,module,exports){var ref=_dereq_("../types"),ObjectType=ref.ObjectType,ValueType=ref.ValueType,StringType=ref.StringType,NumberType=ref.NumberType,BooleanType=ref.BooleanType,RuntimeError=_dereq_("../runtime_error"),ref$1=_dereq_("../types"),checkSubtype=ref$1.checkSubtype,toString=ref$1.toString,typeOf=_dereq_("../values").typeOf,types={string:StringType,number:NumberType,boolean:BooleanType,object:ObjectType},Assertion=function(e,r){this.type=e,this.args=r};Assertion.parse=function(e,r){if(e.length<2)return r.error("Expected at least one argument.");for(var t=e[0],n=types[t],o=[],p=1;p<e.length;p++){var s=r.parse(e[p],p,ValueType);if(!s)return null;o.push(s)}return new Assertion(n,o)},Assertion.prototype.evaluate=function(e){for(var r=this,t=0;t<this.args.length;t++){var n=r.args[t].evaluate(e);if(!checkSubtype(r.type,typeOf(n)))return n;if(t===r.args.length-1)throw new RuntimeError("Expected value to be of type "+toString(r.type)+", but found "+toString(typeOf(n))+" instead.")}return null},Assertion.prototype.eachChild=function(e){this.args.forEach(e)},Assertion.prototype.possibleOutputs=function(){return(e=[]).concat.apply(e,this.args.map(function(e){return e.possibleOutputs()}));var e},module.exports=Assertion},{"../runtime_error":143,"../types":146,"../values":147}],126:[function(_dereq_,module,exports){var ref=_dereq_("../types"),array=ref.array,ValueType=ref.ValueType,NumberType=ref.NumberType,RuntimeError=_dereq_("../runtime_error"),At=function(e,t,r){this.type=e,this.index=t,this.input=r};At.parse=function(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,NumberType),n=t.parse(e[2],2,array(t.expectedType||ValueType));if(!r||!n)return null;var u=n.type;return new At(u.itemType,r,n)},At.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0||t>=r.length)throw new RuntimeError("Array index out of bounds: "+t+" > "+r.length+".");if(t!==Math.floor(t))throw new RuntimeError("Array index must be an integer, but found "+t+" instead.");return r[t]},At.prototype.eachChild=function(e){e(this.index),e(this.input)},At.prototype.possibleOutputs=function(){return[void 0]},module.exports=At},{"../runtime_error":143,"../types":146}],127:[function(_dereq_,module,exports){var BooleanType=_dereq_("../types").BooleanType,Case=function(e,t,r){this.type=e,this.branches=t,this.otherwise=r};Case.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);for(var n=[],a=1;a<e.length-1;a+=2){var s=t.parse(e[a],a,BooleanType);if(!s)return null;var o=t.parse(e[a+1],a+1,r);if(!o)return null;n.push([s,o]),r=r||o.type}var u=t.parse(e[e.length-1],e.length-1,r);return u?new Case(r,n,u):null},Case.prototype.evaluate=function(e){for(var r=0,n=this.branches;r<n.length;r+=1){var a=n[r],s=a[0],o=a[1];if(s.evaluate(e))return o.evaluate(e)}return this.otherwise.evaluate(e)},Case.prototype.eachChild=function(e){for(var r=0,n=this.branches;r<n.length;r+=1){var a=n[r],s=a[0],o=a[1];e(s),e(o)}e(this.otherwise)},Case.prototype.possibleOutputs=function(){return(e=[]).concat.apply(e,this.branches.map(function(e){return e[0],e[1].possibleOutputs()})).concat(this.otherwise.possibleOutputs());var e},module.exports=Case},{"../types":146}],128:[function(_dereq_,module,exports){var ref=_dereq_("../types"),checkSubtype=ref.checkSubtype,ValueType=ref.ValueType,Coalesce=function(e,t){this.type=e,this.args=t};Coalesce.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,a=t.expectedType;a&&"value"!==a.kind&&(r=a);for(var n=[],o=0,u=e.slice(1);o<u.length;o+=1){var s=u[o],l=t.parse(s,1+n.length,r,void 0,{omitTypeAnnotations:!0});if(!l)return null;r=r||l.type,n.push(l)}return a&&n.some(function(e){return checkSubtype(a,e.type)})?new Coalesce(ValueType,n):new Coalesce(r,n)},Coalesce.prototype.evaluate=function(e){for(var r=null,a=0,n=this.args;a<n.length&&null===(r=n[a].evaluate(e));a+=1);return r},Coalesce.prototype.eachChild=function(e){this.args.forEach(e)},Coalesce.prototype.possibleOutputs=function(){return(e=[]).concat.apply(e,this.args.map(function(e){return e.possibleOutputs()}));var e},module.exports=Coalesce},{"../types":146}],129:[function(_dereq_,module,exports){var ref=_dereq_("../types"),ColorType=ref.ColorType,ValueType=ref.ValueType,NumberType=ref.NumberType,ref$1=_dereq_("../values"),Color=ref$1.Color,validateRGBA=ref$1.validateRGBA,RuntimeError=_dereq_("../runtime_error"),types={"to-number":NumberType,"to-color":ColorType},Coercion=function(r,e){this.type=r,this.args=e};Coercion.parse=function(r,e){if(r.length<2)return e.error("Expected at least one argument.");for(var t=r[0],o=types[t],n=[],i=1;i<r.length;i++){var a=e.parse(r[i],i,ValueType);if(!a)return null;n.push(a)}return new Coercion(o,n)},Coercion.prototype.evaluate=function(r){if("color"===this.type.kind){for(var t,o,n=0,i=this.args;n<i.length;n+=1)if(o=null,"string"==typeof(t=i[n].evaluate(r))){var a=r.parseColor(t);if(a)return a}else if(Array.isArray(t)&&!(o=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":validateRGBA(t[0],t[1],t[2],t[3])))return new Color(t[0]/255,t[1]/255,t[2]/255,t[3]);throw new RuntimeError(o||"Could not parse color from value '"+("string"==typeof t?t:JSON.stringify(t))+"'")}for(var u=null,l=0,s=this.args;l<s.length;l+=1)if(null!==(u=s[l].evaluate(r))){var p=Number(u);if(!isNaN(p))return p}throw new RuntimeError("Could not convert "+JSON.stringify(u)+" to number.")},Coercion.prototype.eachChild=function(r){this.args.forEach(r)},Coercion.prototype.possibleOutputs=function(){return(r=[]).concat.apply(r,this.args.map(function(r){return r.possibleOutputs()}));var r},module.exports=Coercion},{"../runtime_error":143,"../types":146,"../values":147}],130:[function(_dereq_,module,exports){function isComparableType(e){return"string"===e.kind||"number"===e.kind||"boolean"===e.kind||"null"===e.kind}function makeComparison(e){return function(){function t(e,t){this.type=BooleanType,this.lhs=e,this.rhs=t}return t.parse=function(e,r){if(3!==e.length)return r.error("Expected two arguments.");var n=r.parse(e[1],1,ValueType);if(!n)return null;var o=r.parse(e[2],2,ValueType);return o?isComparableType(n.type)||isComparableType(o.type)?n.type.kind!==o.type.kind&&"value"!==n.type.kind&&"value"!==o.type.kind?r.error("Cannot compare "+toString(n.type)+" and "+toString(o.type)+"."):new t(n,o):r.error("Expected at least one argument to be a string, number, boolean, or null, but found ("+toString(n.type)+", "+toString(o.type)+") instead."):null},t.prototype.evaluate=function(t){return e(this.lhs.evaluate(t),this.rhs.evaluate(t))},t.prototype.eachChild=function(e){e(this.lhs),e(this.rhs)},t.prototype.possibleOutputs=function(){return[!0,!1]},t}()}var ref=_dereq_("../types"),ValueType=ref.ValueType,BooleanType=ref.BooleanType,toString=_dereq_("../types").toString;module.exports={Equals:makeComparison(function(e,t){return e===t}),NotEquals:makeComparison(function(e,t){return e!==t})}},{"../types":146}],131:[function(_dereq_,module,exports){function rgba(e,r){var t=r[0],a=r[1],n=r[2],u=r[3];t=t.evaluate(e),a=a.evaluate(e),n=n.evaluate(e);var o=u?u.evaluate(e):1,p=validateRGBA(t,a,n,o);if(p)throw new RuntimeError(p);return new Color(t/255*o,a/255*o,n/255*o,o)}function has(e,r){return e in r}function get(e,r){var t=r[e];return void 0===t?null:t}function length(e,r){return r[0].evaluate(e).length}function lt(e,r){var t=r[0],a=r[1];return t.evaluate(e)<a.evaluate(e)}function gt(e,r){var t=r[0],a=r[1];return t.evaluate(e)>a.evaluate(e)}function lteq(e,r){var t=r[0],a=r[1];return t.evaluate(e)<=a.evaluate(e)}function gteq(e,r){var t=r[0],a=r[1];return t.evaluate(e)>=a.evaluate(e)}var ref=_dereq_("../types"),NumberType=ref.NumberType,StringType=ref.StringType,BooleanType=ref.BooleanType,ColorType=ref.ColorType,ObjectType=ref.ObjectType,ValueType=ref.ValueType,ErrorType=ref.ErrorType,array=ref.array,toString=ref.toString,ref$1=_dereq_("../values"),typeOf=ref$1.typeOf,Color=ref$1.Color,validateRGBA=ref$1.validateRGBA,ref$2=_dereq_("../compound_expression"),CompoundExpression=ref$2.CompoundExpression,varargs=ref$2.varargs,RuntimeError=_dereq_("../runtime_error"),Let=_dereq_("./let"),Var=_dereq_("./var"),Literal=_dereq_("./literal"),Assertion=_dereq_("./assertion"),ArrayAssertion=_dereq_("./array"),Coercion=_dereq_("./coercion"),At=_dereq_("./at"),Match=_dereq_("./match"),Case=_dereq_("./case"),Step=_dereq_("./step"),Interpolate=_dereq_("./interpolate"),Coalesce=_dereq_("./coalesce"),ref$3=_dereq_("./equals"),expressions={"==":ref$3.Equals,"!=":ref$3.NotEquals,array:ArrayAssertion,at:At,boolean:Assertion,case:Case,coalesce:Coalesce,interpolate:Interpolate,let:Let,literal:Literal,match:Match,number:Assertion,object:Assertion,step:Step,string:Assertion,"to-color":Coercion,"to-number":Coercion,var:Var};CompoundExpression.register(expressions,{error:[ErrorType,[StringType],function(e,r){var t=r[0];throw new RuntimeError(t.evaluate(e))}],typeof:[StringType,[ValueType],function(e,r){var t=r[0];return toString(typeOf(t.evaluate(e)))}],"to-string":[StringType,[ValueType],function(e,r){var t=r[0],a=typeof(t=t.evaluate(e));return null===t||"string"===a||"number"===a||"boolean"===a?String(t):t instanceof Color?t.toString():JSON.stringify(t)}],"to-boolean":[BooleanType,[ValueType],function(e,r){var t=r[0];return Boolean(t.evaluate(e))}],"to-rgba":[array(NumberType,4),[ColorType],function(e,r){var a=r[0].evaluate(e),n=a.r,u=a.g,o=a.b,p=a.a;return[255*n/p,255*u/p,255*o/p,p]}],rgb:[ColorType,[NumberType,NumberType,NumberType],rgba],rgba:[ColorType,[NumberType,NumberType,NumberType,NumberType],rgba],length:{type:NumberType,overloads:[[[StringType],length],[[array(ValueType)],length]]},has:{type:BooleanType,overloads:[[[StringType],function(e,r){return has(r[0].evaluate(e),e.properties())}],[[StringType,ObjectType],function(e,r){var t=r[0],a=r[1];return has(t.evaluate(e),a.evaluate(e))}]]},get:{type:ValueType,overloads:[[[StringType],function(e,r){return get(r[0].evaluate(e),e.properties())}],[[StringType,ObjectType],function(e,r){var t=r[0],a=r[1];return get(t.evaluate(e),a.evaluate(e))}]]},properties:[ObjectType,[],function(e){return e.properties()}],"geometry-type":[StringType,[],function(e){return e.geometryType()}],id:[ValueType,[],function(e){return e.id()}],zoom:[NumberType,[],function(e){return e.globals.zoom}],"heatmap-density":[NumberType,[],function(e){return e.globals.heatmapDensity||0}],"+":[NumberType,varargs(NumberType),function(e,r){for(var t=0,a=0,n=r;a<n.length;a+=1)t+=n[a].evaluate(e);return t}],"*":[NumberType,varargs(NumberType),function(e,r){for(var t=1,a=0,n=r;a<n.length;a+=1)t*=n[a].evaluate(e);return t}],"-":{type:NumberType,overloads:[[[NumberType,NumberType],function(e,r){var t=r[0],a=r[1];return t.evaluate(e)-a.evaluate(e)}],[[NumberType],function(e,r){return-r[0].evaluate(e)}]]},"/":[NumberType,[NumberType,NumberType],function(e,r){var t=r[0],a=r[1];return t.evaluate(e)/a.evaluate(e)}],"%":[NumberType,[NumberType,NumberType],function(e,r){var t=r[0],a=r[1];return t.evaluate(e)%a.evaluate(e)}],ln2:[NumberType,[],function(){return Math.LN2}],pi:[NumberType,[],function(){return Math.PI}],e:[NumberType,[],function(){return Math.E}],"^":[NumberType,[NumberType,NumberType],function(e,r){var t=r[0],a=r[1];return Math.pow(t.evaluate(e),a.evaluate(e))}],sqrt:[NumberType,[NumberType],function(e,r){var t=r[0];return Math.sqrt(t.evaluate(e))}],log10:[NumberType,[NumberType],function(e,r){var t=r[0];return Math.log10(t.evaluate(e))}],ln:[NumberType,[NumberType],function(e,r){var t=r[0];return Math.log(t.evaluate(e))}],log2:[NumberType,[NumberType],function(e,r){var t=r[0];return Math.log2(t.evaluate(e))}],sin:[NumberType,[NumberType],function(e,r){var t=r[0];return Math.sin(t.evaluate(e))}],cos:[NumberType,[NumberType],function(e,r){var t=r[0];return Math.cos(t.evaluate(e))}],tan:[NumberType,[NumberType],function(e,r){var t=r[0];return Math.tan(t.evaluate(e))}],asin:[NumberType,[NumberType],function(e,r){var t=r[0];return Math.asin(t.evaluate(e))}],acos:[NumberType,[NumberType],function(e,r){var t=r[0];return Math.acos(t.evaluate(e))}],atan:[NumberType,[NumberType],function(e,r){var t=r[0];return Math.atan(t.evaluate(e))}],min:[NumberType,varargs(NumberType),function(e,r){return Math.min.apply(Math,r.map(function(r){return r.evaluate(e)}))}],max:[NumberType,varargs(NumberType),function(e,r){return Math.max.apply(Math,r.map(function(r){return r.evaluate(e)}))}],"filter-==":[BooleanType,[StringType,ValueType],function(e,r){var t=r[0],a=r[1];return e.properties()[t.value]===a.value}],"filter-id-==":[BooleanType,[ValueType],function(e,r){var t=r[0];return e.id()===t.value}],"filter-type-==":[BooleanType,[StringType],function(e,r){var t=r[0];return e.geometryType()===t.value}],"filter-<":[BooleanType,[StringType,ValueType],function(e,r){var t=r[0],a=r[1],n=e.properties()[t.value],u=a.value;return typeof n==typeof u&&n<u}],"filter-id-<":[BooleanType,[ValueType],function(e,r){var t=r[0],a=e.id(),n=t.value;return typeof a==typeof n&&a<n}],"filter->":[BooleanType,[StringType,ValueType],function(e,r){var t=r[0],a=r[1],n=e.properties()[t.value],u=a.value;return typeof n==typeof u&&n>u}],"filter-id->":[BooleanType,[ValueType],function(e,r){var t=r[0],a=e.id(),n=t.value;return typeof a==typeof n&&a>n}],"filter-<=":[BooleanType,[StringType,ValueType],function(e,r){var t=r[0],a=r[1],n=e.properties()[t.value],u=a.value;return typeof n==typeof u&&n<=u}],"filter-id-<=":[BooleanType,[ValueType],function(e,r){var t=r[0],a=e.id(),n=t.value;return typeof a==typeof n&&a<=n}],"filter->=":[BooleanType,[StringType,ValueType],function(e,r){var t=r[0],a=r[1],n=e.properties()[t.value],u=a.value;return typeof n==typeof u&&n>=u}],"filter-id->=":[BooleanType,[ValueType],function(e,r){var t=r[0],a=e.id(),n=t.value;return typeof a==typeof n&&a>=n}],"filter-has":[BooleanType,[ValueType],function(e,r){return r[0].value in e.properties()}],"filter-has-id":[BooleanType,[],function(e){return null!==e.id()}],"filter-type-in":[BooleanType,[array(StringType)],function(e,r){return r[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[BooleanType,[array(ValueType)],function(e,r){return r[0].value.indexOf(e.id())>=0}],"filter-in-small":[BooleanType,[StringType,array(ValueType)],function(e,r){var t=r[0];return r[1].value.indexOf(e.properties()[t.value])>=0}],"filter-in-large":[BooleanType,[StringType,array(ValueType)],function(e,r){var t=r[0],a=r[1];return function binarySearch(e,r,t,a){for(;t<=a;){var n=t+a>>1;if(r[n]===e)return!0;r[n]>e?a=n-1:t=n+1}return!1}(e.properties()[t.value],a.value,0,a.value.length-1)}],">":{type:BooleanType,overloads:[[[NumberType,NumberType],gt],[[StringType,StringType],gt]]},"<":{type:BooleanType,overloads:[[[NumberType,NumberType],lt],[[StringType,StringType],lt]]},">=":{type:BooleanType,overloads:[[[NumberType,NumberType],gteq],[[StringType,StringType],gteq]]},"<=":{type:BooleanType,overloads:[[[NumberType,NumberType],lteq],[[StringType,StringType],lteq]]},all:{type:BooleanType,overloads:[[[BooleanType,BooleanType],function(e,r){var t=r[0],a=r[1];return t.evaluate(e)&&a.evaluate(e)}],[varargs(BooleanType),function(e,r){for(var t=0,a=r;t<a.length;t+=1)if(!a[t].evaluate(e))return!1;return!0}]]},any:{type:BooleanType,overloads:[[[BooleanType,BooleanType],function(e,r){var t=r[0],a=r[1];return t.evaluate(e)||a.evaluate(e)}],[varargs(BooleanType),function(e,r){for(var t=0,a=r;t<a.length;t+=1)if(a[t].evaluate(e))return!0;return!1}]]},"!":[BooleanType,[BooleanType],function(e,r){return!r[0].evaluate(e)}],upcase:[StringType,[StringType],function(e,r){return r[0].evaluate(e).toUpperCase()}],downcase:[StringType,[StringType],function(e,r){return r[0].evaluate(e).toLowerCase()}],concat:[StringType,varargs(StringType),function(e,r){return r.map(function(r){return r.evaluate(e)}).join("")}]}),module.exports=expressions},{"../compound_expression":123,"../runtime_error":143,"../types":146,"../values":147,"./array":124,"./assertion":125,"./at":126,"./case":127,"./coalesce":128,"./coercion":129,"./equals":130,"./interpolate":132,"./let":133,"./literal":134,"./match":135,"./step":136,"./var":137}],132:[function(_dereq_,module,exports){function exponentialInterpolation(e,t,r,n){var i=n-r,o=e-r;return 0===i?0:1===t?o/i:(Math.pow(t,o)-1)/(Math.pow(t,i)-1)}var UnitBezier=_dereq_("@mapbox/unitbezier"),interpolate=_dereq_("../../util/interpolate"),ref=_dereq_("../types"),toString=ref.toString,NumberType=ref.NumberType,findStopLessThanOrEqualTo=_dereq_("../stops").findStopLessThanOrEqualTo,Interpolate=function(e,t,r,n){this.type=e,this.interpolation=t,this.input=r,this.labels=[],this.outputs=[];for(var o=0,a=n;o<a.length;o+=1){var u=a[o],p=u[0],l=u[1];this.labels.push(p),this.outputs.push(l)}};Interpolate.interpolationFactor=function(e,t,r,n){var i=0;if("exponential"===e.name)i=exponentialInterpolation(t,e.base,r,n);else if("linear"===e.name)i=exponentialInterpolation(t,1,r,n);else if("cubic-bezier"===e.name){var o=e.controlPoints;i=new UnitBezier(o[0],o[1],o[2],o[3]).solve(exponentialInterpolation(t,1,r,n))}return i},Interpolate.parse=function(e,t){var r=e[1],n=e[2],i=e.slice(3);if(!Array.isArray(r)||0===r.length)return t.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){var o=r[1];if("number"!=typeof o)return t.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:o}}else{if("cubic-bezier"!==r[0])return t.error("Unknown interpolation type "+String(r[0]),1,0);var a=r.slice(1);if(4!==a.length||a.some(function(e){return"number"!=typeof e||e<0||e>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:a}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(n=t.parse(n,2,NumberType)))return null;var u=[],p=null;t.expectedType&&"value"!==t.expectedType.kind&&(p=t.expectedType);for(var l=0;l<i.length;l+=2){var s=i[l],f=i[l+1],c=l+3,h=l+4;if("number"!=typeof s)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',c);if(u.length&&u[u.length-1][0]>=s)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',c);var v=t.parse(f,h,p);if(!v)return null;p=p||v.type,u.push([s,v])}return"number"===p.kind||"color"===p.kind||"array"===p.kind&&"number"===p.itemType.kind&&"number"==typeof p.N?new Interpolate(p,r,n,u):t.error("Type "+toString(p)+" is not interpolatable.")},Interpolate.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);var n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);var i=t.length;if(n>=t[i-1])return r[i-1].evaluate(e);var o=findStopLessThanOrEqualTo(t,n),a=t[o],u=t[o+1],p=Interpolate.interpolationFactor(this.interpolation,n,a,u),l=r[o].evaluate(e),s=r[o+1].evaluate(e);return interpolate[this.type.kind.toLowerCase()](l,s,p)},Interpolate.prototype.eachChild=function(e){e(this.input);for(var r=0,n=this.outputs;r<n.length;r+=1)e(n[r])},Interpolate.prototype.possibleOutputs=function(){return(e=[]).concat.apply(e,this.outputs.map(function(e){return e.possibleOutputs()}));var e},module.exports=Interpolate},{"../../util/interpolate":158,"../stops":145,"../types":146,"@mapbox/unitbezier":7}],133:[function(_dereq_,module,exports){var Let=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};Let.prototype.evaluate=function(t){t.pushScope(this.bindings);var e=this.result.evaluate(t);return t.popScope(),e},Let.prototype.eachChild=function(t){for(var r=0,n=this.bindings;r<n.length;r+=1)t(n[r][1]);t(this.result)},Let.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var r=[],n=1;n<t.length-1;n+=2){var s=t[n];if("string"!=typeof s)return e.error("Expected string, but found "+typeof s+" instead.",n);if(/[^a-zA-Z0-9_]/.test(s))return e.error("Variable names must contain only alphanumeric characters or '_'.",n);var i=e.parse(t[n+1],n+1);if(!i)return null;r.push([s,i])}var u=e.parse(t[t.length-1],t.length-1,void 0,r);return u?new Let(r,u):null},Let.prototype.possibleOutputs=function(){return this.result.possibleOutputs()},module.exports=Let},{}],134:[function(_dereq_,module,exports){var ref=_dereq_("../values"),isValue=ref.isValue,typeOf=ref.typeOf,Literal=function(e,r){this.type=e,this.value=r};Literal.parse=function(e,r){if(2!==e.length)return r.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!isValue(e[1]))return r.error("invalid value");var t=e[1],i=typeOf(t),a=r.expectedType;return"array"!==i.kind||0!==i.N||!a||"array"!==a.kind||"number"==typeof a.N&&0!==a.N||(i=a),new Literal(i,t)},Literal.prototype.evaluate=function(){return this.value},Literal.prototype.eachChild=function(){},Literal.prototype.possibleOutputs=function(){return[this.value]},module.exports=Literal},{"../values":147}],135:[function(_dereq_,module,exports){var typeOf=_dereq_("../values").typeOf,Match=function(e,t,r,n,u,s){this.inputType=e,this.type=t,this.input=r,this.cases=n,this.outputs=u,this.otherwise=s};Match.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,n;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);for(var u={},s=[],a=2;a<e.length-1;a+=2){var i=e[a],o=e[a+1];Array.isArray(i)||(i=[i]);var p=t.concat(a);if(0===i.length)return p.error("Expected at least one branch label.");for(var h=0,l=i;h<l.length;h+=1){var c=l[h];if("number"!=typeof c&&"string"!=typeof c)return p.error("Branch labels must be numbers or strings.");if("number"==typeof c&&Math.abs(c)>Number.MAX_SAFE_INTEGER)return p.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof c&&Math.floor(c)!==c)return p.error("Numeric branch labels must be integer values.");if(r){if(p.checkSubtype(r,typeOf(c)))return null}else r=typeOf(c);if(void 0!==u[String(c)])return p.error("Branch labels must be unique.");u[String(c)]=s.length}var f=t.parse(o,a,n);if(!f)return null;n=n||f.type,s.push(f)}var b=t.parse(e[1],1,r);if(!b)return null;var y=t.parse(e[e.length-1],e.length-1,n);return y?new Match(r,n,b,u,s,y):null},Match.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},Match.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},Match.prototype.possibleOutputs=function(){return(e=[]).concat.apply(e,this.outputs.map(function(e){return e.possibleOutputs()})).concat(this.otherwise.possibleOutputs());var e},module.exports=Match},{"../values":147}],136:[function(_dereq_,module,exports){var NumberType=_dereq_("../types").NumberType,findStopLessThanOrEqualTo=_dereq_("../stops").findStopLessThanOrEqualTo,Step=function(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var n=0,s=r;n<s.length;n+=1){var p=s[n],a=p[0],i=p[1];this.labels.push(a),this.outputs.push(i)}};Step.parse=function(e,t){var r=e[1],u=e.slice(2);if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(r=t.parse(r,1,NumberType)))return null;var n=[],s=null;t.expectedType&&"value"!==t.expectedType.kind&&(s=t.expectedType),u.unshift(-1/0);for(var p=0;p<u.length;p+=2){var a=u[p],i=u[p+1],o=p+1,l=p+2;if("number"!=typeof a)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',o);if(n.length&&n[n.length-1][0]>=a)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',o);var f=t.parse(i,l,s);if(!f)return null;s=s||f.type,n.push([a,f])}return new Step(s,r,n)},Step.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);var u=this.input.evaluate(e);if(u<=t[0])return r[0].evaluate(e);var n=t.length;return u>=t[n-1]?r[n-1].evaluate(e):r[findStopLessThanOrEqualTo(t,u)].evaluate(e)},Step.prototype.eachChild=function(e){e(this.input);for(var r=0,u=this.outputs;r<u.length;r+=1)e(u[r])},Step.prototype.possibleOutputs=function(){return(e=[]).concat.apply(e,this.outputs.map(function(e){return e.possibleOutputs()}));var e},module.exports=Step},{"../stops":145,"../types":146}],137:[function(_dereq_,module,exports){var Var=function(e,r){this.type=r,this.name=e};Var.parse=function(e,r){if(2!==e.length||"string"!=typeof e[1])return r.error("'var' expression requires exactly one string literal argument.");var t=e[1];return r.scope.has(t)?new Var(t,r.scope.get(t).type):r.error('Unknown variable "'+t+'". Make sure "'+t+'" has been bound in an enclosing "let" expression before using it.',1)},Var.prototype.evaluate=function(e){return e.scope.get(this.name).evaluate(e)},Var.prototype.eachChild=function(){},Var.prototype.possibleOutputs=function(){return[void 0]},module.exports=Var},{}],138:[function(_dereq_,module,exports){var Scope=_dereq_("./scope"),Color=_dereq_("./values").Color,geometryTypes=["Unknown","Point","LineString","Polygon"],EvaluationContext=function(){this.scope=new Scope,this._parseColorCache={}};EvaluationContext.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},EvaluationContext.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?geometryTypes[this.feature.type]:this.feature.type:null},EvaluationContext.prototype.properties=function(){return this.feature&&this.feature.properties||{}},EvaluationContext.prototype.pushScope=function(t){this.scope=this.scope.concat(t)},EvaluationContext.prototype.popScope=function(){this.scope=this.scope.parent},EvaluationContext.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Color.parse(t)),e},module.exports=EvaluationContext},{"./scope":144,"./values":147}],139:[function(_dereq_,module,exports){function isExpression(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in definitions}function createExpression(e,r,n){void 0===n&&(n={});var t=new ParsingContext(definitions,[],function getExpectedType(e){var r={color:ColorType,string:StringType,number:NumberType,enum:StringType,boolean:BooleanType};return"array"===e.type?array(r[e.value]||ValueType,e.length):r[e.type]||null}(r)),o=t.parse(e);return o?success(!1===n.handleErrors?new StyleExpression(o):new StyleExpressionWithErrorHandling(o,r)):error(t.errors)}function createPropertyExpression(e,r,n){if(void 0===n&&(n={}),"error"===(e=createExpression(e,r,n)).result)return e;var t=e.value.expression,o=isConstant.isFeatureConstant(t);if(!o&&!r["property-function"])return error([new ParsingError("","property expressions not supported")]);var i=isConstant.isGlobalPropertyConstant(t,["zoom"]);if(!i&&!1===r["zoom-function"])return error([new ParsingError("","zoom expressions not supported")]);var s=function findZoomCurve(e){var r=null;if(e instanceof Let)r=findZoomCurve(e.result);else if(e instanceof Coalesce)for(var n=0,t=e.args;n<t.length;n+=1){var o=t[n];if(r=findZoomCurve(o))break}else(e instanceof Step||e instanceof Interpolate)&&e.input instanceof CompoundExpression&&"zoom"===e.input.name&&(r=e);return r instanceof ParsingError?r:(e.eachChild(function(e){var n=findZoomCurve(e);n instanceof ParsingError?r=n:!r&&n?r=new ParsingError("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&n&&r!==n&&(r=new ParsingError("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r)}(t);return s||i?s instanceof ParsingError?error([s]):s instanceof Interpolate&&"piecewise-constant"===r.function?error([new ParsingError("",'"interpolate" expressions cannot be used with this property')]):success(s?new ZoomDependentExpression(o?"camera":"composite",e.value,s):new ZoomConstantExpression(o?"constant":"source",e.value)):error([new ParsingError("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}var extend=_dereq_("../util/extend"),ParsingError=_dereq_("./parsing_error"),ParsingContext=_dereq_("./parsing_context"),EvaluationContext=_dereq_("./evaluation_context"),CompoundExpression=_dereq_("./compound_expression").CompoundExpression,Step=_dereq_("./definitions/step"),Interpolate=_dereq_("./definitions/interpolate"),Coalesce=_dereq_("./definitions/coalesce"),Let=_dereq_("./definitions/let"),definitions=_dereq_("./definitions"),isConstant=_dereq_("./is_constant"),RuntimeError=_dereq_("./runtime_error"),ref$1=_dereq_("../util/result"),success=ref$1.success,error=ref$1.error,StyleExpression=function(e){this.expression=e};StyleExpression.prototype.evaluate=function(e,r){return this._evaluator||(this._evaluator=new EvaluationContext),this._evaluator.globals=e,this._evaluator.feature=r,this.expression.evaluate(this._evaluator)};var StyleExpressionWithErrorHandling=function(e){function r(r,n){e.call(this,r),this._warningHistory={},this._defaultValue=function getDefaultValue(e){return"color"===e.type&&isFunction(e.default)?new Color(0,0,0,0):"color"===e.type?Color.parse(e.default)||null:void 0===e.default?null:e.default}(n),"enum"===n.type&&(this._enumValues=n.values)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.evaluate=function(e,r){this._evaluator||(this._evaluator=new EvaluationContext),this._evaluator.globals=e,this._evaluator.feature=r;try{var n=this.expression.evaluate(this._evaluator);if(null===n||void 0===n)return this._defaultValue;if(this._enumValues&&!(n in this._enumValues))throw new RuntimeError("Expected value to be one of "+Object.keys(this._enumValues).map(function(e){return JSON.stringify(e)}).join(", ")+", but found "+JSON.stringify(n)+" instead.");return n}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}},r}(StyleExpression),ZoomConstantExpression=function(e,r){this.kind=e,this._styleExpression=r};ZoomConstantExpression.prototype.evaluate=function(e,r){return this._styleExpression.evaluate(e,r)};var ZoomDependentExpression=function(e,r,n){this.kind=e,this.zoomStops=n.labels,this._styleExpression=r,n instanceof Interpolate&&(this._interpolationType=n.interpolation)};ZoomDependentExpression.prototype.evaluate=function(e,r){return this._styleExpression.evaluate(e,r)},ZoomDependentExpression.prototype.interpolationFactor=function(e,r,n){return this._interpolationType?Interpolate.interpolationFactor(this._interpolationType,e,r,n):0};var ref$2=_dereq_("../function"),isFunction=ref$2.isFunction,createFunction=ref$2.createFunction,Color=_dereq_("./values").Color,StylePropertyFunction=function(e,r){this._parameters=e,this._specification=r,extend(this,createFunction(this._parameters,this._specification))};StylePropertyFunction.deserialize=function(e){return new StylePropertyFunction(e._parameters,e._specification)},StylePropertyFunction.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}},module.exports={StyleExpression:StyleExpression,StyleExpressionWithErrorHandling:StyleExpressionWithErrorHandling,isExpression:isExpression,createExpression:createExpression,createPropertyExpression:createPropertyExpression,normalizePropertyExpression:function normalizePropertyExpression(e,r){if(isFunction(e))return new StylePropertyFunction(e,r);if(isExpression(e)){var n=createPropertyExpression(e,r);if("error"===n.result)throw new Error(n.value.map(function(e){return e.key+": "+e.message}).join(", "));return n.value}var t=e;return"string"==typeof e&&"color"===r.type&&(t=Color.parse(e)),{kind:"constant",evaluate:function(){return t}}},ZoomConstantExpression:ZoomConstantExpression,ZoomDependentExpression:ZoomDependentExpression,StylePropertyFunction:StylePropertyFunction};var ref$4=_dereq_("./types"),ColorType=ref$4.ColorType,StringType=ref$4.StringType,NumberType=ref$4.NumberType,BooleanType=ref$4.BooleanType,ValueType=ref$4.ValueType,array=ref$4.array},{"../function":149,"../util/extend":156,"../util/result":160,"./compound_expression":123,"./definitions":131,"./definitions/coalesce":128,"./definitions/interpolate":132,"./definitions/let":133,"./definitions/step":136,"./evaluation_context":138,"./is_constant":140,"./parsing_context":141,"./parsing_error":142,"./runtime_error":143,"./types":146,"./values":147}],140:[function(_dereq_,module,exports){var CompoundExpression=_dereq_("./compound_expression").CompoundExpression;module.exports={isFeatureConstant:function isFeatureConstant(n){if(n instanceof CompoundExpression){if("get"===n.name&&1===n.args.length)return!1;if("has"===n.name&&1===n.args.length)return!1;if("properties"===n.name||"geometry-type"===n.name||"id"===n.name)return!1;if(/^filter-/.test(n.name))return!1}var e=!0;return n.eachChild(function(n){e&&!isFeatureConstant(n)&&(e=!1)}),e},isGlobalPropertyConstant:function isGlobalPropertyConstant(n,e){if(n instanceof CompoundExpression&&e.indexOf(n.name)>=0)return!1;var t=!0;return n.eachChild(function(n){t&&!isGlobalPropertyConstant(n,e)&&(t=!1)}),t}}},{"./compound_expression":123}],141:[function(_dereq_,module,exports){var Scope=_dereq_("./scope"),checkSubtype=_dereq_("./types").checkSubtype,ParsingError=_dereq_("./parsing_error"),Literal=_dereq_("./definitions/literal"),Assertion=_dereq_("./definitions/assertion"),ArrayAssertion=_dereq_("./definitions/array"),Coercion=_dereq_("./definitions/coercion"),ParsingContext=function(e,r,t,n,i){void 0===r&&(r=[]),void 0===n&&(n=new Scope),void 0===i&&(i=[]),this.registry=e,this.path=r,this.key=r.map(function(e){return"["+e+"]"}).join(""),this.scope=n,this.errors=i,this.expectedType=t};ParsingContext.prototype.parse=function(e,r,t,n,i){void 0===i&&(i={});var o=this;if(r&&(o=o.concat(r,t,n)),null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return o.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var a=e[0];if("string"!=typeof a)return o.error("Expression name must be a string, but found "+typeof a+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var s=o.registry[a];if(s){var u=s.parse(e,o);if(!u)return null;if(o.expectedType){var p=o.expectedType,l=u.type;if("string"!==p.kind&&"number"!==p.kind&&"boolean"!==p.kind||"value"!==l.kind)if("array"===p.kind&&"value"===l.kind)i.omitTypeAnnotations||(u=new ArrayAssertion(p,u));else if("color"!==p.kind||"value"!==l.kind&&"string"!==l.kind){if(o.checkSubtype(o.expectedType,u.type))return null}else i.omitTypeAnnotations||(u=new Coercion(p,[u]));else i.omitTypeAnnotations||(u=new Assertion(p,[u]))}if(!(u instanceof Literal)&&function isConstant(e){var t=_dereq_("./compound_expression").CompoundExpression,n=_dereq_("./is_constant"),i=n.isGlobalPropertyConstant,o=n.isFeatureConstant;if(e instanceof _dereq_("./definitions/var"))return!1;if(e instanceof t&&"error"===e.name)return!1;var a=!0;return e.eachChild(function(e){e instanceof Literal||(a=!1)}),!!a&&o(e)&&i(e,["zoom","heatmap-density"])}(u)){var c=new(_dereq_("./evaluation_context"));try{u=new Literal(u.type,u.evaluate(c))}catch(e){return o.error(e.message),null}}return u}return o.error('Unknown expression "'+a+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===e?o.error("'undefined' value invalid. Use null instead."):"object"==typeof e?o.error('Bare objects invalid. Use ["literal", {...}] instead.'):o.error("Expected an array, but found "+typeof e+" instead.")},ParsingContext.prototype.concat=function(e,r,t){var n="number"==typeof e?this.path.concat(e):this.path,i=t?this.scope.concat(t):this.scope;return new ParsingContext(this.registry,n,r||null,i,this.errors)},ParsingContext.prototype.error=function(e){for(var arguments$1=arguments,r=[],t=arguments.length-1;t-- >0;)r[t]=arguments$1[t+1];var n=""+this.key+r.map(function(e){return"["+e+"]"}).join("");this.errors.push(new ParsingError(n,e))},ParsingContext.prototype.checkSubtype=function(e,r){var t=checkSubtype(e,r);return t&&this.error(t),t},module.exports=ParsingContext},{"./compound_expression":123,"./definitions/array":124,"./definitions/assertion":125,"./definitions/coercion":129,"./definitions/literal":134,"./definitions/var":137,"./evaluation_context":138,"./is_constant":140,"./parsing_error":142,"./scope":144,"./types":146}],142:[function(_dereq_,module,exports){var ParsingError=function(r){function t(t,o){r.call(this,o),this.message=o,this.key=t}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t}(Error);module.exports=ParsingError},{}],143:[function(_dereq_,module,exports){var RuntimeError=function(r){this.name="ExpressionEvaluationError",this.message=r};RuntimeError.prototype.toJSON=function(){return this.message},module.exports=RuntimeError},{}],144:[function(_dereq_,module,exports){var Scope=function(t,n){void 0===n&&(n=[]),this.parent=t,this.bindings={};for(var e=0,r=n;e<r.length;e+=1){var o=r[e],s=o[0],p=o[1];this.bindings[s]=p}};Scope.prototype.concat=function(t){return new Scope(this,t)},Scope.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},Scope.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)},module.exports=Scope},{}],145:[function(_dereq_,module,exports){var RuntimeError=_dereq_("./runtime_error");module.exports={findStopLessThanOrEqualTo:function findStopLessThanOrEqualTo(r,e){for(var n,t,u=0,i=r.length-1,a=0;u<=i;){if(n=r[a=Math.floor((u+i)/2)],t=r[a+1],e===n||e>n&&e<t)return a;if(n<e)u=a+1;else{if(!(n>e))throw new RuntimeError("Input is not a number.");i=a-1}}return Math.max(a-1,0)}}},{"./runtime_error":143}],146:[function(_dereq_,module,exports){function array(e,r){return{kind:"array",itemType:e,N:r}}function toString(e){if("array"===e.kind){var r=toString(e.itemType);return"number"==typeof e.N?"array<"+r+", "+e.N+">":"value"===e.itemType.kind?"array":"array<"+r+">"}return e.kind}var NullType={kind:"null"},NumberType={kind:"number"},StringType={kind:"string"},BooleanType={kind:"boolean"},ColorType={kind:"color"},ObjectType={kind:"object"},ValueType={kind:"value"},valueMemberTypes=[NullType,NumberType,StringType,BooleanType,ColorType,ObjectType,array(ValueType)];module.exports={NullType:NullType,NumberType:NumberType,StringType:StringType,BooleanType:BooleanType,ColorType:ColorType,ObjectType:ObjectType,ValueType:ValueType,array:array,ErrorType:{kind:"error"},toString:toString,checkSubtype:function checkSubtype(e,r){if("error"===r.kind)return null;if("array"===e.kind){if("array"===r.kind&&!checkSubtype(e.itemType,r.itemType)&&("number"!=typeof e.N||e.N===r.N))return null}else{if(e.kind===r.kind)return null;if("value"===e.kind)for(var n=0,y=valueMemberTypes;n<y.length;n+=1)if(!checkSubtype(y[n],r))return null}return"Expected "+toString(e)+" but found "+toString(r)+" instead."}}},{}],147:[function(_dereq_,module,exports){var Color=_dereq_("../util/color"),ref=_dereq_("./types"),NullType=ref.NullType,NumberType=ref.NumberType,StringType=ref.StringType,BooleanType=ref.BooleanType,ColorType=ref.ColorType,ObjectType=ref.ObjectType,ValueType=ref.ValueType,array=ref.array;module.exports={Color:Color,validateRGBA:function validateRGBA(e,r,t,n){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof r&&r>=0&&r<=255&&"number"==typeof t&&t>=0&&t<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:"Invalid rgba value ["+[e,r,t,n].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof n?[e,r,t,n]:[e,r,t]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."},isValue:function isValue(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof Color)return!0;if(Array.isArray(e)){for(var r=0,t=e;r<t.length;r+=1)if(!isValue(t[r]))return!1;return!0}if("object"==typeof e){for(var n in e)if(!isValue(e[n]))return!1;return!0}return!1},typeOf:function typeOf(e){if(null===e)return NullType;if("string"==typeof e)return StringType;if("boolean"==typeof e)return BooleanType;if("number"==typeof e)return NumberType;if(e instanceof Color)return ColorType;if(Array.isArray(e)){for(var r,t=e.length,n=0,u=e;n<u.length;n+=1){var f=typeOf(u[n]);if(r){if(r===f)continue;r=ValueType;break}r=f}return array(r||ValueType,t)}return ObjectType}}},{"../util/color":153,"./types":146}],148:[function(_dereq_,module,exports){function isExpressionFilter(e){if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3===e.length&&(Array.isArray(e[1])||Array.isArray(e[2]));case"any":case"all":for(var r=0,t=e.slice(1);r<t.length;r+=1){var n=t[r];if(!isExpressionFilter(n)&&"boolean"!=typeof n)return!1}return!0;default:return!0}}function compare(e,r){return e<r?-1:e>r?1:0}function convertFilter(e){if(!e)return!0;var r=e[0];return e.length<=1?"any"!==r:"=="===r?convertComparisonOp(e[1],e[2],"=="):"!="===r?convertNegation(convertComparisonOp(e[1],e[2],"==")):"<"===r||">"===r||"<="===r||">="===r?convertComparisonOp(e[1],e[2],r):"any"===r?function convertDisjunctionOp(e){return["any"].concat(e.map(convertFilter))}(e.slice(1)):"all"===r?["all"].concat(e.slice(1).map(convertFilter)):"none"===r?["all"].concat(e.slice(1).map(convertFilter).map(convertNegation)):"in"===r?convertInOp(e[1],e.slice(2)):"!in"===r?convertNegation(convertInOp(e[1],e.slice(2))):"has"===r?convertHasOp(e[1]):"!has"!==r||convertNegation(convertHasOp(e[1]))}function convertComparisonOp(e,r,t){switch(e){case"$type":return["filter-type-"+t,r];case"$id":return["filter-id-"+t,r];default:return["filter-"+t,e,r]}}function convertInOp(e,r){if(0===r.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(function(e){return typeof e!=typeof r[0]})?["filter-in-large",e,["literal",r.sort(compare)]]:["filter-in-small",e,["literal",r]]}}function convertHasOp(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function convertNegation(e){return["!",e]}var createExpression=_dereq_("../expression").createExpression;module.exports=function createFilter(e){if(!e)return function(){return!0};isExpressionFilter(e)||(e=convertFilter(e));var r=createExpression(e,filterSpec);if("error"===r.result)throw new Error(r.value.map(function(e){return e.key+": "+e.message}).join(", "));return function(e,t){return r.value.evaluate(e,t)}},module.exports.isExpressionFilter=isExpressionFilter;var filterSpec={type:"boolean",default:!1,function:!0,"property-function":!0,"zoom-function":!0}},{"../expression":139}],149:[function(_dereq_,module,exports){function identityFunction(e){return e}function coalesce(e,t,o){return void 0!==e?e:void 0!==t?t:void 0!==o?o:void 0}function evaluateCategoricalFunction(e,t,o,r,n){return coalesce(typeof o===n?r[o]:void 0,e.default,t.default)}function evaluateIntervalFunction(e,t,o){if("number"!==getType(o))return coalesce(e.default,t.default);var r=e.stops.length;if(1===r)return e.stops[0][1];if(o<=e.stops[0][0])return e.stops[0][1];if(o>=e.stops[r-1][0])return e.stops[r-1][1];var n=findStopLessThanOrEqualTo(e.stops,o);return e.stops[n][1]}function evaluateExponentialFunction(e,t,o){var r=void 0!==e.base?e.base:1;if("number"!==getType(o))return coalesce(e.default,t.default);var n=e.stops.length;if(1===n)return e.stops[0][1];if(o<=e.stops[0][0])return e.stops[0][1];if(o>=e.stops[n-1][0])return e.stops[n-1][1];var a=findStopLessThanOrEqualTo(e.stops,o),i=function interpolationFactor(e,t,o,r){var n=r-o,a=e-o;return 0===n?0:1===t?a/n:(Math.pow(t,a)-1)/(Math.pow(t,n)-1)}(o,r,e.stops[a][0],e.stops[a+1][0]),u=e.stops[a][1],p=e.stops[a+1][1],l=interpolate[t.type]||identityFunction;if(e.colorSpace&&"rgb"!==e.colorSpace){var s=colorSpaces[e.colorSpace];l=function(e,t){return s.reverse(s.interpolate(s.forward(e),s.forward(t),i))}}return"function"==typeof u.evaluate?{evaluate:function(){for(var arguments$1=arguments,e=[],t=arguments.length;t--;)e[t]=arguments$1[t];var o=u.evaluate.apply(void 0,e),r=p.evaluate.apply(void 0,e);if(void 0!==o&&void 0!==r)return l(o,r,i)}}:l(u,p,i)}function evaluateIdentityFunction(e,t,o){return"color"===t.type?o=Color.parse(o):getType(o)===t.type||"enum"===t.type&&t.values[o]||(o=void 0),coalesce(o,e.default,t.default)}function findStopLessThanOrEqualTo(e,t){for(var o,r,a=0,i=e.length-1,u=0;a<=i;){if(o=e[u=Math.floor((a+i)/2)][0],r=e[u+1][0],t===o||t>o&&t<r)return u;o<t?a=u+1:o>t&&(i=u-1)}return Math.max(u-1,0)}var colorSpaces=_dereq_("../util/color_spaces"),Color=_dereq_("../util/color"),extend=_dereq_("../util/extend"),getType=_dereq_("../util/get_type"),interpolate=_dereq_("../util/interpolate"),Interpolate=_dereq_("../expression/definitions/interpolate");module.exports={createFunction:function createFunction(e,t){var u,p,l,o="color"===t.type,r=e.stops&&"object"==typeof e.stops[0][0],n=r||void 0!==e.property,a=r||!n,i=e.type||("interpolated"===t.function?"exponential":"interval");if(o&&((e=extend({},e)).stops&&(e.stops=e.stops.map(function(e){return[e[0],Color.parse(e[1])]})),e.default?e.default=Color.parse(e.default):e.default=Color.parse(t.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!colorSpaces[e.colorSpace])throw new Error("Unknown color space: "+e.colorSpace);if("exponential"===i)u=evaluateExponentialFunction;else if("interval"===i)u=evaluateIntervalFunction;else if("categorical"===i){u=evaluateCategoricalFunction,p=Object.create(null);for(var s=0,c=e.stops;s<c.length;s+=1){var f=c[s];p[f[0]]=f[1]}l=typeof e.stops[0][0]}else{if("identity"!==i)throw new Error('Unknown function type "'+i+'"');u=evaluateIdentityFunction}if(r){for(var v={},d=[],y=0;y<e.stops.length;y++){var F=e.stops[y],h=F[0].zoom;void 0===v[h]&&(v[h]={zoom:h,type:e.type,property:e.property,default:e.default,stops:[]},d.push(h)),v[h].stops.push([F[0].value,F[1]])}for(var m=[],g=0,b=d;g<b.length;g+=1){var S=b[g];m.push([v[S].zoom,createFunction(v[S],t)])}return{kind:"composite",interpolationFactor:Interpolate.interpolationFactor.bind(void 0,{name:"linear"}),zoomStops:m.map(function(e){return e[0]}),evaluate:function(o,r){var n=o.zoom;return evaluateExponentialFunction({stops:m,base:e.base},t,n).evaluate(n,r)}}}return a?{kind:"camera",interpolationFactor:"exponential"===i?Interpolate.interpolationFactor.bind(void 0,{name:"exponential",base:void 0!==e.base?e.base:1}):function(){return 0},zoomStops:e.stops.map(function(e){return e[0]}),evaluate:function(o){var r=o.zoom;return u(e,t,r,p,l)}}:{kind:"source",evaluate:function(o,r){var n=r&&r.properties?r.properties[e.property]:void 0;return void 0===n?coalesce(e.default,t.default):u(e,t,n,p,l)}}},isFunction:function isFunction(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}}},{"../expression/definitions/interpolate":132,"../util/color":153,"../util/color_spaces":154,"../util/extend":156,"../util/get_type":157,"../util/interpolate":158}],150:[function(_dereq_,module,exports){function stringify(r){var t=typeof r;if("number"===t||"boolean"===t||"string"===t||void 0===r||null===r)return JSON.stringify(r);if(Array.isArray(r)){for(var e="[",i=0,n=r;i<n.length;i+=1)e+=stringify(n[i])+",";return e+"]"}for(var o=Object.keys(r).sort(),f="{",u=0;u<o.length;u++)f+=JSON.stringify(o[u])+":"+stringify(r[o[u]])+",";return f+"}"}function getKey(r){for(var t="",e=0,i=refProperties;e<i.length;e+=1)t+="/"+stringify(r[i[e]]);return t}var refProperties=_dereq_("./util/ref_properties");module.exports=function groupByLayout(r){for(var t={},e=0;e<r.length;e++){var i=getKey(r[e]),n=t[i];n||(n=t[i]=[]),n.push(r[e])}var o=[];for(var f in t)o.push(t[f]);return o}},{"./util/ref_properties":159}],151:[function(_dereq_,module,exports){module.exports=_dereq_("./v8.json")},{"./v8.json":152}],152:[function(_dereq_,module,exports){module.exports={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image","source_canvas"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.0511,180,85.0511]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.0511,180,85.0511]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.0511,180,85.0511]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_canvas:{type:{required:!0,type:"enum",values:{canvas:{}}},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}},animate:{type:"boolean",default:"true"},canvas:{type:"string",required:!0}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_fill:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_circle:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_line:{"line-cap":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{butt:{},round:{},square:{}},default:"butt"},"line-join":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{bevel:{},round:{},miter:{}},default:"miter"},"line-miter-limit":{type:"number",default:2,function:"interpolated","zoom-function":!0,requires:[{"line-join":"miter"}]},"line-round-limit":{type:"number",default:1.05,function:"interpolated","zoom-function":!0,requires:[{"line-join":"round"}]},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_symbol:{"symbol-placement":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{point:{},line:{}},default:"point"},"symbol-spacing":{type:"number",default:250,minimum:1,function:"interpolated","zoom-function":!0,units:"pixels",requires:[{"symbol-placement":"line"}]},"symbol-avoid-edges":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1},"icon-allow-overlap":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image"]},"icon-ignore-placement":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image"]},"icon-optional":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image","text-field"]},"icon-rotation-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"]},"icon-size":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,units:"factor of the original icon size",requires:["icon-image"]},"icon-text-fit":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"]},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",function:"interpolated","zoom-function":!0,requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}]},"icon-image":{type:"string",function:"piecewise-constant","zoom-function":!0,"property-function":!0,tokens:!0},"icon-rotate":{type:"number",default:0,period:360,function:"interpolated","zoom-function":!0,"property-function":!0,units:"degrees",requires:["icon-image"]},"icon-padding":{type:"number",default:2,minimum:0,function:"interpolated","zoom-function":!0,units:"pixels",requires:["icon-image"]},"icon-keep-upright":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":"line"}]},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,"property-function":!0,requires:["icon-image"]},"icon-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"]},"icon-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"]},"text-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"]},"text-rotation-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"]},"text-field":{type:"string",function:"piecewise-constant","zoom-function":!0,"property-function":!0,default:"",tokens:!0},"text-font":{type:"array",value:"string",function:"piecewise-constant","zoom-function":!0,"property-function":!0,default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"]},"text-size":{type:"number",default:16,minimum:0,units:"pixels",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-line-height":{type:"number",default:1.2,units:"ems",function:"interpolated","zoom-function":!0,requires:["text-field"]},"text-letter-spacing":{type:"number",default:0,units:"ems",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-justify":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{left:{},center:{},right:{}},default:"center",requires:["text-field"]},"text-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field"]},"text-max-angle":{type:"number",default:45,units:"degrees",function:"interpolated","zoom-function":!0,requires:["text-field",{"symbol-placement":"line"}]},"text-rotate":{type:"number",default:0,period:360,units:"degrees",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",function:"interpolated","zoom-function":!0,requires:["text-field"]},"text-keep-upright":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":"line"}]},"text-transform":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"]},"text-offset":{type:"array",value:"number",units:"ems",function:"interpolated","zoom-function":!0,"property-function":!0,length:2,default:[0,0],requires:["text-field"]},"text-allow-overlap":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field"]},"text-ignore-placement":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field"]},"text-optional":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field","icon-image"]},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},transition:!1,"zoom-function":!0,"property-function":!1,function:"piecewise-constant"},position:{type:"array",default:[1.15,210,30],length:3,value:"number",transition:!0,function:"interpolated","zoom-function":!0,"property-function":!1},color:{type:"color",default:"#ffffff",function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0},intensity:{type:"number",default:.5,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!0},"fill-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:1,minimum:0,maximum:1,transition:!0},"fill-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"}]},"fill-outline-color":{type:"color",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}]},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"fill-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["fill-translate"]},"fill-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!1,default:1,minimum:0,maximum:1,transition:!0},"fill-extrusion-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-extrusion-pattern"}]},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"fill-extrusion-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"]},"fill-extrusion-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0},"fill-extrusion-height":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:0,minimum:0,units:"meters",transition:!0},"fill-extrusion-base":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"]}},paint_line:{"line-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:1,minimum:0,maximum:1,transition:!0},"line-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"line-pattern"}]},"line-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"line-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["line-translate"]},"line-width":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-gap-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-offset":{type:"number",default:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-dasharray":{type:"array",value:"number",function:"piecewise-constant","zoom-function":!0,minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}]},"line-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"circle-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-blur":{type:"number",default:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"circle-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["circle-translate"]},"circle-pitch-scale":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map"},"circle-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"viewport"},"circle-stroke-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"circle-stroke-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"heatmap-weight":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!1},"heatmap-intensity":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],function:"interpolated","zoom-function":!1,"property-function":!1,transition:!1},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-halo-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"]},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-halo-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"]}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-hue-rotate":{type:"number",default:0,period:360,function:"interpolated","zoom-function":!0,transition:!0,units:"degrees"},"raster-brightness-min":{type:"number",function:"interpolated","zoom-function":!0,default:0,minimum:0,maximum:1,transition:!0},"raster-brightness-max":{type:"number",function:"interpolated","zoom-function":!0,default:1,minimum:0,maximum:1,transition:!0},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-fade-duration":{type:"number",default:300,minimum:0,function:"interpolated","zoom-function":!0,transition:!1,units:"milliseconds"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,function:"interpolated","zoom-function":!0,transition:!1},"hillshade-illumination-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"viewport"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"hillshade-shadow-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,transition:!0},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",function:"interpolated","zoom-function":!0,transition:!0},"hillshade-accent-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,transition:!0}},paint_background:{"background-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,transition:!0,requires:[{"!":"background-pattern"}]},"background-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,transition:!0}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}}}},{}],153:[function(_dereq_,module,exports){var parseCSSColor=_dereq_("csscolorparser").parseCSSColor,Color=function(r,o,t,e){void 0===e&&(e=1),this.r=r,this.g=o,this.b=t,this.a=e};Color.parse=function(r){if(r){if(r instanceof Color)return r;if("string"==typeof r){var o=parseCSSColor(r);if(o)return new Color(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3])}}},Color.prototype.toString=function(){var r=this;return"rgba("+[this.r,this.g,this.b].map(function(o){return Math.round(255*o/r.a)}).concat(this.a).join(",")+")"},Color.black=new Color(0,0,0,1),Color.white=new Color(1,1,1,1),Color.transparent=new Color(0,0,0,0),module.exports=Color},{csscolorparser:13}],154:[function(_dereq_,module,exports){function xyz2lab(a){return a>t3?Math.pow(a,1/3):a/t2+t0}function lab2xyz(a){return a>t1?a*a*a:t2*(a-t0)}function xyz2rgb(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function rgb2xyz(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function rgbToLab(a){var r=rgb2xyz(a.r),t=rgb2xyz(a.g),e=rgb2xyz(a.b),n=xyz2lab((.4124564*r+.3575761*t+.1804375*e)/Xn),l=xyz2lab((.2126729*r+.7151522*t+.072175*e)/Yn);return{l:116*l-16,a:500*(n-l),b:200*(l-xyz2lab((.0193339*r+.119192*t+.9503041*e)/Zn)),alpha:a.a}}function labToRgb(a){var r=(a.l+16)/116,t=isNaN(a.a)?r:r+a.a/500,e=isNaN(a.b)?r:r-a.b/200;return r=Yn*lab2xyz(r),t=Xn*lab2xyz(t),e=Zn*lab2xyz(e),new Color(xyz2rgb(3.2404542*t-1.5371385*r-.4985314*e),xyz2rgb(-.969266*t+1.8760108*r+.041556*e),xyz2rgb(.0556434*t-.2040259*r+1.0572252*e),a.alpha)}var Color=_dereq_("./color"),interpolateNumber=_dereq_("./interpolate").number,Xn=.95047,Yn=1,Zn=1.08883,t0=4/29,t1=6/29,t2=3*t1*t1,t3=t1*t1*t1,deg2rad=Math.PI/180,rad2deg=180/Math.PI;module.exports={lab:{forward:rgbToLab,reverse:labToRgb,interpolate:function interpolateLab(a,r,t){return{l:interpolateNumber(a.l,r.l,t),a:interpolateNumber(a.a,r.a,t),b:interpolateNumber(a.b,r.b,t),alpha:interpolateNumber(a.alpha,r.alpha,t)}}},hcl:{forward:function rgbToHcl(a){var r=rgbToLab(a),t=r.l,e=r.a,n=r.b,l=Math.atan2(n,e)*rad2deg;return{h:l<0?l+360:l,c:Math.sqrt(e*e+n*n),l:t,alpha:a.a}},reverse:function hclToRgb(a){var r=a.h*deg2rad,t=a.c;return labToRgb({l:a.l,a:Math.cos(r)*t,b:Math.sin(r)*t,alpha:a.alpha})},interpolate:function interpolateHcl(a,r,t){return{h:function interpolateHue(a,r,t){var e=r-a;return a+t*(e>180||e<-180?e-360*Math.round(e/360):e)}(a.h,r.h,t),c:interpolateNumber(a.c,r.c,t),l:interpolateNumber(a.l,r.l,t),alpha:interpolateNumber(a.alpha,r.alpha,t)}}}}},{"./color":153,"./interpolate":158}],155:[function(_dereq_,module,exports){module.exports=function deepEqual(e,r){if(Array.isArray(e)){if(!Array.isArray(r)||e.length!==r.length)return!1;for(var t=0;t<e.length;t++)if(!deepEqual(e[t],r[t]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==r){if("object"!=typeof r)return!1;if(Object.keys(e).length!==Object.keys(r).length)return!1;for(var n in e)if(!deepEqual(e[n],r[n]))return!1;return!0}return e===r}},{}],156:[function(_dereq_,module,exports){module.exports=function(r){for(var arguments$1=arguments,t=[],e=arguments.length-1;e-- >0;)t[e]=arguments$1[e+1];for(var n=0,o=t;n<o.length;n+=1){var a=o[n];for(var f in a)r[f]=a[f]}return r}},{}],157:[function(_dereq_,module,exports){module.exports=function(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":null===n?"null":typeof n}},{}],158:[function(_dereq_,module,exports){function number(r,n,u){return r*(1-u)+n*u}var Color=_dereq_("./color");module.exports={number:number,color:function color(r,n,u){return new Color(number(r.r,n.r,u),number(r.g,n.g,u),number(r.b,n.b,u),number(r.a,n.a,u))},array:function array(r,n,u){return r.map(function(r,e){return number(r,n[e],u)})}}},{"./color":153}],159:[function(_dereq_,module,exports){module.exports=["type","source","source-layer","minzoom","maxzoom","filter","layout"]},{}],160:[function(_dereq_,module,exports){module.exports={success:function success(r){return{result:"success",value:r}},error:function error(r){return{result:"error",value:r}}}},{}],161:[function(_dereq_,module,exports){function unbundle(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}module.exports=unbundle,module.exports.deep=function deepUnbundle(e){return Array.isArray(e)?e.map(deepUnbundle):unbundle(e)}},{}],162:[function(_dereq_,module,exports){var extend=_dereq_("../util/extend"),unbundle=_dereq_("../util/unbundle_jsonlint"),isExpression=_dereq_("../expression").isExpression,isFunction=_dereq_("../function").isFunction;module.exports=function(e){var r=_dereq_("./validate_function"),i=_dereq_("./validate_expression"),t=_dereq_("./validate_object"),n={"*":function(){return[]},array:_dereq_("./validate_array"),boolean:_dereq_("./validate_boolean"),number:_dereq_("./validate_number"),color:_dereq_("./validate_color"),constants:_dereq_("./validate_constants"),enum:_dereq_("./validate_enum"),filter:_dereq_("./validate_filter"),function:_dereq_("./validate_function"),layer:_dereq_("./validate_layer"),object:_dereq_("./validate_object"),source:_dereq_("./validate_source"),light:_dereq_("./validate_light"),string:_dereq_("./validate_string")},u=e.value,a=e.valueSpec,l=e.styleSpec;return a.function&&isFunction(unbundle(u))?r(e):a.function&&isExpression(unbundle.deep(u))?i(e):a.type&&n[a.type]?n[a.type](e):t(extend({},e,{valueSpec:a.type?l[a.type]:a}))}},{"../expression":139,"../function":149,"../util/extend":156,"../util/unbundle_jsonlint":161,"./validate_array":163,"./validate_boolean":164,"./validate_color":165,"./validate_constants":166,"./validate_enum":167,"./validate_expression":168,"./validate_filter":169,"./validate_function":170,"./validate_layer":172,"./validate_light":174,"./validate_number":175,"./validate_object":176,"./validate_source":179,"./validate_string":180}],163:[function(_dereq_,module,exports){var getType=_dereq_("../util/get_type"),validate=_dereq_("./validate"),ValidationError=_dereq_("../error/validation_error");module.exports=function(e){var r=e.value,t=e.valueSpec,a=e.style,n=e.styleSpec,l=e.key,i=e.arrayElementValidator||validate;if("array"!==getType(r))return[new ValidationError(l,r,"array expected, "+getType(r)+" found")];if(t.length&&r.length!==t.length)return[new ValidationError(l,r,"array length "+t.length+" expected, length "+r.length+" found")];if(t["min-length"]&&r.length<t["min-length"])return[new ValidationError(l,r,"array length at least "+t["min-length"]+" expected, length "+r.length+" found")];var o={type:t.value};n.$version<7&&(o.function=t.function),"object"===getType(t.value)&&(o=t.value);for(var u=[],g=0;g<r.length;g++)u=u.concat(i({array:r,arrayIndex:g,value:r[g],valueSpec:o,style:a,styleSpec:n,key:l+"["+g+"]"}));return u}},{"../error/validation_error":122,"../util/get_type":157,"./validate":162}],164:[function(_dereq_,module,exports){var getType=_dereq_("../util/get_type"),ValidationError=_dereq_("../error/validation_error");module.exports=function(e){var r=e.value,o=e.key,t=getType(r);return"boolean"!==t?[new ValidationError(o,r,"boolean expected, "+t+" found")]:[]}},{"../error/validation_error":122,"../util/get_type":157}],165:[function(_dereq_,module,exports){var ValidationError=_dereq_("../error/validation_error"),getType=_dereq_("../util/get_type"),parseCSSColor=_dereq_("csscolorparser").parseCSSColor;module.exports=function(r){var e=r.key,o=r.value,t=getType(o);return"string"!==t?[new ValidationError(e,o,"color expected, "+t+" found")]:null===parseCSSColor(o)?[new ValidationError(e,o,'color expected, "'+o+'" found')]:[]}},{"../error/validation_error":122,"../util/get_type":157,csscolorparser:13}],166:[function(_dereq_,module,exports){var ValidationError=_dereq_("../error/validation_error");module.exports=function(r){var e=r.key,a=r.value;return a?[new ValidationError(e,a,"constants have been deprecated as of v8")]:[]}},{"../error/validation_error":122}],167:[function(_dereq_,module,exports){var ValidationError=_dereq_("../error/validation_error"),unbundle=_dereq_("../util/unbundle_jsonlint");module.exports=function(e){var r=e.key,n=e.value,u=e.valueSpec,i=[];return Array.isArray(u.values)?-1===u.values.indexOf(unbundle(n))&&i.push(new ValidationError(r,n,"expected one of ["+u.values.join(", ")+"], "+JSON.stringify(n)+" found")):-1===Object.keys(u.values).indexOf(unbundle(n))&&i.push(new ValidationError(r,n,"expected one of ["+Object.keys(u.values).join(", ")+"], "+JSON.stringify(n)+" found")),i}},{"../error/validation_error":122,"../util/unbundle_jsonlint":161}],168:[function(_dereq_,module,exports){var ValidationError=_dereq_("../error/validation_error"),ref=_dereq_("../expression"),createExpression=ref.createExpression,createPropertyExpression=ref.createPropertyExpression,unbundle=_dereq_("../util/unbundle_jsonlint");module.exports=function(e){var r=("property"===e.expressionContext?createPropertyExpression:createExpression)(unbundle.deep(e.value),e.valueSpec);return"error"===r.result?r.value.map(function(r){return new ValidationError(""+e.key+r.key,e.value,r.message)}):"property"===e.expressionContext&&"text-font"===e.propertyKey&&-1!==r.value._styleExpression.expression.possibleOutputs().indexOf(void 0)?[new ValidationError(e.key,e.value,'Invalid data expression for "text-font". Output values must be contained as literals within the expression.')]:[]}},{"../error/validation_error":122,"../expression":139,"../util/unbundle_jsonlint":161}],169:[function(_dereq_,module,exports){var ValidationError=_dereq_("../error/validation_error"),validateExpression=_dereq_("./validate_expression"),validateEnum=_dereq_("./validate_enum"),getType=_dereq_("../util/get_type"),unbundle=_dereq_("../util/unbundle_jsonlint"),extend=_dereq_("../util/extend"),isExpressionFilter=_dereq_("../feature_filter").isExpressionFilter;module.exports=function(e){return isExpressionFilter(unbundle.deep(e.value))?validateExpression(extend({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function validateNonExpressionFilter(e){var r=e.value,t=e.key;if("array"!==getType(r))return[new ValidationError(t,r,"array expected, "+getType(r)+" found")];var a,n=e.styleSpec,i=[];if(r.length<1)return[new ValidationError(t,r,"filter array must have at least 1 element")];switch(i=i.concat(validateEnum({key:t+"[0]",value:r[0],valueSpec:n.filter_operator,style:e.style,styleSpec:e.styleSpec})),unbundle(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&"$type"===unbundle(r[1])&&i.push(new ValidationError(t,r,'"$type" cannot be use with operator "'+r[0]+'"'));case"==":case"!=":3!==r.length&&i.push(new ValidationError(t,r,'filter array for operator "'+r[0]+'" must have 3 elements'));case"in":case"!in":r.length>=2&&"string"!==(a=getType(r[1]))&&i.push(new ValidationError(t+"[1]",r[1],"string expected, "+a+" found"));for(var l=2;l<r.length;l++)a=getType(r[l]),"$type"===unbundle(r[1])?i=i.concat(validateEnum({key:t+"["+l+"]",value:r[l],valueSpec:n.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==a&&"number"!==a&&"boolean"!==a&&i.push(new ValidationError(t+"["+l+"]",r[l],"string, number, or boolean expected, "+a+" found"));break;case"any":case"all":case"none":for(var s=1;s<r.length;s++)i=i.concat(validateNonExpressionFilter({key:t+"["+s+"]",value:r[s],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":a=getType(r[1]),2!==r.length?i.push(new ValidationError(t,r,'filter array for "'+r[0]+'" operator must have 2 elements')):"string"!==a&&i.push(new ValidationError(t+"[1]",r[1],"string expected, "+a+" found"))}return i}(e)}},{"../error/validation_error":122,"../feature_filter":148,"../util/extend":156,"../util/get_type":157,"../util/unbundle_jsonlint":161,"./validate_enum":167,"./validate_expression":168}],170:[function(_dereq_,module,exports){var ValidationError=_dereq_("../error/validation_error"),getType=_dereq_("../util/get_type"),validate=_dereq_("./validate"),validateObject=_dereq_("./validate_object"),validateArray=_dereq_("./validate_array"),validateNumber=_dereq_("./validate_number"),unbundle=_dereq_("../util/unbundle_jsonlint");module.exports=function(e){function r(e){var t=[],r=e.value,o=e.key;if("array"!==getType(r))return[new ValidationError(o,r,"array expected, "+getType(r)+" found")];if(2!==r.length)return[new ValidationError(o,r,"array length 2 expected, length "+r.length+" found")];if(d){if("object"!==getType(r[0]))return[new ValidationError(o,r,"object expected, "+getType(r[0])+" found")];if(void 0===r[0].zoom)return[new ValidationError(o,r,"object stop key must have zoom")];if(void 0===r[0].value)return[new ValidationError(o,r,"object stop key must have value")];if(l&&l>unbundle(r[0].zoom))return[new ValidationError(o,r[0].zoom,"stop zoom values must appear in ascending order")];unbundle(r[0].zoom)!==l&&(l=unbundle(r[0].zoom),i=void 0,s={}),t=t.concat(validateObject({key:o+"[0]",value:r[0],valueSpec:{zoom:{}},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:validateNumber,value:a}}))}else t=t.concat(a({key:o+"[0]",value:r[0],valueSpec:{},style:e.style,styleSpec:e.styleSpec},r));return t.concat(validate({key:o+"[1]",value:r[1],valueSpec:u,style:e.style,styleSpec:e.styleSpec}))}function a(e,t){var r=getType(e.value),a=unbundle(e.value),o=null!==e.value?e.value:t;if(n){if(r!==n)return[new ValidationError(e.key,o,r+" stop domain type must match previous stop domain type "+n)]}else n=r;if("number"!==r&&"string"!==r&&"boolean"!==r)return[new ValidationError(e.key,o,"stop domain value must be a number, string, or boolean")];if("number"!==r&&"categorical"!==p){var l="number expected, "+r+" found";return u["property-function"]&&void 0===p&&(l+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ValidationError(e.key,o,l)]}return"categorical"!==p||"number"!==r||isFinite(a)&&Math.floor(a)===a?"categorical"!==p&&"number"===r&&void 0!==i&&a<i?[new ValidationError(e.key,o,"stop domain values must appear in ascending order")]:(i=a,"categorical"===p&&a in s?[new ValidationError(e.key,o,"stop domain values must be unique")]:(s[a]=!0,[])):[new ValidationError(e.key,o,"integer expected, found "+a)]}var n,i,l,u=e.valueSpec,p=unbundle(e.value.type),s={},y="categorical"!==p&&void 0===e.value.property,c=!y,d="array"===getType(e.value.stops)&&"array"===getType(e.value.stops[0])&&"object"===getType(e.value.stops[0][0]),v=validateObject({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function t(e){if("identity"===p)return[new ValidationError(e.key,e.value,'identity function may not have a "stops" property')];var t=[],a=e.value;return t=t.concat(validateArray({key:e.key,value:a,valueSpec:e.valueSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:r})),"array"===getType(a)&&0===a.length&&t.push(new ValidationError(e.key,a,"array must have at least one stop")),t},default:function o(e){return validate({key:e.key,value:e.value,valueSpec:u,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===p&&y&&v.push(new ValidationError(e.key,e.value,'missing required property "property"')),"identity"===p||e.value.stops||v.push(new ValidationError(e.key,e.value,'missing required property "stops"')),"exponential"===p&&"piecewise-constant"===e.valueSpec.function&&v.push(new ValidationError(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(c&&!e.valueSpec["property-function"]?v.push(new ValidationError(e.key,e.value,"property functions not supported")):y&&!e.valueSpec["zoom-function"]&&"heatmap-color"!==e.objectKey&&v.push(new ValidationError(e.key,e.value,"zoom functions not supported"))),"categorical"!==p&&!d||void 0!==e.value.property||v.push(new ValidationError(e.key,e.value,'"property" property is required')),v}},{"../error/validation_error":122,"../util/get_type":157,"../util/unbundle_jsonlint":161,"./validate":162,"./validate_array":163,"./validate_number":175,"./validate_object":176}],171:[function(_dereq_,module,exports){var ValidationError=_dereq_("../error/validation_error"),validateString=_dereq_("./validate_string");module.exports=function(r){var e=r.value,t=r.key,a=validateString(r);return a.length?a:(-1===e.indexOf("{fontstack}")&&a.push(new ValidationError(t,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&a.push(new ValidationError(t,e,'"glyphs" url must include a "{range}" token')),a)}},{"../error/validation_error":122,"./validate_string":180}],172:[function(_dereq_,module,exports){var ValidationError=_dereq_("../error/validation_error"),unbundle=_dereq_("../util/unbundle_jsonlint"),validateObject=_dereq_("./validate_object"),validateFilter=_dereq_("./validate_filter"),validatePaintProperty=_dereq_("./validate_paint_property"),validateLayoutProperty=_dereq_("./validate_layout_property"),validateSpec=_dereq_("./validate"),extend=_dereq_("../util/extend");module.exports=function(e){var r=[],t=e.value,a=e.key,l=e.style,i=e.styleSpec;t.type||t.ref||r.push(new ValidationError(a,t,'either "type" or "ref" is required'));var d,u=unbundle(t.type),n=unbundle(t.ref);if(t.id)for(var o=unbundle(t.id),s=0;s<e.arrayIndex;s++){var y=l.layers[s];unbundle(y.id)===o&&r.push(new ValidationError(a,t.id,'duplicate layer id "'+t.id+'", previously used at line '+y.id.__line__))}if("ref"in t)["type","source","source-layer","filter","layout"].forEach(function(e){e in t&&r.push(new ValidationError(a,t[e],'"'+e+'" is prohibited for ref layers'))}),l.layers.forEach(function(e){unbundle(e.id)===n&&(d=e)}),d?d.ref?r.push(new ValidationError(a,t.ref,"ref cannot reference another ref layer")):u=unbundle(d.type):r.push(new ValidationError(a,t.ref,'ref layer "'+n+'" not found'));else if("background"!==u)if(t.source){var c=l.sources&&l.sources[t.source],p=c&&unbundle(c.type);c?"vector"===p&&"raster"===u?r.push(new ValidationError(a,t.source,'layer "'+t.id+'" requires a raster source')):"raster"===p&&"raster"!==u?r.push(new ValidationError(a,t.source,'layer "'+t.id+'" requires a vector source')):"vector"!==p||t["source-layer"]?"raster-dem"===p&&"hillshade"!==u&&r.push(new ValidationError(a,t.source,"raster-dem source can only be used with layer type 'hillshade'.")):r.push(new ValidationError(a,t,'layer "'+t.id+'" must specify a "source-layer"')):r.push(new ValidationError(a,t.source,'source "'+t.source+'" not found'))}else r.push(new ValidationError(a,t,'missing required property "source"'));return r=r.concat(validateObject({key:a,value:t,valueSpec:i.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return validateSpec({key:a+".type",value:t.type,valueSpec:i.layer.type,style:e.style,styleSpec:e.styleSpec,object:t,objectKey:"type"})},filter:validateFilter,layout:function(e){return validateObject({layer:t,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return validateLayoutProperty(extend({layerType:u},e))}}})},paint:function(e){return validateObject({layer:t,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return validatePaintProperty(extend({layerType:u},e))}}})}}}))}},{"../error/validation_error":122,"../util/extend":156,"../util/unbundle_jsonlint":161,"./validate":162,"./validate_filter":169,"./validate_layout_property":173,"./validate_object":176,"./validate_paint_property":177}],173:[function(_dereq_,module,exports){var validateProperty=_dereq_("./validate_property");module.exports=function(r){return validateProperty(r,"layout")}},{"./validate_property":178}],174:[function(_dereq_,module,exports){var ValidationError=_dereq_("../error/validation_error"),getType=_dereq_("../util/get_type"),validate=_dereq_("./validate");module.exports=function(e){var t=e.value,r=e.styleSpec,a=r.light,i=e.style,n=[],o=getType(t);if(void 0===t)return n;if("object"!==o)return n.concat([new ValidationError("light",t,"object expected, "+o+" found")]);for(var l in t){var c=l.match(/^(.*)-transition$/);n=c&&a[c[1]]&&a[c[1]].transition?n.concat(validate({key:l,value:t[l],valueSpec:r.transition,style:i,styleSpec:r})):a[l]?n.concat(validate({key:l,value:t[l],valueSpec:a[l],style:i,styleSpec:r})):n.concat([new ValidationError(l,t[l],'unknown property "'+l+'"')])}return n}},{"../error/validation_error":122,"../util/get_type":157,"./validate":162}],175:[function(_dereq_,module,exports){var getType=_dereq_("../util/get_type"),ValidationError=_dereq_("../error/validation_error");module.exports=function(e){var r=e.key,i=e.value,m=e.valueSpec,a=getType(i);return"number"!==a?[new ValidationError(r,i,"number expected, "+a+" found")]:"minimum"in m&&i<m.minimum?[new ValidationError(r,i,i+" is less than the minimum value "+m.minimum)]:"maximum"in m&&i>m.maximum?[new ValidationError(r,i,i+" is greater than the maximum value "+m.maximum)]:[]}},{"../error/validation_error":122,"../util/get_type":157}],176:[function(_dereq_,module,exports){var ValidationError=_dereq_("../error/validation_error"),getType=_dereq_("../util/get_type"),validateSpec=_dereq_("./validate");module.exports=function(e){var r=e.key,t=e.value,i=e.valueSpec||{},a=e.objectElementValidators||{},o=e.style,l=e.styleSpec,n=[],u=getType(t);if("object"!==u)return[new ValidationError(r,t,"object expected, "+u+" found")];for(var d in t){var p=d.split(".")[0],c=i[p]||i["*"],v=void 0;if(a[p])v=a[p];else if(i[p])v=validateSpec;else if(a["*"])v=a["*"];else{if(!i["*"]){n.push(new ValidationError(r,t[d],'unknown property "'+d+'"'));continue}v=validateSpec}n=n.concat(v({key:(r?r+".":r)+d,value:t[d],valueSpec:c,style:o,styleSpec:l,object:t,objectKey:d},t))}for(var s in i)a[s]||i[s].required&&void 0===i[s].default&&void 0===t[s]&&n.push(new ValidationError(r,t,'missing required property "'+s+'"'));return n}},{"../error/validation_error":122,"../util/get_type":157,"./validate":162}],177:[function(_dereq_,module,exports){var validateProperty=_dereq_("./validate_property");module.exports=function(r){return validateProperty(r,"paint")}},{"./validate_property":178}],178:[function(_dereq_,module,exports){var validate=_dereq_("./validate"),ValidationError=_dereq_("../error/validation_error"),getType=_dereq_("../util/get_type"),isFunction=_dereq_("../function").isFunction,unbundle=_dereq_("../util/unbundle_jsonlint");module.exports=function(e,t){var r=e.key,n=e.style,i=e.styleSpec,o=e.value,a=e.objectKey,u=i[t+"_"+e.layerType];if(!u)return[];var p=a.match(/^(.*)-transition$/);if("paint"===t&&p&&u[p[1]]&&u[p[1]].transition)return validate({key:r,value:o,valueSpec:i.transition,style:n,styleSpec:i});var y,l=e.valueSpec||u[a];if(!l)return[new ValidationError(r,o,'unknown property "'+a+'"')];if("string"===getType(o)&&l["property-function"]&&!l.tokens&&(y=/^{([^}]+)}$/.exec(o)))return[new ValidationError(r,o,'"'+a+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(y[1])+" }`.")];var s=[];return"symbol"===e.layerType&&("text-field"===a&&n&&!n.glyphs&&s.push(new ValidationError(r,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&isFunction(unbundle.deep(o))&&"identity"===unbundle(o.type)&&s.push(new ValidationError(r,o,'"text-font" does not support identity functions'))),s.concat(validate({key:e.key,value:o,valueSpec:l,style:n,styleSpec:i,expressionContext:"property",propertyKey:a}))}},{"../error/validation_error":122,"../function":149,"../util/get_type":157,"../util/unbundle_jsonlint":161,"./validate":162}],179:[function(_dereq_,module,exports){var ValidationError=_dereq_("../error/validation_error"),unbundle=_dereq_("../util/unbundle_jsonlint"),validateObject=_dereq_("./validate_object"),validateEnum=_dereq_("./validate_enum");module.exports=function(e){var a=e.value,r=e.key,t=e.styleSpec,l=e.style;if(!a.type)return[new ValidationError(r,a,'"type" is required')];var u=unbundle(a.type),s=[];switch(u){case"vector":case"raster":case"raster-dem":if(s=s.concat(validateObject({key:r,value:a,valueSpec:t["source_"+u.replace("-","_")],style:e.style,styleSpec:t})),"url"in a)for(var c in a)["type","url","tileSize"].indexOf(c)<0&&s.push(new ValidationError(r+"."+c,a[c],'a source with a "url" property may not include a "'+c+'" property'));return s;case"geojson":return validateObject({key:r,value:a,valueSpec:t.source_geojson,style:l,styleSpec:t});case"video":return validateObject({key:r,value:a,valueSpec:t.source_video,style:l,styleSpec:t});case"image":return validateObject({key:r,value:a,valueSpec:t.source_image,style:l,styleSpec:t});case"canvas":return validateObject({key:r,value:a,valueSpec:t.source_canvas,style:l,styleSpec:t});default:return validateEnum({key:r+".type",value:a.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image","canvas"]},style:l,styleSpec:t})}}},{"../error/validation_error":122,"../util/unbundle_jsonlint":161,"./validate_enum":167,"./validate_object":176}],180:[function(_dereq_,module,exports){var getType=_dereq_("../util/get_type"),ValidationError=_dereq_("../error/validation_error");module.exports=function(r){var e=r.value,t=r.key,i=getType(e);return"string"!==i?[new ValidationError(t,e,"string expected, "+i+" found")]:[]}},{"../error/validation_error":122,"../util/get_type":157}],181:[function(_dereq_,module,exports){function validateStyleMin(e,a){a=a||latestStyleSpec;var t=[];return t=t.concat(validate({key:"",value:e,valueSpec:a.$root,styleSpec:a,style:e,objectElementValidators:{glyphs:validateGlyphsURL,"*":function(){return[]}}})),e.constants&&(t=t.concat(validateConstants({key:"constants",value:e.constants,style:e,styleSpec:a}))),sortErrors(t)}function sortErrors(e){return[].concat(e).sort(function(e,a){return e.line-a.line})}function wrapCleanErrors(e){return function(){return sortErrors(e.apply(this,arguments))}}var validateConstants=_dereq_("./validate/validate_constants"),validate=_dereq_("./validate/validate"),latestStyleSpec=_dereq_("./reference/latest"),validateGlyphsURL=_dereq_("./validate/validate_glyphs_url");validateStyleMin.source=wrapCleanErrors(_dereq_("./validate/validate_source")),validateStyleMin.light=wrapCleanErrors(_dereq_("./validate/validate_light")),validateStyleMin.layer=wrapCleanErrors(_dereq_("./validate/validate_layer")),validateStyleMin.filter=wrapCleanErrors(_dereq_("./validate/validate_filter")),validateStyleMin.paintProperty=wrapCleanErrors(_dereq_("./validate/validate_paint_property")),validateStyleMin.layoutProperty=wrapCleanErrors(_dereq_("./validate/validate_layout_property")),module.exports=validateStyleMin},{"./reference/latest":151,"./validate/validate":162,"./validate/validate_constants":166,"./validate/validate_filter":169,"./validate/validate_glyphs_url":171,"./validate/validate_layer":172,"./validate/validate_layout_property":173,"./validate/validate_light":174,"./validate/validate_paint_property":177,"./validate/validate_source":179}],182:[function(_dereq_,module,exports){var ZoomHistory=_dereq_("./zoom_history"),EvaluationParameters=function(t,o){this.zoom=t,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ZoomHistory,this.transition={})};EvaluationParameters.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},module.exports=EvaluationParameters},{"./zoom_history":212}],183:[function(_dereq_,module,exports){var styleSpec=_dereq_("../style-spec/reference/latest"),util=_dereq_("../util/util"),Evented=_dereq_("../util/evented"),validateStyle=_dereq_("./validate_style"),sphericalToCartesian=_dereq_("../util/util").sphericalToCartesian,interpolate=(_dereq_("../style-spec/util/color"),_dereq_("../style-spec/util/interpolate")),ref$1=_dereq_("./properties"),Properties=ref$1.Properties,Transitionable=ref$1.Transitionable,DataConstantProperty=(ref$1.Transitioning,ref$1.PossiblyEvaluated,ref$1.DataConstantProperty),LightPositionProperty=function(){this.specification=styleSpec.light.position};LightPositionProperty.prototype.possiblyEvaluate=function(t,e){return sphericalToCartesian(t.expression.evaluate(e))},LightPositionProperty.prototype.interpolate=function(t,e,i){return{x:interpolate.number(t.x,e.x,i),y:interpolate.number(t.y,e.y,i),z:interpolate.number(t.z,e.z,i)}};var properties=new Properties({anchor:new DataConstantProperty(styleSpec.light.anchor),position:new LightPositionProperty,color:new DataConstantProperty(styleSpec.light.color),intensity:new DataConstantProperty(styleSpec.light.intensity)}),Light=function(t){function e(e){t.call(this),this._transitionable=new Transitionable(properties),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getLight=function(){return this._transitionable.serialize()},e.prototype.setLight=function(t){if(!this._validate(validateStyle.light,t))for(var i in t){var r=t[i];util.endsWith(i,"-transition")?this._transitionable.setTransition(i.slice(0,-"-transition".length),r):this._transitionable.setValue(i,r)}},e.prototype.updateTransitions=function(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)},e.prototype.hasTransition=function(){return this._transitioning.hasTransition()},e.prototype.recalculate=function(t){this.properties=this._transitioning.possiblyEvaluate(t)},e.prototype._validate=function(t,e){return validateStyle.emitErrors(this,t.call(validateStyle,util.extend({value:e,style:{glyphs:!0,sprite:!0},styleSpec:styleSpec})))},e}(Evented);module.exports=Light},{"../style-spec/reference/latest":151,"../style-spec/util/color":153,"../style-spec/util/interpolate":158,"../util/evented":260,"../util/util":275,"./properties":188,"./validate_style":211}],184:[function(_dereq_,module,exports){var normalizeGlyphsURL=_dereq_("../util/mapbox").normalizeGlyphsURL,ajax=_dereq_("../util/ajax"),parseGlyphPBF=_dereq_("./parse_glyph_pbf");module.exports=function(e,r,a,l,p){var i=256*r,s=i+255,t=l(normalizeGlyphsURL(a).replace("{fontstack}",e).replace("{range}",i+"-"+s),ajax.ResourceType.Glyphs);ajax.getArrayBuffer(t,function(e,r){if(e)p(e);else if(r){for(var a={},l=0,i=parseGlyphPBF(r.data);l<i.length;l+=1){var s=i[l];a[s.id]=s}p(null,a)}})}},{"../util/ajax":251,"../util/mapbox":267,"./parse_glyph_pbf":186}],185:[function(_dereq_,module,exports){var ajax=_dereq_("../util/ajax"),browser=_dereq_("../util/browser"),normalizeSpriteURL=_dereq_("../util/mapbox").normalizeSpriteURL,RGBAImage=_dereq_("../util/image").RGBAImage;module.exports=function(e,i,r){function a(){if(n)r(n);else if(t&&o){var e=browser.getImageData(o),i={};for(var a in t){var u=t[a],g=u.width,l=u.height,x=u.x,m=u.y,p=u.sdf,f=u.pixelRatio,s=new RGBAImage({width:g,height:l});RGBAImage.copy(e,s,{x:x,y:m},{x:0,y:0},{width:g,height:l}),i[a]={data:s,pixelRatio:f,sdf:p}}r(null,i)}}var t,o,n,u=browser.devicePixelRatio>1?"@2x":"";ajax.getJSON(i(normalizeSpriteURL(e,u,".json"),ajax.ResourceType.SpriteJSON),function(e,i){n||(n=e,t=i,a())}),ajax.getImage(i(normalizeSpriteURL(e,u,".png"),ajax.ResourceType.SpriteImage),function(e,i){n||(n=e,o=i,a())})}},{"../util/ajax":251,"../util/browser":252,"../util/image":263,"../util/mapbox":267}],186:[function(_dereq_,module,exports){function readFontstacks(e,a,r){1===e&&r.readMessage(readFontstack,a)}function readFontstack(e,a,r){if(3===e){var t=r.readMessage(readGlyph,{}),d=t.id,i=t.bitmap,n=t.width,o=t.height,h=t.left,s=t.top,p=t.advance;a.push({id:d,bitmap:new AlphaImage({width:n+2*border,height:o+2*border},i),metrics:{width:n,height:o,left:h,top:s,advance:p}})}}function readGlyph(e,a,r){1===e?a.id=r.readVarint():2===e?a.bitmap=r.readBytes():3===e?a.width=r.readVarint():4===e?a.height=r.readVarint():5===e?a.left=r.readSVarint():6===e?a.top=r.readSVarint():7===e&&(a.advance=r.readVarint())}var AlphaImage=_dereq_("../util/image").AlphaImage,Protobuf=_dereq_("pbf"),border=3;module.exports=function(e){return new Protobuf(e).readFields(readFontstacks,[])},module.exports.GLYPH_PBF_BORDER=border},{"../util/image":263,pbf:30}],187:[function(_dereq_,module,exports){var browser=_dereq_("../util/browser"),Placement=_dereq_("../symbol/placement"),LayerPlacement=function(){this._currentTileIndex=0,this._seenCrossTileIDs={}};LayerPlacement.prototype.continuePlacement=function(e,n,t,r,o){for(var l=this;this._currentTileIndex<e.length;){var s=e[l._currentTileIndex];if(n.placeLayerTile(r,s,t,l._seenCrossTileIDs),l._currentTileIndex++,o())return!0}};var PauseablePlacement=function(e,n,t,r,o){this.placement=new Placement(e,o),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=t,this._showCollisionBoxes=r,this._done=!1};PauseablePlacement.prototype.isDone=function(){return this._done},PauseablePlacement.prototype.continuePlacement=function(e,n,t){for(var r=this,o=browser.now(),l=function(){var e=browser.now()-o;return!r._forceFullPlacement&&e>2};this._currentPlacementIndex>=0;){var a=n[e[r._currentPlacementIndex]],i=r.placement.collisionIndex.transform.zoom;if("symbol"===a.type&&(!a.minzoom||a.minzoom<=i)&&(!a.maxzoom||a.maxzoom>i)){if(r._inProgressLayer||(r._inProgressLayer=new LayerPlacement),r._inProgressLayer.continuePlacement(t[a.source],r.placement,r._showCollisionBoxes,a,l))return;delete r._inProgressLayer}r._currentPlacementIndex--}this._done=!0},PauseablePlacement.prototype.commit=function(e,n){return this.placement.commit(e,n),this.placement},module.exports=PauseablePlacement},{"../symbol/placement":223,"../util/browser":252}],188:[function(_dereq_,module,exports){var ref=_dereq_("../util/util"),clone=ref.clone,extend=ref.extend,easeCubicInOut=ref.easeCubicInOut,interpolate=_dereq_("../style-spec/util/interpolate"),normalizePropertyExpression=_dereq_("../style-spec/expression").normalizePropertyExpression,register=(_dereq_("../style-spec/util/color"),_dereq_("../util/web_worker_transfer").register),PropertyValue=function(t,e){this.property=t,this.value=e,this.expression=normalizePropertyExpression(void 0===e?t.specification.default:e,t.specification)};PropertyValue.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},PropertyValue.prototype.possiblyEvaluate=function(t){return this.property.possiblyEvaluate(this,t)};var TransitionablePropertyValue=function(t){this.property=t,this.value=new PropertyValue(t,void 0)};TransitionablePropertyValue.prototype.transitioned=function(t,e){return new TransitioningPropertyValue(this.property,this.value,e,extend({},t.transition,this.transition),t.now)},TransitionablePropertyValue.prototype.untransitioned=function(){return new TransitioningPropertyValue(this.property,this.value,null,{},0)};var Transitionable=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};Transitionable.prototype.getValue=function(t){return clone(this._values[t].value.value)},Transitionable.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new TransitionablePropertyValue(this._values[t].property)),this._values[t].value=new PropertyValue(this._values[t].property,null===e?void 0:clone(e))},Transitionable.prototype.getTransition=function(t){return clone(this._values[t].transition)},Transitionable.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new TransitionablePropertyValue(this._values[t].property)),this._values[t].transition=clone(e)||void 0},Transitionable.prototype.serialize=function(){for(var t=this,e={},r=0,a=Object.keys(t._values);r<a.length;r+=1){var o=a[r],i=t.getValue(o);void 0!==i&&(e[o]=i);var n=t.getTransition(o);void 0!==n&&(e[o+"-transition"]=n)}return e},Transitionable.prototype.transitioned=function(t,e){for(var a=new Transitioning(this._properties),o=0,i=Object.keys(this._values);o<i.length;o+=1){var n=i[o];a._values[n]=this._values[n].transitioned(t,e._values[n])}return a},Transitionable.prototype.untransitioned=function(){for(var e=new Transitioning(this._properties),r=0,a=Object.keys(this._values);r<a.length;r+=1){var o=a[r];e._values[o]=this._values[o].untransitioned()}return e};var TransitioningPropertyValue=function(t,e,r,a,o){this.property=t,this.value=e,this.begin=o+a.delay||0,this.end=this.begin+a.duration||0,t.specification.transition&&(a.delay||a.duration)&&(this.prior=r)};TransitioningPropertyValue.prototype.possiblyEvaluate=function(t){var e=t.now||0,r=this.value.possiblyEvaluate(t),a=this.prior;if(a){if(e>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(e<this.begin)return a.possiblyEvaluate(t);var o=(e-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(t),r,easeCubicInOut(o))}return r};var Transitioning=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};Transitioning.prototype.possiblyEvaluate=function(t){for(var r=new PossiblyEvaluated(this._properties),a=0,o=Object.keys(this._values);a<o.length;a+=1){var i=o[a];r._values[i]=this._values[i].possiblyEvaluate(t)}return r},Transitioning.prototype.hasTransition=function(){for(var e=0,r=Object.keys(this._values);e<r.length;e+=1){var a=r[e];if(this._values[a].prior)return!0}return!1};var Layout=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};Layout.prototype.getValue=function(t){return clone(this._values[t].value)},Layout.prototype.setValue=function(t,e){this._values[t]=new PropertyValue(this._values[t].property,null===e?void 0:clone(e))},Layout.prototype.serialize=function(){for(var e={},r=0,a=Object.keys(this._values);r<a.length;r+=1){var o=a[r],i=this.getValue(o);void 0!==i&&(e[o]=i)}return e},Layout.prototype.possiblyEvaluate=function(t){for(var r=new PossiblyEvaluated(this._properties),a=0,o=Object.keys(this._values);a<o.length;a+=1){var i=o[a];r._values[i]=this._values[i].possiblyEvaluate(t)}return r};var PossiblyEvaluatedPropertyValue=function(t,e,r){this.property=t,this.value=e,this.globals=r};PossiblyEvaluatedPropertyValue.prototype.isConstant=function(){return"constant"===this.value.kind},PossiblyEvaluatedPropertyValue.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},PossiblyEvaluatedPropertyValue.prototype.evaluate=function(t){return this.property.evaluate(this.value,this.globals,t)};var PossiblyEvaluated=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};PossiblyEvaluated.prototype.get=function(t){return this._values[t]};var DataConstantProperty=function(t){this.specification=t};DataConstantProperty.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},DataConstantProperty.prototype.interpolate=function(t,e,r){var a=interpolate[this.specification.type];return a?a(t,e,r):t};var DataDrivenProperty=function(t){this.specification=t};DataDrivenProperty.prototype.possiblyEvaluate=function(t,e){return"constant"===t.expression.kind||"camera"===t.expression.kind?new PossiblyEvaluatedPropertyValue(this,{kind:"constant",value:t.expression.evaluate(e)},e):new PossiblyEvaluatedPropertyValue(this,t.expression,e)},DataDrivenProperty.prototype.interpolate=function(t,e,r){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0!==t.value.value&&void 0!==e.value.value){var a=interpolate[this.specification.type];return a?new PossiblyEvaluatedPropertyValue(this,{kind:"constant",value:a(t.value.value,e.value.value,r)},t.globals):t}},DataDrivenProperty.prototype.evaluate=function(t,e,r){return"constant"===t.kind?t.value:t.evaluate(e,r)};var CrossFadedProperty=function(t){this.specification=t};CrossFadedProperty.prototype.possiblyEvaluate=function(t,e){if(void 0!==t.value){if("constant"===t.expression.kind){var r=t.expression.evaluate(e);return this._calculate(r,r,r,e)}return this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e)}},CrossFadedProperty.prototype._calculate=function(t,e,r,a){var o=a.zoom,i=o-Math.floor(o),n=a.crossFadingFactor();return o>a.zoomHistory.lastIntegerZoom?{from:t,to:e,fromScale:2,toScale:1,t:i+(1-i)*n}:{from:r,to:e,fromScale:.5,toScale:1,t:1-(1-n)*i}},CrossFadedProperty.prototype.interpolate=function(t){return t};var HeatmapColorProperty=function(t){this.specification=t};HeatmapColorProperty.prototype.possiblyEvaluate=function(){},HeatmapColorProperty.prototype.interpolate=function(){};register("DataDrivenProperty",DataDrivenProperty),register("DataConstantProperty",DataConstantProperty),register("CrossFadedProperty",CrossFadedProperty),register("HeatmapColorProperty",HeatmapColorProperty),module.exports={PropertyValue:PropertyValue,Transitionable:Transitionable,Transitioning:Transitioning,Layout:Layout,PossiblyEvaluatedPropertyValue:PossiblyEvaluatedPropertyValue,PossiblyEvaluated:PossiblyEvaluated,DataConstantProperty:DataConstantProperty,DataDrivenProperty:DataDrivenProperty,CrossFadedProperty:CrossFadedProperty,HeatmapColorProperty:HeatmapColorProperty,Properties:function(t){var e=this;for(var r in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},t){var a=t[r],o=e.defaultPropertyValues[r]=new PropertyValue(a,void 0),i=e.defaultTransitionablePropertyValues[r]=new TransitionablePropertyValue(a);e.defaultTransitioningPropertyValues[r]=i.untransitioned(),e.defaultPossiblyEvaluatedValues[r]=o.possiblyEvaluate({})}}}},{"../style-spec/expression":139,"../style-spec/util/color":153,"../style-spec/util/interpolate":158,"../util/util":275,"../util/web_worker_transfer":278}],189:[function(_dereq_,module,exports){var Point=_dereq_("@mapbox/point-geometry");module.exports={getMaximumPaintValue:function getMaximumPaintValue(t,a,e){var n=a.paint.get(t).value;return"constant"===n.kind?n.value:e.programConfigurations.get(a.id).binders[t].statistics.max},translateDistance:function translateDistance(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},translate:function translate(t,a,e,n,r){if(!a[0]&&!a[1])return t;var i=Point.convert(a);"viewport"===e&&i._rotate(-n);for(var u=[],s=0;s<t.length;s++){for(var o=t[s],l=[],m=0;m<o.length;m++)l.push(o[m].sub(i._mult(r)));u.push(l)}return u}}},{"@mapbox/point-geometry":4}],190:[function(_dereq_,module,exports){var Evented=_dereq_("../util/evented"),StyleLayer=_dereq_("./style_layer"),loadSprite=_dereq_("./load_sprite"),ImageManager=_dereq_("../render/image_manager"),GlyphManager=_dereq_("../render/glyph_manager"),Light=_dereq_("./light"),LineAtlas=_dereq_("../render/line_atlas"),util=_dereq_("../util/util"),ajax=_dereq_("../util/ajax"),mapbox=_dereq_("../util/mapbox"),browser=_dereq_("../util/browser"),Dispatcher=_dereq_("../util/dispatcher"),validateStyle=_dereq_("./validate_style"),getSourceType=_dereq_("../source/source").getType,setSourceType=_dereq_("../source/source").setType,QueryFeatures=_dereq_("../source/query_features"),SourceCache=_dereq_("../source/source_cache"),styleSpec=(_dereq_("../source/geojson_source"),_dereq_("../style-spec/reference/latest")),getWorkerPool=_dereq_("../util/global_worker_pool"),deref=_dereq_("../style-spec/deref"),diff=_dereq_("../style-spec/diff"),rtlTextPlugin=_dereq_("../source/rtl_text_plugin"),PauseablePlacement=_dereq_("./pauseable_placement"),ZoomHistory=_dereq_("./zoom_history"),CrossTileSymbolIndex=_dereq_("../symbol/cross_tile_symbol_index"),supportedDiffOperations=util.pick(diff.operations,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),ignoredDiffOperations=util.pick(diff.operations,["setCenter","setZoom","setBearing","setPitch"]),Style=function(e){function r(r,t){var a=this;void 0===t&&(t={}),e.call(this),this.map=r,this.dispatcher=new Dispatcher(getWorkerPool(),this),this.imageManager=new ImageManager,this.glyphManager=new GlyphManager(r._transformRequest,t.localIdeographFontFamily),this.lineAtlas=new LineAtlas(256,512),this.crossTileSymbolIndex=new CrossTileSymbolIndex,this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new ZoomHistory,this._loaded=!1,this._resetUpdates();var i=this;this._rtlTextPluginCallback=rtlTextPlugin.registerForPluginAvailability(function(e){for(var r in i.dispatcher.broadcast("loadRTLTextPlugin",e.pluginBlobURL,e.errorCallback),i.sourceCaches)i.sourceCaches[r].reload()}),this.on("data",function(e){if("source"===e.dataType&&"metadata"===e.sourceDataType){var r=a.sourceCaches[e.sourceId];if(r){var t=r.getSource();if(t&&t.vectorLayerIds)for(var i in a._layers){var s=a._layers[i];s.source===t.id&&a._validateLayer(s)}}}})}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.loadURL=function(e,r){var t=this;void 0===r&&(r={}),this.fire("dataloading",{dataType:"style"});var a="boolean"==typeof r.validate?r.validate:!mapbox.isMapboxURL(e);e=mapbox.normalizeStyleURL(e,r.accessToken);var i=this.map._transformRequest(e,ajax.ResourceType.Style);ajax.getJSON(i,function(e,r){e?t.fire("error",{error:e}):r&&t._load(r,a)})},r.prototype.loadJSON=function(e,r){var t=this;void 0===r&&(r={}),this.fire("dataloading",{dataType:"style"}),browser.frame(function(){t._load(e,!1!==r.validate)})},r.prototype._load=function(e,r){var t=this;if(!r||!validateStyle.emitErrors(this,validateStyle(e))){for(var a in this._loaded=!0,this.stylesheet=e,e.sources)t.addSource(a,e.sources[a],{validate:!1});e.sprite?loadSprite(e.sprite,this.map._transformRequest,function(e,r){if(e)t.fire("error",e);else if(r)for(var a in r)t.imageManager.addImage(a,r[a]);t.imageManager.setLoaded(!0),t.fire("data",{dataType:"style"})}):this.imageManager.setLoaded(!0),this.glyphManager.setURL(e.glyphs);var i=deref(this.stylesheet.layers);this._order=i.map(function(e){return e.id}),this._layers={};for(var s=0,o=i;s<o.length;s+=1){var n=o[s];(n=StyleLayer.create(n)).setEventedParent(t,{layer:{id:n.id}}),t._layers[n.id]=n}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Light(this.stylesheet.light),this.fire("data",{dataType:"style"}),this.fire("style.load")}},r.prototype._validateLayer=function(e){var r=this.sourceCaches[e.source];if(r){var t=e.sourceLayer;if(t){var a=r.getSource();("geojson"===a.type||a.vectorLayerIds&&-1===a.vectorLayerIds.indexOf(t))&&this.fire("error",{error:new Error('Source layer "'+t+'" does not exist on source "'+a.id+'" as specified by style layer "'+e.id+'"')})}}},r.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var r in this.sourceCaches)if(!this.sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()},r.prototype._serializeLayers=function(e){var r=this;return e.map(function(e){return r._layers[e].serialize()})},r.prototype.hasTransitions=function(){var e=this;if(this.light&&this.light.hasTransition())return!0;for(var r in e.sourceCaches)if(e.sourceCaches[r].hasTransition())return!0;for(var t in e._layers)if(e._layers[t].hasTransition())return!0;return!1},r.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},r.prototype.update=function(e){var r=this;if(this._loaded){if(this._changed){var t=Object.keys(this._updatedLayers),a=Object.keys(this._removedLayers);for(var i in(t.length||a.length)&&this._updateWorkerLayers(t,a),r._updatedSources){var s=r._updatedSources[i];"reload"===s?r._reloadSource(i):"clear"===s&&r._clearSource(i)}for(var o in r._updatedPaintProps)r._layers[o].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates(),this.fire("data",{dataType:"style"})}for(var n in r.sourceCaches)r.sourceCaches[n].used=!1;for(var l=0,h=r._order;l<h.length;l+=1){var u=h[l],d=r._layers[u];d.recalculate(e),!d.isHidden(e.zoom)&&d.source&&(r.sourceCaches[d.source].used=!0)}this.light.recalculate(e),this.z=e.zoom}},r.prototype._updateWorkerLayers=function(e,r){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(e),removedIds:r})},r.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={}},r.prototype.setState=function(e){var r=this;if(this._checkLoaded(),validateStyle.emitErrors(this,validateStyle(e)))return!1;(e=util.clone(e)).layers=deref(e.layers);var t=diff(this.serialize(),e).filter(function(e){return!(e.command in ignoredDiffOperations)});if(0===t.length)return!1;var a=t.filter(function(e){return!(e.command in supportedDiffOperations)});if(a.length>0)throw new Error("Unimplemented: "+a.map(function(e){return e.command}).join(", ")+".");return t.forEach(function(e){"setTransition"!==e.command&&r[e.command].apply(r,e.args)}),this.stylesheet=e,!0},r.prototype.addImage=function(e,r){if(this.getImage(e))return this.fire("error",{error:new Error("An image with this name already exists.")});this.imageManager.addImage(e,r),this.fire("data",{dataType:"style"})},r.prototype.getImage=function(e){return this.imageManager.getImage(e)},r.prototype.removeImage=function(e){if(!this.getImage(e))return this.fire("error",{error:new Error("No image with this name exists.")});this.imageManager.removeImage(e),this.fire("data",{dataType:"style"})},r.prototype.addSource=function(e,r,t){var a=this;if(this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error("There is already a source with this ID");if(!r.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(r).join(", ")+".");if(!(["vector","raster","geojson","video","image","canvas"].indexOf(r.type)>=0&&this._validate(validateStyle.source,"sources."+e,r,null,t))){this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);var i=this.sourceCaches[e]=new SourceCache(e,r,this.dispatcher);i.style=this,i.setEventedParent(this,function(){return{isSourceLoaded:a.loaded(),source:i.serialize(),sourceId:e}}),i.onAdd(this.map),this._changed=!0}},r.prototype.removeSource=function(e){var r=this;if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(var t in r._layers)if(r._layers[t].source===e)return r.fire("error",{error:new Error('Source "'+e+'" cannot be removed while layer "'+t+'" is using it.')});var a=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],a.fire("data",{sourceDataType:"metadata",dataType:"source",sourceId:e}),a.setEventedParent(null),a.clearTiles(),a.onRemove&&a.onRemove(this.map),this._changed=!0},r.prototype.setGeoJSONSourceData=function(e,r){this._checkLoaded(),this.sourceCaches[e].getSource().setData(r),this._changed=!0},r.prototype.getSource=function(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()},r.prototype.addLayer=function(e,r,t){this._checkLoaded();var a=e.id;if("object"==typeof e.source&&(this.addSource(a,e.source),e=util.clone(e),e=util.extend(e,{source:a})),!this._validate(validateStyle.layer,"layers."+a,e,{arrayIndex:-1},t)){var i=StyleLayer.create(e);this._validateLayer(i),i.setEventedParent(this,{layer:{id:a}});var s=r?this._order.indexOf(r):this._order.length;if(r&&-1===s)return void this.fire("error",{error:new Error('Layer with id "'+r+'" does not exist on this map.')});if(this._order.splice(s,0,a),this._layerOrderChanged=!0,this._layers[a]=i,this._removedLayers[a]&&i.source){var o=this._removedLayers[a];delete this._removedLayers[a],o.type!==i.type?this._updatedSources[i.source]="clear":(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause())}this._updateLayer(i)}},r.prototype.moveLayer=function(e,r){if(this._checkLoaded(),this._changed=!0,this._layers[e]){var t=this._order.indexOf(e);this._order.splice(t,1);var a=r?this._order.indexOf(r):this._order.length;r&&-1===a?this.fire("error",{error:new Error('Layer with id "'+r+'" does not exist on this map.')}):(this._order.splice(a,0,e),this._layerOrderChanged=!0)}else this.fire("error",{error:new Error("The layer '"+e+"' does not exist in the map's style and cannot be moved.")})},r.prototype.removeLayer=function(e){this._checkLoaded();var r=this._layers[e];if(r){r.setEventedParent(null);var t=this._order.indexOf(e);this._order.splice(t,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=r,delete this._layers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e]}else this.fire("error",{error:new Error("The layer '"+e+"' does not exist in the map's style and cannot be removed.")})},r.prototype.getLayer=function(e){return this._layers[e]},r.prototype.setLayerZoomRange=function(e,r,t){this._checkLoaded();var a=this.getLayer(e);a?a.minzoom===r&&a.maxzoom===t||(null!=r&&(a.minzoom=r),null!=t&&(a.maxzoom=t),this._updateLayer(a)):this.fire("error",{error:new Error("The layer '"+e+"' does not exist in the map's style and cannot have zoom extent.")})},r.prototype.setFilter=function(e,r){this._checkLoaded();var t=this.getLayer(e);if(t)return util.deepEqual(t.filter,r)?void 0:null===r||void 0===r?(t.filter=void 0,void this._updateLayer(t)):void(this._validate(validateStyle.filter,"layers."+t.id+".filter",r)||(t.filter=util.clone(r),this._updateLayer(t)));this.fire("error",{error:new Error("The layer '"+e+"' does not exist in the map's style and cannot be filtered.")})},r.prototype.getFilter=function(e){return util.clone(this.getLayer(e).filter)},r.prototype.setLayoutProperty=function(e,r,t){this._checkLoaded();var a=this.getLayer(e);a?util.deepEqual(a.getLayoutProperty(r),t)||(a.setLayoutProperty(r,t),this._updateLayer(a)):this.fire("error",{error:new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")})},r.prototype.getLayoutProperty=function(e,r){return this.getLayer(e).getLayoutProperty(r)},r.prototype.setPaintProperty=function(e,r,t){this._checkLoaded();var a=this.getLayer(e);if(a){if(!util.deepEqual(a.getPaintProperty(r),t)){var i=a._transitionablePaint._values[r].value.isDataDriven();a.setPaintProperty(r,t),(a._transitionablePaint._values[r].value.isDataDriven()||i)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[e]=!0}}else this.fire("error",{error:new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")})},r.prototype.getPaintProperty=function(e,r){return this.getLayer(e).getPaintProperty(r)},r.prototype.getTransition=function(){return util.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},r.prototype.serialize=function(){var e=this;return util.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:util.mapObject(this.sourceCaches,function(e){return e.serialize()}),layers:this._order.map(function(r){return e._layers[r].serialize()})},function(e){return void 0!==e})},r.prototype._updateLayer=function(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._changed=!0},r.prototype._flattenRenderedFeatures=function(e){for(var t=[],a=this._order.length-1;a>=0;a--)for(var i=this._order[a],s=0,o=e;s<o.length;s+=1){var l=o[s][i];if(l)for(var h=0,u=l;h<u.length;h+=1){var d=u[h];t.push(d)}}return t},r.prototype.queryRenderedFeatures=function(e,r,t,a){var i=this;r&&r.filter&&this._validate(validateStyle.filter,"queryRenderedFeatures.filter",r.filter);var s={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire("error",{error:"parameters.layers must be an Array."}),[];for(var o=0,n=r.layers;o<n.length;o+=1){var l=n[o],h=i._layers[l];if(!h)return i.fire("error",{error:"The layer '"+l+"' does not exist in the map's style and cannot be queried for features."}),[];s[h.source]=!0}}var u=[];for(var d in i.sourceCaches)if(!r.layers||s[d]){var c=QueryFeatures.rendered(i.sourceCaches[d],i._layers,e,r,t,a,i.placement?i.placement.collisionIndex:null);u.push(c)}return this._flattenRenderedFeatures(u)},r.prototype.querySourceFeatures=function(e,r){r&&r.filter&&this._validate(validateStyle.filter,"querySourceFeatures.filter",r.filter);var t=this.sourceCaches[e];return t?QueryFeatures.source(t,r):[]},r.prototype.addSourceType=function(e,r,t){return getSourceType(e)?t(new Error('A source type called "'+e+'" already exists.')):(setSourceType(e,r),r.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:e,url:r.workerSourceURL},t):t(null,null))},r.prototype.getLight=function(){return this.light.getLight()},r.prototype.setLight=function(e){this._checkLoaded();var r=this.light.getLight(),t=!1;for(var a in e)if(!util.deepEqual(e[a],r[a])){t=!0;break}if(t){var i={now:browser.now(),transition:util.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e),this.light.updateTransitions(i)}},r.prototype._validate=function(e,r,t,a,i){return(!i||!1!==i.validate)&&validateStyle.emitErrors(this,e.call(validateStyle,util.extend({key:r,style:this.serialize(),value:t,styleSpec:styleSpec},a)))},r.prototype._remove=function(){for(var r in rtlTextPlugin.evented.off("pluginAvailable",this._rtlTextPluginCallback),this.sourceCaches)this.sourceCaches[r].clearTiles();this.dispatcher.remove()},r.prototype._clearSource=function(e){this.sourceCaches[e].clearTiles()},r.prototype._reloadSource=function(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()},r.prototype._updateSources=function(e){for(var t in this.sourceCaches)this.sourceCaches[t].update(e)},r.prototype._generateCollisionBoxes=function(){for(var r in this.sourceCaches)this._reloadSource(r)},r.prototype._updatePlacement=function(e,r,t){for(var a=this,i=!1,s=!1,o={},n=0,l=a._order;n<l.length;n+=1){var h=l[n],u=a._layers[h];if("symbol"===u.type){if(!o[u.source]){var d=a.sourceCaches[u.source];o[u.source]=d.getRenderableIds().map(function(e){return d.getTileByID(e)}).sort(function(e,r){return r.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(r.tileID)?-1:1)})}var c=a.crossTileSymbolIndex.addLayer(u,o[u.source]);i=i||c}}this.crossTileSymbolIndex.pruneUnusedLayers(this._order);var y=this._layerOrderChanged;if((y||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(browser.now()))&&(this.pauseablePlacement=new PauseablePlacement(e,this._order,y,r,t),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,o),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(this.placement,browser.now()),s=!0),i&&this.pauseablePlacement.placement.setStale()),s||i)for(var p=0,f=a._order;p<f.length;p+=1){var v=f[p],g=a._layers[v];"symbol"===g.type&&a.placement.updateLayerOpacities(g,o[g.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(browser.now())},r.prototype.getImages=function(e,r,t){this.imageManager.getImages(r.icons,t)},r.prototype.getGlyphs=function(e,r,t){this.glyphManager.getGlyphs(r.stacks,t)},r}(Evented);module.exports=Style},{"../render/glyph_manager":86,"../render/image_manager":88,"../render/line_atlas":89,"../source/geojson_source":99,"../source/query_features":105,"../source/rtl_text_plugin":109,"../source/source":110,"../source/source_cache":111,"../style-spec/deref":120,"../style-spec/diff":121,"../style-spec/reference/latest":151,"../symbol/cross_tile_symbol_index":218,"../util/ajax":251,"../util/browser":252,"../util/dispatcher":258,"../util/evented":260,"../util/global_worker_pool":262,"../util/mapbox":267,"../util/util":275,"./light":183,"./load_sprite":185,"./pauseable_placement":187,"./style_layer":191,"./validate_style":211,"./zoom_history":212}],191:[function(_dereq_,module,exports){var util=_dereq_("../util/util"),styleSpec=_dereq_("../style-spec/reference/latest"),validateStyle=_dereq_("./validate_style"),Evented=_dereq_("../util/evented"),ref=_dereq_("./properties"),Layout=ref.Layout,Transitionable=ref.Transitionable,StyleLayer=(ref.Transitioning,ref.Properties,function(t){function e(e,i){for(var r in t.call(this),this.id=e.id,this.metadata=e.metadata,this.type=e.type,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,this.visibility="visible","background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),this._featureFilter=function(){return!0},i.layout&&(this._unevaluatedLayout=new Layout(i.layout)),this._transitionablePaint=new Transitionable(i.paint),e.paint)this.setPaintProperty(r,e.paint[r],{validate:!1});for(var s in e.layout)this.setLayoutProperty(s,e.layout[s],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getLayoutProperty=function(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)},e.prototype.setLayoutProperty=function(t,e,i){if(null!==e&&void 0!==e){var a="layers."+this.id+".layout."+t;if(this._validate(validateStyle.layoutProperty,a,t,e,i))return}"visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility="none"===e?e:"visible"},e.prototype.getPaintProperty=function(t){return util.endsWith(t,"-transition")?this._transitionablePaint.getTransition(t.slice(0,-"-transition".length)):this._transitionablePaint.getValue(t)},e.prototype.setPaintProperty=function(t,e,i){if(null!==e&&void 0!==e){var a="layers."+this.id+".paint."+t;if(this._validate(validateStyle.paintProperty,a,t,e,i))return}util.endsWith(t,"-transition")?this._transitionablePaint.setTransition(t.slice(0,-"-transition".length),e||void 0):this._transitionablePaint.setValue(t,e)},e.prototype.isHidden=function(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility},e.prototype.updateTransitions=function(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)},e.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},e.prototype.recalculate=function(t){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t)),this.paint=this._transitioningPaint.possiblyEvaluate(t)},e.prototype.serialize=function(){var t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return"none"===this.visibility&&(t.layout=t.layout||{},t.layout.visibility="none"),util.filterObject(t,function(t,e){return!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)})},e.prototype._validate=function(t,e,i,a,r){return(!r||!1!==r.validate)&&validateStyle.emitErrors(this,t.call(validateStyle,{key:e,layerType:this.type,objectKey:i,value:a,styleSpec:styleSpec,style:{glyphs:!0,sprite:!0}}))},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e}(Evented));module.exports=StyleLayer;var subclasses={circle:_dereq_("./style_layer/circle_style_layer"),heatmap:_dereq_("./style_layer/heatmap_style_layer"),hillshade:_dereq_("./style_layer/hillshade_style_layer"),fill:_dereq_("./style_layer/fill_style_layer"),"fill-extrusion":_dereq_("./style_layer/fill_extrusion_style_layer"),line:_dereq_("./style_layer/line_style_layer"),symbol:_dereq_("./style_layer/symbol_style_layer"),background:_dereq_("./style_layer/background_style_layer"),raster:_dereq_("./style_layer/raster_style_layer")};StyleLayer.create=function(t){return new subclasses[t.type](t)}},{"../style-spec/reference/latest":151,"../util/evented":260,"../util/util":275,"./properties":188,"./style_layer/background_style_layer":192,"./style_layer/circle_style_layer":194,"./style_layer/fill_extrusion_style_layer":196,"./style_layer/fill_style_layer":198,"./style_layer/heatmap_style_layer":200,"./style_layer/hillshade_style_layer":202,"./style_layer/line_style_layer":204,"./style_layer/raster_style_layer":206,"./style_layer/symbol_style_layer":208,"./validate_style":211}],192:[function(_dereq_,module,exports){var StyleLayer=_dereq_("../style_layer"),properties=_dereq_("./background_style_layer_properties"),ref=_dereq_("../properties"),BackgroundStyleLayer=(ref.Transitionable,ref.Transitioning,ref.PossiblyEvaluated,function(e){function r(r){e.call(this,r,properties)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r}(StyleLayer));module.exports=BackgroundStyleLayer},{"../properties":188,"../style_layer":191,"./background_style_layer_properties":193}],193:[function(_dereq_,module,exports){var styleSpec=_dereq_("../../style-spec/reference/latest"),ref=_dereq_("../properties"),Properties=ref.Properties,DataConstantProperty=ref.DataConstantProperty,CrossFadedProperty=(ref.DataDrivenProperty,ref.CrossFadedProperty),paint=(ref.HeatmapColorProperty,new Properties({"background-color":new DataConstantProperty(styleSpec.paint_background["background-color"]),"background-pattern":new CrossFadedProperty(styleSpec.paint_background["background-pattern"]),"background-opacity":new DataConstantProperty(styleSpec.paint_background["background-opacity"])}));module.exports={paint:paint}},{"../../style-spec/reference/latest":151,"../properties":188}],194:[function(_dereq_,module,exports){var StyleLayer=_dereq_("../style_layer"),CircleBucket=_dereq_("../../data/bucket/circle_bucket"),multiPolygonIntersectsBufferedMultiPoint=_dereq_("../../util/intersection_tests").multiPolygonIntersectsBufferedMultiPoint,ref$1=_dereq_("../query_utils"),getMaximumPaintValue=ref$1.getMaximumPaintValue,translateDistance=ref$1.translateDistance,translate=ref$1.translate,properties=_dereq_("./circle_style_layer_properties"),ref$2=_dereq_("../properties"),CircleStyleLayer=(ref$2.Transitionable,ref$2.Transitioning,ref$2.PossiblyEvaluated,function(e){function t(t){e.call(this,t,properties)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.createBucket=function(e){return new CircleBucket(e)},t.prototype.queryRadius=function(e){var t=e;return getMaximumPaintValue("circle-radius",this,t)+getMaximumPaintValue("circle-stroke-width",this,t)+translateDistance(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(e,t,r,i,a,n){var l=translate(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),a,n),s=this.paint.get("circle-radius").evaluate(t)*n,u=this.paint.get("circle-stroke-width").evaluate(t)*n;return multiPolygonIntersectsBufferedMultiPoint(l,r,s+u)},t}(StyleLayer));module.exports=CircleStyleLayer},{"../../data/bucket/circle_bucket":42,"../../util/intersection_tests":264,"../properties":188,"../query_utils":189,"../style_layer":191,"./circle_style_layer_properties":195}],195:[function(_dereq_,module,exports){var styleSpec=_dereq_("../../style-spec/reference/latest"),ref=_dereq_("../properties"),Properties=ref.Properties,DataConstantProperty=ref.DataConstantProperty,DataDrivenProperty=ref.DataDrivenProperty,paint=(ref.CrossFadedProperty,ref.HeatmapColorProperty,new Properties({"circle-radius":new DataDrivenProperty(styleSpec.paint_circle["circle-radius"]),"circle-color":new DataDrivenProperty(styleSpec.paint_circle["circle-color"]),"circle-blur":new DataDrivenProperty(styleSpec.paint_circle["circle-blur"]),"circle-opacity":new DataDrivenProperty(styleSpec.paint_circle["circle-opacity"]),"circle-translate":new DataConstantProperty(styleSpec.paint_circle["circle-translate"]),"circle-translate-anchor":new DataConstantProperty(styleSpec.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new DataConstantProperty(styleSpec.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new DataConstantProperty(styleSpec.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new DataDrivenProperty(styleSpec.paint_circle["circle-stroke-width"]),"circle-stroke-color":new DataDrivenProperty(styleSpec.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new DataDrivenProperty(styleSpec.paint_circle["circle-stroke-opacity"])}));module.exports={paint:paint}},{"../../style-spec/reference/latest":151,"../properties":188}],196:[function(_dereq_,module,exports){var StyleLayer=_dereq_("../style_layer"),FillExtrusionBucket=_dereq_("../../data/bucket/fill_extrusion_bucket"),multiPolygonIntersectsMultiPolygon=_dereq_("../../util/intersection_tests").multiPolygonIntersectsMultiPolygon,ref$1=_dereq_("../query_utils"),translateDistance=ref$1.translateDistance,translate=ref$1.translate,properties=_dereq_("./fill_extrusion_style_layer_properties"),ref$2=_dereq_("../properties"),FillExtrusionStyleLayer=(ref$2.Transitionable,ref$2.Transitioning,ref$2.PossiblyEvaluated,function(t){function e(e){t.call(this,e,properties)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new FillExtrusionBucket(t)},e.prototype.queryRadius=function(){return translateDistance(this.paint.get("fill-extrusion-translate"))},e.prototype.queryIntersectsFeature=function(t,e,r,i,n,o){var s=translate(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),n,o);return multiPolygonIntersectsMultiPolygon(s,r)},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("fill-extrusion-opacity")&&"none"!==this.visibility},e.prototype.resize=function(){this.viewportFrame&&(this.viewportFrame.destroy(),this.viewportFrame=null)},e}(StyleLayer));module.exports=FillExtrusionStyleLayer},{"../../data/bucket/fill_extrusion_bucket":46,"../../util/intersection_tests":264,"../properties":188,"../query_utils":189,"../style_layer":191,"./fill_extrusion_style_layer_properties":197}],197:[function(_dereq_,module,exports){var styleSpec=_dereq_("../../style-spec/reference/latest"),ref=_dereq_("../properties"),Properties=ref.Properties,DataConstantProperty=ref.DataConstantProperty,DataDrivenProperty=ref.DataDrivenProperty,CrossFadedProperty=ref.CrossFadedProperty,paint=(ref.HeatmapColorProperty,new Properties({"fill-extrusion-opacity":new DataConstantProperty(styleSpec["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new DataDrivenProperty(styleSpec["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new DataConstantProperty(styleSpec["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new DataConstantProperty(styleSpec["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new CrossFadedProperty(styleSpec["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new DataDrivenProperty(styleSpec["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new DataDrivenProperty(styleSpec["paint_fill-extrusion"]["fill-extrusion-base"])}));module.exports={paint:paint}},{"../../style-spec/reference/latest":151,"../properties":188}],198:[function(_dereq_,module,exports){var StyleLayer=_dereq_("../style_layer"),FillBucket=_dereq_("../../data/bucket/fill_bucket"),multiPolygonIntersectsMultiPolygon=_dereq_("../../util/intersection_tests").multiPolygonIntersectsMultiPolygon,ref$1=_dereq_("../query_utils"),translateDistance=ref$1.translateDistance,translate=ref$1.translate,properties=_dereq_("./fill_style_layer_properties"),ref$2=_dereq_("../properties"),FillStyleLayer=(ref$2.Transitionable,ref$2.Transitioning,ref$2.PossiblyEvaluated,function(t){function e(e){t.call(this,e,properties)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.recalculate=function(t){this.paint=this._transitioningPaint.possiblyEvaluate(t),void 0===this._transitionablePaint.getValue("fill-outline-color")&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},e.prototype.createBucket=function(t){return new FillBucket(t)},e.prototype.queryRadius=function(){return translateDistance(this.paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(t,e,r,i,l,n){var a=translate(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),l,n);return multiPolygonIntersectsMultiPolygon(a,r)},e}(StyleLayer));module.exports=FillStyleLayer},{"../../data/bucket/fill_bucket":44,"../../util/intersection_tests":264,"../properties":188,"../query_utils":189,"../style_layer":191,"./fill_style_layer_properties":199}],199:[function(_dereq_,module,exports){var styleSpec=_dereq_("../../style-spec/reference/latest"),ref=_dereq_("../properties"),Properties=ref.Properties,DataConstantProperty=ref.DataConstantProperty,DataDrivenProperty=ref.DataDrivenProperty,CrossFadedProperty=ref.CrossFadedProperty,paint=(ref.HeatmapColorProperty,new Properties({"fill-antialias":new DataConstantProperty(styleSpec.paint_fill["fill-antialias"]),"fill-opacity":new DataDrivenProperty(styleSpec.paint_fill["fill-opacity"]),"fill-color":new DataDrivenProperty(styleSpec.paint_fill["fill-color"]),"fill-outline-color":new DataDrivenProperty(styleSpec.paint_fill["fill-outline-color"]),"fill-translate":new DataConstantProperty(styleSpec.paint_fill["fill-translate"]),"fill-translate-anchor":new DataConstantProperty(styleSpec.paint_fill["fill-translate-anchor"]),"fill-pattern":new CrossFadedProperty(styleSpec.paint_fill["fill-pattern"])}));module.exports={paint:paint}},{"../../style-spec/reference/latest":151,"../properties":188}],200:[function(_dereq_,module,exports){var StyleLayer=_dereq_("../style_layer"),HeatmapBucket=_dereq_("../../data/bucket/heatmap_bucket"),RGBAImage=_dereq_("../../util/image").RGBAImage,properties=_dereq_("./heatmap_style_layer_properties"),ref=_dereq_("../properties"),HeatmapStyleLayer=(ref.Transitionable,ref.Transitioning,ref.PossiblyEvaluated,function(t){function e(e){t.call(this,e,properties),this._updateColorRamp()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new HeatmapBucket(t)},e.prototype.setPaintProperty=function(e,r,a){t.prototype.setPaintProperty.call(this,e,r,a),"heatmap-color"===e&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){for(var t=this._transitionablePaint._values["heatmap-color"].value.expression,e=new Uint8Array(1024),r=e.length,a=4;a<r;a+=4){var o=t.evaluate({heatmapDensity:a/r});e[a+0]=Math.floor(255*o.r/o.a),e[a+1]=Math.floor(255*o.g/o.a),e[a+2]=Math.floor(255*o.b/o.a),e[a+3]=Math.floor(255*o.a)}this.colorRamp=new RGBAImage({width:256,height:1},e),this.colorRampTexture=null},e.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},e}(StyleLayer));module.exports=HeatmapStyleLayer},{"../../data/bucket/heatmap_bucket":47,"../../util/image":263,"../properties":188,"../style_layer":191,"./heatmap_style_layer_properties":201}],201:[function(_dereq_,module,exports){var styleSpec=_dereq_("../../style-spec/reference/latest"),ref=_dereq_("../properties"),Properties=ref.Properties,DataConstantProperty=ref.DataConstantProperty,DataDrivenProperty=ref.DataDrivenProperty,HeatmapColorProperty=(ref.CrossFadedProperty,ref.HeatmapColorProperty),paint=new Properties({"heatmap-radius":new DataDrivenProperty(styleSpec.paint_heatmap["heatmap-radius"]),"heatmap-weight":new DataDrivenProperty(styleSpec.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new DataConstantProperty(styleSpec.paint_heatmap["heatmap-intensity"]),"heatmap-color":new HeatmapColorProperty(styleSpec.paint_heatmap["heatmap-color"]),"heatmap-opacity":new DataConstantProperty(styleSpec.paint_heatmap["heatmap-opacity"])});module.exports={paint:paint}},{"../../style-spec/reference/latest":151,"../properties":188}],202:[function(_dereq_,module,exports){var StyleLayer=_dereq_("../style_layer"),properties=_dereq_("./hillshade_style_layer_properties"),ref=_dereq_("../properties"),HillshadeStyleLayer=(ref.Transitionable,ref.Transitioning,ref.PossiblyEvaluated,function(e){function r(r){e.call(this,r,properties)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},r}(StyleLayer));module.exports=HillshadeStyleLayer},{"../properties":188,"../style_layer":191,"./hillshade_style_layer_properties":203}],203:[function(_dereq_,module,exports){var styleSpec=_dereq_("../../style-spec/reference/latest"),ref=_dereq_("../properties"),Properties=ref.Properties,DataConstantProperty=ref.DataConstantProperty,paint=(ref.DataDrivenProperty,ref.CrossFadedProperty,ref.HeatmapColorProperty,new Properties({"hillshade-illumination-direction":new DataConstantProperty(styleSpec.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new DataConstantProperty(styleSpec.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new DataConstantProperty(styleSpec.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new DataConstantProperty(styleSpec.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new DataConstantProperty(styleSpec.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new DataConstantProperty(styleSpec.paint_hillshade["hillshade-accent-color"])}));module.exports={paint:paint}},{"../../style-spec/reference/latest":151,"../properties":188}],204:[function(_dereq_,module,exports){function getLineWidth(t,e){return e>0?e+2*t:t}var Point=_dereq_("@mapbox/point-geometry"),StyleLayer=_dereq_("../style_layer"),LineBucket=_dereq_("../../data/bucket/line_bucket"),multiPolygonIntersectsBufferedMultiLine=_dereq_("../../util/intersection_tests").multiPolygonIntersectsBufferedMultiLine,ref$1=_dereq_("../query_utils"),getMaximumPaintValue=ref$1.getMaximumPaintValue,translateDistance=ref$1.translateDistance,translate=ref$1.translate,properties=_dereq_("./line_style_layer_properties"),extend=_dereq_("../../util/util").extend,EvaluationParameters=_dereq_("../evaluation_parameters"),ref$3=_dereq_("../properties"),lineFloorwidthProperty=(ref$3.Transitionable,ref$3.Transitioning,ref$3.Layout,ref$3.PossiblyEvaluated,new(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.possiblyEvaluate=function(e,r){return r=new EvaluationParameters(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),t.prototype.possiblyEvaluate.call(this,e,r)},e.prototype.evaluate=function(e,r,i){return r=extend({},r,{zoom:Math.floor(r.zoom)}),t.prototype.evaluate.call(this,e,r,i)},e}(ref$3.DataDrivenProperty))(properties.paint.properties["line-width"].specification));lineFloorwidthProperty.useIntegerZoom=!0;var LineStyleLayer=function(t){function e(e){t.call(this,e,properties)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.recalculate=function(e){t.prototype.recalculate.call(this,e),this.paint._values["line-floorwidth"]=lineFloorwidthProperty.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)},e.prototype.createBucket=function(t){return new LineBucket(t)},e.prototype.queryRadius=function(t){var e=t,r=getLineWidth(getMaximumPaintValue("line-width",this,e),getMaximumPaintValue("line-gap-width",this,e)),i=getMaximumPaintValue("line-offset",this,e);return r/2+Math.abs(i)+translateDistance(this.paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(t,e,r,i,n,a){var o=translate(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),n,a),l=a/2*getLineWidth(this.paint.get("line-width").evaluate(e),this.paint.get("line-gap-width").evaluate(e)),u=this.paint.get("line-offset").evaluate(e);return u&&(r=function offsetLine(t,e){for(var r=[],i=new Point(0,0),n=0;n<t.length;n++){for(var a=t[n],o=[],l=0;l<a.length;l++){var u=a[l-1],s=a[l],p=a[l+1],y=0===l?i:s.sub(u)._unit()._perp(),f=l===a.length-1?i:p.sub(s)._unit()._perp(),c=y._add(f)._unit(),h=c.x*f.x+c.y*f.y;c._mult(1/h),o.push(c._mult(e)._add(s))}r.push(o)}return r}(r,u*a)),multiPolygonIntersectsBufferedMultiLine(o,r,l)},e}(StyleLayer);module.exports=LineStyleLayer},{"../../data/bucket/line_bucket":49,"../../util/intersection_tests":264,"../../util/util":275,"../evaluation_parameters":182,"../properties":188,"../query_utils":189,"../style_layer":191,"./line_style_layer_properties":205,"@mapbox/point-geometry":4}],205:[function(_dereq_,module,exports){var styleSpec=_dereq_("../../style-spec/reference/latest"),ref=_dereq_("../properties"),Properties=ref.Properties,DataConstantProperty=ref.DataConstantProperty,DataDrivenProperty=ref.DataDrivenProperty,CrossFadedProperty=ref.CrossFadedProperty,layout=(ref.HeatmapColorProperty,new Properties({"line-cap":new DataConstantProperty(styleSpec.layout_line["line-cap"]),"line-join":new DataDrivenProperty(styleSpec.layout_line["line-join"]),"line-miter-limit":new DataConstantProperty(styleSpec.layout_line["line-miter-limit"]),"line-round-limit":new DataConstantProperty(styleSpec.layout_line["line-round-limit"])})),paint=new Properties({"line-opacity":new DataDrivenProperty(styleSpec.paint_line["line-opacity"]),"line-color":new DataDrivenProperty(styleSpec.paint_line["line-color"]),"line-translate":new DataConstantProperty(styleSpec.paint_line["line-translate"]),"line-translate-anchor":new DataConstantProperty(styleSpec.paint_line["line-translate-anchor"]),"line-width":new DataDrivenProperty(styleSpec.paint_line["line-width"]),"line-gap-width":new DataDrivenProperty(styleSpec.paint_line["line-gap-width"]),"line-offset":new DataDrivenProperty(styleSpec.paint_line["line-offset"]),"line-blur":new DataDrivenProperty(styleSpec.paint_line["line-blur"]),"line-dasharray":new CrossFadedProperty(styleSpec.paint_line["line-dasharray"]),"line-pattern":new CrossFadedProperty(styleSpec.paint_line["line-pattern"])});module.exports={paint:paint,layout:layout}},{"../../style-spec/reference/latest":151,"../properties":188}],206:[function(_dereq_,module,exports){var StyleLayer=_dereq_("../style_layer"),properties=_dereq_("./raster_style_layer_properties"),ref=_dereq_("../properties"),RasterStyleLayer=(ref.Transitionable,ref.Transitioning,ref.PossiblyEvaluated,function(e){function r(r){e.call(this,r,properties)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r}(StyleLayer));module.exports=RasterStyleLayer},{"../properties":188,"../style_layer":191,"./raster_style_layer_properties":207}],207:[function(_dereq_,module,exports){var styleSpec=_dereq_("../../style-spec/reference/latest"),ref=_dereq_("../properties"),Properties=ref.Properties,DataConstantProperty=ref.DataConstantProperty,paint=(ref.DataDrivenProperty,ref.CrossFadedProperty,ref.HeatmapColorProperty,new Properties({"raster-opacity":new DataConstantProperty(styleSpec.paint_raster["raster-opacity"]),"raster-hue-rotate":new DataConstantProperty(styleSpec.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new DataConstantProperty(styleSpec.paint_raster["raster-brightness-min"]),"raster-brightness-max":new DataConstantProperty(styleSpec.paint_raster["raster-brightness-max"]),"raster-saturation":new DataConstantProperty(styleSpec.paint_raster["raster-saturation"]),"raster-contrast":new DataConstantProperty(styleSpec.paint_raster["raster-contrast"]),"raster-fade-duration":new DataConstantProperty(styleSpec.paint_raster["raster-fade-duration"])}));module.exports={paint:paint}},{"../../style-spec/reference/latest":151,"../properties":188}],208:[function(_dereq_,module,exports){var StyleLayer=_dereq_("../style_layer"),SymbolBucket=_dereq_("../../data/bucket/symbol_bucket"),resolveTokens=_dereq_("../../util/token"),isExpression=_dereq_("../../style-spec/expression").isExpression,properties=_dereq_("./symbol_style_layer_properties"),ref$1=_dereq_("../properties"),SymbolStyleLayer=(ref$1.Transitionable,ref$1.Transitioning,ref$1.Layout,ref$1.PossiblyEvaluated,function(t){function e(e){t.call(this,e,properties)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.recalculate=function(e){t.prototype.recalculate.call(this,e),"auto"===this.layout.get("icon-rotation-alignment")&&("line"===this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("line"===this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"))},e.prototype.getValueAndResolveTokens=function(t,e){var o=this.layout.get(t).evaluate(e),i=this._unevaluatedLayout._values[t];return i.isDataDriven()||isExpression(i.value)?o:resolveTokens(e.properties,o)},e.prototype.createBucket=function(t){return new SymbolBucket(t)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e}(StyleLayer));module.exports=SymbolStyleLayer},{"../../data/bucket/symbol_bucket":51,"../../style-spec/expression":139,"../../util/token":274,"../properties":188,"../style_layer":191,"./symbol_style_layer_properties":209}],209:[function(_dereq_,module,exports){var styleSpec=_dereq_("../../style-spec/reference/latest"),ref=_dereq_("../properties"),Properties=ref.Properties,DataConstantProperty=ref.DataConstantProperty,DataDrivenProperty=ref.DataDrivenProperty,layout=(ref.CrossFadedProperty,ref.HeatmapColorProperty,new Properties({"symbol-placement":new DataConstantProperty(styleSpec.layout_symbol["symbol-placement"]),"symbol-spacing":new DataConstantProperty(styleSpec.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new DataConstantProperty(styleSpec.layout_symbol["symbol-avoid-edges"]),"icon-allow-overlap":new DataConstantProperty(styleSpec.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new DataConstantProperty(styleSpec.layout_symbol["icon-ignore-placement"]),"icon-optional":new DataConstantProperty(styleSpec.layout_symbol["icon-optional"]),"icon-rotation-alignment":new DataConstantProperty(styleSpec.layout_symbol["icon-rotation-alignment"]),"icon-size":new DataDrivenProperty(styleSpec.layout_symbol["icon-size"]),"icon-text-fit":new DataConstantProperty(styleSpec.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new DataConstantProperty(styleSpec.layout_symbol["icon-text-fit-padding"]),"icon-image":new DataDrivenProperty(styleSpec.layout_symbol["icon-image"]),"icon-rotate":new DataDrivenProperty(styleSpec.layout_symbol["icon-rotate"]),"icon-padding":new DataConstantProperty(styleSpec.layout_symbol["icon-padding"]),"icon-keep-upright":new DataConstantProperty(styleSpec.layout_symbol["icon-keep-upright"]),"icon-offset":new DataDrivenProperty(styleSpec.layout_symbol["icon-offset"]),"icon-anchor":new DataDrivenProperty(styleSpec.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new DataConstantProperty(styleSpec.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new DataConstantProperty(styleSpec.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new DataConstantProperty(styleSpec.layout_symbol["text-rotation-alignment"]),"text-field":new DataDrivenProperty(styleSpec.layout_symbol["text-field"]),"text-font":new DataDrivenProperty(styleSpec.layout_symbol["text-font"]),"text-size":new DataDrivenProperty(styleSpec.layout_symbol["text-size"]),"text-max-width":new DataDrivenProperty(styleSpec.layout_symbol["text-max-width"]),"text-line-height":new DataConstantProperty(styleSpec.layout_symbol["text-line-height"]),"text-letter-spacing":new DataDrivenProperty(styleSpec.layout_symbol["text-letter-spacing"]),"text-justify":new DataDrivenProperty(styleSpec.layout_symbol["text-justify"]),"text-anchor":new DataDrivenProperty(styleSpec.layout_symbol["text-anchor"]),"text-max-angle":new DataConstantProperty(styleSpec.layout_symbol["text-max-angle"]),"text-rotate":new DataDrivenProperty(styleSpec.layout_symbol["text-rotate"]),"text-padding":new DataConstantProperty(styleSpec.layout_symbol["text-padding"]),"text-keep-upright":new DataConstantProperty(styleSpec.layout_symbol["text-keep-upright"]),"text-transform":new DataDrivenProperty(styleSpec.layout_symbol["text-transform"]),"text-offset":new DataDrivenProperty(styleSpec.layout_symbol["text-offset"]),"text-allow-overlap":new DataConstantProperty(styleSpec.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new DataConstantProperty(styleSpec.layout_symbol["text-ignore-placement"]),"text-optional":new DataConstantProperty(styleSpec.layout_symbol["text-optional"])})),paint=new Properties({"icon-opacity":new DataDrivenProperty(styleSpec.paint_symbol["icon-opacity"]),"icon-color":new DataDrivenProperty(styleSpec.paint_symbol["icon-color"]),"icon-halo-color":new DataDrivenProperty(styleSpec.paint_symbol["icon-halo-color"]),"icon-halo-width":new DataDrivenProperty(styleSpec.paint_symbol["icon-halo-width"]),"icon-halo-blur":new DataDrivenProperty(styleSpec.paint_symbol["icon-halo-blur"]),"icon-translate":new DataConstantProperty(styleSpec.paint_symbol["icon-translate"]),"icon-translate-anchor":new DataConstantProperty(styleSpec.paint_symbol["icon-translate-anchor"]),"text-opacity":new DataDrivenProperty(styleSpec.paint_symbol["text-opacity"]),"text-color":new DataDrivenProperty(styleSpec.paint_symbol["text-color"]),"text-halo-color":new DataDrivenProperty(styleSpec.paint_symbol["text-halo-color"]),"text-halo-width":new DataDrivenProperty(styleSpec.paint_symbol["text-halo-width"]),"text-halo-blur":new DataDrivenProperty(styleSpec.paint_symbol["text-halo-blur"]),"text-translate":new DataConstantProperty(styleSpec.paint_symbol["text-translate"]),"text-translate-anchor":new DataConstantProperty(styleSpec.paint_symbol["text-translate-anchor"])});module.exports={paint:paint,layout:layout}},{"../../style-spec/reference/latest":151,"../properties":188}],210:[function(_dereq_,module,exports){var StyleLayer=_dereq_("./style_layer"),util=_dereq_("../util/util"),featureFilter=_dereq_("../style-spec/feature_filter"),groupByLayout=_dereq_("../style-spec/group_by_layout"),StyleLayerIndex=function(e){e&&this.replace(e)};StyleLayerIndex.prototype.replace=function(e){this._layerConfigs={},this._layers={},this.update(e,[])},StyleLayerIndex.prototype.update=function(e,r){for(var t=this,a=0,i=e;a<i.length;a+=1){var l=i[a];t._layerConfigs[l.id]=l;var y=t._layers[l.id]=StyleLayer.create(l);y._featureFilter=featureFilter(y.filter)}for(var u=0,s=r;u<s.length;u+=1){var o=s[u];delete t._layerConfigs[o],delete t._layers[o]}this.familiesBySource={};for(var f=0,p=groupByLayout(util.values(this._layerConfigs));f<p.length;f+=1){var _=p[f].map(function(e){return t._layers[e.id]}),d=_[0];if("none"!==d.visibility){var v=d.source||"",g=t.familiesBySource[v];g||(g=t.familiesBySource[v]={});var h=d.sourceLayer||"_geojsonTileLayer",L=g[h];L||(L=g[h]=[]),L.push(_)}}},module.exports=StyleLayerIndex},{"../style-spec/feature_filter":148,"../style-spec/group_by_layout":150,"../util/util":275,"./style_layer":191}],211:[function(_dereq_,module,exports){module.exports=_dereq_("../style-spec/validate_style.min"),module.exports.emitErrors=function(r,e){if(e&&e.length){for(var t=0,o=e;t<o.length;t+=1){var i=o[t].message;r.fire("error",{error:new Error(i)})}return!0}return!1}},{"../style-spec/validate_style.min":181}],212:[function(_dereq_,module,exports){var ZoomHistory=function(){this.first=!0};ZoomHistory.prototype.update=function(o,t){var s=Math.floor(o);return this.first?(this.first=!1,this.lastIntegerZoom=s,this.lastIntegerZoomTime=0,this.lastZoom=o,this.lastFloorZoom=s,!0):(this.lastFloorZoom>s?(this.lastIntegerZoom=s+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<s&&(this.lastIntegerZoom=s,this.lastIntegerZoomTime=t),o!==this.lastZoom&&(this.lastZoom=o,this.lastFloorZoom=s,!0))},module.exports=ZoomHistory},{}],213:[function(_dereq_,module,exports){var Point=_dereq_("@mapbox/point-geometry"),register=_dereq_("../util/web_worker_transfer").register,Anchor=function(t){function e(e,r,o,n){t.call(this,e,r),this.angle=o,void 0!==n&&(this.segment=n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(Point);register("Anchor",Anchor),module.exports=Anchor},{"../util/web_worker_transfer":278,"@mapbox/point-geometry":4}],214:[function(_dereq_,module,exports){module.exports=function checkMaxAngle(e,t,a,r,n){if(void 0===t.segment)return!0;for(var i=t,s=t.segment+1,f=0;f>-a/2;){if(--s<0)return!1;f-=e[s].dist(i),i=e[s]}f+=e[s].dist(e[s+1]),s++;for(var l=[],o=0;f<a/2;){var u=e[s-1],c=e[s],g=e[s+1];if(!g)return!1;var h=u.angleTo(c)-c.angleTo(g);for(h=Math.abs((h+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:f,angleDelta:h}),o+=h;f-l[0].distance>r;)o-=l.shift().angleDelta;if(o>n)return!1;s++,f+=c.dist(g)}return!0}},{}],215:[function(_dereq_,module,exports){var Point=_dereq_("@mapbox/point-geometry");module.exports=function clipLine(n,x,y,o,e){for(var r=[],t=0;t<n.length;t++)for(var i=n[t],u=void 0,d=0;d<i.length-1;d++){var P=i[d],w=i[d+1];P.x<x&&w.x<x||(P.x<x?P=new Point(x,P.y+(w.y-P.y)*((x-P.x)/(w.x-P.x)))._round():w.x<x&&(w=new Point(x,P.y+(w.y-P.y)*((x-P.x)/(w.x-P.x)))._round()),P.y<y&&w.y<y||(P.y<y?P=new Point(P.x+(w.x-P.x)*((y-P.y)/(w.y-P.y)),y)._round():w.y<y&&(w=new Point(P.x+(w.x-P.x)*((y-P.y)/(w.y-P.y)),y)._round()),P.x>=o&&w.x>=o||(P.x>=o?P=new Point(o,P.y+(w.y-P.y)*((o-P.x)/(w.x-P.x)))._round():w.x>=o&&(w=new Point(o,P.y+(w.y-P.y)*((o-P.x)/(w.x-P.x)))._round()),P.y>=e&&w.y>=e||(P.y>=e?P=new Point(P.x+(w.x-P.x)*((e-P.y)/(w.y-P.y)),e)._round():w.y>=e&&(w=new Point(P.x+(w.x-P.x)*((e-P.y)/(w.y-P.y)),e)._round()),u&&P.equals(u[u.length-1])||(u=[P],r.push(u)),u.push(w)))))}return r}},{"@mapbox/point-geometry":4}],216:[function(_dereq_,module,exports){var CollisionFeature=function(t,e,i,o,a,r,l,n,s,d,h){var u=l.top*n-s,f=l.bottom*n+s,c=l.left*n-s,x=l.right*n+s;if(this.boxStartIndex=t.length,d){var m=f-u,v=x-c;m>0&&(m=Math.max(10*n,m),this._addLineCollisionCircles(t,e,i,i.segment,v,m,o,a,r,h))}else t.emplaceBack(i.x,i.y,c,u,x,f,o,a,r,0,0);this.boxEndIndex=t.length};CollisionFeature.prototype._addLineCollisionCircles=function(t,e,i,o,a,r,l,n,s,d){var h=r/2,u=Math.floor(a/h),f=1+.4*Math.log(d)/Math.LN2,c=Math.floor(u*f/2),x=-r/2,m=i,v=o+1,C=x,b=-a/2,g=b-a/4;do{if(--v<0){if(C>b)return;v=0;break}C-=e[v].dist(m),m=e[v]}while(C>g);for(var p=e[v].dist(e[v+1]),M=-c;M<u+c;M++){var _=M*h,k=b+_;if(_<0&&(k+=_),_>a&&(k+=_-a),!(k<C)){for(;C+p<k;){if(C+=p,++v+1>=e.length)return;p=e[v].dist(e[v+1])}var y=k-C,F=e[v],B=e[v+1].sub(F)._unit()._mult(y)._add(F)._round(),I=Math.abs(k-x)<h?0:.8*(k-x);t.emplaceBack(B.x,B.y,-r/2,-r/2,r/2,r/2,l,n,s,r/2,I)}}},module.exports=CollisionFeature},{}],217:[function(_dereq_,module,exports){function markCollisionCircleUsed(t,i,e){t[i+4]=e?1:0}var Point=_dereq_("@mapbox/point-geometry"),intersectionTests=_dereq_("../util/intersection_tests"),Grid=_dereq_("./grid_index"),projection=(_dereq_("@mapbox/gl-matrix").mat4,_dereq_("../symbol/projection")),CollisionIndex=function(t,i,e){void 0===i&&(i=new Grid(t.width+200,t.height+200,25)),void 0===e&&(e=new Grid(t.width+200,t.height+200,25)),this.transform=t,this.grid=i,this.ignoredGrid=e,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+100,this.screenBottomBoundary=t.height+100};CollisionIndex.prototype.placeCollisionBox=function(t,i,e,n){var r=this.projectAndGetPerspectiveRatio(n,t.anchorPointX,t.anchorPointY),o=e*r.perspectiveRatio,s=t.x1*o+r.point.x,a=t.y1*o+r.point.y,c=t.x2*o+r.point.x,p=t.y2*o+r.point.y;return!i&&this.grid.hitTest(s,a,c,p)?{box:[],offscreen:!1}:{box:[s,a,c,p],offscreen:this.isOffscreen(s,a,c,p)}},CollisionIndex.prototype.approximateTileDistance=function(t,i,e,n,r){var o=r?1:n/this.pitchfactor,s=t.lastSegmentViewportDistance*e;return t.prevTileDistance+s+(o-1)*s*Math.abs(Math.sin(i))},CollisionIndex.prototype.placeCollisionCircles=function(t,i,e,n,r,o,s,a,c,p,d,l,h){var f=this,x=[],g=this.projectAnchor(p,o.anchorX,o.anchorY),v=c/24,y=o.lineOffsetX*c,m=o.lineOffsetY*c,I=new Point(o.anchorX,o.anchorY),P=projection.project(I,d).point,C=projection.placeFirstAndLastGlyph(v,a,y,m,!1,P,I,o,s,d,{},!0),w=!1,D=!0,b=g.perspectiveRatio*n,j=1/(n*e),T=0,k=0;C&&(T=this.approximateTileDistance(C.first.tileDistance,C.first.angle,j,g.cameraDistance,h),k=this.approximateTileDistance(C.last.tileDistance,C.last.angle,j,g.cameraDistance,h));for(var G=0;G<t.length;G+=5){var M=t[G],R=t[G+1],q=t[G+2],B=t[G+3];if(!C||B<-T||B>k)markCollisionCircleUsed(t,G,!1);else{var A=f.projectPoint(p,M,R),O=q*b;if(x.length>0){var U=A.x-x[x.length-4],X=A.y-x[x.length-3];if(O*O*2>U*U+X*X&&G+8<t.length){var Y=t[G+8];if(Y>-T&&Y<k){markCollisionCircleUsed(t,G,!1);continue}}}var L=G/5;if(x.push(A.x,A.y,O,L),markCollisionCircleUsed(t,G,!0),D=D&&f.isOffscreen(A.x-O,A.y-O,A.x+O,A.y+O),!i&&f.grid.hitTestCircle(A.x,A.y,O)){if(!l)return{circles:[],offscreen:!1};w=!0}}}return{circles:w?[]:x,offscreen:D}},CollisionIndex.prototype.queryRenderedSymbols=function(t,i,e,n,r,o){var a={},c=[];if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return c;for(var p=this.transform.calculatePosMatrix(i.toUnwrapped()),d=[],l=1/0,h=1/0,f=-1/0,x=-1/0,g=0;g<t.length;g++)for(var u=t[g],v=0;v<u.length;v++){var y=this.projectPoint(p,u[v].x,u[v].y);l=Math.min(l,y.x),h=Math.min(h,y.y),f=Math.max(f,y.x),x=Math.max(x,y.y),d.push(y)}for(var m=i.key,I=[],P=this.grid.query(l,h,f,x),C=0;C<P.length;C++)P[C].sourceID===r&&P[C].tileID===m&&o[P[C].bucketInstanceId]&&I.push(P[C].boxIndex);for(var w=this.ignoredGrid.query(l,h,f,x),D=0;D<w.length;D++)w[D].sourceID===r&&w[D].tileID===m&&o[w[D].bucketInstanceId]&&I.push(w[D].boxIndex);for(var b=0;b<I.length;b++){var j=n.get(I[b]),T=j.sourceLayerIndex,k=j.featureIndex,G=j.bucketIndex;if(void 0===a[T]&&(a[T]={}),void 0===a[T][k]&&(a[T][k]={}),!a[T][k][G]){var M=this.projectAndGetPerspectiveRatio(p,j.anchorPointX,j.anchorPointY),R=e*M.perspectiveRatio,q=j.x1*R+M.point.x,B=j.y1*R+M.point.y,A=j.x2*R+M.point.x,O=j.y2*R+M.point.y,U=[new Point(q,B),new Point(A,B),new Point(A,O),new Point(q,O)];intersectionTests.polygonIntersectsPolygon(d,U)&&(a[T][k][G]=!0,c.push(I[b]))}}return c},CollisionIndex.prototype.insertCollisionBox=function(t,i,e,n,r,o){var a={tileID:e,sourceID:n,bucketInstanceId:r,boxIndex:o};(i?this.ignoredGrid:this.grid).insert(a,t[0],t[1],t[2],t[3])},CollisionIndex.prototype.insertCollisionCircles=function(t,i,e,n,r,o){for(var s=i?this.ignoredGrid:this.grid,a=0;a<t.length;a+=4){var c={tileID:e,sourceID:n,bucketInstanceId:r,boxIndex:o+t[a+3]};s.insertCircle(c,t[a],t[a+1],t[a+2])}},CollisionIndex.prototype.projectAnchor=function(t,i,e){var n=[i,e,0,1];return projection.xyTransformMat4(n,n,t),{perspectiveRatio:.5+this.transform.cameraToCenterDistance/n[3]*.5,cameraDistance:n[3]}},CollisionIndex.prototype.projectPoint=function(t,i,e){var n=[i,e,0,1];return projection.xyTransformMat4(n,n,t),new Point((n[0]/n[3]+1)/2*this.transform.width+100,(-n[1]/n[3]+1)/2*this.transform.height+100)},CollisionIndex.prototype.projectAndGetPerspectiveRatio=function(t,i,e){var n=[i,e,0,1];return projection.xyTransformMat4(n,n,t),{point:new Point((n[0]/n[3]+1)/2*this.transform.width+100,(-n[1]/n[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/n[3]*.5}},CollisionIndex.prototype.isOffscreen=function(t,i,e,n){return e<100||t>=this.screenRightBoundary||n<100||i>this.screenBottomBoundary},module.exports=CollisionIndex},{"../symbol/projection":224,"../util/intersection_tests":264,"./grid_index":220,"@mapbox/gl-matrix":2,"@mapbox/point-geometry":4}],218:[function(_dereq_,module,exports){var EXTENT=_dereq_("../data/extent"),roundingFactor=512/EXTENT/2,TileLayerIndex=function(e,s,r){var n=this;this.tileID=e,this.indexedSymbolInstances={},this.bucketInstanceId=r;for(var o=0,t=s;o<t.length;o+=1){var i=t[o],a=i.key;n.indexedSymbolInstances[a]||(n.indexedSymbolInstances[a]=[]),n.indexedSymbolInstances[a].push({crossTileID:i.crossTileID,coord:n.getScaledCoordinates(i,e)})}};TileLayerIndex.prototype.getScaledCoordinates=function(e,s){var r=s.canonical.z-this.tileID.canonical.z,n=roundingFactor/Math.pow(2,r),o=e.anchor;return{x:Math.floor((s.canonical.x*EXTENT+o.x)*n),y:Math.floor((s.canonical.y*EXTENT+o.y)*n)}},TileLayerIndex.prototype.findMatches=function(e,s,r){for(var o=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),t=0,i=e;t<i.length;t+=1){var a=i[t];if(!a.crossTileID){var l=this.indexedSymbolInstances[a.key];if(l)for(var c=this.getScaledCoordinates(a,s),d=0,I=l;d<I.length;d+=1){var y=I[d];if(Math.abs(y.coord.x-c.x)<=o&&Math.abs(y.coord.y-c.y)<=o&&!r[y.crossTileID]){r[y.crossTileID]=!0,a.crossTileID=y.crossTileID;break}}}}};var CrossTileIDs=function(){this.maxCrossTileID=0};CrossTileIDs.prototype.generate=function(){return++this.maxCrossTileID};var CrossTileSymbolLayerIndex=function(){this.indexes={},this.usedCrossTileIDs={}};CrossTileSymbolLayerIndex.prototype.addBucket=function(e,s,r){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(var o=0,t=s.symbolInstances;o<t.length;o+=1)t[o].crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});var i=this.usedCrossTileIDs[e.overscaledZ];for(var a in this.indexes){var l=this.indexes[a];if(Number(a)>e.overscaledZ)for(var c in l){var d=l[c];d.tileID.isChildOf(e)&&d.findMatches(s.symbolInstances,e,i)}else{var y=l[e.scaledTo(Number(a)).key];y&&y.findMatches(s.symbolInstances,e,i)}}for(var v=0,h=s.symbolInstances;v<h.length;v+=1){var u=h[v];u.crossTileID||(u.crossTileID=r.generate(),i[u.crossTileID]=!0)}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new TileLayerIndex(e,s.symbolInstances,s.bucketInstanceId),!0},CrossTileSymbolLayerIndex.prototype.removeBucketCrossTileIDs=function(e,s){for(var n in s.indexedSymbolInstances)for(var o=0,t=s.indexedSymbolInstances[n];o<t.length;o+=1){var i=t[o];delete this.usedCrossTileIDs[e][i.crossTileID]}},CrossTileSymbolLayerIndex.prototype.removeStaleBuckets=function(e){var s=this,r=!1;for(var n in s.indexes){var o=s.indexes[n];for(var t in o)e[o[t].bucketInstanceId]||(s.removeBucketCrossTileIDs(n,o[t]),delete o[t],r=!0)}return r};var CrossTileSymbolIndex=function(){this.layerIndexes={},this.crossTileIDs=new CrossTileIDs,this.maxBucketInstanceId=0};CrossTileSymbolIndex.prototype.addLayer=function(e,s){var n=this.layerIndexes[e.id];void 0===n&&(n=this.layerIndexes[e.id]=new CrossTileSymbolLayerIndex);for(var o=!1,t={},i=0,a=s;i<a.length;i+=1){var l=a[i],c=l.getBucket(e);c&&(c.bucketInstanceId||(c.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(l.tileID,c,this.crossTileIDs)&&(o=!0),t[c.bucketInstanceId]=!0)}return n.removeStaleBuckets(t)&&(o=!0),o},CrossTileSymbolIndex.prototype.pruneUnusedLayers=function(e){var r={};for(var n in e.forEach(function(e){r[e]=!0}),this.layerIndexes)r[n]||delete this.layerIndexes[n]},module.exports=CrossTileSymbolIndex},{"../data/extent":53}],219:[function(_dereq_,module,exports){var interpolate=_dereq_("../style-spec/util/interpolate").number,Anchor=_dereq_("../symbol/anchor"),checkMaxAngle=_dereq_("./check_max_angle");module.exports=function getAnchors(e,r,t,n,a,l,o,i,c){var h=n?.6*l*o:0,s=Math.max(n?n.right-n.left:0,a?a.right-a.left:0),u=0===e[0].x||e[0].x===c||0===e[0].y||e[0].y===c;return r-s*o<r/4&&(r=s*o+r/4),function resample(e,r,t,n,a,l,o,i,c){for(var h=l/2,s=0,u=0;u<e.length-1;u++)s+=e[u].dist(e[u+1]);for(var g=0,p=r-t,x=[],f=0;f<e.length-1;f++){for(var m=e[f],v=e[f+1],y=m.dist(v),A=v.angleTo(m);p+t<g+y;){var d=((p+=t)-g)/y,k=interpolate(m.x,v.x,d),q=interpolate(m.y,v.y,d);if(k>=0&&k<c&&q>=0&&q<c&&p-h>=0&&p+h<=s){var M=new Anchor(k,q,A,f);M._round(),n&&!checkMaxAngle(e,M,l,n,a)||x.push(M)}}g+=y}return i||x.length||o||(x=resample(e,g/2,t,n,a,l,o,!0,c)),x}(e,u?r/2*i%r:(s/2+2*l)*o*i%r,r,h,t,s*o,u,!1,c)}},{"../style-spec/util/interpolate":158,"../symbol/anchor":213,"./check_max_angle":214}],220:[function(_dereq_,module,exports){var GridIndex=function(e,t,i){var r=this.boxCells=[],s=this.circleCells=[];this.xCellCount=Math.ceil(e/i),this.yCellCount=Math.ceil(t/i);for(var l=0;l<this.xCellCount*this.yCellCount;l++)r.push([]),s.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0};GridIndex.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},GridIndex.prototype.insert=function(e,t,i,r,s){this._forEachCell(t,i,r,s,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(r),this.bboxes.push(s)},GridIndex.prototype.insertCircle=function(e,t,i,r){this._forEachCell(t-r,i-r,t+r,i+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(i),this.circles.push(r)},GridIndex.prototype._insertBoxCell=function(e,t,i,r,s,l){this.boxCells[s].push(l)},GridIndex.prototype._insertCircleCell=function(e,t,i,r,s,l){this.circleCells[s].push(l)},GridIndex.prototype._query=function(e,t,i,r,s){if(i<0||e>this.width||r<0||t>this.height)return!s&&[];var l=[];if(e<=0&&t<=0&&this.width<=i&&this.height<=r)l=Array.prototype.slice.call(this.boxKeys).concat(this.circleKeys);else{var o={hitTest:s,seenUids:{box:{},circle:{}}};this._forEachCell(e,t,i,r,this._queryCell,l,o)}return s?l.length>0:l},GridIndex.prototype._queryCircle=function(e,t,i,r){var s=e-i,l=e+i,o=t-i,h=t+i;if(l<0||s>this.width||h<0||o>this.height)return!r&&[];var n=[],c={hitTest:r,circle:{x:e,y:t,radius:i},seenUids:{box:{},circle:{}}};return this._forEachCell(s,o,l,h,this._queryCellCircle,n,c),r?n.length>0:n},GridIndex.prototype.query=function(e,t,i,r){return this._query(e,t,i,r,!1)},GridIndex.prototype.hitTest=function(e,t,i,r){return this._query(e,t,i,r,!0)},GridIndex.prototype.hitTestCircle=function(e,t,i){return this._queryCircle(e,t,i,!0)},GridIndex.prototype._queryCell=function(e,t,i,r,s,l,o){var h=this,n=o.seenUids,c=this.boxCells[s];if(null!==c)for(var u=this.bboxes,d=0,C=c;d<C.length;d+=1){var a=C[d];if(!n.box[a]){n.box[a]=!0;var x=4*a;if(e<=u[x+2]&&t<=u[x+3]&&i>=u[x+0]&&r>=u[x+1]){if(o.hitTest)return l.push(!0),!0;l.push(h.boxKeys[a])}}}var p=this.circleCells[s];if(null!==p)for(var f=this.circles,y=0,v=p;y<v.length;y+=1){var b=v[y];if(!n.circle[b]){n.circle[b]=!0;var _=3*b;if(h._circleAndRectCollide(f[_],f[_+1],f[_+2],e,t,i,r)){if(o.hitTest)return l.push(!0),!0;l.push(h.circleKeys[b])}}}},GridIndex.prototype._queryCellCircle=function(e,t,i,r,s,l,o){var n=o.circle,c=o.seenUids,u=this.boxCells[s];if(null!==u)for(var d=this.bboxes,C=0,a=u;C<a.length;C+=1){var x=a[C];if(!c.box[x]){c.box[x]=!0;var p=4*x;if(this._circleAndRectCollide(n.x,n.y,n.radius,d[p+0],d[p+1],d[p+2],d[p+3]))return l.push(!0),!0}}var f=this.circleCells[s];if(null!==f)for(var y=this.circles,v=0,b=f;v<b.length;v+=1){var _=b[v];if(!c.circle[_]){c.circle[_]=!0;var G=3*_;if(this._circlesCollide(y[G],y[G+1],y[G+2],n.x,n.y,n.radius))return l.push(!0),!0}}},GridIndex.prototype._forEachCell=function(e,t,i,r,s,l,o){for(var n=this._convertToXCellCoord(e),c=this._convertToYCellCoord(t),u=this._convertToXCellCoord(i),d=this._convertToYCellCoord(r),C=n;C<=u;C++)for(var a=c;a<=d;a++){var x=this.xCellCount*a+C;if(s.call(this,e,t,i,r,x,l,o))return}},GridIndex.prototype._convertToXCellCoord=function(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))},GridIndex.prototype._convertToYCellCoord=function(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))},GridIndex.prototype._circlesCollide=function(e,t,i,r,s,l){var o=r-e,h=s-t,n=i+l;return n*n>o*o+h*h},GridIndex.prototype._circleAndRectCollide=function(e,t,i,r,s,l,o){var h=(l-r)/2,n=Math.abs(e-(r+h));if(n>h+i)return!1;var c=(o-s)/2,u=Math.abs(t-(s+c));if(u>c+i)return!1;if(n<=h||u<=c)return!0;var d=n-h,C=u-c;return d*d+C*C<=i*i},module.exports=GridIndex},{}],221:[function(_dereq_,module,exports){module.exports=function(e){function t(t){g.push(e[t]),l++}function r(e,t,r){var n=u[e];return delete u[e],u[t]=n,g[n].geometry[0].pop(),g[n].geometry[0]=g[n].geometry[0].concat(r[0]),n}function n(e,t,r){var n=i[t];return delete i[t],i[e]=n,g[n].geometry[0].shift(),g[n].geometry[0]=r[0].concat(g[n].geometry[0]),n}function o(e,t,r){var n=r?t[0][t[0].length-1]:t[0][0];return e+":"+n.x+":"+n.y}for(var i={},u={},g=[],l=0,m=0;m<e.length;m++){var y=e[m],c=y.geometry,f=y.text;if(f){var a=o(f,c),s=o(f,c,!0);if(a in u&&s in i&&u[a]!==i[s]){var v=n(a,s,c),d=r(a,s,g[v].geometry);delete i[a],delete u[s],u[o(f,g[d].geometry,!0)]=d,g[v].geometry=null}else a in u?r(a,s,c):s in i?n(a,s,c):(t(m),i[a]=l-1,u[s]=l-1)}else t(m)}return g.filter(function(e){return e.geometry})}},{}],222:[function(_dereq_,module,exports){var register=_dereq_("../util/web_worker_transfer").register,OpacityState=function(){this.opacity=0,this.targetOpacity=0,this.time=0};OpacityState.prototype.clone=function(){var t=new OpacityState;return t.opacity=this.opacity,t.targetOpacity=this.targetOpacity,t.time=this.time,t},register("OpacityState",OpacityState),module.exports=OpacityState},{"../util/web_worker_transfer":278}],223:[function(_dereq_,module,exports){function updateCollisionVertices(e,t,i){e.emplaceBack(t?1:0,i?1:0),e.emplaceBack(t?1:0,i?1:0),e.emplaceBack(t?1:0,i?1:0),e.emplaceBack(t?1:0,i?1:0)}function packOpacity(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;var t=e.placed?1:0,i=Math.floor(127*e.opacity);return i*shift25+t*shift24+i*shift17+t*shift16+i*shift9+t*shift8+i*shift1+t}var CollisionIndex=_dereq_("./collision_index"),EXTENT=_dereq_("../data/extent"),symbolSize=_dereq_("./symbol_size"),projection=_dereq_("./projection"),symbolLayoutProperties=_dereq_("../style/style_layer/symbol_style_layer_properties").layout,pixelsToTileUnits=_dereq_("../source/pixels_to_tile_units"),OpacityState=function(e,t,i,o){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):o&&i?1:0,this.placed=i};OpacityState.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var JointOpacityState=function(e,t,i,o,a){this.text=new OpacityState(e?e.text:null,t,i,a),this.icon=new OpacityState(e?e.icon:null,t,o,a)};JointOpacityState.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var JointPlacement=function(e,t,i){this.text=e,this.icon=t,this.skipFade=i},Placement=function(e,t){this.transform=e.clone(),this.collisionIndex=new CollisionIndex(this.transform),this.placements={},this.opacities={},this.stale=!1,this.fadeDuration=t};Placement.prototype.placeLayerTile=function(e,t,i,o){var a=t.getBucket(e);if(a){var l=a.layers[0].layout,n=Math.pow(2,this.transform.zoom-t.tileID.overscaledZ),r=t.tileSize/EXTENT,s=this.transform.calculatePosMatrix(t.tileID.toUnwrapped()),c=projection.getLabelPlaneMatrix(s,"map"===l.get("text-pitch-alignment"),"map"===l.get("text-rotation-alignment"),this.transform,pixelsToTileUnits(t,1,this.transform.zoom)),p=projection.getLabelPlaneMatrix(s,"map"===l.get("icon-pitch-alignment"),"map"===l.get("icon-rotation-alignment"),this.transform,pixelsToTileUnits(t,1,this.transform.zoom));this.placeLayerBucket(a,s,c,p,n,r,i,o,t.collisionBoxArray,t.tileID.key,e.source)}},Placement.prototype.placeLayerBucket=function(e,t,i,o,a,l,n,r,s,c,p){for(var x=this,y=e.layers[0].layout,h=symbolSize.evaluateSizeForZoom(e.textSizeData,this.transform.zoom,symbolLayoutProperties.properties["text-size"]),m=!e.hasTextData()||y.get("text-optional"),d=!e.hasIconData()||y.get("icon-optional"),u=0,f=e.symbolInstances;u<f.length;u+=1){var B=f[u];if(!r[B.crossTileID]){var g=!1,I=!1,v=!0,C=null,D=null,T=null;B.collisionArrays||(B.collisionArrays=e.deserializeCollisionBoxes(s,B.textBoxStartIndex,B.textBoxEndIndex,B.iconBoxStartIndex,B.iconBoxEndIndex)),B.collisionArrays.textBox&&(g=(C=x.collisionIndex.placeCollisionBox(B.collisionArrays.textBox,y.get("text-allow-overlap"),l,t)).box.length>0,v=v&&C.offscreen);var V=B.collisionArrays.textCircles;if(V){var S=e.text.placedSymbolArray.get(B.placedTextSymbolIndices[0]),A=symbolSize.evaluateSizeForFeature(e.textSizeData,h,S);D=x.collisionIndex.placeCollisionCircles(V,y.get("text-allow-overlap"),a,l,B.key,S,e.lineVertexArray,e.glyphOffsetArray,A,t,i,n,"map"===y.get("text-pitch-alignment")),g=y.get("text-allow-overlap")||D.circles.length>0,v=v&&D.offscreen}B.collisionArrays.iconBox&&(I=(T=x.collisionIndex.placeCollisionBox(B.collisionArrays.iconBox,y.get("icon-allow-overlap"),l,t)).box.length>0,v=v&&T.offscreen),m||d?d?m||(I=I&&g):g=I&&g:I=g=I&&g,g&&C&&x.collisionIndex.insertCollisionBox(C.box,y.get("text-ignore-placement"),c,p,e.bucketInstanceId,B.textBoxStartIndex),I&&T&&x.collisionIndex.insertCollisionBox(T.box,y.get("icon-ignore-placement"),c,p,e.bucketInstanceId,B.iconBoxStartIndex),g&&D&&x.collisionIndex.insertCollisionCircles(D.circles,y.get("text-ignore-placement"),c,p,e.bucketInstanceId,B.textBoxStartIndex),x.placements[B.crossTileID]=new JointPlacement(g,I,v||e.justReloaded),r[B.crossTileID]=!0}}e.justReloaded=!1},Placement.prototype.commit=function(e,t){var i=this;this.commitTime=t;var o=!1,a=e&&0!==this.fadeDuration?(this.commitTime-e.commitTime)/this.fadeDuration:1,l=e?e.opacities:{};for(var n in i.placements){var r=i.placements[n],s=l[n];s?(i.opacities[n]=new JointOpacityState(s,a,r.text,r.icon),o=o||r.text!==s.text.placed||r.icon!==s.icon.placed):(i.opacities[n]=new JointOpacityState(null,a,r.text,r.icon,r.skipFade),o=o||r.text||r.icon)}for(var c in l){var p=l[c];if(!i.opacities[c]){var x=new JointOpacityState(p,a,!1,!1);x.isHidden()||(i.opacities[c]=x,o=o||p.text.placed||p.icon.placed)}}o?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)},Placement.prototype.updateLayerOpacities=function(e,t){for(var o={},a=0,l=t;a<l.length;a+=1){var n=l[a],r=n.getBucket(e);r&&this.updateBucketOpacities(r,o,n.collisionBoxArray)}},Placement.prototype.updateBucketOpacities=function(e,t,i){e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasCollisionBoxData()&&e.collisionBox.collisionVertexArray.clear(),e.hasCollisionCircleData()&&e.collisionCircle.collisionVertexArray.clear();for(var a=e.layers[0].layout,l=new JointOpacityState(null,0,a.get("text-allow-overlap"),a.get("icon-allow-overlap"),!0),n=0;n<e.symbolInstances.length;n++){var r=e.symbolInstances[n],s=t[r.crossTileID],c=this.opacities[r.crossTileID];c?s&&(c=l):(c=l,this.opacities[r.crossTileID]=c),t[r.crossTileID]=!0;var p=r.numGlyphVertices>0||r.numVerticalGlyphVertices>0,x=r.numIconVertices>0;if(p){for(var y=packOpacity(c.text),h=(r.numGlyphVertices+r.numVerticalGlyphVertices)/4,m=0;m<h;m++)e.text.opacityVertexArray.emplaceBack(y);for(var d=0,u=r.placedTextSymbolIndices;d<u.length;d+=1){var f=u[d];e.text.placedSymbolArray.get(f).hidden=c.text.isHidden()}}if(x){for(var B=packOpacity(c.icon),g=0;g<r.numIconVertices/4;g++)e.icon.opacityVertexArray.emplaceBack(B);e.icon.placedSymbolArray.get(n).hidden=c.icon.isHidden()}r.collisionArrays||(r.collisionArrays=e.deserializeCollisionBoxes(i,r.textBoxStartIndex,r.textBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex));var I=r.collisionArrays;if(I){I.textBox&&e.hasCollisionBoxData()&&updateCollisionVertices(e.collisionBox.collisionVertexArray,c.text.placed,!1),I.iconBox&&e.hasCollisionBoxData()&&updateCollisionVertices(e.collisionBox.collisionVertexArray,c.icon.placed,!1);var v=I.textCircles;if(v&&e.hasCollisionCircleData())for(var C=0;C<v.length;C+=5){var D=s||0===v[C+4];updateCollisionVertices(e.collisionCircle.collisionVertexArray,c.text.placed,D)}}}e.sortFeatures(this.transform.angle),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasCollisionBoxData()&&e.collisionBox.collisionVertexBuffer&&e.collisionBox.collisionVertexBuffer.updateData(e.collisionBox.collisionVertexArray),e.hasCollisionCircleData()&&e.collisionCircle.collisionVertexBuffer&&e.collisionCircle.collisionVertexBuffer.updateData(e.collisionCircle.collisionVertexArray)},Placement.prototype.symbolFadeChange=function(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration},Placement.prototype.hasTransitions=function(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration},Placement.prototype.stillRecent=function(e){return"undefined"!==this.commitTime&&this.commitTime+this.fadeDuration>e},Placement.prototype.setStale=function(){this.stale=!0};var shift25=Math.pow(2,25),shift24=Math.pow(2,24),shift17=Math.pow(2,17),shift16=Math.pow(2,16),shift9=Math.pow(2,9),shift8=Math.pow(2,8),shift1=Math.pow(2,1);module.exports=Placement},{"../data/extent":53,"../source/pixels_to_tile_units":104,"../style/style_layer/symbol_style_layer_properties":209,"./collision_index":217,"./projection":224,"./symbol_size":228}],224:[function(_dereq_,module,exports){function project(e,t){var r=[e.x,e.y,0,1];xyTransformMat4(r,r,t);var n=r[3];return{point:new Point(r[0]/n,r[1]/n),signedDistanceFromCamera:n}}function isVisible(e,t){var r=e[0]/e[3],n=e[1]/e[3];return r>=-t[0]&&r<=t[0]&&n>=-t[1]&&n<=t[1]}function placeFirstAndLastGlyph(e,t,r,n,a,i,o,l,s,p,u,y){var c=l.glyphStartIndex+l.numGlyphs,m=l.lineStartIndex,d=l.lineStartIndex+l.lineLength,g=t.getoffsetX(l.glyphStartIndex),h=t.getoffsetX(c-1),f=placeGlyphAlongLine(e*g,r,n,a,i,o,l.segment,m,d,s,p,u,y);if(!f)return null;var x=placeGlyphAlongLine(e*h,r,n,a,i,o,l.segment,m,d,s,p,u,y);return x?{first:f,last:x}:null}function requiresOrientationChange(e,t,r,n){return e===WritingMode.horizontal&&Math.abs(r.y-t.y)>Math.abs(r.x-t.x)*n?{useVertical:!0}:(e===WritingMode.vertical?t.y<r.y:t.x>r.x)?{needsFlipping:!0}:null}function placeGlyphsAlongLine(e,t,r,n,a,i,o,l,s,p,u,y,c,m){var d,g=t/24,h=e.lineOffsetX*t,f=e.lineOffsetY*t;if(e.numGlyphs>1){var x=e.glyphStartIndex+e.numGlyphs,v=e.lineStartIndex,b=e.lineStartIndex+e.lineLength,L=placeFirstAndLastGlyph(g,l,h,f,r,u,y,e,s,i,c,!1);if(!L)return{notEnoughRoom:!0};var A=project(L.first.point,o).point,G=project(L.last.point,o).point;if(n&&!r){var M=requiresOrientationChange(e.writingMode,A,G,m);if(M)return M}d=[L.first];for(var S=e.glyphStartIndex+1;S<x-1;S++)d.push(placeGlyphAlongLine(g*l.getoffsetX(S),h,f,r,u,y,e.segment,v,b,s,i,c,!1));d.push(L.last)}else{if(n&&!r){var w=project(y,a).point,F=e.lineStartIndex+e.segment+1,D=new Point(s.getx(F),s.gety(F)),I=project(D,a),j=I.signedDistanceFromCamera>0?I.point:projectTruncatedLineSegment(y,D,w,1,a),z=requiresOrientationChange(e.writingMode,w,j,m);if(z)return z}var P=placeGlyphAlongLine(g*l.getoffsetX(e.glyphStartIndex),h,f,r,u,y,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,s,i,c,!1);if(!P)return{notEnoughRoom:!0};d=[P]}for(var _=0,C=d;_<C.length;_+=1){var V=C[_];addDynamicAttributes(p,V.point,V.angle)}return{}}function projectTruncatedLineSegment(e,t,r,n,a){var i=project(e.add(e.sub(t)._unit()),a).point,o=r.sub(i);return r.add(o._mult(n/o.mag()))}function placeGlyphAlongLine(e,t,r,n,a,i,o,l,s,p,u,y,c){var m=n?e-t:e+t,d=m>0?1:-1,g=0;n&&(d*=-1,g=Math.PI),d<0&&(g+=Math.PI);for(var h=d>0?l+o:l+o+1,f=h,x=a,v=a,b=0,L=0,A=Math.abs(m);b+L<=A;){if((h+=d)<l||h>=s)return null;if(v=x,void 0===(x=y[h])){var G=new Point(p.getx(h),p.gety(h)),M=project(G,u);if(M.signedDistanceFromCamera>0)x=y[h]=M.point;else{var S=h-d;x=projectTruncatedLineSegment(0===b?i:new Point(p.getx(S),p.gety(S)),G,v,A-b+1,u)}}b+=L,L=v.dist(x)}var w=(A-b)/L,F=x.sub(v),D=F.mult(w)._add(v);return D._add(F._unit()._perp()._mult(r*d)),{point:D,angle:g+Math.atan2(x.y-v.y,x.x-v.x),tileDistance:c?{prevTileDistance:h-d===f?0:p.gettileUnitDistanceFromAnchor(h-d),lastSegmentViewportDistance:A-b}:null}}function hideGlyphs(e,t){for(var r=0;r<e;r++){var n=t.length;t.resize(n+4),t.float32.set(hiddenGlyphAttributes,3*n)}}function xyTransformMat4(e,t,r){var n=t[0],a=t[1];return e[0]=r[0]*n+r[4]*a+r[12],e[1]=r[1]*n+r[5]*a+r[13],e[3]=r[3]*n+r[7]*a+r[15],e}var Point=_dereq_("@mapbox/point-geometry"),ref=_dereq_("@mapbox/gl-matrix"),mat4=ref.mat4,vec4=ref.vec4,symbolSize=_dereq_("./symbol_size"),addDynamicAttributes=_dereq_("../data/bucket/symbol_bucket").addDynamicAttributes,symbolLayoutProperties=_dereq_("../style/style_layer/symbol_style_layer_properties").layout,WritingMode=_dereq_("../symbol/shaping").WritingMode;module.exports={updateLineLabels:function updateLineLabels(e,t,r,n,a,i,o,l){var s=n?e.textSizeData:e.iconSizeData,p=symbolSize.evaluateSizeForZoom(s,r.transform.zoom,symbolLayoutProperties.properties[n?"text-size":"icon-size"]),u=[256/r.width*2+1,256/r.height*2+1],y=n?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;y.clear();for(var c=e.lineVertexArray,m=n?e.text.placedSymbolArray:e.icon.placedSymbolArray,d=r.transform.width/r.transform.height,g=!1,h=0;h<m.length;h++){var f=m.get(h);if(f.hidden||f.writingMode===WritingMode.vertical&&!g)hideGlyphs(f.numGlyphs,y);else{g=!1;var x=[f.anchorX,f.anchorY,0,1];if(vec4.transformMat4(x,x,t),isVisible(x,u)){var b=.5+x[3]/r.transform.cameraToCenterDistance*.5,L=symbolSize.evaluateSizeForFeature(s,p,f),A=o?L*b:L/b,G=new Point(f.anchorX,f.anchorY),M=project(G,a).point,S={},w=placeGlyphsAlongLine(f,A,!1,l,t,a,i,e.glyphOffsetArray,c,y,M,G,S,d);g=w.useVertical,(w.notEnoughRoom||g||w.needsFlipping&&placeGlyphsAlongLine(f,A,!0,l,t,a,i,e.glyphOffsetArray,c,y,M,G,S,d).notEnoughRoom)&&hideGlyphs(f.numGlyphs,y)}else hideGlyphs(f.numGlyphs,y)}}n?e.text.dynamicLayoutVertexBuffer.updateData(y):e.icon.dynamicLayoutVertexBuffer.updateData(y)},getLabelPlaneMatrix:function getLabelPlaneMatrix(e,t,r,n,a){var i=mat4.identity(new Float32Array(16));return t?(mat4.identity(i),mat4.scale(i,i,[1/a,1/a,1]),r||mat4.rotateZ(i,i,n.angle)):(mat4.scale(i,i,[n.width/2,-n.height/2,1]),mat4.translate(i,i,[1,-1,0]),mat4.multiply(i,i,e)),i},getGlCoordMatrix:function getGlCoordMatrix(e,t,r,n,a){var i=mat4.identity(new Float32Array(16));return t?(mat4.multiply(i,i,e),mat4.scale(i,i,[a,a,1]),r||mat4.rotateZ(i,i,-n.angle)):(mat4.scale(i,i,[1,-1,1]),mat4.translate(i,i,[-1,-1,0]),mat4.scale(i,i,[2/n.width,2/n.height,1])),i},project:project,placeFirstAndLastGlyph:placeFirstAndLastGlyph,xyTransformMat4:xyTransformMat4};var hiddenGlyphAttributes=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0])},{"../data/bucket/symbol_bucket":51,"../style/style_layer/symbol_style_layer_properties":209,"../symbol/shaping":226,"./symbol_size":228,"@mapbox/gl-matrix":2,"@mapbox/point-geometry":4}],225:[function(_dereq_,module,exports){var Point=_dereq_("@mapbox/point-geometry"),GLYPH_PBF_BORDER=_dereq_("../style/parse_glyph_pbf").GLYPH_PBF_BORDER;module.exports={getIconQuads:function getIconQuads(t,e,i,o,n,a,r){var u,l,g,d,f=e.image,c=i.layout,h=e.top-1/f.pixelRatio,x=e.left-1/f.pixelRatio,p=e.bottom+1/f.pixelRatio,s=e.right+1/f.pixelRatio;if("none"!==c.get("icon-text-fit")&&n){var P=s-x,_=p-h,w=c.get("text-size").evaluate(r)/24,m=n.left*w,v=n.right*w,y=n.top*w,R=v-m,b=n.bottom*w-y,G=c.get("icon-text-fit-padding")[0],B=c.get("icon-text-fit-padding")[1],I=c.get("icon-text-fit-padding")[2],Q=c.get("icon-text-fit-padding")[3],O="width"===c.get("icon-text-fit")?.5*(b-_):0,A="height"===c.get("icon-text-fit")?.5*(R-P):0,D="width"===c.get("icon-text-fit")||"both"===c.get("icon-text-fit")?R:P,E="height"===c.get("icon-text-fit")||"both"===c.get("icon-text-fit")?b:_;u=new Point(m+A-Q,y+O-G),l=new Point(m+A+B+D,y+O-G),g=new Point(m+A+B+D,y+O+I+E),d=new Point(m+A-Q,y+O+I+E)}else u=new Point(x,h),l=new Point(s,h),g=new Point(s,p),d=new Point(x,p);var F=i.layout.get("icon-rotate").evaluate(r)*Math.PI/180;if(F){var H=Math.sin(F),L=Math.cos(F),Y=[L,-H,H,L];u._matMult(Y),l._matMult(Y),d._matMult(Y),g._matMult(Y)}return[{tl:u,tr:l,bl:d,br:g,tex:{x:f.textureRect.x-1,y:f.textureRect.y-1,w:f.textureRect.w+2,h:f.textureRect.h+2},writingMode:void 0,glyphOffset:[0,0]}]},getGlyphQuads:function getGlyphQuads(t,e,i,o,n,a,r){for(var u=i.layout.get("text-rotate").evaluate(a)*Math.PI/180,l=i.layout.get("text-offset").evaluate(a).map(function(t){return 24*t}),g=e.positionedGlyphs,d=[],f=0;f<g.length;f++){var c=g[f],h=r[c.glyph];if(h){var x=h.rect;if(x){var p=GLYPH_PBF_BORDER+1,s=h.metrics.advance/2,P=o?[c.x+s,c.y]:[0,0],_=o?[0,0]:[c.x+s+l[0],c.y+l[1]],w=h.metrics.left-p-s+_[0],m=-h.metrics.top-p+_[1],v=w+x.w,y=m+x.h,M=new Point(w,m),R=new Point(v,m),b=new Point(w,y),G=new Point(v,y);if(o&&c.vertical){var B=new Point(-s,s),I=-Math.PI/2,Q=new Point(5,0);M._rotateAround(I,B)._add(Q),R._rotateAround(I,B)._add(Q),b._rotateAround(I,B)._add(Q),G._rotateAround(I,B)._add(Q)}if(u){var O=Math.sin(u),A=Math.cos(u),D=[A,-O,O,A];M._matMult(D),R._matMult(D),b._matMult(D),G._matMult(D)}d.push({tl:M,tr:R,bl:b,br:G,tex:x,writingMode:e.writingMode,glyphOffset:P})}}}return d}}},{"../style/parse_glyph_pbf":186,"@mapbox/point-geometry":4}],226:[function(_dereq_,module,exports){function calculateBadness(e,t,a,r){var i=Math.pow(e-t,2);return r?e<t?i/2:2*i:i+Math.abs(a)*a}function calculatePenalty(e,t){var a=0;return 10===e&&(a-=1e4),40!==e&&65288!==e||(a+=50),41!==t&&65289!==t||(a+=50),a}function evaluateBreak(e,t,a,r,i,n){for(var l=null,o=calculateBadness(t,a,i,n),c=0,s=r;c<s.length;c+=1){var h=s[c],u=calculateBadness(t-h.x,a,i,n)+h.badness;u<=o&&(l=h,o=u)}return{index:e,x:t,priorBreak:l,badness:o}}function determineLineBreaks(e,t,a,r){if(!a)return[];if(!e)return[];for(var i=[],n=function determineAverageLineWidth(e,t,a,r){for(var i=0,n=0;n<e.length;n++){var l=r[e.charCodeAt(n)];l&&(i+=l.metrics.advance+t)}return i/Math.max(1,Math.ceil(i/a))}(e,t,a,r),l=0,o=0;o<e.length;o++){var c=e.charCodeAt(o),s=r[c];s&&!whitespace[c]&&(l+=s.metrics.advance+t),o<e.length-1&&(breakable[c]||scriptDetection.charAllowsIdeographicBreaking(c))&&i.push(evaluateBreak(o+1,l,n,i,calculatePenalty(c,e.charCodeAt(o+1)),!1))}return function leastBadBreaks(e){return e?leastBadBreaks(e.priorBreak).concat(e.index):[]}(evaluateBreak(e.length,l,n,i,0,!0))}function getAnchorAlignment(e){var t=.5,a=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:t,verticalAlign:a}}function justifyLine(e,t,a,r,i){if(i){var n=t[e[r].glyph];if(n)for(var l=n.metrics.advance,o=(e[r].x+l)*i,c=a;c<=r;c++)e[c].x-=o}}var scriptDetection=_dereq_("../util/script_detection"),verticalizePunctuation=_dereq_("../util/verticalize_punctuation"),rtlTextPlugin=_dereq_("../source/rtl_text_plugin"),WritingMode={horizontal:1,vertical:2,horizontalOnly:3};module.exports={shapeText:function shapeText(e,t,a,r,i,n,l,o,c,s){var h=e.trim();s===WritingMode.vertical&&(h=verticalizePunctuation(h));var u=[],p={positionedGlyphs:u,text:h,top:o[1],bottom:o[1],left:o[0],right:o[0],writingMode:s},b=rtlTextPlugin.processBidirectionalText;return function shapeLines(e,t,a,r,i,n,l,o,c){for(var s=0,h=-17,g=0,u=e.positionedGlyphs,p="right"===n?1:"left"===n?0:.5,b=0,v=a;b<v.length;b+=1){var d=v[b];if((d=d.trim()).length){for(var f=u.length,k=0;k<d.length;k++){var m=d.charCodeAt(k),x=t[m];x&&(scriptDetection.charHasUprightVerticalOrientation(m)&&l!==WritingMode.horizontal?(u.push({glyph:m,x:s,y:0,vertical:!0}),s+=c+o):(u.push({glyph:m,x:s,y:h,vertical:!1}),s+=x.metrics.advance+o))}if(u.length!==f){var A=s-o;g=Math.max(A,g),justifyLine(u,t,f,u.length-1,p)}s=0,h+=r}else h+=r}var B=getAnchorAlignment(i),y=B.horizontalAlign,w=B.verticalAlign;!function align(e,t,a,r,i,n,l){for(var o=(t-a)*i,c=(-r*l+.5)*n,s=0;s<e.length;s++)e[s].x+=o,e[s].y+=c}(u,p,y,w,g,r,a.length);var z=a.length*r;e.top+=-w*z,e.bottom=e.top+z,e.left+=-y*g,e.right=e.left+g}(p,t,b?b(h,determineLineBreaks(h,l,a,t)):function breakLines(e,t){for(var a=[],r=0,i=0,n=t;i<n.length;i+=1){var l=n[i];a.push(e.substring(r,l)),r=l}return r<e.length&&a.push(e.substring(r,e.length)),a}(h,determineLineBreaks(h,l,a,t)),r,i,n,s,l,c),!!u.length&&p},shapeIcon:function shapeIcon(e,t,a){var r=getAnchorAlignment(a),i=r.horizontalAlign,n=r.verticalAlign,l=t[0],o=t[1],c=l-e.displaySize[0]*i,s=c+e.displaySize[0],h=o-e.displaySize[1]*n;return{image:e,top:h,bottom:h+e.displaySize[1],left:c,right:s}},WritingMode:WritingMode};var whitespace={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},breakable={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0}},{"../source/rtl_text_plugin":109,"../util/script_detection":269,"../util/verticalize_punctuation":277}],227:[function(_dereq_,module,exports){function addFeature(e,t,a,i,o,n){var r=n.layoutTextSize.evaluate(t),l=n.layoutIconSize.evaluate(t),s=n.textMaxSize.evaluate(t);void 0===s&&(s=r);var c=e.layers[0].layout,u=c.get("text-offset").evaluate(t),x=c.get("icon-offset").evaluate(t),g=r/24,y=e.tilePixelRatio*g,p=e.tilePixelRatio*s/24,d=e.tilePixelRatio*l,m=e.tilePixelRatio*c.get("symbol-spacing"),v=c.get("text-padding")*e.tilePixelRatio,f=c.get("icon-padding")*e.tilePixelRatio,h=c.get("text-max-angle")/180*Math.PI,S="map"===c.get("text-rotation-alignment")&&"line"===c.get("symbol-placement"),z="map"===c.get("icon-rotation-alignment")&&"line"===c.get("symbol-placement"),T=m/2,I=function(r,l){l.x<0||l.x>=EXTENT||l.y<0||l.y>=EXTENT||e.symbolInstances.push(function addSymbol(e,t,a,i,o,n,r,l,s,c,u,x,g,y,p,d,m,v,f,h,S,z){var b,T,I=e.addToLineVertexArray(t,a),E=0,P=0,w=0,q=i.horizontal?i.horizontal.text:"",A=[];i.horizontal&&(b=new CollisionFeature(r,a,t,l,s,c,i.horizontal,u,x,g,e.overscaling),P+=addTextVertices(e,t,i.horizontal,n,g,f,h,y,I,i.vertical?WritingMode.horizontal:WritingMode.horizontalOnly,A,S,z),i.vertical&&(w+=addTextVertices(e,t,i.vertical,n,g,f,h,y,I,WritingMode.vertical,A,S,z)));var L=b?b.boxStartIndex:e.collisionBoxArray.length,D=b?b.boxEndIndex:e.collisionBoxArray.length;if(o){var O=getIconQuads(t,o,n,m,i.horizontal,f,h);T=new CollisionFeature(r,a,t,l,s,c,o,p,d,!1,e.overscaling),E=4*O.length;var _=e.iconSizeData,R=null;"source"===_.functionType?R=[10*n.layout.get("icon-size").evaluate(h)]:"composite"===_.functionType&&(R=[10*z.compositeIconSizes[0].evaluate(h),10*z.compositeIconSizes[1].evaluate(h)]),e.addSymbols(e.icon,O,R,v,m,h,!1,t,I.lineStartIndex,I.lineLength)}var B=T?T.boxStartIndex:e.collisionBoxArray.length,M=T?T.boxEndIndex:e.collisionBoxArray.length;return e.glyphOffsetArray.length>=SymbolBucket.MAX_GLYPHS&&util.warnOnce("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),{key:q,textBoxStartIndex:L,textBoxEndIndex:D,iconBoxStartIndex:B,iconBoxEndIndex:M,textOffset:y,iconOffset:v,anchor:t,line:a,featureIndex:l,feature:h,numGlyphVertices:P,numVerticalGlyphVertices:w,numIconVertices:E,textOpacityState:new OpacityState,iconOpacityState:new OpacityState,isDuplicate:!1,placedTextSymbolIndices:A,crossTileID:0}}(e,l,r,a,i,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,y,v,S,u,d,f,z,x,{zoom:e.zoom},t,o,n))};if("line"===c.get("symbol-placement"))for(var E=0,P=clipLine(t.geometry,0,0,EXTENT,EXTENT);E<P.length;E+=1)for(var w=P[E],A=0,L=getAnchors(w,m,h,a.vertical||a.horizontal,i,24,p,e.overscaling,EXTENT);A<L.length;A+=1){var D=L[A],O=a.horizontal;O&&anchorIsTooClose(e,O.text,T,D)||I(w,D)}else if("Polygon"===t.type)for(var _=0,R=classifyRings(t.geometry,0);_<R.length;_+=1){var B=R[_],M=findPoleOfInaccessibility(B,16);I(B[0],new Anchor(M.x,M.y,0))}else if("LineString"===t.type)for(var N=0,V=t.geometry;N<V.length;N+=1){var W=V[N];I(W,new Anchor(W[0].x,W[0].y,0))}else if("Point"===t.type)for(var X=0,C=t.geometry;X<C.length;X+=1)for(var k=0,G=C[X];k<G.length;k+=1){var Q=G[k];I([Q],new Anchor(Q.x,Q.y,0))}}function addTextVertices(e,t,a,i,o,n,r,l,s,c,u,x,g){var y=getGlyphQuads(t,a,i,o,n,r,x),p=e.textSizeData,d=null;return"source"===p.functionType?d=[10*i.layout.get("text-size").evaluate(r)]:"composite"===p.functionType&&(d=[10*g.compositeTextSizes[0].evaluate(r),10*g.compositeTextSizes[1].evaluate(r)]),e.addSymbols(e.text,y,d,l,o,r,c,t,s.lineStartIndex,s.lineLength),u.push(e.text.placedSymbolArray.length-1),4*y.length}function anchorIsTooClose(e,t,a,i){var o=e.compareText;if(t in o){for(var n=o[t],r=n.length-1;r>=0;r--)if(i.dist(n[r])<a)return!0}else o[t]=[];return o[t].push(i),!1}var Anchor=_dereq_("./anchor"),getAnchors=_dereq_("./get_anchors"),clipLine=_dereq_("./clip_line"),OpacityState=_dereq_("./opacity_state"),ref=_dereq_("./shaping"),shapeText=ref.shapeText,shapeIcon=ref.shapeIcon,WritingMode=ref.WritingMode,ref$1=_dereq_("./quads"),getGlyphQuads=ref$1.getGlyphQuads,getIconQuads=ref$1.getIconQuads,CollisionFeature=_dereq_("./collision_feature"),util=_dereq_("../util/util"),scriptDetection=_dereq_("../util/script_detection"),findPoleOfInaccessibility=_dereq_("../util/find_pole_of_inaccessibility"),classifyRings=_dereq_("../util/classify_rings"),EXTENT=_dereq_("../data/extent"),SymbolBucket=_dereq_("../data/bucket/symbol_bucket"),EvaluationParameters=_dereq_("../style/evaluation_parameters");_dereq_("@mapbox/point-geometry");module.exports={performSymbolLayout:function performSymbolLayout(e,t,a,i,o,n){e.createArrays(),e.symbolInstances=[];var r=512*e.overscaling;e.tilePixelRatio=EXTENT/r,e.compareText={},e.iconsNeedLinear=!1;var l=e.layers[0].layout,s=e.layers[0]._unevaluatedLayout._values,c={};if("composite"===e.textSizeData.functionType){var u=e.textSizeData.zoomRange,x=u.min,g=u.max;c.compositeTextSizes=[s["text-size"].possiblyEvaluate(new EvaluationParameters(x)),s["text-size"].possiblyEvaluate(new EvaluationParameters(g))]}if("composite"===e.iconSizeData.functionType){var y=e.iconSizeData.zoomRange,p=y.min,d=y.max;c.compositeIconSizes=[s["icon-size"].possiblyEvaluate(new EvaluationParameters(p)),s["icon-size"].possiblyEvaluate(new EvaluationParameters(d))]}c.layoutTextSize=s["text-size"].possiblyEvaluate(new EvaluationParameters(e.zoom+1)),c.layoutIconSize=s["icon-size"].possiblyEvaluate(new EvaluationParameters(e.zoom+1)),c.textMaxSize=s["text-size"].possiblyEvaluate(new EvaluationParameters(18));for(var m=24*l.get("text-line-height"),v="map"===l.get("text-rotation-alignment")&&"line"===l.get("symbol-placement"),f=l.get("text-keep-upright"),h=0,S=e.features;h<S.length;h+=1){var z=S[h],b=l.get("text-font").evaluate(z).join(","),T=t[b]||{},I=a[b]||{},E={},P=z.text;if(P){var w=scriptDetection.allowsVerticalWritingMode(P),q=l.get("text-offset").evaluate(z).map(function(e){return 24*e}),A=24*l.get("text-letter-spacing").evaluate(z),L=scriptDetection.allowsLetterSpacing(P)?A:0,D=l.get("text-anchor").evaluate(z),O=l.get("text-justify").evaluate(z),_="line"!==l.get("symbol-placement")?24*l.get("text-max-width").evaluate(z):0;E.horizontal=shapeText(P,T,_,m,D,O,L,q,24,WritingMode.horizontal),w&&v&&f&&(E.vertical=shapeText(P,T,_,m,D,O,L,q,24,WritingMode.vertical))}var R=void 0;if(z.icon){var B=i[z.icon];B&&(R=shapeIcon(o[z.icon],l.get("icon-offset").evaluate(z),l.get("icon-anchor").evaluate(z)),void 0===e.sdfIcons?e.sdfIcons=B.sdf:e.sdfIcons!==B.sdf&&util.warnOnce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),B.pixelRatio!==e.pixelRatio?e.iconsNeedLinear=!0:0!==l.get("icon-rotate").constantOr(1)&&(e.iconsNeedLinear=!0))}(E.horizontal||R)&&addFeature(e,z,E,R,I,c)}n&&e.generateCollisionDebugBuffers()}}},{"../data/bucket/symbol_bucket":51,"../data/extent":53,"../style/evaluation_parameters":182,"../util/classify_rings":255,"../util/find_pole_of_inaccessibility":261,"../util/script_detection":269,"../util/util":275,"./anchor":213,"./clip_line":215,"./collision_feature":216,"./get_anchors":219,"./opacity_state":222,"./quads":225,"./shaping":226,"@mapbox/point-geometry":4}],228:[function(_dereq_,module,exports){var normalizePropertyExpression=_dereq_("../style-spec/expression").normalizePropertyExpression,interpolate=_dereq_("../style-spec/util/interpolate"),util=_dereq_("../util/util");module.exports={getSizeData:function getSizeData(e,o){var i=o.expression;if("constant"===i.kind)return{functionType:"constant",layoutSize:i.evaluate({zoom:e+1})};if("source"===i.kind)return{functionType:"source"};for(var t=i.zoomStops,r=0;r<t.length&&t[r]<=e;)r++;for(var a=r=Math.max(0,r-1);a<t.length&&t[a]<e+1;)a++;a=Math.min(t.length-1,a);var n={min:t[r],max:t[a]};return"composite"===i.kind?{functionType:"composite",zoomRange:n,propertyValue:o.value}:{functionType:"camera",layoutSize:i.evaluate({zoom:e+1}),zoomRange:n,sizeRange:{min:i.evaluate({zoom:n.min}),max:i.evaluate({zoom:n.max})},propertyValue:o.value}},evaluateSizeForFeature:function evaluateSizeForFeature(e,o,i){var t=o;return"source"===e.functionType?i.lowerSize/10:"composite"===e.functionType?interpolate.number(i.lowerSize/10,i.upperSize/10,t.uSizeT):t.uSize},evaluateSizeForZoom:function evaluateSizeForZoom(e,o,i){if("constant"===e.functionType)return{uSizeT:0,uSize:e.layoutSize};if("source"===e.functionType)return{uSizeT:0,uSize:0};if("camera"===e.functionType){var t=e.propertyValue,r=e.zoomRange,a=e.sizeRange,n=normalizePropertyExpression(t,i.specification),u=util.clamp(n.interpolationFactor(o,r.min,r.max),0,1);return{uSizeT:0,uSize:a.min+u*(a.max-a.min)}}var p=e.propertyValue,l=e.zoomRange,m=normalizePropertyExpression(p,i.specification);return{uSizeT:util.clamp(m.interpolationFactor(o,l.min,l.max),0,1),uSize:0}}}},{"../style-spec/expression":139,"../style-spec/util/interpolate":158,"../util/util":275}],229:[function(_dereq_,module,exports){var rtlTextPlugin=_dereq_("../source/rtl_text_plugin");module.exports=function(e,t,r){var a=t.layout.get("text-transform").evaluate(r);return"uppercase"===a?e=e.toLocaleUpperCase():"lowercase"===a&&(e=e.toLocaleLowerCase()),rtlTextPlugin.applyArabicShaping&&(e=rtlTextPlugin.applyArabicShaping(e)),e}},{"../source/rtl_text_plugin":109}],230:[function(_dereq_,module,exports){var DOM=_dereq_("../util/dom"),Point=_dereq_("@mapbox/point-geometry"),handlers={scrollZoom:_dereq_("./handler/scroll_zoom"),boxZoom:_dereq_("./handler/box_zoom"),dragRotate:_dereq_("./handler/drag_rotate"),dragPan:_dereq_("./handler/drag_pan"),keyboard:_dereq_("./handler/keyboard"),doubleClickZoom:_dereq_("./handler/dblclick_zoom"),touchZoomRotate:_dereq_("./handler/touch_zoom_rotate")};module.exports=function(e,t){function s(){k=null}function h(t,n){var o=DOM.mousePos(p,n);return e.fire(t,{lngLat:e.unproject(o),point:o,originalEvent:n})}function g(t,n){var o=DOM.touchPos(p,n),r=o.reduce(function(e,t,n,o){return e.add(t.div(o.length))},new Point(0,0));return e.fire(t,{lngLat:e.unproject(r),point:r,lngLats:o.map(function(t){return e.unproject(t)},this),points:o,originalEvent:n})}var p=e.getCanvasContainer(),E=null,L=!1,b=null,k=null;for(var q in handlers)e[q]=new handlers[q](e,t),t.interactive&&t[q]&&e[q].enable(t[q]);p.addEventListener("mouseout",function n(e){h("mouseout",e)},!1),p.addEventListener("mousedown",function o(t){e.doubleClickZoom.isActive()||e.stop(),b=DOM.mousePos(p,t),h("mousedown",t),L=!0},!1),p.addEventListener("mouseup",function r(t){var n=e.dragRotate&&e.dragRotate.isActive();E&&!n&&h("contextmenu",E),E=null,L=!1,h("mouseup",t)},!1),p.addEventListener("mousemove",function a(t){if(!(e.dragPan&&e.dragPan.isActive()||e.dragRotate&&e.dragRotate.isActive())){for(var n=t.toElement||t.target;n&&n!==p;)n=n.parentNode;n===p&&h("mousemove",t)}},!1),p.addEventListener("mouseover",function u(e){for(var t=e.toElement||e.target;t&&t!==p;)t=t.parentNode;t===p&&h("mouseover",e)},!1),p.addEventListener("touchstart",function i(t){e.stop(),g("touchstart",t),!t.touches||t.touches.length>1||(k?(clearTimeout(k),k=null,h("dblclick",t)):k=setTimeout(s,300))},!1),p.addEventListener("touchend",function d(e){g("touchend",e)},!1),p.addEventListener("touchmove",function c(e){g("touchmove",e)},!1),p.addEventListener("touchcancel",function l(e){g("touchcancel",e)},!1),p.addEventListener("click",function v(e){DOM.mousePos(p,e).equals(b)&&h("click",e)},!1),p.addEventListener("dblclick",function m(e){h("dblclick",e),e.preventDefault()},!1),p.addEventListener("contextmenu",function f(t){var n=e.dragRotate&&e.dragRotate.isActive();L||n?L&&(E=t):h("contextmenu",t),t.preventDefault()},!1)}},{"../util/dom":259,"./handler/box_zoom":239,"./handler/dblclick_zoom":240,"./handler/drag_pan":241,"./handler/drag_rotate":242,"./handler/keyboard":243,"./handler/scroll_zoom":244,"./handler/touch_zoom_rotate":245,"@mapbox/point-geometry":4}],231:[function(_dereq_,module,exports){var util=_dereq_("../util/util"),interpolate=_dereq_("../style-spec/util/interpolate").number,browser=_dereq_("../util/browser"),LngLat=_dereq_("../geo/lng_lat"),LngLatBounds=_dereq_("../geo/lng_lat_bounds"),Point=_dereq_("@mapbox/point-geometry"),Camera=function(t){function i(i,e){t.call(this),this.moving=!1,this.transform=i,this._bearingSnap=e.bearingSnap}return t&&(i.__proto__=t),i.prototype=Object.create(t&&t.prototype),i.prototype.constructor=i,i.prototype.getCenter=function(){return this.transform.center},i.prototype.setCenter=function(t,i){return this.jumpTo({center:t},i)},i.prototype.panBy=function(t,i,e){return t=Point.convert(t).mult(-1),this.panTo(this.transform.center,util.extend({offset:t},i),e)},i.prototype.panTo=function(t,i,e){return this.easeTo(util.extend({center:t},i),e)},i.prototype.getZoom=function(){return this.transform.zoom},i.prototype.setZoom=function(t,i){return this.jumpTo({zoom:t},i),this},i.prototype.zoomTo=function(t,i,e){return this.easeTo(util.extend({zoom:t},i),e)},i.prototype.zoomIn=function(t,i){return this.zoomTo(this.getZoom()+1,t,i),this},i.prototype.zoomOut=function(t,i){return this.zoomTo(this.getZoom()-1,t,i),this},i.prototype.getBearing=function(){return this.transform.bearing},i.prototype.setBearing=function(t,i){return this.jumpTo({bearing:t},i),this},i.prototype.rotateTo=function(t,i,e){return this.easeTo(util.extend({bearing:t},i),e)},i.prototype.resetNorth=function(t,i){return this.rotateTo(0,util.extend({duration:1e3},t),i),this},i.prototype.snapToNorth=function(t,i){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,i):this},i.prototype.getPitch=function(){return this.transform.pitch},i.prototype.setPitch=function(t,i){return this.jumpTo({pitch:t},i),this},i.prototype.fitBounds=function(t,i,e){if("number"==typeof(i=util.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){var o=i.padding;i.padding={top:o,bottom:o,right:o,left:o}}if(!util.deepEqual(Object.keys(i.padding).sort(function(t,i){return t<i?-1:t>i?1:0}),["bottom","left","right","top"]))return util.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'"),this;t=LngLatBounds.convert(t);var n=[(i.padding.left-i.padding.right)/2,(i.padding.top-i.padding.bottom)/2],r=Math.min(i.padding.right,i.padding.left),a=Math.min(i.padding.top,i.padding.bottom);i.offset=[i.offset[0]+n[0],i.offset[1]+n[1]];var s=Point.convert(i.offset),h=this.transform,p=h.project(t.getNorthWest()),u=h.project(t.getSouthEast()),c=u.sub(p),m=(h.width-2*r-2*Math.abs(s.x))/c.x,f=(h.height-2*a-2*Math.abs(s.y))/c.y;return f<0||m<0?(util.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset."),this):(i.center=h.unproject(p.add(u).div(2)),i.zoom=Math.min(h.scaleZoom(h.scale*Math.min(m,f)),i.maxZoom),i.bearing=0,i.linear?this.easeTo(i,e):this.flyTo(i,e))},i.prototype.jumpTo=function(t,i){this.stop();var e=this.transform,o=!1,n=!1,r=!1;return"zoom"in t&&e.zoom!==+t.zoom&&(o=!0,e.zoom=+t.zoom),void 0!==t.center&&(e.center=LngLat.convert(t.center)),"bearing"in t&&e.bearing!==+t.bearing&&(n=!0,e.bearing=+t.bearing),"pitch"in t&&e.pitch!==+t.pitch&&(r=!0,e.pitch=+t.pitch),this.fire("movestart",i).fire("move",i),o&&this.fire("zoomstart",i).fire("zoom",i).fire("zoomend",i),n&&this.fire("rotate",i),r&&this.fire("pitchstart",i).fire("pitch",i).fire("pitchend",i),this.fire("moveend",i)},i.prototype.easeTo=function(t,i){var e=this;this.stop(),!1===(t=util.extend({offset:[0,0],duration:500,easing:util.ease},t)).animate&&(t.duration=0);var o=this.transform,n=this.getZoom(),r=this.getBearing(),a=this.getPitch(),s="zoom"in t?+t.zoom:n,h="bearing"in t?this._normalizeBearing(t.bearing,r):r,p="pitch"in t?+t.pitch:a,u=o.centerPoint.add(Point.convert(t.offset)),c=o.pointLocation(u),m=LngLat.convert(t.center||c);this._normalizeCenter(m);var f,g,d=o.project(c),l=o.project(m).sub(d),v=o.zoomScale(s-n);return t.around&&(f=LngLat.convert(t.around),g=o.locationPoint(f)),this.zooming=s!==n,this.rotating=r!==h,this.pitching=p!==a,this._prepareEase(i,t.noMoveStart),clearTimeout(this._onEaseEnd),this._ease(function(t){if(e.zooming&&(o.zoom=interpolate(n,s,t)),e.rotating&&(o.bearing=interpolate(r,h,t)),e.pitching&&(o.pitch=interpolate(a,p,t)),f)o.setLocationAtPoint(f,g);else{var c=o.zoomScale(o.zoom-n),m=s>n?Math.min(2,v):Math.max(.5,v),_=Math.pow(m,1-t),b=o.unproject(d.add(l.mult(t*_)).mult(c));o.setLocationAtPoint(o.renderWorldCopies?b.wrap():b,u)}e._fireMoveEvents(i)},function(){t.delayEndEvents?e._onEaseEnd=setTimeout(function(){return e._afterEase(i)},t.delayEndEvents):e._afterEase(i)},t),this},i.prototype._prepareEase=function(t,i){this.moving=!0,i||this.fire("movestart",t),this.zooming&&this.fire("zoomstart",t),this.pitching&&this.fire("pitchstart",t)},i.prototype._fireMoveEvents=function(t){this.fire("move",t),this.zooming&&this.fire("zoom",t),this.rotating&&this.fire("rotate",t),this.pitching&&this.fire("pitch",t)},i.prototype._afterEase=function(t){var i=this.zooming,e=this.pitching;this.moving=!1,this.zooming=!1,this.rotating=!1,this.pitching=!1,i&&this.fire("zoomend",t),e&&this.fire("pitchend",t),this.fire("moveend",t)},i.prototype.flyTo=function(t,i){function e(t){var i=(M*M-z*z+(t?-1:1)*L*L*x*x)/(2*(t?M:z)*L*x);return Math.log(Math.sqrt(i*i+1)-i)}function o(t){return(Math.exp(t)-Math.exp(-t))/2}function n(t){return(Math.exp(t)+Math.exp(-t))/2}var a=this;this.stop(),t=util.extend({offset:[0,0],speed:1.2,curve:1.42,easing:util.ease},t);var s=this.transform,h=this.getZoom(),p=this.getBearing(),u=this.getPitch(),c="zoom"in t?util.clamp(+t.zoom,s.minZoom,s.maxZoom):h,m="bearing"in t?this._normalizeBearing(t.bearing,p):p,f="pitch"in t?+t.pitch:u,g=s.zoomScale(c-h),d=s.centerPoint.add(Point.convert(t.offset)),l=s.pointLocation(d),v=LngLat.convert(t.center||l);this._normalizeCenter(v);var _=s.project(l),b=s.project(v).sub(_),y=t.curve,z=Math.max(s.width,s.height),M=z/g,x=b.mag();if("minZoom"in t){var E=util.clamp(Math.min(t.minZoom,h,c),s.minZoom,s.maxZoom),T=z/s.zoomScale(E-h);y=Math.sqrt(T/x*2)}var L=y*y,j=e(0),w=function(t){return n(j)/n(j+y*t)},Z=function(t){return z*((n(j)*function r(t){return o(t)/n(t)}(j+y*t)-o(j))/L)/x},P=(e(1)-j)/y;if(Math.abs(x)<1e-6||!isFinite(P)){if(Math.abs(z-M)<1e-6)return this.easeTo(t,i);var S=M<z?-1:1;P=Math.abs(Math.log(M/z))/y,Z=function(){return 0},w=function(t){return Math.exp(S*y*t)}}if("duration"in t)t.duration=+t.duration;else{var B="screenSpeed"in t?+t.screenSpeed/y:+t.speed;t.duration=1e3*P/B}return t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this.zooming=!0,this.rotating=p!==m,this.pitching=f!==u,this._prepareEase(i,!1),this._ease(function(t){var e=t*P,o=1/w(e);s.zoom=h+s.scaleZoom(o),a.rotating&&(s.bearing=interpolate(p,m,t)),a.pitching&&(s.pitch=interpolate(u,f,t));var n=s.unproject(_.add(b.mult(Z(e))).mult(o));s.setLocationAtPoint(s.renderWorldCopies?n.wrap():n,d),a._fireMoveEvents(i)},function(){return a._afterEase(i)},t),this},i.prototype.isEasing=function(){return!!this._isEasing},i.prototype.isMoving=function(){return this.moving},i.prototype.stop=function(){return this._onFrame&&this._finishAnimation(),this},i.prototype._ease=function(t,i,e){var o=this;!1===e.animate||0===e.duration?(t(1),i()):(this._easeStart=browser.now(),this._isEasing=!0,this._easeOptions=e,this._startAnimation(function(i){var e=Math.min((browser.now()-o._easeStart)/o._easeOptions.duration,1);t(o._easeOptions.easing(e)),1===e&&o.stop()},function(){o._isEasing=!1,i()}))},i.prototype._updateCamera=function(){this._onFrame&&this._onFrame(this.transform)},i.prototype._startAnimation=function(t,i){return void 0===i&&(i=function(){}),this.stop(),this._onFrame=t,this._finishFn=i,this._update(),this},i.prototype._finishAnimation=function(){delete this._onFrame;var t=this._finishFn;delete this._finishFn,t.call(this)},i.prototype._normalizeBearing=function(t,i){t=util.wrap(t,-180,180);var e=Math.abs(t-i);return Math.abs(t-360-i)<e&&(t-=360),Math.abs(t+360-i)<e&&(t+=360),t},i.prototype._normalizeCenter=function(t){var i=this.transform;if(i.renderWorldCopies&&!i.lngRange){var e=t.lng-i.center.lng;t.lng+=e>180?-360:e<-180?360:0}},i}(_dereq_("../util/evented"));module.exports=Camera},{"../geo/lng_lat":62,"../geo/lng_lat_bounds":63,"../style-spec/util/interpolate":158,"../util/browser":252,"../util/evented":260,"../util/util":275,"@mapbox/point-geometry":4}],232:[function(_dereq_,module,exports){var DOM=_dereq_("../../util/dom"),util=_dereq_("../../util/util"),config=_dereq_("../../util/config"),AttributionControl=function(t){this.options=t,util.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};AttributionControl.prototype.getDefaultPosition=function(){return"bottom-right"},AttributionControl.prototype.onAdd=function(t){var i=this.options&&this.options.compact;return this._map=t,this._container=DOM.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),i&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===i&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},AttributionControl.prototype.onRemove=function(){DOM.remove(this._container),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0},AttributionControl.prototype._updateEditLink=function(){var t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));var i=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:config.ACCESS_TOKEN}];if(t){var e=i.reduce(function(t,e,o){return e.value&&(t+=e.key+"="+e.value+(o<i.length-1?"&":"")),t},"?");t.href="https://www.mapbox.com/feedback/"+e+(this._map._hash?this._map._hash.getHashString(!0):"")}},AttributionControl.prototype._updateData=function(t){t&&"metadata"===t.sourceDataType&&(this._updateAttributions(),this._updateEditLink())},AttributionControl.prototype._updateAttributions=function(){if(this._map.style){var t=[];if(this._map.style.stylesheet){var i=this._map.style.stylesheet;this.styleOwner=i.owner,this.styleId=i.id}var e=this._map.style.sourceCaches;for(var o in e){var a=e[o].getSource();a.attribution&&t.indexOf(a.attribution)<0&&t.push(a.attribution)}t.sort(function(t,i){return t.length-i.length}),(t=t.filter(function(i,e){for(var o=e+1;o<t.length;o++)if(t[o].indexOf(i)>=0)return!1;return!0})).length?(this._container.innerHTML=t.join(" | "),this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null}},AttributionControl.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")},module.exports=AttributionControl},{"../../util/config":256,"../../util/dom":259,"../../util/util":275}],233:[function(_dereq_,module,exports){var DOM=_dereq_("../../util/dom"),util=_dereq_("../../util/util"),window=_dereq_("../../util/window"),FullscreenControl=function(){this._fullscreen=!1,util.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in window.document&&(this._fullscreenchange="MSFullscreenChange"),this._className="mapboxgl-ctrl"};FullscreenControl.prototype.onAdd=function(e){return this._map=e,this._mapContainer=this._map.getContainer(),this._container=DOM.create("div",this._className+" mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._container.style.display="none",util.warnOnce("This device does not support fullscreen mode.")),this._container},FullscreenControl.prototype.onRemove=function(){DOM.remove(this._container),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},FullscreenControl.prototype._checkFullscreenSupport=function(){return!!(window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled)},FullscreenControl.prototype._setupUI=function(){var e=this._fullscreenButton=DOM.create("button",this._className+"-icon "+this._className+"-fullscreen",this._container);e.setAttribute("aria-label","Toggle fullscreen"),e.type="button",this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)},FullscreenControl.prototype._isFullscreen=function(){return this._fullscreen},FullscreenControl.prototype._changeIcon=function(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._mapContainer!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle(this._className+"-shrink"),this._fullscreenButton.classList.toggle(this._className+"-fullscreen"))},FullscreenControl.prototype._onClickFullscreen=function(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._mapContainer.requestFullscreen?this._mapContainer.requestFullscreen():this._mapContainer.mozRequestFullScreen?this._mapContainer.mozRequestFullScreen():this._mapContainer.msRequestFullscreen?this._mapContainer.msRequestFullscreen():this._mapContainer.webkitRequestFullscreen&&this._mapContainer.webkitRequestFullscreen()},module.exports=FullscreenControl},{"../../util/dom":259,"../../util/util":275,"../../util/window":254}],234:[function(_dereq_,module,exports){var supportsGeolocation,Evented=_dereq_("../../util/evented"),DOM=_dereq_("../../util/dom"),window=_dereq_("../../util/window"),util=_dereq_("../../util/util"),LngLat=_dereq_("../../geo/lng_lat"),Marker=_dereq_("../marker"),defaultOptions={positionOptions:{enableHighAccuracy:!1,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0},GeolocateControl=function(t){function o(o){t.call(this),this.options=util.extend({},defaultOptions,o),util.bindAll(["_onSuccess","_onError","_finish","_setupUI","_updateCamera","_updateMarker","_onClickGeolocate"],this)}return t&&(o.__proto__=t),o.prototype=Object.create(t&&t.prototype),o.prototype.constructor=o,o.prototype.onAdd=function(t){return this._map=t,this._container=DOM.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),function checkGeolocationSupport(t){void 0!==supportsGeolocation?t(supportsGeolocation):void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then(function(o){supportsGeolocation="denied"!==o.state,t(supportsGeolocation)}):(supportsGeolocation=!!window.navigator.geolocation,t(supportsGeolocation))}(this._setupUI),this._container},o.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker.remove(),DOM.remove(this._container),this._map=void 0},o.prototype._onSuccess=function(t){if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire("geolocate",t),this._finish()},o.prototype._updateCamera=function(t){var o=new LngLat(t.coords.longitude,t.coords.latitude),e=t.coords.accuracy;this._map.fitBounds(o.toBounds(e),this.options.fitBoundsOptions,{geolocateSource:!0})},o.prototype._updateMarker=function(t){t?this._userLocationDotMarker.setLngLat([t.coords.longitude,t.coords.latitude]).addTo(this._map):this._userLocationDotMarker.remove()},o.prototype._onError=function(t){if(this.options.trackUserLocation)if(1===t.code)this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),void 0!==this._geolocationWatchID&&this._clearWatch();else switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire("error",t),this._finish()},o.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},o.prototype._setupUI=function(t){var o=this;!1!==t&&(this._container.addEventListener("contextmenu",function(t){return t.preventDefault()}),this._geolocateButton=DOM.create("button","mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",this._container),this._geolocateButton.type="button",this._geolocateButton.setAttribute("aria-label","Geolocate"),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=DOM.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Marker(this._dotElement),this.options.trackUserLocation&&(this._watchState="OFF")),this._geolocateButton.addEventListener("click",this._onClickGeolocate.bind(this)),this.options.trackUserLocation&&this._map.on("movestart",function(t){t.geolocateSource||"ACTIVE_LOCK"!==o._watchState||(o._watchState="BACKGROUND",o._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),o._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),o.fire("trackuserlocationend"))}))},o.prototype._onClickGeolocate=function(){if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire("trackuserlocationstart");break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire("trackuserlocationend");break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire("trackuserlocationstart")}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}"OFF"===this._watchState&&void 0!==this._geolocationWatchID?this._clearWatch():void 0===this._geolocationWatchID&&(this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,this.options.positionOptions))}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4)},o.prototype._clearWatch=function(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},o}(Evented);module.exports=GeolocateControl},{"../../geo/lng_lat":62,"../../util/dom":259,"../../util/evented":260,"../../util/util":275,"../../util/window":254,"../marker":248}],235:[function(_dereq_,module,exports){var DOM=_dereq_("../../util/dom"),util=_dereq_("../../util/util"),LogoControl=function(){util.bindAll(["_updateLogo"],this)};LogoControl.prototype.onAdd=function(o){this._map=o,this._container=DOM.create("div","mapboxgl-ctrl");var t=DOM.create("a","mapboxgl-ctrl-logo");return t.target="_blank",t.href="https://www.mapbox.com/",t.setAttribute("aria-label","Mapbox logo"),this._container.appendChild(t),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._container},LogoControl.prototype.onRemove=function(){DOM.remove(this._container),this._map.off("sourcedata",this._updateLogo)},LogoControl.prototype.getDefaultPosition=function(){return"bottom-left"},LogoControl.prototype._updateLogo=function(o){o&&"metadata"!==o.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},LogoControl.prototype._logoRequired=function(){if(this._map.style){var o=this._map.style.sourceCaches;for(var t in o)if(o[t].getSource().mapbox_logo)return!0;return!1}},module.exports=LogoControl},{"../../util/dom":259,"../../util/util":275}],236:[function(_dereq_,module,exports){var DOM=_dereq_("../../util/dom"),util=_dereq_("../../util/util"),DragRotateHandler=_dereq_("../handler/drag_rotate"),defaultOptions={showCompass:!0,showZoom:!0},NavigationControl=function(t){var o=this;this.options=util.extend({},defaultOptions,t),this._container=DOM.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(t){return t.preventDefault()}),this.options.showZoom&&(this._zoomInButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-in","Zoom In",function(){return o._map.zoomIn()}),this._zoomOutButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-out","Zoom Out",function(){return o._map.zoomOut()})),this.options.showCompass&&(util.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-compass","Reset North",function(){return o._map.resetNorth()}),this._compassArrow=DOM.create("span","mapboxgl-ctrl-compass-arrow",this._compass))};NavigationControl.prototype._rotateCompassArrow=function(){var t="rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassArrow.style.transform=t},NavigationControl.prototype.onAdd=function(t){return this._map=t,this.options.showCompass&&(this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new DragRotateHandler(t,{button:"left",element:this._compass}),this._handler.enable()),this._container},NavigationControl.prototype.onRemove=function(){DOM.remove(this._container),this.options.showCompass&&(this._map.off("rotate",this._rotateCompassArrow),this._handler.disable(),delete this._handler),delete this._map},NavigationControl.prototype._createButton=function(t,o,r){var e=DOM.create("button",t,this._container);return e.type="button",e.setAttribute("aria-label",o),e.addEventListener("click",r),e},module.exports=NavigationControl},{"../../util/dom":259,"../../util/util":275,"../handler/drag_rotate":242}],237:[function(_dereq_,module,exports){function updateScale(t,e,o){var n=o&&o.maxWidth||100,i=t._container.clientHeight/2,a=function getDistance(t,e){var o=Math.PI/180,n=t.lat*o,i=e.lat*o,a=Math.sin(n)*Math.sin(i)+Math.cos(n)*Math.cos(i)*Math.cos((e.lng-t.lng)*o);return 6371e3*Math.acos(Math.min(a,1))}(t.unproject([0,i]),t.unproject([n,i]));if(o&&"imperial"===o.unit){var l=3.2808*a;l>5280?setScale(e,n,l/5280,"mi"):setScale(e,n,l,"ft")}else if(o&&"nautical"===o.unit){setScale(e,n,a/1852,"nm")}else setScale(e,n,a,"m")}function setScale(t,e,o,n){var i=function getRoundNum(t){var e=Math.pow(10,(""+Math.floor(t)).length-1),o=t/e;return e*(o=o>=10?10:o>=5?5:o>=3?3:o>=2?2:1)}(o),a=i/o;"m"===n&&i>=1e3&&(i/=1e3,n="km"),t.style.width=e*a+"px",t.innerHTML=i+n}var DOM=_dereq_("../../util/dom"),util=_dereq_("../../util/util"),ScaleControl=function(t){this.options=t,util.bindAll(["_onMove"],this)};ScaleControl.prototype.getDefaultPosition=function(){return"bottom-left"},ScaleControl.prototype._onMove=function(){updateScale(this._map,this._container,this.options)},ScaleControl.prototype.onAdd=function(t){return this._map=t,this._container=DOM.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},ScaleControl.prototype.onRemove=function(){DOM.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},module.exports=ScaleControl},{"../../util/dom":259,"../../util/util":275}],238:[function(_dereq_,module,exports){},{}],239:[function(_dereq_,module,exports){var DOM=_dereq_("../../util/dom"),LngLatBounds=_dereq_("../../geo/lng_lat_bounds"),util=_dereq_("../../util/util"),window=_dereq_("../../util/window"),BoxZoomHandler=function(o){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),util.bindAll(["_onMouseDown","_onMouseMove","_onMouseUp","_onKeyDown"],this)};BoxZoomHandler.prototype.isEnabled=function(){return!!this._enabled},BoxZoomHandler.prototype.isActive=function(){return!!this._active},BoxZoomHandler.prototype.enable=function(){this.isEnabled()||(this._map.dragPan&&this._map.dragPan.disable(),this._el.addEventListener("mousedown",this._onMouseDown,!1),this._map.dragPan&&this._map.dragPan.enable(),this._enabled=!0)},BoxZoomHandler.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("mousedown",this._onMouseDown),this._enabled=!1)},BoxZoomHandler.prototype._onMouseDown=function(o){o.shiftKey&&0===o.button&&(window.document.addEventListener("mousemove",this._onMouseMove,!1),window.document.addEventListener("keydown",this._onKeyDown,!1),window.document.addEventListener("mouseup",this._onMouseUp,!1),DOM.disableDrag(),this._startPos=DOM.mousePos(this._el,o),this._active=!0)},BoxZoomHandler.prototype._onMouseMove=function(o){var e=this._startPos,t=DOM.mousePos(this._el,o);this._box||(this._box=DOM.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));var n=Math.min(e.x,t.x),i=Math.max(e.x,t.x),s=Math.min(e.y,t.y),a=Math.max(e.y,t.y);DOM.setTransform(this._box,"translate("+n+"px,"+s+"px)"),this._box.style.width=i-n+"px",this._box.style.height=a-s+"px"},BoxZoomHandler.prototype._onMouseUp=function(o){if(0===o.button){var e=this._startPos,t=DOM.mousePos(this._el,o),n=(new LngLatBounds).extend(this._map.unproject(e)).extend(this._map.unproject(t));this._finish(),e.x===t.x&&e.y===t.y?this._fireEvent("boxzoomcancel",o):this._map.fitBounds(n,{linear:!0}).fire("boxzoomend",{originalEvent:o,boxZoomBounds:n})}},BoxZoomHandler.prototype._onKeyDown=function(o){27===o.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",o))},BoxZoomHandler.prototype._finish=function(){this._active=!1,window.document.removeEventListener("mousemove",this._onMouseMove,!1),window.document.removeEventListener("keydown",this._onKeyDown,!1),window.document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(DOM.remove(this._box),this._box=null),DOM.enableDrag()},BoxZoomHandler.prototype._fireEvent=function(o,e){return this._map.fire(o,{originalEvent:e})},module.exports=BoxZoomHandler},{"../../geo/lng_lat_bounds":63,"../../util/dom":259,"../../util/util":275,"../../util/window":254}],240:[function(_dereq_,module,exports){var util=_dereq_("../../util/util"),DoubleClickZoomHandler=function(o){this._map=o,util.bindAll(["_onDblClick","_onZoomEnd"],this)};DoubleClickZoomHandler.prototype.isEnabled=function(){return!!this._enabled},DoubleClickZoomHandler.prototype.isActive=function(){return!!this._active},DoubleClickZoomHandler.prototype.enable=function(){this.isEnabled()||(this._map.on("dblclick",this._onDblClick),this._enabled=!0)},DoubleClickZoomHandler.prototype.disable=function(){this.isEnabled()&&(this._map.off("dblclick",this._onDblClick),this._enabled=!1)},DoubleClickZoomHandler.prototype._onDblClick=function(o){this._active=!0,this._map.on("zoomend",this._onZoomEnd),this._map.zoomTo(this._map.getZoom()+(o.originalEvent.shiftKey?-1:1),{around:o.lngLat},o)},DoubleClickZoomHandler.prototype._onZoomEnd=function(){this._active=!1,this._map.off("zoomend",this._onZoomEnd)},module.exports=DoubleClickZoomHandler},{"../../util/util":275}],241:[function(_dereq_,module,exports){var DOM=_dereq_("../../util/dom"),util=_dereq_("../../util/util"),window=_dereq_("../../util/window"),browser=_dereq_("../../util/browser"),inertiaEasing=util.bezier(0,0,.3,1),DragPanHandler=function(e){this._map=e,this._el=e.getCanvasContainer(),util.bindAll(["_onDown","_onMove","_onUp","_onTouchEnd","_onMouseUp","_onDragFrame","_onDragFinished"],this)};DragPanHandler.prototype.isEnabled=function(){return!!this._enabled},DragPanHandler.prototype.isActive=function(){return!!this._active},DragPanHandler.prototype.enable=function(){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._el.addEventListener("mousedown",this._onDown),this._el.addEventListener("touchstart",this._onDown),this._enabled=!0)},DragPanHandler.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._el.removeEventListener("mousedown",this._onDown),this._el.removeEventListener("touchstart",this._onDown),this._enabled=!1)},DragPanHandler.prototype._onDown=function(e){this._ignoreEvent(e)||this.isActive()||(e.touches?(window.document.addEventListener("touchmove",this._onMove),window.document.addEventListener("touchend",this._onTouchEnd)):(window.document.addEventListener("mousemove",this._onMove),window.document.addEventListener("mouseup",this._onMouseUp)),window.addEventListener("blur",this._onMouseUp),this._active=!1,this._previousPos=DOM.mousePos(this._el,e),this._inertia=[[browser.now(),this._previousPos]])},DragPanHandler.prototype._onMove=function(e){if(!this._ignoreEvent(e)){this._lastMoveEvent=e,e.preventDefault();var t=DOM.mousePos(this._el,e);if(this._drainInertiaBuffer(),this._inertia.push([browser.now(),t]),!this._previousPos)return void(this._previousPos=t);this._pos=t,this.isActive()||(this._active=!0,this._map.moving=!0,this._fireEvent("dragstart",e),this._fireEvent("movestart",e),this._map._startAnimation(this._onDragFrame,this._onDragFinished)),this._map._update()}},DragPanHandler.prototype._onDragFrame=function(e){var t=this._lastMoveEvent;t&&(e.setLocationAtPoint(e.pointLocation(this._previousPos),this._pos),this._fireEvent("drag",t),this._fireEvent("move",t),this._previousPos=this._pos,delete this._lastMoveEvent)},DragPanHandler.prototype._onDragFinished=function(e){var t=this;if(this.isActive()){this._active=!1,delete this._lastMoveEvent,delete this._previousPos,delete this._pos,this._fireEvent("dragend",e),this._drainInertiaBuffer();var n=function(){t._map.moving=!1,t._fireEvent("moveend",e)},i=this._inertia;if(i.length<2)return void n();var o=i[i.length-1],r=i[0],s=o[1].sub(r[1]),a=(o[0]-r[0])/1e3;if(0===a||o[1].equals(r[1]))return void n();var h=s.mult(.3/a),u=h.mag();u>1400&&(u=1400,h._unit()._mult(u));var d=u/750,_=h.mult(-d/2);this._map.panBy(_,{duration:1e3*d,easing:inertiaEasing,noMoveStart:!0},{originalEvent:e})}},DragPanHandler.prototype._onUp=function(e){this._onDragFinished(e)},DragPanHandler.prototype._onMouseUp=function(e){this._ignoreEvent(e)||(this._onUp(e),window.document.removeEventListener("mousemove",this._onMove),window.document.removeEventListener("mouseup",this._onMouseUp),window.removeEventListener("blur",this._onMouseUp))},DragPanHandler.prototype._onTouchEnd=function(e){this._ignoreEvent(e)||(this._onUp(e),window.document.removeEventListener("touchmove",this._onMove),window.document.removeEventListener("touchend",this._onTouchEnd))},DragPanHandler.prototype._fireEvent=function(e,t){return this._map.fire(e,t?{originalEvent:t}:{})},DragPanHandler.prototype._ignoreEvent=function(e){var t=this._map;return!(!t.boxZoom||!t.boxZoom.isActive())||!(!t.dragRotate||!t.dragRotate.isActive())||(e.touches?e.touches.length>1:!!e.ctrlKey||"mousemove"!==e.type&&e.button&&0!==e.button)},DragPanHandler.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,t=browser.now();e.length>0&&t-e[0][0]>160;)e.shift()},module.exports=DragPanHandler},{"../../util/browser":252,"../../util/dom":259,"../../util/util":275,"../../util/window":254}],242:[function(_dereq_,module,exports){var DOM=_dereq_("../../util/dom"),util=_dereq_("../../util/util"),window=_dereq_("../../util/window"),browser=_dereq_("../../util/browser"),inertiaEasing=util.bezier(0,0,.25,1),DragRotateHandler=function(t,e){this._map=t,this._el=e.element||t.getCanvasContainer(),this._button=e.button||"right",this._bearingSnap=e.bearingSnap||0,this._pitchWithRotate=!1!==e.pitchWithRotate,util.bindAll(["_onDown","_onMove","_onUp","_onDragFrame","_onDragFinished"],this)};DragRotateHandler.prototype.isEnabled=function(){return!!this._enabled},DragRotateHandler.prototype.isActive=function(){return!!this._active},DragRotateHandler.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("mousedown",this._onDown),this._enabled=!0)},DragRotateHandler.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("mousedown",this._onDown),this._enabled=!1)},DragRotateHandler.prototype._onDown=function(t){if(!(this._map.boxZoom&&this._map.boxZoom.isActive()||this._map.dragPan&&this._map.dragPan.isActive()||this.isActive())){if("right"===this._button){var e=t.ctrlKey?0:2,i=t.button;if(void 0!==window.InstallTrigger&&2===t.button&&t.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0&&(i=0),i!==e)return}else if(t.ctrlKey||0!==t.button)return;DOM.disableDrag(),window.document.addEventListener("mousemove",this._onMove,{capture:!0}),window.document.addEventListener("mouseup",this._onUp),window.addEventListener("blur",this._onUp),this._active=!1,this._inertia=[[browser.now(),this._map.getBearing()]],this._previousPos=DOM.mousePos(this._el,t),this._center=this._map.transform.centerPoint,t.preventDefault()}},DragRotateHandler.prototype._onMove=function(t){this._lastMoveEvent=t;var e=DOM.mousePos(this._el,t);this._previousPos?(this._pos=e,this.isActive()||(this._active=!0,this._map.moving=!0,this._fireEvent("rotatestart",t),this._fireEvent("movestart",t),this._pitchWithRotate&&this._fireEvent("pitchstart",t),this._map._startAnimation(this._onDragFrame,this._onDragFinished)),this._map._update()):this._previousPos=e},DragRotateHandler.prototype._onUp=function(t){window.document.removeEventListener("mousemove",this._onMove,{capture:!0}),window.document.removeEventListener("mouseup",this._onUp),window.removeEventListener("blur",this._onUp),DOM.enableDrag(),this._onDragFinished(t)},DragRotateHandler.prototype._onDragFrame=function(t){var e=this._lastMoveEvent;if(e){var i=this._previousPos,n=this._pos,r=.8*(i.x-n.x),a=-.5*(i.y-n.y),o=t.bearing-r,s=t.pitch-a,h=this._inertia,_=h[h.length-1];this._drainInertiaBuffer(),h.push([browser.now(),this._map._normalizeBearing(o,_[1])]),t.bearing=o,this._pitchWithRotate&&(this._fireEvent("pitch",e),t.pitch=s),this._fireEvent("rotate",e),this._fireEvent("move",e),delete this._lastMoveEvent,this._previousPos=this._pos}},DragRotateHandler.prototype._onDragFinished=function(t){var e=this;if(this.isActive()){this._active=!1,delete this._lastMoveEvent,delete this._previousPos,this._fireEvent("rotateend",t),this._drainInertiaBuffer();var i=this._map,n=i.getBearing(),r=this._inertia,a=function(){Math.abs(n)<e._bearingSnap?i.resetNorth({noMoveStart:!0},{originalEvent:t}):(e._map.moving=!1,e._fireEvent("moveend",t)),e._pitchWithRotate&&e._fireEvent("pitchend",t)};if(r.length<2)return void a();var o=r[0],s=r[r.length-1],h=r[r.length-2],_=i._normalizeBearing(n,h[1]),v=s[1]-o[1],p=v<0?-1:1,d=(s[0]-o[0])/1e3;if(0===v||0===d)return void a();var u=Math.abs(v*(.25/d));u>180&&(u=180);var l=u/180;_+=p*u*(l/2),Math.abs(i._normalizeBearing(_,0))<this._bearingSnap&&(_=i._normalizeBearing(0,_)),i.rotateTo(_,{duration:1e3*l,easing:inertiaEasing,noMoveStart:!0},{originalEvent:t})}},DragRotateHandler.prototype._fireEvent=function(t,e){return this._map.fire(t,e?{originalEvent:e}:{})},DragRotateHandler.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,e=browser.now();t.length>0&&e-t[0][0]>160;)t.shift()},module.exports=DragRotateHandler},{"../../util/browser":252,"../../util/dom":259,"../../util/util":275,"../../util/window":254}],243:[function(_dereq_,module,exports){function easeOut(e){return e*(2-e)}var util=_dereq_("../../util/util"),KeyboardHandler=function(e){this._map=e,this._el=e.getCanvasContainer(),util.bindAll(["_onKeyDown"],this)};KeyboardHandler.prototype.isEnabled=function(){return!!this._enabled},KeyboardHandler.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},KeyboardHandler.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},KeyboardHandler.prototype._onKeyDown=function(e){if(!(e.altKey||e.ctrlKey||e.metaKey)){var t=0,a=0,n=0,r=0,i=0;switch(e.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:e.shiftKey?a=-1:(e.preventDefault(),r=-1);break;case 39:e.shiftKey?a=1:(e.preventDefault(),r=1);break;case 38:e.shiftKey?n=1:(e.preventDefault(),i=-1);break;case 40:e.shiftKey?n=-1:(i=1,e.preventDefault());break;default:return}var s=this._map,o=s.getZoom(),l={duration:300,delayEndEvents:500,easing:easeOut,zoom:t?Math.round(o)+t*(e.shiftKey?2:1):o,bearing:s.getBearing()+15*a,pitch:s.getPitch()+10*n,offset:[100*-r,100*-i],center:s.getCenter()};s.easeTo(l,{originalEvent:e})}},module.exports=KeyboardHandler},{"../../util/util":275}],244:[function(_dereq_,module,exports){var DOM=_dereq_("../../util/dom"),util=_dereq_("../../util/util"),browser=_dereq_("../../util/browser"),window=_dereq_("../../util/window"),interpolate=_dereq_("../../style-spec/util/interpolate").number,LngLat=_dereq_("../../geo/lng_lat"),ua=window.navigator.userAgent.toLowerCase(),firefox=-1!==ua.indexOf("firefox"),safari=-1!==ua.indexOf("safari")&&-1===ua.indexOf("chrom"),ScrollZoomHandler=function(t){this._map=t,this._el=t.getCanvasContainer(),this._delta=0,util.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};ScrollZoomHandler.prototype.isEnabled=function(){return!!this._enabled},ScrollZoomHandler.prototype.isActive=function(){return!!this._active},ScrollZoomHandler.prototype.enable=function(t){this.isEnabled()||(this._el.addEventListener("wheel",this._onWheel,!1),this._el.addEventListener("mousewheel",this._onWheel,!1),this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},ScrollZoomHandler.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("wheel",this._onWheel),this._el.removeEventListener("mousewheel",this._onWheel),this._enabled=!1)},ScrollZoomHandler.prototype._onWheel=function(t){var e=0;"wheel"===t.type?(e=t.deltaY,firefox&&t.deltaMode===window.WheelEvent.DOM_DELTA_PIXEL&&(e/=browser.devicePixelRatio),t.deltaMode===window.WheelEvent.DOM_DELTA_LINE&&(e*=40)):"mousewheel"===t.type&&(e=-t.wheelDeltaY,safari&&(e/=3));var i=browser.now(),o=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,0!==e&&e%4.000244140625==0?this._type="wheel":0!==e&&Math.abs(e)<4?this._type="trackpad":o>400?(this._type=null,this._lastValue=e,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(o*e)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,e+=this._lastValue)),t.shiftKey&&e&&(e/=4),this._type&&(this._lastWheelEvent=t,this._delta-=e,this.isActive()||this._start(t)),t.preventDefault()},ScrollZoomHandler.prototype._onTimeout=function(t){this._type="wheel",this._delta-=this._lastValue,this.isActive()||this._start(t)},ScrollZoomHandler.prototype._start=function(t){if(this._delta){this._active=!0,this._map.moving=!0,this._map.zooming=!0,this._map.fire("movestart",{originalEvent:t}),this._map.fire("zoomstart",{originalEvent:t}),clearTimeout(this._finishTimeout);var e=DOM.mousePos(this._el,t);this._around=LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(e)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._map._startAnimation(this._onScrollFrame,this._onScrollFinished)}},ScrollZoomHandler.prototype._onScrollFrame=function(t){if(this.isActive()){if(0!==this._delta){var e="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?1/450:.01,i=2/(1+Math.exp(-Math.abs(this._delta*e)));this._delta<0&&0!==i&&(i=1/i);var o="number"==typeof this._targetZoom?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(o*i))),"wheel"===this._type&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}if("wheel"===this._type){var a=Math.min((browser.now()-this._lastWheelEventTime)/200,1),s=this._easing(a);t.zoom=interpolate(this._startZoom,this._targetZoom,s),1===a&&this._map.stop()}else t.zoom=this._targetZoom,this._map.stop();t.setLocationAtPoint(this._around,this._aroundPoint),this._map.fire("move",{originalEvent:this._lastWheelEvent}),this._map.fire("zoom",{originalEvent:this._lastWheelEvent})}},ScrollZoomHandler.prototype._onScrollFinished=function(){var t=this;this.isActive()&&(this._active=!1,this._finishTimeout=setTimeout(function(){t._map.moving=!1,t._map.zooming=!1,t._map.fire("zoomend"),t._map.fire("moveend"),delete t._targetZoom},200))},ScrollZoomHandler.prototype._smoothOutEasing=function(t){var e=util.ease;if(this._prevEase){var i=this._prevEase,o=(browser.now()-i.start)/i.duration,a=i.easing(o+.01)-i.easing(o),s=.27/Math.sqrt(a*a+1e-4)*.01,r=Math.sqrt(.0729-s*s);e=util.bezier(s,r,.25,1)}return this._prevEase={start:browser.now(),duration:t,easing:e},e},module.exports=ScrollZoomHandler},{"../../geo/lng_lat":62,"../../style-spec/util/interpolate":158,"../../util/browser":252,"../../util/dom":259,"../../util/util":275,"../../util/window":254}],245:[function(_dereq_,module,exports){var DOM=_dereq_("../../util/dom"),util=_dereq_("../../util/util"),window=_dereq_("../../util/window"),browser=_dereq_("../../util/browser"),inertiaEasing=util.bezier(0,0,.15,1),TouchZoomRotateHandler=function(t){this._map=t,this._el=t.getCanvasContainer(),util.bindAll(["_onStart","_onMove","_onEnd"],this)};TouchZoomRotateHandler.prototype.isEnabled=function(){return!!this._enabled},TouchZoomRotateHandler.prototype.enable=function(t){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._el.addEventListener("touchstart",this._onStart,!1),this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},TouchZoomRotateHandler.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._el.removeEventListener("touchstart",this._onStart),this._enabled=!1)},TouchZoomRotateHandler.prototype.disableRotation=function(){this._rotationDisabled=!0},TouchZoomRotateHandler.prototype.enableRotation=function(){this._rotationDisabled=!1},TouchZoomRotateHandler.prototype._onStart=function(t){if(2===t.touches.length){var e=DOM.mousePos(this._el,t.touches[0]),o=DOM.mousePos(this._el,t.touches[1]);this._startVec=e.sub(o),this._startScale=this._map.transform.scale,this._startBearing=this._map.transform.bearing,this._gestureIntent=void 0,this._inertia=[],window.document.addEventListener("touchmove",this._onMove,!1),window.document.addEventListener("touchend",this._onEnd,!1)}},TouchZoomRotateHandler.prototype._onMove=function(t){if(2===t.touches.length){var e=DOM.mousePos(this._el,t.touches[0]),o=DOM.mousePos(this._el,t.touches[1]),i=e.add(o).div(2),n=e.sub(o),a=n.mag()/this._startVec.mag(),r=this._rotationDisabled?0:180*n.angleWith(this._startVec)/Math.PI,s=this._map;if(this._gestureIntent){var h={duration:0,around:s.unproject(i)};"rotate"===this._gestureIntent&&(h.bearing=this._startBearing+r),"zoom"!==this._gestureIntent&&"rotate"!==this._gestureIntent||(h.zoom=s.transform.scaleZoom(this._startScale*a)),s.stop(),this._drainInertiaBuffer(),this._inertia.push([browser.now(),a,i]),s.easeTo(h,{originalEvent:t})}else{var u=Math.abs(1-a)>.15;Math.abs(r)>10?this._gestureIntent="rotate":u&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._startVec=n,this._startScale=s.transform.scale,this._startBearing=s.transform.bearing)}t.preventDefault()}},TouchZoomRotateHandler.prototype._onEnd=function(t){window.document.removeEventListener("touchmove",this._onMove),window.document.removeEventListener("touchend",this._onEnd),this._drainInertiaBuffer();var e=this._inertia,o=this._map;if(e.length<2)o.snapToNorth({},{originalEvent:t});else{var i=e[e.length-1],n=e[0],a=o.transform.scaleZoom(this._startScale*i[1]),r=o.transform.scaleZoom(this._startScale*n[1]),s=a-r,h=(i[0]-n[0])/1e3,u=i[2];if(0!==h&&a!==r){var l=.15*s/h;Math.abs(l)>2.5&&(l=l>0?2.5:-2.5);var d=1e3*Math.abs(l/(12*.15)),c=a+l*d/2e3;c<0&&(c=0),o.easeTo({zoom:c,duration:d,easing:inertiaEasing,around:this._aroundCenter?o.getCenter():o.unproject(u)},{originalEvent:t})}else o.snapToNorth({},{originalEvent:t})}},TouchZoomRotateHandler.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,e=browser.now();t.length>2&&e-t[0][0]>160;)t.shift()},module.exports=TouchZoomRotateHandler},{"../../util/browser":252,"../../util/dom":259,"../../util/util":275,"../../util/window":254}],246:[function(_dereq_,module,exports){var util=_dereq_("../util/util"),window=_dereq_("../util/window"),throttle=_dereq_("../util/throttle"),Hash=function(){util.bindAll(["_onHashChange","_updateHash"],this),this._updateHash=throttle(this._updateHashUnthrottled.bind(this),300)};Hash.prototype.addTo=function(t){return this._map=t,window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Hash.prototype.remove=function(){return window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),delete this._map,this},Hash.prototype.getHashString=function(t){var e=this._map.getCenter(),h=Math.round(100*this._map.getZoom())/100,a=Math.ceil((h*Math.LN2+Math.log(512/360/.5))/Math.LN10),n=Math.pow(10,a),i=Math.round(e.lng*n)/n,o=Math.round(e.lat*n)/n,s=this._map.getBearing(),r=this._map.getPitch(),u="";return u+=t?"#/"+i+"/"+o+"/"+h:"#"+h+"/"+o+"/"+i,(s||r)&&(u+="/"+Math.round(10*s)/10),r&&(u+="/"+Math.round(r)),u},Hash.prototype._onHashChange=function(){var t=window.location.hash.replace("#","").split("/");return t.length>=3&&(this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:+(t[3]||0),pitch:+(t[4]||0)}),!0)},Hash.prototype._updateHashUnthrottled=function(){var t=this.getHashString();window.history.replaceState("","",t)},module.exports=Hash},{"../util/throttle":272,"../util/util":275,"../util/window":254}],247:[function(_dereq_,module,exports){function removeNode(t){t.parentNode&&t.parentNode.removeChild(t)}var util=_dereq_("../util/util"),browser=_dereq_("../util/browser"),window=_dereq_("../util/window"),ref=_dereq_("../util/window"),HTMLImageElement=ref.HTMLImageElement,HTMLElement=ref.HTMLElement,DOM=_dereq_("../util/dom"),ajax=_dereq_("../util/ajax"),Style=_dereq_("../style/style"),EvaluationParameters=_dereq_("../style/evaluation_parameters"),Painter=_dereq_("../render/painter"),Transform=_dereq_("../geo/transform"),Hash=_dereq_("./hash"),bindHandlers=_dereq_("./bind_handlers"),Camera=_dereq_("./camera"),LngLat=_dereq_("../geo/lng_lat"),LngLatBounds=_dereq_("../geo/lng_lat_bounds"),Point=_dereq_("@mapbox/point-geometry"),AttributionControl=_dereq_("./control/attribution_control"),LogoControl=_dereq_("./control/logo_control"),isSupported=_dereq_("@mapbox/mapbox-gl-supported"),RGBAImage=_dereq_("../util/image").RGBAImage;_dereq_("./events");var defaultOptions={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:22,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,transformRequest:null,fadeDuration:300},Map=function(t){function e(e){if(null!=(e=util.extend({},defaultOptions,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than minZoom");var r=new Transform(e.minZoom,e.maxZoom,e.renderWorldCopies);t.call(this,r,e),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming;var o=e.transformRequest;if(this._transformRequest=o?function(t,e){return o(t,e)||{url:t}}:function(t){return{url:t}},"string"==typeof e.container){var i=window.document.getElementById(e.container);if(!i)throw new Error("Container '"+e.container+"' not found.");this._container=i}else{if(!(e.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}e.maxBounds&&this.setMaxBounds(e.maxBounds),util.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored","_update","_render","_onData","_onDataLoading"],this),this._setupContainer(),this._setupPainter(),this.on("move",this._update.bind(this,!1)),this.on("zoom",this._update.bind(this,!0)),void 0!==window&&(window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1)),bindHandlers(this,e),this._hash=e.hash&&(new Hash).addTo(this),this._hash&&this._hash._onHashChange()||this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),this.resize(),e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new AttributionControl),this.addControl(new LogoControl,e.logoPosition),this.on("style.load",function(){this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",this._onData),this.on("dataloading",this._onDataLoading)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={showTileBoundaries:{},showCollisionBoxes:{},showOverdrawInspector:{},repaint:{},vertices:{}};return e.prototype.addControl=function(t,e){void 0===e&&t.getDefaultPosition&&(e=t.getDefaultPosition()),void 0===e&&(e="top-right");var r=t.onAdd(this),o=this._controlPositions[e];return-1!==e.indexOf("bottom")?o.insertBefore(r,o.firstChild):o.appendChild(r),this},e.prototype.removeControl=function(t){return t.onRemove(this),this},e.prototype.resize=function(){var t=this._containerDimensions(),e=t[0],r=t[1];return this._resizeCanvas(e,r),this.transform.resize(e,r),this.painter.resize(e,r),this.fire("movestart").fire("move").fire("resize").fire("moveend")},e.prototype.getBounds=function(){var t=new LngLatBounds(this.transform.pointLocation(new Point(0,this.transform.height)),this.transform.pointLocation(new Point(this.transform.width,0)));return(this.transform.angle||this.transform.pitch)&&(t.extend(this.transform.pointLocation(new Point(this.transform.size.x,0))),t.extend(this.transform.pointLocation(new Point(0,this.transform.size.y)))),t},e.prototype.getMaxBounds=function(){return this.transform.latRange&&2===this.transform.latRange.length&&this.transform.lngRange&&2===this.transform.lngRange.length?new LngLatBounds([this.transform.lngRange[0],this.transform.latRange[0]],[this.transform.lngRange[1],this.transform.latRange[1]]):null},e.prototype.setMaxBounds=function(t){if(t){var e=LngLatBounds.convert(t);this.transform.lngRange=[e.getWest(),e.getEast()],this.transform.latRange=[e.getSouth(),e.getNorth()],this.transform._constrain(),this._update()}else null!==t&&void 0!==t||(this.transform.lngRange=null,this.transform.latRange=null,this._update());return this},e.prototype.setMinZoom=function(t){if((t=null===t||void 0===t?0:t)>=0&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between 0 and the current maxZoom, inclusive")},e.prototype.getMinZoom=function(){return this.transform.minZoom},e.prototype.setMaxZoom=function(t){if((t=null===t||void 0===t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")},e.prototype.getMaxZoom=function(){return this.transform.maxZoom},e.prototype.project=function(t){return this.transform.locationPoint(LngLat.convert(t))},e.prototype.unproject=function(t){return this.transform.pointLocation(Point.convert(t))},e.prototype.on=function(e,r,o){var i=this;if(void 0===o)return t.prototype.on.call(this,e,r);var n=function(){if("mouseenter"===e||"mouseover"===e){var t=!1;return{layer:r,listener:o,delegates:{mousemove:function(n){var s=i.getLayer(r)?i.queryRenderedFeatures(n.point,{layers:[r]}):[];s.length?t||(t=!0,o.call(i,util.extend({features:s},n,{type:e}))):t=!1},mouseout:function(){t=!1}}}}if("mouseleave"===e||"mouseout"===e){var n=!1;return{layer:r,listener:o,delegates:{mousemove:function(t){(i.getLayer(r)?i.queryRenderedFeatures(t.point,{layers:[r]}):[]).length?n=!0:n&&(n=!1,o.call(i,util.extend({},t,{type:e})))},mouseout:function(t){n&&(n=!1,o.call(i,util.extend({},t,{type:e})))}}}}var a;return{layer:r,listener:o,delegates:(a={},a[e]=function(t){var e=i.getLayer(r)?i.queryRenderedFeatures(t.point,{layers:[r]}):[];e.length&&o.call(i,util.extend({features:e},t))},a)}}();for(var s in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(n),n.delegates)i.on(s,n.delegates[s]);return this},e.prototype.off=function(e,r,o){if(void 0===o)return t.prototype.off.call(this,e,r);if(this._delegatedListeners&&this._delegatedListeners[e])for(var n=this._delegatedListeners[e],s=0;s<n.length;s++){var a=n[s];if(a.layer===r&&a.listener===o){for(var h in a.delegates)this.off(h,a.delegates[h]);return n.splice(s,1),this}}return this},e.prototype.queryRenderedFeatures=function(t,e){return 2===arguments.length?(t=arguments[0],e=arguments[1]):1===arguments.length&&function(t){return t instanceof Point||Array.isArray(t)}(arguments[0])?(t=arguments[0],e={}):1===arguments.length?(t=void 0,e=arguments[0]):(t=void 0,e={}),this.style?this.style.queryRenderedFeatures(this._makeQueryGeometry(t),e,this.transform.zoom,this.transform.angle):[]},e.prototype._makeQueryGeometry=function(t){var r,e=this;if(void 0===t&&(t=[Point.convert([0,0]),Point.convert([this.transform.width,this.transform.height])]),t instanceof Point||"number"==typeof t[0])r=[Point.convert(t)];else{var o=[Point.convert(t[0]),Point.convert(t[1])];r=[o[0],new Point(o[1].x,o[0].y),o[1],new Point(o[0].x,o[1].y),o[0]]}return r.map(function(t){return e.transform.pointCoordinate(t)})},e.prototype.querySourceFeatures=function(t,e){return this.style.querySourceFeatures(t,e)},e.prototype.setStyle=function(t,e){if((!e||!1!==e.diff&&!e.localIdeographFontFamily)&&this.style&&t&&"object"==typeof t)try{return this.style.setState(t)&&this._update(!0),this}catch(t){util.warnOnce("Unable to perform style diff: "+(t.message||t.error||t)+".  Rebuilding the style from scratch.")}return this.style&&(this.style.setEventedParent(null),this.style._remove()),t?(this.style=new Style(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t):this.style.loadJSON(t),this):(delete this.style,this)},e.prototype.getStyle=function(){if(this.style)return this.style.serialize()},e.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():util.warnOnce("There is no style added to the map.")},e.prototype.addSource=function(t,e){return this.style.addSource(t,e),this._update(!0),this},e.prototype.isSourceLoaded=function(t){var e=this.style&&this.style.sourceCaches[t];return void 0===e?void this.fire("error",{error:new Error("There is no source with ID '"+t+"'")}):e.loaded()},e.prototype.areTilesLoaded=function(){var t=this.style&&this.style.sourceCaches;for(var e in t){var o=t[e]._tiles;for(var i in o){var n=o[i];if("loaded"!==n.state&&"errored"!==n.state)return!1}}return!0},e.prototype.addSourceType=function(t,e,r){return this.style.addSourceType(t,e,r)},e.prototype.removeSource=function(t){return this.style.removeSource(t),this._update(!0),this},e.prototype.getSource=function(t){return this.style.getSource(t)},e.prototype.addImage=function(t,e,r){void 0===r&&(r={});var o=r.pixelRatio;void 0===o&&(o=1);var i=r.sdf;if(void 0===i&&(i=!1),e instanceof HTMLImageElement){var n=browser.getImageData(e),s=n.width,a=n.height,h=n.data;this.style.addImage(t,{data:new RGBAImage({width:s,height:a},h),pixelRatio:o,sdf:i})}else{if(void 0===e.width||void 0===e.height)return this.fire("error",{error:new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")});var l=e.width,u=e.height,d=e.data;this.style.addImage(t,{data:new RGBAImage({width:l,height:u},d.slice(0)),pixelRatio:o,sdf:i})}},e.prototype.hasImage=function(t){return t?!!this.style.getImage(t):(this.fire("error",{error:new Error("Missing required image id")}),!1)},e.prototype.removeImage=function(t){this.style.removeImage(t)},e.prototype.loadImage=function(t,e){ajax.getImage(this._transformRequest(t,ajax.ResourceType.Image),e)},e.prototype.addLayer=function(t,e){return this.style.addLayer(t,e),this._update(!0),this},e.prototype.moveLayer=function(t,e){return this.style.moveLayer(t,e),this._update(!0),this},e.prototype.removeLayer=function(t){return this.style.removeLayer(t),this._update(!0),this},e.prototype.getLayer=function(t){return this.style.getLayer(t)},e.prototype.setFilter=function(t,e){return this.style.setFilter(t,e),this._update(!0),this},e.prototype.setLayerZoomRange=function(t,e,r){return this.style.setLayerZoomRange(t,e,r),this._update(!0),this},e.prototype.getFilter=function(t){return this.style.getFilter(t)},e.prototype.setPaintProperty=function(t,e,r){return this.style.setPaintProperty(t,e,r),this._update(!0),this},e.prototype.getPaintProperty=function(t,e){return this.style.getPaintProperty(t,e)},e.prototype.setLayoutProperty=function(t,e,r){return this.style.setLayoutProperty(t,e,r),this._update(!0),this},e.prototype.getLayoutProperty=function(t,e){return this.style.getLayoutProperty(t,e)},e.prototype.setLight=function(t){return this.style.setLight(t),this._update(!0),this},e.prototype.getLight=function(){return this.style.getLight()},e.prototype.getContainer=function(){return this._container},e.prototype.getCanvasContainer=function(){return this._canvasContainer},e.prototype.getCanvas=function(){return this._canvas},e.prototype._containerDimensions=function(){var t=0,e=0;return this._container&&(t=this._container.offsetWidth||400,e=this._container.offsetHeight||300),[t,e]},e.prototype._setupContainer=function(){var t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSContainer=DOM.create("div","mapboxgl-missing-css",t)).innerHTML="Missing Mapbox GL JS CSS";var e=this._canvasContainer=DOM.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=DOM.create("canvas","mapboxgl-canvas",e),this._canvas.style.position="absolute",this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var r=this._containerDimensions();this._resizeCanvas(r[0],r[1]);var o=this._controlContainer=DOM.create("div","mapboxgl-control-container",t),i=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(t){i[t]=DOM.create("div","mapboxgl-ctrl-"+t,o)})},e.prototype._resizeCanvas=function(t,e){var r=window.devicePixelRatio||1;this._canvas.width=r*t,this._canvas.height=r*e,this._canvas.style.width=t+"px",this._canvas.style.height=e+"px"},e.prototype._setupPainter=function(){var t=util.extend({failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer},isSupported.webGLContextAttributes),e=this._canvas.getContext("webgl",t)||this._canvas.getContext("experimental-webgl",t);e?this.painter=new Painter(e,this.transform):this.fire("error",{error:new Error("Failed to initialize WebGL")})},e.prototype._contextLost=function(t){t.preventDefault(),this._frameId&&(browser.cancelFrame(this._frameId),this._frameId=null),this.fire("webglcontextlost",{originalEvent:t})},e.prototype._contextRestored=function(t){this._setupPainter(),this.resize(),this._update(),this.fire("webglcontextrestored",{originalEvent:t})},e.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!(!this.style||!this.style.loaded())},e.prototype._update=function(t){this.style&&(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this._rerender())},e.prototype._render=function(){this._updateCamera();var t=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var e=this.transform.zoom,r=browser.now();this.style.zoomHistory.update(e,r);var o=new EvaluationParameters(e,{now:r,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),i=o.crossFadingFactor();1===i&&i===this._crossFadingFactor||(t=!0,this._crossFadingFactor=i),this.style.update(o)}return this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.rotating,zooming:this.zooming,fadeDuration:this._fadeDuration}),this.fire("render"),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire("load")),this.style&&(this.style.hasTransitions()||t)&&(this._styleDirty=!0),(this._sourcesDirty||this._repaint||this._styleDirty||this._placementDirty)&&this._rerender(),this},e.prototype.remove=function(){this._hash&&this._hash.remove(),browser.cancelFrame(this._frameId),this._frameId=null,this.setStyle(null),void 0!==window&&(window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1));var t=this.painter.context.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),removeNode(this._canvasContainer),removeNode(this._controlContainer),removeNode(this._missingCSSContainer),this._container.classList.remove("mapboxgl-map"),this.fire("remove")},e.prototype._rerender=function(){var t=this;this.style&&!this._frameId&&(this._frameId=browser.frame(function(){t._frameId=null,t._render()}))},e.prototype._onWindowOnline=function(){this._update()},e.prototype._onWindowResize=function(){this._trackResize&&this.stop().resize()._update()},r.showTileBoundaries.get=function(){return!!this._showTileBoundaries},r.showTileBoundaries.set=function(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())},r.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},r.showCollisionBoxes.set=function(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())},r.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},r.showOverdrawInspector.set=function(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())},r.repaint.get=function(){return!!this._repaint},r.repaint.set=function(t){this._repaint=t,this._update()},r.vertices.get=function(){return!!this._vertices},r.vertices.set=function(t){this._vertices=t,this._update()},e.prototype._onData=function(t){this._update("style"===t.dataType),this.fire(t.dataType+"data",t)},e.prototype._onDataLoading=function(t){this.fire(t.dataType+"dataloading",t)},Object.defineProperties(e.prototype,r),e}(Camera);module.exports=Map},{"../geo/lng_lat":62,"../geo/lng_lat_bounds":63,"../geo/transform":64,"../render/painter":90,"../style/evaluation_parameters":182,"../style/style":190,"../util/ajax":251,"../util/browser":252,"../util/dom":259,"../util/image":263,"../util/util":275,"../util/window":254,"./bind_handlers":230,"./camera":231,"./control/attribution_control":232,"./control/logo_control":235,"./events":238,"./hash":246,"@mapbox/mapbox-gl-supported":3,"@mapbox/point-geometry":4}],248:[function(_dereq_,module,exports){var DOM=_dereq_("../util/dom"),LngLat=_dereq_("../geo/lng_lat"),Point=_dereq_("@mapbox/point-geometry"),smartWrap=_dereq_("../util/smart_wrap"),bindAll=_dereq_("../util/util").bindAll,Marker=function(t,e){if(bindAll(["_update","_onMapClick"],this),!t){t=DOM.create("div");var r=DOM.createNS("http://www.w3.org/2000/svg","svg");r.setAttributeNS(null,"height","41px"),r.setAttributeNS(null,"width","27px"),r.setAttributeNS(null,"viewBox","0 0 27 41");var i=DOM.createNS("http://www.w3.org/2000/svg","g");i.setAttributeNS(null,"stroke","none"),i.setAttributeNS(null,"stroke-width","1"),i.setAttributeNS(null,"fill","none"),i.setAttributeNS(null,"fill-rule","evenodd");var s=DOM.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"fill-rule","nonzero");var p=DOM.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"transform","translate(3.0, 29.0)"),p.setAttributeNS(null,"fill","#000000");for(var l=0,o=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];l<o.length;l+=1){var a=o[l],u=DOM.createNS("http://www.w3.org/2000/svg","ellipse");u.setAttributeNS(null,"opacity","0.04"),u.setAttributeNS(null,"cx","10.5"),u.setAttributeNS(null,"cy","5.80029008"),u.setAttributeNS(null,"rx",a.rx),u.setAttributeNS(null,"ry",a.ry),p.appendChild(u)}var h=DOM.createNS("http://www.w3.org/2000/svg","g");h.setAttributeNS(null,"fill","#3FB1CE");var _=DOM.createNS("http://www.w3.org/2000/svg","path");_.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),h.appendChild(_);var g=DOM.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"fill","#000000");var f=DOM.createNS("http://www.w3.org/2000/svg","path");f.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),g.appendChild(f);var d=DOM.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"transform","translate(6.0, 7.0)"),d.setAttributeNS(null,"fill","#FFFFFF");var w=DOM.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"transform","translate(8.0, 8.0)");var c=DOM.createNS("http://www.w3.org/2000/svg","circle");c.setAttributeNS(null,"fill","#000000"),c.setAttributeNS(null,"opacity","0.25"),c.setAttributeNS(null,"cx","5.5"),c.setAttributeNS(null,"cy","5.5"),c.setAttributeNS(null,"r","5.4999962");var v=DOM.createNS("http://www.w3.org/2000/svg","circle");v.setAttributeNS(null,"fill","#FFFFFF"),v.setAttributeNS(null,"cx","5.5"),v.setAttributeNS(null,"cy","5.5"),v.setAttributeNS(null,"r","5.4999962"),w.appendChild(c),w.appendChild(v),s.appendChild(p),s.appendChild(h),s.appendChild(g),s.appendChild(d),s.appendChild(w),r.appendChild(s),t.appendChild(r);var m=[0,-14];e&&e.offset||(e?e.offset=m:e={offset:m})}this._offset=Point.convert(e&&e.offset||[0,0]),t.classList.add("mapboxgl-marker"),this._element=t,this._popup=null};Marker.prototype.addTo=function(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this._update(),this._map.on("click",this._onMapClick),this},Marker.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),delete this._map),DOM.remove(this._element),this._popup&&this._popup.remove(),this},Marker.prototype.getLngLat=function(){return this._lngLat},Marker.prototype.setLngLat=function(t){return this._lngLat=LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},Marker.prototype.getElement=function(){return this._element},Marker.prototype.setPopup=function(t){return this._popup&&(this._popup.remove(),this._popup=null),t&&("offset"in t.options||(t.options.offset=this._offset),this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat)),this},Marker.prototype._onMapClick=function(t){var e=t.originalEvent.target,r=this._element;this._popup&&(e===r||r.contains(e))&&this.togglePopup()},Marker.prototype.getPopup=function(){return this._popup},Marker.prototype.togglePopup=function(){var t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this},Marker.prototype._update=function(t){this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=smartWrap(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset),t&&"moveend"!==t.type||(this._pos=this._pos.round()),DOM.setTransform(this._element,"translate(-50%, -50%) translate("+this._pos.x+"px, "+this._pos.y+"px)"))},Marker.prototype.getOffset=function(){return this._offset},Marker.prototype.setOffset=function(t){return this._offset=Point.convert(t),this._update(),this},module.exports=Marker},{"../geo/lng_lat":62,"../util/dom":259,"../util/smart_wrap":270,"../util/util":275,"@mapbox/point-geometry":4}],249:[function(_dereq_,module,exports){var util=_dereq_("../util/util"),Evented=_dereq_("../util/evented"),DOM=_dereq_("../util/dom"),LngLat=_dereq_("../geo/lng_lat"),Point=_dereq_("@mapbox/point-geometry"),window=_dereq_("../util/window"),smartWrap=_dereq_("../util/smart_wrap"),defaultOptions={closeButton:!0,closeOnClick:!0},Popup=function(t){function o(o){t.call(this),this.options=util.extend(Object.create(defaultOptions),o),util.bindAll(["_update","_onClickClose"],this)}return t&&(o.__proto__=t),o.prototype=Object.create(t&&t.prototype),o.prototype.constructor=o,o.prototype.addTo=function(t){return this._map=t,this._map.on("move",this._update),this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._update(),this},o.prototype.isOpen=function(){return!!this._map},o.prototype.remove=function(){return this._content&&DOM.remove(this._content),this._container&&(DOM.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),delete this._map),this.fire("close"),this},o.prototype.getLngLat=function(){return this._lngLat},o.prototype.setLngLat=function(t){return this._lngLat=LngLat.convert(t),this._pos=null,this._update(),this},o.prototype.setText=function(t){return this.setDOMContent(window.document.createTextNode(t))},o.prototype.setHTML=function(t){var o,e=window.document.createDocumentFragment(),n=window.document.createElement("body");for(n.innerHTML=t;o=n.firstChild;)e.appendChild(o);return this.setDOMContent(e)},o.prototype.setDOMContent=function(t){return this._createContent(),this._content.appendChild(t),this._update(),this},o.prototype._createContent=function(){this._content&&DOM.remove(this._content),this._content=DOM.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=DOM.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))},o.prototype._update=function(){if(this._map&&this._lngLat&&this._content){this._container||(this._container=DOM.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=DOM.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content)),this._map.transform.renderWorldCopies&&(this._lngLat=smartWrap(this._lngLat,this._pos,this._map.transform));var t=this._pos=this._map.project(this._lngLat),o=this.options.anchor,e=function normalizeOffset(t){if(t){if("number"==typeof t){var o=Math.round(Math.sqrt(.5*Math.pow(t,2)));return{top:new Point(0,t),"top-left":new Point(o,o),"top-right":new Point(-o,o),bottom:new Point(0,-t),"bottom-left":new Point(o,-o),"bottom-right":new Point(-o,-o),left:new Point(t,0),right:new Point(-t,0)}}if(t instanceof Point||Array.isArray(t)){var e=Point.convert(t);return{top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{top:Point.convert(t.top||[0,0]),"top-left":Point.convert(t["top-left"]||[0,0]),"top-right":Point.convert(t["top-right"]||[0,0]),bottom:Point.convert(t.bottom||[0,0]),"bottom-left":Point.convert(t["bottom-left"]||[0,0]),"bottom-right":Point.convert(t["bottom-right"]||[0,0]),left:Point.convert(t.left||[0,0]),right:Point.convert(t.right||[0,0])}}return normalizeOffset(new Point(0,0))}(this.options.offset);if(!o){var n=this._container.offsetWidth,i=this._container.offsetHeight;o=t.y+e.bottom.y<i?["top"]:t.y>this._map.transform.height-i?["bottom"]:[],t.x<n/2?o.push("left"):t.x>this._map.transform.width-n/2&&o.push("right"),o=0===o.length?"bottom":o.join("-")}var r=t.add(e[o]).round(),s={top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},p=this._container.classList;for(var a in s)p.remove("mapboxgl-popup-anchor-"+a);p.add("mapboxgl-popup-anchor-"+o),DOM.setTransform(this._container,s[o]+" translate("+r.x+"px,"+r.y+"px)")}},o.prototype._onClickClose=function(){this.remove()},o}(Evented);module.exports=Popup},{"../geo/lng_lat":62,"../util/dom":259,"../util/evented":260,"../util/smart_wrap":270,"../util/util":275,"../util/window":254,"@mapbox/point-geometry":4}],250:[function(_dereq_,module,exports){var util=_dereq_("./util"),ref=_dereq_("./web_worker_transfer"),serialize=ref.serialize,deserialize=ref.deserialize,Actor=function(e,t,r){this.target=e,this.parent=t,this.mapId=r,this.callbacks={},this.callbackID=0,util.bindAll(["receive"],this),this.target.addEventListener("message",this.receive,!1)};Actor.prototype.send=function(e,t,r,i){var a=r?this.mapId+":"+this.callbackID++:null;r&&(this.callbacks[a]=r);var s=[];this.target.postMessage({targetMapId:i,sourceMapId:this.mapId,type:e,id:String(a),data:serialize(t,s)},s)},Actor.prototype.receive=function(e){var t,r=this,i=e.data,a=i.id;if(!i.targetMapId||this.mapId===i.targetMapId){var s=function(e,t){var i=[];r.target.postMessage({sourceMapId:r.mapId,type:"<response>",id:String(a),error:e?String(e):null,data:serialize(t,i)},i)};if("<response>"===i.type)t=this.callbacks[i.id],delete this.callbacks[i.id],t&&i.error?t(new Error(i.error)):t&&t(null,deserialize(i.data));else if(void 0!==i.id&&this.parent[i.type])this.parent[i.type](i.sourceMapId,deserialize(i.data),s);else if(void 0!==i.id&&this.parent.getWorkerSource){var d=i.type.split(".");this.parent.getWorkerSource(i.sourceMapId,d[0])[d[1]](deserialize(i.data),s)}else this.parent[i.type](deserialize(i.data))}},Actor.prototype.remove=function(){this.target.removeEventListener("message",this.receive,!1)},module.exports=Actor},{"./util":275,"./web_worker_transfer":278}],251:[function(_dereq_,module,exports){function makeRequest(e){var t=new window.XMLHttpRequest;for(var r in t.open("GET",e.url,!0),e.headers)t.setRequestHeader(r,e.headers[r]);return t.withCredentials="include"===e.credentials,t}function sameOrigin(e){var t=window.document.createElement("a");return t.href=e,t.protocol===window.document.location.protocol&&t.host===window.document.location.host}var window=_dereq_("./window"),ResourceType={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};exports.ResourceType=ResourceType,"function"==typeof Object.freeze&&Object.freeze(ResourceType);var AJAXError=function(e){function t(t,r){e.call(this,t),this.status=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error);exports.getJSON=function(e,t){var r=makeRequest(e);return r.setRequestHeader("Accept","application/json"),r.onerror=function(){t(new Error(r.statusText))},r.onload=function(){if(r.status>=200&&r.status<300&&r.response){var e;try{e=JSON.parse(r.response)}catch(e){return t(e)}t(null,e)}else t(new AJAXError(r.statusText,r.status))},r.send(),r},exports.getArrayBuffer=function(e,t){var r=makeRequest(e);return r.responseType="arraybuffer",r.onerror=function(){t(new Error(r.statusText))},r.onload=function(){var e=r.response;if(0===e.byteLength&&200===r.status)return t(new Error("http status 200 returned without content."));r.status>=200&&r.status<300&&r.response?t(null,{data:e,cacheControl:r.getResponseHeader("Cache-Control"),expires:r.getResponseHeader("Expires")}):t(new AJAXError(r.statusText,r.status))},r.send(),r};exports.getImage=function(e,t){return exports.getArrayBuffer(e,function(e,r){if(e)t(e);else if(r){var n=new window.Image,o=window.URL||window.webkitURL;n.onload=function(){t(null,n),o.revokeObjectURL(n.src)};var s=new window.Blob([new Uint8Array(r.data)],{type:"image/png"});n.cacheControl=r.cacheControl,n.expires=r.expires,n.src=r.data.byteLength?o.createObjectURL(s):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}})},exports.getVideo=function(e,t){var r=window.document.createElement("video");r.onloadstart=function(){t(null,r)};for(var n=0;n<e.length;n++){var o=window.document.createElement("source");sameOrigin(e[n])||(r.crossOrigin="Anonymous"),o.src=e[n],r.appendChild(o)}return r}},{"./window":254}],252:[function(_dereq_,module,exports){var window=_dereq_("./window"),now=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now.bind(Date),frame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,cancel=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame;module.exports={now:now,frame:function(e){return frame(e)},cancelFrame:function(e){return cancel(e)},getImageData:function(e){var n=window.document.createElement("canvas"),t=n.getContext("2d");if(!t)throw new Error("failed to create canvas 2d context");return n.width=e.width,n.height=e.height,t.drawImage(e,0,0,e.width,e.height),t.getImageData(0,0,e.width,e.height)},hardwareConcurrency:window.navigator.hardwareConcurrency||4,get devicePixelRatio(){return window.devicePixelRatio},supportsWebp:!1};var webpImgTest=window.document.createElement("img");webpImgTest.onload=function(){module.exports.supportsWebp=!0},webpImgTest.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="},{"./window":254}],253:[function(_dereq_,module,exports){var WebWorkify=_dereq_("webworkify"),window=_dereq_("../window"),workerURL=window.URL.createObjectURL(new WebWorkify(_dereq_("../../source/worker"),{bare:!0}));module.exports=function(){return new window.Worker(workerURL)}},{"../../source/worker":118,"../window":254,webworkify:36}],254:[function(_dereq_,module,exports){module.exports=self},{}],255:[function(_dereq_,module,exports){function compareAreas(e,r){return r.area-e.area}var quickselect=_dereq_("quickselect"),calculateSignedArea=_dereq_("./util").calculateSignedArea;module.exports=function(e,r){var a=e.length;if(a<=1)return[e];for(var t,u,c=[],i=0;i<a;i++){var l=calculateSignedArea(e[i]);0!==l&&(e[i].area=Math.abs(l),void 0===u&&(u=l<0),u===l<0?(t&&c.push(t),t=[e[i]]):t.push(e[i]))}if(t&&c.push(t),r>1)for(var n=0;n<c.length;n++)c[n].length<=r||(quickselect(c[n],r,1,c[n].length-1,compareAreas),c[n]=c[n].slice(0,r));return c}},{"./util":275,quickselect:31}],256:[function(_dereq_,module,exports){module.exports={API_URL:"https://api.mapbox.com",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null}},{}],257:[function(_dereq_,module,exports){var DictionaryCoder=function(r){this._stringToNumber={},this._numberToString=[];for(var o=0;o<r.length;o++){var i=r[o];this._stringToNumber[i]=o,this._numberToString[o]=i}};DictionaryCoder.prototype.encode=function(r){return this._stringToNumber[r]},DictionaryCoder.prototype.decode=function(r){return this._numberToString[r]},module.exports=DictionaryCoder},{}],258:[function(_dereq_,module,exports){var util=_dereq_("./util"),Actor=_dereq_("./actor"),Dispatcher=function(t,r){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=util.uniqueId();for(var i=this.workerPool.acquire(this.id),e=0;e<i.length;e++){var s=i[e],c=new Actor(s,r,this.id);c.name="Worker "+e,this.actors.push(c)}};Dispatcher.prototype.broadcast=function(t,r,o){o=o||function(){},util.asyncAll(this.actors,function(o,i){o.send(t,r,i)},o)},Dispatcher.prototype.send=function(t,r,o,i){return("number"!=typeof i||isNaN(i))&&(i=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[i].send(t,r,o),i},Dispatcher.prototype.remove=function(){this.actors.forEach(function(t){t.remove()}),this.actors=[],this.workerPool.release(this.id)},module.exports=Dispatcher},{"./actor":250,"./util":275}],259:[function(_dereq_,module,exports){function testProp(e){for(var t=0;t<e.length;t++)if(e[t]in docStyle)return e[t];return e[0]}var Point=_dereq_("@mapbox/point-geometry"),window=_dereq_("./window");exports.create=function(e,t,n){var o=window.document.createElement(e);return t&&(o.className=t),n&&n.appendChild(o),o},exports.createNS=function(e,t){return window.document.createElementNS(e,t)};var userSelect,docStyle=window.document.documentElement.style,selectProp=testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);exports.disableDrag=function(){selectProp&&(userSelect=docStyle[selectProp],docStyle[selectProp]="none")},exports.enableDrag=function(){selectProp&&(docStyle[selectProp]=userSelect)};var transformProp=testProp(["transform","WebkitTransform"]);exports.setTransform=function(e,t){e.style[transformProp]=t};var suppressClick=function(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",suppressClick,!0)};exports.suppressClick=function(){window.addEventListener("click",suppressClick,!0),window.setTimeout(function(){window.removeEventListener("click",suppressClick,!0)},0)},exports.mousePos=function(e,t){var n=e.getBoundingClientRect();return t=t.touches?t.touches[0]:t,new Point(t.clientX-n.left-e.clientLeft,t.clientY-n.top-e.clientTop)},exports.touchPos=function(e,t){for(var n=e.getBoundingClientRect(),o=[],r="touchend"===t.type?t.changedTouches:t.touches,c=0;c<r.length;c++)o.push(new Point(r[c].clientX-n.left-e.clientLeft,r[c].clientY-n.top-e.clientTop));return o},exports.remove=function(e){e.parentNode&&e.parentNode.removeChild(e)}},{"./window":254,"@mapbox/point-geometry":4}],260:[function(_dereq_,module,exports){function _addEventListener(e,t,n){n[e]=n[e]||[],n[e].push(t)}function _removeEventListener(e,t,n){if(n&&n[e]){var i=n[e].indexOf(t);-1!==i&&n[e].splice(i,1)}}var util=_dereq_("./util"),Evented=function(){};Evented.prototype.on=function(e,t){return this._listeners=this._listeners||{},_addEventListener(e,t,this._listeners),this},Evented.prototype.off=function(e,t){return _removeEventListener(e,t,this._listeners),_removeEventListener(e,t,this._oneTimeListeners),this},Evented.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},_addEventListener(e,t,this._oneTimeListeners),this},Evented.prototype.fire=function(e,t){var n=this;if(this.listens(e)){t=util.extend({},t,{type:e,target:this});for(var s=0,r=this._listeners&&this._listeners[e]?this._listeners[e].slice():[];s<r.length;s+=1)r[s].call(n,t);for(var h=0,_=this._oneTimeListeners&&this._oneTimeListeners[e]?this._oneTimeListeners[e].slice():[];h<_.length;h+=1){var v=_[h];_removeEventListener(e,v,n._oneTimeListeners),v.call(n,t)}this._eventedParent&&this._eventedParent.fire(e,util.extend({},t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData))}else util.endsWith(e,"error")&&console.error(t&&t.error||t||"Empty error event");return this},Evented.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},Evented.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this},module.exports=Evented},{"./util":275}],261:[function(_dereq_,module,exports){function compareMax(e,t){return t.max-e.max}function Cell(e,t,n,o){this.p=new Point(e,t),this.h=n,this.d=function pointToPolygonDist(e,t){for(var n=!1,o=1/0,r=0;r<t.length;r++)for(var i=t[r],l=0,u=i.length,a=u-1;l<u;a=l++){var s=i[l],p=i[a];s.y>e.y!=p.y>e.y&&e.x<(p.x-s.x)*(e.y-s.y)/(p.y-s.y)+s.x&&(n=!n),o=Math.min(o,distToSegmentSquared(e,s,p))}return(n?1:-1)*Math.sqrt(o)}(this.p,o),this.max=this.d+this.h*Math.SQRT2}var Queue=_dereq_("tinyqueue"),Point=_dereq_("@mapbox/point-geometry"),distToSegmentSquared=_dereq_("./intersection_tests").distToSegmentSquared;module.exports=function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=!1);for(var o=1/0,r=1/0,i=-1/0,l=-1/0,u=e[0],a=0;a<u.length;a++){var s=u[a];(!a||s.x<o)&&(o=s.x),(!a||s.y<r)&&(r=s.y),(!a||s.x>i)&&(i=s.x),(!a||s.y>l)&&(l=s.y)}var p=i-o,h=l-r,d=Math.min(p,h),x=d/2,y=new Queue(null,compareMax);if(0===d)return new Point(o,r);for(var g=o;g<i;g+=d)for(var f=r;f<l;f+=d)y.push(new Cell(g+x,f+x,x,e));for(var m=function getCentroidCell(e){for(var t=0,n=0,o=0,r=e[0],i=0,l=r.length,u=l-1;i<l;u=i++){var a=r[i],s=r[u],p=a.x*s.y-s.x*a.y;n+=(a.x+s.x)*p,o+=(a.y+s.y)*p,t+=3*p}return new Cell(n/t,o/t,0,e)}(e),v=y.length;y.length;){var c=y.pop();(c.d>m.d||!m.d)&&(m=c,n&&console.log("found best %d after %d probes",Math.round(1e4*c.d)/1e4,v)),c.max-m.d<=t||(x=c.h/2,y.push(new Cell(c.p.x-x,c.p.y-x,x,e)),y.push(new Cell(c.p.x+x,c.p.y-x,x,e)),y.push(new Cell(c.p.x-x,c.p.y+x,x,e)),y.push(new Cell(c.p.x+x,c.p.y+x,x,e)),v+=4)}return n&&(console.log("num probes: "+v),console.log("best distance: "+m.d)),m.p}},{"./intersection_tests":264,"@mapbox/point-geometry":4,tinyqueue:33}],262:[function(_dereq_,module,exports){var globalWorkerPool,WorkerPool=_dereq_("./worker_pool");module.exports=function(){return globalWorkerPool||(globalWorkerPool=new WorkerPool),globalWorkerPool}},{"./worker_pool":279}],263:[function(_dereq_,module,exports){function createImage(e,t,i,h){var a=t.width,r=t.height;if(h){if(h.length!==a*r*i)throw new RangeError("mismatched image size")}else h=new Uint8Array(a*r*i);return e.width=a,e.height=r,e.data=h,e}function resizeImage(e,t,i){var h=t.width,a=t.height;if(h!==e.width||a!==e.height){var r=createImage({},{width:h,height:a},i);copyImage(e,r,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,h),height:Math.min(e.height,a)},i),e.width=h,e.height=a,e.data=r.data}}function copyImage(e,t,i,h,a,r){if(0===a.width||0===a.height)return t;if(a.width>e.width||a.height>e.height||i.x>e.width-a.width||i.y>e.height-a.height)throw new RangeError("out of range source coordinates for image copy");if(a.width>t.width||a.height>t.height||h.x>t.width-a.width||h.y>t.height-a.height)throw new RangeError("out of range destination coordinates for image copy");for(var g=e.data,n=t.data,o=0;o<a.height;o++)for(var m=((i.y+o)*e.width+i.x)*r,w=((h.y+o)*t.width+h.x)*r,d=0;d<a.width*r;d++)n[w+d]=g[m+d];return t}var register=_dereq_("./web_worker_transfer").register,AlphaImage=function(e,t){createImage(this,e,1,t)};AlphaImage.prototype.resize=function(e){resizeImage(this,e,1)},AlphaImage.prototype.clone=function(){return new AlphaImage({width:this.width,height:this.height},new Uint8Array(this.data))},AlphaImage.copy=function(e,t,i,h,a){copyImage(e,t,i,h,a,1)};var RGBAImage=function(e,t){createImage(this,e,4,t)};RGBAImage.prototype.resize=function(e){resizeImage(this,e,4)},RGBAImage.prototype.clone=function(){return new RGBAImage({width:this.width,height:this.height},new Uint8Array(this.data))},RGBAImage.copy=function(e,t,i,h,a){copyImage(e,t,i,h,a,4)},register("AlphaImage",AlphaImage),register("RGBAImage",RGBAImage),module.exports={AlphaImage:AlphaImage,RGBAImage:RGBAImage}},{"./web_worker_transfer":278}],264:[function(_dereq_,module,exports){function lineIntersectsBufferedLine(n,t,e){if(n.length>1){if(lineIntersectsLine(n,t))return!0;for(var r=0;r<t.length;r++)if(pointIntersectsBufferedLine(t[r],n,e))return!0}for(var o=0;o<n.length;o++)if(pointIntersectsBufferedLine(n[o],t,e))return!0;return!1}function lineIntersectsLine(n,t){if(0===n.length||0===t.length)return!1;for(var e=0;e<n.length-1;e++)for(var r=n[e],o=n[e+1],i=0;i<t.length-1;i++){if(lineSegmentIntersectsLineSegment(r,o,t[i],t[i+1]))return!0}return!1}function lineSegmentIntersectsLineSegment(n,t,e,r){return isCounterClockwise(n,e,r)!==isCounterClockwise(t,e,r)&&isCounterClockwise(n,t,e)!==isCounterClockwise(n,t,r)}function pointIntersectsBufferedLine(n,t,e){var r=e*e;if(1===t.length)return n.distSqr(t[0])<r;for(var o=1;o<t.length;o++)if(distToSegmentSquared(n,t[o-1],t[o])<r)return!0;return!1}function distToSegmentSquared(n,t,e){var r=t.distSqr(e);if(0===r)return n.distSqr(t);var o=((n.x-t.x)*(e.x-t.x)+(n.y-t.y)*(e.y-t.y))/r;return o<0?n.distSqr(t):o>1?n.distSqr(e):n.distSqr(e.sub(t)._mult(o)._add(t))}function multiPolygonContainsPoint(n,t){for(var e,r,o,i=!1,l=0;l<n.length;l++)for(var u=0,s=(e=n[l]).length-1;u<e.length;s=u++)r=e[u],o=e[s],r.y>t.y!=o.y>t.y&&t.x<(o.x-r.x)*(t.y-r.y)/(o.y-r.y)+r.x&&(i=!i);return i}function polygonContainsPoint(n,t){for(var e=!1,r=0,o=n.length-1;r<n.length;o=r++){var i=n[r],l=n[o];i.y>t.y!=l.y>t.y&&t.x<(l.x-i.x)*(t.y-i.y)/(l.y-i.y)+i.x&&(e=!e)}return e}var isCounterClockwise=_dereq_("./util").isCounterClockwise;module.exports={multiPolygonIntersectsBufferedMultiPoint:function multiPolygonIntersectsBufferedMultiPoint(n,t,e){for(var r=0;r<n.length;r++)for(var o=n[r],i=0;i<t.length;i++)for(var l=t[i],u=0;u<l.length;u++){var s=l[u];if(polygonContainsPoint(o,s))return!0;if(pointIntersectsBufferedLine(s,o,e))return!0}return!1},multiPolygonIntersectsMultiPolygon:function multiPolygonIntersectsMultiPolygon(n,t){if(1===n.length&&1===n[0].length)return multiPolygonContainsPoint(t,n[0][0]);for(var e=0;e<t.length;e++)for(var r=t[e],o=0;o<r.length;o++)if(multiPolygonContainsPoint(n,r[o]))return!0;for(var i=0;i<n.length;i++){for(var l=n[i],u=0;u<l.length;u++)if(multiPolygonContainsPoint(t,l[u]))return!0;for(var s=0;s<t.length;s++)if(lineIntersectsLine(l,t[s]))return!0}return!1},multiPolygonIntersectsBufferedMultiLine:function multiPolygonIntersectsBufferedMultiLine(n,t,e){for(var r=0;r<t.length;r++)for(var o=t[r],i=0;i<n.length;i++){var l=n[i];if(l.length>=3)for(var u=0;u<o.length;u++)if(polygonContainsPoint(l,o[u]))return!0;if(lineIntersectsBufferedLine(l,o,e))return!0}return!1},polygonIntersectsPolygon:function polygonIntersectsPolygon(n,t){for(var e=0;e<n.length;e++)if(polygonContainsPoint(t,n[e]))return!0;for(var r=0;r<t.length;r++)if(polygonContainsPoint(n,t[r]))return!0;return!!lineIntersectsLine(n,t)},distToSegmentSquared:distToSegmentSquared}},{"./util":275}],265:[function(_dereq_,module,exports){module.exports={"Latin-1 Supplement":function(n){return n>=128&&n<=255},Arabic:function(n){return n>=1536&&n<=1791},"Arabic Supplement":function(n){return n>=1872&&n<=1919},"Arabic Extended-A":function(n){return n>=2208&&n<=2303},"Hangul Jamo":function(n){return n>=4352&&n<=4607},"Unified Canadian Aboriginal Syllabics":function(n){return n>=5120&&n<=5759},"Unified Canadian Aboriginal Syllabics Extended":function(n){return n>=6320&&n<=6399},"General Punctuation":function(n){return n>=8192&&n<=8303},"Letterlike Symbols":function(n){return n>=8448&&n<=8527},"Number Forms":function(n){return n>=8528&&n<=8591},"Miscellaneous Technical":function(n){return n>=8960&&n<=9215},"Control Pictures":function(n){return n>=9216&&n<=9279},"Optical Character Recognition":function(n){return n>=9280&&n<=9311},"Enclosed Alphanumerics":function(n){return n>=9312&&n<=9471},"Geometric Shapes":function(n){return n>=9632&&n<=9727},"Miscellaneous Symbols":function(n){return n>=9728&&n<=9983},"Miscellaneous Symbols and Arrows":function(n){return n>=11008&&n<=11263},"CJK Radicals Supplement":function(n){return n>=11904&&n<=12031},"Kangxi Radicals":function(n){return n>=12032&&n<=12255},"Ideographic Description Characters":function(n){return n>=12272&&n<=12287},"CJK Symbols and Punctuation":function(n){return n>=12288&&n<=12351},Hiragana:function(n){return n>=12352&&n<=12447},Katakana:function(n){return n>=12448&&n<=12543},Bopomofo:function(n){return n>=12544&&n<=12591},"Hangul Compatibility Jamo":function(n){return n>=12592&&n<=12687},Kanbun:function(n){return n>=12688&&n<=12703},"Bopomofo Extended":function(n){return n>=12704&&n<=12735},"CJK Strokes":function(n){return n>=12736&&n<=12783},"Katakana Phonetic Extensions":function(n){return n>=12784&&n<=12799},"Enclosed CJK Letters and Months":function(n){return n>=12800&&n<=13055},"CJK Compatibility":function(n){return n>=13056&&n<=13311},"CJK Unified Ideographs Extension A":function(n){return n>=13312&&n<=19903},"Yijing Hexagram Symbols":function(n){return n>=19904&&n<=19967},"CJK Unified Ideographs":function(n){return n>=19968&&n<=40959},"Yi Syllables":function(n){return n>=40960&&n<=42127},"Yi Radicals":function(n){return n>=42128&&n<=42191},"Hangul Jamo Extended-A":function(n){return n>=43360&&n<=43391},"Hangul Syllables":function(n){return n>=44032&&n<=55215},"Hangul Jamo Extended-B":function(n){return n>=55216&&n<=55295},"Private Use Area":function(n){return n>=57344&&n<=63743},"CJK Compatibility Ideographs":function(n){return n>=63744&&n<=64255},"Arabic Presentation Forms-A":function(n){return n>=64336&&n<=65023},"Vertical Forms":function(n){return n>=65040&&n<=65055},"CJK Compatibility Forms":function(n){return n>=65072&&n<=65103},"Small Form Variants":function(n){return n>=65104&&n<=65135},"Arabic Presentation Forms-B":function(n){return n>=65136&&n<=65279},"Halfwidth and Fullwidth Forms":function(n){return n>=65280&&n<=65519}}},{}],266:[function(_dereq_,module,exports){var LRUCache=function(t,e){this.max=t,this.onRemove=e,this.reset()};LRUCache.prototype.reset=function(){var t=this;for(var e in t.data)t.onRemove(t.data[e]);return this.data={},this.order=[],this},LRUCache.prototype.add=function(t,e){if(this.has(t))this.order.splice(this.order.indexOf(t),1),this.data[t]=e,this.order.push(t);else if(this.data[t]=e,this.order.push(t),this.order.length>this.max){var r=this.getAndRemove(this.order[0]);r&&this.onRemove(r)}return this},LRUCache.prototype.has=function(t){return t in this.data},LRUCache.prototype.keys=function(){return this.order},LRUCache.prototype.getAndRemove=function(t){if(!this.has(t))return null;var e=this.data[t];return delete this.data[t],this.order.splice(this.order.indexOf(t),1),e},LRUCache.prototype.get=function(t){return this.has(t)?this.data[t]:null},LRUCache.prototype.remove=function(t){if(!this.has(t))return this;var e=this.data[t];return delete this.data[t],this.onRemove(e),this.order.splice(this.order.indexOf(t),1),this},LRUCache.prototype.setMaxSize=function(t){var e=this;for(this.max=t;this.order.length>this.max;){var r=e.getAndRemove(e.order[0]);r&&e.onRemove(r)}return this},module.exports=LRUCache},{}],267:[function(_dereq_,module,exports){function makeAPIURL(r,e){var t=parseUrl(config.API_URL);if(r.protocol=t.protocol,r.authority=t.authority,"/"!==t.path&&(r.path=""+t.path+r.path),!config.REQUIRE_ACCESS_TOKEN)return formatUrl(r);if(!(e=e||config.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+help);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+help);return r.params.push("access_token="+e),formatUrl(r)}function isMapboxURL(r){return 0===r.indexOf("mapbox:")}function parseUrl(r){var e=r.match(urlRe);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function formatUrl(r){var e=r.params.length?"?"+r.params.join("&"):"";return r.protocol+"://"+r.authority+r.path+e}var config=_dereq_("./config"),browser=_dereq_("./browser"),help="See https://www.mapbox.com/api-documentation/#access-tokens";exports.isMapboxURL=isMapboxURL,exports.normalizeStyleURL=function(r,e){if(!isMapboxURL(r))return r;var t=parseUrl(r);return t.path="/styles/v1"+t.path,makeAPIURL(t,e)},exports.normalizeGlyphsURL=function(r,e){if(!isMapboxURL(r))return r;var t=parseUrl(r);return t.path="/fonts/v1"+t.path,makeAPIURL(t,e)},exports.normalizeSourceURL=function(r,e){if(!isMapboxURL(r))return r;var t=parseUrl(r);return t.path="/v4/"+t.authority+".json",t.params.push("secure"),makeAPIURL(t,e)},exports.normalizeSpriteURL=function(r,e,t,a){var o=parseUrl(r);return isMapboxURL(r)?(o.path="/styles/v1"+o.path+"/sprite"+e+t,makeAPIURL(o,a)):(o.path+=""+e+t,formatUrl(o))};var imageExtensionRe=/(\.(png|jpg)\d*)(?=$)/;exports.normalizeTileURL=function(r,e,t){if(!e||!isMapboxURL(e))return r;var a=parseUrl(r),o=browser.devicePixelRatio>=2||512===t?"@2x":"",p=browser.supportsWebp?".webp":"$1";return a.path=a.path.replace(imageExtensionRe,""+o+p),function replaceTempAccessToken(r){for(var e=0;e<r.length;e++)0===r[e].indexOf("access_token=tk.")&&(r[e]="access_token="+(config.ACCESS_TOKEN||""))}(a.params),formatUrl(a)};var urlRe=/^(\w+):\/\/([^\/?]*)(\/[^?]+)?\??(.+)?/},{"./browser":252,"./config":256}],268:[function(_dereq_,module,exports){module.exports={getEntriesByName:function(e){return!(!performance||!performance.getEntriesByName)&&performance.getEntriesByName(e)}}},{}],269:[function(_dereq_,module,exports){var isChar=_dereq_("./is_char_in_unicode_block");module.exports.allowsIdeographicBreaking=function(a){for(var i=0,r=a;i<r.length;i+=1){var s=r[i];if(!exports.charAllowsIdeographicBreaking(s.charCodeAt(0)))return!1}return!0},module.exports.allowsVerticalWritingMode=function(a){for(var i=0,r=a;i<r.length;i+=1){var s=r[i];if(exports.charHasUprightVerticalOrientation(s.charCodeAt(0)))return!0}return!1},module.exports.allowsLetterSpacing=function(a){for(var i=0,r=a;i<r.length;i+=1){var s=r[i];if(!exports.charAllowsLetterSpacing(s.charCodeAt(0)))return!1}return!0},module.exports.charAllowsLetterSpacing=function(a){return!(isChar.Arabic(a)||isChar["Arabic Supplement"](a)||isChar["Arabic Extended-A"](a)||isChar["Arabic Presentation Forms-A"](a)||isChar["Arabic Presentation Forms-B"](a))},module.exports.charAllowsIdeographicBreaking=function(a){return!!(!(a<11904)&&(isChar["Bopomofo Extended"](a)||isChar.Bopomofo(a)||isChar["CJK Compatibility Forms"](a)||isChar["CJK Compatibility Ideographs"](a)||isChar["CJK Compatibility"](a)||isChar["CJK Radicals Supplement"](a)||isChar["CJK Strokes"](a)||isChar["CJK Symbols and Punctuation"](a)||isChar["CJK Unified Ideographs Extension A"](a)||isChar["CJK Unified Ideographs"](a)||isChar["Enclosed CJK Letters and Months"](a)||isChar["Halfwidth and Fullwidth Forms"](a)||isChar.Hiragana(a)||isChar["Ideographic Description Characters"](a)||isChar["Kangxi Radicals"](a)||isChar["Katakana Phonetic Extensions"](a)||isChar.Katakana(a)||isChar["Vertical Forms"](a)||isChar["Yi Radicals"](a)||isChar["Yi Syllables"](a)))},exports.charHasUprightVerticalOrientation=function(a){return!!(746===a||747===a||!(a<4352)&&(isChar["Bopomofo Extended"](a)||isChar.Bopomofo(a)||isChar["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||isChar["CJK Compatibility Ideographs"](a)||isChar["CJK Compatibility"](a)||isChar["CJK Radicals Supplement"](a)||isChar["CJK Strokes"](a)||!(!isChar["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||12336===a)||isChar["CJK Unified Ideographs Extension A"](a)||isChar["CJK Unified Ideographs"](a)||isChar["Enclosed CJK Letters and Months"](a)||isChar["Hangul Compatibility Jamo"](a)||isChar["Hangul Jamo Extended-A"](a)||isChar["Hangul Jamo Extended-B"](a)||isChar["Hangul Jamo"](a)||isChar["Hangul Syllables"](a)||isChar.Hiragana(a)||isChar["Ideographic Description Characters"](a)||isChar.Kanbun(a)||isChar["Kangxi Radicals"](a)||isChar["Katakana Phonetic Extensions"](a)||isChar.Katakana(a)&&12540!==a||!(!isChar["Halfwidth and Fullwidth Forms"](a)||65288===a||65289===a||65293===a||a>=65306&&a<=65310||65339===a||65341===a||65343===a||a>=65371&&a<=65503||65507===a||a>=65512&&a<=65519)||!(!isChar["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||isChar["Unified Canadian Aboriginal Syllabics"](a)||isChar["Unified Canadian Aboriginal Syllabics Extended"](a)||isChar["Vertical Forms"](a)||isChar["Yijing Hexagram Symbols"](a)||isChar["Yi Syllables"](a)||isChar["Yi Radicals"](a)))},exports.charHasNeutralVerticalOrientation=function(a){return!!(isChar["Latin-1 Supplement"](a)&&(167===a||169===a||174===a||177===a||188===a||189===a||190===a||215===a||247===a)||isChar["General Punctuation"](a)&&(8214===a||8224===a||8225===a||8240===a||8241===a||8251===a||8252===a||8258===a||8263===a||8264===a||8265===a||8273===a)||isChar["Letterlike Symbols"](a)||isChar["Number Forms"](a)||isChar["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||9003===a||a>=9085&&a<=9114||a>=9150&&a<=9165||9167===a||a>=9169&&a<=9179||a>=9186&&a<=9215)||isChar["Control Pictures"](a)&&9251!==a||isChar["Optical Character Recognition"](a)||isChar["Enclosed Alphanumerics"](a)||isChar["Geometric Shapes"](a)||isChar["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||isChar["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||isChar["CJK Symbols and Punctuation"](a)||isChar.Katakana(a)||isChar["Private Use Area"](a)||isChar["CJK Compatibility Forms"](a)||isChar["Small Form Variants"](a)||isChar["Halfwidth and Fullwidth Forms"](a)||8734===a||8756===a||8757===a||a>=9984&&a<=10087||a>=10102&&a<=10131||65532===a||65533===a)},exports.charHasRotatedVerticalOrientation=function(a){return!(exports.charHasUprightVerticalOrientation(a)||exports.charHasNeutralVerticalOrientation(a))}},{"./is_char_in_unicode_block":265}],270:[function(_dereq_,module,exports){var LngLat=_dereq_("../geo/lng_lat");module.exports=function(n,t,l){if(n=new LngLat(n.lng,n.lat),t){var a=new LngLat(n.lng-360,n.lat),i=new LngLat(n.lng+360,n.lat),o=l.locationPoint(n).distSqr(t);l.locationPoint(a).distSqr(t)<o?n=a:l.locationPoint(i).distSqr(t)<o&&(n=i)}for(;Math.abs(n.lng-l.center.lng)>180;){var e=l.locationPoint(n);if(e.x>=0&&e.y>=0&&e.x<=l.width&&e.y<=l.height)break;n.lng>l.center.lng?n.lng-=360:n.lng+=360}return n}},{"../geo/lng_lat":62}],271:[function(_dereq_,module,exports){function align(t,r){return Math.ceil(t/r)*r}var viewTypes={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},StructArray=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};StructArray.serialize=function(t,r){return t._trim(),r&&(t.isTransferred=!0,r.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},StructArray.deserialize=function(t){var r=Object.create(this.prototype);return r.arrayBuffer=t.arrayBuffer,r.length=t.length,r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r},StructArray.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},StructArray.prototype.clear=function(){this.length=0},StructArray.prototype.resize=function(t){this.reserve(t),this.length=t},StructArray.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}},StructArray.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")},module.exports.StructArray=StructArray,module.exports.Struct=function(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},module.exports.viewTypes=viewTypes,module.exports.createLayout=function createLayout(t,r){void 0===r&&(r=1);var e=0,i=0;return{members:t.map(function(t){var a=function sizeOf(t){return viewTypes[t].BYTES_PER_ELEMENT}(t.type),s=e=align(e,Math.max(r,a)),n=t.components||1;return i=Math.max(i,a),e+=a*n,{name:t.name,type:t.type,components:n,offset:s}}),size:align(e,Math.max(i,r)),alignment:r}}},{}],272:[function(_dereq_,module,exports){module.exports=function(t,n){var u=!1,e=0,r=function(){e=0,u&&(t(),e=setTimeout(r,n),u=!1)};return function(){return u=!0,e||r(),e}}},{}],273:[function(_dereq_,module,exports){function edge(e,r){if(e.row>r.row){var a=e;e=r,r=a}return{x0:e.column,y0:e.row,x1:r.column,y1:r.row,dx:r.column-e.column,dy:r.row-e.row}}function scanSpans(e,r,a,n,d){var o=Math.max(a,Math.floor(r.y0)),i=Math.min(n,Math.ceil(r.y1));if(e.x0===r.x0&&e.y0===r.y0?e.x0+r.dy/e.dy*e.dx<r.x1:e.x1-r.dy/e.dy*e.dx<r.x0){var t=e;e=r,r=t}for(var y=e.dx/e.dy,c=r.dx/r.dy,l=e.dx>0,x=r.dx<0,u=o;u<i;u++){var s=y*Math.max(0,Math.min(e.dy,u+l-e.y0))+e.x0,f=c*Math.max(0,Math.min(r.dy,u+x-r.y0))+r.x0;d(Math.floor(f),Math.ceil(s),u)}}function scanTriangle(e,r,a,n,d,o){var i,t=edge(e,r),y=edge(r,a),c=edge(a,e);t.dy>y.dy&&(i=t,t=y,y=i),t.dy>c.dy&&(i=t,t=c,c=i),y.dy>c.dy&&(i=y,y=c,c=i),t.dy&&scanSpans(c,t,n,d,o),y.dy&&scanSpans(c,y,n,d,o)}_dereq_("../geo/coordinate");var OverscaledTileID=_dereq_("../source/tile_id").OverscaledTileID;module.exports=function tileCover(e,r,a,n){function d(r,d,t){var y,c,x;if(t>=0&&t<=o)for(y=r;y<d;y++)0!==(c=Math.floor(y/o))&&!0!==n||(x=new OverscaledTileID(a,c,e,(y%o+o)%o,t),i[x.key]=x)}void 0===n&&(n=!0);var o=1<<e,i={};return scanTriangle(r[0],r[1],r[2],0,o,d),scanTriangle(r[2],r[3],r[0],0,o,d),Object.keys(i).map(function(e){return i[e]})}},{"../geo/coordinate":61,"../source/tile_id":114}],274:[function(_dereq_,module,exports){module.exports=function resolveTokens(e,n){return n.replace(/{([^{}]+)}/g,function(n,r){return r in e?String(e[r]):""})}},{}],275:[function(_dereq_,module,exports){var UnitBezier=_dereq_("@mapbox/unitbezier"),Coordinate=_dereq_("../geo/coordinate");_dereq_("@mapbox/point-geometry");exports.easeCubicInOut=function(r){if(r<=0)return 0;if(r>=1)return 1;var e=r*r,n=e*r;return 4*(r<.5?n:3*(r-e)+n-.75)},exports.bezier=function(r,e,n,t){var o=new UnitBezier(r,e,n,t);return function(r){return o.solve(r)}},exports.ease=exports.bezier(.25,.1,.25,1),exports.clamp=function(r,e,n){return Math.min(n,Math.max(e,r))},exports.wrap=function(r,e,n){var t=n-e,o=((r-e)%t+t)%t+e;return o===e?n:o},exports.asyncAll=function(r,e,n){if(!r.length)return n(null,[]);var t=r.length,o=new Array(r.length),a=null;r.forEach(function(r,i){e(r,function(r,e){r&&(a=r),o[i]=e,0==--t&&n(a,o)})})},exports.values=function(r){var e=[];for(var n in r)e.push(r[n]);return e},exports.keysDifference=function(r,e){var n=[];for(var t in r)t in e||n.push(t);return n},exports.extend=function(r){for(var arguments$1=arguments,e=[],n=arguments.length-1;n-- >0;)e[n]=arguments$1[n+1];for(var t=0,o=e;t<o.length;t+=1){var a=o[t];for(var i in a)r[i]=a[i]}return r},exports.pick=function(r,e){for(var n={},t=0;t<e.length;t++){var o=e[t];o in r&&(n[o]=r[o])}return n};var id=1;exports.uniqueId=function(){return id++},exports.bindAll=function(r,e){r.forEach(function(r){e[r]&&(e[r]=e[r].bind(e))})},exports.getCoordinatesCenter=function(r){for(var e=1/0,n=1/0,t=-1/0,o=-1/0,a=0;a<r.length;a++)e=Math.min(e,r[a].column),n=Math.min(n,r[a].row),t=Math.max(t,r[a].column),o=Math.max(o,r[a].row);var i=t-e,u=o-n,s=Math.max(i,u),c=Math.max(0,Math.floor(-Math.log(s)/Math.LN2));return new Coordinate((e+t)/2,(n+o)/2,0).zoomTo(c)},exports.endsWith=function(r,e){return-1!==r.indexOf(e,r.length-e.length)},exports.mapObject=function(r,e,n){var o={};for(var a in r)o[a]=e.call(n||this,r[a],a,r);return o},exports.filterObject=function(r,e,n){var o={};for(var a in r)e.call(n||this,r[a],a,r)&&(o[a]=r[a]);return o},exports.deepEqual=_dereq_("../style-spec/util/deep_equal"),exports.clone=function(r){return Array.isArray(r)?r.map(exports.clone):"object"==typeof r&&r?exports.mapObject(r,exports.clone):r},exports.arraysIntersect=function(r,e){for(var n=0;n<r.length;n++)if(e.indexOf(r[n])>=0)return!0;return!1};var warnOnceHistory={};exports.warnOnce=function(r){warnOnceHistory[r]||("undefined"!=typeof console&&console.warn(r),warnOnceHistory[r]=!0)},exports.isCounterClockwise=function(r,e,n){return(n.y-r.y)*(e.x-r.x)>(e.y-r.y)*(n.x-r.x)},exports.calculateSignedArea=function(r){for(var e=0,n=0,t=r.length,o=t-1,a=void 0,i=void 0;n<t;o=n++)a=r[n],e+=((i=r[o]).x-a.x)*(a.y+i.y);return e},exports.isClosedPolygon=function(r){if(r.length<4)return!1;var e=r[0],n=r[r.length-1];return!(Math.abs(e.x-n.x)>0||Math.abs(e.y-n.y)>0)&&Math.abs(exports.calculateSignedArea(r))>.01},exports.sphericalToCartesian=function(r){var e=r[0],n=r[1],t=r[2];return n+=90,n*=Math.PI/180,t*=Math.PI/180,{x:e*Math.cos(n)*Math.sin(t),y:e*Math.sin(n)*Math.sin(t),z:e*Math.cos(t)}},exports.parseCacheControl=function(r){var n={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(r,e,t,o){var a=t||o;return n[e]=!a||a.toLowerCase(),""}),n["max-age"]){var t=parseInt(n["max-age"],10);isNaN(t)?delete n["max-age"]:n["max-age"]=t}return n}},{"../geo/coordinate":61,"../style-spec/util/deep_equal":155,"@mapbox/point-geometry":4,"@mapbox/unitbezier":7}],276:[function(_dereq_,module,exports){var Feature=function(e,t,r,o){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=r,e._y=o,this.properties=e.properties,null!=e.id&&(this.id=e.id)},prototypeAccessors={geometry:{}};prototypeAccessors.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},prototypeAccessors.geometry.set=function(e){this._geometry=e},Feature.prototype.toJSON=function(){var t={geometry:this.geometry};for(var r in this)"_geometry"!==r&&"_vectorTileFeature"!==r&&(t[r]=this[r]);return t},Object.defineProperties(Feature.prototype,prototypeAccessors),module.exports=Feature},{}],277:[function(_dereq_,module,exports){var scriptDetection=_dereq_("./script_detection");module.exports=function(t){for(var o="",e=0;e<t.length;e++){var r=t.charCodeAt(e+1)||null,l=t.charCodeAt(e-1)||null;r&&scriptDetection.charHasRotatedVerticalOrientation(r)&&!module.exports.lookup[t[e+1]]||l&&scriptDetection.charHasRotatedVerticalOrientation(l)&&!module.exports.lookup[t[e-1]]||!module.exports.lookup[t[e]]?o+=t[e]:o+=module.exports.lookup[t[e]]}return o},module.exports.lookup={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"}},{"./script_detection":269}],278:[function(_dereq_,module,exports){function register(e,r,i){void 0===i&&(i={}),Object.defineProperty(r,"_classRegistryKey",{value:e,writeable:!1}),registry[e]={klass:r,omit:i.omit||[],shallow:i.shallow||[]}}var Grid=_dereq_("grid-index"),Color=_dereq_("../style-spec/util/color"),ref=_dereq_("../style-spec/expression"),StylePropertyFunction=ref.StylePropertyFunction,StyleExpression=ref.StyleExpression,StyleExpressionWithErrorHandling=ref.StyleExpressionWithErrorHandling,ZoomDependentExpression=ref.ZoomDependentExpression,ZoomConstantExpression=ref.ZoomConstantExpression,CompoundExpression=_dereq_("../style-spec/expression/compound_expression").CompoundExpression,expressions=_dereq_("../style-spec/expression/definitions"),ImageData=_dereq_("./window").ImageData,registry={};for(var name in register("Object",Object),Grid.serialize=function(e,r){var i=e.toArrayBuffer();return r&&r.push(i),i},Grid.deserialize=function(e){return new Grid(e)},register("Grid",Grid),register("Color",Color),register("StylePropertyFunction",StylePropertyFunction),register("StyleExpression",StyleExpression,{omit:["_evaluator"]}),register("StyleExpressionWithErrorHandling",StyleExpressionWithErrorHandling,{omit:["_evaluator"]}),register("ZoomDependentExpression",ZoomDependentExpression),register("ZoomConstantExpression",ZoomConstantExpression),register("CompoundExpression",CompoundExpression,{omit:["_evaluate"]}),expressions)expressions[name]._classRegistryKey||register("Expression_"+name,expressions[name]);module.exports={register:register,serialize:function serialize(e,r){if(null===e||void 0===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(e instanceof ArrayBuffer)return r&&r.push(e),e;if(ArrayBuffer.isView(e)){var i=e;return r&&r.push(i.buffer),i}if(e instanceof ImageData)return r&&r.push(e.data.buffer),e;if(Array.isArray(e)){for(var s=[],o=0,t=e;o<t.length;o+=1){var n=t[o];s.push(serialize(n,r))}return s}if("object"==typeof e){var a=e.constructor,f=a._classRegistryKey;if(!f)throw new Error("can't serialize object of unregistered class");var l={};if(a.serialize)l._serialized=a.serialize(e,r);else for(var p in e)if(e.hasOwnProperty(p)&&!(registry[f].omit.indexOf(p)>=0)){var u=e[p];l[p]=registry[f].shallow.indexOf(p)>=0?u:serialize(u,r)}return{name:f,properties:l}}throw new Error("can't serialize object of type "+typeof e)},deserialize:function deserialize(e){if(null===e||void 0===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof ArrayBuffer||ArrayBuffer.isView(e)||e instanceof ImageData)return e;if(Array.isArray(e))return e.map(function(e){return deserialize(e)});if("object"==typeof e){var r=e,i=r.name,s=r.properties;if(!i)throw new Error("can't deserialize object of anonymous class");var t=registry[i].klass;if(!t)throw new Error("can't deserialize unregistered class "+i);if(t.deserialize)return t.deserialize(s._serialized);for(var n=Object.create(t.prototype),a=0,f=Object.keys(s);a<f.length;a+=1){var l=f[a];n[l]=registry[i].shallow.indexOf(l)>=0?s[l]:deserialize(s[l])}return n}throw new Error("can't deserialize object of type "+typeof e)}}},{"../style-spec/expression":139,"../style-spec/expression/compound_expression":123,"../style-spec/expression/definitions":131,"../style-spec/util/color":153,"./window":254,"grid-index":24}],279:[function(_dereq_,module,exports){var WebWorker=_dereq_("./web_worker"),WorkerPool=function(){this.active={}};WorkerPool.prototype.acquire=function(r){if(!this.workers){var o=_dereq_("../").workerCount;for(this.workers=[];this.workers.length<o;)this.workers.push(new WebWorker)}return this.active[r]=!0,this.workers.slice()},WorkerPool.prototype.release=function(r){delete this.active[r],0===Object.keys(this.active).length&&(this.workers.forEach(function(r){r.terminate()}),this.workers=null)},module.exports=WorkerPool},{"../":73,"./web_worker":253}]},{},[73])(73)})}).call(this,void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),_$mapboxGl_254=_$mapboxGl_254.exports;var _$constants_639={requiredVersion:"0.44.1",styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",controlContainerClassName:"mapboxgl-control-container",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@0.44.1."].join("\n"),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.plot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join("\n"),mapOnErrorMsg:"Mapbox error.",styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none"}},__defaultLine_643=_$color_411.defaultLine,__domainAttrs_643=_$domain_610.attributes,textposition=_$attributes_862.textposition,__overrideAll_643=_$edit_types_569.overrideAll,fontAttr=_$font_attributes_611({});fontAttr.family.dflt="Open Sans Regular, Arial Unicode MS Regular";var _$layout_attributes_643=__overrideAll_643({_arrayAttrRegexps:[_$lib_539.counterRegex("mapbox",".layers",!0)],domain:__domainAttrs_643({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],dflt:"basic"},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:{_isLinkedToArray:"layer",sourcetype:{valType:"enumerated",values:["geojson","vector"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},type:{valType:"enumerated",values:["circle","line","fill","symbol"],dflt:"circle"},below:{valType:"string",dflt:""},color:{valType:"color",dflt:__defaultLine_643},opacity:{valType:"number",min:0,max:1,dflt:1},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2}},fill:{outlinecolor:{valType:"color",dflt:__defaultLine_643}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},textfont:fontAttr,textposition:_$lib_539.extendFlat({},textposition,{arrayOk:!1})}}},"plot","from-root");function __handleDefaults_644(containerIn,containerOut,coerce,opts){coerce("accesstoken",opts.accessToken),coerce("style"),coerce("center.lon"),coerce("center.lat"),coerce("zoom"),coerce("bearing"),coerce("pitch"),function handleLayerDefaults(containerIn,containerOut){var layerIn,layerOut,layersIn=containerIn.layers||[],layersOut=containerOut.layers=[];function coerce(attr,dflt){return _$lib_539.coerce(layerIn,layerOut,_$layout_attributes_643.layers,attr,dflt)}for(var i=0;i<layersIn.length;i++)if(layerIn=layersIn[i],layerOut={},_$lib_539.isPlainObject(layerIn)){var sourceType=coerce("sourcetype");coerce("source"),"vector"===sourceType&&coerce("sourcelayer");var type=coerce("type");coerce("below"),coerce("color"),coerce("opacity"),"circle"===type&&coerce("circle.radius"),"line"===type&&coerce("line.width"),"fill"===type&&coerce("fill.outlinecolor"),"symbol"===type&&(coerce("symbol.icon"),coerce("symbol.iconsize"),coerce("symbol.text"),_$lib_539.coerceFont(coerce,"symbol.textfont"),coerce("symbol.textposition")),layerOut._index=i,layersOut.push(layerOut)}}(containerIn,containerOut),containerOut._input=containerIn}var _$convertTextOpts_640=function convertTextOpts(textposition,iconSize){var parts=textposition.split(" "),vPos=parts[0],hPos=parts[1],factor=_$lib_539.isArrayOrTypedArray(iconSize)?_$lib_539.mean(iconSize):iconSize,xInc=.5+factor/100,yInc=1.5+factor/100,anchorVals=["",""],offset=[0,0];switch(vPos){case"top":anchorVals[0]="top",offset[1]=-yInc;break;case"bottom":anchorVals[0]="bottom",offset[1]=yInc}switch(hPos){case"left":anchorVals[1]="right",offset[0]=-xInc;break;case"right":anchorVals[1]="left",offset[0]=xInc}return{anchor:anchorVals[0]&&anchorVals[1]?anchorVals.join("-"):anchorVals[0]?anchorVals[0]:anchorVals[1]?anchorVals[1]:"center",offset:offset}};function MapboxLayer(mapbox,index){this.mapbox=mapbox,this.map=mapbox.map,this.uid=mapbox.uid+"-layer"+index,this.idSource=this.uid+"-source",this.idLayer=this.uid+"-layer",this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}var __proto_642=MapboxLayer.prototype;function isVisible(opts){var source=opts.source;return _$lib_539.isPlainObject(source)||"string"==typeof source&&source.length>0}function convertOpts(opts){var layout={},paint={};switch(opts.type){case"circle":_$lib_539.extendFlat(paint,{"circle-radius":opts.circle.radius,"circle-color":opts.color,"circle-opacity":opts.opacity});break;case"line":_$lib_539.extendFlat(paint,{"line-width":opts.line.width,"line-color":opts.color,"line-opacity":opts.opacity});break;case"fill":_$lib_539.extendFlat(paint,{"fill-color":opts.color,"fill-outline-color":opts.fill.outlinecolor,"fill-opacity":opts.opacity});break;case"symbol":var symbol=opts.symbol,textOpts=_$convertTextOpts_640(symbol.textposition,symbol.iconsize);_$lib_539.extendFlat(layout,{"icon-image":symbol.icon+"-15","icon-size":symbol.iconsize/10,"text-field":symbol.text,"text-size":symbol.textfont.size,"text-anchor":textOpts.anchor,"text-offset":textOpts.offset}),_$lib_539.extendFlat(paint,{"icon-color":opts.color,"text-color":symbol.textfont.color,"text-opacity":opts.opacity})}return{layout:layout,paint:paint}}__proto_642.update=function update(opts){this.visible?this.needsNewSource(opts)?(this.updateLayer(opts),this.updateSource(opts)):this.needsNewLayer(opts)?this.updateLayer(opts):this.updateStyle(opts):(this.updateSource(opts),this.updateLayer(opts)),this.visible=isVisible(opts)},__proto_642.needsNewSource=function(opts){return this.sourceType!==opts.sourcetype||this.source!==opts.source||this.layerType!==opts.type},__proto_642.needsNewLayer=function(opts){return this.layerType!==opts.type||this.below!==opts.below},__proto_642.updateSource=function(opts){var map=this.map;if(map.getSource(this.idSource)&&map.removeSource(this.idSource),this.sourceType=opts.sourcetype,this.source=opts.source,isVisible(opts)){var sourceOpts=function convertSourceOpts(opts){var field,sourceType=opts.sourcetype,source=opts.source,sourceOpts={type:sourceType};"geojson"===sourceType?field="data":"vector"===sourceType&&(field="string"==typeof source?"url":"tiles");return sourceOpts[field]=source,sourceOpts}(opts);map.addSource(this.idSource,sourceOpts)}},__proto_642.updateLayer=function(opts){var map=this.map,convertedOpts=convertOpts(opts);map.getLayer(this.idLayer)&&map.removeLayer(this.idLayer),this.layerType=opts.type,isVisible(opts)&&map.addLayer({id:this.idLayer,source:this.idSource,"source-layer":opts.sourcelayer||"",type:opts.type,layout:convertedOpts.layout,paint:convertedOpts.paint},opts.below)},__proto_642.updateStyle=function(opts){if(isVisible(opts)){var convertedOpts=convertOpts(opts);this.mapbox.setOptions(this.idLayer,"setLayoutProperty",convertedOpts.layout),this.mapbox.setOptions(this.idLayer,"setPaintProperty",convertedOpts.paint)}},__proto_642.dispose=function dispose(){var map=this.map;map.removeLayer(this.idLayer),map.removeSource(this.idSource)};var _$createMapboxLayer_642=function createMapboxLayer(mapbox,index,opts){var mapboxLayer=new MapboxLayer(mapbox,index);return mapboxLayer.update(opts),mapboxLayer};function Mapbox(opts){this.id=opts.id,this.gd=opts.gd,this.container=opts.container,this.isStatic=opts.staticPlot;var fullLayout=opts.fullLayout;this.uid=fullLayout._uid+"-"+this.id,this.opts=fullLayout[this.id],this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(fullLayout),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[]}var __proto_645=Mapbox.prototype,_$createMapbox_645=function createMapbox(opts){return new Mapbox(opts)};function getStyleObj(val){var styleValues=_$layout_attributes_643.style.values,styleDflt=_$layout_attributes_643.style.dflt,styleObj={};return _$lib_539.isPlainObject(val)?(styleObj.id=val.id,styleObj.style=val):"string"==typeof val?(styleObj.id=val,styleObj.style=-1!==styleValues.indexOf(val)?convertStyleVal(val):val):(styleObj.id=styleDflt,styleObj.style=convertStyleVal(styleDflt)),styleObj.transition={duration:0,delay:0},styleObj}function convertStyleVal(val){return _$constants_639.styleUrlPrefix+val+"-"+_$constants_639.styleUrlSuffix}function convertCenter(center){return[center.lon,center.lat]}__proto_645.plot=function(calcData,fullLayout,promises){var promise,self=this,opts=self.opts=fullLayout[this.id];self.map&&opts.accesstoken!==self.accessToken&&(self.map.remove(),self.map=null,self.styleObj=null,self.traceHash=[],self.layerList={}),promise=self.map?new Promise(function(resolve,reject){self.updateMap(calcData,fullLayout,resolve,reject)}):new Promise(function(resolve,reject){self.createMap(calcData,fullLayout,resolve,reject)}),promises.push(promise)},__proto_645.createMap=function(calcData,fullLayout,resolve,reject){var self=this,gd=self.gd,opts=self.opts,styleObj=self.styleObj=getStyleObj(opts.style);self.accessToken=opts.accesstoken;var map=self.map=new _$mapboxGl_254.Map({container:self.div,style:styleObj.style,center:convertCenter(opts.center),zoom:opts.zoom,bearing:opts.bearing,pitch:opts.pitch,interactive:!self.isStatic,preserveDrawingBuffer:self.isStatic,doubleClickZoom:!1,boxZoom:!1}),className=_$constants_639.controlContainerClassName,controlContainer=self.div.getElementsByClassName(className)[0];function unhover(){_$fx_453.loneUnhover(fullLayout._toppaper)}self.div.removeChild(controlContainer),map._canvas.style.left="0px",map._canvas.style.top="0px",self.rejectOnError(reject),map.once("load",function(){self.updateData(calcData),self.updateLayout(fullLayout),self.resolveOnRender(resolve)}),self.isStatic||(map.on("moveend",function(eventData){if(self.map){var view=self.getView();if(opts._input.center=opts.center=view.center,opts._input.zoom=opts.zoom=view.zoom,opts._input.bearing=opts.bearing=view.bearing,opts._input.pitch=opts.pitch=view.pitch,eventData.originalEvent){var update={};update[self.id]=_$lib_539.extendFlat({},view),gd.emit("plotly_relayout",update)}}}),map.on("mousemove",function(evt){var bb=self.div.getBoundingClientRect();evt.clientX=evt.point.x+bb.left,evt.clientY=evt.point.y+bb.top,evt.target.getBoundingClientRect=function(){return bb},self.xaxis.p2c=function(){return evt.lngLat.lng},self.yaxis.p2c=function(){return evt.lngLat.lat},_$fx_453.hover(gd,evt,self.id)}),map.on("click",function(evt){_$fx_453.click(gd,evt.originalEvent)}),map.on("dragstart",unhover),map.on("zoomstart",unhover),map.on("dblclick",function(){var viewInitial=self.viewInitial;map.setCenter(convertCenter(viewInitial.center)),map.setZoom(viewInitial.zoom),map.setBearing(viewInitial.bearing),map.setPitch(viewInitial.pitch);var viewNow=self.getView();opts._input.center=opts.center=viewNow.center,opts._input.zoom=opts.zoom=viewNow.zoom,opts._input.bearing=opts.bearing=viewNow.bearing,opts._input.pitch=opts.pitch=viewNow.pitch,gd.emit("plotly_doubleclick",null)}),self.clearSelect=function(){gd._fullLayout._zoomlayer.selectAll(".select-outline").remove()})},__proto_645.updateMap=function(calcData,fullLayout,resolve,reject){var self=this,map=self.map;self.rejectOnError(reject);var styleObj=getStyleObj(self.opts.style);self.styleObj.id!==styleObj.id?(self.styleObj=styleObj,map.setStyle(styleObj.style),map.once("styledata",function(){self.traceHash={},self.updateData(calcData),self.updateLayout(fullLayout),self.resolveOnRender(resolve)})):(self.updateData(calcData),self.updateLayout(fullLayout),self.resolveOnRender(resolve))},__proto_645.updateData=function(calcData){var traceObj,trace,i,j,traceHash=this.traceHash;for(i=0;i<calcData.length;i++){var calcTrace=calcData[i];(traceObj=traceHash[(trace=calcTrace[0].trace).uid])?traceObj.update(calcTrace):trace._module&&(traceHash[trace.uid]=trace._module.plot(this,calcTrace))}var ids=Object.keys(traceHash);id_loop:for(i=0;i<ids.length;i++){var id=ids[i];for(j=0;j<calcData.length;j++)if(id===(trace=calcData[j][0].trace).uid)continue id_loop;(traceObj=traceHash[id]).dispose(),delete traceHash[id]}},__proto_645.updateLayout=function(fullLayout){var map=this.map,opts=this.opts;map.setCenter(convertCenter(opts.center)),map.setZoom(opts.zoom),map.setBearing(opts.bearing),map.setPitch(opts.pitch),this.updateLayers(),this.updateFramework(fullLayout),this.updateFx(fullLayout),this.map.resize()},__proto_645.resolveOnRender=function(resolve){var map=this.map;map.on("render",function onRender(){map.loaded()&&(map.off("render",onRender),setTimeout(resolve,0))})},__proto_645.rejectOnError=function(reject){var map=this.map;function handler(){reject(new Error(_$constants_639.mapOnErrorMsg))}map.once("error",handler),map.once("style.error",handler),map.once("source.error",handler),map.once("tile.error",handler),map.once("layer.error",handler)},__proto_645.createFramework=function(fullLayout){var self=this,div=self.div=document.createElement("div");div.id=self.uid,div.style.position="absolute",self.container.appendChild(div),self.xaxis={_id:"x",c2p:function(v){return self.project(v).x}},self.yaxis={_id:"y",c2p:function(v){return self.project(v).y}},self.updateFramework(fullLayout)},__proto_645.updateFx=function(fullLayout){var self=this,map=self.map,gd=self.gd;if(!self.isStatic){var fillRangeItems,dragMode=fullLayout.dragmode;if(fillRangeItems="select"===dragMode?function(eventData,poly){(eventData.range={})[self.id]=[invert([poly.xmin,poly.ymin]),invert([poly.xmax,poly.ymax])]}:function(eventData,poly,pts){(eventData.lassoPoints={})[self.id]=pts.filtered.map(invert)},"select"===dragMode||"lasso"===dragMode){map.dragPan.disable(),map.on("zoomstart",self.clearSelect);var dragOptions={element:self.div,gd:gd,plotinfo:{xaxis:self.xaxis,yaxis:self.yaxis,fillRangeItems:fillRangeItems},xaxes:[self.xaxis],yaxes:[self.yaxis],subplot:self.id,prepFn:function(e,startX,startY){_$prepSelect_602(e,startX,startY,dragOptions,dragMode)}};_$dragelement_433.init(dragOptions)}else map.dragPan.enable(),map.off("zoomstart",self.clearSelect),self.div.onmousedown=null}function invert(pxpy){var obj=self.map.unproject(pxpy);return[obj.lng,obj.lat]}},__proto_645.updateFramework=function(fullLayout){var domain=fullLayout[this.id].domain,size=fullLayout._size,style=this.div.style;style.width=size.w*(domain.x[1]-domain.x[0])+"px",style.height=size.h*(domain.y[1]-domain.y[0])+"px",style.left=size.l+domain.x[0]*size.w+"px",style.top=size.t+(1-domain.y[1])*size.h+"px",this.xaxis._offset=size.l+domain.x[0]*size.w,this.xaxis._length=size.w*(domain.x[1]-domain.x[0]),this.yaxis._offset=size.t+(1-domain.y[1])*size.h,this.yaxis._length=size.h*(domain.y[1]-domain.y[0])},__proto_645.updateLayers=function(){var i,layers=this.opts.layers,layerList=this.layerList;if(layers.length!==layerList.length){for(i=0;i<layerList.length;i++)layerList[i].dispose();for(layerList=this.layerList=[],i=0;i<layers.length;i++)layerList.push(_$createMapboxLayer_642(this,i,layers[i]))}else for(i=0;i<layers.length;i++)layerList[i].update(layers[i])},__proto_645.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},__proto_645.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},__proto_645.setOptions=function(id,methodName,opts){for(var k in opts)this.map[methodName](id,k,opts[k])},__proto_645.project=function(v){return this.map.project(new _$mapboxGl_254.LngLat(v[0],v[1]))},__proto_645.getView=function(){var map=this.map,mapCenter=map.getCenter();return{center:{lon:mapCenter.lng,lat:mapCenter.lat},zoom:map.getZoom(),bearing:map.getBearing(),pitch:map.getPitch()}};var _$mapbox_641={},__getSubplotCalcData_641=_$get_data_621.getSubplotCalcData;for(var __k_641 in _$constants_639.styleRules)_$lib_539.addStyleRule(".mapboxgl-"+__k_641,_$constants_639.styleRules[__k_641]);_$mapbox_641.name="mapbox",_$mapbox_641.attr="subplot",_$mapbox_641.idRoot="mapbox",_$mapbox_641.idRegex=_$mapbox_641.attrRegex=_$lib_539.counterRegex("mapbox"),_$mapbox_641.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},_$mapbox_641.layoutAttributes=_$layout_attributes_643,_$mapbox_641.supplyLayoutDefaults=function supplyLayoutDefaults(layoutIn,layoutOut,fullData){_$handleSubplotDefaults_660(layoutIn,layoutOut,0,{type:"mapbox",attributes:_$layout_attributes_643,handleDefaults:__handleDefaults_644,partition:"y",accessToken:layoutOut._mapboxAccessToken})},_$mapbox_641.plot=function plotMapbox(gd){var fullLayout=gd._fullLayout,calcData=gd.calcdata,mapboxIds=fullLayout._subplots.mapbox;if(_$mapboxGl_254.version!==_$constants_639.requiredVersion)throw new Error(_$constants_639.wrongVersionErrorMsg);var accessToken=function findAccessToken(gd,mapboxIds){var fullLayout=gd._fullLayout;if(""===gd._context.mapboxAccessToken)return"";for(var i=0;i<mapboxIds.length;i++){var opts=fullLayout[mapboxIds[i]];if(opts.accesstoken)return opts.accesstoken}throw new Error(_$constants_639.noAccessTokenErrorMsg)}(gd,mapboxIds);_$mapboxGl_254.accessToken=accessToken;for(var i=0;i<mapboxIds.length;i++){var id=mapboxIds[i],subplotCalcData=__getSubplotCalcData_641(calcData,"mapbox",id),opts=fullLayout[id],mapbox=opts._subplot;mapbox||(mapbox=_$createMapbox_645({gd:gd,container:fullLayout._glcontainer.node(),id:id,fullLayout:fullLayout,staticPlot:gd._context.staticPlot}),fullLayout[id]._subplot=mapbox),mapbox.viewInitial||(mapbox.viewInitial={center:_$lib_539.extendFlat({},opts.center),zoom:opts.zoom,bearing:opts.bearing,pitch:opts.pitch}),mapbox.plot(subplotCalcData,fullLayout,gd._promises)}},_$mapbox_641.clean=function(newFullData,newFullLayout,oldFullData,oldFullLayout){for(var oldMapboxKeys=oldFullLayout._subplots.mapbox||[],i=0;i<oldMapboxKeys.length;i++){var oldMapboxKey=oldMapboxKeys[i];!newFullLayout[oldMapboxKey]&&oldFullLayout[oldMapboxKey]._subplot&&oldFullLayout[oldMapboxKey]._subplot.destroy()}},_$mapbox_641.toSVG=function(gd){for(var fullLayout=gd._fullLayout,subplotIds=fullLayout._subplots.mapbox,size=fullLayout._size,i=0;i<subplotIds.length;i++){var opts=fullLayout[subplotIds[i]],domain=opts.domain,mapbox=opts._subplot,imageData=mapbox.toImage("png");fullLayout._glimages.append("svg:image").attr({xmlns:_$xmlns_namespaces_519.svg,"xlink:href":imageData,x:size.l+size.w*domain.x[0],y:size.t+size.h*(1-domain.y[1]),width:size.w*(domain.x[1]-domain.x[0]),height:size.h*(domain.y[1]-domain.y[0]),preserveAspectRatio:"none"}),mapbox.destroy()}},_$mapbox_641.updateFx=function(fullLayout){for(var subplotIds=fullLayout._subplots.mapbox,i=0;i<subplotIds.length;i++){fullLayout[subplotIds[i]]._subplot.updateFx(fullLayout)}};var __extendFlat_912=_$extend_528.extendFlat,__overrideAll_912=_$edit_types_569.overrideAll,__lineAttrs_912=_$attributes_900.line,markerAttrs=_$attributes_900.marker,_$attributes_912=__overrideAll_912({lon:_$attributes_900.lon,lat:_$attributes_900.lat,mode:__extendFlat_912({},_$attributes_862.mode,{dflt:"markers"}),text:__extendFlat_912({},_$attributes_862.text,{}),hovertext:__extendFlat_912({},_$attributes_862.hovertext,{}),line:{color:__lineAttrs_912.color,width:__lineAttrs_912.width},connectgaps:_$attributes_862.connectgaps,marker:{symbol:{valType:"string",dflt:"circle",arrayOk:!0},opacity:markerAttrs.opacity,size:markerAttrs.size,sizeref:markerAttrs.sizeref,sizemin:markerAttrs.sizemin,sizemode:markerAttrs.sizemode,color:markerAttrs.color,colorscale:markerAttrs.colorscale,cauto:markerAttrs.cauto,cmax:markerAttrs.cmax,cmin:markerAttrs.cmin,autocolorscale:markerAttrs.autocolorscale,reversescale:markerAttrs.reversescale,showscale:markerAttrs.showscale,colorbar:_$attributes_412},fill:_$attributes_900.fill,fillcolor:_$attributes_862.fillcolor,textfont:_$layout_attributes_643.layers.symbol.textfont,textposition:_$layout_attributes_643.layers.symbol.textposition,selected:{marker:_$attributes_862.selected.marker},unselected:{marker:_$attributes_862.unselected.marker},hoverinfo:__extendFlat_912({},_$attributes_581.hoverinfo,{flags:["lon","lat","text","name"]})},"calc","nested");var __BADNUM_916=_$numerical_517.BADNUM;var __BADNUM_913=_$numerical_517.BADNUM,_$convert_913=function convert(calcTrace){var lineCoords,trace=calcTrace[0].trace,isVisible=!0===trace.visible,hasFill="none"!==trace.fill,hasLines=_$subtypes_884.hasLines(trace),hasMarkers=_$subtypes_884.hasMarkers(trace),hasText=_$subtypes_884.hasText(trace),hasCircles=hasMarkers&&"circle"===trace.marker.symbol,hasSymbols=hasMarkers&&"circle"!==trace.marker.symbol,fill=initContainer(),line=initContainer(),circle=initContainer(),symbol=initContainer(),opts={fill:fill,line:line,circle:circle,symbol:symbol};if(!isVisible)return opts;if((hasFill||hasLines)&&(lineCoords=_$geojson_utils_532.calcTraceToLineCoords(calcTrace)),hasFill&&(fill.geojson=_$geojson_utils_532.makePolygon(lineCoords),fill.layout.visibility="visible",_$lib_539.extendFlat(fill.paint,{"fill-color":trace.fillcolor})),hasLines&&(line.geojson=_$geojson_utils_532.makeLine(lineCoords),line.layout.visibility="visible",_$lib_539.extendFlat(line.paint,{"line-width":trace.line.width,"line-color":trace.line.color,"line-opacity":trace.opacity})),hasCircles){var circleOpts=function makeCircleOpts(calcTrace){var i,colorFn,sizeFn,opacityFn,trace=calcTrace[0].trace,marker=trace.marker,selectedpoints=trace.selectedpoints,arrayColor=_$lib_539.isArrayOrTypedArray(marker.color),arraySize=_$lib_539.isArrayOrTypedArray(marker.size),arrayOpacity=_$lib_539.isArrayOrTypedArray(marker.opacity);function addTraceOpacity(o){return trace.opacity*o}function size2radius(s){return s/2}arrayColor&&(colorFn=_$colorscale_426.hasColorscale(trace,"marker")?_$colorscale_426.makeColorScaleFunc(_$colorscale_426.extractScale(marker.colorscale,marker.cmin,marker.cmax)):_$lib_539.identity);arraySize&&(sizeFn=_$makeBubbleSizeFn_879(trace));arrayOpacity&&(opacityFn=function(mo){var mo2=_$fastIsnumeric_139(mo)?+_$lib_539.constrain(mo,0,1):0;return addTraceOpacity(mo2)});var fns,features=[];for(i=0;i<calcTrace.length;i++){var calcPt=calcTrace[i],lonlat=calcPt.lonlat;if(!isBADNUM(lonlat)){var props={};colorFn&&(props.mcc=calcPt.mcc=colorFn(calcPt.mc)),sizeFn&&(props.mrc=calcPt.mrc=sizeFn(calcPt.ms)),opacityFn&&(props.mo=opacityFn(calcPt.mo)),selectedpoints&&(props.selected=calcPt.selected||0),features.push({type:"Feature",geometry:{type:"Point",coordinates:lonlat},properties:props})}}if(selectedpoints)for(fns=_$drawing_436.makeSelectedPointStyleFns(trace),i=0;i<features.length;i++){var d=features[i].properties,mo2=fns.opacityFn(d);if(void 0!==mo2?d.mo=addTraceOpacity(mo2):void 0===d.mo&&(d.mo=addTraceOpacity(marker.opacity)),fns.colorFn){var mc2=fns.colorFn(d);mc2?d.mcc=mc2:d.mcc||(d.mcc=marker.color)}if(fns.sizeFn){var mrc2=fns.sizeFn(d);void 0!==mrc2?d.mrc=mrc2:void 0===d.mrc&&(d.mrc=size2radius(marker.size))}}return{geojson:{type:"FeatureCollection",features:features},mcc:arrayColor||fns&&fns.colorFn?{type:"identity",property:"mcc"}:marker.color,mrc:arraySize||fns&&fns.sizeFn?{type:"identity",property:"mrc"}:size2radius(marker.size),mo:arrayOpacity||selectedpoints?{type:"identity",property:"mo"}:addTraceOpacity(marker.opacity)}}(calcTrace);circle.geojson=circleOpts.geojson,circle.layout.visibility="visible",_$lib_539.extendFlat(circle.paint,{"circle-color":circleOpts.mcc,"circle-radius":circleOpts.mrc,"circle-opacity":circleOpts.mo})}if((hasSymbols||hasText)&&(symbol.geojson=function makeSymbolGeoJSON(calcTrace){for(var trace=calcTrace[0].trace,symbol=(trace.marker||{}).symbol,text=trace.text,fillSymbol="circle"!==symbol?getFillFunc(symbol):blankFillFunc,fillText=_$subtypes_884.hasText(trace)?getFillFunc(text):blankFillFunc,features=[],i=0;i<calcTrace.length;i++){var calcPt=calcTrace[i];isBADNUM(calcPt.lonlat)||features.push({type:"Feature",geometry:{type:"Point",coordinates:calcPt.lonlat},properties:{symbol:fillSymbol(calcPt.mx),text:fillText(calcPt.tx)}})}return{type:"FeatureCollection",features:features}}(calcTrace),_$lib_539.extendFlat(symbol.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),hasSymbols&&(_$lib_539.extendFlat(symbol.layout,{"icon-size":trace.marker.size/10}),_$lib_539.extendFlat(symbol.paint,{"icon-opacity":trace.opacity*trace.marker.opacity,"icon-color":trace.marker.color})),hasText)){var iconSize=(trace.marker||{}).size,textOpts=_$convertTextOpts_640(trace.textposition,iconSize);_$lib_539.extendFlat(symbol.layout,{"text-size":trace.textfont.size,"text-anchor":textOpts.anchor,"text-offset":textOpts.offset}),_$lib_539.extendFlat(symbol.paint,{"text-color":trace.textfont.color,"text-opacity":trace.opacity})}return opts};function initContainer(){return{geojson:_$geojson_utils_532.makeBlank(),layout:{visibility:"none"},paint:{}}}function getFillFunc(attr){return _$lib_539.isArrayOrTypedArray(attr)?function(v){return v}:attr?function(){return attr}:blankFillFunc}function blankFillFunc(){return""}function isBADNUM(lonlat){return lonlat[0]===__BADNUM_913}function ScatterMapbox(subplot,uid){this.subplot=subplot,this.uid=uid,this.sourceIds={fill:uid+"-source-fill",line:uid+"-source-line",circle:uid+"-source-circle",symbol:uid+"-source-symbol"},this.layerIds={fill:uid+"-layer-fill",line:uid+"-layer-line",circle:uid+"-layer-circle",symbol:uid+"-layer-symbol"},this.order=["fill","line","circle","symbol"]}var __proto_918=ScatterMapbox.prototype;__proto_918.addSource=function(k,opts){this.subplot.map.addSource(this.sourceIds[k],{type:"geojson",data:opts.geojson})},__proto_918.setSourceData=function(k,opts){this.subplot.map.getSource(this.sourceIds[k]).setData(opts.geojson)},__proto_918.addLayer=function(k,opts){this.subplot.map.addLayer({type:k,id:this.layerIds[k],source:this.sourceIds[k],layout:opts.layout,paint:opts.paint})},__proto_918.update=function update(calcTrace){for(var subplot=this.subplot,optsAll=_$convert_913(calcTrace),i=0;i<this.order.length;i++){var k=this.order[i],opts=optsAll[k];subplot.setOptions(this.layerIds[k],"setLayoutProperty",opts.layout),"visible"===opts.layout.visibility&&(this.setSourceData(k,opts),subplot.setOptions(this.layerIds[k],"setPaintProperty",opts.paint))}calcTrace[0].trace._glTrace=this},__proto_918.dispose=function dispose(){for(var map=this.subplot.map,i=0;i<this.order.length;i++){var k=this.order[i];map.removeLayer(this.layerIds[k]),map.removeSource(this.sourceIds[k])}};var __ScatterMapbox_917={};__ScatterMapbox_917.attributes=_$attributes_912,__ScatterMapbox_917.supplyDefaults=function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_912,attr,dflt)}if(function handleLonLatDefaults(traceIn,traceOut,coerce){var lon=coerce("lon")||[],lat=coerce("lat")||[],len=Math.min(lon.length,lat.length);return traceOut._length=len,len}(0,traceOut,coerce)){if(coerce("text"),coerce("hovertext"),coerce("mode"),_$subtypes_884.hasLines(traceOut)&&(_$lineDefaults_875(traceIn,traceOut,defaultColor,layout,coerce,{noDash:!0}),coerce("connectgaps")),_$subtypes_884.hasMarkers(traceOut)){_$markerDefaults_880(traceIn,traceOut,defaultColor,layout,coerce,{noLine:!0});var marker=traceOut.marker;marker.line={width:0},"circle"!==marker.symbol&&(_$lib_539.isArrayOrTypedArray(marker.size)&&(marker.size=marker.size[0]),_$lib_539.isArrayOrTypedArray(marker.color)&&(marker.color=marker.color[0]))}_$subtypes_884.hasText(traceOut)&&_$text_defaults_885(0,0,layout,coerce,{noSelect:!0}),coerce("fill"),"none"!==traceOut.fill&&_$fillColorDefaults_871(0,traceOut,defaultColor,coerce),_$lib_539.coerceSelectionMarkerOpacity(traceOut,coerce)}else traceOut.visible=!1},__ScatterMapbox_917.colorbar=_$colorbar_866,__ScatterMapbox_917.calc=_$calc_901,__ScatterMapbox_917.plot=function createScatterMapbox(subplot,calcTrace){for(var scatterMapbox=new ScatterMapbox(subplot,calcTrace[0].trace.uid),optsAll=_$convert_913(calcTrace),i=0;i<scatterMapbox.order.length;i++){var k=scatterMapbox.order[i],opts=optsAll[k];scatterMapbox.addSource(k,opts),scatterMapbox.addLayer(k,opts)}return calcTrace[0].trace._glTrace=scatterMapbox,scatterMapbox},__ScatterMapbox_917.hoverPoints=function hoverPoints(pointData,xval,yval){var cd=pointData.cd,trace=cd[0].trace,xa=pointData.xa,ya=pointData.ya,subplot=pointData.subplot,lonShift=360*(xval>=0?Math.floor((xval+180)/360):Math.ceil((xval-180)/360)),xval2=xval-lonShift;if(_$fx_453.getClosest(cd,function distFn(d){var lonlat=d.lonlat;if(lonlat[0]===__BADNUM_916)return 1/0;var lon=_$lib_539.wrap180(lonlat[0]),lat=lonlat[1],pt=subplot.project([lon,lat]),dx=pt.x-xa.c2p([xval2,lat]),dy=pt.y-ya.c2p([lon,yval]),rad=Math.max(3,d.mrc||0);return Math.max(Math.sqrt(dx*dx+dy*dy)-rad,1-3/rad)},pointData),!1!==pointData.index){var di=cd[pointData.index],lonlat=di.lonlat,lonlatShifted=[_$lib_539.wrap180(lonlat[0])+lonShift,lonlat[1]],xc=xa.c2p(lonlatShifted),yc=ya.c2p(lonlatShifted),rad=di.mrc||1;return pointData.x0=xc-rad,pointData.x1=xc+rad,pointData.y0=yc-rad,pointData.y1=yc+rad,pointData.color=_$getTraceColor_872(trace,di),pointData.extraText=function __getExtraText_916(trace,di,labels){var parts=(di.hi||trace.hoverinfo).split("+"),isAll=-1!==parts.indexOf("all"),hasLon=-1!==parts.indexOf("lon"),hasLat=-1!==parts.indexOf("lat"),lonlat=di.lonlat,text=[];function format(v){return v+"°"}return isAll||hasLon&&hasLat?text.push("("+format(lonlat[0])+", "+format(lonlat[1])+")"):hasLon?text.push(labels.lon+format(lonlat[0])):hasLat&&text.push(labels.lat+format(lonlat[1])),(isAll||-1!==parts.indexOf("text"))&&_$fillHoverText_870(di,trace,text),text.join("<br>")}(trace,di,cd[0].t.labels),[pointData]}},__ScatterMapbox_917.eventData=function eventData(out,pt){return out.lon=pt.lon,out.lat=pt.lat,out},__ScatterMapbox_917.selectPoints=function selectPoints(searchInfo,polygon){var i,cd=searchInfo.cd,xa=searchInfo.xaxis,ya=searchInfo.yaxis,selection=[],trace=cd[0].trace;if(!_$subtypes_884.hasMarkers(trace))return[];if(!1===polygon)for(i=0;i<cd.length;i++)cd[i].selected=0;else for(i=0;i<cd.length;i++){var di=cd[i],lonlat=di.lonlat,lonlat2=[_$lib_539.wrap180(lonlat[0]),lonlat[1]],xy=[xa.c2p(lonlat2),ya.c2p(lonlat2)];polygon.contains(xy)?(selection.push({pointNumber:i,lon:lonlat[0],lat:lonlat[1]}),di.selected=1):di.selected=0}return selection},__ScatterMapbox_917.style=function(_,cd){cd&&cd[0].trace._glTrace.update(cd)},__ScatterMapbox_917.moduleType="trace",__ScatterMapbox_917.name="scattermapbox",__ScatterMapbox_917.basePlotModule=_$mapbox_641,__ScatterMapbox_917.categories=["mapbox","gl","symbols","markerColorscale","showLegend","scatterlike"],__ScatterMapbox_917.meta={};var _$scattermapbox_31=__ScatterMapbox_917,_$constants_648={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-axis","radial-axis","angular-line","radial-line"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20},__domainAttrs_651=_$domain_610.attributes,__extendFlat_651=_$lib_539.extendFlat,__overrideAll_651=_$edit_types_569.overrideAll,axisLineGridAttr=__overrideAll_651({color:_$layout_attributes_596.color,showline:__extendFlat_651({},_$layout_attributes_596.showline,{dflt:!0}),linecolor:_$layout_attributes_596.linecolor,linewidth:_$layout_attributes_596.linewidth,showgrid:__extendFlat_651({},_$layout_attributes_596.showgrid,{dflt:!0}),gridcolor:_$layout_attributes_596.gridcolor,gridwidth:_$layout_attributes_596.gridwidth},"plot","from-root"),axisTickAttrs=__overrideAll_651({tickmode:_$layout_attributes_596.tickmode,nticks:_$layout_attributes_596.nticks,tick0:_$layout_attributes_596.tick0,dtick:_$layout_attributes_596.dtick,tickvals:_$layout_attributes_596.tickvals,ticktext:_$layout_attributes_596.ticktext,ticks:_$layout_attributes_596.ticks,ticklen:_$layout_attributes_596.ticklen,tickwidth:_$layout_attributes_596.tickwidth,tickcolor:_$layout_attributes_596.tickcolor,showticklabels:_$layout_attributes_596.showticklabels,showtickprefix:_$layout_attributes_596.showtickprefix,tickprefix:_$layout_attributes_596.tickprefix,showticksuffix:_$layout_attributes_596.showticksuffix,ticksuffix:_$layout_attributes_596.ticksuffix,showexponent:_$layout_attributes_596.showexponent,exponentformat:_$layout_attributes_596.exponentformat,separatethousands:_$layout_attributes_596.separatethousands,tickfont:_$layout_attributes_596.tickfont,tickangle:_$layout_attributes_596.tickangle,tickformat:_$layout_attributes_596.tickformat,tickformatstops:_$layout_attributes_596.tickformatstops,layer:_$layout_attributes_596.layer},"plot","from-root"),radialAxisAttrs={visible:__extendFlat_651({},_$layout_attributes_596.visible,{dflt:!0}),type:_$layout_attributes_596.type,autorange:_$layout_attributes_596.autorange,rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:_$layout_attributes_596.range,categoryorder:_$layout_attributes_596.categoryorder,categoryarray:_$layout_attributes_596.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:__extendFlat_651({},_$layout_attributes_596.title,{editType:"plot",dflt:""}),titlefont:__overrideAll_651(_$layout_attributes_596.titlefont,"plot","from-root"),hoverformat:_$layout_attributes_596.hoverformat,editType:"calc"};__extendFlat_651(radialAxisAttrs,axisLineGridAttr,axisTickAttrs);var angularAxisAttrs={visible:__extendFlat_651({},_$layout_attributes_596.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc"},categoryorder:_$layout_attributes_596.categoryorder,categoryarray:_$layout_attributes_596.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:_$layout_attributes_596.hoverformat,editType:"calc"};__extendFlat_651(angularAxisAttrs,axisLineGridAttr,axisTickAttrs);var _$layout_attributes_651={domain:__domainAttrs_651({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:_$attributes_410.background},radialaxis:radialAxisAttrs,angularaxis:angularAxisAttrs,editType:"calc"},_$helpers_649={};_$helpers_649.setConvertAngular=function setConvertAngular(ax){var _c2rad,_rad2c,dir={clockwise:-1,counterclockwise:1}[ax.direction],rot=_$lib_539.deg2rad(ax.rotation);function getTotalNumberOfCategories(){return ax.period?Math.max(ax.period,ax._categories.length):ax._categories.length}function unTransformRad(v){return(v-rot)/dir}"linear"===ax.type?(_c2rad=function(v,unit){return"degrees"===unit?_$lib_539.deg2rad(v):v},_rad2c=function(v,unit){return"degrees"===unit?_$lib_539.rad2deg(v):v}):"category"===ax.type&&(_c2rad=function(v){var tot=getTotalNumberOfCategories();return 2*v*Math.PI/tot},_rad2c=function(v){return v*getTotalNumberOfCategories()/Math.PI/2}),ax.unTransformRad=unTransformRad,ax._c2rad=_c2rad,ax.c2rad=function(v,unit){return function transformRad(v){return dir*v+rot}(_c2rad(v,unit))},ax.rad2c=function(v,unit){return _rad2c(unTransformRad(v),unit)},ax.c2deg=function(v,unit){return _$lib_539.rad2deg(ax.c2rad(v,unit))},ax.deg2c=function(v,unit){return ax.rad2c(_$lib_539.deg2rad(v),unit)}};var __getSubplotData_652=_$get_data_621.getSubplotData,setConvertAngular=_$helpers_649.setConvertAngular,axisNames=_$constants_648.axisNames;function __handleDefaults_652(contIn,contOut,coerce,opts){var bgColor=coerce("bgcolor");opts.bgColor=_$color_411.combine(bgColor,opts.paper_bgcolor);var axName,sector=coerce("sector"),subplotData=__getSubplotData_652(opts.fullData,_$constants_648.name,opts.id),layoutOut=opts.layoutOut;function coerceAxis(attr,dflt){return coerce(axName+"."+attr,dflt)}for(var i=0;i<axisNames.length;i++){axName=axisNames[i],_$lib_539.isPlainObject(contIn[axName])||(contIn[axName]={});var axIn=contIn[axName],axOut=contOut[axName]={};axOut._id=axOut._name=axName;var dataAttr=_$constants_648.axisName2dataArray[axName],axType=handleAxisTypeDefaults(axIn,axOut,coerceAxis,subplotData,dataAttr);_$handleCategoryOrderDefaults_588(axIn,axOut,coerceAxis),axOut._initialCategories="category"===axType?_$orderedCategories_599(dataAttr,axOut.categoryorder,axOut.categoryarray,subplotData):[];var dfltColor,dfltFontColor,visible=coerceAxis("visible");switch(_$setConvert_603(axOut,layoutOut),visible&&(dfltFontColor=(dfltColor=coerceAxis("color"))===axIn.color?dfltColor:opts.font.color),axOut._m=1,axName){case"radialaxis":var autoRange=coerceAxis("autorange",!axOut.isValidRange(axIn.range));axIn.autorange=autoRange,autoRange&&coerceAxis("rangemode"),"reversed"===autoRange&&(axOut._m=-1),coerceAxis("range"),axOut.cleanRange("range",{dfltRange:[0,1]}),visible&&(coerceAxis("side"),coerceAxis("angle",sector[0]),coerceAxis("title"),_$lib_539.coerceFont(coerceAxis,"titlefont",{family:opts.font.family,size:Math.round(1.2*opts.font.size),color:dfltFontColor}));break;case"angularaxis":if("date"===axType){_$lib_539.log("Polar plots do not support date angular axes yet.");for(var j=0;j<subplotData.length;j++)subplotData[j].visible=!1;axType=axIn.type=axOut.type="linear"}coerceAxis("linear"===axType?"thetaunit":"period"),coerceAxis("rotation",{counterclockwise:0,clockwise:90}[coerceAxis("direction")]),setConvertAngular(axOut)}if(visible)_$handleTickValueDefaults_606(axIn,axOut,coerceAxis,axOut.type),_$handleTickLabelDefaults_604(axIn,axOut,coerceAxis,axOut.type,{tickSuffixDflt:"degrees"===axOut.thetaunit?"°":void 0}),_$handleTickDefaults_605(axIn,axOut,coerceAxis,{outerTicks:!0}),coerceAxis("showticklabels")&&(_$lib_539.coerceFont(coerceAxis,"tickfont",{family:opts.font.family,size:opts.font.size,color:dfltFontColor}),coerceAxis("tickangle"),coerceAxis("tickformat")),_$handleLineGridDefaults_598(axIn,axOut,coerceAxis,{dfltColor:dfltColor,bgColor:opts.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:_$layout_attributes_651[axName]}),coerceAxis("layer");"category"!==axType&&coerceAxis("hoverformat"),axOut._input=axIn}}function handleAxisTypeDefaults(axIn,axOut,coerce,subplotData,dataAttr){if("-"===coerce("type")){for(var trace,i=0;i<subplotData.length;i++)if(subplotData[i].visible){trace=subplotData[i];break}trace&&(axOut.type=_$autoType_585(trace[dataAttr],"gregorian")),"-"===axOut.type?axOut.type="linear":axIn.type=axOut.type}return axOut.type}var __doAutoRange_659=_$autorange___doAutoRange,__MID_SHIFT_659=_$alignment_511.MID_SHIFT,____659=_$lib_539._,deg2rad=_$lib_539.deg2rad,rad2deg=_$lib_539.rad2deg,wrap360=_$lib_539.wrap360,__wrap180_659=_$lib_539.wrap180,__setConvertAngular_659=_$helpers_649.setConvertAngular;function __Polar_659(gd,id){this.id=id,this.gd=gd,this._hasClipOnAxisFalse=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var fullLayout=gd._fullLayout,clipIdBase="clip"+fullLayout._uid+id;this.clipIds.circle=clipIdBase+"-circle",this.clipPaths.circle=fullLayout._clips.append("clipPath").attr("id",this.clipIds.circle),this.clipPaths.circle.append("path"),this.framework=fullLayout._polarlayer.append("g").attr("class",id),this.radialTickLayout=null,this.angularTickLayout=null}var __proto_659=__Polar_659.prototype,_$createPolar_659=function createPolar(gd,id){return new __Polar_659(gd,id)};function setScale(ax,axLayout,fullLayout){_$axes_584.setConvert(ax,fullLayout),ax._min=axLayout._min,ax._max=axLayout._max,ax.setScale()}function strTickLayout(axLayout){var out=axLayout.ticks+String(axLayout.ticklen)+String(axLayout.showticklabels);return"side"in axLayout&&(out+=axLayout.side),out}function pathSector(r,sector){if(isFullCircle(sector))return _$drawing_436.symbolFuncs[0](r);var xs=r*Math.cos(deg2rad(sector[0])),ys=-r*Math.sin(deg2rad(sector[0])),xe=r*Math.cos(deg2rad(sector[1])),ye=-r*Math.sin(deg2rad(sector[1]));return"M"+[xs,ys]+"A"+[r,r]+" "+(Math.abs(sector[1]-sector[0])<=180?[0,0,0]:[0,1,0])+" "+[xe,ye]}function pathSectorClosed(r,sector){return pathSector(r,sector)+(isFullCircle(sector)?"":"L0,0Z")}function isFullCircle(sector){return 360===Math.abs(sector[1]-sector[0])}function updateElement(sel,showAttr,attrs){return showAttr?(sel.attr("display",null),sel.attr(attrs)):sel&&sel.attr("display","none"),sel}function strTranslate(x,y){return"translate("+x+","+y+")"}function strRotate(angle){return"rotate("+angle+")"}function __sign_659(v){return Math.abs(v)<1e-10?0:v>0?1:-1}function signCos(v){return __sign_659(Math.cos(v))}function signSin(v){return __sign_659(Math.sin(v))}__proto_659.plot=function(polarCalcData,fullLayout){var polarLayout=fullLayout[this.id];this._hasClipOnAxisFalse=!1;for(var i=0;i<polarCalcData.length;i++){if(!1===polarCalcData[i][0].trace.cliponaxis){this._hasClipOnAxisFalse=!0;break}}this.updateLayers(fullLayout,polarLayout),this.updateLayout(fullLayout,polarLayout),_$plots_647.generalUpdatePerTraceModule(this.gd,this,polarCalcData,polarLayout),this.updateFx(fullLayout,polarLayout)},__proto_659.updateLayers=function(fullLayout,polarLayout){var layers=this.layers,radialLayout=polarLayout.radialaxis,angularLayout=polarLayout.angularaxis,layerNames=_$constants_648.layerNames,frontPlotIndex=layerNames.indexOf("frontplot"),layerData=layerNames.slice(0,frontPlotIndex),isAngularAxisBelowTraces="below traces"===angularLayout.layer,isRadialAxisBelowTraces="below traces"===radialLayout.layer;isAngularAxisBelowTraces&&layerData.push("angular-axis"),isRadialAxisBelowTraces&&layerData.push("radial-axis"),isAngularAxisBelowTraces&&layerData.push("angular-line"),isRadialAxisBelowTraces&&layerData.push("radial-line"),layerData.push("frontplot"),isAngularAxisBelowTraces||layerData.push("angular-axis"),isRadialAxisBelowTraces||layerData.push("radial-axis"),isAngularAxisBelowTraces||layerData.push("angular-line"),isRadialAxisBelowTraces||layerData.push("radial-line");var join=this.framework.selectAll(".polarsublayer").data(layerData,String);join.enter().append("g").attr("class",function(d){return"polarsublayer "+d}).each(function(d){var sel=layers[d]=_$d3_127.select(this);switch(d){case"frontplot":sel.append("g").classed("scatterlayer",!0);break;case"backplot":sel.append("g").classed("maplayer",!0);break;case"plotbg":layers.bgcircle=sel.append("path");break;case"radial-grid":sel.style("fill","none"),sel.append("g").classed("x",1);break;case"angular-grid":sel.style("fill","none"),sel.append("g").classed("angular",1);break;case"radial-line":sel.append("line").style("fill","none");break;case"angular-line":sel.append("path").style("fill","none")}}),join.order()},__proto_659.updateLayout=function(fullLayout,polarLayout){var _this=this,layers=_this.layers,gs=fullLayout._size,xDomain=polarLayout.domain.x,yDomain=polarLayout.domain.y;_this.xOffset=gs.l+gs.w*xDomain[0],_this.yOffset=gs.t+gs.h*(1-yDomain[1]);var xLength2,yLength2,xDomain2,yDomain2,gap,xLength=_this.xLength=gs.w*(xDomain[1]-xDomain[0]),yLength=_this.yLength=gs.h*(yDomain[1]-yDomain[0]),sector=_this.sector=polarLayout.sector,sectorBBox=_this.sectorBBox=function computeSectorBBox(sector){var x0,y0,x1,y1,s0=sector[0],arc=sector[1]-s0,a0=wrap360(s0),a1=a0+arc,ax0=Math.cos(deg2rad(a0)),ay0=Math.sin(deg2rad(a0)),ax1=Math.cos(deg2rad(a1)),ay1=Math.sin(deg2rad(a1));y1=a0<=90&&a1>=90||a0>90&&a1>=450?1:ay0<=0&&ay1<=0?0:Math.max(ay0,ay1);x0=a0<=180&&a1>=180||a0>180&&a1>=540?-1:ax0>=0&&ax1>=0?0:Math.min(ax0,ax1);y0=a0<=270&&a1>=270||a0>270&&a1>=630?-1:ay0>=0&&ay1>=0?0:Math.min(ay0,ay1);x1=a1>=360?1:ax0<=0&&ax1<=0?0:Math.max(ax0,ax1);return[x0,y0,x1,y1]}(sector),dxSectorBBox=sectorBBox[2]-sectorBBox[0],dySectorBBox=sectorBBox[3]-sectorBBox[1],arDomain=yLength/xLength,arSector=Math.abs(dySectorBBox/dxSectorBBox);arDomain>arSector?(xLength2=xLength,gap=(yLength-(yLength2=xLength*arSector))/gs.h/2,xDomain2=[xDomain[0],xDomain[1]],yDomain2=[yDomain[0]+gap,yDomain[1]-gap]):(yLength2=yLength,gap=(xLength-(xLength2=yLength/arSector))/gs.w/2,xDomain2=[xDomain[0]+gap,xDomain[1]-gap],yDomain2=[yDomain[0],yDomain[1]]),_this.xLength2=xLength2,_this.yLength2=yLength2,_this.xDomain2=xDomain2,_this.yDomain2=yDomain2;var xOffset2=_this.xOffset2=gs.l+gs.w*xDomain2[0],yOffset2=_this.yOffset2=gs.t+gs.h*(1-yDomain2[1]),radius=_this.radius=xLength2/dxSectorBBox,cx=_this.cx=xOffset2-radius*sectorBBox[0],cy=_this.cy=yOffset2+radius*sectorBBox[3],cxx=_this.cxx=cx-xOffset2,cyy=_this.cyy=cy-yOffset2;_this.updateRadialAxis(fullLayout,polarLayout),_this.updateRadialAxisTitle(fullLayout,polarLayout),_this.updateAngularAxis(fullLayout,polarLayout);var radialRange=_this.radialAxis.range,rSpan=radialRange[1]-radialRange[0],xaxis=_this.xaxis={type:"linear",_id:"x",range:[sectorBBox[0]*rSpan,sectorBBox[2]*rSpan],domain:xDomain2};_$axes_584.setConvert(xaxis,fullLayout),xaxis.setScale();var yaxis=_this.yaxis={type:"linear",_id:"y",range:[sectorBBox[1]*rSpan,sectorBBox[3]*rSpan],domain:yDomain2};_$axes_584.setConvert(yaxis,fullLayout),yaxis.setScale(),xaxis.isPtWithinRange=function(d){return _this.isPtWithinSector(d)},yaxis.isPtWithinRange=function(){return!0},layers.frontplot.attr("transform",strTranslate(xOffset2,yOffset2)).call(_$drawing_436.setClipUrl,_this._hasClipOnAxisFalse?null:_this.clipIds.circle),layers.bgcircle.attr({d:pathSectorClosed(radius,sector),transform:strTranslate(cx,cy)}).call(_$color_411.fill,polarLayout.bgcolor),_this.clipPaths.circle.select("path").attr("d",pathSectorClosed(radius,sector)).attr("transform",strTranslate(cxx,cyy)),_this.framework.selectAll(".crisp").classed("crisp",0)},__proto_659.updateRadialAxis=function(fullLayout,polarLayout){var gd=this.gd,layers=this.layers,radius=this.radius,cx=this.cx,cy=this.cy,gs=fullLayout._size,radialLayout=polarLayout.radialaxis,sector=polarLayout.sector,a0=wrap360(sector[0]);this.fillViewInitialKey("radialaxis.angle",radialLayout.angle);var ax=this.radialAxis=_$lib_539.extendFlat({},radialLayout,{_axislayer:layers["radial-axis"],_gridlayer:layers["radial-grid"],_id:"x",_pos:0,side:{counterclockwise:"top",clockwise:"bottom"}[radialLayout.side],domain:[0,radius/gs.w],anchor:"free",position:0,_counteraxis:!0,automargin:!1});setScale(ax,radialLayout,fullLayout),__doAutoRange_659(ax),radialLayout.range=ax.range.slice(),radialLayout._input.range=ax.range.slice(),this.fillViewInitialKey("radialaxis.range",ax.range.slice()),"auto"===ax.tickangle&&a0>90&&a0<=270&&(ax.tickangle=180),ax._transfn=function(d){return"translate("+ax.l2p(d.x)+",0)"},ax._gridpath=function(d){return pathSector(ax.r2p(d.x),sector)};var newTickLayout=strTickLayout(radialLayout);this.radialTickLayout!==newTickLayout&&(layers["radial-axis"].selectAll(".xtick").remove(),this.radialTickLayout=newTickLayout),_$axes_584.doTicks(gd,ax,!0),updateElement(layers["radial-axis"],radialLayout.showticklabels||radialLayout.ticks,{transform:strTranslate(cx,cy)+strRotate(-radialLayout.angle)}),updateElement(layers["radial-grid"],radialLayout.showgrid,{transform:strTranslate(cx,cy)}).selectAll("path").attr("transform",null),updateElement(layers["radial-line"].select("line"),radialLayout.showline,{x1:0,y1:0,x2:radius,y2:0,transform:strTranslate(cx,cy)+strRotate(-radialLayout.angle)}).attr("stroke-width",radialLayout.linewidth).call(_$color_411.stroke,radialLayout.linecolor)},__proto_659.updateRadialAxisTitle=function(fullLayout,polarLayout,_angle){var gd=this.gd,radius=this.radius,cx=this.cx,cy=this.cy,radialLayout=polarLayout.radialaxis,titleClass=this.id+"title",angle=void 0!==_angle?_angle:radialLayout.angle,angleRad=deg2rad(angle),cosa=Math.cos(angleRad),sina=Math.sin(angleRad),pad=0;if(radialLayout.title){var h=_$drawing_436.bBox(this.layers["radial-axis"].node()).height,ts=radialLayout.titlefont.size;pad="counterclockwise"===radialLayout.side?-h-.4*ts:h+.8*ts}this.layers["radial-axis-title"]=_$titles_504.draw(gd,titleClass,{propContainer:radialLayout,propName:this.id+".radialaxis.title",placeholder:____659(gd,"Click to enter radial axis title"),attributes:{x:cx+radius/2*cosa+pad*sina,y:cy-radius/2*sina+pad*cosa,"text-anchor":"middle"},transform:{rotate:-angle}})},__proto_659.updateAngularAxis=function(fullLayout,polarLayout){var _this=this,gd=_this.gd,layers=_this.layers,radius=_this.radius,cx=_this.cx,cy=_this.cy,angularLayout=polarLayout.angularaxis,sector=polarLayout.sector,sectorInRad=sector.map(deg2rad);_this.fillViewInitialKey("angularaxis.rotation",angularLayout.rotation);var ax=_this.angularAxis=_$lib_539.extendFlat({},angularLayout,{_axislayer:layers["angular-axis"],_gridlayer:layers["angular-grid"],_id:"angular",_pos:0,side:"right",domain:[0,Math.PI],anchor:"free",position:0,_counteraxis:!0,automargin:!1,autorange:!1});if("linear"===ax.type)isFullCircle(sector)?ax.range=sector.slice():ax.range=sectorInRad.map(ax.unTransformRad).map(rad2deg),"radians"===ax.thetaunit&&(ax.tick0=rad2deg(ax.tick0),ax.dtick=rad2deg(ax.dtick));else if("category"===ax.type){var period=angularLayout.period?Math.max(angularLayout.period,angularLayout._categories.length):angularLayout._categories.length;ax.range=[0,period],ax._tickFilter=function(d){return _this.isPtWithinSector({r:_this.radialAxis.range[1],rad:ax.c2rad(d.x)})}}function c2rad(d){return ax.c2rad(d.x,"degrees")}function rad2xy(rad){return[radius*Math.cos(rad),radius*Math.sin(rad)]}setScale(ax,angularLayout,fullLayout),ax._transfn=function(d){var rad=c2rad(d),xy=rad2xy(rad),out=strTranslate(cx+xy[0],cy-xy[1]),sel=_$d3_127.select(this);return sel&&sel.node()&&sel.classed("ticks")&&(out+=strRotate(-rad2deg(rad))),out},ax._gridpath=function(d){var xy=rad2xy(c2rad(d));return"M0,0L"+-xy[0]+","+xy[1]};var offset4fontsize="outside"!==angularLayout.ticks?.7:.5;ax._labelx=function(d){var rad=c2rad(d),labelStandoff=ax._labelStandoff,pad=ax._pad;return(0===signSin(rad)?0:Math.cos(rad)*(labelStandoff+pad+offset4fontsize*d.fontSize))+signCos(rad)*(d.dx+labelStandoff+pad)},ax._labely=function(d){var rad=c2rad(d),labelStandoff=ax._labelStandoff,labelShift=ax._labelShift,pad=ax._pad;return d.dy+d.fontSize*__MID_SHIFT_659-labelShift+-Math.sin(rad)*(labelStandoff+pad+offset4fontsize*d.fontSize)},ax._labelanchor=function(angle,d){var rad=c2rad(d);return 0===signSin(rad)?signCos(rad)>0?"start":"end":"middle"};var newTickLayout=strTickLayout(angularLayout);_this.angularTickLayout!==newTickLayout&&(layers["angular-axis"].selectAll(".angulartick").remove(),_this.angularTickLayout=newTickLayout),_$axes_584.doTicks(gd,ax,!0),updateElement(layers["angular-line"].select("path"),angularLayout.showline,{d:pathSectorClosed(radius,sector),transform:strTranslate(cx,cy)}).attr("stroke-width",angularLayout.linewidth).call(_$color_411.stroke,angularLayout.linecolor)},__proto_659.updateFx=function(fullLayout,polarLayout){this.gd._context.staticPlot||(this.updateAngularDrag(fullLayout,polarLayout),this.updateRadialDrag(fullLayout,polarLayout),this.updateMainDrag(fullLayout,polarLayout))},__proto_659.updateMainDrag=function(fullLayout,polarLayout){var _this=this,gd=_this.gd,layers=_this.layers,zoomlayer=fullLayout._zoomlayer,MINZOOM=_$constants_648.MINZOOM,OFFEDGE=_$constants_648.OFFEDGE,radius=_this.radius,cx=_this.cx,cy=_this.cy,cxx=_this.cxx,cyy=_this.cyy,sector=polarLayout.sector,mainDrag=_$dragbox_592.makeDragger(layers,"path","maindrag","crosshair");_$d3_127.select(mainDrag).attr("d",pathSectorClosed(radius,sector)).attr("transform",strTranslate(cx,cy));var x0,y0,r0,r1,path0,dimmed,lum,zb,corners,dragOpts={element:mainDrag,gd:gd,subplot:_this.id,plotinfo:{xaxis:_this.xaxis,yaxis:_this.yaxis},xaxes:[_this.xaxis],yaxes:[_this.yaxis]};function xy2r(x,y){var xx=x-cxx,yy=y-cyy;return Math.sqrt(xx*xx+yy*yy)}function xy2a(x,y){return Math.atan2(cyy-y,x-cxx)}function ra2xy(r,a){return[r*Math.cos(a),r*Math.sin(-a)]}function pathCorner(r,a){var clen=_$constants_648.cornerLen,chw=_$constants_648.cornerHalfWidth;if(0===r)return pathSectorClosed(2*chw,sector);var da=clen/r/2,am=a-da,ap=a+da,rb=Math.max(0,Math.min(r,radius)),rm=rb-chw,rp=rb+chw;return"M"+ra2xy(rm,am)+"A"+[rm,rm]+" 0,0,0 "+ra2xy(rm,ap)+"L"+ra2xy(rp,ap)+"A"+[rp,rp]+" 0,0,1 "+ra2xy(rp,am)+"Z"}function zoomMove(dx,dy){var path1,cpath,x1=x0+dx,y1=y0+dy,rr0=xy2r(x0,y0),rr1=Math.min(xy2r(x1,y1),radius),a0=xy2a(x0,y0),a1=xy2a(x1,y1);rr0<OFFEDGE?rr0=0:radius-rr0<OFFEDGE?rr0=radius:rr1<OFFEDGE?rr1=0:radius-rr1<OFFEDGE&&(rr1=radius),Math.abs(rr1-rr0)>MINZOOM?(rr0<rr1?(r0=rr0,r1=rr1):(r0=rr1,r1=rr0,a1=[a0,a0=a1][0]),path1=path0+pathSectorClosed(r1,sector)+pathSectorClosed(r0,sector),cpath=pathCorner(r0,a0)+pathCorner(r1,a1)):(r0=null,r1=null,path1=path0,cpath="M0,0Z"),zb.attr("d",path1),corners.attr("d",cpath),_$dragbox_592.transitionZoombox(zb,corners,dimmed,lum),dimmed=!0}function zoomDone(){if(_$dragbox_592.removeZoombox(gd),null!==r0&&null!==r1){_$dragbox_592.showDoubleClickNotifier(gd);var radialRange=_this.radialAxis.range,drange=radialRange[1]-radialRange[0],updateObj={};updateObj[_this.id+".radialaxis.range"]=[radialRange[0]+r0*drange/radius,radialRange[0]+r1*drange/radius],_$registry_668.call("relayout",gd,updateObj)}}dragOpts.prepFn=function(evt,startX,startY){var dragModeNow=gd._fullLayout.dragmode,bbox=mainDrag.getBoundingClientRect();switch(x0=startX-bbox.left,y0=startY-bbox.top,dragModeNow){case"zoom":dragOpts.moveFn=zoomMove,dragOpts.doneFn=zoomDone,function zoomPrep(){r0=null,r1=null,path0=pathSectorClosed(radius,sector),dimmed=!1;var polarLayoutNow=gd._fullLayout[_this.id];lum=_$tinycolor_352(polarLayoutNow.bgcolor).getLuminance(),(zb=_$dragbox_592.makeZoombox(zoomlayer,lum,cx,cy,path0)).attr("fill-rule","evenodd"),corners=_$dragbox_592.makeCorners(zoomlayer,cx,cy),_$dragbox_592.clearSelect(zoomlayer)}();break;case"select":case"lasso":_$prepSelect_602(evt,startX,startY,dragOpts,dragModeNow)}},dragOpts.clickFn=function(numClicks,evt){if(_$dragbox_592.removeZoombox(gd),2===numClicks){var updateObj={};for(var k in _this.viewInitial)updateObj[_this.id+"."+k]=_this.viewInitial[k];gd.emit("plotly_doubleclick",null),_$registry_668.call("relayout",gd,updateObj)}_$fx_453.click(gd,evt,_this.id)},mainDrag.onmousemove=function(evt){_$fx_453.hover(gd,evt,_this.id),gd._fullLayout._lasthover=mainDrag,gd._fullLayout._hoversubplot=_this.id},mainDrag.onmouseout=function(evt){gd._dragging||_$dragelement_433.unhover(gd,evt)},_$dragelement_433.init(dragOpts)},__proto_659.updateRadialDrag=function(fullLayout,polarLayout){var _this=this,gd=_this.gd,layers=_this.layers,radius=_this.radius,cx=_this.cx,cy=_this.cy,radialAxis=_this.radialAxis,radialLayout=polarLayout.radialaxis,angle0=deg2rad(radialLayout.angle),range0=radialAxis.range.slice(),drange=range0[1]-range0[0],bl=_$constants_648.radialDragBoxSize,bl2=bl/2;if(radialLayout.visible){var moveFn2,angle1,rng1,radialDrag=_$dragbox_592.makeRectDragger(layers,"radialdrag","crosshair",-bl2,-bl2,bl,bl),dragOpts={element:radialDrag,gd:gd},tx=cx+(radius+bl2)*Math.cos(angle0),ty=cy-(radius+bl2)*Math.sin(angle0);_$d3_127.select(radialDrag).attr("transform",strTranslate(tx,ty)),dragOpts.prepFn=function(){moveFn2=null,angle1=null,rng1=null,dragOpts.moveFn=moveFn,dragOpts.doneFn=doneFn,_$dragbox_592.clearSelect(fullLayout._zoomlayer)},dragOpts.clampFn=function(dx,dy){return Math.sqrt(dx*dx+dy*dy)<_$constants_648.MINDRAG&&(dx=0,dy=0),[dx,dy]},_$dragelement_433.init(dragOpts)}function moveFn(dx,dy){if(moveFn2)moveFn2(dx,dy);else{var dvec=[dx,-dy],rvec=[Math.cos(angle0),Math.sin(angle0)],comp=Math.abs(_$lib_539.dot(dvec,rvec)/Math.sqrt(_$lib_539.dot(dvec,dvec)));isNaN(comp)||(moveFn2=comp<.5?rotateMove:rerangeMove)}}function doneFn(){null!==angle1?_$registry_668.call("relayout",gd,_this.id+".radialaxis.angle",angle1):null!==rng1&&_$registry_668.call("relayout",gd,_this.id+".radialaxis.range[1]",rng1)}function rotateMove(dx,dy){var x1=tx+dx,y1=ty+dy;angle1=rad2deg(Math.atan2(cy-y1,x1-cx));var transform=strTranslate(cx,cy)+strRotate(-angle1);layers["radial-axis"].attr("transform",transform),layers["radial-line"].select("line").attr("transform",transform);var fullLayoutNow=_this.gd._fullLayout,polarLayoutNow=fullLayoutNow[_this.id];_this.updateRadialAxisTitle(fullLayoutNow,polarLayoutNow,angle1)}function rerangeMove(dx,dy){var dr=_$lib_539.dot([dx,-dy],[Math.cos(angle0),Math.sin(angle0)]),rprime=range0[1]-drange*dr/radius*.75;if(drange>0==rprime>range0[0]){rng1=radialAxis.range[1]=rprime,_$axes_584.doTicks(gd,_this.radialAxis,!0),layers["radial-grid"].attr("transform",strTranslate(cx,cy)).selectAll("path").attr("transform",null);var rSpan=rng1-range0[0],sectorBBox=_this.sectorBBox;for(var k in _this.xaxis.range=[sectorBBox[0]*rSpan,sectorBBox[2]*rSpan],_this.yaxis.range=[sectorBBox[1]*rSpan,sectorBBox[3]*rSpan],_this.xaxis.setScale(),_this.yaxis.setScale(),_this.traceHash){var moduleCalcData=_this.traceHash[k],moduleCalcDataVisible=_$lib_539.filterVisible(moduleCalcData),_module=moduleCalcData[0][0].trace._module,polarLayoutNow=gd._fullLayout[_this.id];if(_module.plot(gd,_this,moduleCalcDataVisible,polarLayoutNow),!_$registry_668.traceIs(k,"gl"))for(var i=0;i<moduleCalcDataVisible.length;i++)_module.style(gd,moduleCalcDataVisible[i])}}}},__proto_659.updateAngularDrag=function(fullLayout,polarLayout){var _this=this,gd=_this.gd,layers=_this.layers,radius=_this.radius,cx=_this.cx,cy=_this.cy,cxx=_this.cxx,cyy=_this.cyy,sector=polarLayout.sector,dbs=_$constants_648.angularDragBoxSize,angularDrag=_$dragbox_592.makeDragger(layers,"path","angulardrag","move"),dragOpts={element:angularDrag,gd:gd};function xy2a(x,y){return Math.atan2(cyy+dbs-y,x-cxx-dbs)}_$d3_127.select(angularDrag).attr("d",function pathAnnulus(r0,r1,sector){var ss,sm,se,largeArc=Math.abs(sector[1]-sector[0])<=180?0:1;function pt(r,s){return[r*Math.cos(s),-r*Math.sin(s)]}function arc(r,s,cw){return"A"+[r,r]+" "+[0,largeArc,cw]+" "+pt(r,s)}return isFullCircle(sector)?(ss=0,se=2*Math.PI,sm=Math.PI,"M"+pt(r0,ss)+arc(r0,sm,0)+arc(r0,se,0)+"ZM"+pt(r1,ss)+arc(r1,sm,1)+arc(r1,se,1)+"Z"):(ss=deg2rad(sector[0]),se=deg2rad(sector[1]),"M"+pt(r0,ss)+"L"+pt(r1,ss)+arc(r1,se,0)+"L"+pt(r0,se)+arc(r0,ss,1)+"Z")}(radius,radius+dbs,sector)).attr("transform",strTranslate(cx,cy)).call(_$setCursor_558,"move");var x0,y0,rot0,rot1,sector0,a0,scatterTraces=layers.frontplot.select(".scatterlayer").selectAll(".trace"),scatterPoints=scatterTraces.selectAll(".point"),scatterTextPoints=scatterTraces.selectAll(".textpoint");function moveFn(dx,dy){var a1=xy2a(x0+dx,y0+dy),da=rad2deg(a1-a0);rot1=rot0+da,layers.frontplot.attr("transform",strTranslate(_this.xOffset2,_this.yOffset2)+strRotate([-da,cxx,cyy])),_this.clipPaths.circle.select("path").attr("transform",strTranslate(cxx,cyy)+strRotate(da)),scatterPoints.each(function(){var sel=_$d3_127.select(this),xy=_$drawing_436.getTranslate(sel);sel.attr("transform",strTranslate(xy.x,xy.y)+strRotate([da]))}),scatterTextPoints.each(function(){var sel=_$d3_127.select(this),tx=sel.select("text"),xy=_$drawing_436.getTranslate(sel);sel.attr("transform",strRotate([da,tx.attr("x"),tx.attr("y")])+strTranslate(xy.x,xy.y))});var angularAxis=_this.angularAxis;for(var k in angularAxis.rotation=__wrap180_659(rot1),"linear"!==angularAxis.type||isFullCircle(sector)||(angularAxis.range=sector0.map(deg2rad).map(angularAxis.unTransformRad).map(rad2deg)),__setConvertAngular_659(angularAxis),_$axes_584.doTicks(gd,angularAxis,!0),_this._hasClipOnAxisFalse&&!isFullCircle(sector)&&(_this.sector=[sector0[0]-da,sector0[1]-da],scatterTraces.call(_$drawing_436.hideOutsideRangePoints,_this)),_this.traceHash)if(_$registry_668.traceIs(k,"gl")){var moduleCalcData=_this.traceHash[k],moduleCalcDataVisible=_$lib_539.filterVisible(moduleCalcData),_module=moduleCalcData[0][0].trace._module,polarLayoutNow=gd._fullLayout[_this.id];_module.plot(gd,_this,moduleCalcDataVisible,polarLayoutNow)}}function doneFn(){scatterTextPoints.select("text").attr("transform",null);var updateObj={};updateObj[_this.id+".angularaxis.rotation"]=rot1,_$registry_668.call("relayout",gd,updateObj)}dragOpts.prepFn=function(evt,startX,startY){var polarLayoutNow=fullLayout[_this.id];sector0=polarLayoutNow.sector.slice(),rot0=polarLayoutNow.angularaxis.rotation;var bbox=angularDrag.getBoundingClientRect();x0=startX-bbox.left,y0=startY-bbox.top,a0=xy2a(x0,y0),dragOpts.moveFn=moveFn,dragOpts.doneFn=doneFn,_$dragbox_592.clearSelect(fullLayout._zoomlayer)},_$dragelement_433.init(dragOpts)},__proto_659.isPtWithinSector=function(d){var sector=this.sector,radialAxis=this.radialAxis,radialRange=radialAxis.range,r=radialAxis.c2r(d.r),s0=wrap360(sector[0]),s1=wrap360(sector[1]);s0>s1&&(s1+=360);var r0,r1,deg=wrap360(rad2deg(d.rad)),nextTurnDeg=deg+360;return radialRange[1]>=radialRange[0]?(r0=radialRange[0],r1=radialRange[1]):(r0=radialRange[1],r1=radialRange[0]),r>=r0&&r<=r1&&(isFullCircle(sector)||deg>=s0&&deg<=s1||nextTurnDeg>=s0&&nextTurnDeg<=s1)},__proto_659.fillViewInitialKey=function(key,val){key in this.viewInitial||(this.viewInitial[key]=val)};var __getSubplotCalcData_650=_$get_data_621.getSubplotCalcData,__counterRegex_650=_$lib_539.counterRegex,attr=_$constants_648.attr,__name_650=_$constants_648.name,counter=__counterRegex_650(__name_650),__attributes_650={};__attributes_650[attr]={valType:"subplotid",dflt:__name_650,editType:"calc"};var _$polar_650={attr:attr,name:__name_650,idRoot:__name_650,idRegex:counter,attrRegex:counter,attributes:__attributes_650,layoutAttributes:_$layout_attributes_651,supplyLayoutDefaults:function supplyLayoutDefaults(layoutIn,layoutOut,fullData){_$handleSubplotDefaults_660(layoutIn,layoutOut,0,{type:_$constants_648.name,attributes:_$layout_attributes_651,handleDefaults:__handleDefaults_652,font:layoutOut.font,paper_bgcolor:layoutOut.paper_bgcolor,fullData:fullData,layoutOut:layoutOut})},plot:function __plot_650(gd){for(var fullLayout=gd._fullLayout,calcData=gd.calcdata,subplotIds=fullLayout._subplots[__name_650],i=0;i<subplotIds.length;i++){var id=subplotIds[i],subplotCalcData=__getSubplotCalcData_650(calcData,__name_650,id),subplot=fullLayout[id]._subplot;subplot||(subplot=_$createPolar_659(gd,id),fullLayout[id]._subplot=subplot),subplot.plot(subplotCalcData,fullLayout,gd._promises)}},clean:function clean(newFullData,newFullLayout,oldFullData,oldFullLayout){for(var oldIds=oldFullLayout._subplots[__name_650]||[],i=0;i<oldIds.length;i++){var id=oldIds[i],oldSubplot=oldFullLayout[id]._subplot;if(!newFullLayout[id]&&oldSubplot)for(var k in oldSubplot.framework.remove(),oldSubplot.layers["radial-axis-title"].remove(),oldSubplot.clipPaths)oldSubplot.clipPaths[k].remove()}},toSVG:_$cartesian_595.toSVG},__extendFlat_920=_$extend_528.extendFlat,__lineAttrs_920=_$attributes_862.line,_$attributes_920={mode:_$attributes_862.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:_$attributes_862.text,hovertext:_$attributes_862.hovertext,line:{color:__lineAttrs_920.color,width:__lineAttrs_920.width,dash:__lineAttrs_920.dash,shape:__extendFlat_920({},__lineAttrs_920.shape,{values:["linear","spline"]}),smoothing:__lineAttrs_920.smoothing,editType:"calc"},connectgaps:_$attributes_862.connectgaps,marker:_$attributes_862.marker,cliponaxis:__extendFlat_920({},_$attributes_862.cliponaxis,{dflt:!1}),textposition:_$attributes_862.textposition,textfont:_$attributes_862.textfont,fill:__extendFlat_920({},_$attributes_862.fill,{values:["none","toself","tonext"]}),fillcolor:_$attributes_862.fillcolor,hoverinfo:__extendFlat_920({},_$attributes_581.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:_$attributes_862.hoveron,selected:_$attributes_862.selected,unselected:_$attributes_862.unselected},__BADNUM_921=_$numerical_517.BADNUM,__calcMarkerSize_921=_$calc___calcMarkerSize,PTS_LINESONLY=_$constants_868.PTS_LINESONLY;function makeHoverPointText(cdi,trace,subplot){var radialAxis=subplot.radialAxis,angularAxis=subplot.angularAxis,parts=(cdi.hi||trace.hoverinfo).split("+"),text=[];radialAxis._hovertitle="r",angularAxis._hovertitle="θ";var theta,rad=angularAxis._c2rad(cdi.theta,trace.thetaunit);function textPart(ax,val){text.push(ax._hovertitle+": "+_$axes_584.tickText(ax,val,"hover").text)}return theta="linear"===angularAxis.type&&trace.thetaunit!==angularAxis.thetaunit?"degrees"===angularAxis.thetaunit?_$lib_539.rad2deg(rad):rad:cdi.theta,-1!==parts.indexOf("all")&&(parts=["r","theta"]),-1!==parts.indexOf("r")&&textPart(radialAxis,radialAxis.c2r(cdi.r)),-1!==parts.indexOf("theta")&&textPart(angularAxis,theta),text.join("<br>")}var _$hover_923={hoverPoints:function __hoverPoints_923(pointData,xval,yval,hovermode){var scatterPointData=_$hoverPoints_873(pointData,xval,yval,hovermode);if(scatterPointData&&!1!==scatterPointData[0].index){var newPointData=scatterPointData[0];if(void 0===newPointData.index)return scatterPointData;var subplot=pointData.subplot,cdi=newPointData.cd[newPointData.index],trace=newPointData.trace;if(subplot.isPtWithinSector(cdi))return newPointData.xLabelVal=void 0,newPointData.yLabelVal=void 0,newPointData.extraText=makeHoverPointText(cdi,trace,subplot),scatterPointData}},makeHoverPointText:makeHoverPointText},__BADNUM_925=_$numerical_517.BADNUM,_$scatterpolar_32={moduleType:"trace",name:"scatterpolar",basePlotModule:_$polar_650,categories:["polar","symbols","markerColorscale","showLegend","scatter-like"],attributes:_$attributes_920,supplyDefaults:function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_920,attr,dflt)}var r=coerce("r"),theta=coerce("theta"),len=r&&theta?Math.min(r.length,theta.length):0;if(len){traceOut._length=len,coerce("thetaunit"),coerce("mode",len<PTS_LINESONLY?"lines+markers":"lines"),coerce("text"),coerce("hovertext"),_$subtypes_884.hasLines(traceOut)&&(_$lineDefaults_875(traceIn,traceOut,defaultColor,layout,coerce),_$handleLineShapeDefaults_877(0,0,coerce),coerce("connectgaps")),_$subtypes_884.hasMarkers(traceOut)&&_$markerDefaults_880(traceIn,traceOut,defaultColor,layout,coerce,{gradient:!0}),_$subtypes_884.hasText(traceOut)&&_$text_defaults_885(0,0,layout,coerce);var dfltHoverOn=[];(_$subtypes_884.hasMarkers(traceOut)||_$subtypes_884.hasText(traceOut))&&(coerce("cliponaxis"),coerce("marker.maxdisplayed"),dfltHoverOn.push("points")),coerce("fill"),"none"!==traceOut.fill&&(_$fillColorDefaults_871(0,traceOut,defaultColor,coerce),_$subtypes_884.hasLines(traceOut)||_$handleLineShapeDefaults_877(0,0,coerce)),"tonext"!==traceOut.fill&&"toself"!==traceOut.fill||dfltHoverOn.push("fills"),coerce("hoveron",dfltHoverOn.join("+")||"points"),_$lib_539.coerceSelectionMarkerOpacity(traceOut,coerce)}else traceOut.visible=!1},calc:function calc(gd,trace){var v,fullLayout=gd._fullLayout,subplotId=trace.subplot,radialAxis=fullLayout[subplotId].radialaxis,angularAxis=fullLayout[subplotId].angularaxis,rArray=radialAxis.makeCalcdata(trace,"r"),thetaArray=angularAxis.makeCalcdata(trace,"theta"),len=trace._length,cd=new Array(len);for(var i=0;i<len;i++){var r=rArray[i],theta=thetaArray[i],cdi=cd[i]={};_$fastIsnumeric_139(r)&&_$fastIsnumeric_139(theta)?(cdi.r=r,cdi.theta=theta,cdi.rad=(v=theta,angularAxis.c2rad(v,trace.thetaunit))):cdi.r=__BADNUM_921}var ppad=__calcMarkerSize_921(trace,len);return _$axes_584.expand(radialAxis,rArray,{ppad:ppad}),_$calcMarkerColorscale_867(trace),_$arraysToCalcdata_861(cd,trace),_$calcSelection_864(cd,trace),cd},plot:function plot(gd,subplot,moduleCalcData){var i,j,rFilter,plotinfo={xaxis:subplot.xaxis,yaxis:subplot.yaxis,plot:subplot.framework,layerClipId:subplot._hasClipOnAxisFalse?subplot.clipIds.circle:null},radialAxis=subplot.radialAxis,radialRange=radialAxis.range;for(rFilter=radialRange[0]>radialRange[1]?function(v){return v<=0}:function(v){return v>=0},i=0;i<moduleCalcData.length;i++)for(j=0;j<moduleCalcData[i].length;j++){var cdi=moduleCalcData[i][j],r=cdi.r;if(r!==__BADNUM_925){var rr=radialAxis.c2r(r)-radialRange[0];if(rFilter(rr)){var rad=cdi.rad;cdi.x=rr*Math.cos(rad),cdi.y=rr*Math.sin(rad);continue}cdi.intoCenter=[subplot.cxx,subplot.cyy]}cdi.x=__BADNUM_925,cdi.y=__BADNUM_925}_$plot_881(gd,plotinfo,moduleCalcData)},style:_$style_883.style,hoverPoints:_$hover_923.hoverPoints,selectPoints:_$selectPoints_882,meta:{}},_$attributes_926={mode:_$attributes_920.mode,r:_$attributes_920.r,theta:_$attributes_920.theta,thetaunit:_$attributes_920.thetaunit,text:_$attributes_920.text,line:_$attributes_909.line,connectgaps:_$attributes_909.connectgaps,marker:_$attributes_909.marker,fill:_$attributes_909.fill,fillcolor:_$attributes_909.fillcolor,hoverinfo:_$attributes_920.hoverinfo,hoveron:_$attributes_920.hoveron,selected:_$attributes_920.selected,unselected:_$attributes_920.unselected},__PTS_LINESONLY_927=_$constants_868.PTS_LINESONLY,__makeHoverPointText_928=_$hover_923.makeHoverPointText;var _$scatterpolargl_33={moduleType:"trace",name:"scatterpolargl",basePlotModule:_$polar_650,categories:["gl","regl","polar","symbols","markerColorscale","showLegend","scatter-like"],attributes:_$attributes_926,supplyDefaults:function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_926,attr,dflt)}var r=coerce("r"),theta=coerce("theta"),len=r&&theta?Math.min(r.length,theta.length):0;if(len){traceOut._length=len,coerce("thetaunit"),coerce("mode",len<__PTS_LINESONLY_927?"lines+markers":"lines"),coerce("text"),_$subtypes_884.hasLines(traceOut)&&(_$lineDefaults_875(traceIn,traceOut,defaultColor,layout,coerce),coerce("connectgaps"));var dfltHoverOn=[];_$subtypes_884.hasMarkers(traceOut)&&(_$markerDefaults_880(traceIn,traceOut,defaultColor,layout,coerce),dfltHoverOn.push("points")),coerce("fill"),"none"!==traceOut.fill&&_$fillColorDefaults_871(0,traceOut,defaultColor,coerce),"tonext"!==traceOut.fill&&"toself"!==traceOut.fill||dfltHoverOn.push("fills"),coerce("hoveron",dfltHoverOn.join("+")||"points"),_$lib_539.coerceSelectionMarkerOpacity(traceOut,coerce)}else traceOut.visible=!1},calc:function __calc_928(container,trace){var layout=container._fullLayout,subplotId=trace.subplot,radialAxis=layout[subplotId].radialaxis,angularAxis=layout[subplotId].angularaxis,rArray=radialAxis.makeCalcdata(trace,"r"),thetaArray=angularAxis.makeCalcdata(trace,"theta"),stash={};return trace._length<rArray.length&&(rArray=rArray.slice(0,trace._length)),trace._length<thetaArray.length&&(thetaArray=thetaArray.slice(0,trace._length)),_$calcMarkerColorscale_867(trace),stash.r=rArray,stash.theta=thetaArray,_$axes_584.expand(radialAxis,rArray,{tozero:!0}),"linear"!==angularAxis.type&&(angularAxis.autorange=!0,_$axes_584.expand(angularAxis,thetaArray),delete angularAxis.autorange),[{x:!1,y:!1,t:stash,trace:trace}]},plot:function __plot_928(container,subplot,cdata){var radialAxis=subplot.radialAxis,angularAxis=subplot.angularAxis,rRange=radialAxis.range,scene=_$scattergl_911.sceneUpdate(container,subplot);return scene.clear(),cdata.forEach(function(cdscatter,traceIndex){if(cdscatter&&cdscatter[0]&&cdscatter[0].trace){var i,r,rr,theta,rad,cd=cdscatter[0],trace=cd.trace,stash=cd.t,rArray=stash.r,thetaArray=stash.theta,subRArray=rArray.slice(),subThetaArray=thetaArray.slice();for(i=0;i<rArray.length;i++)r=rArray[i],theta=thetaArray[i],rad=angularAxis.c2rad(theta,trace.thetaunit),subplot.isPtWithinSector({r:r,rad:rad})||(subRArray[i]=NaN,subThetaArray[i]=NaN);var v,count=rArray.length,positions=new Array(2*count),x=Array(count),y=Array(count);for(i=0;i<count;i++)r=subRArray[i],theta=subThetaArray[i],_$fastIsnumeric_139(r)&&_$fastIsnumeric_139(theta)&&r>=0?(rr=radialAxis.c2r(r)-rRange[0],v=theta,rad=angularAxis.c2rad(v,trace.thetaunit),x[i]=positions[2*i]=rr*Math.cos(rad),y[i]=positions[2*i+1]=rr*Math.sin(rad)):x[i]=y[i]=positions[2*i]=positions[2*i+1]=NaN;var options=_$scattergl_911.sceneOptions(container,subplot,trace,positions);options.fill&&!scene.fill2d&&(scene.fill2d=!0),options.marker&&!scene.scatter2d&&(scene.scatter2d=!0),options.line&&!scene.line2d&&(scene.line2d=!0),!options.errorX&&!options.errorY||scene.error2d||(scene.error2d=!0),_$subtypes_884.hasMarkers(trace)&&(options.selected.positions=options.unselected.positions=options.marker.positions),scene.lineOptions.push(options.line),scene.errorXOptions.push(options.errorX),scene.errorYOptions.push(options.errorY),scene.fillOptions.push(options.fill),scene.markerOptions.push(options.marker),scene.selectedOptions.push(options.selected),scene.unselectedOptions.push(options.unselected),scene.count=cdata.length,stash.scene=scene,stash.index=traceIndex,stash.x=x,stash.y=y,stash.rawx=x,stash.rawy=y,stash.r=rArray,stash.theta=thetaArray,stash.positions=positions,stash.count=count,stash.tree=_$KDTree_252(positions,512)}}),_$scattergl_911.plot(container,subplot,cdata)},hoverPoints:function __hoverPoints_928(pointData,xval,yval,hovermode){var stash=pointData.cd[0].t,rArray=stash.r,thetaArray=stash.theta,scatterPointData=_$scattergl_911.hoverPoints(pointData,xval,yval,hovermode);if(scatterPointData&&!1!==scatterPointData[0].index){var newPointData=scatterPointData[0];if(void 0===newPointData.index)return scatterPointData;var subplot=pointData.subplot,angularAxis=subplot.angularAxis,cdi=newPointData.cd[newPointData.index],trace=newPointData.trace;if(cdi.r=rArray[newPointData.index],cdi.theta=thetaArray[newPointData.index],cdi.rad=angularAxis.c2rad(cdi.theta,trace.thetaunit),subplot.isPtWithinSector(cdi))return newPointData.xLabelVal=void 0,newPointData.yLabelVal=void 0,newPointData.extraText=__makeHoverPointText_928(cdi,trace,subplot),scatterPointData}},style:_$scattergl_911.style,selectPoints:_$scattergl_911.selectPoints,meta:{}},__extendFlat_663=_$extend_528.extendFlat,_$axis_attributes_663={title:_$layout_attributes_596.title,titlefont:_$layout_attributes_596.titlefont,color:_$layout_attributes_596.color,tickmode:_$layout_attributes_596.tickmode,nticks:__extendFlat_663({},_$layout_attributes_596.nticks,{dflt:6,min:1}),tick0:_$layout_attributes_596.tick0,dtick:_$layout_attributes_596.dtick,tickvals:_$layout_attributes_596.tickvals,ticktext:_$layout_attributes_596.ticktext,ticks:_$layout_attributes_596.ticks,ticklen:_$layout_attributes_596.ticklen,tickwidth:_$layout_attributes_596.tickwidth,tickcolor:_$layout_attributes_596.tickcolor,showticklabels:_$layout_attributes_596.showticklabels,showtickprefix:_$layout_attributes_596.showtickprefix,tickprefix:_$layout_attributes_596.tickprefix,showticksuffix:_$layout_attributes_596.showticksuffix,ticksuffix:_$layout_attributes_596.ticksuffix,showexponent:_$layout_attributes_596.showexponent,exponentformat:_$layout_attributes_596.exponentformat,separatethousands:_$layout_attributes_596.separatethousands,tickfont:_$layout_attributes_596.tickfont,tickangle:_$layout_attributes_596.tickangle,tickformat:_$layout_attributes_596.tickformat,tickformatstops:_$layout_attributes_596.tickformatstops,hoverformat:_$layout_attributes_596.hoverformat,showline:__extendFlat_663({},_$layout_attributes_596.showline,{dflt:!0}),linecolor:_$layout_attributes_596.linecolor,linewidth:_$layout_attributes_596.linewidth,showgrid:__extendFlat_663({},_$layout_attributes_596.showgrid,{dflt:!0}),gridcolor:_$layout_attributes_596.gridcolor,gridwidth:_$layout_attributes_596.gridwidth,layer:_$layout_attributes_596.layer,min:{valType:"number",dflt:0,min:0}},_$supplyLayoutDefaults_664=function supplyLayoutDefaults(containerIn,containerOut,options){function coerce(attr,dflt){return _$lib_539.coerce(containerIn,containerOut,_$axis_attributes_663,attr,dflt)}containerOut.type="linear";var dfltColor=coerce("color"),dfltFontColor=dfltColor===containerIn.color?dfltColor:options.font.color,letterUpper=containerOut._name.charAt(0).toUpperCase(),dfltTitle="Component "+letterUpper,title=coerce("title",dfltTitle);containerOut._hovertitle=title===dfltTitle?title:letterUpper,_$lib_539.coerceFont(coerce,"titlefont",{family:options.font.family,size:Math.round(1.2*options.font.size),color:dfltFontColor}),coerce("min"),_$handleTickValueDefaults_606(containerIn,containerOut,coerce,"linear"),_$handleTickLabelDefaults_604(containerIn,containerOut,coerce,"linear",{}),_$handleTickDefaults_605(containerIn,containerOut,coerce,{outerTicks:!0}),coerce("showticklabels")&&(_$lib_539.coerceFont(coerce,"tickfont",{family:options.font.family,size:options.font.size,color:dfltFontColor}),coerce("tickangle"),coerce("tickformat")),_$handleLineGridDefaults_598(containerIn,containerOut,coerce,{dfltColor:dfltColor,bgColor:options.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:_$axis_attributes_663}),coerce("hoverformat"),coerce("layer")},__domainAttrs_666=_$domain_610.attributes,_$layout_attributes_666=(0,_$edit_types_569.overrideAll)({domain:__domainAttrs_666({name:"ternary"}),bgcolor:{valType:"color",dflt:_$attributes_410.background},sum:{valType:"number",dflt:1,min:0},aaxis:_$axis_attributes_663,baxis:_$axis_attributes_663,caxis:_$axis_attributes_663},"plot","from-root"),__axesNames_665=["aaxis","baxis","caxis"];function handleTernaryDefaults(ternaryLayoutIn,ternaryLayoutOut,coerce,options){var axName,containerIn,containerOut,bgColor=coerce("bgcolor"),sum=coerce("sum");options.bgColor=_$color_411.combine(bgColor,options.paper_bgcolor);for(var j=0;j<__axesNames_665.length;j++)containerIn=ternaryLayoutIn[axName=__axesNames_665[j]]||{},containerOut=ternaryLayoutOut[axName]={_name:axName,type:"linear"},_$supplyLayoutDefaults_664(containerIn,containerOut,options);var aaxis=ternaryLayoutOut.aaxis,baxis=ternaryLayoutOut.baxis,caxis=ternaryLayoutOut.caxis;aaxis.min+baxis.min+caxis.min>=sum&&(aaxis.min=0,baxis.min=0,caxis.min=0,ternaryLayoutIn.aaxis&&delete ternaryLayoutIn.aaxis.min,ternaryLayoutIn.baxis&&delete ternaryLayoutIn.baxis.min,ternaryLayoutIn.caxis&&delete ternaryLayoutIn.caxis.min)}var ____667=_$lib_539._,__extendFlat_667=_$extend_528.extendFlat;function Ternary(options,fullLayout){this.id=options.id,this.graphDiv=options.graphDiv,this.init(fullLayout),this.makeFramework(fullLayout)}var _$Ternary_667=Ternary,__proto_667=Ternary.prototype;__proto_667.init=function(fullLayout){this.container=fullLayout._ternarylayer,this.defs=fullLayout._defs,this.layoutId=fullLayout._uid,this.traceHash={},this.layers={}},__proto_667.plot=function(ternaryCalcData,fullLayout){var ternaryLayout=fullLayout[this.id],graphSize=fullLayout._size;this._hasClipOnAxisFalse=!1;for(var i=0;i<ternaryCalcData.length;i++){if(!1===ternaryCalcData[i][0].trace.cliponaxis){this._hasClipOnAxisFalse=!0;break}}this.updateLayers(ternaryLayout),this.adjustLayout(ternaryLayout,graphSize),_$plots_647.generalUpdatePerTraceModule(this.graphDiv,this,ternaryCalcData,ternaryLayout),this.layers.plotbg.select("path").call(_$color_411.fill,ternaryLayout.bgcolor)},__proto_667.makeFramework=function(fullLayout){var ternaryLayout=fullLayout[this.id],clipId=this.clipId="clip"+this.layoutId+this.id;this.clipDef=fullLayout._clips.selectAll("#"+clipId).data([0]),this.clipDef.enter().append("clipPath").attr("id",clipId).append("path").attr("d","M0,0Z");var clipIdRelative=this.clipIdRelative="clip-relative"+this.layoutId+this.id;this.clipDefRelative=fullLayout._clips.selectAll("#"+clipIdRelative).data([0]),this.clipDefRelative.enter().append("clipPath").attr("id",clipIdRelative).append("path").attr("d","M0,0Z"),this.plotContainer=this.container.selectAll("g."+this.id).data([0]),this.plotContainer.enter().append("g").classed(this.id,!0),this.updateLayers(ternaryLayout),_$drawing_436.setClipUrl(this.layers.backplot,clipId),_$drawing_436.setClipUrl(this.layers.grids,clipId)},__proto_667.updateLayers=function(ternaryLayout){var layers=this.layers,plotLayers=["draglayer","plotbg","backplot","grids"];"below traces"===ternaryLayout.aaxis.layer&&plotLayers.push("aaxis","aline"),"below traces"===ternaryLayout.baxis.layer&&plotLayers.push("baxis","bline"),"below traces"===ternaryLayout.caxis.layer&&plotLayers.push("caxis","cline"),plotLayers.push("frontplot"),"above traces"===ternaryLayout.aaxis.layer&&plotLayers.push("aaxis","aline"),"above traces"===ternaryLayout.baxis.layer&&plotLayers.push("baxis","bline"),"above traces"===ternaryLayout.caxis.layer&&plotLayers.push("caxis","cline");var toplevel=this.plotContainer.selectAll("g.toplevel").data(plotLayers,String),grids=["agrid","bgrid","cgrid"];toplevel.enter().append("g").attr("class",function(d){return"toplevel "+d}).each(function(d){var s=_$d3_127.select(this);layers[d]=s,"frontplot"===d?s.append("g").classed("scatterlayer",!0):"backplot"===d?s.append("g").classed("maplayer",!0):"plotbg"===d?s.append("path").attr("d","M0,0Z"):"aline"===d||"bline"===d||"cline"===d?s.append("path"):"grids"===d&&grids.forEach(function(d){layers[d]=s.append("g").classed("grid "+d,!0);var fictID="bgrid"===d?"x":"y";layers[d].append("g").classed(fictID,!0)})}),toplevel.order()};var w_over_h=Math.sqrt(4/3);__proto_667.adjustLayout=function(ternaryLayout,graphSize){var x0,y0,w,h,xDomainFinal,yDomainFinal,_this=this,domain=ternaryLayout.domain,xDomainCenter=(domain.x[0]+domain.x[1])/2,yDomainCenter=(domain.y[0]+domain.y[1])/2,xDomain=domain.x[1]-domain.x[0],yDomain=domain.y[1]-domain.y[0],wmax=xDomain*graphSize.w,hmax=yDomain*graphSize.h,sum=ternaryLayout.sum,amin=ternaryLayout.aaxis.min,bmin=ternaryLayout.baxis.min,cmin=ternaryLayout.caxis.min;wmax>w_over_h*hmax?w=(h=hmax)*w_over_h:h=(w=wmax)/w_over_h,xDomainFinal=xDomain*w/wmax,yDomainFinal=yDomain*h/hmax,x0=graphSize.l+graphSize.w*xDomainCenter-w/2,y0=graphSize.t+graphSize.h*(1-yDomainCenter)-h/2,_this.x0=x0,_this.y0=y0,_this.w=w,_this.h=h,_this.sum=sum,_this.xaxis={type:"linear",range:[amin+2*cmin-sum,sum-amin-2*bmin],domain:[xDomainCenter-xDomainFinal/2,xDomainCenter+xDomainFinal/2],_id:"x"},_$setConvert_603(_this.xaxis,_this.graphDiv._fullLayout),_this.xaxis.setScale(),_this.xaxis.isPtWithinRange=function(d){return d.a>=_this.aaxis.range[0]&&d.a<=_this.aaxis.range[1]&&d.b>=_this.baxis.range[1]&&d.b<=_this.baxis.range[0]&&d.c>=_this.caxis.range[1]&&d.c<=_this.caxis.range[0]},_this.yaxis={type:"linear",range:[amin,sum-bmin-cmin],domain:[yDomainCenter-yDomainFinal/2,yDomainCenter+yDomainFinal/2],_id:"y"},_$setConvert_603(_this.yaxis,_this.graphDiv._fullLayout),_this.yaxis.setScale(),_this.yaxis.isPtWithinRange=function(){return!0};var yDomain0=_this.yaxis.domain[0],aaxis=_this.aaxis=__extendFlat_667({},ternaryLayout.aaxis,{visible:!0,range:[amin,sum-bmin-cmin],side:"left",_counterangle:30,tickangle:(+ternaryLayout.aaxis.tickangle||0)-30,domain:[yDomain0,yDomain0+yDomainFinal*w_over_h],_axislayer:_this.layers.aaxis,_gridlayer:_this.layers.agrid,_pos:0,_id:"y",_length:w,_gridpath:"M0,0l"+h+",-"+w/2,automargin:!1});_$setConvert_603(aaxis,_this.graphDiv._fullLayout),aaxis.setScale();var baxis=_this.baxis=__extendFlat_667({},ternaryLayout.baxis,{visible:!0,range:[sum-amin-cmin,bmin],side:"bottom",_counterangle:30,domain:_this.xaxis.domain,_axislayer:_this.layers.baxis,_gridlayer:_this.layers.bgrid,_counteraxis:_this.aaxis,_pos:0,_id:"x",_length:w,_gridpath:"M0,0l-"+w/2+",-"+h,automargin:!1});_$setConvert_603(baxis,_this.graphDiv._fullLayout),baxis.setScale(),aaxis._counteraxis=baxis;var caxis=_this.caxis=__extendFlat_667({},ternaryLayout.caxis,{visible:!0,range:[sum-amin-bmin,cmin],side:"right",_counterangle:30,tickangle:(+ternaryLayout.caxis.tickangle||0)+30,domain:[yDomain0,yDomain0+yDomainFinal*w_over_h],_axislayer:_this.layers.caxis,_gridlayer:_this.layers.cgrid,_counteraxis:_this.baxis,_pos:0,_id:"y",_length:w,_gridpath:"M0,0l-"+h+","+w/2,automargin:!1});_$setConvert_603(caxis,_this.graphDiv._fullLayout),caxis.setScale();var triangleClip="M"+x0+","+(y0+h)+"h"+w+"l-"+w/2+",-"+h+"Z";_this.clipDef.select("path").attr("d",triangleClip),_this.layers.plotbg.select("path").attr("d",triangleClip);var triangleClipRelative="M0,"+h+"h"+w+"l-"+w/2+",-"+h+"Z";_this.clipDefRelative.select("path").attr("d",triangleClipRelative);var plotTransform="translate("+x0+","+y0+")";_this.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",plotTransform),_this.clipDefRelative.select("path").attr("transform",null);var bTransform="translate("+(x0-baxis._offset)+","+(y0+h)+")";_this.layers.baxis.attr("transform",bTransform),_this.layers.bgrid.attr("transform",bTransform);var aTransform="translate("+(x0+w/2)+","+y0+")rotate(30)translate(0,"+-aaxis._offset+")";_this.layers.aaxis.attr("transform",aTransform),_this.layers.agrid.attr("transform",aTransform);var cTransform="translate("+(x0+w/2)+","+y0+")rotate(-30)translate(0,"+-caxis._offset+")";_this.layers.caxis.attr("transform",cTransform),_this.layers.cgrid.attr("transform",cTransform),_this.drawAxes(!0),_this.plotContainer.selectAll(".crisp").classed("crisp",!1),_this.layers.aline.select("path").attr("d",aaxis.showline?"M"+x0+","+(y0+h)+"l"+w/2+",-"+h:"M0,0").call(_$color_411.stroke,aaxis.linecolor||"#000").style("stroke-width",(aaxis.linewidth||0)+"px"),_this.layers.bline.select("path").attr("d",baxis.showline?"M"+x0+","+(y0+h)+"h"+w:"M0,0").call(_$color_411.stroke,baxis.linecolor||"#000").style("stroke-width",(baxis.linewidth||0)+"px"),_this.layers.cline.select("path").attr("d",caxis.showline?"M"+(x0+w/2)+","+y0+"l"+w/2+","+h:"M0,0").call(_$color_411.stroke,caxis.linecolor||"#000").style("stroke-width",(caxis.linewidth||0)+"px"),_this.graphDiv._context.staticPlot||_this.initInteractions(),_$drawing_436.setClipUrl(_this.layers.frontplot,_this._hasClipOnAxisFalse?null:_this.clipId)},__proto_667.drawAxes=function(doTitles){var gd=this.graphDiv,titlesuffix=this.id.substr(7)+"title",aaxis=this.aaxis,baxis=this.baxis,caxis=this.caxis;if(_$axes_584.doTicks(gd,aaxis,!0),_$axes_584.doTicks(gd,baxis,!0),_$axes_584.doTicks(gd,caxis,!0),doTitles){var apad=Math.max(aaxis.showticklabels?aaxis.tickfont.size/2:0,(caxis.showticklabels?.75*caxis.tickfont.size:0)+("outside"===caxis.ticks?.87*caxis.ticklen:0));this.layers["a-title"]=_$titles_504.draw(gd,"a"+titlesuffix,{propContainer:aaxis,propName:this.id+".aaxis.title",placeholder:____667(gd,"Click to enter Component A title"),attributes:{x:this.x0+this.w/2,y:this.y0-aaxis.titlefont.size/3-apad,"text-anchor":"middle"}});var bpad=(baxis.showticklabels?baxis.tickfont.size:0)+("outside"===baxis.ticks?baxis.ticklen:0)+3;this.layers["b-title"]=_$titles_504.draw(gd,"b"+titlesuffix,{propContainer:baxis,propName:this.id+".baxis.title",placeholder:____667(gd,"Click to enter Component B title"),attributes:{x:this.x0-bpad,y:this.y0+this.h+.83*baxis.titlefont.size+bpad,"text-anchor":"middle"}}),this.layers["c-title"]=_$titles_504.draw(gd,"c"+titlesuffix,{propContainer:caxis,propName:this.id+".caxis.title",placeholder:____667(gd,"Click to enter Component C title"),attributes:{x:this.x0+this.w+bpad,y:this.y0+this.h+.83*caxis.titlefont.size+bpad,"text-anchor":"middle"}})}};var CLEN=_$constants_589.MINZOOM/2+.87,BLPATH="m-0.87,.5h"+CLEN+"v3h-"+(CLEN+5.2)+"l"+(CLEN/2+2.6)+",-"+(.87*CLEN+4.5)+"l2.6,1.5l-"+CLEN/2+","+.87*CLEN+"Z",BRPATH="m0.87,.5h-"+CLEN+"v3h"+(CLEN+5.2)+"l-"+(CLEN/2+2.6)+",-"+(.87*CLEN+4.5)+"l-2.6,1.5l"+CLEN/2+","+.87*CLEN+"Z",TOPPATH="m0,1l"+CLEN/2+","+.87*CLEN+"l2.6,-1.5l-"+(CLEN/2+2.6)+",-"+(.87*CLEN+4.5)+"l-"+(CLEN/2+2.6)+","+(.87*CLEN+4.5)+"l2.6,1.5l"+CLEN/2+",-"+.87*CLEN+"Z",STARTMARKER="m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2Z",__SHOWZOOMOUTTIP_667=!0;function __removeZoombox_667(gd){_$d3_127.select(gd).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}__proto_667.initInteractions=function(){var x0,y0,mins0,span0,mins,lum,path0,dimmed,zb,corners,_this=this,dragger=_this.layers.plotbg.select("path").node(),gd=_this.graphDiv,zoomContainer=gd._fullLayout._zoomlayer,dragOptions={element:dragger,gd:gd,plotinfo:{xaxis:_this.xaxis,yaxis:_this.yaxis},subplot:_this.id,prepFn:function(e,startX,startY){dragOptions.xaxes=[_this.xaxis],dragOptions.yaxes=[_this.yaxis];var dragModeNow=gd._fullLayout.dragmode;e.shiftKey&&(dragModeNow="pan"===dragModeNow?"zoom":"pan"),dragOptions.minDrag="lasso"===dragModeNow?1:void 0,"zoom"===dragModeNow?(dragOptions.moveFn=zoomMove,dragOptions.doneFn=zoomDone,function zoomPrep(e,startX,startY){var dragBBox=dragger.getBoundingClientRect();x0=startX-dragBBox.left,y0=startY-dragBBox.top,mins0={a:_this.aaxis.range[0],b:_this.baxis.range[1],c:_this.caxis.range[1]},mins=mins0,span0=_this.aaxis.range[1]-mins0.a,lum=_$tinycolor_352(_this.graphDiv._fullLayout[_this.id].bgcolor).getLuminance(),path0="M0,"+_this.h+"L"+_this.w/2+", 0L"+_this.w+","+_this.h+"Z",dimmed=!1,zb=zoomContainer.append("path").attr("class","zoombox").attr("transform","translate("+_this.x0+", "+_this.y0+")").style({fill:lum>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",path0),corners=zoomContainer.append("path").attr("class","zoombox-corners").attr("transform","translate("+_this.x0+", "+_this.y0+")").style({fill:_$color_411.background,stroke:_$color_411.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),clearSelect()}(0,startX,startY)):"pan"===dragModeNow?(dragOptions.moveFn=plotDrag,dragOptions.doneFn=dragDone,function panPrep(){mins0={a:_this.aaxis.range[0],b:_this.baxis.range[1],c:_this.caxis.range[1]},mins=mins0}(),clearSelect()):"select"!==dragModeNow&&"lasso"!==dragModeNow||_$prepSelect_602(e,startX,startY,dragOptions,dragModeNow)},clickFn:function(numClicks,evt){if(__removeZoombox_667(gd),2===numClicks){var attrs={};attrs[_this.id+".aaxis.min"]=0,attrs[_this.id+".baxis.min"]=0,attrs[_this.id+".caxis.min"]=0,gd.emit("plotly_doubleclick",null),_$registry_668.call("relayout",gd,attrs)}_$fx_453.click(gd,evt,_this.id)}};function getAFrac(x,y){return 1-y/_this.h}function getBFrac(x,y){return 1-(x+(_this.h-y)/Math.sqrt(3))/_this.w}function getCFrac(x,y){return(x-(_this.h-y)/Math.sqrt(3))/_this.w}function zoomMove(dx0,dy0){var x1=x0+dx0,y1=y0+dy0,afrac=Math.max(0,Math.min(1,getAFrac(0,y0),getAFrac(0,y1))),bfrac=Math.max(0,Math.min(1,getBFrac(x0,y0),getBFrac(x1,y1))),cfrac=Math.max(0,Math.min(1,getCFrac(x0,y0),getCFrac(x1,y1))),xLeft=(afrac/2+cfrac)*_this.w,xRight=(1-afrac/2-bfrac)*_this.w,xCenter=(xLeft+xRight)/2,xSpan=xRight-xLeft,yBottom=(1-afrac)*_this.h,yTop=yBottom-xSpan/w_over_h;xSpan<_$constants_589.MINZOOM?(mins=mins0,zb.attr("d",path0),corners.attr("d","M0,0Z")):(mins={a:mins0.a+afrac*span0,b:mins0.b+bfrac*span0,c:mins0.c+cfrac*span0},zb.attr("d",path0+"M"+xLeft+","+yBottom+"H"+xRight+"L"+xCenter+","+yTop+"L"+xLeft+","+yBottom+"Z"),corners.attr("d","M"+x0+","+y0+STARTMARKER+"M"+xLeft+","+yBottom+BLPATH+"M"+xRight+","+yBottom+BRPATH+"M"+xCenter+","+yTop+TOPPATH)),dimmed||(zb.transition().style("fill",lum>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),corners.transition().style("opacity",1).duration(200),dimmed=!0)}function zoomDone(){if(__removeZoombox_667(gd),mins!==mins0){var attrs={};attrs[_this.id+".aaxis.min"]=mins.a,attrs[_this.id+".baxis.min"]=mins.b,attrs[_this.id+".caxis.min"]=mins.c,_$registry_668.call("relayout",gd,attrs),__SHOWZOOMOUTTIP_667&&gd.data&&gd._context.showTips&&(_$lib_539.notifier(____667(gd,"Double-click to zoom back out"),"long"),__SHOWZOOMOUTTIP_667=!1)}}function plotDrag(dx,dy){var dxScaled=dx/_this.xaxis._m,dyScaled=dy/_this.yaxis._m,minsorted=[(mins={a:mins0.a-dyScaled,b:mins0.b+(dxScaled+dyScaled)/2,c:mins0.c-(dxScaled-dyScaled)/2}).a,mins.b,mins.c].sort(),minindices_a=minsorted.indexOf(mins.a),minindices_b=minsorted.indexOf(mins.b),minindices_c=minsorted.indexOf(mins.c);minsorted[0]<0&&(minsorted[1]+minsorted[0]/2<0?(minsorted[2]+=minsorted[0]+minsorted[1],minsorted[0]=minsorted[1]=0):(minsorted[2]+=minsorted[0]/2,minsorted[1]+=minsorted[0]/2,minsorted[0]=0),mins={a:minsorted[minindices_a],b:minsorted[minindices_b],c:minsorted[minindices_c]},dy=(mins0.a-mins.a)*_this.yaxis._m,dx=(mins0.c-mins.c-mins0.b+mins.b)*_this.xaxis._m);var plotTransform="translate("+(_this.x0+dx)+","+(_this.y0+dy)+")";_this.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",plotTransform);var plotTransform2="translate("+-dx+","+-dy+")";_this.clipDefRelative.select("path").attr("transform",plotTransform2),_this.aaxis.range=[mins.a,_this.sum-mins.b-mins.c],_this.baxis.range=[_this.sum-mins.a-mins.c,mins.b],_this.caxis.range=[_this.sum-mins.a-mins.b,mins.c],_this.drawAxes(!1),_this.plotContainer.selectAll(".crisp").classed("crisp",!1),_this._hasClipOnAxisFalse&&_this.plotContainer.select(".scatterlayer").selectAll(".trace").call(_$drawing_436.hideOutsideRangePoints,_this)}function dragDone(){var attrs={};attrs[_this.id+".aaxis.min"]=mins.a,attrs[_this.id+".baxis.min"]=mins.b,attrs[_this.id+".caxis.min"]=mins.c,_$registry_668.call("relayout",gd,attrs)}function clearSelect(){zoomContainer.selectAll(".select-outline").remove()}dragger.onmousemove=function(evt){_$fx_453.hover(gd,evt,_this.id),gd._fullLayout._lasthover=dragger,gd._fullLayout._hoversubplot=_this.id},dragger.onmouseout=function(evt){gd._dragging||_$dragelement_433.unhover(gd,evt)},_$dragelement_433.init(dragOptions)};var _$ternary_661={},__getSubplotCalcData_661=_$get_data_621.getSubplotCalcData,__counterRegex_661=_$lib_539.counterRegex;_$ternary_661.name="ternary",_$ternary_661.attr="subplot",_$ternary_661.idRoot="ternary",_$ternary_661.idRegex=_$ternary_661.attrRegex=__counterRegex_661("ternary"),_$ternary_661.attributes={subplot:{valType:"subplotid",dflt:"ternary",editType:"calc"}},_$ternary_661.layoutAttributes=_$layout_attributes_666,_$ternary_661.supplyLayoutDefaults=function supplyLayoutDefaults(layoutIn,layoutOut,fullData){_$handleSubplotDefaults_660(layoutIn,layoutOut,0,{type:"ternary",attributes:_$layout_attributes_666,handleDefaults:handleTernaryDefaults,font:layoutOut.font,paper_bgcolor:layoutOut.paper_bgcolor})},_$ternary_661.plot=function plotTernary(gd){for(var fullLayout=gd._fullLayout,calcData=gd.calcdata,ternaryIds=fullLayout._subplots.ternary,i=0;i<ternaryIds.length;i++){var ternaryId=ternaryIds[i],ternaryCalcData=__getSubplotCalcData_661(calcData,"ternary",ternaryId),ternary=fullLayout[ternaryId]._subplot;ternary||(ternary=new _$Ternary_667({id:ternaryId,graphDiv:gd,container:fullLayout._ternarylayer.node()},fullLayout),fullLayout[ternaryId]._subplot=ternary),ternary.plot(ternaryCalcData,fullLayout,gd._promises)}},_$ternary_661.clean=function(newFullData,newFullLayout,oldFullData,oldFullLayout){for(var oldTernaryKeys=oldFullLayout._subplots.ternary||[],i=0;i<oldTernaryKeys.length;i++){var oldTernaryKey=oldTernaryKeys[i],oldTernary=oldFullLayout[oldTernaryKey]._subplot;!newFullLayout[oldTernaryKey]&&oldTernary&&(oldTernary.plotContainer.remove(),oldTernary.clipDef.remove(),oldTernary.clipDefRelative.remove(),oldTernary.layers["a-title"].remove(),oldTernary.layers["b-title"].remove(),oldTernary.layers["c-title"].remove())}};var __dash_929=_$attributes_435.dash,__extendFlat_929=_$extend_528.extendFlat,__scatterMarkerAttrs_929=_$attributes_862.marker,__scatterLineAttrs_929=_$attributes_862.line,__scatterMarkerLineAttrs_929=__scatterMarkerAttrs_929.line,_$attributes_929={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:__extendFlat_929({},_$attributes_862.mode,{dflt:"markers"}),text:__extendFlat_929({},_$attributes_862.text,{}),hovertext:__extendFlat_929({},_$attributes_862.hovertext,{}),line:{color:__scatterLineAttrs_929.color,width:__scatterLineAttrs_929.width,dash:__dash_929,shape:__extendFlat_929({},__scatterLineAttrs_929.shape,{values:["linear","spline"]}),smoothing:__scatterLineAttrs_929.smoothing,editType:"calc"},connectgaps:_$attributes_862.connectgaps,cliponaxis:_$attributes_862.cliponaxis,fill:__extendFlat_929({},_$attributes_862.fill,{values:["none","toself","tonext"]}),fillcolor:_$attributes_862.fillcolor,marker:__extendFlat_929({symbol:__scatterMarkerAttrs_929.symbol,opacity:__scatterMarkerAttrs_929.opacity,maxdisplayed:__scatterMarkerAttrs_929.maxdisplayed,size:__scatterMarkerAttrs_929.size,sizeref:__scatterMarkerAttrs_929.sizeref,sizemin:__scatterMarkerAttrs_929.sizemin,sizemode:__scatterMarkerAttrs_929.sizemode,line:__extendFlat_929({width:__scatterMarkerLineAttrs_929.width,editType:"calc"},_$makeColorScaleAttributes_419()),gradient:__scatterMarkerAttrs_929.gradient,editType:"calc"},_$makeColorScaleAttributes_419(),{showscale:__scatterMarkerAttrs_929.showscale,colorbar:_$attributes_412}),textfont:_$attributes_862.textfont,textposition:_$attributes_862.textposition,selected:_$attributes_862.selected,unselected:_$attributes_862.unselected,hoverinfo:__extendFlat_929({},_$attributes_581.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:_$attributes_862.hoveron},__calcMarkerSize_930=_$calc___calcMarkerSize,dataArrays=["a","b","c"],arraysToFill={a:["b","c"],b:["a","c"],c:["a","b"]},ScatterTernary={};ScatterTernary.attributes=_$attributes_929,ScatterTernary.supplyDefaults=function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_929,attr,dflt)}var len,a=coerce("a"),b=coerce("b"),c=coerce("c");if(a?(len=a.length,b?(len=Math.min(len,b.length),c&&(len=Math.min(len,c.length))):len=c?Math.min(len,c.length):0):b&&c&&(len=Math.min(b.length,c.length)),len){traceOut._length=len,coerce("sum"),coerce("text"),coerce("hovertext"),coerce("mode",len<_$constants_868.PTS_LINESONLY?"lines+markers":"lines"),_$subtypes_884.hasLines(traceOut)&&(_$lineDefaults_875(traceIn,traceOut,defaultColor,layout,coerce),_$handleLineShapeDefaults_877(0,0,coerce),coerce("connectgaps")),_$subtypes_884.hasMarkers(traceOut)&&_$markerDefaults_880(traceIn,traceOut,defaultColor,layout,coerce,{gradient:!0}),_$subtypes_884.hasText(traceOut)&&_$text_defaults_885(0,0,layout,coerce);var dfltHoverOn=[];(_$subtypes_884.hasMarkers(traceOut)||_$subtypes_884.hasText(traceOut))&&(coerce("cliponaxis"),coerce("marker.maxdisplayed"),dfltHoverOn.push("points")),coerce("fill"),"none"!==traceOut.fill&&(_$fillColorDefaults_871(0,traceOut,defaultColor,coerce),_$subtypes_884.hasLines(traceOut)||_$handleLineShapeDefaults_877(0,0,coerce)),"tonext"!==traceOut.fill&&"toself"!==traceOut.fill||dfltHoverOn.push("fills"),coerce("hoveron",dfltHoverOn.join("+")||"points"),_$lib_539.coerceSelectionMarkerOpacity(traceOut,coerce)}else traceOut.visible=!1},ScatterTernary.colorbar=_$colorbar_866,ScatterTernary.calc=function calc(gd,trace){var i,j,dataArray,newArray,fillArray1,fillArray2,displaySum=gd._fullLayout[trace.subplot].sum,normSum=trace.sum||displaySum,arrays={a:trace.a,b:trace.b,c:trace.c};for(i=0;i<dataArrays.length;i++)if(!arrays[dataArray=dataArrays[i]]){for(fillArray1=arrays[arraysToFill[dataArray][0]],fillArray2=arrays[arraysToFill[dataArray][1]],newArray=new Array(fillArray1.length),j=0;j<fillArray1.length;j++)newArray[j]=normSum-fillArray1[j]-fillArray2[j];arrays[dataArray]=newArray}var a,b,c,norm,x,y,serieslen=trace._length,cd=new Array(serieslen);for(i=0;i<serieslen;i++)a=arrays.a[i],b=arrays.b[i],c=arrays.c[i],_$fastIsnumeric_139(a)&&_$fastIsnumeric_139(b)&&_$fastIsnumeric_139(c)?(1!=(norm=displaySum/((a=+a)+(b=+b)+(c=+c)))&&(a*=norm,b*=norm,c*=norm),y=a,x=c-b,cd[i]={x:x,y:y,a:a,b:b,c:c}):cd[i]={x:!1,y:!1};return __calcMarkerSize_930(trace,serieslen),_$calcMarkerColorscale_867(trace),_$arraysToCalcdata_861(cd,trace),_$calcSelection_864(cd,trace),cd},ScatterTernary.plot=function plot(gd,ternary,moduleCalcData){var plotContainer=ternary.plotContainer;plotContainer.select(".scatterlayer").selectAll("*").remove();var plotinfo={xaxis:ternary.xaxis,yaxis:ternary.yaxis,plot:plotContainer,layerClipId:ternary._hasClipOnAxisFalse?ternary.clipIdRelative:null};_$plot_881(gd,plotinfo,moduleCalcData)},ScatterTernary.style=_$style_883.style,ScatterTernary.hoverPoints=function hoverPoints(pointData,xval,yval,hovermode){var scatterPointData=_$hoverPoints_873(pointData,xval,yval,hovermode);if(scatterPointData&&!1!==scatterPointData[0].index){var newPointData=scatterPointData[0];if(void 0===newPointData.index){var yFracUp=1-newPointData.y0/pointData.ya._length,xLen=pointData.xa._length,xMin=xLen*yFracUp/2,xMax=xLen-xMin;return newPointData.x0=Math.max(Math.min(newPointData.x0,xMax),xMin),newPointData.x1=Math.max(Math.min(newPointData.x1,xMax),xMin),scatterPointData}var cdi=newPointData.cd[newPointData.index];newPointData.a=cdi.a,newPointData.b=cdi.b,newPointData.c=cdi.c,newPointData.xLabelVal=void 0,newPointData.yLabelVal=void 0;var trace=newPointData.trace,ternary=newPointData.subplot,parts=(cdi.hi||trace.hoverinfo).split("+"),text=[];return-1!==parts.indexOf("all")&&(parts=["a","b","c"]),-1!==parts.indexOf("a")&&textPart(ternary.aaxis,cdi.a),-1!==parts.indexOf("b")&&textPart(ternary.baxis,cdi.b),-1!==parts.indexOf("c")&&textPart(ternary.caxis,cdi.c),newPointData.extraText=text.join("<br>"),scatterPointData}function textPart(ax,val){text.push(ax._hovertitle+": "+_$axes_584.tickText(ax,val,"hover").text)}},ScatterTernary.selectPoints=_$selectPoints_882,ScatterTernary.eventData=function eventData(out,pt,trace,cd,pointNumber){if(pt.xa&&(out.xaxis=pt.xa),pt.ya&&(out.yaxis=pt.ya),cd[pointNumber]){var cdi=cd[pointNumber];out.a=cdi.a,out.b=cdi.b,out.c=cdi.c}else out.a=pt.a,out.b=pt.b,out.c=pt.c;return out},ScatterTernary.moduleType="trace",ScatterTernary.name="scatterternary",ScatterTernary.basePlotModule=_$ternary_661,ScatterTernary.categories=["ternary","symbols","markerColorscale","showLegend","scatter-like"],ScatterTernary.meta={};var _$scatterternary_34=ScatterTernary,_$sort_966={},__pointsAccessorFunction_966=_$helpers_965.pointsAccessorFunction;_$sort_966.moduleType="transform",_$sort_966.name="sort",_$sort_966.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},_$sort_966.supplyDefaults=function(transformIn){var transformOut={};function coerce(attr,dflt){return _$lib_539.coerce(transformIn,transformOut,_$sort_966.attributes,attr,dflt)}return coerce("enabled")&&(coerce("target"),coerce("order")),transformOut},_$sort_966.calcTransform=function(gd,trace,opts){if(opts.enabled){var targetArray=_$lib_539.getTargetArray(trace,opts);if(targetArray){var i,j,target=opts.target,len=targetArray.length,arrayAttrs=trace._arrayAttrs,indices=function getIndices(opts,targetArray,d2c){for(var len=targetArray.length,indices=new Array(len),sortedArray=targetArray.slice().sort(function getSortFunc(opts,d2c){switch(opts.order){case"ascending":return function(a,b){return d2c(a)-d2c(b)};case"descending":return function(a,b){return d2c(b)-d2c(a)}}}(opts,d2c)),i=0;i<len;i++)for(var vTarget=targetArray[i],j=0;j<len;j++){var vSorted=sortedArray[j];if(vTarget===vSorted){indices[j]=i,sortedArray[j]=null;break}}return indices}(opts,targetArray,_$axes_584.getDataToCoordFunc(gd,trace,target,targetArray)),originalPointsAccessor=__pointsAccessorFunction_966(trace.transforms,opts),indexToPoints={};for(i=0;i<arrayAttrs.length;i++){var np=_$lib_539.nestedProperty(trace,arrayAttrs[i]),arrayOld=np.get(),arrayNew=new Array(len);for(j=0;j<len;j++)arrayNew[j]=arrayOld[indices[j]];np.set(arrayNew)}for(j=0;j<len;j++)indexToPoints[j]=originalPointsAccessor(indices[j]);opts._indexToPoints=indexToPoints}}};var _$sort_35=_$sort_966,_$shaders_216={},__vertSrc_216=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute vec3 f;\nattribute vec3 normal;\n\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 lightPosition, eyePosition;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  worldCoordinate = vec3(uv.zw, f.x);\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n  vec4 clipPosition = projection * view * worldPosition;\n  gl_Position = clipPosition;\n  kill = f.y;\n  value = f.z;\n  planeCoordinate = uv.xy;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * worldPosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  lightDirection = lightPosition - cameraCoordinate.xyz;\n  eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);\n}\n"]),__fragSrc_216=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat beckmannSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness) {\n  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);\n}\n\nuniform vec3 lowerBound, upperBound;\nuniform float contourTint;\nuniform vec4 contourColor;\nuniform sampler2D colormap;\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform float vertexColor;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  if (kill > 0.0 ||\n    any(lessThan(worldCoordinate, clipBounds[0])) || any(greaterThan(worldCoordinate, clipBounds[1]))) {\n    discard;\n  }\n\n  vec3 N = normalize(surfaceNormal);\n  vec3 V = normalize(eyeDirection);\n  vec3 L = normalize(lightDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  //decide how to interpolate color — in vertex or in fragment\n  vec4 surfaceColor = step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) + step(.5, vertexColor) * vColor;\n\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;\n}\n"]),__contourVertSrc_216=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute float f;\n\nuniform mat3 permutation;\nuniform mat4 model, view, projection;\nuniform float height, zOffset;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 dataCoordinate = permutation * vec3(uv.xy, height);\n  vec4 worldPosition = model * vec4(dataCoordinate, 1.0);\n\n  vec4 clipPosition = projection * view * worldPosition;\n  clipPosition.z = clipPosition.z + zOffset;\n\n  gl_Position = clipPosition;\n  value = f;\n  kill = -1.0;\n  worldCoordinate = dataCoordinate;\n  planeCoordinate = uv.zw;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Don't do lighting for contours\n  surfaceNormal   = vec3(1,0,0);\n  eyeDirection    = vec3(0,1,0);\n  lightDirection  = vec3(0,0,1);\n}\n"]),pickSrc=_$browser_238(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec2 shape;\nuniform vec3 clipBounds[2];\nuniform float pickId;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 surfaceNormal;\n\nvec2 splitFloat(float v) {\n  float vh = 255.0 * v;\n  float upper = floor(vh);\n  float lower = fract(vh);\n  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);\n}\n\nvoid main() {\n  if(kill > 0.0 ||\n    any(lessThan(worldCoordinate, clipBounds[0])) || any(greaterThan(worldCoordinate, clipBounds[1]))) {\n    discard;\n  }\n  vec2 ux = splitFloat(planeCoordinate.x / shape.x);\n  vec2 uy = splitFloat(planeCoordinate.y / shape.y);\n  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));\n}\n"]);_$shaders_216.createShader=function(gl){var shader=_$createShader_206(gl,__vertSrc_216,__fragSrc_216,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return shader.attributes.uv.location=0,shader.attributes.f.location=1,shader.attributes.normal.location=2,shader},_$shaders_216.createPickShader=function(gl){var shader=_$createShader_206(gl,__vertSrc_216,pickSrc,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return shader.attributes.uv.location=0,shader.attributes.f.location=1,shader.attributes.normal.location=2,shader},_$shaders_216.createContourShader=function(gl){var shader=_$createShader_206(gl,__contourVertSrc_216,__fragSrc_216,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return shader.attributes.uv.location=0,shader.attributes.f.location=1,shader},_$shaders_216.createPickContourShader=function(gl){var shader=_$createShader_206(gl,__contourVertSrc_216,pickSrc,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return shader.attributes.uv.location=0,shader.attributes.f.location=1,shader};var _$gradient_268=function __gradient_268(out,inp,bc){if(Array.isArray(bc)){if(bc.length!==inp.dimension)throw new Error("ndarray-gradient: invalid boundary conditions")}else bc=_$dupe_133(inp.dimension,"string"==typeof bc?bc:"clamp");if(out.dimension!==inp.dimension+1)throw new Error("ndarray-gradient: output dimension must be +1 input dimension");if(out.shape[inp.dimension]!==inp.dimension)throw new Error("ndarray-gradient: output shape must match input shape");for(var i=0;i<inp.dimension;++i)if(out.shape[i]!==inp.shape[i])throw new Error("ndarray-gradient: shape mismatch");if(0===inp.size)return out;if(inp.dimension<=0)return out.set(0),out;return function generateGradient(boundaryConditions){var token=boundaryConditions.join();if(proc=GRADIENT_CACHE[token])return proc;var d=boundaryConditions.length,code=["function gradient(dst,src){var s=src.shape.slice();"];function handleBoundary(facet){for(var cod=d-facet.length,loStr=[],hiStr=[],pickStr=[],i=0;i<d;++i)facet.indexOf(i+1)>=0?pickStr.push("0"):facet.indexOf(-(i+1))>=0?pickStr.push("s["+i+"]-1"):(pickStr.push("-1"),loStr.push("1"),hiStr.push("s["+i+"]-2"));var boundStr=".lo("+loStr.join()+").hi("+hiStr.join()+")";if(0===loStr.length&&(boundStr=""),cod>0){code.push("if(1");for(var i=0;i<d;++i)facet.indexOf(i+1)>=0||facet.indexOf(-(i+1))>=0||code.push("&&s[",i,"]>2");code.push("){grad",cod,"(src.pick(",pickStr.join(),")",boundStr);for(var i=0;i<d;++i)facet.indexOf(i+1)>=0||facet.indexOf(-(i+1))>=0||code.push(",dst.pick(",pickStr.join(),",",i,")",boundStr);code.push(");")}for(var i=0;i<facet.length;++i){var bnd=Math.abs(facet[i])-1,outStr="dst.pick("+pickStr.join()+","+bnd+")"+boundStr;switch(boundaryConditions[bnd]){case"clamp":var cPickStr=pickStr.slice(),dPickStr=pickStr.slice();facet[i]<0?cPickStr[bnd]="s["+bnd+"]-2":dPickStr[bnd]="1",0===cod?code.push("if(s[",bnd,"]>1){dst.set(",pickStr.join(),",",bnd,",0.5*(src.get(",cPickStr.join(),")-src.get(",dPickStr.join(),")))}else{dst.set(",pickStr.join(),",",bnd,",0)};"):code.push("if(s[",bnd,"]>1){diff(",outStr,",src.pick(",cPickStr.join(),")",boundStr,",src.pick(",dPickStr.join(),")",boundStr,");}else{zero(",outStr,");};");break;case"mirror":0===cod?code.push("dst.set(",pickStr.join(),",",bnd,",0);"):code.push("zero(",outStr,");");break;case"wrap":var aPickStr=pickStr.slice(),bPickStr=pickStr.slice();facet[i]<0?(aPickStr[bnd]="s["+bnd+"]-2",bPickStr[bnd]="0"):(aPickStr[bnd]="s["+bnd+"]-1",bPickStr[bnd]="1"),0===cod?code.push("if(s[",bnd,"]>2){dst.set(",pickStr.join(),",",bnd,",0.5*(src.get(",aPickStr.join(),")-src.get(",bPickStr.join(),")))}else{dst.set(",pickStr.join(),",",bnd,",0)};"):code.push("if(s[",bnd,"]>2){diff(",outStr,",src.pick(",aPickStr.join(),")",boundStr,",src.pick(",bPickStr.join(),")",boundStr,");}else{zero(",outStr,");};");break;default:throw new Error("ndarray-gradient: Invalid boundary condition")}}cod>0&&code.push("};")}for(var i=0;i<1<<d;++i){for(var faces=[],j=0;j<d;++j)i&1<<j&&faces.push(j+1);for(var k=0;k<1<<faces.length;++k){for(var sfaces=faces.slice(),j=0;j<faces.length;++j)k&1<<j&&(sfaces[j]=-sfaces[j]);handleBoundary(sfaces)}}code.push("return dst;};return gradient");for(var linkNames=["diff","zero"],linkArgs=[centralDiff,zeroOut],i=1;i<=d;++i)linkNames.push("grad"+i),linkArgs.push(generateTemplate(i));linkNames.push(code.join(""));var proc=Function.apply(void 0,linkNames).apply(void 0,linkArgs);return TEMPLATE_CACHE[token]=proc,proc}(bc)(out,inp)},TEMPLATE_CACHE={},GRADIENT_CACHE={},__EmptyProc_268={body:"",args:[],thisVars:[],localVars:[]},centralDiff=_$compileCwise_115({args:["array","array","array"],pre:__EmptyProc_268,post:__EmptyProc_268,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1},{name:"left",lvalue:!1,rvalue:!0,count:1},{name:"right",lvalue:!1,rvalue:!0,count:1}],body:"out=0.5*(left-right)",thisVars:[],localVars:[]},funcName:"cdiff"}),zeroOut=_$compileCwise_115({args:["array"],pre:__EmptyProc_268,post:__EmptyProc_268,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1}],body:"out=0",thisVars:[],localVars:[]},funcName:"zero"});function generateTemplate(d){if(d in TEMPLATE_CACHE)return TEMPLATE_CACHE[d];for(var code=[],i=0;i<d;++i)code.push("out",i,"s=0.5*(inp",i,"l-inp",i,"r);");var args=["array"],names=["junk"];for(i=0;i<d;++i){args.push("array"),names.push("out"+i+"s");var o=_$dupe_133(d);o[i]=-1,args.push({array:0,offset:o.slice()}),o[i]=1,args.push({array:0,offset:o.slice()}),names.push("inp"+i+"l","inp"+i+"r")}return TEMPLATE_CACHE[d]=_$compileCwise_115({args:args,pre:__EmptyProc_268,post:__EmptyProc_268,body:{body:code.join(""),args:names.map(function(n){return{name:n,lvalue:0===n.indexOf("out"),rvalue:0===n.indexOf("inp"),count:"junk"!==n|0}}),thisVars:[],localVars:[]},funcName:"fdTemplate"+d})}var _$doConvert_273=_$compileCwise_115({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64}),_$convert_272=function convert(arr,result){for(var shape=[],c=arr,sz=1;Array.isArray(c);)shape.push(c.length),sz*=c.length,c=c[0];return 0===shape.length?_$wrappedNDArrayCtor_277():(result||(result=_$wrappedNDArrayCtor_277(new Float64Array(sz),shape)),_$doConvert_273(result,arr),result)},_$createSurfacePlot_217=function createSurfacePlot(params){var gl=params.gl,shader=__createShader_217(gl),pickShader=__createPickShader_217(gl),contourShader=__createContourShader_217(gl),contourPickShader=createPickContourShader(gl),coordinateBuffer=_$createBuffer_153(gl),vao=_$createVAO_222(gl,[{buffer:coordinateBuffer,size:4,stride:SURFACE_VERTEX_SIZE,offset:0},{buffer:coordinateBuffer,size:3,stride:SURFACE_VERTEX_SIZE,offset:16},{buffer:coordinateBuffer,size:3,stride:SURFACE_VERTEX_SIZE,offset:28}]),contourBuffer=_$createBuffer_153(gl),contourVAO=_$createVAO_222(gl,[{buffer:contourBuffer,size:4,stride:20,offset:0},{buffer:contourBuffer,size:1,stride:20,offset:16}]),dynamicBuffer=_$createBuffer_153(gl),dynamicVAO=_$createVAO_222(gl,[{buffer:dynamicBuffer,size:2,type:gl.FLOAT}]),cmap=_$createTexture2D_218(gl,1,N_COLORS,gl.RGBA,gl.UNSIGNED_BYTE);cmap.minFilter=gl.LINEAR,cmap.magFilter=gl.LINEAR;var surface=new SurfacePlot(gl,[0,0],[[0,0,0],[0,0,0]],shader,pickShader,coordinateBuffer,vao,cmap,contourShader,contourPickShader,contourBuffer,contourVAO,dynamicBuffer,dynamicVAO),nparams={levels:[[],[],[]]};for(var id in params)nparams[id]=params[id];return nparams.colormap=nparams.colormap||"jet",surface.update(nparams),surface},__createShader_217=_$shaders_216.createShader,__createContourShader_217=_$shaders_216.createContourShader,__createPickShader_217=_$shaders_216.createPickShader,createPickContourShader=_$shaders_216.createPickContourShader,SURFACE_VERTEX_SIZE=40,__IDENTITY_217=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],QUAD=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],PERMUTATIONS=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];!function(){for(var i=0;i<3;++i){var p=PERMUTATIONS[i],v=(i+2)%3;p[(i+1)%3+0]=1,p[v+3]=1,p[i+6]=1}}();var N_COLORS=256;function SurfacePlot(gl,shape,bounds,shader,pickShader,coordinates,vao,colorMap,contourShader,contourPickShader,contourBuffer,contourVAO,dynamicBuffer,dynamicVAO){this.gl=gl,this.shape=shape,this.bounds=bounds,this.intensityBounds=[],this._shader=shader,this._pickShader=pickShader,this._coordinateBuffer=coordinates,this._vao=vao,this._colorMap=colorMap,this._contourShader=contourShader,this._contourPickShader=contourPickShader,this._contourBuffer=contourBuffer,this._contourVAO=contourVAO,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new function SurfacePickResult(position,index,uv,level,dataCoordinate){this.position=position,this.index=index,this.uv=uv,this.level=level,this.dataCoordinate=dataCoordinate}([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=dynamicBuffer,this._dynamicVAO=dynamicVAO,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[_$wrappedNDArrayCtor_277(_$pool_360.mallocFloat(1024),[0,0]),_$wrappedNDArrayCtor_277(_$pool_360.mallocFloat(1024),[0,0]),_$wrappedNDArrayCtor_277(_$pool_360.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}var __proto_217=SurfacePlot.prototype;__proto_217.isTransparent=function(){return this.opacity<1},__proto_217.isOpaque=function(){if(this.opacity>=1)return!0;for(var i=0;i<3;++i)if(this._contourCounts[i].length>0||this._dynamicCounts[i]>0)return!0;return!1},__proto_217.pickSlots=1,__proto_217.setPickBase=function(id){this.pickId=id};var ZERO_VEC=[0,0,0],PROJECT_DATA={showSurface:!1,showContour:!1,projections:[__IDENTITY_217.slice(),__IDENTITY_217.slice(),__IDENTITY_217.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function computeProjectionData(camera,obj){var i,j,k,cubeAxis=obj.axes&&obj.axes.lastCubeProps.axis||ZERO_VEC,showSurface=obj.showSurface,showContour=obj.showContour;for(i=0;i<3;++i)for(showSurface=showSurface||obj.surfaceProject[i],j=0;j<3;++j)showContour=showContour||obj.contourProject[i][j];for(i=0;i<3;++i){var axisSquish=PROJECT_DATA.projections[i];for(j=0;j<16;++j)axisSquish[j]=0;for(j=0;j<4;++j)axisSquish[5*j]=1;axisSquish[5*i]=0,axisSquish[12+i]=obj.axesBounds[+(cubeAxis[i]>0)][i],_$multiply_175(axisSquish,camera.model,axisSquish);var nclipBounds=PROJECT_DATA.clipBounds[i];for(k=0;k<2;++k)for(j=0;j<3;++j)nclipBounds[k][j]=camera.clipBounds[k][j];nclipBounds[0][i]=-1e8,nclipBounds[1][i]=1e8}return PROJECT_DATA.showSurface=showSurface,PROJECT_DATA.showContour=showContour,PROJECT_DATA}var UNIFORMS={model:__IDENTITY_217,view:__IDENTITY_217,projection:__IDENTITY_217,inverseModel:__IDENTITY_217.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},MATRIX_INVERSE=__IDENTITY_217.slice(),DEFAULT_PERM=[1,0,0,0,1,0,0,0,1];function drawCore(params,transparent){params=params||{};var gl=this.gl;gl.disable(gl.CULL_FACE),this._colorMap.bind(0);var uniforms=UNIFORMS;uniforms.model=params.model||__IDENTITY_217,uniforms.view=params.view||__IDENTITY_217,uniforms.projection=params.projection||__IDENTITY_217,uniforms.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],uniforms.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],uniforms.contourColor=this.contourColor[0],uniforms.inverseModel=_$invert_173(uniforms.inverseModel,uniforms.model);for(var i=0;i<2;++i)for(var clipClamped=uniforms.clipBounds[i],j=0;j<3;++j)clipClamped[j]=Math.min(Math.max(this.clipBounds[i][j],-1e8),1e8);uniforms.kambient=this.ambientLight,uniforms.kdiffuse=this.diffuseLight,uniforms.kspecular=this.specularLight,uniforms.roughness=this.roughness,uniforms.fresnel=this.fresnel,uniforms.opacity=this.opacity,uniforms.height=0,uniforms.permutation=DEFAULT_PERM,uniforms.vertexColor=this.vertexColor;var invCameraMatrix=MATRIX_INVERSE;for(_$multiply_175(invCameraMatrix,uniforms.view,uniforms.model),_$multiply_175(invCameraMatrix,uniforms.projection,invCameraMatrix),_$invert_173(invCameraMatrix,invCameraMatrix),i=0;i<3;++i)uniforms.eyePosition[i]=invCameraMatrix[12+i]/invCameraMatrix[15];var w=invCameraMatrix[15];for(i=0;i<3;++i)w+=this.lightPosition[i]*invCameraMatrix[4*i+3];for(i=0;i<3;++i){var s=invCameraMatrix[12+i];for(j=0;j<3;++j)s+=invCameraMatrix[4*j+i]*this.lightPosition[j];uniforms.lightPosition[i]=s/w}var projectData=computeProjectionData(uniforms,this);if(projectData.showSurface&&transparent===this.opacity<1){for(this._shader.bind(),this._shader.uniforms=uniforms,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(gl.TRIANGLES,this._vertexCount),i=0;i<3;++i)this.surfaceProject[i]&&this.vertexCount&&(this._shader.uniforms.model=projectData.projections[i],this._shader.uniforms.clipBounds=projectData.clipBounds[i],this._vao.draw(gl.TRIANGLES,this._vertexCount));this._vao.unbind()}if(projectData.showContour&&!transparent){var shader=this._contourShader;uniforms.kambient=1,uniforms.kdiffuse=0,uniforms.kspecular=0,uniforms.opacity=1,shader.bind(),shader.uniforms=uniforms;var vao=this._contourVAO;for(vao.bind(),i=0;i<3;++i)for(shader.uniforms.permutation=PERMUTATIONS[i],gl.lineWidth(this.contourWidth[i]),j=0;j<this.contourLevels[i].length;++j)this._contourCounts[i][j]&&(j===this.highlightLevel[i]?(shader.uniforms.contourColor=this.highlightColor[i],shader.uniforms.contourTint=this.highlightTint[i]):0!==j&&j-1!==this.highlightLevel[i]||(shader.uniforms.contourColor=this.contourColor[i],shader.uniforms.contourTint=this.contourTint[i]),shader.uniforms.height=this.contourLevels[i][j],vao.draw(gl.LINES,this._contourCounts[i][j],this._contourOffsets[i][j]));for(i=0;i<3;++i)for(shader.uniforms.model=projectData.projections[i],shader.uniforms.clipBounds=projectData.clipBounds[i],j=0;j<3;++j)if(this.contourProject[i][j]){shader.uniforms.permutation=PERMUTATIONS[j],gl.lineWidth(this.contourWidth[j]);for(var k=0;k<this.contourLevels[j].length;++k)k===this.highlightLevel[j]?(shader.uniforms.contourColor=this.highlightColor[j],shader.uniforms.contourTint=this.highlightTint[j]):0!==k&&k-1!==this.highlightLevel[j]||(shader.uniforms.contourColor=this.contourColor[j],shader.uniforms.contourTint=this.contourTint[j]),shader.uniforms.height=this.contourLevels[j][k],vao.draw(gl.LINES,this._contourCounts[j][k],this._contourOffsets[j][k])}for(vao.unbind(),(vao=this._dynamicVAO).bind(),i=0;i<3;++i)if(0!==this._dynamicCounts[i])for(shader.uniforms.model=uniforms.model,shader.uniforms.clipBounds=uniforms.clipBounds,shader.uniforms.permutation=PERMUTATIONS[i],gl.lineWidth(this.dynamicWidth[i]),shader.uniforms.contourColor=this.dynamicColor[i],shader.uniforms.contourTint=this.dynamicTint[i],shader.uniforms.height=this.dynamicLevel[i],vao.draw(gl.LINES,this._dynamicCounts[i],this._dynamicOffsets[i]),j=0;j<3;++j)this.contourProject[j][i]&&(shader.uniforms.model=projectData.projections[j],shader.uniforms.clipBounds=projectData.clipBounds[j],vao.draw(gl.LINES,this._dynamicCounts[i],this._dynamicOffsets[i]));vao.unbind()}}__proto_217.draw=function(params){return drawCore.call(this,params,!1)},__proto_217.drawTransparent=function(params){return drawCore.call(this,params,!0)};var PICK_UNIFORMS={model:__IDENTITY_217,view:__IDENTITY_217,projection:__IDENTITY_217,inverseModel:__IDENTITY_217,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};function padField(nfield,field){var shape=field.shape.slice(),nshape=nfield.shape.slice();_$ndarrayOps_271.assign(nfield.lo(1,1).hi(shape[0],shape[1]),field),_$ndarrayOps_271.assign(nfield.lo(1).hi(shape[0],1),field.hi(shape[0],1)),_$ndarrayOps_271.assign(nfield.lo(1,nshape[1]-1).hi(shape[0],1),field.lo(0,shape[1]-1).hi(shape[0],1)),_$ndarrayOps_271.assign(nfield.lo(0,1).hi(1,shape[1]),field.hi(1)),_$ndarrayOps_271.assign(nfield.lo(nshape[0]-1,1).hi(1,shape[1]),field.lo(shape[0]-1)),nfield.set(0,0,field.get(0,0)),nfield.set(0,nshape[1]-1,field.get(0,shape[1]-1)),nfield.set(nshape[0]-1,0,field.get(shape[0]-1,0)),nfield.set(nshape[0]-1,nshape[1]-1,field.get(shape[0]-1,shape[1]-1))}function handleArray(param,ctor){return Array.isArray(param)?[ctor(param[0]),ctor(param[1]),ctor(param[2])]:[ctor(param),ctor(param),ctor(param)]}function toColor(x){return Array.isArray(x)?3===x.length?[x[0],x[1],x[2],1]:[x[0],x[1],x[2],x[3]]:[0,0,0,1]}function handleColor(param){if(Array.isArray(param)){if(Array.isArray(param))return[toColor(param[0]),toColor(param[1]),toColor(param[2])];var c=toColor(param);return[c.slice(),c.slice(),c.slice()]}}__proto_217.drawPick=function(params){params=params||{};var gl=this.gl;gl.disable(gl.CULL_FACE);var uniforms=PICK_UNIFORMS;uniforms.model=params.model||__IDENTITY_217,uniforms.view=params.view||__IDENTITY_217,uniforms.projection=params.projection||__IDENTITY_217,uniforms.shape=this._field[2].shape,uniforms.pickId=this.pickId/255,uniforms.lowerBound=this.bounds[0],uniforms.upperBound=this.bounds[1],uniforms.permutation=DEFAULT_PERM;for(var i=0;i<2;++i)for(var clipClamped=uniforms.clipBounds[i],j=0;j<3;++j)clipClamped[j]=Math.min(Math.max(this.clipBounds[i][j],-1e8),1e8);var projectData=computeProjectionData(uniforms,this);if(projectData.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=uniforms,this._vao.bind(),this._vao.draw(gl.TRIANGLES,this._vertexCount),i=0;i<3;++i)this.surfaceProject[i]&&(this._pickShader.uniforms.model=projectData.projections[i],this._pickShader.uniforms.clipBounds=projectData.clipBounds[i],this._vao.draw(gl.TRIANGLES,this._vertexCount));this._vao.unbind()}if(projectData.showContour){var shader=this._contourPickShader;shader.bind(),shader.uniforms=uniforms;var vao=this._contourVAO;for(vao.bind(),j=0;j<3;++j)for(gl.lineWidth(this.contourWidth[j]),shader.uniforms.permutation=PERMUTATIONS[j],i=0;i<this.contourLevels[j].length;++i)this._contourCounts[j][i]&&(shader.uniforms.height=this.contourLevels[j][i],vao.draw(gl.LINES,this._contourCounts[j][i],this._contourOffsets[j][i]));for(i=0;i<3;++i)for(shader.uniforms.model=projectData.projections[i],shader.uniforms.clipBounds=projectData.clipBounds[i],j=0;j<3;++j)if(this.contourProject[i][j]){shader.uniforms.permutation=PERMUTATIONS[j],gl.lineWidth(this.contourWidth[j]);for(var k=0;k<this.contourLevels[j].length;++k)this._contourCounts[j][k]&&(shader.uniforms.height=this.contourLevels[j][k],vao.draw(gl.LINES,this._contourCounts[j][k],this._contourOffsets[j][k]))}vao.unbind()}},__proto_217.pick=function(selection){if(!selection)return null;if(selection.id!==this.pickId)return null;var shape=this._field[2].shape,result=this._pickResult,x=shape[0]*(selection.value[0]+(selection.value[2]>>4)/16)/255,ix=Math.floor(x),fx=x-ix,y=shape[1]*(selection.value[1]+(15&selection.value[2])/16)/255,iy=Math.floor(y),fy=y-iy;ix+=1,iy+=1;var pos=result.position;pos[0]=pos[1]=pos[2]=0;for(var dx=0;dx<2;++dx)for(var s=dx?fx:1-fx,dy=0;dy<2;++dy)for(var r=ix+dx,c=iy+dy,w=s*(dy?fy:1-fy),i=0;i<3;++i)pos[i]+=this._field[i].get(r,c)*w;for(var levelIndex=this._pickResult.level,j=0;j<3;++j)if(levelIndex[j]=_$searchBounds_71.le(this.contourLevels[j],pos[j]),levelIndex[j]<0)this.contourLevels[j].length>0&&(levelIndex[j]=0);else if(levelIndex[j]<this.contourLevels[j].length-1){var a=this.contourLevels[j][levelIndex[j]],b=this.contourLevels[j][levelIndex[j]+1];Math.abs(a-pos[j])>Math.abs(b-pos[j])&&(levelIndex[j]+=1)}for(result.index[0]=fx<.5?ix:ix+1,result.index[1]=fy<.5?iy:iy+1,result.uv[0]=x/shape[0],result.uv[1]=y/shape[1],i=0;i<3;++i)result.dataCoordinate[i]=this._field[i].get(result.index[0],result.index[1]);return result},__proto_217.update=function(params){params=params||{},this.dirty=!0,"contourWidth"in params&&(this.contourWidth=handleArray(params.contourWidth,Number)),"showContour"in params&&(this.showContour=handleArray(params.showContour,Boolean)),"showSurface"in params&&(this.showSurface=!!params.showSurface),"contourTint"in params&&(this.contourTint=handleArray(params.contourTint,Boolean)),"contourColor"in params&&(this.contourColor=handleColor(params.contourColor)),"contourProject"in params&&(this.contourProject=handleArray(params.contourProject,function(x){return handleArray(x,Boolean)})),"surfaceProject"in params&&(this.surfaceProject=params.surfaceProject),"dynamicColor"in params&&(this.dynamicColor=handleColor(params.dynamicColor)),"dynamicTint"in params&&(this.dynamicTint=handleArray(params.dynamicTint,Number)),"dynamicWidth"in params&&(this.dynamicWidth=handleArray(params.dynamicWidth,Number)),"opacity"in params&&(this.opacity=params.opacity),"colorBounds"in params&&(this.colorBounds=params.colorBounds),"vertexColor"in params&&(this.vertexColor=params.vertexColor?1:0);var field=params.field||params.coords&&params.coords[2]||null,levelsChanged=!1;if(field||(field=this._field[2].shape[0]||this._field[2].shape[2]?this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):this._field[2].hi(0,0)),"field"in params||"coords"in params){var fsize=(field.shape[0]+2)*(field.shape[1]+2);fsize>this._field[2].data.length&&(_$pool_360.freeFloat(this._field[2].data),this._field[2].data=_$pool_360.mallocFloat(_$twiddle_72.nextPow2(fsize))),this._field[2]=_$wrappedNDArrayCtor_277(this._field[2].data,[field.shape[0]+2,field.shape[1]+2]),padField(this._field[2],field),this.shape=field.shape.slice();for(var shape=this.shape,i=0;i<2;++i)this._field[2].size>this._field[i].data.length&&(_$pool_360.freeFloat(this._field[i].data),this._field[i].data=_$pool_360.mallocFloat(this._field[2].size)),this._field[i]=_$wrappedNDArrayCtor_277(this._field[i].data,[shape[0]+2,shape[1]+2]);if(params.coords){var coords=params.coords;if(!Array.isArray(coords)||3!==coords.length)throw new Error("gl-surface: invalid coordinates for x/y");for(i=0;i<2;++i){var coord=coords[i];for(j=0;j<2;++j)if(coord.shape[j]!==shape[j])throw new Error("gl-surface: coords have incorrect shape");padField(this._field[i],coord)}}else if(params.ticks){var ticks=params.ticks;if(!Array.isArray(ticks)||2!==ticks.length)throw new Error("gl-surface: invalid ticks");for(i=0;i<2;++i){var tick=ticks[i];if((Array.isArray(tick)||tick.length)&&(tick=_$wrappedNDArrayCtor_277(tick)),tick.shape[0]!==shape[i])throw new Error("gl-surface: invalid tick length");var tick2=_$wrappedNDArrayCtor_277(tick.data,shape);tick2.stride[i]=tick.stride[0],tick2.stride[1^i]=0,padField(this._field[i],tick2)}}else{for(i=0;i<2;++i){var offset=[0,0];offset[i]=1,this._field[i]=_$wrappedNDArrayCtor_277(this._field[i].data,[shape[0]+2,shape[1]+2],offset,0)}this._field[0].set(0,0,0);for(var j=0;j<shape[0];++j)this._field[0].set(j+1,0,j);for(this._field[0].set(shape[0]+1,0,shape[0]-1),this._field[1].set(0,0,0),j=0;j<shape[1];++j)this._field[1].set(0,j+1,j);this._field[1].set(0,shape[1]+1,shape[1]-1)}var fields=this._field,dfields=_$wrappedNDArrayCtor_277(_$pool_360.mallocFloat(3*fields[2].size*2),[3,shape[0]+2,shape[1]+2,2]);for(i=0;i<3;++i)_$gradient_268(dfields.pick(i),fields[i],"mirror");var normals=_$wrappedNDArrayCtor_277(_$pool_360.mallocFloat(3*fields[2].size),[shape[0]+2,shape[1]+2,3]);for(i=0;i<shape[0]+2;++i)for(j=0;j<shape[1]+2;++j){var dxdu=dfields.get(0,i,j,0),dxdv=dfields.get(0,i,j,1),dydu=dfields.get(1,i,j,0),dydv=dfields.get(1,i,j,1),dzdu=dfields.get(2,i,j,0),dzdv=dfields.get(2,i,j,1),nx=dydu*dzdv-dydv*dzdu,ny=dzdu*dxdv-dzdv*dxdu,nz=dxdu*dydv-dxdv*dydu,nl=Math.sqrt(nx*nx+ny*ny+nz*nz);nl<1e-8?(nl=Math.max(Math.abs(nx),Math.abs(ny),Math.abs(nz)))<1e-8?(nz=1,ny=nx=0,nl=1):nl=1/nl:nl=1/Math.sqrt(nl),normals.set(i,j,0,nx*nl),normals.set(i,j,1,ny*nl),normals.set(i,j,2,nz*nl)}_$pool_360.free(dfields.data);var lo=[1/0,1/0,1/0],hi=[-1/0,-1/0,-1/0],lo_intensity=1/0,hi_intensity=-1/0,count=(shape[0]-1)*(shape[1]-1)*6,tverts=_$pool_360.mallocFloat(_$twiddle_72.nextPow2(10*count)),tptr=0,vertexCount=0;for(i=0;i<shape[0]-1;++i)j_loop:for(j=0;j<shape[1]-1;++j){for(var dx=0;dx<2;++dx)for(var dy=0;dy<2;++dy)for(var k=0;k<3;++k){var f=this._field[k].get(1+i+dx,1+j+dy);if(isNaN(f)||!isFinite(f))continue j_loop}for(k=0;k<6;++k){var r=i+QUAD[k][0],c=j+QUAD[k][1],tx=this._field[0].get(r+1,c+1),ty=this._field[1].get(r+1,c+1),vf=f=this._field[2].get(r+1,c+1);nx=normals.get(r+1,c+1,0),ny=normals.get(r+1,c+1,1),nz=normals.get(r+1,c+1,2),params.intensity&&(vf=params.intensity.get(r,c)),tverts[tptr++]=r,tverts[tptr++]=c,tverts[tptr++]=tx,tverts[tptr++]=ty,tverts[tptr++]=f,tverts[tptr++]=0,tverts[tptr++]=vf,tverts[tptr++]=nx,tverts[tptr++]=ny,tverts[tptr++]=nz,lo[0]=Math.min(lo[0],tx),lo[1]=Math.min(lo[1],ty),lo[2]=Math.min(lo[2],f),lo_intensity=Math.min(lo_intensity,vf),hi[0]=Math.max(hi[0],tx),hi[1]=Math.max(hi[1],ty),hi[2]=Math.max(hi[2],f),hi_intensity=Math.max(hi_intensity,vf),vertexCount+=1}}for(params.intensityBounds&&(lo_intensity=+params.intensityBounds[0],hi_intensity=+params.intensityBounds[1]),i=6;i<tptr;i+=10)tverts[i]=(tverts[i]-lo_intensity)/(hi_intensity-lo_intensity);this._vertexCount=vertexCount,this._coordinateBuffer.update(tverts.subarray(0,tptr)),_$pool_360.freeFloat(tverts),_$pool_360.free(normals.data),this.bounds=[lo,hi],this.intensity=params.intensity||this._field[2],this.intensityBounds[0]===lo_intensity&&this.intensityBounds[1]===hi_intensity||(levelsChanged=!0),this.intensityBounds=[lo_intensity,hi_intensity]}if("levels"in params){var levels=params.levels;for(levels=Array.isArray(levels[0])?levels.slice():[[],[],levels],i=0;i<3;++i)levels[i]=levels[i].slice(),levels.sort(function(a,b){return a-b});change_test:for(i=0;i<3;++i){if(levels[i].length!==this.contourLevels[i].length){levelsChanged=!0;break}for(j=0;j<levels[i].length;++j)if(levels[i][j]!==this.contourLevels[i][j]){levelsChanged=!0;break change_test}}this.contourLevels=levels}if(levelsChanged){fields=this._field,shape=this.shape;for(var contourVerts=[],dim=0;dim<3;++dim){levels=this.contourLevels[dim];var levelOffsets=[],levelCounts=[],parts=[0,0,0];for(i=0;i<levels.length;++i){var graph=_$surfaceNets_346(this._field[dim],levels[i]);levelOffsets.push(contourVerts.length/5|0),vertexCount=0;edge_loop:for(j=0;j<graph.cells.length;++j){var e=graph.cells[j];for(k=0;k<2;++k){var p=graph.positions[e[k]],x=p[0],ix=0|Math.floor(x),fx=x-ix,y=p[1],iy=0|Math.floor(y),fy=y-iy,hole=!1;dd_loop:for(var dd=0;dd<3;++dd){parts[dd]=0;var iu=(dim+dd+1)%3;for(dx=0;dx<2;++dx){var s=dx?fx:1-fx;for(r=0|Math.min(Math.max(ix+dx,0),shape[0]),dy=0;dy<2;++dy){var t=dy?fy:1-fy;if(c=0|Math.min(Math.max(iy+dy,0),shape[1]),f=dd<2?this._field[iu].get(r,c):(this.intensity.get(r,c)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(f)||isNaN(f)){hole=!0;break dd_loop}var w=s*t;parts[dd]+=w*f}}}if(hole){if(k>0){for(var l=0;l<5;++l)contourVerts.pop();vertexCount-=1}continue edge_loop}contourVerts.push(parts[0],parts[1],p[0],p[1],parts[2]),vertexCount+=1}}levelCounts.push(vertexCount)}this._contourOffsets[dim]=levelOffsets,this._contourCounts[dim]=levelCounts}var floatBuffer=_$pool_360.mallocFloat(contourVerts.length);for(i=0;i<contourVerts.length;++i)floatBuffer[i]=contourVerts[i];this._contourBuffer.update(floatBuffer),_$pool_360.freeFloat(floatBuffer)}params.colormap&&this._colorMap.setPixels(function __genColormap_217(name){var x=_$convert_272([_$createColormap_105({colormap:name,nshades:N_COLORS,format:"rgba"}).map(function(c){return[c[0],c[1],c[2],255*c[3]]})]);return _$ndarrayOps_271.divseq(x,255),x}(params.colormap))},__proto_217.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var i=0;i<3;++i)_$pool_360.freeFloat(this._field[i].data)},__proto_217.highlight=function(selection){if(!selection)return this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],void(this.highlightLevel=[-1,-1,-1]);for(var i=0;i<3;++i)this.enableHighlight[i]?this.highlightLevel[i]=selection.level[i]:this.highlightLevel[i]=-1;var levels;if(levels=this.snapToData?selection.dataCoordinate:selection.position,this.enableDynamic[0]&&levels[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&levels[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&levels[2]!==this.dynamicLevel[2]){for(var vertexCount=0,shape=this.shape,scratchBuffer=_$pool_360.mallocFloat(12*shape[0]*shape[1]),d=0;d<3;++d)if(this.enableDynamic[d]){this.dynamicLevel[d]=levels[d];var u=(d+1)%3,v=(d+2)%3,f=this._field[d],g=this._field[u],h=this._field[v],graph=(this.intensity,_$surfaceNets_346(f,levels[d])),edges=graph.cells,positions=graph.positions;for(this._dynamicOffsets[d]=vertexCount,i=0;i<edges.length;++i)for(var e=edges[i],j=0;j<2;++j){var p=positions[e[j]],x=+p[0],ix=0|x,jx=0|Math.min(ix+1,shape[0]),fx=x-ix,hx=1-fx,y=+p[1],iy=0|y,jy=0|Math.min(iy+1,shape[1]),fy=y-iy,hy=1-fy,w00=hx*hy,w01=hx*fy,w10=fx*hy,w11=fx*fy,cu=w00*g.get(ix,iy)+w01*g.get(ix,jy)+w10*g.get(jx,iy)+w11*g.get(jx,jy),cv=w00*h.get(ix,iy)+w01*h.get(ix,jy)+w10*h.get(jx,iy)+w11*h.get(jx,jy);if(isNaN(cu)||isNaN(cv)){j&&(vertexCount-=1);break}scratchBuffer[2*vertexCount+0]=cu,scratchBuffer[2*vertexCount+1]=cv,vertexCount+=1}this._dynamicCounts[d]=vertexCount-this._dynamicOffsets[d]}else this.dynamicLevel[d]=NaN,this._dynamicCounts[d]=0;this._dynamicBuffer.update(scratchBuffer.subarray(0,2*vertexCount)),_$pool_360.freeFloat(scratchBuffer)}};var fill=_$wrapper_118({args:["index","array","scalar"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{_inline_1_arg1_=_inline_1_arg2_.apply(void 0,_inline_1_arg0_)}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"cwise",blockSize:64}),_$ndarrayFill_267=function(array,f){return fill(array,f),array},_$invert_165=function __invert_165(out,a){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],det=a0*a3-a2*a1;return det?(det=1/det,out[0]=a3*det,out[1]=-a1*det,out[2]=-a2*det,out[3]=a0*det,out):null};var _$invert_166=function __invert_166(out,a){var a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8],b01=a22*a11-a12*a21,b11=-a22*a10+a12*a20,b21=a21*a10-a11*a20,det=a00*b01+a01*b11+a02*b21;return det?(det=1/det,out[0]=b01*det,out[1]=(-a22*a01+a02*a21)*det,out[2]=(a12*a01-a02*a11)*det,out[3]=b11*det,out[4]=(a22*a00-a02*a20)*det,out[5]=(-a12*a00+a02*a10)*det,out[6]=b21*det,out[7]=(-a21*a00+a01*a20)*det,out[8]=(a11*a00-a01*a10)*det,out):null};var _$invert_184=function __invert_184(out,M){switch(M.length){case 0:break;case 1:out[0]=1/M[0];break;case 4:_$invert_165(out,M);break;case 9:_$invert_166(out,M);break;case 16:_$invert_173(out,M);break;default:throw new Error("currently supports matrices up to 4x4")}return out};var _$interp_270={};function interp1d(arr,x){var ix=Math.floor(x),fx=x-ix,s0=0<=ix&&ix<arr.shape[0],s1=0<=ix+1&&ix+1<arr.shape[0];return(1-fx)*(s0?+arr.get(ix):0)+fx*(s1?+arr.get(ix+1):0)}function __interp2d_270(arr,x,y){var ix=Math.floor(x),fx=x-ix,s0=0<=ix&&ix<arr.shape[0],s1=0<=ix+1&&ix+1<arr.shape[0],iy=Math.floor(y),fy=y-iy,t0=0<=iy&&iy<arr.shape[1],t1=0<=iy+1&&iy+1<arr.shape[1],w00=s0&&t0?arr.get(ix,iy):0,w01=s0&&t1?arr.get(ix,iy+1):0;return(1-fy)*((1-fx)*w00+fx*(s1&&t0?arr.get(ix+1,iy):0))+fy*((1-fx)*w01+fx*(s1&&t1?arr.get(ix+1,iy+1):0))}function interp3d(arr,x,y,z){var ix=Math.floor(x),fx=x-ix,s0=0<=ix&&ix<arr.shape[0],s1=0<=ix+1&&ix+1<arr.shape[0],iy=Math.floor(y),fy=y-iy,t0=0<=iy&&iy<arr.shape[1],t1=0<=iy+1&&iy+1<arr.shape[1],iz=Math.floor(z),fz=z-iz,u0=0<=iz&&iz<arr.shape[2],u1=0<=iz+1&&iz+1<arr.shape[2],w000=s0&&t0&&u0?arr.get(ix,iy,iz):0,w010=s0&&t1&&u0?arr.get(ix,iy+1,iz):0,w100=s1&&t0&&u0?arr.get(ix+1,iy,iz):0,w110=s1&&t1&&u0?arr.get(ix+1,iy+1,iz):0,w001=s0&&t0&&u1?arr.get(ix,iy,iz+1):0,w011=s0&&t1&&u1?arr.get(ix,iy+1,iz+1):0;return(1-fz)*((1-fy)*((1-fx)*w000+fx*w100)+fy*((1-fx)*w010+fx*w110))+fz*((1-fy)*((1-fx)*w001+fx*(s1&&t0&&u1?arr.get(ix+1,iy,iz+1):0))+fy*((1-fx)*w011+fx*(s1&&t1&&u1?arr.get(ix+1,iy+1,iz+1):0)))}(_$interp_270=function __interpolate_270(arr,x,y,z){switch(arr.shape.length){case 0:return 0;case 1:return interp1d(arr,x);case 2:return __interp2d_270(arr,x,y);case 3:return interp3d(arr,x,y,z);default:return function interpNd(arr){var i,t,d=0|arr.shape.length,ix=new Array(d),fx=new Array(d),s0=new Array(d),s1=new Array(d);for(i=0;i<d;++i)t=+arguments[i+1],ix[i]=Math.floor(t),fx[i]=t-ix[i],s0[i]=0<=ix[i]&&ix[i]<arr.shape[i],s1[i]=0<=ix[i]+1&&ix[i]+1<arr.shape[i];var j,w,idx,r=0;i_loop:for(i=0;i<1<<d;++i){for(w=1,idx=arr.offset,j=0;j<d;++j)if(i&1<<j){if(!s1[j])continue i_loop;w*=fx[j],idx+=arr.stride[j]*(ix[j]+1)}else{if(!s0[j])continue i_loop;w*=1-fx[j],idx+=arr.stride[j]*ix[j]}r+=w*arr.data[idx]}return r}.apply(void 0,arguments)}}).d1=interp1d,_$interp_270.d2=__interp2d_270,_$interp_270.d3=interp3d;var do_warp=_$wrapper_118({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=new Array(_inline_3_arg4_)}",args:[{name:"_inline_3_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_3_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_3_arg2_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_3_arg3_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_3_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_4_arg2_(this_warped,_inline_4_arg0_),_inline_4_arg1_=_inline_4_arg3_.apply(void 0,this_warped)}",args:[{name:"_inline_4_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_4_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_4_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_4_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_4_arg4_",lvalue:!1,rvalue:!1,count:0}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warpND",blockSize:64}),do_warp_1=_$wrapper_118({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_7_arg2_(this_warped,_inline_7_arg0_),_inline_7_arg1_=_inline_7_arg3_(_inline_7_arg4_,this_warped[0])}",args:[{name:"_inline_7_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_7_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_7_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_7_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_7_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warp1D",blockSize:64}),do_warp_2=_$wrapper_118({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0,0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_10_arg2_(this_warped,_inline_10_arg0_),_inline_10_arg1_=_inline_10_arg3_(_inline_10_arg4_,this_warped[0],this_warped[1])}",args:[{name:"_inline_10_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_10_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_10_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_10_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_10_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warp2D",blockSize:64}),do_warp_3=_$wrapper_118({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0,0,0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_13_arg2_(this_warped,_inline_13_arg0_),_inline_13_arg1_=_inline_13_arg3_(_inline_13_arg4_,this_warped[0],this_warped[1],this_warped[2])}",args:[{name:"_inline_13_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_13_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_13_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_13_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_13_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warp3D",blockSize:64}),_$warp_276=function warp(dest,src,func){switch(src.shape.length){case 1:do_warp_1(dest,func,_$interp_270.d1,src);break;case 2:do_warp_2(dest,func,_$interp_270.d2,src);break;case 3:do_warp_3(dest,func,_$interp_270.d3,src);break;default:do_warp(dest,func,_$interp_270.bind(void 0,src),src.shape.length)}return dest},_$applyHomography_269=function applyHomography(dest,src,Xi){var n=src.dimension,X=_$invert_184([],Xi);return _$warp_276(dest,src,function(out_c,inp_c){for(var i=0;i<n;++i){out_c[i]=X[(n+1)*n+i];for(var j=0;j<n;++j)out_c[i]+=X[(n+1)*j+i]*inp_c[j]}var w=X[(n+1)*(n+1)-1];for(j=0;j<n;++j)w+=X[(n+1)*j+n]*inp_c[j];var wr=1/w;for(i=0;i<n;++i)out_c[i]*=wr;return out_c}),dest};var __isArrayOrTypedArray_939=_$lib_539.isArrayOrTypedArray,MIN_RESOLUTION=128;function SurfaceTrace(scene,surface,uid){this.scene=scene,this.uid=uid,this.surface=surface,this.data=null,this.showContour=[!1,!1,!1],this.dataScale=1}var __proto_939=SurfaceTrace.prototype;function __padField_939(field){var shape=field.shape,nshape=[shape[0]+2,shape[1]+2],nfield=_$wrappedNDArrayCtor_277(new Float32Array(nshape[0]*nshape[1]),nshape);return _$ndarrayOps_271.assign(nfield.lo(1,1).hi(shape[0],shape[1]),field),_$ndarrayOps_271.assign(nfield.lo(1).hi(shape[0],1),field.hi(shape[0],1)),_$ndarrayOps_271.assign(nfield.lo(1,nshape[1]-1).hi(shape[0],1),field.lo(0,shape[1]-1).hi(shape[0],1)),_$ndarrayOps_271.assign(nfield.lo(0,1).hi(1,shape[1]),field.hi(1)),_$ndarrayOps_271.assign(nfield.lo(nshape[0]-1,1).hi(1,shape[1]),field.lo(shape[0]-1)),nfield.set(0,0,field.get(0,0)),nfield.set(0,nshape[1]-1,field.get(0,shape[1]-1)),nfield.set(nshape[0]-1,0,field.get(shape[0]-1,0)),nfield.set(nshape[0]-1,nshape[1]-1,field.get(shape[0]-1,shape[1]-1)),nfield}__proto_939.handlePick=function(selection){if(selection.object===this.surface){var selectIndex=selection.index=[Math.min(0|Math.round(selection.data.index[0]/this.dataScale-1),this.data.z[0].length-1),Math.min(0|Math.round(selection.data.index[1]/this.dataScale-1),this.data.z.length-1)],traceCoordinate=[0,0,0];__isArrayOrTypedArray_939(this.data.x)?__isArrayOrTypedArray_939(this.data.x[0])?traceCoordinate[0]=this.data.x[selectIndex[1]][selectIndex[0]]:traceCoordinate[0]=this.data.x[selectIndex[0]]:traceCoordinate[0]=selectIndex[0],__isArrayOrTypedArray_939(this.data.y)?__isArrayOrTypedArray_939(this.data.y[0])?traceCoordinate[1]=this.data.y[selectIndex[1]][selectIndex[0]]:traceCoordinate[1]=this.data.y[selectIndex[1]]:traceCoordinate[1]=selectIndex[1],traceCoordinate[2]=this.data.z[selectIndex[1]][selectIndex[0]],selection.traceCoordinate=traceCoordinate;var sceneLayout=this.scene.fullSceneLayout;selection.dataCoordinate=[sceneLayout.xaxis.d2l(traceCoordinate[0],0,this.data.xcalendar)*this.scene.dataScale[0],sceneLayout.yaxis.d2l(traceCoordinate[1],0,this.data.ycalendar)*this.scene.dataScale[1],sceneLayout.zaxis.d2l(traceCoordinate[2],0,this.data.zcalendar)*this.scene.dataScale[2]];var text=this.data.text;return Array.isArray(text)&&text[selectIndex[1]]&&void 0!==text[selectIndex[1]][selectIndex[0]]?selection.textLabel=text[selectIndex[1]][selectIndex[0]]:selection.textLabel=text||"",selection.data.dataCoordinate=selection.dataCoordinate.slice(),this.surface.highlight(selection.data),this.scene.glplot.spikes.position=selection.dataCoordinate,!0}},__proto_939.setContourLevels=function(){for(var nlevels=[[],[],[]],needsUpdate=!1,i=0;i<3;++i)this.showContour[i]&&(needsUpdate=!0,nlevels[i]=this.scene.contourLevels[i]);needsUpdate&&this.surface.update({levels:nlevels})},__proto_939.update=function(data){var i,scene=this.scene,sceneLayout=scene.fullSceneLayout,surface=this.surface,alpha=data.opacity,colormap=function __parseColorScale_939(colorscale,alpha){return void 0===alpha&&(alpha=1),colorscale.map(function(elem){var index=elem[0],rgb=_$tinycolor_352(elem[1]).toRgb();return{index:index,rgb:[rgb.r,rgb.g,rgb.b,alpha]}})}(data.colorscale,alpha),z=data.z,x=data.x,y=data.y,xaxis=sceneLayout.xaxis,yaxis=sceneLayout.yaxis,zaxis=sceneLayout.zaxis,scaleFactor=scene.dataScale,xlen=z[0].length,ylen=data._ylength,coords=[_$wrappedNDArrayCtor_277(new Float32Array(xlen*ylen),[xlen,ylen]),_$wrappedNDArrayCtor_277(new Float32Array(xlen*ylen),[xlen,ylen]),_$wrappedNDArrayCtor_277(new Float32Array(xlen*ylen),[xlen,ylen])],xc=coords[0],yc=coords[1],contourLevels=scene.contourLevels;this.data=data;var xcalendar=data.xcalendar,ycalendar=data.ycalendar,zcalendar=data.zcalendar;_$ndarrayFill_267(coords[2],function(row,col){return zaxis.d2l(z[col][row],0,zcalendar)*scaleFactor[2]}),__isArrayOrTypedArray_939(x)?__isArrayOrTypedArray_939(x[0])?_$ndarrayFill_267(xc,function(row,col){return xaxis.d2l(x[col][row],0,xcalendar)*scaleFactor[0]}):_$ndarrayFill_267(xc,function(row){return xaxis.d2l(x[row],0,xcalendar)*scaleFactor[0]}):_$ndarrayFill_267(xc,function(row){return xaxis.d2l(row,0,xcalendar)*scaleFactor[0]}),__isArrayOrTypedArray_939(x)?__isArrayOrTypedArray_939(y[0])?_$ndarrayFill_267(yc,function(row,col){return yaxis.d2l(y[col][row],0,ycalendar)*scaleFactor[1]}):_$ndarrayFill_267(yc,function(row,col){return yaxis.d2l(y[col],0,ycalendar)*scaleFactor[1]}):_$ndarrayFill_267(yc,function(row,col){return yaxis.d2l(col,0,xcalendar)*scaleFactor[1]});var params={colormap:colormap,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!data.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacity:data.opacity};if(params.intensityBounds=[data.cmin,data.cmax],data.surfacecolor){var intensity=_$wrappedNDArrayCtor_277(new Float32Array(xlen*ylen),[xlen,ylen]);_$ndarrayFill_267(intensity,function(row,col){return data.surfacecolor[col][row]}),coords.push(intensity)}else params.intensityBounds[0]*=scaleFactor[2],params.intensityBounds[1]*=scaleFactor[2];this.dataScale=function refine(coords){var minScale=Math.max(coords[0].shape[0],coords[0].shape[1]);if(minScale<MIN_RESOLUTION){for(var scaleF=MIN_RESOLUTION/minScale,nshape=[0|Math.floor(coords[0].shape[0]*scaleF+1),0|Math.floor(coords[0].shape[1]*scaleF+1)],nsize=nshape[0]*nshape[1],i=0;i<coords.length;++i){var padImg=__padField_939(coords[i]),scaledImg=_$wrappedNDArrayCtor_277(new Float32Array(nsize),nshape);_$applyHomography_269(scaledImg,padImg,[scaleF,0,0,0,scaleF,0,0,0,1]),coords[i]=scaledImg}return scaleF}return 1}(coords),data.surfacecolor&&(params.intensity=coords.pop());var highlightEnable=[!0,!0,!0],axis=["x","y","z"];for(i=0;i<3;++i){var contourParams=data.contours[axis[i]];highlightEnable[i]=contourParams.highlight,params.showContour[i]=contourParams.show||contourParams.highlight,params.showContour[i]&&(params.contourProject[i]=[contourParams.project.x,contourParams.project.y,contourParams.project.z],contourParams.show?(this.showContour[i]=!0,params.levels[i]=contourLevels[i],surface.highlightColor[i]=params.contourColor[i]=_$str2RgbaArray_561(contourParams.color),contourParams.usecolormap?surface.highlightTint[i]=params.contourTint[i]=0:surface.highlightTint[i]=params.contourTint[i]=1,params.contourWidth[i]=contourParams.width):this.showContour[i]=!1,contourParams.highlight&&(params.dynamicColor[i]=_$str2RgbaArray_561(contourParams.highlightcolor),params.dynamicWidth[i]=contourParams.highlightwidth))}(function isColormapCircular(colormap){var first=colormap[0].rgb,last=colormap[colormap.length-1].rgb;return first[0]===last[0]&&first[1]===last[1]&&first[2]===last[2]&&first[3]===last[3]})(colormap)&&(params.vertexColor=!0),params.coords=coords,surface.update(params),surface.visible=data.visible,surface.enableDynamic=highlightEnable,surface.snapToData=!0,"lighting"in data&&(surface.ambientLight=data.lighting.ambient,surface.diffuseLight=data.lighting.diffuse,surface.specularLight=data.lighting.specular,surface.roughness=data.lighting.roughness,surface.fresnel=data.lighting.fresnel),"lightposition"in data&&(surface.lightPosition=[data.lightposition.x,data.lightposition.y,data.lightposition.z]),alpha&&alpha<1&&(surface.supportsTransparency=!0)},__proto_939.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()};var _$createSurfaceTrace_939=function createSurfaceTrace(scene,data){var gl=scene.glplot.gl,surface=_$createSurfacePlot_217({gl:gl}),result=new SurfaceTrace(scene,surface,data.uid);return surface._trace=result,result.update(data),scene.glplot.add(surface),result};function mapLegacy(traceIn,oldAttr,newAttr){oldAttr in traceIn&&!(newAttr in traceIn)&&(traceIn[newAttr]=traceIn[oldAttr])}var Surface={};Surface.attributes=_$attributes_936,Surface.supplyDefaults=function supplyDefaults(traceIn,traceOut,defaultColor,layout){var i,j;function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_936,attr,dflt)}var z=coerce("z");if(z){var x=coerce("x");coerce("y"),traceOut._xlength=Array.isArray(x)&&_$lib_539.isArrayOrTypedArray(x[0])?z.length:z[0].length,traceOut._ylength=z.length,_$registry_668.getComponentMethod("calendars","handleTraceDefaults")(traceIn,traceOut,["x","y","z"],layout),coerce("text"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","opacity"].forEach(function(x){coerce(x)});var surfaceColor=coerce("surfacecolor");coerce("colorscale");var dims=["x","y","z"];for(i=0;i<3;++i){var contourDim="contours."+dims[i],show=coerce(contourDim+".show"),highlight=coerce(contourDim+".highlight");if(show||highlight)for(j=0;j<3;++j)coerce(contourDim+".project."+dims[j]);show&&(coerce(contourDim+".color"),coerce(contourDim+".width"),coerce(contourDim+".usecolormap")),highlight&&(coerce(contourDim+".highlightcolor"),coerce(contourDim+".highlightwidth"))}surfaceColor||(mapLegacy(traceIn,"zmin","cmin"),mapLegacy(traceIn,"zmax","cmax"),mapLegacy(traceIn,"zauto","cauto")),_$colorScaleDefaults_421(traceIn,traceOut,layout,coerce,{prefix:"",cLetter:"c"})}else traceOut.visible=!1},Surface.colorbar=function colorbar(gd,cd){var trace=cd[0].trace,cbId="cb"+trace.uid,cmin=trace.cmin,cmax=trace.cmax,vals=trace.surfacecolor||trace.z;if(_$fastIsnumeric_139(cmin)||(cmin=_$lib_539.aggNums(Math.min,null,vals)),_$fastIsnumeric_139(cmax)||(cmax=_$lib_539.aggNums(Math.max,null,vals)),gd._fullLayout._infolayer.selectAll("."+cbId).remove(),trace.showscale){var cb=cd[0].t.cb=_$draw_415(gd,cbId),sclFunc=_$colorscale_426.makeColorScaleFunc(_$colorscale_426.extractScale(trace.colorscale,cmin,cmax),{noNumericCheck:!0});cb.fillcolor(sclFunc).filllevels({start:cmin,end:cmax,size:(cmax-cmin)/254}).options(trace.colorbar)()}else _$plots_647.autoMargin(gd,cbId)},Surface.calc=function calc(gd,trace){trace.surfacecolor?_$calc_418(trace,trace.surfacecolor,"","c"):_$calc_418(trace,trace.z,"","c")},Surface.plot=_$createSurfaceTrace_939,Surface.moduleType="trace",Surface.name="surface",Surface.basePlotModule=_$gl3d_627,Surface.categories=["gl3d","2dMap","noOpacity"],Surface.meta={};var _$surface_36=Surface,__extendFlat_942=_$extend_528.extendFlat,_$attributes_942=(0,_$edit_types_569.overrideAll)({domain:(0,_$domain_610.attributes)({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[]},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:__extendFlat_942({},_$attributes_394.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:__extendFlat_942({},_$font_attributes_611({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[]},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:__extendFlat_942({},_$attributes_394.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:__extendFlat_942({},_$font_attributes_611({arrayOk:!0}))}},"calc","from-root"),_$constants_945={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}},__extendFlat_946=_$extend_528.extendFlat;function xScale(d){return d.calcdata.columns.reduce(function(prev,next){return next.xIndex<d.xIndex?prev+next.columnWidth:prev},0)}function makeRowBlock(anchorToRowBlock,auxiliary){return Object.keys(anchorToRowBlock).map(function(k){return __extendFlat_946({},anchorToRowBlock[k],{auxiliaryBlocks:auxiliary})})}function makeAnchorToRowBlock(rowHeights,minimumFillHeight){for(var currentRowHeight,anchorToRowBlock={},currentAnchor=0,currentBlockHeight=0,currentBlock={firstRowIndex:null,lastRowIndex:null,rows:[]},currentFirstRowIndex=0,blockCounter=0,i=0;i<rowHeights.length;i++)currentRowHeight=rowHeights[i],currentBlock.rows.push({rowIndex:i,rowHeight:currentRowHeight}),((currentBlockHeight+=currentRowHeight)>=minimumFillHeight||i===rowHeights.length-1)&&(anchorToRowBlock[currentAnchor]=currentBlock,currentBlock.key=blockCounter++,currentBlock.firstRowIndex=currentFirstRowIndex,currentBlock.lastRowIndex=i,currentBlock={firstRowIndex:null,lastRowIndex:null,rows:[]},currentAnchor+=currentBlockHeight,currentFirstRowIndex=i+1,currentBlockHeight=0);return anchorToRowBlock}var _$data_split_helpers_947={},__extendFlat_947=_$extend_528.extendFlat;_$data_split_helpers_947.splitToPanels=function(d){var prevPages=[0,0],headerPanel=__extendFlat_947({},d,{key:"header",type:"header",page:0,prevPages:prevPages,currentRepaint:[null,null],dragHandle:!0,values:d.calcdata.headerCells.values[d.specIndex],rowBlocks:d.calcdata.headerRowBlocks,calcdata:__extendFlat_947({},d.calcdata,{cells:d.calcdata.headerCells})});return[__extendFlat_947({},d,{key:"cells1",type:"cells",page:0,prevPages:prevPages,currentRepaint:[null,null],dragHandle:!1,values:d.calcdata.cells.values[d.specIndex],rowBlocks:d.calcdata.rowBlocks}),__extendFlat_947({},d,{key:"cells2",type:"cells",page:1,prevPages:prevPages,currentRepaint:[null,null],dragHandle:!1,values:d.calcdata.cells.values[d.specIndex],rowBlocks:d.calcdata.rowBlocks}),headerPanel]},_$data_split_helpers_947.splitToCells=function(d){var fromTo=function rowFromTo(d){var rowBlock=d.rowBlocks[d.page],rowFrom=rowBlock?rowBlock.rows[0].rowIndex:0,rowTo=rowBlock?rowFrom+rowBlock.rows.length:0;return[rowFrom,rowTo]}(d);return(d.values||[]).slice(fromTo[0],fromTo[1]).map(function(v,i){return{keyWithinBlock:i+("string"==typeof v&&v.match(/[<$&> ]/)?"_keybuster_"+Math.random():""),key:fromTo[0]+i,column:d,calcdata:d.calcdata,page:d.page,rowBlocks:d.rowBlocks,value:v}})};var raiseToTop=_$lib_539.raiseToTop,cancelEeaseColumn=_$lib_539.cancelTransition,_$plot_950=function plot(gd,wrappedTraceHolders){var table=gd._fullLayout._paper.selectAll("."+_$constants_945.cn.table).data(wrappedTraceHolders.map(function(wrappedTraceHolder){var trace=_$gup_536.unwrap(wrappedTraceHolder).trace;return function calc(gd,trace){var cellsValues=trace.cells.values,slicer=function(a){return a.slice(trace.header.values.length,a.length)},headerValues=trace.header.values.map(function(c){return Array.isArray(c)?c:[c]}).concat(slicer(cellsValues).map(function(){return[""]})),domain=trace.domain,groupWidth=Math.floor(gd._fullLayout._size.w*(domain.x[1]-domain.x[0])),groupHeight=Math.floor(gd._fullLayout._size.h*(domain.y[1]-domain.y[0])),headerRowHeights=trace.header.values.length?headerValues[0].map(function(){return trace.header.height}):[_$constants_945.emptyHeaderHeight],rowHeights=cellsValues.length?cellsValues[0].map(function(){return trace.cells.height}):[],headerHeight=headerRowHeights.reduce(function(a,b){return a+b},0),anchorToRowBlock=makeAnchorToRowBlock(rowHeights,groupHeight-headerHeight+_$constants_945.uplift),headerRowBlocks=makeRowBlock(makeAnchorToRowBlock(headerRowHeights,headerHeight),[]),rowBlocks=makeRowBlock(anchorToRowBlock,headerRowBlocks),uniqueKeys={},columnOrder=trace._fullInput.columnorder.concat(slicer(cellsValues.map(function(d,i){return i}))),columnWidths=headerValues.map(function(d,i){var value=Array.isArray(trace.columnwidth)?trace.columnwidth[Math.min(i,trace.columnwidth.length-1)]:trace.columnwidth;return _$fastIsnumeric_139(value)?Number(value):1}),totalColumnWidths=columnWidths.reduce(function(p,n){return p+n},0);columnWidths=columnWidths.map(function(d){return d/totalColumnWidths*groupWidth});var calcdata={key:trace.index,translateX:domain.x[0]*gd._fullLayout._size.w,translateY:gd._fullLayout._size.h*(1-domain.y[1]),size:gd._fullLayout._size,width:groupWidth,height:groupHeight,columnOrder:columnOrder,groupHeight:groupHeight,rowBlocks:rowBlocks,headerRowBlocks:headerRowBlocks,scrollY:0,cells:trace.cells,headerCells:__extendFlat_946({},trace.header,{values:headerValues}),gdColumns:headerValues.map(function(d){return d[0]}),gdColumnsOriginalOrder:headerValues.map(function(d){return d[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:headerValues.map(function(label,i){var foundKey=uniqueKeys[label];return uniqueKeys[label]=(foundKey||0)+1,{key:label+"__"+uniqueKeys[label],label:label,specIndex:i,xIndex:columnOrder[i],xScale:xScale,x:void 0,calcdata:void 0,columnWidth:columnWidths[i]}})};return calcdata.columns.forEach(function(col){col.calcdata=calcdata,col.x=xScale(col)}),calcdata}(gd,trace)}),_$gup_536.keyFun);table.exit().remove(),table.enter().append("g").classed(_$constants_945.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),table.attr("width",function(d){return d.width+d.size.l+d.size.r}).attr("height",function(d){return d.height+d.size.t+d.size.b}).attr("transform",function(d){return"translate("+d.translateX+","+d.translateY+")"});var tableControlView=table.selectAll("."+_$constants_945.cn.tableControlView).data(_$gup_536.repeat,_$gup_536.keyFun);tableControlView.enter().append("g").classed(_$constants_945.cn.tableControlView,!0).style("box-sizing","content-box").on("mousemove",function(d){tableControlView.filter(function(dd){return d===dd}).call(renderScrollbarKit,gd)}).on("mousewheel",function(d){d.scrollbarState.wheeling||(d.scrollbarState.wheeling=!0,_$d3_127.event.stopPropagation(),_$d3_127.event.preventDefault(),makeDragRow(gd,tableControlView,null,d.scrollY+_$d3_127.event.deltaY)(d),d.scrollbarState.wheeling=!1)}).call(renderScrollbarKit,gd,!0),tableControlView.attr("transform",function(d){return"translate("+d.size.l+" "+d.size.t+")"});var scrollBackground=tableControlView.selectAll("."+_$constants_945.cn.scrollBackground).data(_$gup_536.repeat,_$gup_536.keyFun);scrollBackground.enter().append("rect").classed(_$constants_945.cn.scrollBackground,!0).attr("fill","none"),scrollBackground.attr("width",function(d){return d.width}).attr("height",function(d){return d.height}),tableControlView.each(function(d){_$drawing_436.setClipUrl(_$d3_127.select(this),scrollAreaBottomClipKey(gd,d))});var yColumn=tableControlView.selectAll("."+_$constants_945.cn.yColumn).data(function(vm){return vm.columns},_$gup_536.keyFun);yColumn.enter().append("g").classed(_$constants_945.cn.yColumn,!0),yColumn.exit().remove(),yColumn.attr("transform",function(d){return"translate("+d.x+" 0)"}).call(_$d3_127.behavior.drag().origin(function(d){return easeColumn(_$d3_127.select(this),d,-_$constants_945.uplift),raiseToTop(this),d.calcdata.columnDragInProgress=!0,renderScrollbarKit(tableControlView.filter(function(dd){return d.calcdata.key===dd.key}),gd),d}).on("drag",function(d){var movedColumn=_$d3_127.select(this),getter=function(dd){return(d===dd?_$d3_127.event.x:dd.x)+dd.columnWidth/2};d.x=Math.max(-_$constants_945.overdrag,Math.min(d.calcdata.width+_$constants_945.overdrag-d.columnWidth,_$d3_127.event.x)),flatData(yColumn).filter(function(dd){return dd.calcdata.key===d.calcdata.key}).sort(function(a,b){return getter(a)-getter(b)}).forEach(function(dd,i){dd.xIndex=i,dd.x=d===dd?dd.x:dd.xScale(dd)}),yColumn.filter(function(dd){return d!==dd}).transition().ease(_$constants_945.transitionEase).duration(_$constants_945.transitionDuration).attr("transform",function(d){return"translate("+d.x+" 0)"}),movedColumn.call(cancelEeaseColumn).attr("transform","translate("+d.x+" -"+_$constants_945.uplift+" )")}).on("dragend",function(d){var movedColumn=_$d3_127.select(this),p=d.calcdata;d.x=d.xScale(d),d.calcdata.columnDragInProgress=!1,easeColumn(movedColumn,d,0),function columnMoved(gd,calcdata,indices){var o=calcdata.gdColumnsOriginalOrder;calcdata.gdColumns.sort(function(a,b){return indices[o.indexOf(a)]-indices[o.indexOf(b)]}),calcdata.columnorder=indices,gd.emit("plotly_restyle")}(gd,p,p.columns.map(function(dd){return dd.xIndex}))})),yColumn.each(function(d){_$drawing_436.setClipUrl(_$d3_127.select(this),columnBoundaryClipKey(gd,d))});var columnBlock=yColumn.selectAll("."+_$constants_945.cn.columnBlock).data(_$data_split_helpers_947.splitToPanels,_$gup_536.keyFun);columnBlock.enter().append("g").classed(_$constants_945.cn.columnBlock,!0).attr("id",function(d){return d.key}),columnBlock.style("cursor",function(d){return d.dragHandle?"ew-resize":d.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var headerColumnBlock=columnBlock.filter(headerBlock),cellsColumnBlock=columnBlock.filter(cellsBlock);cellsColumnBlock.call(_$d3_127.behavior.drag().origin(function(d){return _$d3_127.event.stopPropagation(),d}).on("drag",makeDragRow(gd,tableControlView,-1)).on("dragend",function(){})),renderColumnCellTree(gd,tableControlView,headerColumnBlock,columnBlock),renderColumnCellTree(gd,tableControlView,cellsColumnBlock,columnBlock);var scrollAreaClip=tableControlView.selectAll("."+_$constants_945.cn.scrollAreaClip).data(_$gup_536.repeat,_$gup_536.keyFun);scrollAreaClip.enter().append("clipPath").classed(_$constants_945.cn.scrollAreaClip,!0).attr("id",function(d){return scrollAreaBottomClipKey(gd,d)});var scrollAreaClipRect=scrollAreaClip.selectAll("."+_$constants_945.cn.scrollAreaClipRect).data(_$gup_536.repeat,_$gup_536.keyFun);scrollAreaClipRect.enter().append("rect").classed(_$constants_945.cn.scrollAreaClipRect,!0).attr("x",-_$constants_945.overdrag).attr("y",-_$constants_945.uplift).attr("fill","none"),scrollAreaClipRect.attr("width",function(d){return d.width+2*_$constants_945.overdrag}).attr("height",function(d){return d.height+_$constants_945.uplift}),yColumn.selectAll("."+_$constants_945.cn.columnBoundary).data(_$gup_536.repeat,_$gup_536.keyFun).enter().append("g").classed(_$constants_945.cn.columnBoundary,!0);var columnBoundaryClippath=yColumn.selectAll("."+_$constants_945.cn.columnBoundaryClippath).data(_$gup_536.repeat,_$gup_536.keyFun);columnBoundaryClippath.enter().append("clipPath").classed(_$constants_945.cn.columnBoundaryClippath,!0),columnBoundaryClippath.attr("id",function(d){return columnBoundaryClipKey(gd,d)});var columnBoundaryRect=columnBoundaryClippath.selectAll("."+_$constants_945.cn.columnBoundaryRect).data(_$gup_536.repeat,_$gup_536.keyFun);columnBoundaryRect.enter().append("rect").classed(_$constants_945.cn.columnBoundaryRect,!0).attr("fill","none"),columnBoundaryRect.attr("width",function(d){return d.columnWidth}).attr("height",function(d){return d.calcdata.height+_$constants_945.uplift}),updateBlockYPosition(null,cellsColumnBlock,tableControlView)};function scrollAreaBottomClipKey(gd,d){return"clip"+gd._fullLayout._uid+"_scrollAreaBottomClip_"+d.key}function columnBoundaryClipKey(gd,d){return"clip"+gd._fullLayout._uid+"_columnBoundaryClippath_"+d.calcdata.key+"_"+d.specIndex}function flatData(selection){return[].concat.apply([],selection.map(function(g){return g})).map(function(g){return g.__data__})}function renderScrollbarKit(tableControlView,gd,bypassVisibleBar){var scrollbarKit=tableControlView.selectAll("."+_$constants_945.cn.scrollbarKit).data(_$gup_536.repeat,_$gup_536.keyFun);scrollbarKit.enter().append("g").classed(_$constants_945.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),scrollbarKit.each(function(d){var s=d.scrollbarState;s.totalHeight=function calcTotalHeight(d){var blocks=d.rowBlocks;return firstRowAnchor(blocks,blocks.length-1)+(blocks.length?rowsHeight(blocks[blocks.length-1],1/0):1)}(d),s.scrollableAreaHeight=d.groupHeight-headerHeight(d),s.currentlyVisibleHeight=Math.min(s.totalHeight,s.scrollableAreaHeight),s.ratio=s.currentlyVisibleHeight/s.totalHeight,s.barLength=Math.max(s.ratio*s.currentlyVisibleHeight,_$constants_945.goldenRatio*_$constants_945.scrollbarWidth),s.barWiggleRoom=s.currentlyVisibleHeight-s.barLength,s.wiggleRoom=Math.max(0,s.totalHeight-s.scrollableAreaHeight),s.topY=0===s.barWiggleRoom?0:d.scrollY/s.wiggleRoom*s.barWiggleRoom,s.bottomY=s.topY+s.barLength,s.dragMultiplier=s.wiggleRoom/s.barWiggleRoom}).attr("transform",function(d){return"translate("+(d.width+_$constants_945.scrollbarWidth/2+_$constants_945.scrollbarOffset)+" "+headerHeight(d)+")"});var scrollbar=scrollbarKit.selectAll("."+_$constants_945.cn.scrollbar).data(_$gup_536.repeat,_$gup_536.keyFun);scrollbar.enter().append("g").classed(_$constants_945.cn.scrollbar,!0);var scrollbarSlider=scrollbar.selectAll("."+_$constants_945.cn.scrollbarSlider).data(_$gup_536.repeat,_$gup_536.keyFun);scrollbarSlider.enter().append("g").classed(_$constants_945.cn.scrollbarSlider,!0),scrollbarSlider.attr("transform",function(d){return"translate(0 "+(d.scrollbarState.topY||0)+")"});var scrollbarGlyph=scrollbarSlider.selectAll("."+_$constants_945.cn.scrollbarGlyph).data(_$gup_536.repeat,_$gup_536.keyFun);scrollbarGlyph.enter().append("line").classed(_$constants_945.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",_$constants_945.scrollbarWidth).attr("stroke-linecap","round").attr("y1",_$constants_945.scrollbarWidth/2),scrollbarGlyph.attr("y2",function(d){return d.scrollbarState.barLength-_$constants_945.scrollbarWidth/2}).attr("stroke-opacity",function(d){return d.columnDragInProgress||!d.scrollbarState.barWiggleRoom||bypassVisibleBar?0:.4}),scrollbarGlyph.transition().delay(0).duration(0),scrollbarGlyph.transition().delay(_$constants_945.scrollbarHideDelay).duration(_$constants_945.scrollbarHideDuration).attr("stroke-opacity",0);var scrollbarCaptureZone=scrollbar.selectAll("."+_$constants_945.cn.scrollbarCaptureZone).data(_$gup_536.repeat,_$gup_536.keyFun);scrollbarCaptureZone.enter().append("line").classed(_$constants_945.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",_$constants_945.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(d){var y=_$d3_127.event.y,bbox=this.getBoundingClientRect(),s=d.scrollbarState,pixelVal=y-bbox.top,inverseScale=_$d3_127.scale.linear().domain([0,s.scrollableAreaHeight]).range([0,s.totalHeight]).clamp(!0);s.topY<=pixelVal&&pixelVal<=s.bottomY||makeDragRow(gd,tableControlView,null,inverseScale(pixelVal-s.barLength/2))(d)}).call(_$d3_127.behavior.drag().origin(function(d){return _$d3_127.event.stopPropagation(),d.scrollbarState.scrollbarScrollInProgress=!0,d}).on("drag",makeDragRow(gd,tableControlView)).on("dragend",function(){})),scrollbarCaptureZone.attr("y2",function(d){return d.scrollbarState.scrollableAreaHeight})}function renderColumnCellTree(gd,tableControlView,columnBlock,allColumnBlock){var columnCell=function renderColumnCell(columnCells){var columnCell=columnCells.selectAll("."+_$constants_945.cn.columnCell).data(_$data_split_helpers_947.splitToCells,function(d){return d.keyWithinBlock});return columnCell.enter().append("g").classed(_$constants_945.cn.columnCell,!0),columnCell.exit().remove(),columnCell}(function renderColumnCells(columnBlock){var columnCells=columnBlock.selectAll("."+_$constants_945.cn.columnCells).data(_$gup_536.repeat,_$gup_536.keyFun);return columnCells.enter().append("g").classed(_$constants_945.cn.columnCells,!0),columnCells.exit().remove(),columnCells}(columnBlock));!function supplyStylingValues(columnCell){columnCell.each(function(d,i){var spec=d.calcdata.cells.font,col=d.column.specIndex,font={size:gridPick(spec.size,col,i),color:gridPick(spec.color,col,i),family:gridPick(spec.family,col,i)};d.rowNumber=d.key,d.align=gridPick(d.calcdata.cells.align,col,i),d.cellBorderWidth=gridPick(d.calcdata.cells.line.width,col,i),d.font=font})}(columnCell),function sizeAndStyleRect(cellRect){cellRect.attr("width",function(d){return d.column.columnWidth}).attr("stroke-width",function(d){return d.cellBorderWidth}).each(function(d){var atomicSelection=_$d3_127.select(this);_$color_411.stroke(atomicSelection,gridPick(d.calcdata.cells.line.color,d.column.specIndex,d.rowNumber)),_$color_411.fill(atomicSelection,gridPick(d.calcdata.cells.fill.color,d.column.specIndex,d.rowNumber))})}(function renderCellRect(columnCell){var cellRect=columnCell.selectAll("."+_$constants_945.cn.cellRect).data(_$gup_536.repeat,function(d){return d.keyWithinBlock});return cellRect.enter().append("rect").classed(_$constants_945.cn.cellRect,!0),cellRect}(columnCell));var cellText=function renderCellText(cellTextHolder){var cellText=cellTextHolder.selectAll("."+_$constants_945.cn.cellText).data(_$gup_536.repeat,function(d){return d.keyWithinBlock});return cellText.enter().append("text").classed(_$constants_945.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){_$d3_127.event.stopPropagation()}),cellText}(function renderCellTextHolder(columnCell){var cellTextHolder=columnCell.selectAll("."+_$constants_945.cn.cellTextHolder).data(_$gup_536.repeat,function(d){return d.keyWithinBlock});return cellTextHolder.enter().append("g").classed(_$constants_945.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),cellTextHolder}(columnCell));!function setFont(cellText){cellText.each(function(d){_$drawing_436.font(_$d3_127.select(this),d.font)})}(cellText),populateCellText(cellText,tableControlView,allColumnBlock,gd),setCellHeightAndPositionY(columnCell)}function populateCellText(cellText,tableControlView,allColumnBlock,gd){cellText.text(function(d){var col=d.column.specIndex,row=d.rowNumber,userSuppliedContent=d.value,stringSupplied="string"==typeof userSuppliedContent,hasBreaks=stringSupplied&&userSuppliedContent.match(/<br>/i),userBrokenText=!stringSupplied||hasBreaks;d.mayHaveMarkup=stringSupplied&&userSuppliedContent.match(/[<&>]/);var latex=function isLatex(content){return"string"==typeof content&&content.match(_$constants_945.latexCheck)}(userSuppliedContent);d.latex=latex;var hasWrapSplitCharacter,textToRender,prefix=latex?"":gridPick(d.calcdata.cells.prefix,col,row)||"",suffix=latex?"":gridPick(d.calcdata.cells.suffix,col,row)||"",format=latex?null:gridPick(d.calcdata.cells.format,col,row)||null,prefixSuffixedText=prefix+(format?_$d3_127.format(format)(d.value):d.value)+suffix;if(d.wrappingNeeded=!d.wrapped&&!userBrokenText&&!latex&&(hasWrapSplitCharacter=hasWrapCharacter(prefixSuffixedText)),d.cellHeightMayIncrease=hasBreaks||latex||d.mayHaveMarkup||(void 0===hasWrapSplitCharacter?hasWrapCharacter(prefixSuffixedText):hasWrapSplitCharacter),d.needsConvertToTspans=d.mayHaveMarkup||d.wrappingNeeded||d.latex,d.wrappingNeeded){var fragments=(" "===_$constants_945.wrapSplitCharacter?prefixSuffixedText.replace(/<a href=/gi,"<a_href="):prefixSuffixedText).split(_$constants_945.wrapSplitCharacter),hrefRestoredFragments=" "===_$constants_945.wrapSplitCharacter?fragments.map(function(frag){return frag.replace(/<a_href=/gi,"<a href=")}):fragments;d.fragments=hrefRestoredFragments.map(function(f){return{text:f,width:null}}),d.fragments.push({fragment:_$constants_945.wrapSpacer,width:null}),textToRender=hrefRestoredFragments.join(_$constants_945.lineBreaker)+_$constants_945.lineBreaker+_$constants_945.wrapSpacer}else delete d.fragments,textToRender=prefixSuffixedText;return textToRender}).attr("dy",function(d){return d.needsConvertToTspans?0:"0.75em"}).each(function(d){var selection=_$d3_127.select(this),renderCallback=d.wrappingNeeded?wrapTextMaker:updateYPositionMaker;d.needsConvertToTspans?_$svg_text_utils_562.convertToTspans(selection,gd,renderCallback(allColumnBlock,this,tableControlView,gd,d)):_$d3_127.select(this.parentNode).attr("transform",function(d){return"translate("+xPosition(d)+" "+_$constants_945.cellPad+")"}).attr("text-anchor",function(d){return{left:"start",center:"middle",right:"end"}[d.align]})})}function hasWrapCharacter(text){return-1!==text.indexOf(_$constants_945.wrapSplitCharacter)}function gridPick(spec,col,row){if(Array.isArray(spec)){var column=spec[Math.min(col,spec.length-1)];return Array.isArray(column)?column[Math.min(row,column.length-1)]:column}return spec}function easeColumn(selection,d,y){selection.transition().ease(_$constants_945.releaseTransitionEase).duration(_$constants_945.releaseTransitionDuration).attr("transform","translate("+d.x+" "+y+")")}function cellsBlock(d){return"cells"===d.type}function headerBlock(d){return"header"===d.type}function headerHeight(d){return(d.rowBlocks.length?d.rowBlocks[0].auxiliaryBlocks:[]).reduce(function(p,n){return p+rowsHeight(n,1/0)},0)}function updateBlockYPosition(gd,cellsColumnBlock,tableControlView){var d=flatData(cellsColumnBlock)[0];if(void 0!==d){var blocks=d.rowBlocks,calcdata=d.calcdata,bottom=firstRowAnchor(blocks,blocks.length),scrollHeight=d.calcdata.groupHeight-headerHeight(d),scrollY=calcdata.scrollY=Math.max(0,Math.min(bottom-scrollHeight,calcdata.scrollY)),pages=function findPagesAndCacheHeights(blocks,scrollY,scrollHeight){for(var pages=[],pTop=0,blockIndex=0;blockIndex<blocks.length;blockIndex++){for(var block=blocks[blockIndex],blockRows=block.rows,rowsHeight=0,i=0;i<blockRows.length;i++)rowsHeight+=blockRows[i].rowHeight;block.allRowsHeight=rowsHeight,scrollY<pTop+rowsHeight&&scrollY+scrollHeight>pTop&&pages.push(blockIndex),pTop+=rowsHeight}return pages}(blocks,scrollY,scrollHeight);1===pages.length&&(pages[0]===blocks.length-1?pages.unshift(pages[0]-1):pages.push(pages[0]+1)),pages[0]%2&&pages.reverse(),cellsColumnBlock.each(function(d,i){d.page=pages[i],d.scrollY=scrollY}),cellsColumnBlock.attr("transform",function(d){return"translate(0 "+(firstRowAnchor(d.rowBlocks,d.page)-d.scrollY)+")"}),gd&&(conditionalPanelRerender(gd,tableControlView,cellsColumnBlock,pages,d.prevPages,d,0),conditionalPanelRerender(gd,tableControlView,cellsColumnBlock,pages,d.prevPages,d,1),renderScrollbarKit(tableControlView,gd))}}function makeDragRow(gd,allTableControlView,optionalMultiplier,optionalPosition){return function dragRow(eventD){var d=eventD.calcdata?eventD.calcdata:eventD,tableControlView=allTableControlView.filter(function(dd){return d.key===dd.key}),multiplier=optionalMultiplier||d.scrollbarState.dragMultiplier;d.scrollY=void 0===optionalPosition?d.scrollY+multiplier*_$d3_127.event.dy:optionalPosition;var cellsColumnBlock=tableControlView.selectAll("."+_$constants_945.cn.yColumn).selectAll("."+_$constants_945.cn.columnBlock).filter(cellsBlock);updateBlockYPosition(gd,cellsColumnBlock,tableControlView)}}function conditionalPanelRerender(gd,tableControlView,cellsColumnBlock,pages,prevPages,d,revolverIndex){pages[revolverIndex]!==prevPages[revolverIndex]&&(clearTimeout(d.currentRepaint[revolverIndex]),d.currentRepaint[revolverIndex]=setTimeout(function(){var toRerender=cellsColumnBlock.filter(function(d,i){return i===revolverIndex&&pages[i]!==prevPages[i]});renderColumnCellTree(gd,tableControlView,toRerender,cellsColumnBlock),prevPages[revolverIndex]=pages[revolverIndex]}))}function wrapTextMaker(columnBlock,element,tableControlView){return function wrapText(){var cellTextHolder=_$d3_127.select(element.parentNode);cellTextHolder.each(function(d){var fragments=d.fragments;cellTextHolder.selectAll("tspan.line").each(function(dd,i){fragments[i].width=this.getComputedTextLength()});var currentAddition,currentAdditionLength,separatorLength=fragments[fragments.length-1].width,rest=fragments.slice(0,-1),currentRow=[],currentRowLength=0,rowLengthLimit=d.column.columnWidth-2*_$constants_945.cellPad;for(d.value="";rest.length;)currentRowLength+(currentAdditionLength=(currentAddition=rest.shift()).width+separatorLength)>rowLengthLimit&&(d.value+=currentRow.join(_$constants_945.wrapSpacer)+_$constants_945.lineBreaker,currentRow=[],currentRowLength=0),currentRow.push(currentAddition.text),currentRowLength+=currentAdditionLength;currentRowLength&&(d.value+=currentRow.join(_$constants_945.wrapSpacer)),d.wrapped=!0}),cellTextHolder.selectAll("tspan.line").remove(),populateCellText(cellTextHolder.select("."+_$constants_945.cn.cellText),tableControlView,columnBlock),_$d3_127.select(element.parentNode.parentNode).call(setCellHeightAndPositionY)}}function updateYPositionMaker(columnBlock,element,tableControlView,gd,d){return function updateYPosition(){if(!d.settledY){var cellTextHolder=_$d3_127.select(element.parentNode),l=getBlock(d),rowIndex=d.key-l.firstRowIndex,declaredRowHeight=l.rows[rowIndex].rowHeight,requiredHeight=d.cellHeightMayIncrease?element.parentNode.getBoundingClientRect().height+2*_$constants_945.cellPad:declaredRowHeight,finalHeight=Math.max(requiredHeight,declaredRowHeight);finalHeight-l.rows[rowIndex].rowHeight&&(l.rows[rowIndex].rowHeight=finalHeight,columnBlock.selectAll("."+_$constants_945.cn.columnCell).call(setCellHeightAndPositionY),updateBlockYPosition(null,columnBlock.filter(cellsBlock),0),renderScrollbarKit(tableControlView,gd,!0)),cellTextHolder.attr("transform",function(){var box=this.parentNode.getBoundingClientRect(),rectBox=_$d3_127.select(this.parentNode).select("."+_$constants_945.cn.cellRect).node().getBoundingClientRect(),currentTransform=this.transform.baseVal.consolidate(),yPosition=rectBox.top-box.top+(currentTransform?currentTransform.matrix.f:_$constants_945.cellPad);return"translate("+xPosition(d,_$d3_127.select(this.parentNode).select("."+_$constants_945.cn.cellTextHolder).node().getBoundingClientRect().width)+" "+yPosition+")"}),d.settledY=!0}}}function xPosition(d,optionalWidth){switch(d.align){case"left":return _$constants_945.cellPad;case"right":return d.column.columnWidth-(optionalWidth||0)-_$constants_945.cellPad;case"center":return(d.column.columnWidth-(optionalWidth||0))/2;default:return _$constants_945.cellPad}}function setCellHeightAndPositionY(columnCell){columnCell.attr("transform",function(d){var headerHeight=d.rowBlocks[0].auxiliaryBlocks.reduce(function(p,n){return p+rowsHeight(n,1/0)},0);return"translate(0 "+(rowsHeight(getBlock(d),d.key)+headerHeight)+")"}).selectAll("."+_$constants_945.cn.cellRect).attr("height",function(d){return function getRow(l,i){return l.rows[i-l.firstRowIndex]}(getBlock(d),d.key).rowHeight})}function firstRowAnchor(blocks,page){for(var total=0,i=page-1;i>=0;i--)total+=allRowsHeight(blocks[i]);return total}function rowsHeight(rowBlock,key){for(var total=0,i=0;i<rowBlock.rows.length&&rowBlock.rows[i].rowIndex<key;i++)total+=rowBlock.rows[i].rowHeight;return total}function allRowsHeight(rowBlock){var cached=rowBlock.allRowsHeight;if(void 0!==cached)return cached;for(var total=0,i=0;i<rowBlock.rows.length;i++)total+=rowBlock.rows[i].rowHeight;return rowBlock.allRowsHeight=total,total}function getBlock(d){return d.rowBlocks[d.page]}var _$base_plot_943={},__getModuleCalcData_943=_$get_data_621.getModuleCalcData;_$base_plot_943.name="table",_$base_plot_943.plot=function(gd){var calcData=__getModuleCalcData_943(gd.calcdata,"table");calcData.length&&_$plot_950(gd,calcData)},_$base_plot_943.clean=function(newFullData,newFullLayout,oldFullData,oldFullLayout){var hadTable=oldFullLayout._has&&oldFullLayout._has("table"),hasTable=newFullLayout._has&&newFullLayout._has("table");hadTable&&!hasTable&&oldFullLayout._paperdiv.selectAll(".table").remove()};var __wrap_944=_$gup_536.wrap,__handleDomainDefaults_948=_$domain_610.defaults;var Table={};Table.attributes=_$attributes_942,Table.supplyDefaults=function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_942,attr,dflt)}__handleDomainDefaults_948(traceOut,layout,coerce),coerce("columnwidth"),coerce("header.values"),coerce("header.format"),coerce("header.align"),coerce("header.prefix"),coerce("header.suffix"),coerce("header.height"),coerce("header.line.width"),coerce("header.line.color"),coerce("header.fill.color"),_$lib_539.coerceFont(coerce,"header.font",_$lib_539.extendFlat({},layout.font)),function defaultColumnOrder(traceOut,coerce){for(var specifiedColumnOrder=traceOut.columnorder||[],commonLength=traceOut.header.values.length,truncated=specifiedColumnOrder.slice(0,commonLength),sorted=truncated.slice().sort(function(a,b){return a-b}),oneStepped=truncated.map(function(d){return sorted.indexOf(d)}),i=oneStepped.length;i<commonLength;i++)oneStepped.push(i);coerce("columnorder",oneStepped)}(traceOut,coerce),coerce("cells.values"),coerce("cells.format"),coerce("cells.align"),coerce("cells.prefix"),coerce("cells.suffix"),coerce("cells.height"),coerce("cells.line.width"),coerce("cells.line.color"),coerce("cells.fill.color"),_$lib_539.coerceFont(coerce,"cells.font",_$lib_539.extendFlat({},layout.font))},Table.calc=function calc(gd,trace){return __wrap_944(trace)},Table.plot=_$plot_950,Table.moduleType="trace",Table.name="table",Table.basePlotModule=_$base_plot_943,Table.categories=["noOpacity"],Table.meta={};var _$table_37=Table,__extendFlat_951=_$extend_528.extendFlat,_$attributes_951={y:_$attributes_691.y,x:_$attributes_691.x,x0:_$attributes_691.x0,y0:_$attributes_691.y0,name:_$attributes_691.name,orientation:__extendFlat_951({},_$attributes_691.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:_$attributes_691.fillcolor,points:__extendFlat_951({},_$attributes_691.boxpoints,{}),jitter:__extendFlat_951({},_$attributes_691.jitter,{}),pointpos:__extendFlat_951({},_$attributes_691.pointpos,{}),marker:_$attributes_691.marker,text:_$attributes_691.text,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"plot"},selected:_$attributes_691.selected,unselected:_$attributes_691.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}},_$helpers_954={},kernels_gaussian=function(v){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*v*v)};_$helpers_954.makeKDE=function(calcItem,trace,vals){var len=vals.length,kernel=kernels_gaussian,bandwidth=calcItem.bandwidth,factor=1/(len*bandwidth);return function(x){for(var sum=0,i=0;i<len;i++)sum+=kernel((x-vals[i])/bandwidth);return factor*sum}},_$helpers_954.getPositionOnKdePath=function(calcItem,trace,valuePx){var posLetter,valLetter;"h"===trace.orientation?(posLetter="y",valLetter="x"):(posLetter="x",valLetter="y");var pointOnPath=_$lib_539.findPointOnPath(calcItem.path,valuePx,valLetter,{pathLength:calcItem.pathLength}),posCenterPx=calcItem.posCenterPx,posOnPath0=pointOnPath[posLetter];return[posOnPath0,"both"===trace.side?2*posCenterPx-posOnPath0:posCenterPx]},_$helpers_954.getKdeValue=function(calcItem,trace,valueDist){var vals=calcItem.pts.map(_$helpers_954.extractVal);return _$helpers_954.makeKDE(calcItem,trace,vals)(valueDist)/calcItem.posDensityScale},_$helpers_954.extractVal=function(o){return o.v};var __BADNUM_952=_$numerical_517.BADNUM;function ruleOfThumbBandwidth(vals,ssd,iqr){return 1.059*Math.min(ssd,iqr/1.349)*Math.pow(vals.length,-.2)}function calcSpan(trace,cdi,valAxis,bandwidth){var spanOut,spanmode=trace.spanmode,spanIn=trace.span||[],spanTight=[cdi.min,cdi.max],spanLoose=[cdi.min-2*bandwidth,cdi.max+2*bandwidth];function calcSpanItem(index){var s=spanIn[index],sc=valAxis.d2c(s,0,trace[cdi.valLetter+"calendar"]);return sc===__BADNUM_952?spanLoose[index]:sc}var dummyAx={type:"linear",range:spanOut="soft"===spanmode?spanLoose:"hard"===spanmode?spanTight:[calcSpanItem(0),calcSpanItem(1)]};return _$axes_584.setConvert(dummyAx),dummyAx.cleanRange(),spanOut}var __extendFlat_957=_$lib_539.extendFlat,_$layout_attributes_957={violinmode:__extendFlat_957({},_$layout_attributes_696.boxmode,{}),violingap:__extendFlat_957({},_$layout_attributes_696.boxgap,{}),violingroupgap:__extendFlat_957({},_$layout_attributes_696.boxgroupgap,{})},__setPositionOffset_960=_$set_positions___setPositionOffset,__orientations_960=["v","h"],__stylePoints_961=_$style_883.stylePoints,_$violin_38={attributes:_$attributes_951,layoutAttributes:_$layout_attributes_957,supplyDefaults:function supplyDefaults(traceIn,traceOut,defaultColor,layout){function coerce(attr,dflt){return _$lib_539.coerce(traceIn,traceOut,_$attributes_951,attr,dflt)}function coerce2(attr,dflt){return _$lib_539.coerce2(traceIn,traceOut,_$attributes_951,attr,dflt)}if(_$defaults_693.handleSampleDefaults(traceIn,traceOut,coerce,layout),!1!==traceOut.visible){coerce("bandwidth"),coerce("scalegroup",traceOut.name),coerce("scalemode"),coerce("side");var spanmodeDflt,span=coerce("span");Array.isArray(span)&&(spanmodeDflt="manual"),coerce("spanmode",spanmodeDflt);var lineColor=coerce("line.color",(traceIn.marker||{}).color||defaultColor),lineWidth=coerce("line.width"),fillColor=coerce("fillcolor",_$color_411.addOpacity(traceOut.line.color,.5));_$defaults_693.handlePointsDefaults(traceIn,traceOut,coerce,{prefix:""});var boxWidth=coerce2("box.width"),boxFillColor=coerce2("box.fillcolor",fillColor),boxLineColor=coerce2("box.line.color",lineColor),boxLineWidth=coerce2("box.line.width",lineWidth);coerce("box.visible",Boolean(boxWidth||boxFillColor||boxLineColor||boxLineWidth))||delete traceOut.box;var meanLineColor=coerce2("meanline.color",lineColor),meanLineWidth=coerce2("meanline.width",lineWidth);coerce("meanline.visible",Boolean(meanLineColor||meanLineWidth))||delete traceOut.meanline}},supplyLayoutDefaults:function supplyLayoutDefaults(layoutIn,layoutOut,fullData){_$layout_defaults_697._supply(layoutIn,layoutOut,fullData,function coerce(attr,dflt){return _$lib_539.coerce(layoutIn,layoutOut,_$layout_attributes_957,attr,dflt)},"violin")},calc:function calc(gd,trace){var cd=_$calc_692(gd,trace);if(cd[0].t.empty)return cd;var fullLayout=gd._fullLayout,valAxis=_$axes_584.getFromId(gd,trace["h"===trace.orientation?"xaxis":"yaxis"]),violinScaleGroupStats=fullLayout._violinScaleGroupStats,scaleGroup=trace.scalegroup,groupStats=violinScaleGroupStats[scaleGroup];groupStats||(groupStats=violinScaleGroupStats[scaleGroup]={maxWidth:0,maxCount:0});for(var i=0;i<cd.length;i++){var cdi=cd[i],vals=cdi.pts.map(_$helpers_954.extractVal),len=vals.length,bandwidthDflt=ruleOfThumbBandwidth(vals,_$lib_539.stdev(vals,len-1,cdi.mean),cdi.q3-cdi.q1),bandwidth=cdi.bandwidth=trace.bandwidth||bandwidthDflt,span=cdi.span=calcSpan(trace,cdi,valAxis,bandwidth),dist=span[1]-span[0],n=Math.ceil(dist/(Math.min(bandwidthDflt,bandwidth)/3)),step=dist/n;if(!isFinite(step)||!isFinite(n))return _$lib_539.error("Something went wrong with computing the violin span"),cd[0].t.empty=!0,cd;var kde=_$helpers_954.makeKDE(cdi,trace,vals);cdi.density=new Array(n);for(var k=0,t=span[0];t<span[1]+step/2;k++,t+=step){var v=kde(t);groupStats.maxWidth=Math.max(groupStats.maxWidth,v),cdi.density[k]={v:v,t:t}}_$axes_584.expand(valAxis,span,{padded:!0}),groupStats.maxCount=Math.max(groupStats.maxCount,vals.length)}return cd[0].t.labels.kde=_$lib_539._(gd,"kde:"),cd},setPositions:function setPositions(gd,plotinfo){for(var calcdata=gd.calcdata,xa=plotinfo.xaxis,ya=plotinfo.yaxis,i=0;i<__orientations_960.length;i++){for(var orientation=__orientations_960[i],posAxis="h"===orientation?ya:xa,violinList=[],minPad=0,maxPad=0,j=0;j<calcdata.length;j++){var cd=calcdata[j],t=cd[0].t,trace=cd[0].trace;!0!==trace.visible||"violin"!==trace.type||t.empty||trace.orientation!==orientation||trace.xaxis!==xa._id||trace.yaxis!==ya._id||(violinList.push(j),!1!==trace.points&&(minPad=Math.max(minPad,trace.jitter-trace.pointpos-1),maxPad=Math.max(maxPad,trace.jitter+trace.pointpos-1)))}__setPositionOffset_960("violin",gd,violinList,posAxis,[minPad,maxPad])}},plot:function plot(gd,plotinfo,cd){var fullLayout=gd._fullLayout,xa=plotinfo.xaxis,ya=plotinfo.yaxis;function makePath(pts){var segments=_$linePoints_876(pts,{xaxis:xa,yaxis:ya,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0});return _$drawing_436.smoothopen(segments[0],1)}plotinfo.plot.select(".violinlayer").selectAll("g.trace.violins").data(cd).enter().append("g").attr("class","trace violins").each(function(d){var cd0=d[0],t=cd0.t,trace=cd0.trace,sel=cd0.node3=_$d3_127.select(this),numViolins=fullLayout._numViolins,group="group"===fullLayout.violinmode&&numViolins>1,bdPos=t.bdPos=t.dPos*(1-fullLayout.violingap)*(1-fullLayout.violingroupgap)/(group?numViolins:1),bPos=t.bPos=group?2*t.dPos*((t.num+.5)/numViolins-.5)*(1-fullLayout.violingap):0;if(!0!==trace.visible||t.empty)_$d3_127.select(this).remove();else{var valAxis=plotinfo[t.valLetter+"axis"],posAxis=plotinfo[t.posLetter+"axis"],hasBothSides="both"===trace.side,hasPositiveSide=hasBothSides||"positive"===trace.side,hasNegativeSide=hasBothSides||"negative"===trace.side,hasBox=trace.box&&trace.box.visible,hasMeanLine=trace.meanline&&trace.meanline.visible,groupStats=fullLayout._violinScaleGroupStats[trace.scalegroup];if(sel.selectAll("path.violin").data(_$lib_539.identity).enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin").each(function(d){var scale,pathPos,pathNeg,path,i,k,pts,pt,pathSel=_$d3_127.select(this),density=d.density,len=density.length,posCenter=d.pos+bPos,posCenterPx=posAxis.c2p(posCenter);switch(trace.scalemode){case"width":scale=groupStats.maxWidth/bdPos;break;case"count":scale=groupStats.maxWidth/bdPos*(groupStats.maxCount/d.pts.length)}if(hasPositiveSide){for(pts=new Array(len),i=0;i<len;i++)(pt=pts[i]={})[t.posLetter]=posCenter+density[i].v/scale,pt[t.valLetter]=density[i].t;pathPos=makePath(pts)}if(hasNegativeSide){for(pts=new Array(len),k=0,i=len-1;k<len;k++,i--)(pt=pts[k]={})[t.posLetter]=posCenter-density[i].v/scale,pt[t.valLetter]=density[i].t;pathNeg=makePath(pts)}if(hasBothSides)path=pathPos+"L"+pathNeg.substr(1)+"Z";else{var startPt=[posCenterPx,valAxis.c2p(density[0].t)],endPt=[posCenterPx,valAxis.c2p(density[len-1].t)];"h"===trace.orientation&&(startPt.reverse(),endPt.reverse()),path=hasPositiveSide?"M"+startPt+"L"+pathPos.substr(1)+"L"+endPt:"M"+endPt+"L"+pathNeg.substr(1)+"L"+startPt}pathSel.attr("d",path),d.posCenterPx=posCenterPx,d.posDensityScale=scale*bdPos,d.path=pathSel.node(),d.pathLength=d.path.getTotalLength()/(hasBothSides?2:1)}),hasBox){var bdPosScaled,bPosPxOffset,boxWidth=trace.box.width,boxLineWidth=trace.box.line.width;hasBothSides?(bdPosScaled=bdPos*boxWidth,bPosPxOffset=0):hasPositiveSide?(bdPosScaled=[0,bdPos*boxWidth/2],bPosPxOffset=-boxLineWidth):(bdPosScaled=[bdPos*boxWidth/2,0],bPosPxOffset=boxLineWidth),trace.whiskerwidth=0,_$plot_698.plotBoxAndWhiskers(sel,{pos:posAxis,val:valAxis},trace,{bPos:bPos,bdPos:bdPosScaled,bPosPxOffset:bPosPxOffset}),hasMeanLine&&_$plot_698.plotBoxMean(sel,{pos:posAxis,val:valAxis},trace,{bPos:bPos,bdPos:bdPosScaled,bPosPxOffset:bPosPxOffset})}else hasMeanLine&&sel.selectAll("path.mean").data(_$lib_539.identity).enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}).each(function(d){var v=valAxis.c2p(d.mean,!0),p=_$helpers_954.getPositionOnKdePath(d,trace,v);_$d3_127.select(this).attr("d","h"===trace.orientation?"M"+v+","+p[0]+"V"+p[1]:"M"+p[0]+","+v+"H"+p[1])});trace.points&&_$plot_698.plotPoints(sel,{x:xa,y:ya},trace,t)}})},style:function style(gd,cd){var s=cd?cd[0].node3:_$d3_127.select(gd).selectAll("g.trace.violins");s.style("opacity",function(d){return d[0].trace.opacity}),s.each(function(d){var trace=d[0].trace,sel=_$d3_127.select(this),box=trace.box||{},boxLine=box.line||{},meanline=trace.meanline||{},meanLineWidth=meanline.width;sel.selectAll("path.violin").style("stroke-width",trace.line.width+"px").call(_$color_411.stroke,trace.line.color).call(_$color_411.fill,trace.fillcolor),sel.selectAll("path.box").style("stroke-width",boxLine.width+"px").call(_$color_411.stroke,boxLine.color).call(_$color_411.fill,box.fillcolor),sel.selectAll("path.mean").style({"stroke-width":meanLineWidth+"px","stroke-dasharray":2*meanLineWidth+"px,"+meanLineWidth+"px"}).call(_$color_411.stroke,meanline.color),__stylePoints_961(sel,trace,gd)})},hoverPoints:function hoverPoints(pointData,xval,yval,hovermode,hoverLayer){var closePtData,violinLineAttrs,cd=pointData.cd,trace=cd[0].trace,hoveron=trace.hoveron,hasHoveronViolins=-1!==hoveron.indexOf("violins"),hasHoveronKDE=-1!==hoveron.indexOf("kde"),closeData=[];if(hasHoveronViolins||hasHoveronKDE){var closeBoxData=_$hover_694.hoverOnBoxes(pointData,xval,yval,hovermode);if(hasHoveronViolins&&(closeData=closeData.concat(closeBoxData)),hasHoveronKDE&&closeBoxData.length>0){var pLetter,vLetter,pAxis,vAxis,vVal,xa=pointData.xa,ya=pointData.ya;"h"===trace.orientation?(vVal=xval,pLetter="y",pAxis=ya,vLetter="x",vAxis=xa):(vVal=yval,pLetter="x",pAxis=xa,vLetter="y",vAxis=ya);var di=cd[pointData.index];if(vVal>=di.span[0]&&vVal<=di.span[1]){var kdePointData=_$lib_539.extendFlat({},pointData),vValPx=vAxis.c2p(vVal,!0),kdeVal=_$helpers_954.getKdeValue(di,trace,vVal),pOnPath=_$helpers_954.getPositionOnKdePath(di,trace,vValPx),paOffset=pAxis._offset,paLength=pAxis._length;kdePointData[pLetter+"0"]=pOnPath[0],kdePointData[pLetter+"1"]=pOnPath[1],kdePointData[vLetter+"0"]=kdePointData[vLetter+"1"]=vValPx,kdePointData[vLetter+"Label"]=vLetter+": "+_$axes_584.hoverLabelText(vAxis,vVal)+", "+cd[0].t.labels.kde+" "+kdeVal.toFixed(3),kdePointData.spikeDistance=closeBoxData[0].spikeDistance;var spikePosAttr=pLetter+"Spike";kdePointData[spikePosAttr]=closeBoxData[0][spikePosAttr],closeBoxData[0].spikeDistance=void 0,closeBoxData[0][spikePosAttr]=void 0,closeData.push(kdePointData),(violinLineAttrs={stroke:pointData.color})[pLetter+"1"]=_$lib_539.constrain(paOffset+pOnPath[0],paOffset,paOffset+paLength),violinLineAttrs[pLetter+"2"]=_$lib_539.constrain(paOffset+pOnPath[1],paOffset,paOffset+paLength),violinLineAttrs[vLetter+"1"]=violinLineAttrs[vLetter+"2"]=vAxis._offset+vValPx}}}-1!==hoveron.indexOf("points")&&(closePtData=_$hover_694.hoverOnPoints(pointData,xval,yval));var violinLine=hoverLayer.selectAll(".violinline-"+trace.uid).data(violinLineAttrs?[0]:[]);return violinLine.enter().append("line").classed("violinline-"+trace.uid,!0).attr("stroke-width",1.5),violinLine.exit().remove(),violinLine.attr(violinLineAttrs),"closest"===hovermode?closePtData?[closePtData]:closeData:closePtData?(closeData.push(closePtData),closeData):closeData},selectPoints:_$selectPoints_699,moduleType:"trace",name:"violin",basePlotModule:_$cartesian_595,categories:["cartesian","symbols","oriented","box-violin","showLegend"],meta:{}};return _$core_12.register([_$bar_4,_$box_5,_$heatmap_15,_$histogram_17,_$histogram2d_18,_$histogram2dcontour_19,_$pie_24,_$contour_10,_$scatterternary_34,_$violin_38,_$scatter3d_27,_$surface_36,_$mesh3d_21,_$scattergeo_29,_$choropleth_9,_$scattergl_30,_$pointcloud_25,_$heatmapgl_16,_$parcoords_23,_$scattermapbox_31,_$sankey_26,_$table_37,_$carpet_8,_$scattercarpet_28,_$contourcarpet_11,_$ohlc_22,_$candlestick_7,_$scatterpolar_32,_$scatterpolargl_33]),_$core_12.register([_$aggregate_3,_$filter_13,_$groupby_14,_$sort_35]),_$core_12.register([_$calendars_6]),_$core_12},module.exports=f()}).call(exports,__webpack_require__(17))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getColor=exports.getDisplayName=exports.aggregate=exports.getSortedSamples=exports.createSortEventsForGeneComparator=exports.createSamplesMap=exports.isMutation=exports.getSortedGenes=exports.getGeneNames=exports.SupportedEvents=void 0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_PrecomputedComparator2=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(558));function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}var MutationEventTypes=["INFRAME","TRUNC","MISSENSE"],SupportedEvents=exports.SupportedEvents={MISSENSE:{colorHTML:"#008000",displayName:"Missense mutation"},INFRAME:{colorHTML:"#993404",displayName:"Inframe mutation"},TRUNC:{colorHTML:"#000000",displayName:"Truncation mutation"},FUSION:{colorHTML:"#8b00c9",displayName:"Fusion"},AMP:{colorHTML:"#ff0000",displayName:"Amplification"},GAIN:{colorHTML:"#ffb6c1",displayName:"Gain"},HETLOSS:{colorHTML:"#8fd8d8",displayName:"Shallow deletion"},HOMDEL:{colorHTML:"#0000ff",displayName:"Deep deletion"},UP:{colorHTML:"#ff9999",displayName:"mRNA Upregulation"},DOWN:{colorHTML:"#6699cc",displayName:"mRNA Downregulation"}},AlterationsOrder={AMP:0,GAIN:2,HETLOSS:3,HOMDEL:1,undefined:4},MutationsOrder={INFRAME:1,MISSENSE:3,TRUNC:0,undefined:4},ExpressionsOrder={UP:0,DOWN:1,undefined:2},getGeneNames=exports.getGeneNames=function getGeneNames(events){return events.map(function(e){return e.gene}).filter(function(gene){return null!==gene})},isMutation=(exports.getSortedGenes=function getSortedGenes(events){return[].concat(_toConsumableArray(new Set(getGeneNames(events)))).reverse()},exports.isMutation=function isMutation(event){return MutationEventTypes.includes(event.type)}),sign=function sign(x){return x>0?1:x<0?-1:0},createSamplesMap=exports.createSamplesMap=function createSamplesMap(events){var samplesMap={};return events.forEach(function(e){var v=(samplesMap[e.sample]||{})[e.gene]||{};isMutation(e)?v.MUT=e.type:v[e.type]=e.alteration,samplesMap[e.sample]=_extends({},samplesMap[e.sample],function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}({},e.gene,v))}),samplesMap},createSortEventsForGeneComparator=exports.createSortEventsForGeneComparator=function createSortEventsForGeneComparator(gene,map){return function(s1,s2){return function sortEventsForGene(s1,s2,gene,samplesMap){var d1=samplesMap[s1][gene]||{},d2=samplesMap[s2][gene]||{};if(d1.FUSION&&!d2.FUSION)return-1;if(!d1.FUSION&&d2.FUSION)return 1;var cna=sign(AlterationsOrder[d1.CNA]-AlterationsOrder[d2.CNA]);if(0!==cna)return cna;var mut=sign(MutationsOrder[d1.MUT]-MutationsOrder[d2.MUT]);if(0!==mut)return mut;var exp=sign(ExpressionsOrder[d1.EXP]-ExpressionsOrder[d2.EXP]);return 0!==exp?exp:0}(s1,s2,gene,map)}};exports.getSortedSamples=function getSortedSamples(events){var samplesMap=createSamplesMap(events),genes=[].concat(_toConsumableArray(new Set(getGeneNames(events)))),samples=[].concat(_toConsumableArray(new Set(events.map(function(e){return e.sample})))).sort(),perGeneComparators=[];genes.forEach(function(gene){perGeneComparators.push(new _PrecomputedComparator2.default([].concat(_toConsumableArray(samples)),createSortEventsForGeneComparator(gene,samplesMap)))});var samplesToIndex={};samples.forEach(function(s,i){samplesToIndex[s]=i});var sortedSamples=[].concat(_toConsumableArray(samples));return sortedSamples.sort(function samplesComparator(genes,samplesToIndex,perGeneComparators){return function(s1,s2){for(var result=0,absoluteResult=0,i=0;i<genes.length;i+=1){var nextResult=perGeneComparators[i].compare(s1,s2),nextAbsoluteResult=Math.abs(nextResult);if(nextAbsoluteResult>absoluteResult&&(result=nextResult,absoluteResult=nextAbsoluteResult),1===absoluteResult)break}return 0===result&&(result=samplesToIndex[s1]<samplesToIndex[s2]?-1:1),result>0?1:-1}}(genes,samplesToIndex,perGeneComparators)),sortedSamples},exports.aggregate=function aggregate(events){var out={};return events.forEach(function(e){if(e.type&&"NONE"!==e.type){var k=isMutation(e)?e.type:e.alteration,v=out[k]||{type:e.type,alteration:e.alteration,events:[]};v.events.push(e),out[k]=v}}),out},exports.getDisplayName=function getDisplayName(event){var eventName=isMutation(event)?event.type:event.alteration;return SupportedEvents[eventName].displayName},exports.getColor=function getColor(event){var eventName=isMutation(event)?event.type:event.alteration;return SupportedEvents[eventName].colorHTML}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_haselementsininterval2=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(559));var PrecomputedComparator=function(){function PrecomputedComparator(data,comparator){!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,PrecomputedComparator),this.comparator=comparator,this.data=data,this.sort()}return _createClass(PrecomputedComparator,[{key:"sort",value:function sort(){this.sortedData=this.data.sort(this.comparator),this.changePoints=[];for(var i=0;i<this.sortedData.length&&i!==this.sortedData.length-1;i+=1)0!==this.comparator(this.sortedData[i],this.sortedData[i+1])&&this.changePoints.push(i);this.samplesToIndex={};for(var _i=0;_i<this.sortedData.length;_i+=1)this.samplesToIndex[this.sortedData[_i]]=_i}},{key:"compare",value:function compare(s1,s2){var i1=this.samplesToIndex[s1],i2=this.samplesToIndex[s2];if(void 0===i1&&void 0===i2)return 0;if(void 0===i1)return 1;if(void 0===i2)return-1;var shouldNegateResult=!1;if(i1===i2)return 0;if(i1>i2){var tmp=i1;i1=i2,i2=tmp,shouldNegateResult=!0}var res=0;return(0,_haselementsininterval2.default)(this.changePoints,function(x){return x},i1,i2)&&(res=-1),shouldNegateResult&&(res*=-1),res}}]),PrecomputedComparator}();exports.default=PrecomputedComparator},function(module,exports){module.exports=function(sorted_list,valueFn,lower_inc_val,upper_exc_val){for(var middle,middle_val,test_lower_inc=0,test_upper_exc=sorted_list.length,ret=!1;!(test_lower_inc>=test_upper_exc);)if((middle_val=valueFn(sorted_list[middle=Math.floor((test_lower_inc+test_upper_exc)/2)]))>=upper_exc_val)test_upper_exc=middle;else{if(!(middle_val<lower_inc_val)){ret=!0;break}test_lower_inc=middle+1}return ret}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.default=[{sample:"TCGA-25-2392-01",gene:"TP53",alteration:"FUSION",type:"FUSION"},{sample:"TCGA-25-2393-01",gene:"TP53",alteration:"FUSION",type:"FUSION"},{sample:"TCGA-04-1331-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-04-1365-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-04-1648-01",gene:"TP53",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-09-1666-01",gene:"PTEN",alteration:"AMP",type:"CNA"},{sample:"TCGA-13-0720-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-13-0801-01",gene:"BRCA1",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-13-0801-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-13-0905-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-13-0924-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-13-1405-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-13-1408-01",gene:"TP53",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-13-1488-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-23-1023-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-23-1032-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-23-1107-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-23-1114-01",gene:"BRCA2",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-23-1118-01",gene:"PTEN",alteration:"AMP",type:"CNA"},{sample:"TCGA-23-1121-01",gene:"PTEN",alteration:"AMP",type:"CNA"},{sample:"TCGA-23-2084-01",gene:"TP53",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-24-0968-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-24-0970-01",gene:"BRCA2",alteration:"AMP",type:"CNA"},{sample:"TCGA-24-1103-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-24-1474-01",gene:"TP53",alteration:"AMP",type:"CNA"},{sample:"TCGA-24-1567-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-24-2030-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-24-2036-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-24-2262-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-24-2297-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-25-1322-01",gene:"BRCA2",alteration:"AMP",type:"CNA"},{sample:"TCGA-25-2391-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-25-2401-01",gene:"BRCA2",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-29-1697-01",gene:"PTEN",alteration:"AMP",type:"CNA"},{sample:"TCGA-29-1702-01",gene:"TP53",alteration:"AMP",type:"CNA"},{sample:"TCGA-29-1761-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-30-1860-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-31-1951-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-31-1959-01",gene:"BRCA1",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-31-1959-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-36-1570-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-57-1586-01",gene:"BRCA1",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-61-1728-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-61-1895-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-61-1907-01",gene:"BRCA2",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-61-2012-01",gene:"TP53",alteration:"AMP",type:"CNA"},{sample:"TCGA-61-2094-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-61-2097-01",gene:"BRCA2",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-29-1702-01",gene:"TP53",alteration:"UP",type:"EXP"},{sample:"TCGA-61-2012-01",gene:"TP53",alteration:"UP",type:"EXP"},{sample:"TCGA-36-1570-01",gene:"PTEN",alteration:"DOWN",type:"EXP"},{sample:"TCGA-57-1586-01",gene:"BRCA1",alteration:"DOWN",type:"EXP"},{sample:"TCGA-61-1728-01",gene:"PTEN",alteration:"DOWN",type:"EXP"},{sample:"TCGA-61-1895-01",gene:"PTEN",alteration:"DOWN",type:"EXP"},{sample:"TCGA-61-1907-01",gene:"BRCA2",alteration:"DOWN",type:"EXP"},{sample:"TCGA-25-1625-01",gene:"BRCA1",alteration:"E116*",type:"TRUNC"},{sample:"TCGA-04-1357-01",gene:"BRCA1",alteration:"Q1538A",type:"MISSENSE"},{sample:"TCGA-13-0893-01",gene:"BRCA1",alteration:"K503fs",type:"TRUNC"},{sample:"TCGA-61-2109-01",gene:"BRCA1",alteration:"K654fs",type:"TRUNC"},{sample:"TCGA-13-0761-01",gene:"BRCA1",alteration:"R1495_splice",type:"TRUNC"},{sample:"TCGA-23-1118-01",gene:"BRCA1",alteration:"E23fs",type:"TRUNC"},{sample:"TCGA-29-2427-01",gene:"BRCA1",alteration:"L431*",type:"TRUNC"},{sample:"TCGA-23-1122-01",gene:"BRCA1",alteration:"Q1756fs",type:"TRUNC"},{sample:"TCGA-25-2392-01",gene:"BRCA1",alteration:"E1345fs",type:"TRUNC"},{sample:"TCGA-23-1027-01",gene:"BRCA1",alteration:"E23fs",type:"TRUNC"},{sample:"TCGA-25-1632-01",gene:"BRCA1",alteration:"L1216fs",type:"TRUNC"},{sample:"TCGA-23-1026-01",gene:"BRCA1",alteration:"G813fs",type:"TRUNC"},{sample:"TCGA-13-0804-01",gene:"BRCA1",alteration:"C47W",type:"MISSENSE"},{sample:"TCGA-24-2298-01",gene:"BRCA1",alteration:"Q1395fs",type:"TRUNC"},{sample:"TCGA-61-2008-01",gene:"BRCA1",alteration:"W1815*",type:"TRUNC"},{sample:"TCGA-09-2045-01",gene:"BRCA1",alteration:"Q1779fs",type:"TRUNC"},{sample:"TCGA-04-1356-01",gene:"BRCA1",alteration:"V722fs",type:"TRUNC"},{sample:"TCGA-25-1630-01",gene:"BRCA1",alteration:"K519fs",type:"TRUNC"},{sample:"TCGA-24-1470-01",gene:"BRCA1",alteration:"L1676fs",type:"TRUNC"},{sample:"TCGA-13-0730-01",gene:"BRCA1",alteration:"R1835*",type:"TRUNC"},{sample:"TCGA-13-0883-01",gene:"BRCA1",alteration:"Q1756fs",type:"TRUNC"},{sample:"TCGA-25-2401-01",gene:"BRCA1",alteration:"Q1756fs",type:"TRUNC"},{sample:"TCGA-13-0903-01",gene:"BRCA1",alteration:"R504fs",type:"TRUNC"},{sample:"TCGA-13-0887-01",gene:"BRCA1",alteration:"E23fs",type:"TRUNC"},{sample:"TCGA-13-1494-01",gene:"BRCA1",alteration:"K45_splice",type:"TRUNC"},{sample:"TCGA-09-2051-01",gene:"BRCA1",alteration:"Q1756fs",type:"TRUNC"},{sample:"TCGA-23-2078-01",gene:"BRCA1",alteration:"E23fs",type:"TRUNC"},{sample:"TCGA-23-2079-01",gene:"BRCA1",alteration:"E23fs",type:"TRUNC"},{sample:"TCGA-10-0931-01",gene:"BRCA1",alteration:"E23fs",type:"TRUNC"},{sample:"TCGA-59-2348-01",gene:"BRCA1",alteration:"E797*",type:"TRUNC"},{sample:"TCGA-23-2077-01",gene:"BRCA1",alteration:"Q1756fs",type:"TRUNC"},{sample:"TCGA-09-1669-01",gene:"BRCA1",alteration:"E1345fs",type:"TRUNC"},{sample:"TCGA-23-2081-01",gene:"BRCA1",alteration:"Q1756fs",type:"TRUNC"},{sample:"TCGA-13-1408-01",gene:"BRCA1",alteration:"E23fs",type:"TRUNC"},{sample:"TCGA-13-1489-01",gene:"BRCA1",alteration:"N1265fs",type:"TRUNC"},{sample:"TCGA-25-1318-01",gene:"BRCA2",alteration:"L1491fs",type:"TRUNC"},{sample:"TCGA-13-0793-01",gene:"BRCA2",alteration:"T3085fs",type:"TRUNC"},{sample:"TCGA-24-1463-01",gene:"BRCA2",alteration:"G602fs",type:"TRUNC"},{sample:"TCGA-13-0913-01",gene:"BRCA2",alteration:"E1857fs",type:"TRUNC"},{sample:"TCGA-04-1367-01",gene:"BRCA2",alteration:"E294*",type:"TRUNC"},{sample:"TCGA-24-1562-01",gene:"BRCA2",alteration:"K3326*",type:"TRUNC"},{sample:"TCGA-04-1331-01",gene:"BRCA2",alteration:"C711*",type:"TRUNC"},{sample:"TCGA-24-1103-01",gene:"BRCA2",alteration:"K1638E",type:"MISSENSE"},{sample:"TCGA-13-0885-01",gene:"BRCA2",alteration:"K1406fs",type:"TRUNC"},{sample:"TCGA-13-0890-01",gene:"BRCA2",alteration:"V1229fs",type:"TRUNC"},{sample:"TCGA-13-1512-01",gene:"BRCA2",alteration:"K3326*",type:"TRUNC"},{sample:"TCGA-23-1030-01",gene:"BRCA2",alteration:"T1354M",type:"MISSENSE"},{sample:"TCGA-23-1026-01",gene:"BRCA2",alteration:"K3326*",type:"TRUNC"},{sample:"TCGA-25-1634-01",gene:"BRCA2",alteration:"E2878_splice",type:"TRUNC"},{sample:"TCGA-24-1555-01",gene:"BRCA2",alteration:"T2607fs",type:"TRUNC"},{sample:"TCGA-13-0886-01",gene:"BRCA2",alteration:"S1982fs",type:"TRUNC"},{sample:"TCGA-13-0792-01",gene:"BRCA2",alteration:"E1143D",type:"MISSENSE"},{sample:"TCGA-24-2293-01",gene:"BRCA2",alteration:"R2520*",type:"TRUNC"},{sample:"TCGA-23-1120-01",gene:"BRCA2",alteration:"L3277fs",type:"TRUNC"},{sample:"TCGA-57-1584-01",gene:"BRCA2",alteration:"Q1782fs",type:"TRUNC"},{sample:"TCGA-13-0900-01",gene:"BRCA2",alteration:"T256fs",type:"TRUNC"},{sample:"TCGA-24-2280-01",gene:"BRCA2",alteration:"S1982fs",type:"TRUNC"},{sample:"TCGA-24-0975-01",gene:"BRCA2",alteration:"V211_splice",type:"TRUNC"},{sample:"TCGA-24-2288-01",gene:"BRCA2",alteration:"T219fs",type:"TRUNC"},{sample:"TCGA-24-1417-01",gene:"BRCA2",alteration:"R1704fs",type:"TRUNC"},{sample:"TCGA-13-1498-01",gene:"BRCA2",alteration:"S1982fs",type:"TRUNC"},{sample:"TCGA-13-1499-01",gene:"BRCA2",alteration:"S1982fs",type:"TRUNC"},{sample:"TCGA-13-0726-01",gene:"BRCA2",alteration:"R2394*",type:"TRUNC"},{sample:"TCGA-25-2404-01",gene:"BRCA2",alteration:"E342fs",type:"TRUNC"},{sample:"TCGA-13-1481-01",gene:"BRCA2",alteration:"L2696fs",type:"TRUNC"},{sample:"TCGA-10-0930-01",gene:"PTEN",alteration:"V175L",type:"MISSENSE"},{sample:"TCGA-13-1492-01",gene:"PTEN",alteration:"R233fs",type:"TRUNC"},{sample:"TCGA-24-0968-01",gene:"TP53",alteration:"H193R",type:"MISSENSE"},{sample:"TCGA-13-1505-01",gene:"TP53",alteration:"P75fs",type:"TRUNC"},{sample:"TCGA-04-1336-01",gene:"TP53",alteration:"R248W",type:"MISSENSE"},{sample:"TCGA-24-2261-01",gene:"TP53",alteration:"Y163C",type:"MISSENSE"},{sample:"TCGA-13-0912-01",gene:"TP53",alteration:"S261_splice",type:"TRUNC"},{sample:"TCGA-36-1580-01",gene:"TP53",alteration:"R273C",type:"MISSENSE"},{sample:"TCGA-59-2352-01",gene:"TP53",alteration:"G266V",type:"MISSENSE"},{sample:"TCGA-25-2409-01",gene:"TP53",alteration:"R248W",type:"MISSENSE"},{sample:"TCGA-61-1919-01",gene:"TP53",alteration:"I195T",type:"MISSENSE"},{sample:"TCGA-13-0919-01",gene:"TP53",alteration:"V157F",type:"MISSENSE"},{sample:"TCGA-09-2051-01",gene:"TP53",alteration:"P222fs",type:"TRUNC"},{sample:"TCGA-09-2050-01",gene:"TP53",alteration:"L257Q",type:"MISSENSE"},{sample:"TCGA-25-1626-01",gene:"TP53",alteration:"G245V",type:"MISSENSE"},{sample:"TCGA-09-2049-01",gene:"TP53",alteration:"G245S",type:"MISSENSE"},{sample:"TCGA-24-1417-01",gene:"TP53",alteration:"R248W",type:"MISSENSE"},{sample:"TCGA-24-1422-01",gene:"TP53",alteration:"R248W",type:"MISSENSE"},{sample:"TCGA-13-0924-01",gene:"TP53",alteration:"F270L",type:"MISSENSE"},{sample:"TCGA-61-2109-01",gene:"TP53",alteration:"R306fs",type:"TRUNC"},{sample:"TCGA-24-1416-01",gene:"TP53",alteration:"R282W",type:"MISSENSE"},{sample:"TCGA-24-1564-01",gene:"TP53",alteration:"G187_splice",type:"TRUNC"},{sample:"TCGA-61-2088-01",gene:"TP53",alteration:"MCN237del",type:"INFRAME"},{sample:"TCGA-10-0934-01",gene:"TP53",alteration:"R248Q",type:"MISSENSE"},{sample:"TCGA-61-2003-01",gene:"TP53",alteration:"R175H",type:"MISSENSE"},{sample:"TCGA-10-0934-01",gene:"TP53",alteration:"R273H",type:"MISSENSE"},{sample:"TCGA-09-1666-01",gene:"TP53",alteration:"Y126_splice",type:"TRUNC"},{sample:"TCGA-13-0714-01",gene:"TP53",alteration:"S127F",type:"MISSENSE"},{sample:"TCGA-13-1510-01",gene:"TP53",alteration:"R213*",type:"TRUNC"},{sample:"TCGA-36-1576-01",gene:"TP53",alteration:"R337fs",type:"TRUNC"},{sample:"TCGA-25-1329-01",gene:"TP53",alteration:"P47fs",type:"TRUNC"},{sample:"TCGA-13-1481-01",gene:"TP53",alteration:"P177R",type:"MISSENSE"},{sample:"TCGA-04-1337-01",gene:"TP53",alteration:"C135R",type:"MISSENSE"},{sample:"TCGA-24-1428-01",gene:"TP53",alteration:"I195N",type:"MISSENSE"},{sample:"TCGA-24-1567-01",gene:"TP53",alteration:"R282W",type:"MISSENSE"},{sample:"TCGA-04-1332-01",gene:"TP53",alteration:"R181P",type:"MISSENSE"},{sample:"TCGA-04-1349-01",gene:"TP53",alteration:"S241F",type:"MISSENSE"},{sample:"TCGA-61-2008-01",gene:"TP53",alteration:"G117fs",type:"TRUNC"},{sample:"TCGA-13-0791-01",gene:"TP53",alteration:"R273L",type:"MISSENSE"},{sample:"TCGA-09-1669-01",gene:"TP53",alteration:"Q331_splice",type:"TRUNC"},{sample:"TCGA-24-2019-01",gene:"TP53",alteration:"I232N",type:"MISSENSE"},{sample:"TCGA-24-1425-01",gene:"TP53",alteration:"Y234C",type:"MISSENSE"},{sample:"TCGA-24-1423-01",gene:"TP53",alteration:"P191del",type:"INFRAME"},{sample:"TCGA-10-0926-01",gene:"TP53",alteration:"Y163C",type:"MISSENSE"},{sample:"TCGA-13-0760-01",gene:"TP53",alteration:"L265P",type:"MISSENSE"},{sample:"TCGA-24-1556-01",gene:"TP53",alteration:"A307_splice",type:"TRUNC"},{sample:"TCGA-24-1558-01",gene:"TP53",alteration:"R273H",type:"MISSENSE"},{sample:"TCGA-25-2404-01",gene:"TP53",alteration:"H214R",type:"MISSENSE"},{sample:"TCGA-24-1616-01",gene:"TP53",alteration:"Y236C",type:"MISSENSE"},{sample:"TCGA-13-0720-01",gene:"TP53",alteration:"A159V",type:"MISSENSE"},{sample:"TCGA-24-2280-01",gene:"TP53",alteration:"Q192*",type:"TRUNC"},{sample:"TCGA-13-0793-01",gene:"TP53",alteration:"C124fs",type:"TRUNC"},{sample:"TCGA-24-1604-01",gene:"TP53",alteration:"A307_splice",type:"TRUNC"},{sample:"TCGA-09-1659-01",gene:"TP53",alteration:"E294*",type:"TRUNC"},{sample:"TCGA-24-1413-01",gene:"TP53",alteration:"E198*",type:"TRUNC"},{sample:"TCGA-09-1662-01",gene:"TP53",alteration:"C176Y",type:"MISSENSE"},{sample:"TCGA-13-0724-01",gene:"TP53",alteration:"V157F",type:"MISSENSE"},{sample:"TCGA-24-2030-01",gene:"TP53",alteration:"G187_splice",type:"TRUNC"},{sample:"TCGA-13-1484-01",gene:"TP53",alteration:"Y234N",type:"MISSENSE"},{sample:"TCGA-24-2254-01",gene:"TP53",alteration:"S241F",type:"MISSENSE"},{sample:"TCGA-61-2101-01",gene:"TP53",alteration:"P85fs",type:"TRUNC"},{sample:"TCGA-09-0366-01",gene:"TP53",alteration:"K132N",type:"MISSENSE"},{sample:"TCGA-04-1365-01",gene:"TP53",alteration:"Y126_splice",type:"TRUNC"},{sample:"TCGA-09-2053-01",gene:"TP53",alteration:"Y163H",type:"MISSENSE"},{sample:"TCGA-24-2024-01",gene:"TP53",alteration:"V272M",type:"MISSENSE"},{sample:"TCGA-23-1120-01",gene:"TP53",alteration:"R110L",type:"MISSENSE"},{sample:"TCGA-24-0970-01",gene:"TP53",alteration:"G187_splice",type:"TRUNC"},{sample:"TCGA-13-1489-01",gene:"TP53",alteration:"R342*",type:"TRUNC"},{sample:"TCGA-24-1103-01",gene:"TP53",alteration:"A307_splice",type:"TRUNC"},{sample:"TCGA-57-1993-01",gene:"TP53",alteration:"R248Q",type:"MISSENSE"},{sample:"TCGA-25-1322-01",gene:"TP53",alteration:"Y205C",type:"MISSENSE"},{sample:"TCGA-13-0751-01",gene:"TP53",alteration:"L348fs",type:"TRUNC"},{sample:"TCGA-04-1356-01",gene:"TP53",alteration:"Y220C",type:"MISSENSE"},{sample:"TCGA-10-0928-01",gene:"TP53",alteration:"G105S",type:"MISSENSE"},{sample:"TCGA-23-2077-01",gene:"TP53",alteration:"R175H",type:"MISSENSE"},{sample:"TCGA-13-0890-01",gene:"TP53",alteration:"Y126_splice",type:"TRUNC"},{sample:"TCGA-04-1525-01",gene:"TP53",alteration:"R282fs",type:"TRUNC"},{sample:"TCGA-23-1022-01",gene:"TP53",alteration:"K164E",type:"MISSENSE"},{sample:"TCGA-13-0905-01",gene:"TP53",alteration:"R273P",type:"MISSENSE"},{sample:"TCGA-30-1862-01",gene:"TP53",alteration:"E224_splice",type:"TRUNC"},{sample:"TCGA-13-0765-01",gene:"TP53",alteration:"AMP64_264L>LSSGNL",type:"INFRAME"},{sample:"TCGA-31-1953-01",gene:"TP53",alteration:"V97fs",type:"TRUNC"},{sample:"TCGA-04-1514-01",gene:"TP53",alteration:"Y126_splice",type:"TRUNC"},{sample:"TCGA-13-1509-01",gene:"TP53",alteration:"L330fs",type:"TRUNC"},{sample:"TCGA-24-1419-01",gene:"TP53",alteration:"R248Q",type:"MISSENSE"},{sample:"TCGA-25-1321-01",gene:"TP53",alteration:"R273C",type:"MISSENSE"},{sample:"TCGA-20-0987-01",gene:"TP53",alteration:"G105R",type:"MISSENSE"},{sample:"TCGA-23-1024-01",gene:"TP53",alteration:"G108fs",type:"TRUNC"},{sample:"TCGA-24-2290-01",gene:"TP53",alteration:"V274G",type:"MISSENSE"},{sample:"TCGA-23-1124-01",gene:"TP53",alteration:"R156P",type:"MISSENSE"},{sample:"TCGA-61-2094-01",gene:"TP53",alteration:"L130V",type:"MISSENSE"},{sample:"TCGA-25-1625-01",gene:"TP53",alteration:"V216M",type:"MISSENSE"},{sample:"TCGA-61-1736-01",gene:"TP53",alteration:"G245R",type:"MISSENSE"},{sample:"TCGA-13-0800-01",gene:"TP53",alteration:"K132M",type:"MISSENSE"},{sample:"TCGA-24-1555-01",gene:"TP53",alteration:"H179Q",type:"MISSENSE"},{sample:"TCGA-25-2391-01",gene:"TP53",alteration:"E51fs",type:"TRUNC"},{sample:"TCGA-24-1434-01",gene:"TP53",alteration:"L344fs",type:"TRUNC"},{sample:"TCGA-04-1517-01",gene:"TP53",alteration:"R65*",type:"TRUNC"},{sample:"TCGA-09-1661-01",gene:"TP53",alteration:"G187_splice",type:"TRUNC"},{sample:"TCGA-61-1995-01",gene:"TP53",alteration:"C238Y",type:"MISSENSE"},{sample:"TCGA-31-1959-01",gene:"TP53",alteration:"C238F",type:"MISSENSE"},{sample:"TCGA-24-1614-01",gene:"TP53",alteration:"V157F",type:"MISSENSE"},{sample:"TCGA-36-1569-01",gene:"TP53",alteration:"W53*",type:"TRUNC"},{sample:"TCGA-24-2271-01",gene:"TP53",alteration:"K321*",type:"TRUNC"},{sample:"TCGA-23-1123-01",gene:"TP53",alteration:"C176Y",type:"MISSENSE"},{sample:"TCGA-13-1507-01",gene:"TP53",alteration:"T140fs",type:"TRUNC"},{sample:"TCGA-13-0913-01",gene:"TP53",alteration:"P278R",type:"MISSENSE"},{sample:"TCGA-13-0899-01",gene:"TP53",alteration:"Q317*",type:"TRUNC"},{sample:"TCGA-23-1110-01",gene:"TP53",alteration:"C176Y",type:"MISSENSE"},{sample:"TCGA-25-1319-01",gene:"TP53",alteration:"Y220C",type:"MISSENSE"},{sample:"TCGA-24-1548-01",gene:"TP53",alteration:"Y220C",type:"MISSENSE"},{sample:"TCGA-13-0910-01",gene:"TP53",alteration:"C275Y",type:"MISSENSE"},{sample:"TCGA-04-1346-01",gene:"TP53",alteration:"H179R",type:"MISSENSE"},{sample:"TCGA-04-1350-01",gene:"TP53",alteration:"H179R",type:"MISSENSE"},{sample:"TCGA-25-1326-01",gene:"TP53",alteration:"E286K",type:"MISSENSE"},{sample:"TCGA-24-1549-01",gene:"TP53",alteration:"V225_splice",type:"TRUNC"},{sample:"TCGA-13-0891-01",gene:"TP53",alteration:"Y220C",type:"MISSENSE"},{sample:"TCGA-10-0931-01",gene:"TP53",alteration:"Q136*",type:"TRUNC"},{sample:"TCGA-13-1411-01",gene:"TP53",alteration:"C277F",type:"MISSENSE"},{sample:"TCGA-13-1498-01",gene:"TP53",alteration:"I332_splice",type:"TRUNC"},{sample:"TCGA-24-2260-01",gene:"TP53",alteration:"R248Q",type:"MISSENSE"},{sample:"TCGA-23-1030-01",gene:"TP53",alteration:"R175H",type:"MISSENSE"},{sample:"TCGA-04-1342-01",gene:"TP53",alteration:"N288fs",type:"TRUNC"},{sample:"TCGA-13-0723-01",gene:"TP53",alteration:"T150fs",type:"TRUNC"},{sample:"TCGA-24-2289-01",gene:"TP53",alteration:"R196*",type:"TRUNC"},{sample:"TCGA-61-1728-01",gene:"TP53",alteration:"Y220C",type:"MISSENSE"},{sample:"TCGA-13-0883-01",gene:"TP53",alteration:"C238fs",type:"TRUNC"},{sample:"TCGA-23-1026-01",gene:"TP53",alteration:"K132R",type:"MISSENSE"},{sample:"TCGA-61-2097-01",gene:"TP53",alteration:"R342*",type:"TRUNC"},{sample:"TCGA-59-2354-01",gene:"TP53",alteration:"Y220C",type:"MISSENSE"},{sample:"TCGA-59-2350-01",gene:"TP53",alteration:"Y220C",type:"MISSENSE"},{sample:"TCGA-59-2363-01",gene:"TP53",alteration:"Y220C",type:"MISSENSE"},{sample:"TCGA-23-1122-01",gene:"TP53",alteration:"R175H",type:"MISSENSE"},{sample:"TCGA-13-0887-01",gene:"TP53",alteration:"R213*",type:"TRUNC"},{sample:"TCGA-13-0762-01",gene:"TP53",alteration:"H193R",type:"MISSENSE"},{sample:"TCGA-59-2351-01",gene:"TP53",alteration:"T140fs",type:"TRUNC"},{sample:"TCGA-25-2398-01",gene:"TP53",alteration:"154_154G>GTDSTPPPG",type:"INFRAME"},{sample:"TCGA-25-1315-01",gene:"TP53",alteration:"R273H",type:"MISSENSE"},{sample:"TCGA-24-2298-01",gene:"TP53",alteration:"V225_splice",type:"TRUNC"},{sample:"TCGA-13-1497-01",gene:"TP53",alteration:"R333fs",type:"TRUNC"},{sample:"TCGA-13-0792-01",gene:"TP53",alteration:"C238fs",type:"TRUNC"},{sample:"TCGA-13-0903-01",gene:"TP53",alteration:"Y205C",type:"MISSENSE"},{sample:"TCGA-30-1853-01",gene:"TP53",alteration:"G245D",type:"MISSENSE"},{sample:"TCGA-57-1582-01",gene:"TP53",alteration:"Y236C",type:"MISSENSE"},{sample:"TCGA-24-0966-01",gene:"TP53",alteration:"G245V",type:"MISSENSE"},{sample:"TCGA-24-1557-01",gene:"TP53",alteration:"Y126_splice",type:"TRUNC"},{sample:"TCGA-59-2355-01",gene:"TP53",alteration:"Q331_splice",type:"TRUNC"},{sample:"TCGA-23-1023-01",gene:"TP53",alteration:"D281G",type:"MISSENSE"},{sample:"TCGA-10-0927-01",gene:"TP53",alteration:"P36fs",type:"TRUNC"},{sample:"TCGA-09-2044-01",gene:"TP53",alteration:"G187_splice",type:"TRUNC"},{sample:"TCGA-13-0906-01",gene:"TP53",alteration:"F134V",type:"MISSENSE"},{sample:"TCGA-25-1627-01",gene:"TP53",alteration:"Y220C",type:"MISSENSE"},{sample:"TCGA-13-1482-01",gene:"TP53",alteration:"R280I",type:"MISSENSE"},{sample:"TCGA-24-2281-01",gene:"TP53",alteration:"R175H",type:"MISSENSE"},{sample:"TCGA-13-0889-01",gene:"TP53",alteration:"R273C",type:"MISSENSE"},{sample:"TCGA-24-1562-01",gene:"TP53",alteration:"S33_splice",type:"TRUNC"},{sample:"TCGA-13-1488-01",gene:"TP53",alteration:"R306*",type:"TRUNC"},{sample:"TCGA-61-2016-01",gene:"TP53",alteration:"E204*",type:"TRUNC"},{sample:"TCGA-04-1362-01",gene:"TP53",alteration:"V225_splice",type:"TRUNC"},{sample:"TCGA-13-0717-01",gene:"TP53",alteration:"AMP44_246GGM>V",type:"INFRAME"},{sample:"TCGA-61-2104-01",gene:"TP53",alteration:"Y163N",type:"MISSENSE"},{sample:"TCGA-13-0885-01",gene:"TP53",alteration:"W146*",type:"TRUNC"},{sample:"TCGA-24-2288-01",gene:"TP53",alteration:"P250L",type:"MISSENSE"},{sample:"TCGA-13-0726-01",gene:"TP53",alteration:"R282W",type:"MISSENSE"},{sample:"TCGA-10-0938-01",gene:"TP53",alteration:"Q331_splice",type:"TRUNC"},{sample:"TCGA-24-2035-01",gene:"TP53",alteration:"S315fs",type:"TRUNC"},{sample:"TCGA-13-1492-01",gene:"TP53",alteration:"G187_splice",type:"TRUNC"},{sample:"TCGA-24-1105-01",gene:"TP53",alteration:"V157F",type:"MISSENSE"},{sample:"TCGA-13-1494-01",gene:"TP53",alteration:"G105C",type:"MISSENSE"},{sample:"TCGA-24-0979-01",gene:"TP53",alteration:"R248Q",type:"MISSENSE"},{sample:"TCGA-04-1361-01",gene:"TP53",alteration:"Y234C",type:"MISSENSE"},{sample:"TCGA-25-1628-01",gene:"TP53",alteration:"E51*",type:"TRUNC"},{sample:"TCGA-13-1491-01",gene:"TP53",alteration:"C275Y",type:"MISSENSE"},{sample:"TCGA-25-1635-01",gene:"TP53",alteration:"D259Y",type:"MISSENSE"},{sample:"TCGA-13-1506-01",gene:"TP53",alteration:"M66fs",type:"TRUNC"},{sample:"TCGA-24-1560-01",gene:"TP53",alteration:"G244C",type:"MISSENSE"},{sample:"TCGA-13-1410-01",gene:"TP53",alteration:"L130fs",type:"TRUNC"},{sample:"TCGA-13-0804-01",gene:"TP53",alteration:"R273H",type:"MISSENSE"},{sample:"TCGA-24-1464-01",gene:"TP53",alteration:"N239S",type:"MISSENSE"},{sample:"TCGA-10-0935-01",gene:"TP53",alteration:"G187_splice",type:"TRUNC"},{sample:"TCGA-23-1032-01",gene:"TP53",alteration:"R248Q",type:"MISSENSE"},{sample:"TCGA-25-1630-01",gene:"TP53",alteration:"V173L",type:"MISSENSE"},{sample:"TCGA-61-2012-01",gene:"TP53",alteration:"Y220C",type:"MISSENSE"},{sample:"TCGA-36-1568-01",gene:"TP53",alteration:"G245S",type:"MISSENSE"},{sample:"TCGA-23-2072-01",gene:"TP53",alteration:"Q331_splice",type:"TRUNC"},{sample:"TCGA-13-1487-01",gene:"TP53",alteration:"M237K",type:"MISSENSE"},{sample:"TCGA-24-1426-01",gene:"TP53",alteration:"R273C",type:"MISSENSE"},{sample:"TCGA-24-1470-01",gene:"TP53",alteration:"S260fs",type:"TRUNC"},{sample:"TCGA-13-0920-01",gene:"TP53",alteration:"Q100*",type:"TRUNC"},{sample:"TCGA-13-0761-01",gene:"TP53",alteration:"R273H",type:"MISSENSE"},{sample:"TCGA-25-1320-01",gene:"TP53",alteration:"C124fs",type:"TRUNC"},{sample:"TCGA-23-1021-01",gene:"TP53",alteration:"A159V",type:"MISSENSE"},{sample:"TCGA-04-1348-01",gene:"TP53",alteration:"G266R",type:"MISSENSE"},{sample:"TCGA-23-1027-01",gene:"TP53",alteration:"E198*",type:"TRUNC"},{sample:"TCGA-04-1338-01",gene:"TP53",alteration:"G245S",type:"MISSENSE"},{sample:"TCGA-23-1117-01",gene:"TP53",alteration:"Q144fs",type:"TRUNC"},{sample:"TCGA-36-1578-01",gene:"TP53",alteration:"R273H",type:"MISSENSE"},{sample:"TCGA-36-1575-01",gene:"TP53",alteration:"R273H",type:"MISSENSE"},{sample:"TCGA-36-1574-01",gene:"TP53",alteration:"R273H",type:"MISSENSE"},{sample:"TCGA-25-2399-01",gene:"TP53",alteration:"R175H",type:"MISSENSE"},{sample:"TCGA-25-1634-01",gene:"TP53",alteration:"A70fs",type:"TRUNC"},{sample:"TCGA-30-1891-01",gene:"TP53",alteration:"L194R",type:"MISSENSE"},{sample:"TCGA-36-1577-01",gene:"TP53",alteration:"E224_splice",type:"TRUNC"},{sample:"TCGA-13-0900-01",gene:"TP53",alteration:"R273H",type:"MISSENSE"},{sample:"TCGA-24-1466-01",gene:"TP53",alteration:"R249G",type:"MISSENSE"},{sample:"TCGA-61-2092-01",gene:"TP53",alteration:"D208V",type:"MISSENSE"},{sample:"TCGA-04-1347-01",gene:"TP53",alteration:"S215R",type:"MISSENSE"},{sample:"TCGA-20-0990-01",gene:"TP53",alteration:"Q144*",type:"TRUNC"},{sample:"TCGA-13-1499-01",gene:"TP53",alteration:"R273C",type:"MISSENSE"},{sample:"TCGA-24-1104-01",gene:"TP53",alteration:"I195T",type:"MISSENSE"},{sample:"TCGA-24-1418-01",gene:"TP53",alteration:"S227fs",type:"TRUNC"},{sample:"TCGA-57-1583-01",gene:"TP53",alteration:"C229fs",type:"TRUNC"},{sample:"TCGA-29-2427-01",gene:"TP53",alteration:"G244D",type:"MISSENSE"},{sample:"TCGA-13-1499-01",gene:"TP53",alteration:"R248Q",type:"MISSENSE"},{sample:"TCGA-13-0795-01",gene:"TP53",alteration:"C135Y",type:"MISSENSE"},{sample:"TCGA-13-1496-01",gene:"TP53",alteration:"R248Q",type:"MISSENSE"},{sample:"TCGA-09-2045-01",gene:"TP53",alteration:"H179R",type:"MISSENSE"},{sample:"TCGA-23-2081-01",gene:"TP53",alteration:"G262V",type:"MISSENSE"},{sample:"TCGA-24-1474-01",gene:"TP53",alteration:"Q192*",type:"TRUNC"},{sample:"TCGA-25-1623-01",gene:"TP53",alteration:"R282W",type:"MISSENSE"},{sample:"TCGA-24-1551-01",gene:"TP53",alteration:"R248W",type:"MISSENSE"},{sample:"TCGA-24-1431-01",gene:"TP53",alteration:"Q192*",type:"TRUNC"},{sample:"TCGA-13-2060-01",gene:"TP53",alteration:"H179R",type:"MISSENSE"},{sample:"TCGA-25-1631-01",gene:"TP53",alteration:"T125_splice",type:"TRUNC"},{sample:"TCGA-13-0893-01",gene:"TP53",alteration:"G245D",type:"MISSENSE"},{sample:"TCGA-13-1495-01",gene:"TP53",alteration:"I195F",type:"MISSENSE"},{sample:"TCGA-24-1603-01",gene:"TP53",alteration:"S315fs",type:"TRUNC"},{sample:"TCGA-04-1530-01",gene:"TP53",alteration:"R273H",type:"MISSENSE"},{sample:"TCGA-04-1542-01",gene:"TP53",alteration:"R273H",type:"MISSENSE"},{sample:"TCGA-24-1471-01",gene:"TP53",alteration:"E271*",type:"TRUNC"},{sample:"TCGA-61-2102-01",gene:"TP53",alteration:"G266R",type:"MISSENSE"},{sample:"TCGA-24-1469-01",gene:"TP53",alteration:"I195T",type:"MISSENSE"},{sample:"TCGA-57-1584-01",gene:"TP53",alteration:"C176Y",type:"MISSENSE"},{sample:"TCGA-13-1407-01",gene:"TP53",alteration:"F109C",type:"MISSENSE"},{sample:"TCGA-13-1512-01",gene:"TP53",alteration:"R273L",type:"MISSENSE"},{sample:"TCGA-23-1028-01",gene:"TP53",alteration:"P250L",type:"MISSENSE"},{sample:"TCGA-13-0894-01",gene:"TP53",alteration:"H193Y",type:"MISSENSE"},{sample:"TCGA-13-1409-01",gene:"TP53",alteration:"S261_splice",type:"TRUNC"},{sample:"TCGA-24-0982-01",gene:"TP53",alteration:"R248W",type:"MISSENSE"},{sample:"TCGA-36-1570-01",gene:"TP53",alteration:"R248fs",type:"TRUNC"},{sample:"TCGA-13-0730-01",gene:"TP53",alteration:"H178fs",type:"TRUNC"},{sample:"TCGA-61-2000-01",gene:"TP53",alteration:"K132E",type:"MISSENSE"},{sample:"TCGA-61-2110-01",gene:"TP53",alteration:"S127Y",type:"MISSENSE"},{sample:"TCGA-31-1950-01",gene:"TP53",alteration:"I195T",type:"MISSENSE"},{sample:"TCGA-24-1424-01",gene:"TP53",alteration:"I195T",type:"MISSENSE"},{sample:"TCGA-25-1632-01",gene:"TP53",alteration:"R248G",type:"MISSENSE"},{sample:"TCGA-24-1427-01",gene:"TP53",alteration:"V272fs",type:"TRUNC"},{sample:"TCGA-61-1998-01",gene:"TP53",alteration:"S215R",type:"MISSENSE"},{sample:"TCGA-13-0904-01",gene:"TP53",alteration:"G279E",type:"MISSENSE"},{sample:"TCGA-13-0923-01",gene:"TP53",alteration:"G187_splice",type:"TRUNC"},{sample:"TCGA-24-1563-01",gene:"TP53",alteration:"I195T",type:"MISSENSE"},{sample:"TCGA-13-1504-01",gene:"TP53",alteration:"I251S",type:"MISSENSE"},{sample:"TCGA-25-1324-01",gene:"TP53",alteration:"Y126_splice",type:"TRUNC"},{sample:"TCGA-13-0897-01",gene:"TP53",alteration:"R283fs",type:"TRUNC"},{sample:"TCGA-04-1331-01",gene:"TP53",alteration:"R306*",type:"TRUNC"},{sample:"TCGA-10-0937-01",gene:"TP53",alteration:"R282W",type:"MISSENSE"},{sample:"TCGA-13-1405-01",gene:"TP53",alteration:"R196*",type:"TRUNC"},{sample:"TCGA-04-1364-01",gene:"TP53",alteration:"R248Q",type:"MISSENSE"},{sample:"TCGA-20-0991-01",gene:"TP53",alteration:"S241F",type:"MISSENSE"},{sample:"TCGA-24-2267-01",gene:"TP53",alteration:"T284fs",type:"TRUNC"},{sample:"TCGA-13-1404-01",gene:"TP53",alteration:"C176Y",type:"MISSENSE"},{sample:"TCGA-13-0911-01",gene:"TP53",alteration:"L43fs",type:"TRUNC"},{sample:"TCGA-25-1313-01",gene:"TP53",alteration:"L145R",type:"MISSENSE"},{sample:"TCGA-36-1571-01",gene:"TP53",alteration:"R337C",type:"MISSENSE"},{sample:"TCGA-13-0884-01",gene:"TP53",alteration:"R342*",type:"TRUNC"},{sample:"TCGA-23-2078-01",gene:"TP53",alteration:"T256del",type:"INFRAME"},{sample:"TCGA-13-1412-01",gene:"TP53",alteration:"M237I",type:"MISSENSE"},{sample:"TCGA-24-1545-01",gene:"TP53",alteration:"S241Y",type:"MISSENSE"},{sample:"TCGA-25-2401-01",gene:"TP53",alteration:"L194R",type:"MISSENSE"},{sample:"TCGA-24-1436-01",gene:"TP53",alteration:"Q331_splice",type:"TRUNC"},{sample:"TCGA-25-2400-01",gene:"TP53",alteration:"E224_splice",type:"TRUNC"},{sample:"TCGA-04-1357-01",gene:"TP53",alteration:"P223fs",type:"TRUNC"},{sample:"TCGA-13-1403-01",gene:"TP53",alteration:"T125_splice",type:"TRUNC"},{sample:"TCGA-13-0886-01",gene:"TP53",alteration:"V272M",type:"MISSENSE"},{sample:"TCGA-25-1318-01",gene:"TP53",alteration:"R175H",type:"MISSENSE"},{sample:"TCGA-23-1116-01",gene:"TP53",alteration:"S261_splice",type:"TRUNC"},{sample:"TCGA-10-0925-01",gene:null,alteration:null,type:null},{sample:"TCGA-10-0926-01",gene:null,alteration:null,type:null},{sample:"TCGA-10-0927-01",gene:null,alteration:null,type:null},{sample:"TCGA-10-0928-01",gene:null,alteration:null,type:null},{sample:"TCGA-10-0930-01",gene:null,alteration:null,type:null},{sample:"TCGA-10-0931-01",gene:null,alteration:null,type:null},{sample:"TCGA-10-0933-01",gene:null,alteration:null,type:null},{sample:"TCGA-10-0934-01",gene:null,alteration:null,type:null},{sample:"TCGA-20-1684-01",gene:null,alteration:null,type:null},{sample:"TCGA-20-1685-01",gene:null,alteration:null,type:null},{sample:"TCGA-20-1686-01",gene:null,alteration:null,type:null},{sample:"TCGA-20-1687-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1021-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1022-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1023-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1024-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1026-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1027-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1028-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1029-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1030-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1031-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1032-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1107-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1109-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1110-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1111-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1113-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1114-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1116-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1117-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1118-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1119-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1120-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1121-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1122-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1123-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1124-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-1809-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-2072-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-2077-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-2078-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-2079-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-2081-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-2084-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-2641-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-2643-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-2645-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-2647-01",gene:null,alteration:null,type:null},{sample:"TCGA-23-2649-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-0966-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-0968-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-0970-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-0975-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-0979-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-0980-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-0981-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-0982-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1103-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1104-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1105-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1413-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1416-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1417-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1418-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1419-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1422-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1423-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1424-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1425-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1426-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1427-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1428-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1430-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1431-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1434-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1435-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1436-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1463-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1464-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1466-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1467-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1469-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1470-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1471-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1474-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1544-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1545-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1546-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1548-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1549-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1550-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1551-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1552-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1553-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1555-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1556-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1557-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1558-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1560-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1562-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1563-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1564-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1565-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1567-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1603-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1604-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1614-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1616-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1842-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1843-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1844-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1845-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1846-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1847-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1849-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1850-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1852-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1920-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1923-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1924-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1927-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1928-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-1930-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2019-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2020-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2023-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2024-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2026-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2027-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2029-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2030-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2033-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2035-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2036-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2038-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2254-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2260-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2261-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2262-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2267-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2271-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2280-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2281-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2288-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2289-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2290-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2293-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2295-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2297-01",gene:null,alteration:null,type:null},{sample:"TCGA-24-2298-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1312-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1313-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1314-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1315-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1316-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1317-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1318-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1319-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1320-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1321-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1322-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1323-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1324-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1325-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1326-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1328-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1329-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1623-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1625-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1626-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1627-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1628-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1630-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1631-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1632-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1633-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1634-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1635-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1870-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1871-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1877-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-1878-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-2042-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-2390-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-2391-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-2396-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-2397-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-2398-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-2399-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-2400-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-2401-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-2392-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-2393-01",gene:null,alteration:null,type:null}]},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.default=[{sample:"TCGA-25-2392-01",gene:"TP53",alteration:"FUSION",type:"FUSION"},{sample:"TCGA-25-2393-01",gene:"TP53",alteration:"FUSION",type:"FUSION"},{sample:"TCGA-04-1331-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-04-1365-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-04-1648-01",gene:"TP53",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-09-1666-01",gene:"PTEN",alteration:"AMP",type:"CNA"},{sample:"TCGA-13-0720-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-13-0801-01",gene:"BRCA1",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-13-0801-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-13-0905-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"}]},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.default=[{sample:"TCGA-25-2392-01",gene:"TP53",alteration:"FUSION",type:"FUSION"},{sample:"TCGA-25-2393-01",gene:"TP53",alteration:"FUSION",type:"FUSION"},{sample:"TCGA-04-1331-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-04-1365-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-04-1648-01",gene:"TP53",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-09-1666-01",gene:"PTEN",alteration:"AMP",type:"CNA"},{sample:"TCGA-13-0720-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-13-0801-01",gene:"BRCA1",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-13-0801-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-13-0905-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-13-0924-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-13-1405-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-13-1408-01",gene:"TP53",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-13-1488-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-23-1023-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-23-1032-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-23-1107-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-23-1114-01",gene:"BRCA2",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-23-1118-01",gene:"PTEN",alteration:"AMP",type:"CNA"},{sample:"TCGA-23-1121-01",gene:"PTEN",alteration:"AMP",type:"CNA"},{sample:"TCGA-23-2084-01",gene:"TP53",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-24-0968-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-24-0970-01",gene:"BRCA2",alteration:"AMP",type:"CNA"},{sample:"TCGA-24-1103-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-24-1474-01",gene:"TP53",alteration:"AMP",type:"CNA"},{sample:"TCGA-24-1567-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-24-2030-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-24-2036-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-24-2262-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-24-2297-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-25-1322-01",gene:"BRCA2",alteration:"AMP",type:"CNA"},{sample:"TCGA-25-2391-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-25-2401-01",gene:"BRCA2",alteration:"HOMDEL",type:"CNA"},{sample:"TCGA-29-1697-01",gene:"PTEN",alteration:"AMP",type:"CNA"},{sample:"TCGA-29-1702-01",gene:"TP53",alteration:"AMP",type:"CNA"},{sample:"TCGA-29-1761-01",gene:"PTEN",alteration:"HOMDEL",type:"CNA"}]},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.default=[{sample:"TCGA-23-1027-01",gene:"BRCA1",alteration:"E23fs",type:"TRUNC"},{sample:"TCGA-25-1632-01",gene:"BRCA1",alteration:"L1216fs",type:"TRUNC"},{sample:"TCGA-23-1026-01",gene:"BRCA1",alteration:"G813fs",type:"TRUNC"},{sample:"TCGA-13-0804-01",gene:"BRCA1",alteration:"C47W",type:"MISSENSE"},{sample:"TCGA-24-2298-01",gene:"BRCA1",alteration:"Q1395fs",type:"TRUNC"},{sample:"TCGA-61-2008-01",gene:"BRCA1",alteration:"W1815*",type:"TRUNC"},{sample:"TCGA-09-2045-01",gene:"BRCA1",alteration:"Q1779fs",type:"TRUNC"},{sample:"TCGA-04-1356-01",gene:"BRCA1",alteration:"V722fs",type:"TRUNC"},{sample:"TCGA-25-1630-01",gene:"BRCA1",alteration:"K519fs",type:"TRUNC"},{sample:"TCGA-24-1470-01",gene:"BRCA1",alteration:"L1676fs",type:"TRUNC"},{sample:"TCGA-13-0730-01",gene:"BRCA1",alteration:"R1835*",type:"TRUNC"},{sample:"TCGA-13-0883-01",gene:"BRCA1",alteration:"Q1756fs",type:"TRUNC"},{sample:"TCGA-25-2401-01",gene:"BRCA1",alteration:"Q1756fs",type:"TRUNC"},{sample:"TCGA-13-0903-01",gene:"BRCA1",alteration:"R504fs",type:"TRUNC"},{sample:"TCGA-13-0887-01",gene:"BRCA1",alteration:"E23fs",type:"TRUNC"},{sample:"TCGA-13-1494-01",gene:"BRCA1",alteration:"K45_splice",type:"TRUNC"},{sample:"TCGA-09-2051-01",gene:"BRCA1",alteration:"Q1756fs",type:"TRUNC"},{sample:"TCGA-23-2078-01",gene:"BRCA1",alteration:"E23fs",type:"TRUNC"},{sample:"TCGA-23-2079-01",gene:"BRCA1",alteration:"E23fs",type:"TRUNC"},{sample:"TCGA-10-0931-01",gene:"BRCA1",alteration:"E23fs",type:"TRUNC"},{sample:"TCGA-59-2348-01",gene:"BRCA1",alteration:"E797*",type:"TRUNC"},{sample:"TCGA-23-2077-01",gene:"BRCA1",alteration:"Q1756fs",type:"TRUNC"},{sample:"TCGA-09-1669-01",gene:"BRCA1",alteration:"E1345fs",type:"TRUNC"},{sample:"TCGA-23-2081-01",gene:"BRCA1",alteration:"Q1756fs",type:"TRUNC"},{sample:"TCGA-13-1408-01",gene:"BRCA1",alteration:"E23fs",type:"TRUNC"},{sample:"TCGA-13-1489-01",gene:"BRCA1",alteration:"N1265fs",type:"TRUNC"},{sample:"TCGA-25-1318-01",gene:"BRCA2",alteration:"L1491fs",type:"TRUNC"},{sample:"TCGA-13-0793-01",gene:"BRCA2",alteration:"T3085fs",type:"TRUNC"},{sample:"TCGA-24-1463-01",gene:"BRCA2",alteration:"G602fs",type:"TRUNC"},{sample:"TCGA-13-0913-01",gene:"BRCA2",alteration:"E1857fs",type:"TRUNC"},{sample:"TCGA-04-1367-01",gene:"BRCA2",alteration:"E294*",type:"TRUNC"},{sample:"TCGA-24-1562-01",gene:"BRCA2",alteration:"K3326*",type:"TRUNC"},{sample:"TCGA-04-1331-01",gene:"BRCA2",alteration:"C711*",type:"TRUNC"},{sample:"TCGA-24-1103-01",gene:"BRCA2",alteration:"K1638E",type:"MISSENSE"},{sample:"TCGA-13-0885-01",gene:"BRCA2",alteration:"K1406fs",type:"TRUNC"},{sample:"TCGA-13-0890-01",gene:"BRCA2",alteration:"V1229fs",type:"TRUNC"},{sample:"TCGA-13-1512-01",gene:"BRCA2",alteration:"K3326*",type:"TRUNC"},{sample:"TCGA-23-1030-01",gene:"BRCA2",alteration:"T1354M",type:"MISSENSE"},{sample:"TCGA-23-1026-01",gene:"BRCA2",alteration:"K3326*",type:"TRUNC"},{sample:"TCGA-25-1634-01",gene:"BRCA2",alteration:"E2878_splice",type:"TRUNC"},{sample:"TCGA-24-1555-01",gene:"BRCA2",alteration:"T2607fs",type:"TRUNC"},{sample:"TCGA-13-0886-01",gene:"BRCA2",alteration:"S1982fs",type:"TRUNC"},{sample:"TCGA-13-0792-01",gene:"BRCA2",alteration:"E1143D",type:"MISSENSE"},{sample:"TCGA-24-2293-01",gene:"BRCA2",alteration:"R2520*",type:"TRUNC"},{sample:"TCGA-23-1120-01",gene:"BRCA2",alteration:"L3277fs",type:"TRUNC"},{sample:"TCGA-25-2396-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-2397-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-2398-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-2399-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-2400-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-2401-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-2392-01",gene:null,alteration:null,type:null},{sample:"TCGA-25-2393-01",gene:null,alteration:null,type:null}]}]);